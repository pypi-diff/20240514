# Comparing `tmp/bigframes-1.5.0.tar.gz` & `tmp/bigframes-1.6.0.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "bigframes-1.5.0.tar", last modified: Tue May  7 06:49:32 2024, max compression
+gzip compressed data, was "bigframes-1.6.0.tar", last modified: Tue May 14 18:04:26 2024, max compression
```

## Comparing `bigframes-1.5.0.tar` & `bigframes-1.6.0.tar`

### file list

```diff
@@ -1,388 +1,389 @@
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.982660 bigframes-1.5.0/
--rw-rw-r--   0 root         (0)     1003    11358 2024-05-07 06:46:57.000000 bigframes-1.5.0/LICENSE
--rw-rw-r--   0 root         (0)     1003      914 2024-05-07 06:46:57.000000 bigframes-1.5.0/MANIFEST.in
--rw-r--r--   0 root         (0)     1003     4785 2024-05-07 06:49:32.978659 bigframes-1.5.0/PKG-INFO
--rw-rw-r--   0 root         (0)     1003     2391 2024-05-07 06:46:57.000000 bigframes-1.5.0/README.rst
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.902653 bigframes-1.5.0/bigframes/
--rw-rw-r--   0 root         (0)     1003     1216 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/__init__.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.906654 bigframes-1.5.0/bigframes/_config/
--rw-rw-r--   0 root         (0)     1003     4315 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/_config/__init__.py
--rw-rw-r--   0 root         (0)     1003     8953 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/_config/bigquery_options.py
--rw-rw-r--   0 root         (0)     1003     4369 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/_config/compute_options.py
--rw-rw-r--   0 root         (0)     1003     1661 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/_config/display_options.py
--rw-rw-r--   0 root         (0)     1003     1892 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/_config/sampling_options.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.906654 bigframes-1.5.0/bigframes/bigquery/
--rw-rw-r--   0 root         (0)     1003     1730 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/bigquery/__init__.py
--rw-rw-r--   0 root         (0)     1003     7152 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/clients.py
--rw-rw-r--   0 root         (0)     1003     2779 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/constants.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.910654 bigframes-1.5.0/bigframes/core/
--rw-rw-r--   0 root         (0)     1003    18021 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/core/__init__.py
--rw-rw-r--   0 root         (0)     1003    30768 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/core/block_transforms.py
--rw-rw-r--   0 root         (0)     1003    95833 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/core/blocks.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.914654 bigframes-1.5.0/bigframes/core/compile/
--rw-rw-r--   0 root         (0)     1003      832 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/core/compile/__init__.py
--rw-rw-r--   0 root         (0)     1003    17475 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/core/compile/aggregate_compiler.py
--rw-rw-r--   0 root         (0)     1003    52133 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/core/compile/compiled.py
--rw-rw-r--   0 root         (0)     1003     6341 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/core/compile/compiler.py
--rw-rw-r--   0 root         (0)     1003     3356 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/core/compile/concat.py
--rw-rw-r--   0 root         (0)     1003    48955 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/core/compile/scalar_op_compiler.py
--rw-rw-r--   0 root         (0)     1003     7121 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/core/compile/single_column.py
--rw-rw-r--   0 root         (0)     1003     2962 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/core/convert.py
--rw-rw-r--   0 root         (0)     1003     2495 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/core/eval.py
--rw-rw-r--   0 root         (0)     1003     6685 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/core/expression.py
--rw-rw-r--   0 root         (0)     1003     3887 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/core/global_session.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.914654 bigframes-1.5.0/bigframes/core/groupby/
--rw-rw-r--   0 root         (0)     1003    23982 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/core/groupby/__init__.py
--rw-rw-r--   0 root         (0)     1003      716 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/core/guid.py
--rw-rw-r--   0 root         (0)     1003    18056 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/core/indexers.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.914654 bigframes-1.5.0/bigframes/core/indexes/
--rw-rw-r--   0 root         (0)     1003      719 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/core/indexes/__init__.py
--rw-rw-r--   0 root         (0)     1003    16239 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/core/indexes/base.py
--rw-rw-r--   0 root         (0)     1003     1720 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/core/indexes/multi.py
--rw-rw-r--   0 root         (0)     1003     1730 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/core/join_def.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.914654 bigframes-1.5.0/bigframes/core/joins/
--rw-rw-r--   0 root         (0)     1003      691 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/core/joins/__init__.py
--rw-rw-r--   0 root         (0)     1003     2132 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/core/joins/merge.py
--rw-rw-r--   0 root         (0)     1003     2218 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/core/local_data.py
--rw-rw-r--   0 root         (0)     1003     2255 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/core/log_adapter.py
--rw-rw-r--   0 root         (0)     1003    18515 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/core/nodes.py
--rw-rw-r--   0 root         (0)     1003     9445 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/core/ordering.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.914654 bigframes-1.5.0/bigframes/core/reshape/
--rw-rw-r--   0 root         (0)     1003     6872 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/core/reshape/__init__.py
--rw-rw-r--   0 root         (0)     1003    11714 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/core/rewrite.py
--rw-rw-r--   0 root         (0)     1003      746 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/core/scalar.py
--rw-rw-r--   0 root         (0)     1003     2144 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/core/schema.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.914654 bigframes-1.5.0/bigframes/core/tools/
--rw-rw-r--   0 root         (0)     1003      664 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/core/tools/__init__.py
--rw-rw-r--   0 root         (0)     1003     2515 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/core/tools/datetimes.py
--rw-rw-r--   0 root         (0)     1003     3002 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/core/tree_properties.py
--rw-rw-r--   0 root         (0)     1003     5483 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/core/utils.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.914654 bigframes-1.5.0/bigframes/core/window/
--rw-rw-r--   0 root         (0)     1003     3075 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/core/window/__init__.py
--rw-rw-r--   0 root         (0)     1003     1286 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/core/window_spec.py
--rw-rw-r--   0 root         (0)     1003   132153 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/dataframe.py
--rw-rw-r--   0 root         (0)     1003    27597 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/dtypes.py
--rw-rw-r--   0 root         (0)     1003     1029 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/enums.py
--rw-rw-r--   0 root         (0)     1003      992 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/exceptions.py
--rw-rw-r--   0 root         (0)     1003     1273 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/features.py
--rw-rw-r--   0 root         (0)     1003    11179 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/formatting_helpers.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.914654 bigframes-1.5.0/bigframes/functions/
--rw-rw-r--   0 root         (0)     1003      574 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/functions/__init__.py
--rw-rw-r--   0 root         (0)     1003    43091 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/functions/remote_function.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.922655 bigframes-1.5.0/bigframes/ml/
--rw-rw-r--   0 root         (0)     1003      877 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/ml/__init__.py
--rw-rw-r--   0 root         (0)     1003     8542 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/ml/base.py
--rw-rw-r--   0 root         (0)     1003     6659 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/ml/cluster.py
--rw-rw-r--   0 root         (0)     1003     7984 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/ml/compose.py
--rw-rw-r--   0 root         (0)     1003    17897 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/ml/core.py
--rw-rw-r--   0 root         (0)     1003     6807 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/ml/decomposition.py
--rw-rw-r--   0 root         (0)     1003    24746 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/ml/ensemble.py
--rw-rw-r--   0 root         (0)     1003    16689 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/ml/forecasting.py
--rw-rw-r--   0 root         (0)     1003     1141 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/ml/globals.py
--rw-rw-r--   0 root         (0)     1003    10844 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/ml/imported.py
--rw-rw-r--   0 root         (0)     1003    13818 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/ml/linear_model.py
--rw-rw-r--   0 root         (0)     1003    32261 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/ml/llm.py
--rw-rw-r--   0 root         (0)     1003     4899 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/ml/loader.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.922655 bigframes-1.5.0/bigframes/ml/metrics/
--rw-rw-r--   0 root         (0)     1003     1066 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/ml/metrics/__init__.py
--rw-rw-r--   0 root         (0)     1003    11096 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/ml/metrics/_metrics.py
--rw-rw-r--   0 root         (0)     1003     2373 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/ml/metrics/pairwise.py
--rw-rw-r--   0 root         (0)     1003     3748 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/ml/model_selection.py
--rw-rw-r--   0 root         (0)     1003     5067 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/ml/pipeline.py
--rw-rw-r--   0 root         (0)     1003    22667 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/ml/preprocessing.py
--rw-rw-r--   0 root         (0)     1003     5773 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/ml/remote.py
--rw-rw-r--   0 root         (0)     1003    14588 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/ml/sql.py
--rw-rw-r--   0 root         (0)     1003     2403 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/ml/utils.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.922655 bigframes-1.5.0/bigframes/operations/
--rw-rw-r--   0 root         (0)     1003    23377 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/operations/__init__.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.922655 bigframes-1.5.0/bigframes/operations/_matplotlib/
--rw-rw-r--   0 root         (0)     1003     1022 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/operations/_matplotlib/__init__.py
--rw-rw-r--   0 root         (0)     1003     4477 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/operations/_matplotlib/core.py
--rw-rw-r--   0 root         (0)     1003     5970 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/operations/_matplotlib/hist.py
--rw-rw-r--   0 root         (0)     1003    13202 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/operations/aggregations.py
--rw-rw-r--   0 root         (0)     1003     9321 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/operations/base.py
--rw-rw-r--   0 root         (0)     1003     3079 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/operations/datetimes.py
--rw-rw-r--   0 root         (0)     1003     2814 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/operations/plotting.py
--rw-rw-r--   0 root         (0)     1003     9009 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/operations/strings.py
--rw-rw-r--   0 root         (0)     1003     2089 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/operations/structs.py
--rw-rw-r--   0 root         (0)     1003     7613 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/operations/type.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.926655 bigframes-1.5.0/bigframes/pandas/
--rw-rw-r--   0 root         (0)     1003    25854 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/pandas/__init__.py
--rw-rw-r--   0 root         (0)     1003        0 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/py.typed
--rw-rw-r--   0 root         (0)     1003    64473 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/series.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.926655 bigframes-1.5.0/bigframes/session/
--rw-rw-r--   0 root         (0)     1003    80817 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/session/__init__.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.926655 bigframes-1.5.0/bigframes/session/_io/
--rw-rw-r--   0 root         (0)     1003      574 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/session/_io/__init__.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.926655 bigframes-1.5.0/bigframes/session/_io/bigquery/
--rw-rw-r--   0 root         (0)     1003    10605 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/session/_io/bigquery/__init__.py
--rw-rw-r--   0 root         (0)     1003    16779 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/session/_io/bigquery/read_gbq_table.py
--rw-rw-r--   0 root         (0)     1003     4345 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/session/_io/pandas.py
--rw-rw-r--   0 root         (0)     1003     8043 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/session/clients.py
--rw-rw-r--   0 root         (0)     1003        0 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/typing.py
--rw-rw-r--   0 root         (0)     1003      597 2024-05-07 06:46:57.000000 bigframes-1.5.0/bigframes/version.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.978659 bigframes-1.5.0/bigframes.egg-info/
--rw-r--r--   0 root         (0)     1003     4785 2024-05-07 06:49:32.000000 bigframes-1.5.0/bigframes.egg-info/PKG-INFO
--rw-r--r--   0 root         (0)     1003    12539 2024-05-07 06:49:32.000000 bigframes-1.5.0/bigframes.egg-info/SOURCES.txt
--rw-r--r--   0 root         (0)     1003        1 2024-05-07 06:49:32.000000 bigframes-1.5.0/bigframes.egg-info/dependency_links.txt
--rw-r--r--   0 root         (0)     1003        1 2024-05-07 06:49:32.000000 bigframes-1.5.0/bigframes.egg-info/not-zip-safe
--rw-r--r--   0 root         (0)     1003      732 2024-05-07 06:49:32.000000 bigframes-1.5.0/bigframes.egg-info/requires.txt
--rw-r--r--   0 root         (0)     1003       29 2024-05-07 06:49:32.000000 bigframes-1.5.0/bigframes.egg-info/top_level.txt
--rw-rw-r--   0 root         (0)     1003       81 2024-05-07 06:46:57.000000 bigframes-1.5.0/pyproject.toml
--rw-rw-r--   0 root         (0)     1003       67 2024-05-07 06:49:32.982660 bigframes-1.5.0/setup.cfg
--rw-rw-r--   0 root         (0)     1003     4428 2024-05-07 06:46:57.000000 bigframes-1.5.0/setup.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.926655 bigframes-1.5.0/tests/
--rw-rw-r--   0 root         (0)     1003      574 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/__init__.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.930656 bigframes-1.5.0/tests/data/
--rw-rw-r--   0 root         (0)     1003      619 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/data/hockey_players.json
--rw-rw-r--   0 root         (0)     1003     1250 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/data/hockey_players.jsonl
--rw-rw-r--   0 root         (0)     1003      340 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/data/matrix_2by3.json
--rw-rw-r--   0 root         (0)     1003       80 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/data/matrix_2by3.jsonl
--rw-rw-r--   0 root         (0)     1003      421 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/data/matrix_3by4.json
--rw-rw-r--   0 root         (0)     1003      154 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/data/matrix_3by4.jsonl
--rw-rw-r--   0 root         (0)     1003    33350 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/data/nested.jsonl
--rw-rw-r--   0 root         (0)     1003      966 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/data/nested_schema.json
--rw-rw-r--   0 root         (0)     1003    58869 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/data/penguins.jsonl
--rw-rw-r--   0 root         (0)     1003      636 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/data/penguins_schema.json
--rw-rw-r--   0 root         (0)     1003     3909 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/data/scalars.jsonl
--rw-rw-r--   0 root         (0)     1003     1458 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/data/scalars_schema.json
--rw-rw-r--   0 root         (0)     1003    23424 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/data/time_series.jsonl
--rw-rw-r--   0 root         (0)     1003      192 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/data/time_series_schema.json
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.930656 bigframes-1.5.0/tests/system/
--rw-rw-r--   0 root         (0)     1003      574 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/__init__.py
--rw-rw-r--   0 root         (0)     1003    37310 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/conftest.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.930656 bigframes-1.5.0/tests/system/large/
--rw-rw-r--   0 root         (0)     1003      574 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/large/__init__.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.934656 bigframes-1.5.0/tests/system/large/ml/
--rw-rw-r--   0 root         (0)     1003     5411 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/large/ml/test_cluster.py
--rw-rw-r--   0 root         (0)     1003     5391 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/large/ml/test_compose.py
--rw-rw-r--   0 root         (0)     1003     6516 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/large/ml/test_core.py
--rw-rw-r--   0 root         (0)     1003     6487 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/large/ml/test_decomposition.py
--rw-rw-r--   0 root         (0)     1003    14552 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/large/ml/test_ensemble.py
--rw-rw-r--   0 root         (0)     1003     4551 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/large/ml/test_forecasting.py
--rw-rw-r--   0 root         (0)     1003     8408 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/large/ml/test_linear_model.py
--rw-rw-r--   0 root         (0)     1003    30564 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/large/ml/test_pipeline.py
--rw-rw-r--   0 root         (0)     1003     4079 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/large/test_location.py
--rw-rw-r--   0 root         (0)     1003    54220 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/large/test_remote_function.py
--rw-rw-r--   0 root         (0)     1003     4573 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/large/test_session.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.934656 bigframes-1.5.0/tests/system/load/
--rw-rw-r--   0 root         (0)     1003     3000 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/load/test_large_tables.py
--rw-rw-r--   0 root         (0)     1003     4559 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/load/test_llm.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.938656 bigframes-1.5.0/tests/system/small/
--rw-rw-r--   0 root         (0)     1003      574 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/__init__.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.938656 bigframes-1.5.0/tests/system/small/bigquery/
--rw-rw-r--   0 root         (0)     1003      574 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/bigquery/__init__.py
--rw-rw-r--   0 root         (0)     1003     1154 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/bigquery/test_array.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.942657 bigframes-1.5.0/tests/system/small/ml/
--rw-rw-r--   0 root         (0)     1003      574 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/ml/__init__.py
--rw-rw-r--   0 root         (0)     1003    11773 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/ml/conftest.py
--rw-rw-r--   0 root         (0)     1003     7074 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/ml/test_cluster.py
--rw-rw-r--   0 root         (0)     1003    13810 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/ml/test_core.py
--rw-rw-r--   0 root         (0)     1003     6764 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/ml/test_decomposition.py
--rw-rw-r--   0 root         (0)     1003    17015 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/ml/test_ensemble.py
--rw-rw-r--   0 root         (0)     1003     6859 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/ml/test_forecasting.py
--rw-rw-r--   0 root         (0)     1003     4983 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/ml/test_imported.py
--rw-rw-r--   0 root         (0)     1003     8788 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/ml/test_linear_model.py
--rw-rw-r--   0 root         (0)     1003    11929 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/ml/test_llm.py
--rw-rw-r--   0 root         (0)     1003    25138 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/ml/test_metrics.py
--rw-rw-r--   0 root         (0)     1003     2224 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/ml/test_metrics_pairwise.py
--rw-rw-r--   0 root         (0)     1003     6197 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/ml/test_model_selection.py
--rw-rw-r--   0 root         (0)     1003    27150 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/ml/test_preprocessing.py
--rw-rw-r--   0 root         (0)     1003     2570 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/ml/test_register.py
--rw-rw-r--   0 root         (0)     1003     1205 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/ml/test_remote.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.946657 bigframes-1.5.0/tests/system/small/operations/
--rw-rw-r--   0 root         (0)     1003      574 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/operations/__init__.py
--rw-rw-r--   0 root         (0)     1003    10399 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/operations/test_datetimes.py
--rw-rw-r--   0 root         (0)     1003    12453 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/operations/test_plotting.py
--rw-rw-r--   0 root         (0)     1003    15770 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/operations/test_strings.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.946657 bigframes-1.5.0/tests/system/small/regression/
--rw-rw-r--   0 root         (0)     1003     1999 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/regression/test_issue355_merge_after_filter.py
--rw-rw-r--   0 root         (0)     1003   145044 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/test_dataframe.py
--rw-rw-r--   0 root         (0)     1003    18968 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/test_dataframe_io.py
--rw-rw-r--   0 root         (0)     1003    10446 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/test_encryption.py
--rw-rw-r--   0 root         (0)     1003    13974 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/test_groupby.py
--rw-rw-r--   0 root         (0)     1003     1558 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/test_ibis.py
--rw-rw-r--   0 root         (0)     1003    13328 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/test_index.py
--rw-rw-r--   0 root         (0)     1003     1205 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/test_ipython.py
--rw-rw-r--   0 root         (0)     1003    41847 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/test_multiindex.py
--rw-rw-r--   0 root         (0)     1003     4190 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/test_numpy.py
--rw-rw-r--   0 root         (0)     1003    19608 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/test_pandas.py
--rw-rw-r--   0 root         (0)     1003    10425 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/test_pandas_options.py
--rw-rw-r--   0 root         (0)     1003     5133 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/test_progress_bar.py
--rw-rw-r--   0 root         (0)     1003    26485 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/test_remote_function.py
--rw-rw-r--   0 root         (0)     1003      913 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/test_scalar.py
--rw-rw-r--   0 root         (0)     1003   111197 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/test_series.py
--rw-rw-r--   0 root         (0)     1003    40499 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/test_session.py
--rw-rw-r--   0 root         (0)     1003     3343 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/small/test_window.py
--rw-rw-r--   0 root         (0)     1003    12113 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/system/utils.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.946657 bigframes-1.5.0/tests/unit/
--rw-rw-r--   0 root         (0)     1003      574 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/unit/__init__.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.950657 bigframes-1.5.0/tests/unit/_config/
--rw-rw-r--   0 root         (0)     1003      574 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/unit/_config/__init__.py
--rw-rw-r--   0 root         (0)     1003     4218 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/unit/_config/test_bigquery_options.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.950657 bigframes-1.5.0/tests/unit/core/
--rw-rw-r--   0 root         (0)     1003      574 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/unit/core/__init__.py
--rw-rw-r--   0 root         (0)     1003     1619 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/unit/core/test_bf_utils.py
--rw-rw-r--   0 root         (0)     1003     2966 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/unit/core/test_blocks.py
--rw-rw-r--   0 root         (0)     1003     1553 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/unit/core/test_expression.py
--rw-rw-r--   0 root         (0)     1003     1813 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/unit/core/test_log_adapter.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.950657 bigframes-1.5.0/tests/unit/ml/
--rw-rw-r--   0 root         (0)     1003      574 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/unit/ml/__init__.py
--rw-rw-r--   0 root         (0)     1003     2323 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/unit/ml/test_api_primitives.py
--rw-rw-r--   0 root         (0)     1003     6555 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/unit/ml/test_compose.py
--rw-rw-r--   0 root         (0)     1003     7422 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/unit/ml/test_golden_sql.py
--rw-rw-r--   0 root         (0)     1003     4058 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/unit/ml/test_pipeline.py
--rw-rw-r--   0 root         (0)     1003    14554 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/unit/ml/test_sql.py
--rw-rw-r--   0 root         (0)     1003     5298 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/unit/resources.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.954658 bigframes-1.5.0/tests/unit/session/
--rw-rw-r--   0 root         (0)     1003      574 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/unit/session/__init__.py
--rw-rw-r--   0 root         (0)     1003     4347 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/unit/session/test_clients.py
--rw-rw-r--   0 root         (0)     1003     7193 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/unit/session/test_io_bigquery.py
--rw-rw-r--   0 root         (0)     1003    18664 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/unit/session/test_io_pandas.py
--rw-rw-r--   0 root         (0)     1003     1272 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/unit/session/test_read_gbq_table.py
--rw-rw-r--   0 root         (0)     1003    16158 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/unit/session/test_session.py
--rw-rw-r--   0 root         (0)     1003     1744 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/unit/test_clients.py
--rw-rw-r--   0 root         (0)     1003     1056 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/unit/test_compute_options.py
--rw-rw-r--   0 root         (0)     1003     6648 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/unit/test_core.py
--rw-rw-r--   0 root         (0)     1003     2136 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/unit/test_dataframe.py
--rw-rw-r--   0 root         (0)     1003     8819 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/unit/test_dtypes.py
--rw-rw-r--   0 root         (0)     1003     1577 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/unit/test_features.py
--rw-rw-r--   0 root         (0)     1003      528 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/unit/test_formatting_helper.py
--rw-rw-r--   0 root         (0)     1003     1655 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/unit/test_formatting_helpers.py
--rw-rw-r--   0 root         (0)     1003     4055 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/unit/test_pandas.py
--rw-rw-r--   0 root         (0)     1003     1207 2024-05-07 06:46:57.000000 bigframes-1.5.0/tests/unit/test_remote_function.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.890652 bigframes-1.5.0/third_party/
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.954658 bigframes-1.5.0/third_party/bigframes_vendored/
--rw-rw-r--   0 root         (0)     1003        0 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/__init__.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.954658 bigframes-1.5.0/third_party/bigframes_vendored/cpython/
--rw-rw-r--   0 root         (0)     1003     2339 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/cpython/LICENSE
--rw-rw-r--   0 root         (0)     1003        0 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/cpython/__init__.py
--rw-rw-r--   0 root         (0)     1003    18854 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/cpython/_pprint.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.954658 bigframes-1.5.0/third_party/bigframes_vendored/google_cloud_bigquery/
--rw-rw-r--   0 root         (0)     1003    11358 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/google_cloud_bigquery/LICENSE
--rw-rw-r--   0 root         (0)     1003      574 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/google_cloud_bigquery/__init__.py
--rw-rw-r--   0 root         (0)     1003     5290 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/google_cloud_bigquery/_pandas_helpers.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.954658 bigframes-1.5.0/third_party/bigframes_vendored/google_cloud_bigquery/tests/
--rw-rw-r--   0 root         (0)     1003      574 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/google_cloud_bigquery/tests/__init__.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.954658 bigframes-1.5.0/third_party/bigframes_vendored/google_cloud_bigquery/tests/unit/
--rw-rw-r--   0 root         (0)     1003      574 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/google_cloud_bigquery/tests/unit/__init__.py
--rw-rw-r--   0 root         (0)     1003    14045 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/google_cloud_bigquery/tests/unit/test_pandas_helpers.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.954658 bigframes-1.5.0/third_party/bigframes_vendored/ibis/
--rw-rw-r--   0 root         (0)     1003    11358 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/ibis/LICENSE.txt
--rw-rw-r--   0 root         (0)     1003    11663 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/ibis/README.md
--rw-rw-r--   0 root         (0)     1003        0 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/ibis/__init__.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.958658 bigframes-1.5.0/third_party/bigframes_vendored/ibis/backends/
--rw-rw-r--   0 root         (0)     1003        0 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/ibis/backends/__init__.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.958658 bigframes-1.5.0/third_party/bigframes_vendored/ibis/backends/bigquery/
--rw-rw-r--   0 root         (0)     1003      184 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/ibis/backends/bigquery/__init__.py
--rw-rw-r--   0 root         (0)     1003     2091 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/ibis/backends/bigquery/compiler.py
--rw-rw-r--   0 root         (0)     1003     6600 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/ibis/backends/bigquery/datatypes.py
--rw-rw-r--   0 root         (0)     1003     1892 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/ibis/backends/bigquery/registry.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.958658 bigframes-1.5.0/third_party/bigframes_vendored/ibis/expr/
--rw-rw-r--   0 root         (0)     1003        0 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/ibis/expr/__init__.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.958658 bigframes-1.5.0/third_party/bigframes_vendored/ibis/expr/operations/
--rw-rw-r--   0 root         (0)     1003      464 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/ibis/expr/operations/__init__.py
--rw-rw-r--   0 root         (0)     1003      536 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/ibis/expr/operations/analytic.py
--rw-rw-r--   0 root         (0)     1003      276 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/ibis/expr/operations/generic.py
--rw-rw-r--   0 root         (0)     1003      263 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/ibis/expr/operations/json.py
--rw-rw-r--   0 root         (0)     1003      690 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/ibis/expr/operations/reductions.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.958658 bigframes-1.5.0/third_party/bigframes_vendored/pandas/
--rw-rw-r--   0 root         (0)     1003     2284 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/AUTHORS.md
--rw-rw-r--   0 root         (0)     1003     1634 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/LICENSE
--rw-rw-r--   0 root         (0)     1003    10620 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/README.md
--rw-rw-r--   0 root         (0)     1003        0 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/__init__.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.958658 bigframes-1.5.0/third_party/bigframes_vendored/pandas/_config/
--rw-rw-r--   0 root         (0)     1003     2352 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/_config/config.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.962658 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.962658 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/arrays/
--rw-rw-r--   0 root         (0)     1003        0 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/arrays/__init__.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.962658 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/arrays/arrow/
--rw-rw-r--   0 root         (0)     1003        0 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/arrays/arrow/__init__.py
--rw-rw-r--   0 root         (0)     1003     3831 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/arrays/arrow/accessors.py
--rw-rw-r--   0 root         (0)     1003     3689 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/arrays/datetimelike.py
--rw-rw-r--   0 root         (0)     1003     2086 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/common.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.966658 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/computation/
--rw-rw-r--   0 root         (0)     1003     6944 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/computation/align.py
--rw-rw-r--   0 root         (0)     1003     1543 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/computation/common.py
--rw-rw-r--   0 root         (0)     1003     2295 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/computation/engines.py
--rw-rw-r--   0 root         (0)     1003    12685 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/computation/eval.py
--rw-rw-r--   0 root         (0)     1003    25132 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/computation/expr.py
--rw-rw-r--   0 root         (0)     1003    16244 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/computation/ops.py
--rw-rw-r--   0 root         (0)     1003     6477 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/computation/parsing.py
--rw-rw-r--   0 root         (0)     1003    10303 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/computation/scope.py
--rw-rw-r--   0 root         (0)     1003     4394 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/config_init.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.966658 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/dtypes/
--rw-rw-r--   0 root         (0)     1003      707 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/dtypes/inference.py
--rw-rw-r--   0 root         (0)     1003   228195 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/frame.py
--rw-rw-r--   0 root         (0)     1003    40215 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/generic.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.966658 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/groupby/
--rw-rw-r--   0 root         (0)     1003    14023 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/groupby/__init__.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.966658 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/indexes/
--rw-rw-r--   0 root         (0)     1003        0 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/indexes/__init__.py
--rw-rw-r--   0 root         (0)     1003     9589 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/indexes/accessor.py
--rw-rw-r--   0 root         (0)     1003    11461 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/indexes/base.py
--rw-rw-r--   0 root         (0)     1003     2941 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/indexes/multi.py
--rw-rw-r--   0 root         (0)     1003     2909 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/indexing.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.966658 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/reshape/
--rw-rw-r--   0 root         (0)     1003        0 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/reshape/__init__.py
--rw-rw-r--   0 root         (0)     1003     4372 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/reshape/concat.py
--rw-rw-r--   0 root         (0)     1003     3804 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/reshape/encoding.py
--rw-rw-r--   0 root         (0)     1003     3220 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/reshape/merge.py
--rw-rw-r--   0 root         (0)     1003     5844 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/reshape/tile.py
--rw-rw-r--   0 root         (0)     1003   131177 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/series.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.966658 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/strings/
--rw-rw-r--   0 root         (0)     1003    37771 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/strings/accessor.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.970659 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/tools/
--rw-rw-r--   0 root         (0)     1003        0 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/tools/__init__.py
--rw-rw-r--   0 root         (0)     1003     2964 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/tools/datetimes.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.970659 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/window/
--rw-rw-r--   0 root         (0)     1003        0 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/window/__init__.py
--rw-rw-r--   0 root         (0)     1003     1350 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/window/rolling.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.970659 bigframes-1.5.0/third_party/bigframes_vendored/pandas/io/
--rw-rw-r--   0 root         (0)     1003        0 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/io/__init__.py
--rw-rw-r--   0 root         (0)     1003     1269 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/io/common.py
--rw-rw-r--   0 root         (0)     1003     8092 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/io/gbq.py
--rw-rw-r--   0 root         (0)     1003     1428 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/io/parquet.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.970659 bigframes-1.5.0/third_party/bigframes_vendored/pandas/io/parsers/
--rw-rw-r--   0 root         (0)     1003        0 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/io/parsers/__init__.py
--rw-rw-r--   0 root         (0)     1003    10705 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/io/parsers/readers.py
--rw-rw-r--   0 root         (0)     1003     3130 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/io/pickle.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.970659 bigframes-1.5.0/third_party/bigframes_vendored/pandas/pandas/
--rw-rw-r--   0 root         (0)     1003    12353 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/pandas/_typing.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.970659 bigframes-1.5.0/third_party/bigframes_vendored/pandas/plotting/
--rw-rw-r--   0 root         (0)     1003    11460 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/plotting/_core.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.970659 bigframes-1.5.0/third_party/bigframes_vendored/pandas/util/
--rw-rw-r--   0 root         (0)     1003      765 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/util/_exceptions.py
--rw-rw-r--   0 root         (0)     1003     1573 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/pandas/util/_validators.py
--rw-rw-r--   0 root         (0)     1003        0 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/py.typed
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.974659 bigframes-1.5.0/third_party/bigframes_vendored/sklearn/
--rw-rw-r--   0 root         (0)     1003     1532 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/sklearn/COPYING
--rw-rw-r--   0 root         (0)     1003        0 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/sklearn/__init__.py
--rw-rw-r--   0 root         (0)     1003     6212 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/sklearn/base.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.974659 bigframes-1.5.0/third_party/bigframes_vendored/sklearn/cluster/
--rw-rw-r--   0 root         (0)     1003     5924 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/sklearn/cluster/_kmeans.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.974659 bigframes-1.5.0/third_party/bigframes_vendored/sklearn/compose/
--rw-rw-r--   0 root         (0)     1003     2014 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/sklearn/compose/_column_transformer.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.974659 bigframes-1.5.0/third_party/bigframes_vendored/sklearn/decomposition/
--rw-rw-r--   0 root         (0)     1003     5387 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/sklearn/decomposition/_pca.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.974659 bigframes-1.5.0/third_party/bigframes_vendored/sklearn/ensemble/
--rw-rw-r--   0 root         (0)     1003        0 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/sklearn/ensemble/__init__.py
--rw-rw-r--   0 root         (0)     1003     8977 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/sklearn/ensemble/_forest.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.974659 bigframes-1.5.0/third_party/bigframes_vendored/sklearn/linear_model/
--rw-rw-r--   0 root         (0)     1003     5417 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/sklearn/linear_model/_base.py
--rw-rw-r--   0 root         (0)     1003     4348 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/sklearn/linear_model/_logistic.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.974659 bigframes-1.5.0/third_party/bigframes_vendored/sklearn/metrics/
--rw-rw-r--   0 root         (0)     1003     9783 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/sklearn/metrics/_classification.py
--rw-rw-r--   0 root         (0)     1003     6347 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/sklearn/metrics/_ranking.py
--rw-rw-r--   0 root         (0)     1003     3550 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/sklearn/metrics/_regression.py
--rw-rw-r--   0 root         (0)     1003     2124 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/sklearn/metrics/pairwise.py
--rw-rw-r--   0 root         (0)     1003     2977 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/sklearn/pipeline.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.978659 bigframes-1.5.0/third_party/bigframes_vendored/sklearn/preprocessing/
--rw-rw-r--   0 root         (0)     1003     4980 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/sklearn/preprocessing/_data.py
--rw-rw-r--   0 root         (0)     1003     1523 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/sklearn/preprocessing/_discretization.py
--rw-rw-r--   0 root         (0)     1003     4059 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/sklearn/preprocessing/_encoder.py
--rw-rw-r--   0 root         (0)     1003     2085 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/sklearn/preprocessing/_label.py
-drwxr-sr-x   0 root         (0)     1003        0 2024-05-07 06:49:32.978659 bigframes-1.5.0/third_party/bigframes_vendored/xgboost/
--rw-rw-r--   0 root         (0)     1003    11348 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/xgboost/LICENSE
--rw-rw-r--   0 root         (0)     1003        0 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/xgboost/__init__.py
--rw-rw-r--   0 root         (0)     1003     6919 2024-05-07 06:46:57.000000 bigframes-1.5.0/third_party/bigframes_vendored/xgboost/sklearn.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.585627 bigframes-1.6.0/
+-rw-rw-r--   0 root         (0)     1003    11358 2024-05-14 18:01:45.000000 bigframes-1.6.0/LICENSE
+-rw-rw-r--   0 root         (0)     1003      914 2024-05-14 18:01:45.000000 bigframes-1.6.0/MANIFEST.in
+-rw-r--r--   0 root         (0)     1003     4817 2024-05-14 18:04:26.585627 bigframes-1.6.0/PKG-INFO
+-rw-rw-r--   0 root         (0)     1003     2391 2024-05-14 18:01:45.000000 bigframes-1.6.0/README.rst
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.509637 bigframes-1.6.0/bigframes/
+-rw-rw-r--   0 root         (0)     1003     1216 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/__init__.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.513637 bigframes-1.6.0/bigframes/_config/
+-rw-rw-r--   0 root         (0)     1003     4315 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/_config/__init__.py
+-rw-rw-r--   0 root         (0)     1003     9229 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/_config/bigquery_options.py
+-rw-rw-r--   0 root         (0)     1003     4369 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/_config/compute_options.py
+-rw-rw-r--   0 root         (0)     1003     1661 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/_config/display_options.py
+-rw-rw-r--   0 root         (0)     1003     1892 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/_config/sampling_options.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.513637 bigframes-1.6.0/bigframes/bigquery/
+-rw-rw-r--   0 root         (0)     1003     1730 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/bigquery/__init__.py
+-rw-rw-r--   0 root         (0)     1003     7152 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/clients.py
+-rw-rw-r--   0 root         (0)     1003     2779 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/constants.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.517636 bigframes-1.6.0/bigframes/core/
+-rw-rw-r--   0 root         (0)     1003    18113 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/core/__init__.py
+-rw-rw-r--   0 root         (0)     1003    30581 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/core/block_transforms.py
+-rw-rw-r--   0 root         (0)     1003    99761 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/core/blocks.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.521636 bigframes-1.6.0/bigframes/core/compile/
+-rw-rw-r--   0 root         (0)     1003      832 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/core/compile/__init__.py
+-rw-rw-r--   0 root         (0)     1003    17475 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/core/compile/aggregate_compiler.py
+-rw-rw-r--   0 root         (0)     1003    53105 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/core/compile/compiled.py
+-rw-rw-r--   0 root         (0)     1003     6341 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/core/compile/compiler.py
+-rw-rw-r--   0 root         (0)     1003     3356 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/core/compile/concat.py
+-rw-rw-r--   0 root         (0)     1003    49672 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/core/compile/scalar_op_compiler.py
+-rw-rw-r--   0 root         (0)     1003     7121 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/core/compile/single_column.py
+-rw-rw-r--   0 root         (0)     1003     2962 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/core/convert.py
+-rw-rw-r--   0 root         (0)     1003     2495 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/core/eval.py
+-rw-rw-r--   0 root         (0)     1003     6685 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/core/expression.py
+-rw-rw-r--   0 root         (0)     1003     3887 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/core/global_session.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.521636 bigframes-1.6.0/bigframes/core/groupby/
+-rw-rw-r--   0 root         (0)     1003    24020 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/core/groupby/__init__.py
+-rw-rw-r--   0 root         (0)     1003      716 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/core/guid.py
+-rw-rw-r--   0 root         (0)     1003    18056 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/core/indexers.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.521636 bigframes-1.6.0/bigframes/core/indexes/
+-rw-rw-r--   0 root         (0)     1003      719 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/core/indexes/__init__.py
+-rw-rw-r--   0 root         (0)     1003    16239 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/core/indexes/base.py
+-rw-rw-r--   0 root         (0)     1003     1720 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/core/indexes/multi.py
+-rw-rw-r--   0 root         (0)     1003     1730 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/core/join_def.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.521636 bigframes-1.6.0/bigframes/core/joins/
+-rw-rw-r--   0 root         (0)     1003      691 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/core/joins/__init__.py
+-rw-rw-r--   0 root         (0)     1003     2132 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/core/joins/merge.py
+-rw-rw-r--   0 root         (0)     1003     2218 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/core/local_data.py
+-rw-rw-r--   0 root         (0)     1003     3424 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/core/log_adapter.py
+-rw-rw-r--   0 root         (0)     1003    18515 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/core/nodes.py
+-rw-rw-r--   0 root         (0)     1003     9445 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/core/ordering.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.521636 bigframes-1.6.0/bigframes/core/reshape/
+-rw-rw-r--   0 root         (0)     1003     6902 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/core/reshape/__init__.py
+-rw-rw-r--   0 root         (0)     1003    11714 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/core/rewrite.py
+-rw-rw-r--   0 root         (0)     1003      746 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/core/scalar.py
+-rw-rw-r--   0 root         (0)     1003     2144 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/core/schema.py
+-rw-rw-r--   0 root         (0)     1003     1668 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/core/sql.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.521636 bigframes-1.6.0/bigframes/core/tools/
+-rw-rw-r--   0 root         (0)     1003      664 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/core/tools/__init__.py
+-rw-rw-r--   0 root         (0)     1003     2515 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/core/tools/datetimes.py
+-rw-rw-r--   0 root         (0)     1003     3002 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/core/tree_properties.py
+-rw-rw-r--   0 root         (0)     1003     5483 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/core/utils.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.521636 bigframes-1.6.0/bigframes/core/window/
+-rw-rw-r--   0 root         (0)     1003     3075 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/core/window/__init__.py
+-rw-rw-r--   0 root         (0)     1003     4431 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/core/window_spec.py
+-rw-rw-r--   0 root         (0)     1003   134480 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/dataframe.py
+-rw-rw-r--   0 root         (0)     1003    27800 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/dtypes.py
+-rw-rw-r--   0 root         (0)     1003     1029 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/enums.py
+-rw-rw-r--   0 root         (0)     1003     1254 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/exceptions.py
+-rw-rw-r--   0 root         (0)     1003     1273 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/features.py
+-rw-rw-r--   0 root         (0)     1003    11179 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/formatting_helpers.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.521636 bigframes-1.6.0/bigframes/functions/
+-rw-rw-r--   0 root         (0)     1003      574 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/functions/__init__.py
+-rw-rw-r--   0 root         (0)     1003    47775 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/functions/remote_function.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.529635 bigframes-1.6.0/bigframes/ml/
+-rw-rw-r--   0 root         (0)     1003      877 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/ml/__init__.py
+-rw-rw-r--   0 root         (0)     1003     8542 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/ml/base.py
+-rw-rw-r--   0 root         (0)     1003     6196 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/ml/cluster.py
+-rw-rw-r--   0 root         (0)     1003     8049 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/ml/compose.py
+-rw-rw-r--   0 root         (0)     1003    17897 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/ml/core.py
+-rw-rw-r--   0 root         (0)     1003     6757 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/ml/decomposition.py
+-rw-rw-r--   0 root         (0)     1003    23414 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/ml/ensemble.py
+-rw-rw-r--   0 root         (0)     1003    15801 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/ml/forecasting.py
+-rw-rw-r--   0 root         (0)     1003     1141 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/ml/globals.py
+-rw-rw-r--   0 root         (0)     1003    10837 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/ml/imported.py
+-rw-rw-r--   0 root         (0)     1003    12556 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/ml/linear_model.py
+-rw-rw-r--   0 root         (0)     1003    31790 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/ml/llm.py
+-rw-rw-r--   0 root         (0)     1003     4905 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/ml/loader.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.529635 bigframes-1.6.0/bigframes/ml/metrics/
+-rw-rw-r--   0 root         (0)     1003     1066 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/ml/metrics/__init__.py
+-rw-rw-r--   0 root         (0)     1003    11096 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/ml/metrics/_metrics.py
+-rw-rw-r--   0 root         (0)     1003     2373 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/ml/metrics/pairwise.py
+-rw-rw-r--   0 root         (0)     1003     3748 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/ml/model_selection.py
+-rw-rw-r--   0 root         (0)     1003     5067 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/ml/pipeline.py
+-rw-rw-r--   0 root         (0)     1003    23307 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/ml/preprocessing.py
+-rw-rw-r--   0 root         (0)     1003     5773 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/ml/remote.py
+-rw-rw-r--   0 root         (0)     1003    14865 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/ml/sql.py
+-rw-rw-r--   0 root         (0)     1003     3738 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/ml/utils.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.529635 bigframes-1.6.0/bigframes/operations/
+-rw-rw-r--   0 root         (0)     1003    24000 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/operations/__init__.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.529635 bigframes-1.6.0/bigframes/operations/_matplotlib/
+-rw-rw-r--   0 root         (0)     1003     1022 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/operations/_matplotlib/__init__.py
+-rw-rw-r--   0 root         (0)     1003     4477 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/operations/_matplotlib/core.py
+-rw-rw-r--   0 root         (0)     1003     5970 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/operations/_matplotlib/hist.py
+-rw-rw-r--   0 root         (0)     1003    13346 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/operations/aggregations.py
+-rw-rw-r--   0 root         (0)     1003     9947 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/operations/base.py
+-rw-rw-r--   0 root         (0)     1003     3079 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/operations/datetimes.py
+-rw-rw-r--   0 root         (0)     1003     2814 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/operations/plotting.py
+-rw-rw-r--   0 root         (0)     1003     9461 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/operations/strings.py
+-rw-rw-r--   0 root         (0)     1003     2089 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/operations/structs.py
+-rw-rw-r--   0 root         (0)     1003     7613 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/operations/type.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.533634 bigframes-1.6.0/bigframes/pandas/
+-rw-rw-r--   0 root         (0)     1003    26027 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/pandas/__init__.py
+-rw-rw-r--   0 root         (0)     1003        0 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/py.typed
+-rw-rw-r--   0 root         (0)     1003    66345 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/series.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.533634 bigframes-1.6.0/bigframes/session/
+-rw-rw-r--   0 root         (0)     1003    79388 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/session/__init__.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.533634 bigframes-1.6.0/bigframes/session/_io/
+-rw-rw-r--   0 root         (0)     1003      574 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/session/_io/__init__.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.533634 bigframes-1.6.0/bigframes/session/_io/bigquery/
+-rw-rw-r--   0 root         (0)     1003    14297 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/session/_io/bigquery/__init__.py
+-rw-rw-r--   0 root         (0)     1003    16559 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/session/_io/bigquery/read_gbq_table.py
+-rw-rw-r--   0 root         (0)     1003     4345 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/session/_io/pandas.py
+-rw-rw-r--   0 root         (0)     1003     8043 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/session/clients.py
+-rw-rw-r--   0 root         (0)     1003        0 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/typing.py
+-rw-rw-r--   0 root         (0)     1003      597 2024-05-14 18:01:45.000000 bigframes-1.6.0/bigframes/version.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.585627 bigframes-1.6.0/bigframes.egg-info/
+-rw-r--r--   0 root         (0)     1003     4817 2024-05-14 18:04:26.000000 bigframes-1.6.0/bigframes.egg-info/PKG-INFO
+-rw-r--r--   0 root         (0)     1003    12561 2024-05-14 18:04:26.000000 bigframes-1.6.0/bigframes.egg-info/SOURCES.txt
+-rw-r--r--   0 root         (0)     1003        1 2024-05-14 18:04:26.000000 bigframes-1.6.0/bigframes.egg-info/dependency_links.txt
+-rw-r--r--   0 root         (0)     1003        1 2024-05-14 18:04:26.000000 bigframes-1.6.0/bigframes.egg-info/not-zip-safe
+-rw-r--r--   0 root         (0)     1003      749 2024-05-14 18:04:26.000000 bigframes-1.6.0/bigframes.egg-info/requires.txt
+-rw-r--r--   0 root         (0)     1003       29 2024-05-14 18:04:26.000000 bigframes-1.6.0/bigframes.egg-info/top_level.txt
+-rw-rw-r--   0 root         (0)     1003       81 2024-05-14 18:01:45.000000 bigframes-1.6.0/pyproject.toml
+-rw-rw-r--   0 root         (0)     1003       67 2024-05-14 18:04:26.589626 bigframes-1.6.0/setup.cfg
+-rw-rw-r--   0 root         (0)     1003     4454 2024-05-14 18:01:45.000000 bigframes-1.6.0/setup.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.533634 bigframes-1.6.0/tests/
+-rw-rw-r--   0 root         (0)     1003      574 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/__init__.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.537634 bigframes-1.6.0/tests/data/
+-rw-rw-r--   0 root         (0)     1003      619 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/data/hockey_players.json
+-rw-rw-r--   0 root         (0)     1003     1250 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/data/hockey_players.jsonl
+-rw-rw-r--   0 root         (0)     1003      340 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/data/matrix_2by3.json
+-rw-rw-r--   0 root         (0)     1003       80 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/data/matrix_2by3.jsonl
+-rw-rw-r--   0 root         (0)     1003      421 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/data/matrix_3by4.json
+-rw-rw-r--   0 root         (0)     1003      154 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/data/matrix_3by4.jsonl
+-rw-rw-r--   0 root         (0)     1003    33350 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/data/nested.jsonl
+-rw-rw-r--   0 root         (0)     1003      966 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/data/nested_schema.json
+-rw-rw-r--   0 root         (0)     1003    58869 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/data/penguins.jsonl
+-rw-rw-r--   0 root         (0)     1003      636 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/data/penguins_schema.json
+-rw-rw-r--   0 root         (0)     1003     3909 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/data/scalars.jsonl
+-rw-rw-r--   0 root         (0)     1003     1458 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/data/scalars_schema.json
+-rw-rw-r--   0 root         (0)     1003    23424 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/data/time_series.jsonl
+-rw-rw-r--   0 root         (0)     1003      192 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/data/time_series_schema.json
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.537634 bigframes-1.6.0/tests/system/
+-rw-rw-r--   0 root         (0)     1003      574 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/__init__.py
+-rw-rw-r--   0 root         (0)     1003    37310 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/conftest.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.537634 bigframes-1.6.0/tests/system/large/
+-rw-rw-r--   0 root         (0)     1003      574 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/large/__init__.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.541633 bigframes-1.6.0/tests/system/large/ml/
+-rw-rw-r--   0 root         (0)     1003     5411 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/large/ml/test_cluster.py
+-rw-rw-r--   0 root         (0)     1003     5391 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/large/ml/test_compose.py
+-rw-rw-r--   0 root         (0)     1003     6516 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/large/ml/test_core.py
+-rw-rw-r--   0 root         (0)     1003     6487 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/large/ml/test_decomposition.py
+-rw-rw-r--   0 root         (0)     1003    14552 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/large/ml/test_ensemble.py
+-rw-rw-r--   0 root         (0)     1003     4551 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/large/ml/test_forecasting.py
+-rw-rw-r--   0 root         (0)     1003     8408 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/large/ml/test_linear_model.py
+-rw-rw-r--   0 root         (0)     1003    30564 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/large/ml/test_pipeline.py
+-rw-rw-r--   0 root         (0)     1003     4079 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/large/test_location.py
+-rw-rw-r--   0 root         (0)     1003    66919 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/large/test_remote_function.py
+-rw-rw-r--   0 root         (0)     1003     4573 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/large/test_session.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.541633 bigframes-1.6.0/tests/system/load/
+-rw-rw-r--   0 root         (0)     1003     3000 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/load/test_large_tables.py
+-rw-rw-r--   0 root         (0)     1003     4559 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/load/test_llm.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.545632 bigframes-1.6.0/tests/system/small/
+-rw-rw-r--   0 root         (0)     1003      574 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/__init__.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.545632 bigframes-1.6.0/tests/system/small/bigquery/
+-rw-rw-r--   0 root         (0)     1003      574 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/bigquery/__init__.py
+-rw-rw-r--   0 root         (0)     1003     1154 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/bigquery/test_array.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.549632 bigframes-1.6.0/tests/system/small/ml/
+-rw-rw-r--   0 root         (0)     1003      574 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/ml/__init__.py
+-rw-rw-r--   0 root         (0)     1003    11773 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/ml/conftest.py
+-rw-rw-r--   0 root         (0)     1003     7074 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/ml/test_cluster.py
+-rw-rw-r--   0 root         (0)     1003    13810 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/ml/test_core.py
+-rw-rw-r--   0 root         (0)     1003     6764 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/ml/test_decomposition.py
+-rw-rw-r--   0 root         (0)     1003    17015 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/ml/test_ensemble.py
+-rw-rw-r--   0 root         (0)     1003     6859 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/ml/test_forecasting.py
+-rw-rw-r--   0 root         (0)     1003     4983 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/ml/test_imported.py
+-rw-rw-r--   0 root         (0)     1003     8788 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/ml/test_linear_model.py
+-rw-rw-r--   0 root         (0)     1003    11929 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/ml/test_llm.py
+-rw-rw-r--   0 root         (0)     1003    25138 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/ml/test_metrics.py
+-rw-rw-r--   0 root         (0)     1003     2224 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/ml/test_metrics_pairwise.py
+-rw-rw-r--   0 root         (0)     1003     6197 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/ml/test_model_selection.py
+-rw-rw-r--   0 root         (0)     1003    29304 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/ml/test_preprocessing.py
+-rw-rw-r--   0 root         (0)     1003     2570 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/ml/test_register.py
+-rw-rw-r--   0 root         (0)     1003     1205 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/ml/test_remote.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.553631 bigframes-1.6.0/tests/system/small/operations/
+-rw-rw-r--   0 root         (0)     1003      574 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/operations/__init__.py
+-rw-rw-r--   0 root         (0)     1003    10399 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/operations/test_datetimes.py
+-rw-rw-r--   0 root         (0)     1003    12453 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/operations/test_plotting.py
+-rw-rw-r--   0 root         (0)     1003    16777 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/operations/test_strings.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.553631 bigframes-1.6.0/tests/system/small/regression/
+-rw-rw-r--   0 root         (0)     1003     1999 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/regression/test_issue355_merge_after_filter.py
+-rw-rw-r--   0 root         (0)     1003   145044 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/test_dataframe.py
+-rw-rw-r--   0 root         (0)     1003    18968 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/test_dataframe_io.py
+-rw-rw-r--   0 root         (0)     1003    10446 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/test_encryption.py
+-rw-rw-r--   0 root         (0)     1003    13974 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/test_groupby.py
+-rw-rw-r--   0 root         (0)     1003     1558 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/test_ibis.py
+-rw-rw-r--   0 root         (0)     1003    13328 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/test_index.py
+-rw-rw-r--   0 root         (0)     1003     1205 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/test_ipython.py
+-rw-rw-r--   0 root         (0)     1003    41847 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/test_multiindex.py
+-rw-rw-r--   0 root         (0)     1003     3839 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/test_numpy.py
+-rw-rw-r--   0 root         (0)     1003    19608 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/test_pandas.py
+-rw-rw-r--   0 root         (0)     1003    10842 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/test_pandas_options.py
+-rw-rw-r--   0 root         (0)     1003     5133 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/test_progress_bar.py
+-rw-rw-r--   0 root         (0)     1003    31445 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/test_remote_function.py
+-rw-rw-r--   0 root         (0)     1003      913 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/test_scalar.py
+-rw-rw-r--   0 root         (0)     1003   112970 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/test_series.py
+-rw-rw-r--   0 root         (0)     1003    41782 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/test_session.py
+-rw-rw-r--   0 root         (0)     1003     3343 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/small/test_window.py
+-rw-rw-r--   0 root         (0)     1003    12113 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/system/utils.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.553631 bigframes-1.6.0/tests/unit/
+-rw-rw-r--   0 root         (0)     1003      574 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/unit/__init__.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.557631 bigframes-1.6.0/tests/unit/_config/
+-rw-rw-r--   0 root         (0)     1003      574 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/unit/_config/__init__.py
+-rw-rw-r--   0 root         (0)     1003     4322 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/unit/_config/test_bigquery_options.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.557631 bigframes-1.6.0/tests/unit/core/
+-rw-rw-r--   0 root         (0)     1003      574 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/unit/core/__init__.py
+-rw-rw-r--   0 root         (0)     1003     1619 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/unit/core/test_bf_utils.py
+-rw-rw-r--   0 root         (0)     1003     2966 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/unit/core/test_blocks.py
+-rw-rw-r--   0 root         (0)     1003     1553 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/unit/core/test_expression.py
+-rw-rw-r--   0 root         (0)     1003     1813 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/unit/core/test_log_adapter.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.557631 bigframes-1.6.0/tests/unit/ml/
+-rw-rw-r--   0 root         (0)     1003      574 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/unit/ml/__init__.py
+-rw-rw-r--   0 root         (0)     1003     2323 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/unit/ml/test_api_primitives.py
+-rw-rw-r--   0 root         (0)     1003     6555 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/unit/ml/test_compose.py
+-rw-rw-r--   0 root         (0)     1003     7422 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/unit/ml/test_golden_sql.py
+-rw-rw-r--   0 root         (0)     1003     4058 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/unit/ml/test_pipeline.py
+-rw-rw-r--   0 root         (0)     1003    14808 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/unit/ml/test_sql.py
+-rw-rw-r--   0 root         (0)     1003     5298 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/unit/resources.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.561630 bigframes-1.6.0/tests/unit/session/
+-rw-rw-r--   0 root         (0)     1003      574 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/unit/session/__init__.py
+-rw-rw-r--   0 root         (0)     1003     4347 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/unit/session/test_clients.py
+-rw-rw-r--   0 root         (0)     1003     9959 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/unit/session/test_io_bigquery.py
+-rw-rw-r--   0 root         (0)     1003    18664 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/unit/session/test_io_pandas.py
+-rw-rw-r--   0 root         (0)     1003     1272 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/unit/session/test_read_gbq_table.py
+-rw-rw-r--   0 root         (0)     1003    13536 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/unit/session/test_session.py
+-rw-rw-r--   0 root         (0)     1003     1744 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/unit/test_clients.py
+-rw-rw-r--   0 root         (0)     1003     1056 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/unit/test_compute_options.py
+-rw-rw-r--   0 root         (0)     1003     6648 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/unit/test_core.py
+-rw-rw-r--   0 root         (0)     1003     2136 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/unit/test_dataframe.py
+-rw-rw-r--   0 root         (0)     1003     8819 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/unit/test_dtypes.py
+-rw-rw-r--   0 root         (0)     1003     1577 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/unit/test_features.py
+-rw-rw-r--   0 root         (0)     1003      528 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/unit/test_formatting_helper.py
+-rw-rw-r--   0 root         (0)     1003     1655 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/unit/test_formatting_helpers.py
+-rw-rw-r--   0 root         (0)     1003     4055 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/unit/test_pandas.py
+-rw-rw-r--   0 root         (0)     1003     1207 2024-05-14 18:01:45.000000 bigframes-1.6.0/tests/unit/test_remote_function.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.497639 bigframes-1.6.0/third_party/
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.561630 bigframes-1.6.0/third_party/bigframes_vendored/
+-rw-rw-r--   0 root         (0)     1003        0 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/__init__.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.561630 bigframes-1.6.0/third_party/bigframes_vendored/cpython/
+-rw-rw-r--   0 root         (0)     1003     2339 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/cpython/LICENSE
+-rw-rw-r--   0 root         (0)     1003        0 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/cpython/__init__.py
+-rw-rw-r--   0 root         (0)     1003    18854 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/cpython/_pprint.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.561630 bigframes-1.6.0/third_party/bigframes_vendored/google_cloud_bigquery/
+-rw-rw-r--   0 root         (0)     1003    11358 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/google_cloud_bigquery/LICENSE
+-rw-rw-r--   0 root         (0)     1003      574 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/google_cloud_bigquery/__init__.py
+-rw-rw-r--   0 root         (0)     1003     5290 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/google_cloud_bigquery/_pandas_helpers.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.561630 bigframes-1.6.0/third_party/bigframes_vendored/google_cloud_bigquery/tests/
+-rw-rw-r--   0 root         (0)     1003      574 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/google_cloud_bigquery/tests/__init__.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.561630 bigframes-1.6.0/third_party/bigframes_vendored/google_cloud_bigquery/tests/unit/
+-rw-rw-r--   0 root         (0)     1003      574 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/google_cloud_bigquery/tests/unit/__init__.py
+-rw-rw-r--   0 root         (0)     1003    14045 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/google_cloud_bigquery/tests/unit/test_pandas_helpers.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.561630 bigframes-1.6.0/third_party/bigframes_vendored/ibis/
+-rw-rw-r--   0 root         (0)     1003    11358 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/ibis/LICENSE.txt
+-rw-rw-r--   0 root         (0)     1003    11663 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/ibis/README.md
+-rw-rw-r--   0 root         (0)     1003        0 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/ibis/__init__.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.565629 bigframes-1.6.0/third_party/bigframes_vendored/ibis/backends/
+-rw-rw-r--   0 root         (0)     1003        0 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/ibis/backends/__init__.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.565629 bigframes-1.6.0/third_party/bigframes_vendored/ibis/backends/bigquery/
+-rw-rw-r--   0 root         (0)     1003      184 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/ibis/backends/bigquery/__init__.py
+-rw-rw-r--   0 root         (0)     1003     2091 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/ibis/backends/bigquery/compiler.py
+-rw-rw-r--   0 root         (0)     1003     6600 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/ibis/backends/bigquery/datatypes.py
+-rw-rw-r--   0 root         (0)     1003     1892 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/ibis/backends/bigquery/registry.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.565629 bigframes-1.6.0/third_party/bigframes_vendored/ibis/expr/
+-rw-rw-r--   0 root         (0)     1003        0 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/ibis/expr/__init__.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.565629 bigframes-1.6.0/third_party/bigframes_vendored/ibis/expr/operations/
+-rw-rw-r--   0 root         (0)     1003      464 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/ibis/expr/operations/__init__.py
+-rw-rw-r--   0 root         (0)     1003      536 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/ibis/expr/operations/analytic.py
+-rw-rw-r--   0 root         (0)     1003      276 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/ibis/expr/operations/generic.py
+-rw-rw-r--   0 root         (0)     1003      263 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/ibis/expr/operations/json.py
+-rw-rw-r--   0 root         (0)     1003      690 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/ibis/expr/operations/reductions.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.565629 bigframes-1.6.0/third_party/bigframes_vendored/pandas/
+-rw-rw-r--   0 root         (0)     1003     2284 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/AUTHORS.md
+-rw-rw-r--   0 root         (0)     1003     1634 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/LICENSE
+-rw-rw-r--   0 root         (0)     1003    10620 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/README.md
+-rw-rw-r--   0 root         (0)     1003        0 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/__init__.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.565629 bigframes-1.6.0/third_party/bigframes_vendored/pandas/_config/
+-rw-rw-r--   0 root         (0)     1003     2352 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/_config/config.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.569629 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.569629 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/arrays/
+-rw-rw-r--   0 root         (0)     1003        0 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/arrays/__init__.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.569629 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/arrays/arrow/
+-rw-rw-r--   0 root         (0)     1003        0 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/arrays/arrow/__init__.py
+-rw-rw-r--   0 root         (0)     1003     3831 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/arrays/arrow/accessors.py
+-rw-rw-r--   0 root         (0)     1003     3689 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/arrays/datetimelike.py
+-rw-rw-r--   0 root         (0)     1003     2086 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/common.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.573628 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/computation/
+-rw-rw-r--   0 root         (0)     1003     6944 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/computation/align.py
+-rw-rw-r--   0 root         (0)     1003     1543 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/computation/common.py
+-rw-rw-r--   0 root         (0)     1003     2295 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/computation/engines.py
+-rw-rw-r--   0 root         (0)     1003    12685 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/computation/eval.py
+-rw-rw-r--   0 root         (0)     1003    25132 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/computation/expr.py
+-rw-rw-r--   0 root         (0)     1003    16244 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/computation/ops.py
+-rw-rw-r--   0 root         (0)     1003     6477 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/computation/parsing.py
+-rw-rw-r--   0 root         (0)     1003    10303 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/computation/scope.py
+-rw-rw-r--   0 root         (0)     1003     4394 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/config_init.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.573628 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/dtypes/
+-rw-rw-r--   0 root         (0)     1003      707 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/dtypes/inference.py
+-rw-rw-r--   0 root         (0)     1003   229081 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/frame.py
+-rw-rw-r--   0 root         (0)     1003    40215 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/generic.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.573628 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/groupby/
+-rw-rw-r--   0 root         (0)     1003    14023 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/groupby/__init__.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.573628 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/indexes/
+-rw-rw-r--   0 root         (0)     1003        0 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/indexes/__init__.py
+-rw-rw-r--   0 root         (0)     1003     9589 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/indexes/accessor.py
+-rw-rw-r--   0 root         (0)     1003    11461 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/indexes/base.py
+-rw-rw-r--   0 root         (0)     1003     2941 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/indexes/multi.py
+-rw-rw-r--   0 root         (0)     1003     2909 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/indexing.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.573628 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/reshape/
+-rw-rw-r--   0 root         (0)     1003        0 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/reshape/__init__.py
+-rw-rw-r--   0 root         (0)     1003     4372 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/reshape/concat.py
+-rw-rw-r--   0 root         (0)     1003     3804 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/reshape/encoding.py
+-rw-rw-r--   0 root         (0)     1003     3220 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/reshape/merge.py
+-rw-rw-r--   0 root         (0)     1003     5844 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/reshape/tile.py
+-rw-rw-r--   0 root         (0)     1003   134990 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/series.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.573628 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/strings/
+-rw-rw-r--   0 root         (0)     1003    39467 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/strings/accessor.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.577628 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/tools/
+-rw-rw-r--   0 root         (0)     1003        0 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/tools/__init__.py
+-rw-rw-r--   0 root         (0)     1003     2964 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/tools/datetimes.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.577628 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/window/
+-rw-rw-r--   0 root         (0)     1003        0 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/window/__init__.py
+-rw-rw-r--   0 root         (0)     1003     1350 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/window/rolling.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.577628 bigframes-1.6.0/third_party/bigframes_vendored/pandas/io/
+-rw-rw-r--   0 root         (0)     1003        0 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/io/__init__.py
+-rw-rw-r--   0 root         (0)     1003     1269 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/io/common.py
+-rw-rw-r--   0 root         (0)     1003     8092 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/io/gbq.py
+-rw-rw-r--   0 root         (0)     1003     1654 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/io/parquet.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.577628 bigframes-1.6.0/third_party/bigframes_vendored/pandas/io/parsers/
+-rw-rw-r--   0 root         (0)     1003        0 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/io/parsers/__init__.py
+-rw-rw-r--   0 root         (0)     1003    11153 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/io/parsers/readers.py
+-rw-rw-r--   0 root         (0)     1003     3329 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/io/pickle.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.577628 bigframes-1.6.0/third_party/bigframes_vendored/pandas/pandas/
+-rw-rw-r--   0 root         (0)     1003    12353 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/pandas/_typing.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.577628 bigframes-1.6.0/third_party/bigframes_vendored/pandas/plotting/
+-rw-rw-r--   0 root         (0)     1003    11460 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/plotting/_core.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.577628 bigframes-1.6.0/third_party/bigframes_vendored/pandas/util/
+-rw-rw-r--   0 root         (0)     1003      765 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/util/_exceptions.py
+-rw-rw-r--   0 root         (0)     1003     1573 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/pandas/util/_validators.py
+-rw-rw-r--   0 root         (0)     1003        0 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/py.typed
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.581627 bigframes-1.6.0/third_party/bigframes_vendored/sklearn/
+-rw-rw-r--   0 root         (0)     1003     1532 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/sklearn/COPYING
+-rw-rw-r--   0 root         (0)     1003        0 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/sklearn/__init__.py
+-rw-rw-r--   0 root         (0)     1003     6212 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/sklearn/base.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.581627 bigframes-1.6.0/third_party/bigframes_vendored/sklearn/cluster/
+-rw-rw-r--   0 root         (0)     1003     5924 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/sklearn/cluster/_kmeans.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.581627 bigframes-1.6.0/third_party/bigframes_vendored/sklearn/compose/
+-rw-rw-r--   0 root         (0)     1003     2014 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/sklearn/compose/_column_transformer.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.581627 bigframes-1.6.0/third_party/bigframes_vendored/sklearn/decomposition/
+-rw-rw-r--   0 root         (0)     1003     5387 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/sklearn/decomposition/_pca.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.581627 bigframes-1.6.0/third_party/bigframes_vendored/sklearn/ensemble/
+-rw-rw-r--   0 root         (0)     1003        0 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/sklearn/ensemble/__init__.py
+-rw-rw-r--   0 root         (0)     1003     8977 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/sklearn/ensemble/_forest.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.581627 bigframes-1.6.0/third_party/bigframes_vendored/sklearn/linear_model/
+-rw-rw-r--   0 root         (0)     1003     5417 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/sklearn/linear_model/_base.py
+-rw-rw-r--   0 root         (0)     1003     4348 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/sklearn/linear_model/_logistic.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.581627 bigframes-1.6.0/third_party/bigframes_vendored/sklearn/metrics/
+-rw-rw-r--   0 root         (0)     1003     9783 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/sklearn/metrics/_classification.py
+-rw-rw-r--   0 root         (0)     1003     6347 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/sklearn/metrics/_ranking.py
+-rw-rw-r--   0 root         (0)     1003     3550 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/sklearn/metrics/_regression.py
+-rw-rw-r--   0 root         (0)     1003     2124 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/sklearn/metrics/pairwise.py
+-rw-rw-r--   0 root         (0)     1003     2977 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/sklearn/pipeline.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.581627 bigframes-1.6.0/third_party/bigframes_vendored/sklearn/preprocessing/
+-rw-rw-r--   0 root         (0)     1003     4980 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/sklearn/preprocessing/_data.py
+-rw-rw-r--   0 root         (0)     1003     1494 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/sklearn/preprocessing/_discretization.py
+-rw-rw-r--   0 root         (0)     1003     4059 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/sklearn/preprocessing/_encoder.py
+-rw-rw-r--   0 root         (0)     1003     2085 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/sklearn/preprocessing/_label.py
+drwxr-sr-x   0 root         (0)     1003        0 2024-05-14 18:04:26.585627 bigframes-1.6.0/third_party/bigframes_vendored/xgboost/
+-rw-rw-r--   0 root         (0)     1003    11348 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/xgboost/LICENSE
+-rw-rw-r--   0 root         (0)     1003        0 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/xgboost/__init__.py
+-rw-rw-r--   0 root         (0)     1003     6919 2024-05-14 18:01:45.000000 bigframes-1.6.0/third_party/bigframes_vendored/xgboost/sklearn.py
```

### Comparing `bigframes-1.5.0/LICENSE` & `bigframes-1.6.0/LICENSE`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/MANIFEST.in` & `bigframes-1.6.0/MANIFEST.in`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/PKG-INFO` & `bigframes-1.6.0/PKG-INFO`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: bigframes
-Version: 1.5.0
+Version: 1.6.0
 Summary: BigQuery DataFrames -- scalable analytics and machine learning with BigQuery
 Home-page: https://github.com/googleapis/python-bigquery-dataframes
 Author: Google LLC
 Author-email: bigframes-feedback@google.com
 License: Apache 2.0
 Platform: Posix; MacOS X; Windows
 Classifier: Development Status :: 5 - Production/Stable
@@ -28,14 +28,15 @@
 Requires-Dist: google-cloud-bigquery[bqstorage,pandas]>=3.16.0
 Requires-Dist: google-cloud-functions>=1.12.0
 Requires-Dist: google-cloud-bigquery-connection>=1.12.0
 Requires-Dist: google-cloud-iam>=2.12.1
 Requires-Dist: google-cloud-resource-manager>=1.10.3
 Requires-Dist: google-cloud-storage>=2.0.0
 Requires-Dist: ibis-framework[bigquery]<9.0.0dev,>=8.0.0
+Requires-Dist: jellyfish>=0.8.9
 Requires-Dist: pandas>=1.5.0
 Requires-Dist: pyarrow>=8.0.0
 Requires-Dist: pydata-google-auth>=1.8.2
 Requires-Dist: requests>=2.27.1
 Requires-Dist: scikit-learn>=1.2.2
 Requires-Dist: sqlalchemy<3.0dev,>=1.4
 Requires-Dist: sqlglot<=20.11,>=20.8.0
```

### Comparing `bigframes-1.5.0/README.rst` & `bigframes-1.6.0/README.rst`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/__init__.py` & `bigframes-1.6.0/bigframes/__init__.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/_config/__init__.py` & `bigframes-1.6.0/bigframes/_config/__init__.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/_config/bigquery_options.py` & `bigframes-1.6.0/bigframes/_config/bigquery_options.py`

 * *Files 6% similar despite different names*

```diff
@@ -17,34 +17,41 @@
 from __future__ import annotations
 
 from typing import Optional
 import warnings
 
 import google.api_core.exceptions
 import google.auth.credentials
+import jellyfish
 
 import bigframes.constants
 import bigframes.exceptions
 
 SESSION_STARTED_MESSAGE = (
     "Cannot change '{attribute}' once a session has started. "
     "Call bigframes.pandas.close_session() first, if you are using the bigframes.pandas API."
 )
 
-UNKNOWN_LOCATION_MESSAGE = "The location '{location}' is set to an unknown value."
+
+UNKNOWN_LOCATION_MESSAGE = "The location '{location}' is set to an unknown value. Did you mean '{possibility}'?"
 
 
 def _validate_location(value: Optional[str]):
 
     if value is None:
         return
 
     if value not in bigframes.constants.ALL_BIGQUERY_LOCATIONS:
+        location = str(value)
+        possibility = min(
+            bigframes.constants.ALL_BIGQUERY_LOCATIONS,
+            key=lambda item: jellyfish.levenshtein_distance(location, item),
+        )
         warnings.warn(
-            UNKNOWN_LOCATION_MESSAGE.format(location=value),
+            UNKNOWN_LOCATION_MESSAGE.format(location=location, possibility=possibility),
             # There are many layers before we get to (possibly) the user's code:
             # -> bpd.options.bigquery.location = "us-central-1"
             # -> location.setter
             # -> _validate_location
             stacklevel=3,
             category=bigframes.exceptions.UnknownLocationWarning,
         )
```

### Comparing `bigframes-1.5.0/bigframes/_config/compute_options.py` & `bigframes-1.6.0/bigframes/_config/compute_options.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/_config/display_options.py` & `bigframes-1.6.0/bigframes/_config/display_options.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/_config/sampling_options.py` & `bigframes-1.6.0/bigframes/_config/sampling_options.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/bigquery/__init__.py` & `bigframes-1.6.0/bigframes/bigquery/__init__.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/clients.py` & `bigframes-1.6.0/bigframes/clients.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/constants.py` & `bigframes-1.6.0/bigframes/constants.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/core/__init__.py` & `bigframes-1.6.0/bigframes/core/__init__.py`

 * *Files 0% similar despite different names*

```diff
@@ -12,14 +12,15 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 from __future__ import annotations
 
 from dataclasses import dataclass
 import functools
 import io
+import itertools
 import typing
 from typing import Iterable, Sequence
 
 import ibis.expr.types as ibis_types
 import pandas
 import pyarrow as pa
 import pyarrow.feather as pa_feather
@@ -366,22 +367,24 @@
 
         # Build the output rows as a case statment that selects between the N input columns
         unpivot_exprs = []
         # Supports producing multiple stacked ouput columns for stacking only part of hierarchical index
         for col_id, input_ids in unpivot_columns:
             # row explode offset used to choose the input column
             # we use offset instead of label as labels are not necessarily unique
-            cases = tuple(
-                (
-                    ops.eq_op.as_expr(explode_offsets_id, ex.const(i)),
-                    ex.free_var(id_or_null)
-                    if (id_or_null is not None)
-                    else ex.const(None),
+            cases = itertools.chain(
+                *(
+                    (
+                        ops.eq_op.as_expr(explode_offsets_id, ex.const(i)),
+                        ex.free_var(id_or_null)
+                        if (id_or_null is not None)
+                        else ex.const(None),
+                    )
+                    for i, id_or_null in enumerate(input_ids)
                 )
-                for i, id_or_null in enumerate(input_ids)
             )
             col_expr = ops.case_when_op.as_expr(*cases)
             unpivot_exprs.append((col_expr, col_id))
 
         label_exprs = ((ex.free_var(id), id) for id in index_col_ids)
         # passthrough columns are unchanged, just repeated N times each
         passthrough_exprs = ((ex.free_var(id), id) for id in passthrough_columns)
```

### Comparing `bigframes-1.5.0/bigframes/core/block_transforms.py` & `bigframes-1.6.0/bigframes/core/block_transforms.py`

 * *Files 2% similar despite different names*

```diff
@@ -67,29 +67,27 @@
     """Create a boolean column where True indicates a duplicate value"""
     if keep not in ["first", "last", False]:
         raise ValueError("keep must be one of 'first', 'last', or False'")
 
     if keep == "first":
         # Count how many copies occur up to current copy of value
         # Discard this value if there are copies BEFORE
-        window_spec = windows.WindowSpec(
+        window_spec = windows.cumulative_rows(
             grouping_keys=tuple(columns),
-            following=0,
         )
     elif keep == "last":
         # Count how many copies occur up to current copy of values
         # Discard this value if there are copies AFTER
-        window_spec = windows.WindowSpec(
+        window_spec = windows.inverse_cumulative_rows(
             grouping_keys=tuple(columns),
-            preceding=0,
         )
     else:  # keep == False
         # Count how many copies of the value occur in entire series.
         # Discard this value if there are copies ANYWHERE
-        window_spec = windows.WindowSpec(grouping_keys=tuple(columns))
+        window_spec = windows.unbound(grouping_keys=tuple(columns))
     block, dummy = block.create_constant(1)
     block, val_count_col_id = block.apply_window_op(
         dummy,
         agg_ops.count_op,
         window_spec=window_spec,
     )
     block, duplicate_indicator = block.project_expr(
@@ -110,15 +108,15 @@
     block: blocks.Block,
     columns: Sequence[str],
     qs: Sequence[float],
     grouping_column_ids: Sequence[str] = (),
     dropna: bool = False,
 ) -> blocks.Block:
     # TODO: handle windowing and more interpolation methods
-    window = core.WindowSpec(
+    window = windows.unbound(
         grouping_keys=tuple(grouping_column_ids),
     )
     quantile_cols = []
     labels = []
     if len(columns) * len(qs) > constants.MAX_COLUMNS:
         raise NotImplementedError("Too many aggregates requested.")
     for col in columns:
@@ -208,16 +206,16 @@
     x_values: str,
     interpolate_method: str,
     do_extrapolate: bool = True,
 ) -> typing.Tuple[blocks.Block, str]:
     if interpolate_method not in ["linear", "nearest", "ffill"]:
         raise ValueError("interpolate method not supported")
     window_ordering = (ordering.OrderingExpression(ex.free_var(x_values)),)
-    backwards_window = windows.WindowSpec(following=0, ordering=window_ordering)
-    forwards_window = windows.WindowSpec(preceding=0, ordering=window_ordering)
+    backwards_window = windows.rows(following=0, ordering=window_ordering)
+    forwards_window = windows.rows(preceding=0, ordering=window_ordering)
 
     # Note, this method may
     block, notnull = block.apply_unary_op(column, ops.notnull_op)
     block, masked_offsets = block.project_expr(
         ops.where_op.as_expr(x_values, notnull, ex.const(None))
     )
 
@@ -360,15 +358,15 @@
     block, agg_ids = block.aggregate(
         by_column_ids=columns,
         aggregations=[(dummy, agg_ops.count_op)],
         dropna=dropna,
     )
     count_id = agg_ids[0]
     if normalize:
-        unbound_window = windows.WindowSpec()
+        unbound_window = windows.unbound()
         block, total_count_id = block.apply_window_op(
             count_id, agg_ops.sum_op, unbound_window
         )
         block, count_id = block.apply_binary_op(count_id, total_count_id, ops.div_op)
 
     if sort:
         block = block.order_by(
@@ -384,15 +382,15 @@
     return block.select_column(count_id).with_column_labels(
         ["proportion" if normalize else "count"]
     )
 
 
 def pct_change(block: blocks.Block, periods: int = 1) -> blocks.Block:
     column_labels = block.column_labels
-    window_spec = windows.WindowSpec(
+    window_spec = windows.rows(
         preceding=periods if periods > 0 else None,
         following=-periods if periods < 0 else None,
     )
 
     original_columns = block.value_columns
     block, shift_columns = block.multi_apply_window_op(
         original_columns, agg_ops.ShiftOp(periods), window_spec=window_spec
@@ -426,31 +424,30 @@
     nullity_col_ids = []
     for col in columns:
         block, nullity_col_id = block.apply_unary_op(
             col,
             ops.isnull_op,
         )
         nullity_col_ids.append(nullity_col_id)
-        window = windows.WindowSpec(
-            # BigQuery has syntax to reorder nulls with "NULLS FIRST/LAST", but that is unavailable through ibis presently, so must order on a separate nullity expression first.
-            ordering=(
-                ordering.OrderingExpression(
-                    ex.free_var(col),
-                    ordering.OrderingDirection.ASC
-                    if ascending
-                    else ordering.OrderingDirection.DESC,
-                    na_last=(na_option in ["bottom", "keep"]),
-                ),
+        window_ordering = (
+            ordering.OrderingExpression(
+                ex.free_var(col),
+                ordering.OrderingDirection.ASC
+                if ascending
+                else ordering.OrderingDirection.DESC,
+                na_last=(na_option in ["bottom", "keep"]),
             ),
         )
         # Count_op ignores nulls, so if na_option is "top" or "bottom", we instead count the nullity columns, where nulls have been mapped to bools
         block, rownum_id = block.apply_window_op(
             col if na_option == "keep" else nullity_col_id,
             agg_ops.dense_rank_op if method == "dense" else agg_ops.count_op,
-            window_spec=window,
+            window_spec=windows.unbound(ordering=window_ordering)
+            if method == "dense"
+            else windows.rows(following=0, ordering=window_ordering),
             skip_reproject_unsafe=(col != columns[-1]),
         )
         rownum_col_ids.append(rownum_id)
 
     # Step 2: Apply aggregate to groups of like input values.
     # This step is skipped for method=='first' or 'dense'
     if method in ["average", "min", "max"]:
@@ -460,15 +457,15 @@
             "max": agg_ops.max_op,
         }[method]
         post_agg_rownum_col_ids = []
         for i in range(len(columns)):
             block, result_id = block.apply_window_op(
                 rownum_col_ids[i],
                 agg_op,
-                window_spec=windows.WindowSpec(grouping_keys=(columns[i],)),
+                window_spec=windows.unbound(grouping_keys=(columns[i],)),
                 skip_reproject_unsafe=(i < (len(columns) - 1)),
             )
             post_agg_rownum_col_ids.append(result_id)
         rownum_col_ids = post_agg_rownum_col_ids
 
     # Step 3: post processing: mask null values and cast to float
     if method in ["min", "max", "first", "dense"]:
@@ -524,15 +521,15 @@
     block = block.order_by(order_refs)
     if keep in ("first", "last"):
         return block.slice(0, n)
     else:  # keep == "all":
         block, counter = block.apply_window_op(
             column_ids[0],
             agg_ops.rank_op,
-            window_spec=windows.WindowSpec(ordering=tuple(order_refs)),
+            window_spec=windows.unbound(ordering=tuple(order_refs)),
         )
         block, condition = block.project_expr(ops.le_op.as_expr(counter, ex.const(n)))
         block = block.filter_by_id(condition)
         return block.drop_columns([counter, condition])
 
 
 def nlargest(
@@ -554,15 +551,15 @@
     block = block.order_by(order_refs)
     if keep in ("first", "last"):
         return block.slice(0, n)
     else:  # keep == "all":
         block, counter = block.apply_window_op(
             column_ids[0],
             agg_ops.rank_op,
-            window_spec=windows.WindowSpec(ordering=tuple(order_refs)),
+            window_spec=windows.unbound(ordering=tuple(order_refs)),
         )
         block, condition = block.project_expr(ops.le_op.as_expr(counter, ex.const(n)))
         block = block.filter_by_id(condition)
         return block.drop_columns([counter, condition])
 
 
 def skew(
@@ -649,15 +646,15 @@
 def _mean_delta_to_power(
     block: blocks.Block,
     n_power: int,
     column_ids: typing.Sequence[str],
     grouping_column_ids: typing.Sequence[str],
 ) -> typing.Tuple[blocks.Block, typing.Sequence[str]]:
     """Calculate (x-mean(x))^n. Useful for calculating moment statistics such as skew and kurtosis."""
-    window = windows.WindowSpec(grouping_keys=tuple(grouping_column_ids))
+    window = windows.unbound(grouping_keys=tuple(grouping_column_ids))
     block, mean_ids = block.multi_apply_window_op(column_ids, agg_ops.mean_op, window)
     delta_ids = []
     for val_id, mean_val_id in zip(column_ids, mean_ids):
         delta = ops.sub_op.as_expr(val_id, mean_val_id)
         delta_power = ops.pow_op.as_expr(delta, ex.const(n_power))
         block, delta_power_id = block.project_expr(delta_power)
         delta_ids.append(delta_power_id)
@@ -841,15 +838,15 @@
         order_refs = [
             ordering.OrderingExpression(ex.free_var(value_col), direction),
             *[
                 ordering.OrderingExpression(ex.free_var(idx_col))
                 for idx_col in original_block.index_columns
             ],
         ]
-        window_spec = windows.WindowSpec(ordering=tuple(order_refs))
+        window_spec = windows.unbound(ordering=tuple(order_refs))
         idx_col = original_block.index_columns[0]
         block, result_col = block.apply_window_op(
             idx_col, agg_ops.first_op, window_spec
         )
         result_cols.append(result_col)
 
     block = block.select_columns(result_cols).with_column_labels(
```

### Comparing `bigframes-1.5.0/bigframes/core/blocks.py` & `bigframes-1.6.0/bigframes/core/blocks.py`

 * *Files 2% similar despite different names*

```diff
@@ -17,19 +17,21 @@
 These data structures are shared by DataFrame and Series. This allows views to
 link in both directions (DataFrame to Series and vice versa) and prevents
 circular dependencies.
 """
 
 from __future__ import annotations
 
+import ast
 import dataclasses
 import functools
 import itertools
 import os
 import random
+import textwrap
 import typing
 from typing import Iterable, List, Literal, Mapping, Optional, Sequence, Tuple, Union
 import warnings
 
 import google.cloud.bigquery as bigquery
 import pandas as pd
 import pyarrow as pa
@@ -40,17 +42,18 @@
 import bigframes.core as core
 import bigframes.core.expression as ex
 import bigframes.core.expression as scalars
 import bigframes.core.guid as guid
 import bigframes.core.join_def as join_defs
 import bigframes.core.ordering as ordering
 import bigframes.core.schema as bf_schema
+import bigframes.core.sql as sql
 import bigframes.core.tree_properties as tree_properties
-import bigframes.core.utils
 import bigframes.core.utils as utils
+import bigframes.core.window_spec as window_specs
 import bigframes.dtypes
 import bigframes.features
 import bigframes.operations as ops
 import bigframes.operations.aggregations as agg_ops
 import bigframes.session._io.pandas
 
 # Type constraint for wherever column labels are used
@@ -799,19 +802,28 @@
         col_id_3: str,
         op: ops.TernaryOp,
         result_label: Label = None,
     ) -> typing.Tuple[Block, str]:
         expr = op.as_expr(col_id_1, col_id_2, col_id_3)
         return self.project_expr(expr, result_label)
 
+    def apply_nary_op(
+        self,
+        columns: Iterable[str],
+        op: ops.NaryOp,
+        result_label: Label = None,
+    ) -> typing.Tuple[Block, str]:
+        expr = op.as_expr(*columns)
+        return self.project_expr(expr, result_label)
+
     def multi_apply_window_op(
         self,
         columns: typing.Sequence[str],
         op: agg_ops.WindowOp,
-        window_spec: core.WindowSpec,
+        window_spec: window_specs.WindowSpec,
         *,
         skip_null_groups: bool = False,
         never_skip_nulls: bool = False,
     ) -> typing.Tuple[Block, typing.Sequence[str]]:
         block = self
         result_ids = []
         for i, col_id in enumerate(columns):
@@ -862,15 +874,15 @@
             block = block.with_transpose_cache(new_transpose_cache)
         return block
 
     def apply_window_op(
         self,
         column: str,
         op: agg_ops.WindowOp,
-        window_spec: core.WindowSpec,
+        window_spec: window_specs.WindowSpec,
         *,
         result_label: Label = None,
         skip_null_groups: bool = False,
         skip_reproject_unsafe: bool = False,
         never_skip_nulls: bool = False,
     ) -> typing.Tuple[Block, str]:
         block = self
@@ -1423,17 +1435,15 @@
                 column_labels=self.column_labels.insert(0, label),
                 index_labels=self._index_labels,
             ),
             result_id,
         )
 
     def add_prefix(self, prefix: str, axis: str | int | None = None) -> Block:
-        axis_number = bigframes.core.utils.get_axis_number(
-            "rows" if (axis is None) else axis
-        )
+        axis_number = utils.get_axis_number("rows" if (axis is None) else axis)
         if axis_number == 0:
             expr = self._expr
             for index_col in self._index_columns:
                 expr = expr.project_to_id(
                     expression=ops.add_op.as_expr(
                         ex.const(prefix),
                         ops.AsTypeOp(to_type="string").as_expr(index_col),
@@ -1446,17 +1456,15 @@
                 column_labels=self.column_labels,
                 index_labels=self.index.names,
             )
         if axis_number == 1:
             return self.rename(columns=lambda label: f"{prefix}{label}")
 
     def add_suffix(self, suffix: str, axis: str | int | None = None) -> Block:
-        axis_number = bigframes.core.utils.get_axis_number(
-            "rows" if (axis is None) else axis
-        )
+        axis_number = utils.get_axis_number("rows" if (axis is None) else axis)
         if axis_number == 0:
             expr = self._expr
             for index_col in self._index_columns:
                 expr = expr.project_to_id(
                     expression=ops.add_op.as_expr(
                         ops.AsTypeOp(to_type="string").as_expr(index_col),
                         ex.const(suffix),
@@ -2016,15 +2024,15 @@
         op_name = _MONOTONIC_INCREASING if increasing else _MONOTONIC_DECREASING
 
         column_name = " ".join(column_ids)
         if op_name in self._stats_cache[column_name]:
             return self._stats_cache[column_name][op_name]
 
         period = 1
-        window = bigframes.core.WindowSpec(
+        window = window_specs.rows(
             preceding=period,
             following=None,
         )
 
         # any NaN value means not monotonic
         block, last_notna_id = self.apply_unary_op(column_ids[0], ops.notnull_op)
         for column_id in column_ids[1:]:
@@ -2058,14 +2066,103 @@
         block, monotonic_result_id = block.apply_binary_op(
             last_result_id, last_notna_id, ops.and_op  # type: ignore
         )
         result = block.get_stat(monotonic_result_id, agg_ops.all_op)
         self._stats_cache[column_name].update({op_name: result})
         return result
 
+    def _get_rows_as_json_values(self) -> Block:
+        # We want to preserve any ordering currently present before turning to
+        # direct SQL manipulation. We will restore the ordering when we rebuild
+        # expression.
+        # TODO(shobs): Replace direct SQL manipulation by structured expression
+        # manipulation
+        ordering_column_name = guid.generate_guid()
+        expr = self.session._cache_with_offsets(self.expr)
+        expr = expr.promote_offsets(ordering_column_name)
+        expr_sql = self.session._to_sql(expr)
+
+        # Names of the columns to serialize for the row.
+        # We will use the repr-eval pattern to serialize a value here and
+        # deserialize in the cloud function. Let's make sure that would work.
+        column_names = []
+        for col in list(self.index_columns) + [col for col in self.column_labels]:
+            serialized_column_name = repr(col)
+            try:
+                ast.literal_eval(serialized_column_name)
+            except Exception:
+                raise NameError(
+                    f"Column name type '{type(col).__name__}' is not supported for row serialization."
+                    " Please consider using a name for which literal_eval(repr(name)) works."
+                )
+
+            column_names.append(serialized_column_name)
+        column_names_csv = sql.csv(column_names, quoted=True)
+
+        # index columns count
+        index_columns_count = len(self.index_columns)
+
+        # column references to form the array of values for the row
+        column_references_csv = sql.csv(
+            [sql.cast_as_string(col) for col in self.expr.column_ids]
+        )
+
+        # types of the columns to serialize for the row
+        column_types = list(self.index.dtypes) + list(self.dtypes)
+        column_types_csv = sql.csv([str(typ) for typ in column_types], quoted=True)
+
+        # row dtype to use for deserializing the row as pandas series
+        pandas_row_dtype = bigframes.dtypes.lcd_type(*column_types)
+        if pandas_row_dtype is None:
+            pandas_row_dtype = "object"
+        pandas_row_dtype = sql.quote(str(pandas_row_dtype))
+
+        # create a json column representing row through SQL manipulation
+        row_json_column_name = guid.generate_guid()
+        select_columns = (
+            [ordering_column_name] + list(self.index_columns) + [row_json_column_name]
+        )
+        select_columns_csv = sql.csv(
+            [sql.column_reference(col) for col in select_columns]
+        )
+        json_sql = f"""\
+With T0 AS (
+{textwrap.indent(expr_sql, "    ")}
+),
+T1 AS (
+    SELECT *,
+           JSON_OBJECT(
+               "names", [{column_names_csv}],
+               "types", [{column_types_csv}],
+               "values", [{column_references_csv}],
+               "indexlength", {index_columns_count},
+               "dtype", {pandas_row_dtype}
+           ) AS {row_json_column_name} FROM T0
+)
+SELECT {select_columns_csv} FROM T1
+"""
+        ibis_table = self.session.ibis_client.sql(json_sql)
+        order_for_ibis_table = ordering.ExpressionOrdering.from_offset_col(
+            ordering_column_name
+        )
+        expr = core.ArrayValue.from_ibis(
+            self.session,
+            ibis_table,
+            [ibis_table[col] for col in select_columns if col != ordering_column_name],
+            hidden_ordering_columns=[ibis_table[ordering_column_name]],
+            ordering=order_for_ibis_table,
+        )
+        block = Block(
+            expr,
+            index_columns=self.index_columns,
+            column_labels=[row_json_column_name],
+            index_labels=self._index_labels,
+        )
+        return block
+
 
 class BlockIndexProperties:
     """Accessor for the index-related block properties."""
 
     def __init__(self, block: Block):
         self._block = block
```

### Comparing `bigframes-1.5.0/bigframes/core/compile/__init__.py` & `bigframes-1.6.0/bigframes/core/compile/__init__.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/core/compile/aggregate_compiler.py` & `bigframes-1.6.0/bigframes/core/compile/aggregate_compiler.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/core/compile/compiled.py` & `bigframes-1.6.0/bigframes/core/compile/compiled.py`

 * *Files 2% similar despite different names*

```diff
@@ -36,15 +36,15 @@
     ascending_over,
     encode_order_string,
     ExpressionOrdering,
     IntegerEncoding,
     OrderingExpression,
 )
 import bigframes.core.schema as schemata
-from bigframes.core.window_spec import WindowSpec
+from bigframes.core.window_spec import RangeWindowBounds, RowsWindowBounds, WindowSpec
 import bigframes.dtypes
 import bigframes.operations.aggregations as agg_ops
 
 ORDER_ID_COLUMN = "bigframes_ordering_id"
 PREDICATE_COLUMN = "bigframes_predicate"
 
 
@@ -731,15 +731,17 @@
         op: the windowable operator to apply to the input column
         window_spec: a specification of the window over which to apply the operator
         output_name: the id to assign to the output of the operator, by default will replace input col if distinct output id not provided
         never_skip_nulls: will disable null skipping for operators that would otherwise do so
         skip_reproject_unsafe: skips the reprojection step, can be used when performing many non-dependent window operations, user responsible for not nesting window expressions, or using outputs as join, filter or aggregation keys before a reprojection
         """
         column = typing.cast(ibis_types.Column, self._get_ibis_column(column_name))
-        window = self._ibis_window_from_spec(window_spec, allow_ties=op.handles_ties)
+        window = self._ibis_window_from_spec(
+            window_spec, require_total_order=op.uses_total_row_ordering
+        )
         bindings = {col: self._get_ibis_column(col) for col in self.column_ids}
 
         window_op = agg_compiler.compile_analytic(
             ex.UnaryAggregation(op, ex.free_var(column_name)), window, bindings=bindings
         )
 
         clauses = []
@@ -1158,47 +1160,63 @@
                 ibis_types.IntegerColumn, ibis.row_number().over(window)
             )
             return encode_order_string(row_nums)
 
     def _compile_expression(self, expr: ex.Expression):
         return op_compiler.compile_expression(expr, self._ibis_bindings)
 
-    def _ibis_window_from_spec(self, window_spec: WindowSpec, allow_ties: bool = False):
+    def _ibis_window_from_spec(
+        self, window_spec: WindowSpec, require_total_order: bool
+    ):
         group_by: typing.List[ibis_types.Value] = (
             [
                 typing.cast(
                     ibis_types.Column, _as_identity(self._get_ibis_column(column))
                 )
                 for column in window_spec.grouping_keys
             ]
             if window_spec.grouping_keys
             else []
         )
         if self._reduced_predicate is not None:
             group_by.append(self._reduced_predicate)
+
+        # Construct ordering. There are basically 3 main cases
+        # 1. Order-independent op (aggregation, cut, rank) with unbound window - no ordering clause needed
+        # 2. Order-independent op (aggregation, cut, rank) with range window - use ordering clause, ties allowed
+        # 3. Order-depedenpent op (navigation functions, array_agg) or rows bounds - use total row order to break ties.
         if window_spec.ordering:
             order_by = _convert_ordering_to_table_values(
                 {**self._column_names, **self._hidden_ordering_column_names},
                 window_spec.ordering,
             )
-            if not allow_ties:
-                # Most operator need an unambiguous ordering, so the table's total ordering is appended
+            if require_total_order or isinstance(window_spec.bounds, RowsWindowBounds):
+                # Some operators need an unambiguous ordering, so the table's total ordering is appended
                 order_by = tuple([*order_by, *self._ibis_order])
-        elif (window_spec.following is not None) or (window_spec.preceding is not None):
+        elif isinstance(window_spec.bounds, RowsWindowBounds):
             # If window spec has following or preceding bounds, we need to apply an unambiguous ordering.
             order_by = tuple(self._ibis_order)
         else:
             # Unbound grouping window. Suitable for aggregations but not for analytic function application.
             order_by = None
-        return ibis.window(
-            preceding=window_spec.preceding,
-            following=window_spec.following,
-            order_by=order_by,
-            group_by=group_by,
-        )
+
+        bounds = window_spec.bounds
+        window = ibis.window(order_by=order_by, group_by=group_by)
+        if bounds is not None:
+            if isinstance(bounds, RangeWindowBounds):
+                window = window.preceding_following(
+                    bounds.preceding, bounds.following, how="range"
+                )
+            if isinstance(bounds, RowsWindowBounds):
+                window = window.preceding_following(
+                    bounds.preceding, bounds.following, how="rows"
+                )
+            else:
+                raise ValueError(f"unrecognized window bounds {bounds}")
+        return window
 
     class Builder:
         def __init__(
             self,
             table: ibis_types.Table,
             ordering: ExpressionOrdering,
             columns: Collection[ibis_types.Value] = (),
```

### Comparing `bigframes-1.5.0/bigframes/core/compile/compiler.py` & `bigframes-1.6.0/bigframes/core/compile/compiler.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/core/compile/concat.py` & `bigframes-1.6.0/bigframes/core/compile/concat.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/core/compile/scalar_op_compiler.py` & `bigframes-1.6.0/bigframes/core/compile/scalar_op_compiler.py`

 * *Files 1% similar despite different names*

```diff
@@ -584,14 +584,19 @@
         if any_match is not None:
             any_match = any_match | pat_match
         else:
             any_match = pat_match
     return any_match if any_match is not None else ibis_types.literal(False)
 
 
+@scalar_op_compiler.register_unary_op(ops.StringSplitOp, pass_op=True)
+def stringsplit_op_impl(x: ibis_types.Value, op: ops.StringSplitOp):
+    return typing.cast(ibis_types.StringValue, x).split(op.pat)
+
+
 @scalar_op_compiler.register_unary_op(ops.ZfillOp, pass_op=True)
 def zfill_op_impl(x: ibis_types.Value, op: ops.ZfillOp):
     str_value = typing.cast(ibis_types.StringValue, x)
     return (
         ibis.case()
         .when(
             str_value[0] == "-",
@@ -1294,30 +1299,44 @@
 ):
     if x.name("name").equals(y.name("name")):
         return x
     else:
         return ibis.coalesce(x, y)
 
 
-@scalar_op_compiler.register_binary_op(ops.cliplower_op)
-def clip_lower(
+@scalar_op_compiler.register_binary_op(ops.maximum_op)
+def maximum_impl(
     value: ibis_types.Value,
     lower: ibis_types.Value,
 ):
+    # Note: propagates nulls
     return ibis.case().when(lower.isnull() | (value < lower), lower).else_(value).end()
 
 
-@scalar_op_compiler.register_binary_op(ops.clipupper_op)
-def clip_upper(
+@scalar_op_compiler.register_binary_op(ops.minimum_op)
+def minimum_impl(
     value: ibis_types.Value,
     upper: ibis_types.Value,
 ):
+    # Note: propagates nulls
     return ibis.case().when(upper.isnull() | (value > upper), upper).else_(value).end()
 
 
+@scalar_op_compiler.register_binary_op(ops.BinaryRemoteFunctionOp, pass_op=True)
+def binary_remote_function_op_impl(
+    x: ibis_types.Value, y: ibis_types.Value, op: ops.BinaryRemoteFunctionOp
+):
+    if not hasattr(op.func, "bigframes_remote_function"):
+        raise TypeError(
+            f"only a bigframes remote function is supported as a callable. {constants.FEEDBACK_LINK}"
+        )
+    x_transformed = op.func(x, y)
+    return x_transformed
+
+
 # Ternary Operations
 @scalar_op_compiler.register_ternary_op(ops.where_op)
 def where_op(
     original: ibis_types.Value,
     condition: ibis_types.Value,
     replacement: ibis_types.Value,
 ) -> ibis_types.Value:
```

### Comparing `bigframes-1.5.0/bigframes/core/compile/single_column.py` & `bigframes-1.6.0/bigframes/core/compile/single_column.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/core/convert.py` & `bigframes-1.6.0/bigframes/core/convert.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/core/eval.py` & `bigframes-1.6.0/bigframes/core/eval.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/core/expression.py` & `bigframes-1.6.0/bigframes/core/expression.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/core/global_session.py` & `bigframes-1.6.0/bigframes/core/global_session.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/core/groupby/__init__.py` & `bigframes-1.6.0/bigframes/core/groupby/__init__.py`

 * *Files 2% similar despite different names*

```diff
@@ -24,14 +24,15 @@
 from bigframes.core import log_adapter
 import bigframes.core as core
 import bigframes.core.block_transforms as block_ops
 import bigframes.core.blocks as blocks
 import bigframes.core.ordering as order
 import bigframes.core.utils as utils
 import bigframes.core.window as windows
+import bigframes.core.window_spec as window_specs
 import bigframes.dataframe as df
 import bigframes.dtypes as dtypes
 import bigframes.operations.aggregations as agg_ops
 import bigframes.series as series
 
 
 @log_adapter.class_logger
@@ -213,48 +214,47 @@
     def cummax(self, *args, numeric_only: bool = False, **kwargs) -> df.DataFrame:
         return self._apply_window_op(agg_ops.max_op, numeric_only=numeric_only)
 
     def cumprod(self, *args, **kwargs) -> df.DataFrame:
         return self._apply_window_op(agg_ops.product_op, numeric_only=True)
 
     def shift(self, periods=1) -> series.Series:
-        window = core.WindowSpec(
+        window = window_specs.rows(
             grouping_keys=tuple(self._by_col_ids),
             preceding=periods if periods > 0 else None,
             following=-periods if periods < 0 else None,
         )
         return self._apply_window_op(agg_ops.ShiftOp(periods), window=window)
 
     def diff(self, periods=1) -> series.Series:
-        window = core.WindowSpec(
+        window = window_specs.rows(
             grouping_keys=tuple(self._by_col_ids),
             preceding=periods if periods > 0 else None,
             following=-periods if periods < 0 else None,
         )
         return self._apply_window_op(agg_ops.DiffOp(periods), window=window)
 
     def rolling(self, window: int, min_periods=None) -> windows.Window:
         # To get n size window, need current row and n-1 preceding rows.
-        window_spec = core.WindowSpec(
+        window_spec = window_specs.rows(
             grouping_keys=tuple(self._by_col_ids),
             preceding=window - 1,
             following=0,
             min_periods=min_periods or window,
         )
         block = self._block.order_by(
             [order.ascending_over(col) for col in self._by_col_ids],
         )
         return windows.Window(
             block, window_spec, self._selected_cols, drop_null_groups=self._dropna
         )
 
     def expanding(self, min_periods: int = 1) -> windows.Window:
-        window_spec = core.WindowSpec(
+        window_spec = window_specs.cumulative_rows(
             grouping_keys=tuple(self._by_col_ids),
-            following=0,
             min_periods=min_periods,
         )
         block = self._block.order_by(
             [order.ascending_over(col) for col in self._by_col_ids],
         )
         return windows.Window(
             block, window_spec, self._selected_cols, drop_null_groups=self._dropna
@@ -420,16 +420,16 @@
     def _apply_window_op(
         self,
         op: agg_ops.WindowOp,
         window: typing.Optional[core.WindowSpec] = None,
         numeric_only: bool = False,
     ):
         """Apply window op to groupby. Defaults to grouped cumulative window."""
-        window_spec = window or core.WindowSpec(
-            grouping_keys=tuple(self._by_col_ids), following=0
+        window_spec = window or window_specs.cumulative_rows(
+            grouping_keys=tuple(self._by_col_ids)
         )
         columns = self._aggregated_columns(numeric_only=numeric_only)
         block, result_ids = self._block.multi_apply_window_op(
             columns, op, window_spec=window_spec
         )
         block = block.select_columns(result_ids)
         return df.DataFrame(block)
@@ -590,32 +590,32 @@
                 discard_name=True,
             )
             - 1
         )
 
     def shift(self, periods=1) -> series.Series:
         """Shift index by desired number of periods."""
-        window = core.WindowSpec(
+        window = window_specs.rows(
             grouping_keys=tuple(self._by_col_ids),
             preceding=periods if periods > 0 else None,
             following=-periods if periods < 0 else None,
         )
         return self._apply_window_op(agg_ops.ShiftOp(periods), window=window)
 
     def diff(self, periods=1) -> series.Series:
-        window = core.WindowSpec(
+        window = window_specs.rows(
             grouping_keys=tuple(self._by_col_ids),
             preceding=periods if periods > 0 else None,
             following=-periods if periods < 0 else None,
         )
         return self._apply_window_op(agg_ops.DiffOp(periods), window=window)
 
     def rolling(self, window: int, min_periods=None) -> windows.Window:
         # To get n size window, need current row and n-1 preceding rows.
-        window_spec = core.WindowSpec(
+        window_spec = window_specs.rows(
             grouping_keys=tuple(self._by_col_ids),
             preceding=window - 1,
             following=0,
             min_periods=min_periods or window,
         )
         block = self._block.order_by(
             [order.ascending_over(col) for col in self._by_col_ids],
@@ -625,17 +625,16 @@
             window_spec,
             [self._value_column],
             drop_null_groups=self._dropna,
             is_series=True,
         )
 
     def expanding(self, min_periods: int = 1) -> windows.Window:
-        window_spec = core.WindowSpec(
+        window_spec = window_specs.cumulative_rows(
             grouping_keys=tuple(self._by_col_ids),
-            following=0,
             min_periods=min_periods,
         )
         block = self._block.order_by(
             [order.ascending_over(col) for col in self._by_col_ids],
         )
         return windows.Window(
             block,
@@ -657,16 +656,16 @@
     def _apply_window_op(
         self,
         op: agg_ops.WindowOp,
         discard_name=False,
         window: typing.Optional[core.WindowSpec] = None,
     ):
         """Apply window op to groupby. Defaults to grouped cumulative window."""
-        window_spec = window or core.WindowSpec(
-            grouping_keys=tuple(self._by_col_ids), following=0
+        window_spec = window or window_specs.cumulative_rows(
+            grouping_keys=tuple(self._by_col_ids)
         )
 
         label = self._value_name if not discard_name else None
         block, result_id = self._block.apply_window_op(
             self._value_column,
             op,
             result_label=label,
```

### Comparing `bigframes-1.5.0/bigframes/core/guid.py` & `bigframes-1.6.0/bigframes/core/guid.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/core/indexers.py` & `bigframes-1.6.0/bigframes/core/indexers.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/core/indexes/__init__.py` & `bigframes-1.6.0/bigframes/core/indexes/__init__.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/core/indexes/base.py` & `bigframes-1.6.0/bigframes/core/indexes/base.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/core/indexes/multi.py` & `bigframes-1.6.0/bigframes/core/indexes/multi.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/core/join_def.py` & `bigframes-1.6.0/bigframes/core/join_def.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/core/joins/__init__.py` & `bigframes-1.6.0/bigframes/core/joins/__init__.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/core/joins/merge.py` & `bigframes-1.6.0/bigframes/core/joins/merge.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/core/local_data.py` & `bigframes-1.6.0/bigframes/core/local_data.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/core/log_adapter.py` & `bigframes-1.6.0/bigframes/core/log_adapter.py`

 * *Files 27% similar despite different names*

```diff
@@ -17,39 +17,82 @@
 from typing import List
 
 _lock = threading.Lock()
 MAX_LABELS_COUNT = 64
 _api_methods: List = []
 _excluded_methods = ["__setattr__", "__getattr__"]
 
+# Stack to track method calls
+_call_stack: List = []
+
 
 def class_logger(decorated_cls):
     """Decorator that adds logging functionality to each method of the class."""
     for attr_name, attr_value in decorated_cls.__dict__.items():
         if callable(attr_value) and (attr_name not in _excluded_methods):
             setattr(decorated_cls, attr_name, method_logger(attr_value, decorated_cls))
+        elif isinstance(attr_value, property):
+            setattr(
+                decorated_cls, attr_name, property_logger(attr_value, decorated_cls)
+            )
     return decorated_cls
 
 
 def method_logger(method, decorated_cls):
     """Decorator that adds logging functionality to a method."""
 
     @functools.wraps(method)
     def wrapper(*args, **kwargs):
         class_name = decorated_cls.__name__  # Access decorated class name
         api_method_name = str(method.__name__)
         full_method_name = f"{class_name.lower()}-{api_method_name}"
-        # Track regular and "dunder" methods
-        if api_method_name.startswith("__") or not api_method_name.startswith("_"):
+
+        # Track directly called methods
+        if len(_call_stack) == 0:
             add_api_method(full_method_name)
-        return method(*args, **kwargs)
+
+        _call_stack.append(full_method_name)
+
+        try:
+            return method(*args, **kwargs)
+        finally:
+            _call_stack.pop()
 
     return wrapper
 
 
+def property_logger(prop, decorated_cls):
+    """Decorator that adds logging functionality to a property."""
+
+    def shared_wrapper(f):
+        @functools.wraps(f)
+        def wrapped(*args, **kwargs):
+            class_name = decorated_cls.__name__
+            property_name = f.__name__
+            full_property_name = f"{class_name.lower()}-{property_name.lower()}"
+
+            if len(_call_stack) == 0:
+                add_api_method(full_property_name)
+
+            _call_stack.append(full_property_name)
+            try:
+                return f(*args, **kwargs)
+            finally:
+                _call_stack.pop()
+
+        return wrapped
+
+    # Apply the wrapper to the getter, setter, and deleter
+    return property(
+        shared_wrapper(prop.fget),
+        shared_wrapper(prop.fset) if prop.fset else None,
+        shared_wrapper(prop.fdel) if prop.fdel else None,
+    )
+
+
 def add_api_method(api_method_name):
     global _lock
     global _api_methods
     with _lock:
         # Push the method to the front of the _api_methods list
         _api_methods.insert(0, api_method_name)
         # Keep the list length within the maximum limit (adjust MAX_LABELS_COUNT as needed)
```

### Comparing `bigframes-1.5.0/bigframes/core/nodes.py` & `bigframes-1.6.0/bigframes/core/nodes.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/core/ordering.py` & `bigframes-1.6.0/bigframes/core/ordering.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/core/reshape/__init__.py` & `bigframes-1.6.0/bigframes/core/reshape/__init__.py`

 * *Files 2% similar despite different names*

```diff
@@ -15,18 +15,18 @@
 
 import typing
 from typing import Iterable, Literal, Optional, Union
 
 import pandas as pd
 
 import bigframes.constants as constants
-import bigframes.core as core
 import bigframes.core.expression as ex
 import bigframes.core.ordering as order
 import bigframes.core.utils as utils
+import bigframes.core.window_spec as window_specs
 import bigframes.dataframe
 import bigframes.operations as ops
 import bigframes.operations.aggregations as agg_ops
 import bigframes.series
 
 
 @typing.overload
@@ -155,15 +155,15 @@
     if labels is not None and labels is not False:
         raise NotImplementedError(
             "The 'labels' parameter must be either False or None. "
             "Please provide a valid value for 'labels'."
         )
 
     return x._apply_window_op(
-        agg_ops.CutOp(bins, labels=labels), window_spec=core.WindowSpec()
+        agg_ops.CutOp(bins, labels=labels), window_spec=window_specs.unbound()
     )
 
 
 def qcut(
     x: bigframes.series.Series,
     q: typing.Union[int, typing.Sequence[float]],
     *,
@@ -185,15 +185,15 @@
         )
     block = x._block
     label = block.col_id_to_label[x._value_column]
     block, nullity_id = block.apply_unary_op(x._value_column, ops.notnull_op)
     block, result = block.apply_window_op(
         x._value_column,
         agg_ops.QcutOp(q),  # type: ignore
-        window_spec=core.WindowSpec(
+        window_spec=window_specs.unbound(
             grouping_keys=(nullity_id,),
             ordering=(order.ascending_over(x._value_column),),
         ),
     )
     block, result = block.project_expr(
         ops.where_op.as_expr(result, nullity_id, ex.const(None)), label=label
     )
```

### Comparing `bigframes-1.5.0/bigframes/core/rewrite.py` & `bigframes-1.6.0/bigframes/core/rewrite.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/core/scalar.py` & `bigframes-1.6.0/bigframes/core/scalar.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/core/schema.py` & `bigframes-1.6.0/bigframes/core/schema.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/core/tools/__init__.py` & `bigframes-1.6.0/bigframes/core/tools/__init__.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/core/tools/datetimes.py` & `bigframes-1.6.0/bigframes/core/tools/datetimes.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/core/tree_properties.py` & `bigframes-1.6.0/bigframes/core/tree_properties.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/core/utils.py` & `bigframes-1.6.0/bigframes/core/utils.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/core/window/__init__.py` & `bigframes-1.6.0/bigframes/core/window/__init__.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/dataframe.py` & `bigframes-1.6.0/bigframes/dataframe.py`

 * *Files 1% similar despite different names*

```diff
@@ -30,14 +30,15 @@
     Literal,
     Mapping,
     Optional,
     Sequence,
     Tuple,
     Union,
 )
+import warnings
 
 import bigframes_vendored.pandas.core.frame as vendored_pandas_frame
 import bigframes_vendored.pandas.pandas._typing as vendored_pandas_typing
 import google.api_core.exceptions
 import google.cloud.bigquery as bigquery
 import numpy
 import pandas
@@ -55,15 +56,17 @@
 import bigframes.core.groupby as groupby
 import bigframes.core.guid
 import bigframes.core.indexers as indexers
 import bigframes.core.indexes as indexes
 import bigframes.core.ordering as order
 import bigframes.core.utils as utils
 import bigframes.core.window
+import bigframes.core.window_spec as window_spec
 import bigframes.dtypes
+import bigframes.exceptions
 import bigframes.formatting_helpers as formatter
 import bigframes.operations as ops
 import bigframes.operations.aggregations as agg_ops
 import bigframes.operations.plotting as plotting
 import bigframes.series
 import bigframes.series as bf_series
 import bigframes.session._io.bigquery
@@ -651,14 +654,18 @@
         with display_options.pandas_repr(opts):
             # _repr_html_ stub is missing so mypy thinks it's a Series. Ignore mypy.
             html_string = pandas_df._repr_html_()  # type:ignore
 
         html_string += f"[{row_count} rows x {column_count} columns in total]"
         return html_string
 
+    def __delitem__(self, key: str):
+        df = self.drop(columns=[key])
+        self._set_block(df._get_block())
+
     def __setitem__(self, key: str, value: SingleItemValue):
         df = self._assign_single_item(key, value)
         self._set_block(df._get_block())
 
     __setitem__.__doc__ = inspect.getdoc(vendored_pandas_frame.DataFrame.__setitem__)
 
     def _apply_binop(
@@ -1866,19 +1873,19 @@
                 else x
             )
         return self.apply(
             lambda x: x.replace(to_replace=to_replace, value=value, regex=regex)
         )
 
     def ffill(self, *, limit: typing.Optional[int] = None) -> DataFrame:
-        window = bigframes.core.WindowSpec(preceding=limit, following=0)
+        window = window_spec.rows(preceding=limit, following=0)
         return self._apply_window_op(agg_ops.LastNonNullOp(), window)
 
     def bfill(self, *, limit: typing.Optional[int] = None) -> DataFrame:
-        window = bigframes.core.WindowSpec(preceding=0, following=limit)
+        window = window_spec.rows(preceding=0, following=limit)
         return self._apply_window_op(agg_ops.FirstNonNullOp(), window)
 
     def isin(self, values) -> DataFrame:
         if utils.is_dict_like(values):
             block = self._block
             result_ids = []
             for col, label in zip(self._block.value_columns, self._block.column_labels):
@@ -2566,25 +2573,25 @@
         self, other: Union[DataFrame, indexes.Index], *, how: str = "left"
     ):
         block, _ = self._block.join(other._block, how=how, block_identity_join=True)
         return DataFrame(block)
 
     def rolling(self, window: int, min_periods=None) -> bigframes.core.window.Window:
         # To get n size window, need current row and n-1 preceding rows.
-        window_spec = bigframes.core.WindowSpec(
+        window_def = window_spec.rows(
             preceding=window - 1, following=0, min_periods=min_periods or window
         )
         return bigframes.core.window.Window(
-            self._block, window_spec, self._block.value_columns
+            self._block, window_def, self._block.value_columns
         )
 
     def expanding(self, min_periods: int = 1) -> bigframes.core.window.Window:
-        window_spec = bigframes.core.WindowSpec(following=0, min_periods=min_periods)
+        window = window_spec.cumulative_rows(min_periods=min_periods)
         return bigframes.core.window.Window(
-            self._block, window_spec, self._block.value_columns
+            self._block, window, self._block.value_columns
         )
 
     def groupby(
         self,
         by: typing.Union[
             blocks.Label,
             bigframes.series.Series,
@@ -2683,64 +2690,64 @@
             (dtype in bigframes.dtypes.NUMERIC_BIGFRAMES_TYPES_PERMISSIVE)
             for _, dtype in self.dtypes.items()
         ]
         if not all(is_numeric_types):
             raise ValueError("All values must be numeric to apply cumsum.")
         return self._apply_window_op(
             agg_ops.sum_op,
-            bigframes.core.WindowSpec(following=0),
+            window_spec.cumulative_rows(),
         )
 
     def cumprod(self) -> DataFrame:
         is_numeric_types = [
             (dtype in bigframes.dtypes.NUMERIC_BIGFRAMES_TYPES_PERMISSIVE)
             for _, dtype in self.dtypes.items()
         ]
         if not all(is_numeric_types):
             raise ValueError("All values must be numeric to apply cumsum.")
         return self._apply_window_op(
             agg_ops.product_op,
-            bigframes.core.WindowSpec(following=0),
+            window_spec.cumulative_rows(),
         )
 
     def cummin(self) -> DataFrame:
         return self._apply_window_op(
             agg_ops.min_op,
-            bigframes.core.WindowSpec(following=0),
+            window_spec.cumulative_rows(),
         )
 
     def cummax(self) -> DataFrame:
         return self._apply_window_op(
             agg_ops.max_op,
-            bigframes.core.WindowSpec(following=0),
+            window_spec.cumulative_rows(),
         )
 
     def shift(self, periods: int = 1) -> DataFrame:
-        window = bigframes.core.WindowSpec(
+        window = window_spec.rows(
             preceding=periods if periods > 0 else None,
             following=-periods if periods < 0 else None,
         )
         return self._apply_window_op(agg_ops.ShiftOp(periods), window)
 
     def diff(self, periods: int = 1) -> DataFrame:
-        window = bigframes.core.WindowSpec(
+        window = window_spec.rows(
             preceding=periods if periods > 0 else None,
             following=-periods if periods < 0 else None,
         )
         return self._apply_window_op(agg_ops.DiffOp(periods), window)
 
     def pct_change(self, periods: int = 1) -> DataFrame:
         # Future versions of pandas will not perfrom ffill automatically
         df = self.ffill()
         return DataFrame(block_ops.pct_change(df._block, periods=periods))
 
     def _apply_window_op(
         self,
         op: agg_ops.WindowOp,
-        window_spec: bigframes.core.WindowSpec,
+        window_spec: window_spec.WindowSpec,
     ):
         block, result_ids = self._block.multi_apply_window_op(
             self._block.value_columns,
             op,
             window_spec=window_spec,
         )
         return DataFrame(block.select_columns(result_ids))
@@ -3299,15 +3306,67 @@
         # to be applied before passing data to remote function, protecting from bad
         # inputs causing errors.
         reprojected_df = DataFrame(self._block._force_reproject())
         return reprojected_df._apply_unary_op(
             ops.RemoteFunctionOp(func=func, apply_on_null=(na_action is None))
         )
 
-    def apply(self, func, *, args: typing.Tuple = (), **kwargs):
+    def apply(self, func, *, axis=0, args: typing.Tuple = (), **kwargs):
+        if utils.get_axis_number(axis) == 1:
+            warnings.warn(
+                "axis=1 scenario is in preview.",
+                category=bigframes.exceptions.PreviewWarning,
+            )
+
+            # Early check whether the dataframe dtypes are currently supported
+            # in the remote function
+            # NOTE: Keep in sync with the value converters used in the gcf code
+            # generated in generate_cloud_function_main_code in remote_function.py
+            remote_function_supported_dtypes = (
+                bigframes.dtypes.INT_DTYPE,
+                bigframes.dtypes.FLOAT_DTYPE,
+                bigframes.dtypes.BOOL_DTYPE,
+                bigframes.dtypes.STRING_DTYPE,
+            )
+            supported_dtypes_types = tuple(
+                type(dtype) for dtype in remote_function_supported_dtypes
+            )
+            supported_dtypes_hints = tuple(
+                str(dtype) for dtype in remote_function_supported_dtypes
+            )
+
+            for dtype in self.dtypes:
+                if not isinstance(dtype, supported_dtypes_types):
+                    raise NotImplementedError(
+                        f"DataFrame has a column of dtype '{dtype}' which is not supported with axis=1."
+                        f" Supported dtypes are {supported_dtypes_hints}."
+                    )
+
+            # Check if the function is a remote function
+            if not hasattr(func, "bigframes_remote_function"):
+                raise ValueError("For axis=1 a remote function must be used.")
+
+            # Serialize the rows as json values
+            block = self._get_block()
+            rows_as_json_series = bigframes.series.Series(
+                block._get_rows_as_json_values()
+            )
+
+            # Apply the function
+            result_series = rows_as_json_series._apply_unary_op(
+                ops.RemoteFunctionOp(func=func, apply_on_null=True)
+            )
+            result_series.name = None
+
+            # Return Series with materialized result so that any error in the remote
+            # function is caught early
+            materialized_series = result_series.cache()
+            return materialized_series
+
+        # Per-column apply
         results = {name: func(col, *args, **kwargs) for name, col in self.items()}
         if all(
             [
                 isinstance(val, bigframes.series.Series) or utils.is_list_like(val)
                 for val in results.values()
             ]
         ):
```

### Comparing `bigframes-1.5.0/bigframes/dtypes.py` & `bigframes-1.6.0/bigframes/dtypes.py`

 * *Files 1% similar despite different names*

```diff
@@ -401,14 +401,20 @@
                 """
             )
         )
 
     return BIGFRAMES_TO_IBIS[bigframes_dtype]
 
 
+def bigframes_dtype_to_arrow_dtype(
+    bigframes_dtype: Union[DtypeString, Dtype, np.dtype[Any]]
+) -> pa.DataType:
+    return ibis_dtype_to_arrow_dtype(bigframes_dtype_to_ibis_dtype(bigframes_dtype))
+
+
 def literal_to_ibis_scalar(
     literal, force_dtype: typing.Optional[Dtype] = None, validate: bool = True
 ):
     """Accept any literal and, if possible, return an Ibis Scalar
     expression with a BigQuery DataFrames compatible data type
 
     Args:
```

### Comparing `bigframes-1.5.0/bigframes/enums.py` & `bigframes-1.6.0/bigframes/enums.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/exceptions.py` & `bigframes-1.6.0/bigframes/exceptions.py`

 * *Files 18% similar despite different names*

```diff
@@ -13,17 +13,27 @@
 # limitations under the License.
 
 """Public exceptions and warnings used across BigQuery DataFrames."""
 
 # NOTE: This module should not depend on any others in the package.
 
 
+# Uses UserWarning for backwards compatibility with warning without a category
+# set.
+class DefaultLocationWarning(UserWarning):
+    """No location was specified, so using a default one."""
+
+
 class UnknownLocationWarning(Warning):
     """The location is set to an unknown value."""
 
 
 class CleanupFailedWarning(Warning):
     """Bigframes failed to clean up a table resource."""
 
 
 class DefaultIndexWarning(Warning):
     """Default index may cause unexpected costs."""
+
+
+class PreviewWarning(Warning):
+    """The feature is in preview."""
```

### Comparing `bigframes-1.5.0/bigframes/features.py` & `bigframes-1.6.0/bigframes/features.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/formatting_helpers.py` & `bigframes-1.6.0/bigframes/formatting_helpers.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/functions/__init__.py` & `bigframes-1.6.0/bigframes/functions/__init__.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/functions/remote_function.py` & `bigframes-1.6.0/bigframes/functions/remote_function.py`

 * *Files 9% similar despite different names*

```diff
@@ -21,16 +21,18 @@
 import random
 import shutil
 import string
 import sys
 import tempfile
 import textwrap
 from typing import List, NamedTuple, Optional, Sequence, TYPE_CHECKING, Union
+import warnings
 
 import ibis
+import pandas
 import requests
 
 if TYPE_CHECKING:
     from bigframes.session import Session
 
 import bigframes_vendored.ibis.backends.bigquery.datatypes as third_party_ibis_bqtypes
 import cloudpickle
@@ -258,15 +260,15 @@
         # serialized bytecode
         udf_bytecode_file_path = os.path.join(dir, udf_bytecode_file_name)
         with open(udf_bytecode_file_path, "wb") as f:
             cloudpickle.dump(def_, f, protocol=_pickle_protocol_version)
 
         return udf_code_file_name, udf_bytecode_file_name
 
-    def generate_cloud_function_main_code(self, def_, dir):
+    def generate_cloud_function_main_code(self, def_, dir, is_row_processor=False):
         """Get main.py code for the cloud function for the given user defined function."""
 
         # Pickle the udf with all its dependencies
         udf_code_file, udf_bytecode_file = self.generate_udf_code(def_, dir)
         handler_func_name = "udf_http"
 
         # We want to build a cloud function that works for BQ remote functions,
@@ -281,84 +283,176 @@
         #   "calls" : [
         #     [123, "hello"],
         #     [456, "world"]
         #   ]
         #   ...
         # }
         # https://cloud.google.com/bigquery/docs/reference/standard-sql/remote-functions#input_format
-        code_template = textwrap.dedent(
-            """\
-        import cloudpickle
-        import functions_framework
-        from flask import jsonify
-        import json
-
-        # original udf code is in {udf_code_file}
-        # serialized udf code is in {udf_bytecode_file}
-        with open("{udf_bytecode_file}", "rb") as f:
-          udf = cloudpickle.load(f)
-
-        def {handler_func_name}(request):
-          try:
-            request_json = request.get_json(silent=True)
-            calls = request_json["calls"]
-            replies = []
-            for call in calls:
-              reply = udf(*call)
-              replies.append(reply)
-            return_json = json.dumps({{"replies" : replies}})
-            return return_json
-          except Exception as e:
-            return jsonify( {{ "errorMessage": str(e) }} ), 400
-        """
-        )
-
-        code = code_template.format(
-            udf_code_file=udf_code_file,
-            udf_bytecode_file=udf_bytecode_file,
-            handler_func_name=handler_func_name,
-        )
+        code = """\
+import cloudpickle
+import functions_framework
+from flask import jsonify
+import json
+"""
+        if is_row_processor:
+            code += """\
+import ast
+import math
+import pandas as pd
+
+def get_pd_series(row):
+    row_json = json.loads(row)
+    col_names = row_json["names"]
+    col_types = row_json["types"]
+    col_values = row_json["values"]
+    index_length = row_json["indexlength"]
+    dtype = row_json["dtype"]
+
+    # At this point we are assuming that col_names, col_types and col_values are
+    # arrays of the same length, representing column names, types and values for
+    # one row of data
+
+    # column names are not necessarily strings
+    # they are serialized as repr(name) at source
+    evaluated_col_names = []
+    for col_name in col_names:
+        try:
+            col_name = ast.literal_eval(col_name)
+        except Exception as ex:
+            raise NameError(f"Failed to evaluate column name from '{col_name}': {ex}")
+        evaluated_col_names.append(col_name)
+    col_names = evaluated_col_names
+
+    # Supported converters for pandas to python types
+    value_converters = {
+        "boolean": lambda val: val == "true",
+        "Int64": int,
+        "Float64": float,
+        "string": str,
+    }
+
+    def convert_value(value, value_type):
+        value_converter = value_converters.get(value_type)
+        if value_converter is None:
+            raise ValueError(f"Don't know how to handle type '{value_type}'")
+        if value is None:
+            return None
+        return value_converter(value)
+
+    index_values = [
+        pd.Series([convert_value(col_values[i], col_types[i])], dtype=col_types[i])[0]
+        for i in range(index_length)
+    ]
+
+    data_col_names = col_names[index_length:]
+    data_col_types = col_types[index_length:]
+    data_col_values = col_values[index_length:]
+    data_col_values = [
+        pd.Series([convert_value(a, data_col_types[i])], dtype=data_col_types[i])[0]
+        for i, a in enumerate(data_col_values)
+    ]
+
+    row_index = index_values[0] if len(index_values) == 1 else tuple(index_values)
+    row_series = pd.Series(data_col_values, index=data_col_names, name=row_index, dtype=dtype)
+    return row_series
+"""
+        code += f"""\
+
+# original udf code is in {udf_code_file}
+# serialized udf code is in {udf_bytecode_file}
+with open("{udf_bytecode_file}", "rb") as f:
+    udf = cloudpickle.load(f)
+
+def {handler_func_name}(request):
+    try:
+        request_json = request.get_json(silent=True)
+        calls = request_json["calls"]
+        replies = []
+        for call in calls:
+"""
+
+        if is_row_processor:
+            code += """\
+            reply = udf(get_pd_series(call[0]))
+            if isinstance(reply, float) and (math.isnan(reply) or math.isinf(reply)):
+                # json serialization of the special float values (nan, inf, -inf)
+                # is not in strict compliance of the JSON specification
+                # https://docs.python.org/3/library/json.html#basic-usage.
+                # Let's convert them to a quoted string representation ("NaN",
+                # "Infinity", "-Infinity" respectively) which is handled by
+                # BigQuery
+                reply = json.dumps(reply)
+            elif pd.isna(reply):
+                # Pandas N/A values are not json serializable, so use a python
+                # equivalent instead
+                reply = None
+            elif hasattr(reply, "item"):
+                # Numpy types are not json serializable, so use its Python
+                # value instead
+                reply = reply.item()
+"""
+        else:
+            code += """\
+            reply = udf(*call)
+"""
+        code += """\
+            replies.append(reply)
+        return_json = json.dumps({"replies" : replies})
+        return return_json
+    except Exception as e:
+        return jsonify( { "errorMessage": str(e) } ), 400
+"""
 
         main_py = os.path.join(dir, "main.py")
         with open(main_py, "w") as f:
             f.write(code)
         logger.debug(f"Wrote {os.path.abspath(main_py)}:\n{open(main_py).read()}")
 
         return handler_func_name
 
-    def generate_cloud_function_code(self, def_, dir, package_requirements=None):
+    def generate_cloud_function_code(
+        self, def_, dir, package_requirements=None, is_row_processor=False
+    ):
         """Generate the cloud function code for a given user defined function."""
 
         # requirements.txt
         requirements = ["cloudpickle >= 2.1.0"]
+        if is_row_processor:
+            # bigframes remote function will send an entire row of data as json,
+            # which would be converted to a pandas series and processed
+            requirements.append(f"pandas=={pandas.__version__}")
         if package_requirements:
             requirements.extend(package_requirements)
         requirements = sorted(requirements)
         requirements_txt = os.path.join(dir, "requirements.txt")
         with open(requirements_txt, "w") as f:
             f.write("\n".join(requirements))
 
         # main.py
-        entry_point = self.generate_cloud_function_main_code(def_, dir)
+        entry_point = self.generate_cloud_function_main_code(
+            def_, dir, is_row_processor
+        )
         return entry_point
 
     def create_cloud_function(
         self,
         def_,
         cf_name,
         package_requirements=None,
         timeout_seconds=600,
         max_instance_count=None,
+        is_row_processor=False,
+        vpc_connector=None,
     ):
         """Create a cloud function from the given user defined function."""
 
         # Build and deploy folder structure containing cloud function
         with tempfile.TemporaryDirectory() as dir:
             entry_point = self.generate_cloud_function_code(
-                def_, dir, package_requirements
+                def_, dir, package_requirements, is_row_processor
             )
             archive_path = shutil.make_archive(dir, "zip", dir)
 
             # We are creating cloud function source code from the currently running
             # python version. Use the same version to deploy. This is necessary
             # because cloudpickle serialization done in one python version and
             # deserialization done in another python version doesn't work.
@@ -422,14 +516,16 @@
                         "BigQuery remote function can wait only up to 20 minutes"
                         ", see for more details "
                         "https://cloud.google.com/bigquery/quotas#remote_function_limits."
                     )
                 function.service_config.timeout_seconds = timeout_seconds
             if max_instance_count is not None:
                 function.service_config.max_instance_count = max_instance_count
+            if vpc_connector is not None:
+                function.service_config.vpc_connector = vpc_connector
             function.service_config.service_account_email = (
                 self._cloud_function_service_account
             )
             function.kms_key_name = self._cloud_function_kms_key_name
             create_function_request.function = function
 
             # Create the cloud function and wait for it to be ready to use
@@ -470,14 +566,16 @@
         output_type,
         reuse,
         name,
         package_requirements,
         max_batching_rows,
         cloud_function_timeout,
         cloud_function_max_instance_count,
+        is_row_processor,
+        cloud_function_vpc_connector,
     ):
         """Provision a BigQuery remote function."""
         # If reuse of any existing function with the same name (indicated by the
         # same hash of its source code) is not intended, then attach a unique
         # suffix to the intended function name to make it unique.
         uniq_suffix = None
         if not reuse:
@@ -496,14 +594,16 @@
         if not cf_endpoint:
             cf_endpoint = self.create_cloud_function(
                 def_,
                 cloud_function_name,
                 package_requirements,
                 cloud_function_timeout,
                 cloud_function_max_instance_count,
+                is_row_processor,
+                cloud_function_vpc_connector,
             )
         else:
             logger.info(f"Cloud function {cloud_function_name} already exists.")
 
         # Derive the name of the remote function
         remote_function_name = name
         if not remote_function_name:
@@ -651,14 +751,15 @@
     packages: Optional[Sequence[str]] = None,
     cloud_function_service_account: Optional[str] = None,
     cloud_function_kms_key_name: Optional[str] = None,
     cloud_function_docker_repository: Optional[str] = None,
     max_batching_rows: Optional[int] = 1000,
     cloud_function_timeout: Optional[int] = 600,
     cloud_function_max_instances: Optional[int] = None,
+    cloud_function_vpc_connector: Optional[str] = None,
 ):
     """Decorator to turn a user defined function into a BigQuery remote function.
 
     .. deprecated:: 0.0.1
        This is an internal method. Please use :func:`bigframes.pandas.remote_function` instead.
 
     .. note::
@@ -696,16 +797,17 @@
 
                Alternatively, the IAM could also be setup via the gcloud CLI:
 
                `$ gcloud projects add-iam-policy-binding PROJECT_ID --member="serviceAccount:CONNECTION_SERVICE_ACCOUNT_ID" --role="roles/run.invoker"`.
 
     Args:
         input_types (type or sequence(type)):
-            Input data type, or sequence of input data types in the user
-            defined function.
+            For scalar user defined function it should be the input type or
+            sequence of input types. For row processing user defined function,
+            type `Series` should be specified.
         output_type (type):
             Data type of the output in the user defined function.
         session (bigframes.Session, Optional):
             BigQuery DataFrames session to use for getting default project,
             dataset and BigQuery connection.
         bigquery_client (google.cloud.bigquery.Client, Optional):
             Client to use for BigQuery operations. If this param is not provided
@@ -794,19 +896,40 @@
         cloud_function_max_instances (int, Optional):
             The maximumm instance count for the cloud function created. This
             can be used to control how many cloud function instances can be
             active at max at any given point of time. Lower setting can help
             control the spike in the billing. Higher setting can help
             support processing larger scale data. When not specified, cloud
             function's default setting applies. For more details see
-            https://cloud.google.com/functions/docs/configuring/max-instances
+            https://cloud.google.com/functions/docs/configuring/max-instances.
+        cloud_function_vpc_connector (str, Optional):
+            The VPC connector you would like to configure for your cloud
+            function. This is useful if your code needs access to data or
+            service(s) that are on a VPC network. See for more details
+            https://cloud.google.com/functions/docs/networking/connecting-vpc.
     """
-    if isinstance(input_types, type):
+    is_row_processor = False
+
+    import bigframes.series
+
+    if input_types == bigframes.series.Series:
+        warnings.warn(
+            "input_types=Series scenario is in preview.",
+            stacklevel=1,
+            category=bigframes.exceptions.PreviewWarning,
+        )
+
+        # we will model the row as a json serialized string containing the data
+        # and the metadata representing the row
+        input_types = [str]
+        is_row_processor = True
+    elif isinstance(input_types, type):
         input_types = [input_types]
 
+    # Some defaults may be used from the session if not provided otherwise
     import bigframes.pandas as bpd
 
     session = session or bpd.get_global_session()
 
     # A BigQuery client is required to perform BQ operations
     if not bigquery_client:
         bigquery_client = session.bqclient
@@ -924,14 +1047,16 @@
             ibis_signature.output_type,
             reuse,
             name,
             packages,
             max_batching_rows,
             cloud_function_timeout,
             cloud_function_max_instances,
+            is_row_processor,
+            cloud_function_vpc_connector,
         )
 
         # TODO: Move ibis logic to compiler step
         node = ibis.udf.scalar.builtin(
             f,
             name=rf_name,
             schema=f"{dataset_ref.project}.{dataset_ref.dataset_id}",
```

### Comparing `bigframes-1.5.0/bigframes/ml/__init__.py` & `bigframes-1.6.0/bigframes/ml/__init__.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/ml/base.py` & `bigframes-1.6.0/bigframes/ml/base.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/ml/cluster.py` & `bigframes-1.6.0/bigframes/ml/cluster.py`

 * *Files 6% similar despite different names*

```diff
@@ -30,14 +30,15 @@
 _BQML_PARAMS_MAPPING = {
     "n_clusters": "numClusters",
     "init": "kmeansInitializationMethod",
     "init_col": "kmeansInitializationColumn",
     "distance_type": "distanceType",
     "max_iter": "maxIterations",
     "tol": "minRelativeProgress",
+    "warm_start": "warmStart",
 }
 
 
 @log_adapter.class_logger
 class KMeans(
     base.UnsupervisedTrainablePredictor,
     bigframes_vendored.sklearn.cluster._kmeans.KMeans,
@@ -63,35 +64,26 @@
         self.max_iter = max_iter
         self.tol = tol
         self.warm_start = warm_start
         self._bqml_model: Optional[core.BqmlModel] = None
         self._bqml_model_factory = globals.bqml_model_factory()
 
     @classmethod
-    def _from_bq(cls, session: bigframes.Session, model: bigquery.Model) -> KMeans:
-        assert model.model_type == "KMEANS"
+    def _from_bq(cls, session: bigframes.Session, bq_model: bigquery.Model) -> KMeans:
+        assert bq_model.model_type == "KMEANS"
 
         kwargs: dict = {}
 
-        # See https://cloud.google.com/bigquery/docs/reference/rest/v2/models#trainingrun
-        last_fitting = model.training_runs[-1]["trainingOptions"]
-        dummy_kmeans = cls()
-        for bf_param, bf_value in dummy_kmeans.__dict__.items():
-            bqml_param = _BQML_PARAMS_MAPPING.get(bf_param)
-            if bqml_param in last_fitting:
-                # Convert types
-                kwargs[bf_param] = (
-                    str(last_fitting[bqml_param])
-                    if bf_param in ["init"]
-                    else type(bf_value)(last_fitting[bqml_param])
-                )
-
-        new_kmeans = cls(**kwargs)
-        new_kmeans._bqml_model = core.BqmlModel(session, model)
-        return new_kmeans
+        kwargs = utils.retrieve_params_from_bq_model(
+            cls, bq_model, _BQML_PARAMS_MAPPING
+        )
+
+        model = cls(**kwargs)
+        model._bqml_model = core.BqmlModel(session, bq_model)
+        return model
 
     @property
     def _bqml_options(self) -> dict:
         """The model options as they will be set for BQML"""
         options = {
             "model_type": "KMEANS",
             "num_clusters": self.n_clusters,
```

### Comparing `bigframes-1.5.0/bigframes/ml/compose.py` & `bigframes-1.6.0/bigframes/ml/compose.py`

 * *Files 1% similar despite different names*

```diff
@@ -34,14 +34,15 @@
 _BQML_TRANSFROM_TYPE_MAPPING = types.MappingProxyType(
     {
         "ML.STANDARD_SCALER": preprocessing.StandardScaler,
         "ML.ONE_HOT_ENCODER": preprocessing.OneHotEncoder,
         "ML.MAX_ABS_SCALER": preprocessing.MaxAbsScaler,
         "ML.MIN_MAX_SCALER": preprocessing.MinMaxScaler,
         "ML.BUCKETIZE": preprocessing.KBinsDiscretizer,
+        "ML.QUANTILE_BUCKETIZE": preprocessing.KBinsDiscretizer,
         "ML.LABEL_ENCODER": preprocessing.LabelEncoder,
     }
 )
 
 
 @log_adapter.class_logger
 class ColumnTransformer(
```

### Comparing `bigframes-1.5.0/bigframes/ml/core.py` & `bigframes-1.6.0/bigframes/ml/core.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/ml/decomposition.py` & `bigframes-1.6.0/bigframes/ml/decomposition.py`

 * *Files 6% similar despite different names*

```diff
@@ -23,14 +23,16 @@
 from google.cloud import bigquery
 
 import bigframes
 from bigframes.core import log_adapter
 from bigframes.ml import base, core, globals, utils
 import bigframes.pandas as bpd
 
+_BQML_PARAMS_MAPPING = {"svd_solver": "pcaSolver"}
+
 
 @log_adapter.class_logger
 class PCA(
     base.UnsupervisedTrainablePredictor,
     bigframes_vendored.sklearn.decomposition._pca.PCA,
 ):
     __doc__ = bigframes_vendored.sklearn.decomposition._pca.PCA.__doc__
@@ -43,31 +45,30 @@
     ):
         self.n_components = n_components
         self.svd_solver = svd_solver
         self._bqml_model: Optional[core.BqmlModel] = None
         self._bqml_model_factory = globals.bqml_model_factory()
 
     @classmethod
-    def _from_bq(cls, session: bigframes.Session, model: bigquery.Model) -> PCA:
-        assert model.model_type == "PCA"
+    def _from_bq(cls, session: bigframes.Session, bq_model: bigquery.Model) -> PCA:
+        assert bq_model.model_type == "PCA"
 
-        kwargs: dict = {}
+        kwargs = utils.retrieve_params_from_bq_model(
+            cls, bq_model, _BQML_PARAMS_MAPPING
+        )
 
-        # See https://cloud.google.com/bigquery/docs/reference/rest/v2/models#trainingrun
-        last_fitting = model.training_runs[-1]["trainingOptions"]
+        last_fitting = bq_model.training_runs[-1]["trainingOptions"]
         if "numPrincipalComponents" in last_fitting:
             kwargs["n_components"] = int(last_fitting["numPrincipalComponents"])
-        if "pcaExplainedVarianceRatio" in last_fitting:
+        elif "pcaExplainedVarianceRatio" in last_fitting:
             kwargs["n_components"] = float(last_fitting["pcaExplainedVarianceRatio"])
-        if "pcaSolver" in last_fitting:
-            kwargs["svd_solver"] = str(last_fitting["pcaSolver"])
 
-        new_pca = cls(**kwargs)
-        new_pca._bqml_model = core.BqmlModel(session, model)
-        return new_pca
+        model = cls(**kwargs)
+        model._bqml_model = core.BqmlModel(session, bq_model)
+        return model
 
     @property
     def _bqml_options(self) -> dict:
         """The model options as they will be set for BQML"""
         options: dict = {
             "model_type": "PCA",
             "pca_solver": self.svd_solver,
```

### Comparing `bigframes-1.5.0/bigframes/ml/ensemble.py` & `bigframes-1.6.0/bigframes/ml/ensemble.py`

 * *Files 13% similar despite different names*

```diff
@@ -26,28 +26,31 @@
 import bigframes
 from bigframes.core import log_adapter
 from bigframes.ml import base, core, globals, utils
 import bigframes.pandas as bpd
 
 _BQML_PARAMS_MAPPING = {
     "booster": "boosterType",
+    "dart_normalized_type": "dartNormalizeType",
     "tree_method": "treeMethod",
-    "colsample_bytree": "colsampleBylevel",
-    "colsample_bylevel": "colsampleBytree",
+    "colsample_bytree": "colsampleBytree",
+    "colsample_bylevel": "colsampleBylevel",
     "colsample_bynode": "colsampleBynode",
     "gamma": "minSplitLoss",
     "subsample": "subsample",
     "reg_alpha": "l1Regularization",
     "reg_lambda": "l2Regularization",
     "learning_rate": "learnRate",
     "tol": "minRelativeProgress",
     "n_estimators": "numParallelTree",
     "min_tree_child_weight": "minTreeChildWeight",
     "max_depth": "maxTreeDepth",
     "max_iterations": "maxIterations",
+    "enable_global_explain": "enableGlobalExplain",
+    "xgboost_version": "xgboostVersion",
 }
 
 
 @log_adapter.class_logger
 class XGBRegressor(
     base.SupervisedTrainablePredictor,
     bigframes_vendored.xgboost.sklearn.XGBRegressor,
@@ -95,32 +98,25 @@
         self.enable_global_explain = enable_global_explain
         self.xgboost_version = xgboost_version
         self._bqml_model: Optional[core.BqmlModel] = None
         self._bqml_model_factory = globals.bqml_model_factory()
 
     @classmethod
     def _from_bq(
-        cls, session: bigframes.Session, model: bigquery.Model
+        cls, session: bigframes.Session, bq_model: bigquery.Model
     ) -> XGBRegressor:
-        assert model.model_type == "BOOSTED_TREE_REGRESSOR"
+        assert bq_model.model_type == "BOOSTED_TREE_REGRESSOR"
 
-        kwargs = {}
-
-        # See https://cloud.google.com/bigquery/docs/reference/rest/v2/models#trainingrun
-        last_fitting = model.training_runs[-1]["trainingOptions"]
+        kwargs = utils.retrieve_params_from_bq_model(
+            cls, bq_model, _BQML_PARAMS_MAPPING
+        )
 
-        dummy_regressor = cls()
-        for bf_param, bf_value in dummy_regressor.__dict__.items():
-            bqml_param = _BQML_PARAMS_MAPPING.get(bf_param)
-            if bqml_param in last_fitting:
-                kwargs[bf_param] = type(bf_value)(last_fitting[bqml_param])
-
-        new_xgb_regressor = cls(**kwargs)
-        new_xgb_regressor._bqml_model = core.BqmlModel(session, model)
-        return new_xgb_regressor
+        model = cls(**kwargs)
+        model._bqml_model = core.BqmlModel(session, bq_model)
+        return model
 
     @property
     def _bqml_options(self) -> Dict[str, str | int | bool | float | List[str]]:
         """The model options as they will be set for BQML"""
         return {
             "model_type": "BOOSTED_TREE_REGRESSOR",
             "data_split_method": "NO_SPLIT",
@@ -251,32 +247,25 @@
         self.enable_global_explain = enable_global_explain
         self.xgboost_version = xgboost_version
         self._bqml_model: Optional[core.BqmlModel] = None
         self._bqml_model_factory = globals.bqml_model_factory()
 
     @classmethod
     def _from_bq(
-        cls, session: bigframes.Session, model: bigquery.Model
+        cls, session: bigframes.Session, bq_model: bigquery.Model
     ) -> XGBClassifier:
-        assert model.model_type == "BOOSTED_TREE_CLASSIFIER"
-
-        kwargs = {}
+        assert bq_model.model_type == "BOOSTED_TREE_CLASSIFIER"
 
-        # See https://cloud.google.com/bigquery/docs/reference/rest/v2/models#trainingrun
-        last_fitting = model.training_runs[-1]["trainingOptions"]
+        kwargs = utils.retrieve_params_from_bq_model(
+            cls, bq_model, _BQML_PARAMS_MAPPING
+        )
 
-        dummy_classifier = XGBClassifier()
-        for bf_param, bf_value in dummy_classifier.__dict__.items():
-            bqml_param = _BQML_PARAMS_MAPPING.get(bf_param)
-            if bqml_param is not None:
-                kwargs[bf_param] = type(bf_value)(last_fitting[bqml_param])
-
-        new_xgb_classifier = cls(**kwargs)
-        new_xgb_classifier._bqml_model = core.BqmlModel(session, model)
-        return new_xgb_classifier
+        model = cls(**kwargs)
+        model._bqml_model = core.BqmlModel(session, bq_model)
+        return model
 
     @property
     def _bqml_options(self) -> Dict[str, str | int | bool | float | List[str]]:
         """The model options as they will be set for BQML"""
         return {
             "model_type": "BOOSTED_TREE_CLASSIFIER",
             "data_split_method": "NO_SPLIT",
@@ -366,24 +355,24 @@
 
     def __init__(
         self,
         n_estimators: int = 100,
         *,
         tree_method: Literal["auto", "exact", "approx", "hist"] = "auto",
         min_tree_child_weight: int = 1,
-        colsample_bytree=1.0,
-        colsample_bylevel=1.0,
-        colsample_bynode=0.8,
-        gamma=0.00,
+        colsample_bytree: float = 1.0,
+        colsample_bylevel: float = 1.0,
+        colsample_bynode: float = 0.8,
+        gamma: float = 0.0,
         max_depth: int = 15,
-        subsample=0.8,
-        reg_alpha=0.0,
-        reg_lambda=1.0,
-        tol=0.01,
-        enable_global_explain=False,
+        subsample: float = 0.8,
+        reg_alpha: float = 0.0,
+        reg_lambda: float = 1.0,
+        tol: float = 0.01,
+        enable_global_explain: bool = False,
         xgboost_version: Literal["0.9", "1.1"] = "0.9",
     ):
         self.n_estimators = n_estimators
         self.tree_method = tree_method
         self.min_tree_child_weight = min_tree_child_weight
         self.colsample_bytree = colsample_bytree
         self.colsample_bylevel = colsample_bylevel
@@ -397,32 +386,25 @@
         self.enable_global_explain = enable_global_explain
         self.xgboost_version = xgboost_version
         self._bqml_model: Optional[core.BqmlModel] = None
         self._bqml_model_factory = globals.bqml_model_factory()
 
     @classmethod
     def _from_bq(
-        cls, session: bigframes.Session, model: bigquery.Model
+        cls, session: bigframes.Session, bq_model: bigquery.Model
     ) -> RandomForestRegressor:
-        assert model.model_type == "RANDOM_FOREST_REGRESSOR"
-
-        kwargs = {}
+        assert bq_model.model_type == "RANDOM_FOREST_REGRESSOR"
 
-        # See https://cloud.google.com/bigquery/docs/reference/rest/v2/models#trainingrun
-        last_fitting = model.training_runs[-1]["trainingOptions"]
+        kwargs = utils.retrieve_params_from_bq_model(
+            cls, bq_model, _BQML_PARAMS_MAPPING
+        )
 
-        dummy_model = cls()
-        for bf_param, bf_value in dummy_model.__dict__.items():
-            bqml_param = _BQML_PARAMS_MAPPING.get(bf_param)
-            if bqml_param in last_fitting:
-                kwargs[bf_param] = type(bf_value)(last_fitting[bqml_param])
-
-        new_random_forest_regressor = cls(**kwargs)
-        new_random_forest_regressor._bqml_model = core.BqmlModel(session, model)
-        return new_random_forest_regressor
+        model = cls(**kwargs)
+        model._bqml_model = core.BqmlModel(session, bq_model)
+        return model
 
     @property
     def _bqml_options(self) -> Dict[str, str | int | bool | float | List[str]]:
         """The model options as they will be set for BQML"""
         return {
             "model_type": "RANDOM_FOREST_REGRESSOR",
             "early_stop": True,
@@ -538,15 +520,15 @@
         colsample_bynode: float = 0.8,
         gamma: float = 0.00,
         max_depth: int = 15,
         subsample: float = 0.8,
         reg_alpha: float = 0.0,
         reg_lambda: float = 1.0,
         tol: float = 0.01,
-        enable_global_explain=False,
+        enable_global_explain: bool = False,
         xgboost_version: Literal["0.9", "1.1"] = "0.9",
     ):
         self.n_estimators = n_estimators
         self.tree_method = tree_method
         self.min_tree_child_weight = min_tree_child_weight
         self.colsample_bytree = colsample_bytree
         self.colsample_bylevel = colsample_bylevel
@@ -560,32 +542,25 @@
         self.enable_global_explain = enable_global_explain
         self.xgboost_version = xgboost_version
         self._bqml_model: Optional[core.BqmlModel] = None
         self._bqml_model_factory = globals.bqml_model_factory()
 
     @classmethod
     def _from_bq(
-        cls, session: bigframes.Session, model: bigquery.Model
+        cls, session: bigframes.Session, bq_model: bigquery.Model
     ) -> RandomForestClassifier:
-        assert model.model_type == "RANDOM_FOREST_CLASSIFIER"
+        assert bq_model.model_type == "RANDOM_FOREST_CLASSIFIER"
 
-        kwargs = {}
-
-        # See https://cloud.google.com/bigquery/docs/reference/rest/v2/models#trainingrun
-        last_fitting = model.training_runs[-1]["trainingOptions"]
+        kwargs = utils.retrieve_params_from_bq_model(
+            cls, bq_model, _BQML_PARAMS_MAPPING
+        )
 
-        dummy_model = RandomForestClassifier()
-        for bf_param, bf_value in dummy_model.__dict__.items():
-            bqml_param = _BQML_PARAMS_MAPPING.get(bf_param)
-            if bqml_param is not None:
-                kwargs[bf_param] = type(bf_value)(last_fitting[bqml_param])
-
-        new_random_forest_classifier = cls(**kwargs)
-        new_random_forest_classifier._bqml_model = core.BqmlModel(session, model)
-        return new_random_forest_classifier
+        model = cls(**kwargs)
+        model._bqml_model = core.BqmlModel(session, bq_model)
+        return model
 
     @property
     def _bqml_options(self) -> Dict[str, str | int | bool | float | List[str]]:
         """The model options as they will be set for BQML"""
         return {
             "model_type": "RANDOM_FOREST_CLASSIFIER",
             "early_stop": True,
```

### Comparing `bigframes-1.5.0/bigframes/ml/forecasting.py` & `bigframes-1.6.0/bigframes/ml/forecasting.py`

 * *Files 8% similar despite different names*

```diff
@@ -28,14 +28,15 @@
 _BQML_PARAMS_MAPPING = {
     "horizon": "horizon",
     "auto_arima": "autoArima",
     "auto_arima_max_order": "autoArimaMaxOrder",
     "auto_arima_min_order": "autoArimaMinOrder",
     "order": "nonSeasonalOrder",
     "data_frequency": "dataFrequency",
+    "include_drift": "includeDrift",
     "holiday_region": "holidayRegion",
     "clean_spikes_and_dips": "cleanSpikesAndDips",
     "adjust_step_changes": "adjustStepChanges",
     "time_series_length_fraction": "timeSeriesLengthFraction",
     "min_time_series_length": "minTimeSeriesLength",
     "max_time_series_length": "maxTimeSeriesLength",
     "decompose_time_series": "decomposeTimeSeries",
@@ -127,43 +128,26 @@
         self.decompose_time_series = decompose_time_series
         # TODO(garrettwu) add order and seasonalities params, which need struct/array
 
         self._bqml_model: Optional[core.BqmlModel] = None
         self._bqml_model_factory = globals.bqml_model_factory()
 
     @classmethod
-    def _from_bq(cls, session: bigframes.Session, model: bigquery.Model) -> ARIMAPlus:
-        assert model.model_type == "ARIMA_PLUS"
-
-        kwargs: dict = {}
-        last_fitting = model.training_runs[-1]["trainingOptions"]
-
-        dummy_arima = cls()
-        for bf_param, bf_value in dummy_arima.__dict__.items():
-            bqml_param = _BQML_PARAMS_MAPPING.get(bf_param)
-            if bqml_param in last_fitting:
-                # Convert types
-                if bf_param in ["time_series_length_fraction"]:
-                    kwargs[bf_param] = float(last_fitting[bqml_param])
-                elif bf_param in [
-                    "auto_arima_max_order",
-                    "auto_arima_min_order",
-                    "min_time_series_length",
-                    "max_time_series_length",
-                    "trend_smoothing_window_size",
-                ]:
-                    kwargs[bf_param] = int(last_fitting[bqml_param])
-                elif bf_param in ["holiday_region"]:
-                    kwargs[bf_param] = str(last_fitting[bqml_param])
-                else:
-                    kwargs[bf_param] = type(bf_value)(last_fitting[bqml_param])
-
-        new_arima_plus = cls(**kwargs)
-        new_arima_plus._bqml_model = core.BqmlModel(session, model)
-        return new_arima_plus
+    def _from_bq(
+        cls, session: bigframes.Session, bq_model: bigquery.Model
+    ) -> ARIMAPlus:
+        assert bq_model.model_type == "ARIMA_PLUS"
+
+        kwargs = utils.retrieve_params_from_bq_model(
+            cls, bq_model, _BQML_PARAMS_MAPPING
+        )
+
+        model = cls(**kwargs)
+        model._bqml_model = core.BqmlModel(session, bq_model)
+        return model
 
     @property
     def _bqml_options(self) -> dict:
         """The model options as they will be set for BQML."""
         options = {
             "model_type": "ARIMA_PLUS",
             "horizon": self.horizon,
```

### Comparing `bigframes-1.5.0/bigframes/ml/globals.py` & `bigframes-1.6.0/bigframes/ml/globals.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/ml/imported.py` & `bigframes-1.6.0/bigframes/ml/imported.py`

 * *Files 6% similar despite different names*

```diff
@@ -52,21 +52,21 @@
         options = {"model_type": "TENSORFLOW", "model_path": self.model_path}
         return self._bqml_model_factory.create_imported_model(
             session=self.session, options=options
         )
 
     @classmethod
     def _from_bq(
-        cls, session: bigframes.Session, model: bigquery.Model
+        cls, session: bigframes.Session, bq_model: bigquery.Model
     ) -> TensorFlowModel:
-        assert model.model_type == "TENSORFLOW"
+        assert bq_model.model_type == "TENSORFLOW"
 
-        tf_model = cls(session=session, model_path="")
-        tf_model._bqml_model = core.BqmlModel(session, model)
-        return tf_model
+        model = cls(session=session, model_path="")
+        model._bqml_model = core.BqmlModel(session, bq_model)
+        return model
 
     def predict(self, X: Union[bpd.DataFrame, bpd.Series]) -> bpd.DataFrame:
         """Predict the result from input DataFrame.
 
         Args:
             X (bigframes.dataframe.DataFrame):
                 Input DataFrame. Schema is defined by the model.
@@ -130,20 +130,22 @@
     def _create_bqml_model(self):
         options = {"model_type": "ONNX", "model_path": self.model_path}
         return self._bqml_model_factory.create_imported_model(
             session=self.session, options=options
         )
 
     @classmethod
-    def _from_bq(cls, session: bigframes.Session, model: bigquery.Model) -> ONNXModel:
-        assert model.model_type == "ONNX"
-
-        onnx_model = cls(session=session, model_path="")
-        onnx_model._bqml_model = core.BqmlModel(session, model)
-        return onnx_model
+    def _from_bq(
+        cls, session: bigframes.Session, bq_model: bigquery.Model
+    ) -> ONNXModel:
+        assert bq_model.model_type == "ONNX"
+
+        model = cls(session=session, model_path="")
+        model._bqml_model = core.BqmlModel(session, bq_model)
+        return model
 
     def predict(self, X: Union[bpd.DataFrame, bpd.Series]) -> bpd.DataFrame:
         """Predict the result from input DataFrame.
 
         Args:
             X (bigframes.dataframe.DataFrame or bigframes.series.Series):
                 Input DataFrame or Series. Schema is defined by the model.
@@ -245,21 +247,21 @@
                 input=self.input,
                 output=self.output,
                 options=options,
             )
 
     @classmethod
     def _from_bq(
-        cls, session: bigframes.Session, model: bigquery.Model
+        cls, session: bigframes.Session, bq_model: bigquery.Model
     ) -> XGBoostModel:
-        assert model.model_type == "XGBOOST"
+        assert bq_model.model_type == "XGBOOST"
 
-        xgboost_model = cls(session=session, model_path="")
-        xgboost_model._bqml_model = core.BqmlModel(session, model)
-        return xgboost_model
+        model = cls(session=session, model_path="")
+        model._bqml_model = core.BqmlModel(session, bq_model)
+        return model
 
     def predict(self, X: Union[bpd.DataFrame, bpd.Series]) -> bpd.DataFrame:
         """Predict the result from input DataFrame.
 
         Args:
             X (bigframes.dataframe.DataFrame or bigframes.series.Series):
                 Input DataFrame or Series. Schema is defined by the model.
```

### Comparing `bigframes-1.5.0/bigframes/ml/linear_model.py` & `bigframes-1.6.0/bigframes/ml/linear_model.py`

 * *Files 7% similar despite different names*

```diff
@@ -38,15 +38,14 @@
     "learning_rate_strategy": "learnRateStrategy",
     "learning_rate": "learnRate",
     "tol": "minRelativeProgress",
     "ls_init_learning_rate": "initialLearnRate",
     "warm_start": "warmStart",
     "calculate_p_values": "calculatePValues",
     "enable_global_explain": "enableGlobalExplain",
-    "category_encoding_method": "categoryEncodingMethod",
 }
 
 
 @log_adapter.class_logger
 class LinearRegression(
     base.SupervisedTrainablePredictor,
     bigframes_vendored.sklearn.linear_model._base.LinearRegression,
@@ -84,38 +83,25 @@
         self.calculate_p_values = calculate_p_values
         self.enable_global_explain = enable_global_explain
         self._bqml_model: Optional[core.BqmlModel] = None
         self._bqml_model_factory = globals.bqml_model_factory()
 
     @classmethod
     def _from_bq(
-        cls, session: bigframes.Session, model: bigquery.Model
+        cls, session: bigframes.Session, bq_model: bigquery.Model
     ) -> LinearRegression:
-        assert model.model_type == "LINEAR_REGRESSION"
+        assert bq_model.model_type == "LINEAR_REGRESSION"
 
-        # TODO(bmil): construct a standard way to extract these properties
-        kwargs = {}
-
-        # See https://cloud.google.com/bigquery/docs/reference/rest/v2/models#trainingrun
-        last_fitting = model.training_runs[-1]["trainingOptions"]
+        kwargs = utils.retrieve_params_from_bq_model(
+            cls, bq_model, _BQML_PARAMS_MAPPING
+        )
 
-        dummy_linear = cls()
-        for bf_param, bf_value in dummy_linear.__dict__.items():
-            bqml_param = _BQML_PARAMS_MAPPING.get(bf_param)
-            if bqml_param in last_fitting:
-                # Convert types
-                kwargs[bf_param] = (
-                    float(last_fitting[bqml_param])
-                    if bf_param in ["l1_reg", "learning_rate", "ls_init_learning_rate"]
-                    else type(bf_value)(last_fitting[bqml_param])
-                )
-
-        new_linear_regression = cls(**kwargs)
-        new_linear_regression._bqml_model = core.BqmlModel(session, model)
-        return new_linear_regression
+        model = cls(**kwargs)
+        model._bqml_model = core.BqmlModel(session, bq_model)
+        return model
 
     @property
     def _bqml_options(self) -> dict:
         """The model options as they will be set for BQML"""
         options = {
             "model_type": "LINEAR_REG",
             "data_split_method": "NO_SPLIT",
@@ -239,41 +225,32 @@
         self.class_weight = class_weight
         self._auto_class_weight = class_weight == "balanced"
         self._bqml_model: Optional[core.BqmlModel] = None
         self._bqml_model_factory = globals.bqml_model_factory()
 
     @classmethod
     def _from_bq(
-        cls, session: bigframes.Session, model: bigquery.Model
+        cls, session: bigframes.Session, bq_model: bigquery.Model
     ) -> LogisticRegression:
-        assert model.model_type == "LOGISTIC_REGRESSION"
+        assert bq_model.model_type == "LOGISTIC_REGRESSION"
 
-        kwargs = {}
+        kwargs = utils.retrieve_params_from_bq_model(
+            cls, bq_model, _BQML_PARAMS_MAPPING
+        )
 
-        # See https://cloud.google.com/bigquery/docs/reference/rest/v2/models#trainingrun
-        last_fitting = model.training_runs[-1]["trainingOptions"]
-        dummy_logistic = cls()
-        for bf_param, bf_value in dummy_logistic.__dict__.items():
-            bqml_param = _BQML_PARAMS_MAPPING.get(bf_param)
-            if bqml_param in last_fitting:
-                # Convert types
-                kwargs[bf_param] = (
-                    float(last_fitting[bqml_param])
-                    if bf_param in ["l1_reg", "learning_rate", "ls_init_learning_rate"]
-                    else type(bf_value)(last_fitting[bqml_param])
-                )
+        last_fitting = bq_model.training_runs[-1]["trainingOptions"]
         if last_fitting["autoClassWeights"]:
             kwargs["class_weight"] = "balanced"
         # TODO(ashleyxu) support class_weight in the constructor.
         # if "labelClassWeights" in last_fitting:
         #     kwargs["class_weight"] = last_fitting["labelClassWeights"]
 
-        new_logistic_regression = cls(**kwargs)
-        new_logistic_regression._bqml_model = core.BqmlModel(session, model)
-        return new_logistic_regression
+        model = cls(**kwargs)
+        model._bqml_model = core.BqmlModel(session, bq_model)
+        return model
 
     @property
     def _bqml_options(self) -> dict:
         """The model options as they will be set for BQML"""
         options = {
             "model_type": "LOGISTIC_REG",
             "data_split_method": "NO_SPLIT",
```

### Comparing `bigframes-1.5.0/bigframes/ml/llm.py` & `bigframes-1.6.0/bigframes/ml/llm.py`

 * *Files 4% similar despite different names*

```diff
@@ -124,46 +124,38 @@
 
         return self._bqml_model_factory.create_remote_model(
             session=self.session, connection_name=self.connection_name, options=options
         )
 
     @classmethod
     def _from_bq(
-        cls, session: bigframes.Session, model: bigquery.Model
+        cls, session: bigframes.Session, bq_model: bigquery.Model
     ) -> PaLM2TextGenerator:
-        assert model.model_type == "MODEL_TYPE_UNSPECIFIED"
-        assert "remoteModelInfo" in model._properties
-        assert "endpoint" in model._properties["remoteModelInfo"]
-        assert "connection" in model._properties["remoteModelInfo"]
+        assert bq_model.model_type == "MODEL_TYPE_UNSPECIFIED"
+        assert "remoteModelInfo" in bq_model._properties
+        assert "endpoint" in bq_model._properties["remoteModelInfo"]
+        assert "connection" in bq_model._properties["remoteModelInfo"]
 
         # Parse the remote model endpoint
-        bqml_endpoint = model._properties["remoteModelInfo"]["endpoint"]
-        model_connection = model._properties["remoteModelInfo"]["connection"]
+        bqml_endpoint = bq_model._properties["remoteModelInfo"]["endpoint"]
+        model_connection = bq_model._properties["remoteModelInfo"]["connection"]
         model_endpoint = bqml_endpoint.split("/")[-1]
 
-        # Get the optional params
-        kwargs: dict = {}
-        last_fitting = model.training_runs[-1]["trainingOptions"]
-
-        dummy_text_generator = cls(session=session)
-        for bf_param, _ in dummy_text_generator.__dict__.items():
-            bqml_param = _BQML_PARAMS_MAPPING.get(bf_param)
-            if bqml_param in last_fitting:
-                # Convert types
-                if bf_param in ["max_iterations"]:
-                    kwargs[bf_param] = int(last_fitting[bqml_param])
+        kwargs = utils.retrieve_params_from_bq_model(
+            cls, bq_model, _BQML_PARAMS_MAPPING
+        )
 
-        text_generator_model = cls(
+        model = cls(
             **kwargs,
             session=session,
             model_name=model_endpoint,
             connection_name=model_connection,
         )
-        text_generator_model._bqml_model = core.BqmlModel(session, model)
-        return text_generator_model
+        model._bqml_model = core.BqmlModel(session, bq_model)
+        return model
 
     @property
     def _bqml_options(self) -> dict:
         """The model options as they will be set for BQML"""
         options = {
             "max_iterations": self.max_iterations,
             "data_split_method": "NO_SPLIT",
@@ -460,37 +452,38 @@
         }
         return self._bqml_model_factory.create_remote_model(
             session=self.session, connection_name=self.connection_name, options=options
         )
 
     @classmethod
     def _from_bq(
-        cls, session: bigframes.Session, model: bigquery.Model
+        cls, session: bigframes.Session, bq_model: bigquery.Model
     ) -> PaLM2TextEmbeddingGenerator:
-        assert model.model_type == "MODEL_TYPE_UNSPECIFIED"
-        assert "remoteModelInfo" in model._properties
-        assert "endpoint" in model._properties["remoteModelInfo"]
-        assert "connection" in model._properties["remoteModelInfo"]
+        assert bq_model.model_type == "MODEL_TYPE_UNSPECIFIED"
+        assert "remoteModelInfo" in bq_model._properties
+        assert "endpoint" in bq_model._properties["remoteModelInfo"]
+        assert "connection" in bq_model._properties["remoteModelInfo"]
 
         # Parse the remote model endpoint
-        bqml_endpoint = model._properties["remoteModelInfo"]["endpoint"]
-        model_connection = model._properties["remoteModelInfo"]["connection"]
+        bqml_endpoint = bq_model._properties["remoteModelInfo"]["endpoint"]
+        model_connection = bq_model._properties["remoteModelInfo"]["connection"]
         model_endpoint = bqml_endpoint.split("/")[-1]
 
         model_name, version = utils.parse_model_endpoint(model_endpoint)
 
-        embedding_generator_model = cls(
+        model = cls(
             session=session,
             # str to literals
             model_name=model_name,  # type: ignore
             version=version,
             connection_name=model_connection,
         )
-        embedding_generator_model._bqml_model = core.BqmlModel(session, model)
-        return embedding_generator_model
+
+        model._bqml_model = core.BqmlModel(session, bq_model)
+        return model
 
     def predict(self, X: Union[bpd.DataFrame, bpd.Series]) -> bpd.DataFrame:
         """Predict the result from input DataFrame.
 
         Args:
             X (bigframes.dataframe.DataFrame or bigframes.series.Series):
                 Input DataFrame, which needs to contain a column with name "content". Only the column will be used as input. Content can include preamble, questions, suggestions, instructions, or examples.
@@ -612,26 +605,26 @@
 
         return self._bqml_model_factory.create_remote_model(
             session=self.session, connection_name=self.connection_name, options=options
         )
 
     @classmethod
     def _from_bq(
-        cls, session: bigframes.Session, model: bigquery.Model
+        cls, session: bigframes.Session, bq_model: bigquery.Model
     ) -> GeminiTextGenerator:
-        assert model.model_type == "MODEL_TYPE_UNSPECIFIED"
-        assert "remoteModelInfo" in model._properties
-        assert "connection" in model._properties["remoteModelInfo"]
+        assert bq_model.model_type == "MODEL_TYPE_UNSPECIFIED"
+        assert "remoteModelInfo" in bq_model._properties
+        assert "connection" in bq_model._properties["remoteModelInfo"]
 
         # Parse the remote model endpoint
-        model_connection = model._properties["remoteModelInfo"]["connection"]
+        model_connection = bq_model._properties["remoteModelInfo"]["connection"]
 
-        text_generator_model = cls(session=session, connection_name=model_connection)
-        text_generator_model._bqml_model = core.BqmlModel(session, model)
-        return text_generator_model
+        model = cls(session=session, connection_name=model_connection)
+        model._bqml_model = core.BqmlModel(session, bq_model)
+        return model
 
     def predict(
         self,
         X: Union[bpd.DataFrame, bpd.Series],
         *,
         temperature: float = 0.9,
         max_output_tokens: int = 8192,
```

### Comparing `bigframes-1.5.0/bigframes/ml/loader.py` & `bigframes-1.6.0/bigframes/ml/loader.py`

 * *Files 0% similar despite different names*

```diff
@@ -117,24 +117,24 @@
 
     return transformer
 
 
 def _model_from_bq(session: bigframes.Session, bq_model: bigquery.Model):
     if bq_model.model_type in _BQML_MODEL_TYPE_MAPPING:
         return _BQML_MODEL_TYPE_MAPPING[bq_model.model_type]._from_bq(  # type: ignore
-            session=session, model=bq_model
+            session=session, bq_model=bq_model
         )
     if _is_bq_model_remote(bq_model):
         # Parse the remote model endpoint
         bqml_endpoint = bq_model._properties["remoteModelInfo"]["endpoint"]
         model_endpoint = bqml_endpoint.split("/")[-1]
         model_name, _ = utils.parse_model_endpoint(model_endpoint)
 
         return _BQML_ENDPOINT_TYPE_MAPPING[model_name]._from_bq(  # type: ignore
-            session=session, model=bq_model
+            session=session, bq_model=bq_model
         )
 
     raise NotImplementedError(
         f"Model type {bq_model.model_type} is not yet supported by BigQuery DataFrames. {constants.FEEDBACK_LINK}"
     )
```

### Comparing `bigframes-1.5.0/bigframes/ml/metrics/__init__.py` & `bigframes-1.6.0/bigframes/ml/metrics/__init__.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/ml/metrics/_metrics.py` & `bigframes-1.6.0/bigframes/ml/metrics/_metrics.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/ml/metrics/pairwise.py` & `bigframes-1.6.0/bigframes/ml/metrics/pairwise.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/ml/model_selection.py` & `bigframes-1.6.0/bigframes/ml/model_selection.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/ml/pipeline.py` & `bigframes-1.6.0/bigframes/ml/pipeline.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/ml/preprocessing.py` & `bigframes-1.6.0/bigframes/ml/preprocessing.py`

 * *Files 2% similar despite different names*

```diff
@@ -286,18 +286,14 @@
     )
 
     def __init__(
         self,
         n_bins: int = 5,
         strategy: Literal["uniform", "quantile"] = "quantile",
     ):
-        if strategy != "uniform":
-            raise NotImplementedError(
-                f"Only strategy = 'uniform' is supported now, input is {strategy}."
-            )
         if n_bins < 2:
             raise ValueError(
                 f"n_bins has to be larger than or equal to 2, input is {n_bins}."
             )
         self.n_bins = n_bins
         self.strategy = strategy
         self._bqml_model: Optional[core.BqmlModel] = None
@@ -333,38 +329,61 @@
                 min_value = X[column].min()
                 max_value = X[column].max()
                 bin_size = (max_value - min_value) / self.n_bins
                 array_split_points[column] = [
                     min_value + i * bin_size for i in range(self.n_bins - 1)
                 ]
 
-        return [
-            (
-                self._base_sql_generator.ml_bucketize(
-                    column, array_split_points[column], f"kbinsdiscretizer_{column}"
-                ),
-                f"kbinsdiscretizer_{column}",
+            return [
+                (
+                    self._base_sql_generator.ml_bucketize(
+                        column, array_split_points[column], f"kbinsdiscretizer_{column}"
+                    ),
+                    f"kbinsdiscretizer_{column}",
+                )
+                for column in columns
+            ]
+
+        elif self.strategy == "quantile":
+
+            return [
+                (
+                    self._base_sql_generator.ml_quantile_bucketize(
+                        column, self.n_bins, f"kbinsdiscretizer_{column}"
+                    ),
+                    f"kbinsdiscretizer_{column}",
+                )
+                for column in columns
+            ]
+
+        else:
+            raise ValueError(
+                f"strategy should be set 'quantile' or 'uniform', but your input is {self.strategy}."
             )
-            for column in columns
-        ]
 
     @classmethod
     def _parse_from_sql(cls, sql: str) -> tuple[KBinsDiscretizer, str]:
         """Parse SQL to tuple(KBinsDiscretizer, column_label).
 
         Args:
-            sql: SQL string of format "ML.BUCKETIZE({col_label}, array_split_points, FALSE) OVER()"
+            sql: SQL string of format "ML.BUCKETIZE({col_label}, array_split_points, FALSE)"
+                or ML.QUANTILE_BUCKETIZE({col_label}, num_bucket) OVER()"
 
         Returns:
             tuple(KBinsDiscretizer, column_label)"""
         s = sql[sql.find("(") + 1 : sql.find(")")]
-        array_split_points = s[s.find("[") + 1 : s.find("]")]
         col_label = s[: s.find(",")]
-        n_bins = array_split_points.count(",") + 2
-        return cls(n_bins, "uniform"), col_label
+
+        if sql.startswith("ML.QUANTILE_BUCKETIZE"):
+            num_bins = s.split(",")[1]
+            return cls(int(num_bins), "quantile"), col_label
+        else:
+            array_split_points = s[s.find("[") + 1 : s.find("]")]
+            n_bins = array_split_points.count(",") + 2
+            return cls(n_bins, "uniform"), col_label
 
     def fit(
         self,
         X: Union[bpd.DataFrame, bpd.Series],
         y=None,  # ignored
     ) -> KBinsDiscretizer:
         (X,) = utils.convert_to_dataframe(X)
```

### Comparing `bigframes-1.5.0/bigframes/ml/remote.py` & `bigframes-1.6.0/bigframes/ml/remote.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/ml/sql.py` & `bigframes-1.6.0/bigframes/ml/sql.py`

 * *Files 2% similar despite different names*

```diff
@@ -105,17 +105,26 @@
 
     def ml_bucketize(
         self,
         numeric_expr_sql: str,
         array_split_points: Iterable[Union[int, float]],
         name: str,
     ) -> str:
-        """Encode ML.MIN_MAX_SCALER for BQML"""
+        """Encode ML.BUCKETIZE for BQML"""
         return f"""ML.BUCKETIZE({numeric_expr_sql}, {array_split_points}, FALSE) AS {name}"""
 
+    def ml_quantile_bucketize(
+        self,
+        numeric_expr_sql: str,
+        num_bucket: int,
+        name: str,
+    ) -> str:
+        """Encode ML.QUANTILE_BUCKETIZE for BQML"""
+        return f"""ML.QUANTILE_BUCKETIZE({numeric_expr_sql}, {num_bucket}) OVER() AS {name}"""
+
     def ml_one_hot_encoder(
         self,
         numeric_expr_sql: str,
         drop: str,
         top_k: int,
         frequency_threshold: int,
         name: str,
```

### Comparing `bigframes-1.5.0/bigframes/operations/__init__.py` & `bigframes-1.6.0/bigframes/operations/__init__.py`

 * *Files 2% similar despite different names*

```diff
@@ -13,15 +13,15 @@
 # limitations under the License.
 
 from __future__ import annotations
 
 import dataclasses
 import functools
 import typing
-from typing import Tuple, Union
+from typing import Union
 
 import numpy as np
 import pandas as pd
 import pyarrow as pa
 
 import bigframes.dtypes as dtypes
 import bigframes.operations.type as op_typing
@@ -42,32 +42,52 @@
     @property
     def order_preserving(self) -> bool:
         """Whether the row operation preserves total ordering. Can be pruned from ordering expressions."""
         ...
 
 
 @dataclasses.dataclass(frozen=True)
-class NaryOp:
+class ScalarOp:
     @property
     def name(self) -> str:
         raise NotImplementedError("RowOp abstract base class has no implementation")
 
     def output_type(self, *input_types: dtypes.ExpressionType) -> dtypes.ExpressionType:
         raise NotImplementedError("Abstract operation has no output type")
 
     @property
     def order_preserving(self) -> bool:
         """Whether the row operation preserves total ordering. Can be pruned from ordering expressions."""
         return False
 
 
+@dataclasses.dataclass(frozen=True)
+class NaryOp(ScalarOp):
+    def as_expr(
+        self,
+        *exprs: Union[str | bigframes.core.expression.Expression],
+    ) -> bigframes.core.expression.Expression:
+        import bigframes.core.expression
+
+        # Keep this in sync with output_type and compilers
+        inputs: list[bigframes.core.expression.Expression] = []
+
+        for expr in exprs:
+            inputs.append(_convert_expr_input(expr))
+
+        return bigframes.core.expression.OpExpression(
+            self,
+            tuple(inputs),
+        )
+
+
 # These classes can be used to create simple ops that don't take local parameters
 # All is needed is a unique name, and to register an implementation in ibis_mappings.py
 @dataclasses.dataclass(frozen=True)
-class UnaryOp(NaryOp):
+class UnaryOp(ScalarOp):
     @property
     def arguments(self) -> int:
         return 1
 
     def as_expr(
         self, input_id: typing.Union[str, bigframes.core.expression.Expression] = "arg"
     ) -> bigframes.core.expression.Expression:
@@ -75,15 +95,15 @@
 
         return bigframes.core.expression.OpExpression(
             self, (_convert_expr_input(input_id),)
         )
 
 
 @dataclasses.dataclass(frozen=True)
-class BinaryOp(NaryOp):
+class BinaryOp(ScalarOp):
     @property
     def arguments(self) -> int:
         return 2
 
     def as_expr(
         self,
         left_input: typing.Union[str, bigframes.core.expression.Expression] = "arg1",
@@ -97,15 +117,15 @@
                 _convert_expr_input(left_input),
                 _convert_expr_input(right_input),
             ),
         )
 
 
 @dataclasses.dataclass(frozen=True)
-class TernaryOp(NaryOp):
+class TernaryOp(ScalarOp):
     @property
     def arguments(self) -> int:
         return 3
 
     def as_expr(
         self,
         input1: typing.Union[str, bigframes.core.expression.Expression] = "arg1",
@@ -363,14 +383,27 @@
     pat: typing.Sequence[str]
 
     def output_type(self, *input_types):
         return op_typing.STRING_PREDICATE.output_type(input_types[0])
 
 
 @dataclasses.dataclass(frozen=True)
+class StringSplitOp(UnaryOp):
+    name: typing.ClassVar[str] = "str_split"
+    pat: typing.Sequence[str]
+
+    def output_type(self, *input_types):
+        input_type = input_types[0]
+        if not isinstance(input_type, pd.StringDtype):
+            raise TypeError("field accessor input must be a string type")
+        arrow_type = dtypes.bigframes_dtype_to_arrow_dtype(input_type)
+        return pd.ArrowDtype(pa.list_(arrow_type))
+
+
+@dataclasses.dataclass(frozen=True)
 class EndsWithOp(UnaryOp):
     name: typing.ClassVar[str] = "str_endswith"
     pat: typing.Sequence[str]
 
     def output_type(self, *input_types):
         return op_typing.STRING_PREDICATE.output_type(input_types[0])
 
@@ -439,17 +472,15 @@
             raise TypeError("field accessor input must be a struct type")
 
         pa_type = input_type.pyarrow_dtype
         if not isinstance(pa_type, pa.StructType):
             raise TypeError("field accessor input must be a struct type")
 
         pa_result_type = pa_type[self.name_or_index].type
-        # TODO: Directly convert from arrow to pandas type
-        ibis_result_type = dtypes.arrow_dtype_to_ibis_dtype(pa_result_type)
-        return dtypes.ibis_dtype_to_bigframes_dtype(ibis_result_type)
+        return dtypes.arrow_dtype_to_bigframes_dtype(pa_result_type)
 
 
 @dataclasses.dataclass(frozen=True)
 class AsTypeOp(UnaryOp):
     name: typing.ClassVar[str] = "astype"
     # TODO: Convert strings to dtype earlier
     to_type: dtypes.DtypeString | dtypes.Dtype
@@ -521,16 +552,16 @@
 
     def output_type(self, *input_types):
         return input_types[0]
 
 
 # Binary Ops
 fillna_op = create_binary_op(name="fillna", type_signature=op_typing.COERCE)
-cliplower_op = create_binary_op(name="clip_lower", type_signature=op_typing.COERCE)
-clipupper_op = create_binary_op(name="clip_upper", type_signature=op_typing.COERCE)
+maximum_op = create_binary_op(name="maximum", type_signature=op_typing.COERCE)
+minimum_op = create_binary_op(name="minimum", type_signature=op_typing.COERCE)
 coalesce_op = create_binary_op(name="coalesce", type_signature=op_typing.COERCE)
 
 
 ## Math Ops
 @dataclasses.dataclass(frozen=True)
 class AddOp(BinaryOp):
     name: typing.ClassVar[str] = "add"
@@ -563,14 +594,24 @@
         ):
             # Numeric subtraction
             return dtypes.coerce_to_common(left_type, right_type)
         # TODO: Add temporal addition once delta types supported
         raise TypeError(f"Cannot subtract dtypes {left_type} and {right_type}")
 
 
+@dataclasses.dataclass(frozen=True)
+class BinaryRemoteFunctionOp(BinaryOp):
+    name: typing.ClassVar[str] = "binary_remote_function"
+    func: typing.Callable
+
+    def output_type(self, *input_types):
+        # This property should be set to a valid Dtype by the @remote_function decorator or read_gbq_function method
+        return self.func.output_dtype
+
+
 add_op = AddOp()
 sub_op = SubOp()
 mul_op = create_binary_op(name="mul", type_signature=op_typing.BINARY_NUMERIC)
 div_op = create_binary_op(name="div", type_signature=op_typing.BINARY_REAL_NUMERIC)
 floordiv_op = create_binary_op(name="floordiv", type_signature=op_typing.BINARY_NUMERIC)
 pow_op = create_binary_op(name="pow", type_signature=op_typing.BINARY_NUMERIC)
 mod_op = create_binary_op(name="mod", type_signature=op_typing.BINARY_NUMERIC)
@@ -651,35 +692,14 @@
             raise TypeError(f"Case inputs {input_types[::2]} must be boolean-valued")
         output_expr_types = input_types[1::2]
         return functools.reduce(
             lambda t1, t2: dtypes.coerce_to_common(t1, t2),
             output_expr_types,
         )
 
-    def as_expr(
-        self,
-        *case_output_pairs: Tuple[
-            Union[str | bigframes.core.expression.Expression],
-            Union[str | bigframes.core.expression.Expression],
-        ],
-    ) -> bigframes.core.expression.Expression:
-        import bigframes.core.expression
-
-        # Keep this in sync with output_type and compilers
-        inputs: list[bigframes.core.expression.Expression] = []
-
-        for case, output in case_output_pairs:
-            inputs.append(_convert_expr_input(case))
-            inputs.append(_convert_expr_input(output))
-
-        return bigframes.core.expression.OpExpression(
-            self,
-            tuple(inputs),
-        )
-
 
 case_when_op = CaseWhenOp()
 
 
 # Just parameterless unary ops for now
 # TODO: Parameter mappings
 NUMPY_TO_OP: typing.Final = {
@@ -710,8 +730,10 @@
 NUMPY_TO_BINOP: typing.Final = {
     np.add: add_op,
     np.subtract: sub_op,
     np.multiply: mul_op,
     np.divide: div_op,
     np.power: pow_op,
     np.arctan2: arctan2_op,
+    np.maximum: maximum_op,
+    np.minimum: minimum_op,
 }
```

### Comparing `bigframes-1.5.0/bigframes/operations/_matplotlib/__init__.py` & `bigframes-1.6.0/bigframes/operations/_matplotlib/__init__.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/operations/_matplotlib/core.py` & `bigframes-1.6.0/bigframes/operations/_matplotlib/core.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/operations/_matplotlib/hist.py` & `bigframes-1.6.0/bigframes/operations/_matplotlib/hist.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/operations/aggregations.py` & `bigframes-1.6.0/bigframes/operations/aggregations.py`

 * *Files 5% similar despite different names*

```diff
@@ -30,16 +30,16 @@
 class WindowOp:
     @property
     def skips_nulls(self):
         """Whether the window op skips null rows."""
         return True
 
     @property
-    def handles_ties(self):
-        """Whether the operator can handle ties without nondeterministic output. (eg. rank operator can handle ties but not the count operator)"""
+    def uses_total_row_ordering(self):
+        """Whether the operator needs total row ordering. (eg. lead, lag, array_agg)"""
         return False
 
     @abc.abstractmethod
     def output_type(self, *input_types: dtypes.ExpressionType) -> dtypes.ExpressionType:
         ...
 
 
@@ -228,18 +228,14 @@
     bins: typing.Union[int, Iterable]
     labels: Optional[bool]
 
     @property
     def skips_nulls(self):
         return False
 
-    @property
-    def handles_ties(self):
-        return True
-
     def output_type(self, *input_types: dtypes.ExpressionType) -> dtypes.ExpressionType:
         if isinstance(self.bins, int) and (self.labels is False):
             return dtypes.INT_DTYPE
         else:
             # Assumption: buckets use same numeric type
             interval_dtype = (
                 pa.float64()
@@ -263,18 +259,14 @@
     def name(self):
         return f"qcut-{self.quantiles}"
 
     @property
     def skips_nulls(self):
         return False
 
-    @property
-    def handles_ties(self):
-        return True
-
     def output_type(self, *input_types: dtypes.ExpressionType) -> dtypes.ExpressionType:
         return signatures.FixedOutputType(
             dtypes.is_orderable, dtypes.INT_DTYPE, "orderable"
         ).output_type(input_types[0])
 
 
 @dataclasses.dataclass(frozen=True)
@@ -304,78 +296,94 @@
 class RankOp(UnaryWindowOp):
     name: ClassVar[str] = "rank"
 
     @property
     def skips_nulls(self):
         return False
 
-    @property
-    def handles_ties(self):
-        return True
-
     def output_type(self, *input_types: dtypes.ExpressionType) -> dtypes.ExpressionType:
         return signatures.FixedOutputType(
             dtypes.is_orderable, dtypes.INT_DTYPE, "orderable"
         ).output_type(input_types[0])
 
 
 @dataclasses.dataclass(frozen=True)
 class DenseRankOp(UnaryWindowOp):
     @property
     def skips_nulls(self):
         return False
 
-    @property
-    def handles_ties(self):
-        return True
-
     def output_type(self, *input_types: dtypes.ExpressionType) -> dtypes.ExpressionType:
         return signatures.FixedOutputType(
             dtypes.is_orderable, dtypes.INT_DTYPE, "orderable"
         ).output_type(input_types[0])
 
 
 @dataclasses.dataclass(frozen=True)
 class FirstOp(UnaryWindowOp):
     name: ClassVar[str] = "first"
 
+    @property
+    def uses_total_row_ordering(self):
+        return True
+
 
 @dataclasses.dataclass(frozen=True)
 class FirstNonNullOp(UnaryWindowOp):
     @property
+    def uses_total_row_ordering(self):
+        return True
+
+    @property
     def skips_nulls(self):
         return False
 
 
 @dataclasses.dataclass(frozen=True)
 class LastOp(UnaryWindowOp):
     name: ClassVar[str] = "last"
 
+    @property
+    def uses_total_row_ordering(self):
+        return True
+
 
 @dataclasses.dataclass(frozen=True)
 class LastNonNullOp(UnaryWindowOp):
     @property
+    def uses_total_row_ordering(self):
+        return True
+
+    @property
     def skips_nulls(self):
         return False
 
 
 @dataclasses.dataclass(frozen=True)
 class ShiftOp(UnaryWindowOp):
     periods: int
 
     @property
+    def uses_total_row_ordering(self):
+        return True
+
+    @property
     def skips_nulls(self):
         return False
 
 
 @dataclasses.dataclass(frozen=True)
 class DiffOp(UnaryWindowOp):
     periods: int
 
     @property
+    def uses_total_row_ordering(self):
+        return True
+
+    @property
     def skips_nulls(self):
         return False
 
 
 @dataclasses.dataclass(frozen=True)
 class AllOp(UnaryAggregateOp):
     name: ClassVar[str] = "all"
```

### Comparing `bigframes-1.5.0/bigframes/operations/base.py` & `bigframes-1.6.0/bigframes/operations/base.py`

 * *Files 4% similar despite different names*

```diff
@@ -11,14 +11,15 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from __future__ import annotations
 
 import typing
+from typing import List, Sequence
 
 import bigframes_vendored.pandas.pandas._typing as vendored_pandas_typing
 import numpy
 import pandas as pd
 
 import bigframes.constants as constants
 import bigframes.core.blocks as blocks
@@ -201,14 +202,29 @@
             expr = op.as_expr(
                 ex.const(other) if reverse else self._value_column,
                 self._value_column if reverse else ex.const(other),
             )
             block, result_id = self._block.project_expr(expr, name)
             return series.Series(block.select_column(result_id))
 
+    def _apply_nary_op(
+        self,
+        op: ops.NaryOp,
+        others: Sequence[typing.Union[series.Series, scalars.Scalar]],
+        ignore_self=False,
+    ):
+        """Applies an n-ary operator to the series and others."""
+        values, block = self._align_n(others, ignore_self=ignore_self)
+        block, result_id = block.apply_nary_op(
+            values,
+            op,
+            self._name,
+        )
+        return series.Series(block.select_column(result_id))
+
     def _apply_binary_aggregation(
         self, other: series.Series, stat: agg_ops.BinaryAggregateOp
     ) -> float:
         (left, right, block) = self._align(other, how="outer")
 
         return block.get_binary_stat(left, right, stat)
 
@@ -222,16 +238,21 @@
         )
         return (values[0], values[1], block)
 
     def _align_n(
         self,
         others: typing.Sequence[typing.Union[series.Series, scalars.Scalar]],
         how="outer",
+        ignore_self=False,
     ) -> tuple[typing.Sequence[str], blocks.Block]:
-        value_ids = [self._value_column]
+        if ignore_self:
+            value_ids: List[str] = []
+        else:
+            value_ids = [self._value_column]
+
         block = self._block
         for other in others:
             if isinstance(other, series.Series):
                 block, (
                     get_column_left,
                     get_column_right,
                 ) = block.join(other._block, how=how)
```

### Comparing `bigframes-1.5.0/bigframes/operations/datetimes.py` & `bigframes-1.6.0/bigframes/operations/datetimes.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/operations/plotting.py` & `bigframes-1.6.0/bigframes/operations/plotting.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/operations/strings.py` & `bigframes-1.6.0/bigframes/operations/strings.py`

 * *Files 3% similar despite different names*

```diff
@@ -243,14 +243,26 @@
         self,
         pat: Union[str, tuple[str, ...]],
     ) -> series.Series:
         if not isinstance(pat, tuple):
             pat = (pat,)
         return self._apply_unary_op(ops.EndsWithOp(pat=pat))
 
+    def split(
+        self,
+        pat: str = " ",
+        regex: Union[bool, None] = None,
+    ) -> series.Series:
+        if regex is True or (regex is None and len(pat) > 1):
+            raise NotImplementedError(
+                "Regular expressions aren't currently supported. Please set "
+                + f"`regex=False` and try again. {constants.FEEDBACK_LINK}"
+            )
+        return self._apply_unary_op(ops.StringSplitOp(pat=pat))
+
     def zfill(self, width: int) -> series.Series:
         return self._apply_unary_op(ops.ZfillOp(width=width))
 
     def center(self, width: int, fillchar: str = " ") -> series.Series:
         return self._apply_unary_op(
             ops.StrPadOp(length=width, fillchar=fillchar, side="both")
         )
```

### Comparing `bigframes-1.5.0/bigframes/operations/structs.py` & `bigframes-1.6.0/bigframes/operations/structs.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/operations/type.py` & `bigframes-1.6.0/bigframes/operations/type.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/pandas/__init__.py` & `bigframes-1.6.0/bigframes/pandas/__init__.py`

 * *Files 1% similar despite different names*

```diff
@@ -63,14 +63,15 @@
 import bigframes.core.reshape
 import bigframes.core.tools
 import bigframes.dataframe
 import bigframes.enums
 import bigframes.operations as ops
 import bigframes.series
 import bigframes.session
+import bigframes.session._io.bigquery
 import bigframes.session.clients
 
 
 # Include method definition so that the method appears in our docs for
 # bigframes.pandas general functions.
 @typing.overload
 def concat(
@@ -387,15 +388,15 @@
         credentials=options.bigquery.credentials,
         application_name=options.bigquery.application_name,
         bq_kms_key_name=options.bigquery.kms_key_name,
     )
 
     bqclient = clients_provider.bqclient
 
-    if bigframes.session._is_query(query):
+    if bigframes.session._io.bigquery.is_query(query):
         job = bqclient.query(query, bigquery.QueryJobConfig(dry_run=True))
         options.bigquery.location = job.location
     else:
         table = bqclient.get_table(query)
         options.bigquery.location = table.location
 
 
@@ -649,14 +650,15 @@
     packages: Optional[Sequence[str]] = None,
     cloud_function_service_account: Optional[str] = None,
     cloud_function_kms_key_name: Optional[str] = None,
     cloud_function_docker_repository: Optional[str] = None,
     max_batching_rows: Optional[int] = 1000,
     cloud_function_timeout: Optional[int] = 600,
     cloud_function_max_instances: Optional[int] = None,
+    cloud_function_vpc_connector: Optional[str] = None,
 ):
     return global_session.with_default_session(
         bigframes.session.Session.remote_function,
         input_types=input_types,
         output_type=output_type,
         dataset=dataset,
         bigquery_connection=bigquery_connection,
@@ -665,14 +667,15 @@
         packages=packages,
         cloud_function_service_account=cloud_function_service_account,
         cloud_function_kms_key_name=cloud_function_kms_key_name,
         cloud_function_docker_repository=cloud_function_docker_repository,
         max_batching_rows=max_batching_rows,
         cloud_function_timeout=cloud_function_timeout,
         cloud_function_max_instances=cloud_function_max_instances,
+        cloud_function_vpc_connector=cloud_function_vpc_connector,
     )
 
 
 remote_function.__doc__ = inspect.getdoc(bigframes.session.Session.remote_function)
 
 
 def read_gbq_function(function_name: str):
```

### Comparing `bigframes-1.5.0/bigframes/series.py` & `bigframes-1.6.0/bigframes/series.py`

 * *Files 2% similar despite different names*

```diff
@@ -406,54 +406,73 @@
             )
         left_op = ops.ge_op if (inclusive in ["left", "both"]) else ops.gt_op
         right_op = ops.le_op if (inclusive in ["right", "both"]) else ops.lt_op
         return self._apply_binary_op(left, left_op).__and__(
             self._apply_binary_op(right, right_op)
         )
 
+    def case_when(self, caselist) -> Series:
+        return self._apply_nary_op(
+            ops.case_when_op,
+            tuple(
+                itertools.chain(
+                    itertools.chain(*caselist),
+                    # Fallback to current value if no other matches.
+                    (
+                        # We make a Series with a constant value to avoid casts to
+                        # types other than boolean.
+                        Series(True, index=self.index, dtype=pandas.BooleanDtype()),
+                        self,
+                    ),
+                ),
+            ),
+            # Self is already included in "others".
+            ignore_self=True,
+        )
+
     def cumsum(self) -> Series:
         return self._apply_window_op(
-            agg_ops.sum_op, bigframes.core.window_spec.WindowSpec(following=0)
+            agg_ops.sum_op, bigframes.core.window_spec.cumulative_rows()
         )
 
     def ffill(self, *, limit: typing.Optional[int] = None) -> Series:
-        window = bigframes.core.window_spec.WindowSpec(preceding=limit, following=0)
+        window = bigframes.core.window_spec.rows(preceding=limit, following=0)
         return self._apply_window_op(agg_ops.LastNonNullOp(), window)
 
     pad = ffill
     pad.__doc__ = inspect.getdoc(vendored_pandas_series.Series.ffill)
 
     def bfill(self, *, limit: typing.Optional[int] = None) -> Series:
-        window = bigframes.core.window_spec.WindowSpec(preceding=0, following=limit)
+        window = bigframes.core.window_spec.rows(preceding=0, following=limit)
         return self._apply_window_op(agg_ops.FirstNonNullOp(), window)
 
     def cummax(self) -> Series:
         return self._apply_window_op(
-            agg_ops.max_op, bigframes.core.window_spec.WindowSpec(following=0)
+            agg_ops.max_op, bigframes.core.window_spec.cumulative_rows()
         )
 
     def cummin(self) -> Series:
         return self._apply_window_op(
-            agg_ops.min_op, bigframes.core.window_spec.WindowSpec(following=0)
+            agg_ops.min_op, bigframes.core.window_spec.cumulative_rows()
         )
 
     def cumprod(self) -> Series:
         return self._apply_window_op(
-            agg_ops.product_op, bigframes.core.window_spec.WindowSpec(following=0)
+            agg_ops.product_op, bigframes.core.window_spec.cumulative_rows()
         )
 
     def shift(self, periods: int = 1) -> Series:
-        window = bigframes.core.window_spec.WindowSpec(
+        window = bigframes.core.window_spec.rows(
             preceding=periods if periods > 0 else None,
             following=-periods if periods < 0 else None,
         )
         return self._apply_window_op(agg_ops.ShiftOp(periods), window)
 
     def diff(self, periods: int = 1) -> Series:
-        window = bigframes.core.window_spec.WindowSpec(
+        window = bigframes.core.window_spec.rows(
             preceding=periods if periods > 0 else None,
             following=-periods if periods < 0 else None,
         )
         return self._apply_window_op(agg_ops.DiffOp(periods), window)
 
     def pct_change(self, periods: int = 1) -> Series:
         # Future versions of pandas will not perfrom ffill automatically
@@ -932,15 +951,15 @@
             by_column_ids=[self._value_column],
             aggregations=((self._value_column, agg_ops.count_op),),
         )
         value_count_col_id = agg_ids[0]
         block, max_value_count_col_id = block.apply_window_op(
             value_count_col_id,
             agg_ops.max_op,
-            window_spec=bigframes.core.window_spec.WindowSpec(),
+            window_spec=bigframes.core.window_spec.unbound(),
         )
         block, is_mode_col_id = block.apply_binary_op(
             value_count_col_id,
             max_value_count_col_id,
             ops.eq_op,
         )
         block = block.filter_by_id(is_mode_col_id)
@@ -1008,17 +1027,17 @@
         )
         return Series(block.select_column(result_id).with_column_labels([self.name]))
 
     def clip(self, lower, upper):
         if lower is None and upper is None:
             return self
         if lower is None:
-            return self._apply_binary_op(upper, ops.clipupper_op, alignment="left")
+            return self._apply_binary_op(upper, ops.minimum_op, alignment="left")
         if upper is None:
-            return self._apply_binary_op(lower, ops.cliplower_op, alignment="left")
+            return self._apply_binary_op(lower, ops.maximum_op, alignment="left")
         value_id, lower_id, upper_id, block = self._align3(lower, upper)
         block, result_id = block.apply_ternary_op(
             value_id, lower_id, upper_id, ops.clip_op
         )
         return Series(block.select_column(result_id).with_column_labels([self.name]))
 
     def argmax(self) -> int:
@@ -1203,24 +1222,24 @@
             for column in block.index_columns
         ]
         block = block.order_by(ordering)
         return Series(block)
 
     def rolling(self, window: int, min_periods=None) -> bigframes.core.window.Window:
         # To get n size window, need current row and n-1 preceding rows.
-        window_spec = bigframes.core.window_spec.WindowSpec(
+        window_spec = bigframes.core.window_spec.rows(
             preceding=window - 1, following=0, min_periods=min_periods or window
         )
         return bigframes.core.window.Window(
             self._block, window_spec, self._block.value_columns, is_series=True
         )
 
     def expanding(self, min_periods: int = 1) -> bigframes.core.window.Window:
-        window_spec = bigframes.core.window_spec.WindowSpec(
-            following=0, min_periods=min_periods
+        window_spec = bigframes.core.window_spec.cumulative_rows(
+            min_periods=min_periods
         )
         return bigframes.core.window.Window(
             self._block, window_spec, self._block.value_columns, is_series=True
         )
 
     def groupby(
         self,
@@ -1351,14 +1370,46 @@
         )
 
         # return Series with materialized result so that any error in the remote
         # function is caught early
         materialized_series = result_series._cached()
         return materialized_series
 
+    def combine(
+        self,
+        other,
+        func,
+    ) -> Series:
+        if not callable(func):
+            raise ValueError(
+                "Only a ufunc (a function that applies to the entire Series) or a remote function that only works on single values are supported."
+            )
+
+        if not hasattr(func, "bigframes_remote_function"):
+            # Keep this in sync with .apply
+            try:
+                return func(self, other)
+            except Exception as ex:
+                # This could happen if any of the operators in func is not
+                # supported on a Series. Let's guide the customer to use a
+                # remote function instead
+                if hasattr(ex, "message"):
+                    ex.message += f"\n{_remote_function_recommendation_message}"
+                raise
+
+        reprojected_series = Series(self._block._force_reproject())
+        result_series = reprojected_series._apply_binary_op(
+            other, ops.BinaryRemoteFunctionOp(func=func)
+        )
+
+        # return Series with materialized result so that any error in the remote
+        # function is caught early
+        materialized_series = result_series._cached()
+        return materialized_series
+
     def add_prefix(self, prefix: str, axis: int | str | None = None) -> Series:
         return Series(self._get_block().add_prefix(prefix))
 
     def add_suffix(self, suffix: str, axis: int | str | None = None) -> Series:
         return Series(self._get_block().add_suffix(suffix))
 
     def filter(
```

### Comparing `bigframes-1.5.0/bigframes/session/__init__.py` & `bigframes-1.6.0/bigframes/session/__init__.py`

 * *Files 2% similar despite different names*

```diff
@@ -39,5014 +39,4924 @@
 00000260: 2074 6f20 4269 6751 7565 7279 2e22 2222   to BigQuery."""
 00000270: 0a0a 6672 6f6d 205f 5f66 7574 7572 655f  ..from __future_
 00000280: 5f20 696d 706f 7274 2061 6e6e 6f74 6174  _ import annotat
 00000290: 696f 6e73 0a0a 696d 706f 7274 2063 6f70  ions..import cop
 000002a0: 790a 696d 706f 7274 2064 6174 6574 696d  y.import datetim
 000002b0: 650a 696d 706f 7274 206c 6f67 6769 6e67  e.import logging
 000002c0: 0a69 6d70 6f72 7420 6f73 0a69 6d70 6f72  .import os.impor
-000002d0: 7420 7265 0a69 6d70 6f72 7420 7365 6372  t re.import secr
-000002e0: 6574 730a 696d 706f 7274 2074 7970 696e  ets.import typin
-000002f0: 670a 6672 6f6d 2074 7970 696e 6720 696d  g.from typing im
-00000300: 706f 7274 2028 0a20 2020 2041 6e79 2c0a  port (.    Any,.
-00000310: 2020 2020 4361 6c6c 6162 6c65 2c0a 2020      Callable,.  
-00000320: 2020 4469 6374 2c0a 2020 2020 494f 2c0a    Dict,.    IO,.
-00000330: 2020 2020 4974 6572 6162 6c65 2c0a 2020      Iterable,.  
-00000340: 2020 4c69 7374 2c0a 2020 2020 4c69 7465    List,.    Lite
-00000350: 7261 6c2c 0a20 2020 204d 6170 7069 6e67  ral,.    Mapping
-00000360: 2c0a 2020 2020 4d75 7461 626c 6553 6571  ,.    MutableSeq
-00000370: 7565 6e63 652c 0a20 2020 204f 7074 696f  uence,.    Optio
-00000380: 6e61 6c2c 0a20 2020 2053 6571 7565 6e63  nal,.    Sequenc
-00000390: 652c 0a20 2020 2054 7570 6c65 2c0a 2020  e,.    Tuple,.  
-000003a0: 2020 556e 696f 6e2c 0a29 0a69 6d70 6f72    Union,.).impor
-000003b0: 7420 7575 6964 0a69 6d70 6f72 7420 7761  t uuid.import wa
-000003c0: 726e 696e 6773 0a0a 2320 4576 656e 2074  rnings..# Even t
-000003d0: 686f 7567 6820 7468 6520 6962 6973 2e62  hough the ibis.b
-000003e0: 6163 6b65 6e64 732e 6269 6771 7565 7279  ackends.bigquery
-000003f0: 2069 6d70 6f72 7420 6973 2075 6e75 7365   import is unuse
-00000400: 642c 2069 7427 7320 6e65 6564 6564 0a23  d, it's needed.#
-00000410: 2074 6f20 7265 6769 7374 6572 206e 6577   to register new
-00000420: 2061 6e64 2072 6570 6c61 6365 6d65 6e74   and replacement
-00000430: 206f 7073 2077 6974 6820 7468 6520 4962   ops with the Ib
-00000440: 6973 2042 6967 5175 6572 7920 6261 636b  is BigQuery back
-00000450: 656e 642e 0a69 6d70 6f72 7420 6269 6766  end..import bigf
-00000460: 7261 6d65 735f 7665 6e64 6f72 6564 2e69  rames_vendored.i
-00000470: 6269 732e 6261 636b 656e 6473 2e62 6967  bis.backends.big
-00000480: 7175 6572 7920 2023 206e 6f71 610a 696d  query  # noqa.im
-00000490: 706f 7274 2062 6967 6672 616d 6573 5f76  port bigframes_v
-000004a0: 656e 646f 7265 642e 7061 6e64 6173 2e69  endored.pandas.i
-000004b0: 6f2e 6762 7120 6173 2074 6869 7264 5f70  o.gbq as third_p
-000004c0: 6172 7479 5f70 616e 6461 735f 6762 710a  arty_pandas_gbq.
-000004d0: 696d 706f 7274 2062 6967 6672 616d 6573  import bigframes
-000004e0: 5f76 656e 646f 7265 642e 7061 6e64 6173  _vendored.pandas
-000004f0: 2e69 6f2e 7061 7271 7565 7420 6173 2074  .io.parquet as t
-00000500: 6869 7264 5f70 6172 7479 5f70 616e 6461  hird_party_panda
-00000510: 735f 7061 7271 7565 740a 696d 706f 7274  s_parquet.import
-00000520: 2062 6967 6672 616d 6573 5f76 656e 646f   bigframes_vendo
-00000530: 7265 642e 7061 6e64 6173 2e69 6f2e 7061  red.pandas.io.pa
-00000540: 7273 6572 732e 7265 6164 6572 7320 6173  rsers.readers as
-00000550: 2074 6869 7264 5f70 6172 7479 5f70 616e   third_party_pan
-00000560: 6461 735f 7265 6164 6572 730a 696d 706f  das_readers.impo
-00000570: 7274 2062 6967 6672 616d 6573 5f76 656e  rt bigframes_ven
-00000580: 646f 7265 642e 7061 6e64 6173 2e69 6f2e  dored.pandas.io.
-00000590: 7069 636b 6c65 2061 7320 7468 6972 645f  pickle as third_
-000005a0: 7061 7274 795f 7061 6e64 6173 5f70 6963  party_pandas_pic
-000005b0: 6b6c 650a 696d 706f 7274 2067 6f6f 676c  kle.import googl
-000005c0: 652e 6170 695f 636f 7265 2e63 6c69 656e  e.api_core.clien
-000005d0: 745f 696e 666f 0a69 6d70 6f72 7420 676f  t_info.import go
-000005e0: 6f67 6c65 2e61 7069 5f63 6f72 652e 636c  ogle.api_core.cl
-000005f0: 6965 6e74 5f6f 7074 696f 6e73 0a69 6d70  ient_options.imp
-00000600: 6f72 7420 676f 6f67 6c65 2e61 7069 5f63  ort google.api_c
-00000610: 6f72 652e 6578 6365 7074 696f 6e73 0a69  ore.exceptions.i
-00000620: 6d70 6f72 7420 676f 6f67 6c65 2e61 7069  mport google.api
-00000630: 5f63 6f72 652e 6761 7069 635f 7631 2e63  _core.gapic_v1.c
-00000640: 6c69 656e 745f 696e 666f 0a69 6d70 6f72  lient_info.impor
-00000650: 7420 676f 6f67 6c65 2e61 7574 682e 6372  t google.auth.cr
-00000660: 6564 656e 7469 616c 730a 696d 706f 7274  edentials.import
-00000670: 2067 6f6f 676c 652e 636c 6f75 642e 6269   google.cloud.bi
-00000680: 6771 7565 7279 2061 7320 6269 6771 7565  gquery as bigque
-00000690: 7279 0a69 6d70 6f72 7420 676f 6f67 6c65  ry.import google
-000006a0: 2e63 6c6f 7564 2e62 6967 7175 6572 792e  .cloud.bigquery.
-000006b0: 7461 626c 650a 696d 706f 7274 2067 6f6f  table.import goo
-000006c0: 676c 652e 636c 6f75 642e 6269 6771 7565  gle.cloud.bigque
-000006d0: 7279 5f63 6f6e 6e65 6374 696f 6e5f 7631  ry_connection_v1
-000006e0: 0a69 6d70 6f72 7420 676f 6f67 6c65 2e63  .import google.c
-000006f0: 6c6f 7564 2e62 6967 7175 6572 795f 7374  loud.bigquery_st
-00000700: 6f72 6167 655f 7631 0a69 6d70 6f72 7420  orage_v1.import 
-00000710: 676f 6f67 6c65 2e63 6c6f 7564 2e66 756e  google.cloud.fun
-00000720: 6374 696f 6e73 5f76 320a 696d 706f 7274  ctions_v2.import
-00000730: 2067 6f6f 676c 652e 636c 6f75 642e 7265   google.cloud.re
-00000740: 736f 7572 6365 6d61 6e61 6765 725f 7633  sourcemanager_v3
-00000750: 0a69 6d70 6f72 7420 676f 6f67 6c65 2e63  .import google.c
-00000760: 6c6f 7564 2e73 746f 7261 6765 2061 7320  loud.storage as 
-00000770: 7374 6f72 6167 6520 2023 2074 7970 653a  storage  # type:
-00000780: 2069 676e 6f72 650a 696d 706f 7274 2069   ignore.import i
-00000790: 6269 730a 696d 706f 7274 2069 6269 732e  bis.import ibis.
-000007a0: 6261 636b 656e 6473 2e62 6967 7175 6572  backends.bigquer
-000007b0: 7920 6173 2069 6269 735f 6269 6771 7565  y as ibis_bigque
-000007c0: 7279 0a69 6d70 6f72 7420 6962 6973 2e65  ry.import ibis.e
-000007d0: 7870 722e 7479 7065 7320 6173 2069 6269  xpr.types as ibi
-000007e0: 735f 7479 7065 730a 696d 706f 7274 206e  s_types.import n
-000007f0: 756d 7079 2061 7320 6e70 0a69 6d70 6f72  umpy as np.impor
-00000800: 7420 7061 6e64 6173 0a66 726f 6d20 7061  t pandas.from pa
-00000810: 6e64 6173 2e5f 7479 7069 6e67 2069 6d70  ndas._typing imp
-00000820: 6f72 7420 280a 2020 2020 436f 6d70 7265  ort (.    Compre
-00000830: 7373 696f 6e4f 7074 696f 6e73 2c0a 2020  ssionOptions,.  
-00000840: 2020 4669 6c65 5061 7468 2c0a 2020 2020    FilePath,.    
-00000850: 5265 6164 5069 636b 6c65 4275 6666 6572  ReadPickleBuffer
-00000860: 2c0a 2020 2020 5374 6f72 6167 654f 7074  ,.    StorageOpt
-00000870: 696f 6e73 2c0a 290a 696d 706f 7274 2070  ions,.).import p
-00000880: 7961 7272 6f77 2061 7320 7061 0a0a 696d  yarrow as pa..im
-00000890: 706f 7274 2062 6967 6672 616d 6573 2e5f  port bigframes._
-000008a0: 636f 6e66 6967 2e62 6967 7175 6572 795f  config.bigquery_
-000008b0: 6f70 7469 6f6e 7320 6173 2062 6967 7175  options as bigqu
-000008c0: 6572 795f 6f70 7469 6f6e 730a 696d 706f  ery_options.impo
-000008d0: 7274 2062 6967 6672 616d 6573 2e63 6c69  rt bigframes.cli
-000008e0: 656e 7473 0a69 6d70 6f72 7420 6269 6766  ents.import bigf
-000008f0: 7261 6d65 732e 636f 6e73 7461 6e74 7320  rames.constants 
-00000900: 6173 2063 6f6e 7374 616e 7473 0a69 6d70  as constants.imp
-00000910: 6f72 7420 6269 6766 7261 6d65 732e 636f  ort bigframes.co
-00000920: 7265 2061 7320 636f 7265 0a69 6d70 6f72  re as core.impor
-00000930: 7420 6269 6766 7261 6d65 732e 636f 7265  t bigframes.core
-00000940: 2e62 6c6f 636b 7320 6173 2062 6c6f 636b  .blocks as block
-00000950: 730a 696d 706f 7274 2062 6967 6672 616d  s.import bigfram
-00000960: 6573 2e63 6f72 652e 636f 6d70 696c 650a  es.core.compile.
-00000970: 696d 706f 7274 2062 6967 6672 616d 6573  import bigframes
-00000980: 2e63 6f72 652e 6e6f 6465 7320 6173 206e  .core.nodes as n
-00000990: 6f64 6573 0a66 726f 6d20 6269 6766 7261  odes.from bigfra
-000009a0: 6d65 732e 636f 7265 2e6f 7264 6572 696e  mes.core.orderin
-000009b0: 6720 696d 706f 7274 2049 6e74 6567 6572  g import Integer
-000009c0: 456e 636f 6469 6e67 0a69 6d70 6f72 7420  Encoding.import 
-000009d0: 6269 6766 7261 6d65 732e 636f 7265 2e6f  bigframes.core.o
-000009e0: 7264 6572 696e 6720 6173 206f 7264 6572  rdering as order
-000009f0: 0a69 6d70 6f72 7420 6269 6766 7261 6d65  .import bigframe
-00000a00: 732e 636f 7265 2e74 7265 655f 7072 6f70  s.core.tree_prop
-00000a10: 6572 7469 6573 2061 7320 7472 6176 6572  erties as traver
-00000a20: 7361 6c73 0a69 6d70 6f72 7420 6269 6766  sals.import bigf
-00000a30: 7261 6d65 732e 636f 7265 2e74 7265 655f  rames.core.tree_
-00000a40: 7072 6f70 6572 7469 6573 2061 7320 7472  properties as tr
-00000a50: 6565 5f70 726f 7065 7274 6965 730a 696d  ee_properties.im
-00000a60: 706f 7274 2062 6967 6672 616d 6573 2e63  port bigframes.c
-00000a70: 6f72 652e 7574 696c 7320 6173 2075 7469  ore.utils as uti
-00000a80: 6c73 0a69 6d70 6f72 7420 6269 6766 7261  ls.import bigfra
-00000a90: 6d65 732e 6474 7970 6573 0a69 6d70 6f72  mes.dtypes.impor
-00000aa0: 7420 6269 6766 7261 6d65 732e 666f 726d  t bigframes.form
-00000ab0: 6174 7469 6e67 5f68 656c 7065 7273 2061  atting_helpers a
-00000ac0: 7320 666f 726d 6174 7469 6e67 5f68 656c  s formatting_hel
-00000ad0: 7065 7273 0a66 726f 6d20 6269 6766 7261  pers.from bigfra
-00000ae0: 6d65 732e 6675 6e63 7469 6f6e 732e 7265  mes.functions.re
-00000af0: 6d6f 7465 5f66 756e 6374 696f 6e20 696d  mote_function im
-00000b00: 706f 7274 2072 6561 645f 6762 715f 6675  port read_gbq_fu
-00000b10: 6e63 7469 6f6e 2061 7320 6269 6766 7261  nction as bigfra
-00000b20: 6d65 735f 7267 660a 6672 6f6d 2062 6967  mes_rgf.from big
-00000b30: 6672 616d 6573 2e66 756e 6374 696f 6e73  frames.functions
-00000b40: 2e72 656d 6f74 655f 6675 6e63 7469 6f6e  .remote_function
-00000b50: 2069 6d70 6f72 7420 7265 6d6f 7465 5f66   import remote_f
-00000b60: 756e 6374 696f 6e20 6173 2062 6967 6672  unction as bigfr
-00000b70: 616d 6573 5f72 660a 696d 706f 7274 2062  ames_rf.import b
-00000b80: 6967 6672 616d 6573 2e73 6573 7369 6f6e  igframes.session
-00000b90: 2e5f 696f 2e62 6967 7175 6572 7920 6173  ._io.bigquery as
-00000ba0: 2062 6967 6672 616d 6573 5f69 6f0a 696d   bigframes_io.im
-00000bb0: 706f 7274 2062 6967 6672 616d 6573 2e73  port bigframes.s
-00000bc0: 6573 7369 6f6e 2e5f 696f 2e62 6967 7175  ession._io.bigqu
-00000bd0: 6572 792e 7265 6164 5f67 6271 5f74 6162  ery.read_gbq_tab
-00000be0: 6c65 2061 7320 6266 5f72 6561 645f 6762  le as bf_read_gb
-00000bf0: 715f 7461 626c 650a 696d 706f 7274 2062  q_table.import b
-00000c00: 6967 6672 616d 6573 2e73 6573 7369 6f6e  igframes.session
-00000c10: 2e63 6c69 656e 7473 0a69 6d70 6f72 7420  .clients.import 
-00000c20: 6269 6766 7261 6d65 732e 7665 7273 696f  bigframes.versio
-00000c30: 6e0a 0a23 2041 766f 6964 2063 6972 6375  n..# Avoid circu
-00000c40: 6c61 7220 696d 706f 7274 732e 0a69 6620  lar imports..if 
-00000c50: 7479 7069 6e67 2e54 5950 455f 4348 4543  typing.TYPE_CHEC
-00000c60: 4b49 4e47 3a0a 2020 2020 696d 706f 7274  KING:.    import
-00000c70: 2062 6967 6672 616d 6573 2e63 6f72 652e   bigframes.core.
-00000c80: 696e 6465 7865 730a 2020 2020 696d 706f  indexes.    impo
-00000c90: 7274 2062 6967 6672 616d 6573 2e64 6174  rt bigframes.dat
-00000ca0: 6166 7261 6d65 2061 7320 6461 7461 6672  aframe as datafr
-00000cb0: 616d 650a 2020 2020 696d 706f 7274 2062  ame.    import b
-00000cc0: 6967 6672 616d 6573 2e73 6572 6965 730a  igframes.series.
-00000cd0: 0a5f 4249 4746 5241 4d45 535f 4445 4641  ._BIGFRAMES_DEFA
-00000ce0: 554c 545f 434f 4e4e 4543 5449 4f4e 5f49  ULT_CONNECTION_I
-00000cf0: 4420 3d20 2262 6967 6672 616d 6573 2d64  D = "bigframes-d
-00000d00: 6566 6175 6c74 2d63 6f6e 6e65 6374 696f  efault-connectio
-00000d10: 6e22 0a0a 5f54 454d 505f 5441 424c 455f  n".._TEMP_TABLE_
-00000d20: 4944 5f46 4f52 4d41 5420 3d20 2262 7164  ID_FORMAT = "bqd
-00000d30: 667b 6461 7465 7d5f 7b73 6573 7369 6f6e  f{date}_{session
-00000d40: 5f69 647d 5f7b 7261 6e64 6f6d 5f69 647d  _id}_{random_id}
-00000d50: 220a 0a5f 4d41 585f 434c 5553 5445 525f  ".._MAX_CLUSTER_
-00000d60: 434f 4c55 4d4e 5320 3d20 340a 0a23 2054  COLUMNS = 4..# T
-00000d70: 4f44 4f28 7377 6173 7429 3a20 4e65 6564  ODO(swast): Need
-00000d80: 2074 6f20 636f 6e6e 6563 7420 746f 2072   to connect to r
-00000d90: 6567 696f 6e61 6c20 656e 6470 6f69 6e74  egional endpoint
-00000da0: 7320 7768 656e 2070 6572 666f 726d 696e  s when performin
-00000db0: 6720 7265 6d6f 7465 0a23 2066 756e 6374  g remote.# funct
-00000dc0: 696f 6e73 206f 7065 7261 7469 6f6e 7320  ions operations 
-00000dd0: 2842 5120 436f 6e6e 6563 7469 6f6e 2049  (BQ Connection I
-00000de0: 414d 2c20 436c 6f75 6420 5275 6e20 2f20  AM, Cloud Run / 
-00000df0: 436c 6f75 6420 4675 6e63 7469 6f6e 7329  Cloud Functions)
-00000e00: 2e0a 2320 416c 736f 2073 6565 2069 6620  ..# Also see if 
-00000e10: 7265 736f 7572 6365 206d 616e 6167 6572  resource manager
-00000e20: 2063 6c69 656e 7420 6c69 6272 6172 7920   client library 
-00000e30: 7375 7070 6f72 7473 2072 6567 696f 6e61  supports regiona
-00000e40: 6c20 656e 6470 6f69 6e74 732e 0a0a 5f56  l endpoints..._V
-00000e50: 414c 4944 5f45 4e43 4f44 494e 4753 203d  ALID_ENCODINGS =
-00000e60: 207b 0a20 2020 2022 5554 462d 3822 2c0a   {.    "UTF-8",.
-00000e70: 2020 2020 2249 534f 2d38 3835 392d 3122      "ISO-8859-1"
-00000e80: 2c0a 2020 2020 2255 5446 2d31 3642 4522  ,.    "UTF-16BE"
-00000e90: 2c0a 2020 2020 2255 5446 2d31 364c 4522  ,.    "UTF-16LE"
-00000ea0: 2c0a 2020 2020 2255 5446 2d33 3242 4522  ,.    "UTF-32BE"
-00000eb0: 2c0a 2020 2020 2255 5446 2d33 324c 4522  ,.    "UTF-32LE"
-00000ec0: 2c0a 7d0a 0a23 2042 6967 5175 6572 7920  ,.}..# BigQuery 
-00000ed0: 6861 7320 3120 4d42 2071 7565 7279 2073  has 1 MB query s
-00000ee0: 697a 6520 6c69 6d69 742e 2044 6f6e 2774  ize limit. Don't
-00000ef0: 2077 616e 7420 746f 2074 616b 6520 7570   want to take up
-00000f00: 206d 6f72 6520 7468 616e 2061 2066 6577   more than a few
-00000f10: 2025 206f 6620 7468 6174 2069 6e6c 696e   % of that inlin
-00000f20: 696e 6720 6120 7461 626c 652e 0a23 2041  ing a table..# A
-00000f30: 6c73 6f20 6d75 7374 2061 7373 756d 6520  lso must assume 
-00000f40: 7468 6174 2074 6578 7420 656e 636f 6469  that text encodi
-00000f50: 6e67 2061 7320 6c69 7465 7261 6c73 2069  ng as literals i
-00000f60: 7320 6d75 6368 206c 6573 7320 6566 6669  s much less effi
-00000f70: 6369 656e 7420 7468 616e 2069 6e2d 6d65  cient than in-me
-00000f80: 6d6f 7279 2072 6570 7265 7365 6e74 6174  mory representat
-00000f90: 696f 6e2e 0a4d 4158 5f49 4e4c 494e 455f  ion..MAX_INLINE_
-00000fa0: 4446 5f42 5954 4553 203d 2035 3030 300a  DF_BYTES = 5000.
-00000fb0: 0a23 204d 6178 2063 6f6d 706c 6578 6974  .# Max complexit
-00000fc0: 7920 7468 6174 2073 686f 756c 6420 6265  y that should be
-00000fd0: 2065 7865 6375 7465 6420 6173 2061 2073   executed as a s
-00000fe0: 696e 676c 6520 7175 6572 790a 5155 4552  ingle query.QUER
-00000ff0: 595f 434f 4d50 4c45 5849 5459 5f4c 494d  Y_COMPLEXITY_LIM
-00001000: 4954 203d 2031 6537 0a23 204e 756d 6265  IT = 1e7.# Numbe
-00001010: 7220 6f66 2074 696d 6573 2074 6f20 6661  r of times to fa
-00001020: 6374 6f72 206f 7574 2073 7562 7175 6572  ctor out subquer
-00001030: 6965 7320 6265 666f 7265 2067 6976 696e  ies before givin
-00001040: 6720 7570 2e0a 4d41 585f 5355 4254 5245  g up..MAX_SUBTRE
-00001050: 455f 4641 4354 4f52 494e 4753 203d 2035  E_FACTORINGS = 5
-00001060: 0a0a 6c6f 6767 6572 203d 206c 6f67 6769  ..logger = loggi
-00001070: 6e67 2e67 6574 4c6f 6767 6572 285f 5f6e  ng.getLogger(__n
-00001080: 616d 655f 5f29 0a0a 2320 4578 636c 7564  ame__)..# Exclud
-00001090: 6573 2067 656f 6772 6170 6879 2c20 6279  es geography, by
-000010a0: 7465 732c 2061 6e64 206e 6573 7465 6420  tes, and nested 
-000010b0: 2861 7272 6179 2c20 7374 7275 6374 2920  (array, struct) 
-000010c0: 6461 7461 7479 7065 730a 494e 4c49 4e41  datatypes.INLINA
-000010d0: 424c 455f 4454 5950 4553 3a20 5365 7175  BLE_DTYPES: Sequ
-000010e0: 656e 6365 5b62 6967 6672 616d 6573 2e64  ence[bigframes.d
-000010f0: 7479 7065 732e 4474 7970 655d 203d 2028  types.Dtype] = (
-00001100: 0a20 2020 2070 616e 6461 732e 426f 6f6c  .    pandas.Bool
-00001110: 6561 6e44 7479 7065 2829 2c0a 2020 2020  eanDtype(),.    
-00001120: 7061 6e64 6173 2e46 6c6f 6174 3634 4474  pandas.Float64Dt
-00001130: 7970 6528 292c 0a20 2020 2070 616e 6461  ype(),.    panda
-00001140: 732e 496e 7436 3444 7479 7065 2829 2c0a  s.Int64Dtype(),.
-00001150: 2020 2020 7061 6e64 6173 2e53 7472 696e      pandas.Strin
-00001160: 6744 7479 7065 2873 746f 7261 6765 3d22  gDtype(storage="
-00001170: 7079 6172 726f 7722 292c 0a20 2020 2070  pyarrow"),.    p
-00001180: 616e 6461 732e 4172 726f 7744 7479 7065  andas.ArrowDtype
-00001190: 2870 612e 6461 7465 3332 2829 292c 0a20  (pa.date32()),. 
-000011a0: 2020 2070 616e 6461 732e 4172 726f 7744     pandas.ArrowD
-000011b0: 7479 7065 2870 612e 7469 6d65 3634 2822  type(pa.time64("
-000011c0: 7573 2229 292c 0a20 2020 2070 616e 6461  us")),.    panda
-000011d0: 732e 4172 726f 7744 7479 7065 2870 612e  s.ArrowDtype(pa.
-000011e0: 7469 6d65 7374 616d 7028 2275 7322 2929  timestamp("us"))
-000011f0: 2c0a 2020 2020 7061 6e64 6173 2e41 7272  ,.    pandas.Arr
-00001200: 6f77 4474 7970 6528 7061 2e74 696d 6573  owDtype(pa.times
-00001210: 7461 6d70 2822 7573 222c 2074 7a3d 2255  tamp("us", tz="U
-00001220: 5443 2229 292c 0a20 2020 2070 616e 6461  TC")),.    panda
-00001230: 732e 4172 726f 7744 7479 7065 2870 612e  s.ArrowDtype(pa.
-00001240: 6465 6369 6d61 6c31 3238 2833 382c 2039  decimal128(38, 9
-00001250: 2929 2c0a 2020 2020 7061 6e64 6173 2e41  )),.    pandas.A
-00001260: 7272 6f77 4474 7970 6528 7061 2e64 6563  rrowDtype(pa.dec
-00001270: 696d 616c 3235 3628 3736 2c20 3338 2929  imal256(76, 38))
-00001280: 2c0a 290a 0a0a 6465 6620 5f69 735f 7175  ,.)...def _is_qu
-00001290: 6572 7928 7175 6572 795f 6f72 5f74 6162  ery(query_or_tab
-000012a0: 6c65 3a20 7374 7229 202d 3e20 626f 6f6c  le: str) -> bool
-000012b0: 3a0a 2020 2020 2222 2244 6574 6572 6d69  :.    """Determi
-000012c0: 6e65 2069 6620 6071 7565 7279 5f6f 725f  ne if `query_or_
-000012d0: 7461 626c 6560 2069 7320 6120 7461 626c  table` is a tabl
-000012e0: 6520 4944 206f 7220 6120 5351 4c20 7374  e ID or a SQL st
-000012f0: 7269 6e67 2222 220a 2020 2020 7265 7475  ring""".    retu
-00001300: 726e 2072 652e 7365 6172 6368 2872 225c  rn re.search(r"\
-00001310: 7322 2c20 7175 6572 795f 6f72 5f74 6162  s", query_or_tab
-00001320: 6c65 2e73 7472 6970 2829 2c20 7265 2e4d  le.strip(), re.M
-00001330: 554c 5449 4c49 4e45 2920 6973 206e 6f74  ULTILINE) is not
-00001340: 204e 6f6e 650a 0a0a 6465 6620 5f69 735f   None...def _is_
-00001350: 7461 626c 655f 7769 7468 5f77 696c 6463  table_with_wildc
-00001360: 6172 645f 7375 6666 6978 2871 7565 7279  ard_suffix(query
-00001370: 5f6f 725f 7461 626c 653a 2073 7472 2920  _or_table: str) 
-00001380: 2d3e 2062 6f6f 6c3a 0a20 2020 2022 2222  -> bool:.    """
-00001390: 4465 7465 726d 696e 6520 6966 2060 7175  Determine if `qu
-000013a0: 6572 795f 6f72 5f74 6162 6c65 6020 6973  ery_or_table` is
-000013b0: 2061 2074 6162 6c65 2061 6e64 2063 6f6e   a table and con
-000013c0: 7461 696e 7320 6120 7769 6c64 6361 7264  tains a wildcard
-000013d0: 2073 7566 6669 782e 2222 220a 2020 2020   suffix.""".    
-000013e0: 7265 7475 726e 206e 6f74 205f 6973 5f71  return not _is_q
-000013f0: 7565 7279 2871 7565 7279 5f6f 725f 7461  uery(query_or_ta
-00001400: 626c 6529 2061 6e64 2071 7565 7279 5f6f  ble) and query_o
-00001410: 725f 7461 626c 652e 656e 6473 7769 7468  r_table.endswith
-00001420: 2822 2a22 290a 0a0a 636c 6173 7320 5365  ("*")...class Se
-00001430: 7373 696f 6e28 0a20 2020 2074 6869 7264  ssion(.    third
-00001440: 5f70 6172 7479 5f70 616e 6461 735f 6762  _party_pandas_gb
-00001450: 712e 4742 5149 4f4d 6978 696e 2c0a 2020  q.GBQIOMixin,.  
-00001460: 2020 7468 6972 645f 7061 7274 795f 7061    third_party_pa
-00001470: 6e64 6173 5f70 6172 7175 6574 2e50 6172  ndas_parquet.Par
-00001480: 7175 6574 494f 4d69 7869 6e2c 0a20 2020  quetIOMixin,.   
-00001490: 2074 6869 7264 5f70 6172 7479 5f70 616e   third_party_pan
-000014a0: 6461 735f 7069 636b 6c65 2e50 6963 6b6c  das_pickle.Pickl
-000014b0: 6549 4f4d 6978 696e 2c0a 2020 2020 7468  eIOMixin,.    th
-000014c0: 6972 645f 7061 7274 795f 7061 6e64 6173  ird_party_pandas
-000014d0: 5f72 6561 6465 7273 2e52 6561 6465 7249  _readers.ReaderI
-000014e0: 4f4d 6978 696e 2c0a 293a 0a20 2020 2022  OMixin,.):.    "
-000014f0: 2222 4573 7461 626c 6973 6865 7320 6120  ""Establishes a 
-00001500: 4269 6751 7565 7279 2063 6f6e 6e65 6374  BigQuery connect
-00001510: 696f 6e20 746f 2063 6170 7475 7265 2061  ion to capture a
-00001520: 2067 726f 7570 206f 6620 6a6f 6220 6163   group of job ac
-00001530: 7469 7669 7469 6573 2072 656c 6174 6564  tivities related
-00001540: 2074 6f0a 2020 2020 4461 7461 4672 616d   to.    DataFram
-00001550: 6573 2e0a 0a20 2020 2041 7267 733a 0a20  es...    Args:. 
-00001560: 2020 2020 2020 2063 6f6e 7465 7874 2028         context (
-00001570: 6269 6766 7261 6d65 732e 5f63 6f6e 6669  bigframes._confi
-00001580: 672e 6269 6771 7565 7279 5f6f 7074 696f  g.bigquery_optio
-00001590: 6e73 2e42 6967 5175 6572 794f 7074 696f  ns.BigQueryOptio
-000015a0: 6e73 293a 0a20 2020 2020 2020 2020 2020  ns):.           
-000015b0: 2043 6f6e 6669 6775 7261 7469 6f6e 2061   Configuration a
-000015c0: 646a 7573 7469 6e67 2068 6f77 2074 6f20  djusting how to 
-000015d0: 636f 6e6e 6563 7420 746f 2042 6967 5175  connect to BigQu
-000015e0: 6572 7920 616e 6420 7265 6c61 7465 640a  ery and related.
-000015f0: 2020 2020 2020 2020 2020 2020 4150 4973              APIs
-00001600: 2e20 4e6f 7465 2074 6861 7420 736f 6d65  . Note that some
-00001610: 206f 7074 696f 6e73 2061 7265 2069 676e   options are ign
-00001620: 6f72 6564 2069 6620 6060 636c 6965 6e74  ored if ``client
-00001630: 735f 7072 6f76 6964 6572 6060 2069 730a  s_provider`` is.
-00001640: 2020 2020 2020 2020 2020 2020 7365 742e              set.
-00001650: 0a20 2020 2020 2020 2063 6c69 656e 7473  .        clients
-00001660: 5f70 726f 7669 6465 7220 2862 6967 6672  _provider (bigfr
-00001670: 616d 6573 2e73 6573 7369 6f6e 2e63 6c69  ames.session.cli
-00001680: 656e 7473 2e43 6c69 656e 7473 5072 6f76  ents.ClientsProv
-00001690: 6964 6572 293a 0a20 2020 2020 2020 2020  ider):.         
-000016a0: 2020 2041 6e20 6f62 6a65 6374 2070 726f     An object pro
-000016b0: 7669 6469 6e67 2063 6c69 656e 7420 6c69  viding client li
-000016c0: 6272 6172 7920 6f62 6a65 6374 732e 0a20  brary objects.. 
-000016d0: 2020 2022 2222 0a0a 2020 2020 6465 6620     """..    def 
-000016e0: 5f5f 696e 6974 5f5f 280a 2020 2020 2020  __init__(.      
-000016f0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00001700: 636f 6e74 6578 743a 204f 7074 696f 6e61  context: Optiona
-00001710: 6c5b 6269 6771 7565 7279 5f6f 7074 696f  l[bigquery_optio
-00001720: 6e73 2e42 6967 5175 6572 794f 7074 696f  ns.BigQueryOptio
-00001730: 6e73 5d20 3d20 4e6f 6e65 2c0a 2020 2020  ns] = None,.    
-00001740: 2020 2020 636c 6965 6e74 735f 7072 6f76      clients_prov
-00001750: 6964 6572 3a20 4f70 7469 6f6e 616c 5b62  ider: Optional[b
-00001760: 6967 6672 616d 6573 2e73 6573 7369 6f6e  igframes.session
-00001770: 2e63 6c69 656e 7473 2e43 6c69 656e 7473  .clients.Clients
-00001780: 5072 6f76 6964 6572 5d20 3d20 4e6f 6e65  Provider] = None
-00001790: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
-000017a0: 2069 6620 636f 6e74 6578 7420 6973 204e   if context is N
-000017b0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-000017c0: 2063 6f6e 7465 7874 203d 2062 6967 7175   context = bigqu
-000017d0: 6572 795f 6f70 7469 6f6e 732e 4269 6751  ery_options.BigQ
-000017e0: 7565 7279 4f70 7469 6f6e 7328 290a 0a20  ueryOptions().. 
-000017f0: 2020 2020 2020 2023 2054 4f44 4f28 7377         # TODO(sw
-00001800: 6173 7429 3a20 4765 7420 6c6f 6361 7469  ast): Get locati
-00001810: 6f6e 2066 726f 6d20 7468 6520 656e 7669  on from the envi
-00001820: 726f 6e6d 656e 742e 0a20 2020 2020 2020  ronment..       
-00001830: 2069 6620 636f 6e74 6578 742e 6c6f 6361   if context.loca
-00001840: 7469 6f6e 2069 7320 4e6f 6e65 3a0a 2020  tion is None:.  
-00001850: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00001860: 6c6f 6361 7469 6f6e 203d 2022 5553 220a  location = "US".
-00001870: 2020 2020 2020 2020 2020 2020 7761 726e              warn
-00001880: 696e 6773 2e77 6172 6e28 0a20 2020 2020  ings.warn(.     
-00001890: 2020 2020 2020 2020 2020 2066 224e 6f20             f"No 
-000018a0: 6578 706c 6963 6974 206c 6f63 6174 696f  explicit locatio
-000018b0: 6e20 6973 2073 6574 2c20 736f 2075 7369  n is set, so usi
-000018c0: 6e67 206c 6f63 6174 696f 6e20 7b73 656c  ng location {sel
-000018d0: 662e 5f6c 6f63 6174 696f 6e7d 2066 6f72  f._location} for
-000018e0: 2074 6865 2073 6573 7369 6f6e 2e22 2c0a   the session.",.
-000018f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001900: 7374 6163 6b6c 6576 656c 3d32 2c0a 2020  stacklevel=2,.  
-00001910: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00001920: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00001930: 2020 2020 2020 7365 6c66 2e5f 6c6f 6361        self._loca
-00001940: 7469 6f6e 203d 2063 6f6e 7465 7874 2e6c  tion = context.l
-00001950: 6f63 6174 696f 6e0a 0a20 2020 2020 2020  ocation..       
-00001960: 2073 656c 662e 5f62 715f 6b6d 735f 6b65   self._bq_kms_ke
-00001970: 795f 6e61 6d65 203d 2063 6f6e 7465 7874  y_name = context
-00001980: 2e6b 6d73 5f6b 6579 5f6e 616d 650a 0a20  .kms_key_name.. 
-00001990: 2020 2020 2020 2023 2049 6e73 7461 6e74         # Instant
-000019a0: 6961 7465 2061 2063 6c69 656e 7473 2070  iate a clients p
-000019b0: 726f 7669 6465 7220 746f 2068 656c 7020  rovider to help 
-000019c0: 7769 7468 2063 6c6f 7564 2063 6c69 656e  with cloud clien
-000019d0: 7473 2074 6861 7420 7769 6c6c 2062 650a  ts that will be.
-000019e0: 2020 2020 2020 2020 2320 7573 6564 2069          # used i
-000019f0: 6e20 7468 6520 6675 7475 7265 206f 7065  n the future ope
-00001a00: 7261 7469 6f6e 7320 696e 2074 6865 2073  rations in the s
-00001a10: 6573 7369 6f6e 0a20 2020 2020 2020 2069  ession.        i
-00001a20: 6620 636c 6965 6e74 735f 7072 6f76 6964  f clients_provid
-00001a30: 6572 3a0a 2020 2020 2020 2020 2020 2020  er:.            
-00001a40: 7365 6c66 2e5f 636c 6965 6e74 735f 7072  self._clients_pr
-00001a50: 6f76 6964 6572 203d 2063 6c69 656e 7473  ovider = clients
-00001a60: 5f70 726f 7669 6465 720a 2020 2020 2020  _provider.      
-00001a70: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00001a80: 2020 2020 7365 6c66 2e5f 636c 6965 6e74      self._client
-00001a90: 735f 7072 6f76 6964 6572 203d 2062 6967  s_provider = big
-00001aa0: 6672 616d 6573 2e73 6573 7369 6f6e 2e63  frames.session.c
-00001ab0: 6c69 656e 7473 2e43 6c69 656e 7473 5072  lients.ClientsPr
-00001ac0: 6f76 6964 6572 280a 2020 2020 2020 2020  ovider(.        
-00001ad0: 2020 2020 2020 2020 7072 6f6a 6563 743d          project=
-00001ae0: 636f 6e74 6578 742e 7072 6f6a 6563 742c  context.project,
-00001af0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001b00: 206c 6f63 6174 696f 6e3d 7365 6c66 2e5f   location=self._
-00001b10: 6c6f 6361 7469 6f6e 2c0a 2020 2020 2020  location,.      
-00001b20: 2020 2020 2020 2020 2020 7573 655f 7265            use_re
-00001b30: 6769 6f6e 616c 5f65 6e64 706f 696e 7473  gional_endpoints
-00001b40: 3d63 6f6e 7465 7874 2e75 7365 5f72 6567  =context.use_reg
-00001b50: 696f 6e61 6c5f 656e 6470 6f69 6e74 732c  ional_endpoints,
-00001b60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001b70: 2063 7265 6465 6e74 6961 6c73 3d63 6f6e   credentials=con
-00001b80: 7465 7874 2e63 7265 6465 6e74 6961 6c73  text.credentials
-00001b90: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00001ba0: 2020 6170 706c 6963 6174 696f 6e5f 6e61    application_na
-00001bb0: 6d65 3d63 6f6e 7465 7874 2e61 7070 6c69  me=context.appli
-00001bc0: 6361 7469 6f6e 5f6e 616d 652c 0a20 2020  cation_name,.   
-00001bd0: 2020 2020 2020 2020 2020 2020 2062 715f               bq_
-00001be0: 6b6d 735f 6b65 795f 6e61 6d65 3d73 656c  kms_key_name=sel
-00001bf0: 662e 5f62 715f 6b6d 735f 6b65 795f 6e61  f._bq_kms_key_na
-00001c00: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
-00001c10: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-00001c20: 5f61 6e6f 6e79 6d6f 7573 5f64 6174 6173  _anonymous_datas
-00001c30: 6574 203d 2028 0a20 2020 2020 2020 2020  et = (.         
-00001c40: 2020 2062 6967 6672 616d 6573 2e73 6573     bigframes.ses
-00001c50: 7369 6f6e 2e5f 696f 2e62 6967 7175 6572  sion._io.bigquer
-00001c60: 792e 6372 6561 7465 5f62 715f 6461 7461  y.create_bq_data
-00001c70: 7365 745f 7265 6665 7265 6e63 6528 0a20  set_reference(. 
-00001c80: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00001c90: 656c 662e 6271 636c 6965 6e74 2c20 6c6f  elf.bqclient, lo
-00001ca0: 6361 7469 6f6e 3d73 656c 662e 5f6c 6f63  cation=self._loc
-00001cb0: 6174 696f 6e0a 2020 2020 2020 2020 2020  ation.          
-00001cc0: 2020 290a 2020 2020 2020 2020 290a 0a20    ).        ).. 
-00001cd0: 2020 2020 2020 2023 2054 4f44 4f28 7368         # TODO(sh
-00001ce0: 6f62 7329 3a20 5265 6d6f 7665 2074 6869  obs): Remove thi
-00001cf0: 7320 6c6f 6769 6320 6166 7465 7220 6874  s logic after ht
-00001d00: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
-00001d10: 2f69 6269 732d 7072 6f6a 6563 742f 6962  /ibis-project/ib
-00001d20: 6973 2f69 7373 7565 732f 3834 3934 0a20  is/issues/8494. 
-00001d30: 2020 2020 2020 2023 2068 6173 2062 6565         # has bee
-00001d40: 6e20 6669 7865 642e 2054 6865 2069 6269  n fixed. The ibi
-00001d50: 7320 636c 6965 6e74 2063 6861 6e67 6573  s client changes
-00001d60: 2074 6865 2064 6566 6175 6c74 2071 7565   the default que
-00001d70: 7279 206a 6f62 2063 6f6e 6669 670a 2020  ry job config.  
-00001d80: 2020 2020 2020 2320 736f 2077 6520 6172        # so we ar
-00001d90: 6520 676f 696e 6720 746f 2072 656d 656d  e going to remem
-00001da0: 6265 7220 7468 6520 6375 7272 656e 7420  ber the current 
-00001db0: 636f 6e66 6967 2061 6e64 2072 6573 746f  config and resto
-00001dc0: 7265 2069 7420 6166 7465 720a 2020 2020  re it after.    
-00001dd0: 2020 2020 2320 7468 6520 6962 6973 2063      # the ibis c
-00001de0: 6c69 656e 7420 6861 7320 6265 656e 2063  lient has been c
-00001df0: 7265 6174 6564 0a20 2020 2020 2020 206f  reated.        o
-00001e00: 7269 6769 6e61 6c5f 6465 6661 756c 745f  riginal_default_
-00001e10: 7175 6572 795f 6a6f 625f 636f 6e66 6967  query_job_config
-00001e20: 203d 2073 656c 662e 6271 636c 6965 6e74   = self.bqclient
-00001e30: 2e64 6566 6175 6c74 5f71 7565 7279 5f6a  .default_query_j
-00001e40: 6f62 5f63 6f6e 6669 670a 0a20 2020 2020  ob_config..     
-00001e50: 2020 2073 656c 662e 6962 6973 5f63 6c69     self.ibis_cli
-00001e60: 656e 7420 3d20 7479 7069 6e67 2e63 6173  ent = typing.cas
-00001e70: 7428 0a20 2020 2020 2020 2020 2020 2069  t(.            i
-00001e80: 6269 735f 6269 6771 7565 7279 2e42 6163  bis_bigquery.Bac
-00001e90: 6b65 6e64 2c0a 2020 2020 2020 2020 2020  kend,.          
-00001ea0: 2020 6962 6973 2e62 6967 7175 6572 792e    ibis.bigquery.
-00001eb0: 636f 6e6e 6563 7428 0a20 2020 2020 2020  connect(.       
-00001ec0: 2020 2020 2020 2020 2070 726f 6a65 6374           project
-00001ed0: 5f69 643d 636f 6e74 6578 742e 7072 6f6a  _id=context.proj
-00001ee0: 6563 742c 0a20 2020 2020 2020 2020 2020  ect,.           
-00001ef0: 2020 2020 2063 6c69 656e 743d 7365 6c66       client=self
-00001f00: 2e62 7163 6c69 656e 742c 0a20 2020 2020  .bqclient,.     
-00001f10: 2020 2020 2020 2020 2020 2073 746f 7261             stora
-00001f20: 6765 5f63 6c69 656e 743d 7365 6c66 2e62  ge_client=self.b
-00001f30: 7173 746f 7261 6765 7265 6164 636c 6965  qstoragereadclie
-00001f40: 6e74 2c0a 2020 2020 2020 2020 2020 2020  nt,.            
-00001f50: 292c 0a20 2020 2020 2020 2029 0a0a 2020  ),.        )..  
-00001f60: 2020 2020 2020 7365 6c66 2e62 7163 6c69        self.bqcli
-00001f70: 656e 742e 6465 6661 756c 745f 7175 6572  ent.default_quer
-00001f80: 795f 6a6f 625f 636f 6e66 6967 203d 206f  y_job_config = o
-00001f90: 7269 6769 6e61 6c5f 6465 6661 756c 745f  riginal_default_
-00001fa0: 7175 6572 795f 6a6f 625f 636f 6e66 6967  query_job_config
-00001fb0: 0a0a 2020 2020 2020 2020 2320 5265 736f  ..        # Reso
-00001fc0: 6c76 6520 7468 6520 4251 2063 6f6e 6e65  lve the BQ conne
-00001fd0: 6374 696f 6e20 666f 7220 7265 6d6f 7465  ction for remote
-00001fe0: 2066 756e 6374 696f 6e20 616e 6420 5665   function and Ve
-00001ff0: 7274 6578 2041 4920 696e 7465 6772 6174  rtex AI integrat
-00002000: 696f 6e0a 2020 2020 2020 2020 7365 6c66  ion.        self
-00002010: 2e5f 6271 5f63 6f6e 6e65 6374 696f 6e20  ._bq_connection 
-00002020: 3d20 636f 6e74 6578 742e 6271 5f63 6f6e  = context.bq_con
-00002030: 6e65 6374 696f 6e20 6f72 205f 4249 4746  nection or _BIGF
-00002040: 5241 4d45 535f 4445 4641 554c 545f 434f  RAMES_DEFAULT_CO
-00002050: 4e4e 4543 5449 4f4e 5f49 440a 2020 2020  NNECTION_ID.    
-00002060: 2020 2020 7365 6c66 2e5f 736b 6970 5f62      self._skip_b
-00002070: 715f 636f 6e6e 6563 7469 6f6e 5f63 6865  q_connection_che
-00002080: 636b 203d 2063 6f6e 7465 7874 2e5f 736b  ck = context._sk
-00002090: 6970 5f62 715f 636f 6e6e 6563 7469 6f6e  ip_bq_connection
-000020a0: 5f63 6865 636b 0a0a 2020 2020 2020 2020  _check..        
-000020b0: 2320 4e6f 7720 7468 6174 2077 6527 7265  # Now that we're
-000020c0: 2073 7461 7274 696e 6720 7468 6520 7365   starting the se
-000020d0: 7373 696f 6e2c 2064 6f6e 2774 2061 6c6c  ssion, don't all
-000020e0: 6f77 2074 6865 206f 7074 696f 6e73 2074  ow the options t
-000020f0: 6f20 6265 0a20 2020 2020 2020 2023 2063  o be.        # c
-00002100: 6861 6e67 6564 2e0a 2020 2020 2020 2020  hanged..        
-00002110: 636f 6e74 6578 742e 5f73 6573 7369 6f6e  context._session
-00002120: 5f73 7461 7274 6564 203d 2054 7275 650a  _started = True.
-00002130: 2020 2020 2020 2020 7365 6c66 2e5f 6466          self._df
-00002140: 5f73 6e61 7073 686f 743a 2044 6963 745b  _snapshot: Dict[
-00002150: 0a20 2020 2020 2020 2020 2020 2062 6967  .            big
-00002160: 7175 6572 792e 5461 626c 6552 6566 6572  query.TableRefer
-00002170: 656e 6365 2c20 5475 706c 655b 6461 7465  ence, Tuple[date
-00002180: 7469 6d65 2e64 6174 6574 696d 652c 2062  time.datetime, b
-00002190: 6967 7175 6572 792e 5461 626c 655d 0a20  igquery.Table]. 
-000021a0: 2020 2020 2020 205d 203d 207b 7d0a 0a20         ] = {}.. 
-000021b0: 2020 2020 2020 2023 2075 6e69 7175 6520         # unique 
-000021c0: 7365 7373 696f 6e20 6964 656e 7469 6669  session identifi
-000021d0: 6572 2c20 7368 6f72 7420 656e 6f75 6768  er, short enough
-000021e0: 2074 6f20 6265 2068 756d 616e 2072 6561   to be human rea
-000021f0: 6461 626c 650a 2020 2020 2020 2020 2320  dable.        # 
-00002200: 6f6e 6c79 206e 6565 6473 2074 6f20 6265  only needs to be
-00002210: 2075 6e69 7175 6520 616d 6f6e 6720 7365   unique among se
-00002220: 7373 696f 6e73 2063 7265 6174 6564 2062  ssions created b
-00002230: 7920 7468 6520 7361 6d65 2075 7365 720a  y the same user.
-00002240: 2020 2020 2020 2020 2320 6174 2074 6865          # at the
-00002250: 2073 616d 6520 7469 6d65 2069 6e20 7468   same time in th
-00002260: 6520 7361 6d65 2072 6567 696f 6e0a 2020  e same region.  
-00002270: 2020 2020 2020 7365 6c66 2e5f 7365 7373        self._sess
-00002280: 696f 6e5f 6964 3a20 7374 7220 3d20 2273  ion_id: str = "s
-00002290: 6573 7369 6f6e 2220 2b20 7365 6372 6574  ession" + secret
-000022a0: 732e 746f 6b65 6e5f 6865 7828 3329 0a20  s.token_hex(3). 
-000022b0: 2020 2020 2020 2073 656c 662e 5f74 6162         self._tab
-000022c0: 6c65 5f69 6473 3a20 4c69 7374 5b73 7472  le_ids: List[str
-000022d0: 5d20 3d20 5b5d 0a20 2020 2020 2020 2023  ] = [].        #
-000022e0: 2073 746f 7265 2074 6162 6c65 2069 6473   store table ids
-000022f0: 2061 6e64 2064 656c 6574 6520 7468 656d   and delete them
-00002300: 2077 6865 6e20 7468 6520 7365 7373 696f   when the sessio
-00002310: 6e20 6973 2063 6c6f 7365 640a 0a20 2020  n is closed..   
-00002320: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-00002330: 6566 2062 7163 6c69 656e 7428 7365 6c66  ef bqclient(self
-00002340: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00002350: 6e20 7365 6c66 2e5f 636c 6965 6e74 735f  n self._clients_
-00002360: 7072 6f76 6964 6572 2e62 7163 6c69 656e  provider.bqclien
-00002370: 740a 0a20 2020 2040 7072 6f70 6572 7479  t..    @property
-00002380: 0a20 2020 2064 6566 2062 7163 6f6e 6e65  .    def bqconne
-00002390: 6374 696f 6e63 6c69 656e 7428 7365 6c66  ctionclient(self
-000023a0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-000023b0: 6e20 7365 6c66 2e5f 636c 6965 6e74 735f  n self._clients_
-000023c0: 7072 6f76 6964 6572 2e62 7163 6f6e 6e65  provider.bqconne
-000023d0: 6374 696f 6e63 6c69 656e 740a 0a20 2020  ctionclient..   
-000023e0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-000023f0: 6566 2062 7173 746f 7261 6765 7265 6164  ef bqstorageread
-00002400: 636c 6965 6e74 2873 656c 6629 3a0a 2020  client(self):.  
-00002410: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00002420: 662e 5f63 6c69 656e 7473 5f70 726f 7669  f._clients_provi
-00002430: 6465 722e 6271 7374 6f72 6167 6572 6561  der.bqstoragerea
-00002440: 6463 6c69 656e 740a 0a20 2020 2040 7072  dclient..    @pr
-00002450: 6f70 6572 7479 0a20 2020 2064 6566 2063  operty.    def c
-00002460: 6c6f 7564 6675 6e63 7469 6f6e 7363 6c69  loudfunctionscli
-00002470: 656e 7428 7365 6c66 293a 0a20 2020 2020  ent(self):.     
-00002480: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-00002490: 636c 6965 6e74 735f 7072 6f76 6964 6572  clients_provider
-000024a0: 2e63 6c6f 7564 6675 6e63 7469 6f6e 7363  .cloudfunctionsc
-000024b0: 6c69 656e 740a 0a20 2020 2040 7072 6f70  lient..    @prop
-000024c0: 6572 7479 0a20 2020 2064 6566 2072 6573  erty.    def res
-000024d0: 6f75 7263 656d 616e 6167 6572 636c 6965  ourcemanagerclie
-000024e0: 6e74 2873 656c 6629 3a0a 2020 2020 2020  nt(self):.      
-000024f0: 2020 7265 7475 726e 2073 656c 662e 5f63    return self._c
-00002500: 6c69 656e 7473 5f70 726f 7669 6465 722e  lients_provider.
-00002510: 7265 736f 7572 6365 6d61 6e61 6765 7263  resourcemanagerc
-00002520: 6c69 656e 740a 0a20 2020 205f 6271 5f63  lient..    _bq_c
-00002530: 6f6e 6e65 6374 696f 6e5f 6d61 6e61 6765  onnection_manage
-00002540: 723a 204f 7074 696f 6e61 6c5b 6269 6766  r: Optional[bigf
-00002550: 7261 6d65 732e 636c 6965 6e74 732e 4271  rames.clients.Bq
-00002560: 436f 6e6e 6563 7469 6f6e 4d61 6e61 6765  ConnectionManage
-00002570: 725d 203d 204e 6f6e 650a 0a20 2020 2040  r] = None..    @
-00002580: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-00002590: 2062 7163 6f6e 6e65 6374 696f 6e6d 616e   bqconnectionman
-000025a0: 6167 6572 2873 656c 6629 3a0a 2020 2020  ager(self):.    
-000025b0: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
-000025c0: 5f73 6b69 705f 6271 5f63 6f6e 6e65 6374  _skip_bq_connect
-000025d0: 696f 6e5f 6368 6563 6b20 616e 6420 6e6f  ion_check and no
-000025e0: 7420 7365 6c66 2e5f 6271 5f63 6f6e 6e65  t self._bq_conne
-000025f0: 6374 696f 6e5f 6d61 6e61 6765 723a 0a20  ction_manager:. 
-00002600: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00002610: 5f62 715f 636f 6e6e 6563 7469 6f6e 5f6d  _bq_connection_m
-00002620: 616e 6167 6572 203d 2062 6967 6672 616d  anager = bigfram
-00002630: 6573 2e63 6c69 656e 7473 2e42 7143 6f6e  es.clients.BqCon
-00002640: 6e65 6374 696f 6e4d 616e 6167 6572 280a  nectionManager(.
-00002650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002660: 7365 6c66 2e62 7163 6f6e 6e65 6374 696f  self.bqconnectio
-00002670: 6e63 6c69 656e 742c 2073 656c 662e 7265  nclient, self.re
-00002680: 736f 7572 6365 6d61 6e61 6765 7263 6c69  sourcemanagercli
-00002690: 656e 740a 2020 2020 2020 2020 2020 2020  ent.            
-000026a0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-000026b0: 2073 656c 662e 5f62 715f 636f 6e6e 6563   self._bq_connec
-000026c0: 7469 6f6e 5f6d 616e 6167 6572 0a0a 2020  tion_manager..  
-000026d0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-000026e0: 6465 6620 7365 7373 696f 6e5f 6964 2873  def session_id(s
-000026f0: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
-00002700: 7475 726e 2073 656c 662e 5f73 6573 7369  turn self._sessi
-00002710: 6f6e 5f69 640a 0a20 2020 2040 7072 6f70  on_id..    @prop
-00002720: 6572 7479 0a20 2020 2064 6566 205f 7072  erty.    def _pr
-00002730: 6f6a 6563 7428 7365 6c66 293a 0a20 2020  oject(self):.   
-00002740: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00002750: 2e62 7163 6c69 656e 742e 7072 6f6a 6563  .bqclient.projec
-00002760: 740a 0a20 2020 2064 6566 205f 5f68 6173  t..    def __has
-00002770: 685f 5f28 7365 6c66 293a 0a20 2020 2020  h__(self):.     
-00002780: 2020 2023 2053 7461 626c 6520 6861 7368     # Stable hash
-00002790: 206e 6565 6465 6420 746f 2075 7365 2069   needed to use i
-000027a0: 6e20 6578 7072 6573 7369 6f6e 2074 7265  n expression tre
-000027b0: 650a 2020 2020 2020 2020 7265 7475 726e  e.        return
-000027c0: 2068 6173 6828 7374 7228 7365 6c66 2e5f   hash(str(self._
-000027d0: 616e 6f6e 796d 6f75 735f 6461 7461 7365  anonymous_datase
-000027e0: 7429 290a 0a20 2020 2064 6566 2063 6c6f  t))..    def clo
-000027f0: 7365 2873 656c 6629 3a0a 2020 2020 2020  se(self):.      
-00002800: 2020 2222 2244 656c 6574 6520 7461 626c    """Delete tabl
-00002810: 6573 2074 6861 7420 7765 7265 2063 7265  es that were cre
-00002820: 6174 6564 2077 6974 6820 7468 6973 2073  ated with this s
-00002830: 6573 7369 6f6e 2773 2073 6573 7369 6f6e  ession's session
-00002840: 5f69 642e 2222 220a 2020 2020 2020 2020  _id.""".        
-00002850: 636c 6965 6e74 203d 2073 656c 662e 6271  client = self.bq
-00002860: 636c 6965 6e74 0a20 2020 2020 2020 2070  client.        p
-00002870: 726f 6a65 6374 5f69 6420 3d20 7365 6c66  roject_id = self
-00002880: 2e5f 616e 6f6e 796d 6f75 735f 6461 7461  ._anonymous_data
-00002890: 7365 742e 7072 6f6a 6563 740a 2020 2020  set.project.    
-000028a0: 2020 2020 6461 7461 7365 745f 6964 203d      dataset_id =
-000028b0: 2073 656c 662e 5f61 6e6f 6e79 6d6f 7573   self._anonymous
-000028c0: 5f64 6174 6173 6574 2e64 6174 6173 6574  _dataset.dataset
-000028d0: 5f69 640a 0a20 2020 2020 2020 2066 6f72  _id..        for
-000028e0: 2074 6162 6c65 5f69 6420 696e 2073 656c   table_id in sel
-000028f0: 662e 5f74 6162 6c65 5f69 6473 3a0a 2020  f._table_ids:.  
-00002900: 2020 2020 2020 2020 2020 6675 6c6c 5f69            full_i
-00002910: 6420 3d20 222e 222e 6a6f 696e 285b 7072  d = ".".join([pr
-00002920: 6f6a 6563 745f 6964 2c20 6461 7461 7365  oject_id, datase
-00002930: 745f 6964 2c20 7461 626c 655f 6964 5d29  t_id, table_id])
-00002940: 0a20 2020 2020 2020 2020 2020 2063 6c69  .            cli
-00002950: 656e 742e 6465 6c65 7465 5f74 6162 6c65  ent.delete_table
-00002960: 2866 756c 6c5f 6964 2c20 6e6f 745f 666f  (full_id, not_fo
-00002970: 756e 645f 6f6b 3d54 7275 6529 0a0a 2020  und_ok=True)..  
-00002980: 2020 6465 6620 7265 6164 5f67 6271 280a    def read_gbq(.
-00002990: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-000029a0: 2020 2020 2020 7175 6572 795f 6f72 5f74        query_or_t
-000029b0: 6162 6c65 3a20 7374 722c 0a20 2020 2020  able: str,.     
-000029c0: 2020 202a 2c0a 2020 2020 2020 2020 696e     *,.        in
-000029d0: 6465 785f 636f 6c3a 2049 7465 7261 626c  dex_col: Iterabl
-000029e0: 655b 7374 725d 207c 2073 7472 207c 2062  e[str] | str | b
-000029f0: 6967 6672 616d 6573 2e65 6e75 6d73 2e44  igframes.enums.D
-00002a00: 6566 6175 6c74 496e 6465 784b 696e 6420  efaultIndexKind 
-00002a10: 3d20 2829 2c0a 2020 2020 2020 2020 636f  = (),.        co
-00002a20: 6c75 6d6e 733a 2049 7465 7261 626c 655b  lumns: Iterable[
-00002a30: 7374 725d 203d 2028 292c 0a20 2020 2020  str] = (),.     
-00002a40: 2020 2063 6f6e 6669 6775 7261 7469 6f6e     configuration
-00002a50: 3a20 4f70 7469 6f6e 616c 5b44 6963 745d  : Optional[Dict]
-00002a60: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-00002a70: 206d 6178 5f72 6573 756c 7473 3a20 4f70   max_results: Op
-00002a80: 7469 6f6e 616c 5b69 6e74 5d20 3d20 4e6f  tional[int] = No
-00002a90: 6e65 2c0a 2020 2020 2020 2020 6669 6c74  ne,.        filt
-00002aa0: 6572 733a 2074 6869 7264 5f70 6172 7479  ers: third_party
-00002ab0: 5f70 616e 6461 735f 6762 712e 4669 6c74  _pandas_gbq.Filt
-00002ac0: 6572 7354 7970 6520 3d20 2829 2c0a 2020  ersType = (),.  
-00002ad0: 2020 2020 2020 7573 655f 6361 6368 653a        use_cache:
-00002ae0: 204f 7074 696f 6e61 6c5b 626f 6f6c 5d20   Optional[bool] 
-00002af0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-00002b00: 636f 6c5f 6f72 6465 723a 2049 7465 7261  col_order: Itera
-00002b10: 626c 655b 7374 725d 203d 2028 292c 0a20  ble[str] = (),. 
-00002b20: 2020 2020 2020 2023 2041 6464 2061 2076         # Add a v
-00002b30: 6572 6966 7920 696e 6465 7820 6172 6775  erify index argu
-00002b40: 6d65 6e74 2074 6861 7420 6661 696c 7320  ment that fails 
-00002b50: 6966 2074 6865 2069 6e64 6578 2069 7320  if the index is 
-00002b60: 6e6f 7420 756e 6971 7565 2e0a 2020 2020  not unique..    
-00002b70: 2920 2d3e 2064 6174 6166 7261 6d65 2e44  ) -> dataframe.D
-00002b80: 6174 6146 7261 6d65 3a0a 2020 2020 2020  ataFrame:.      
-00002b90: 2020 2320 544f 444f 2862 2f32 3831 3537    # TODO(b/28157
-00002ba0: 3132 3134 293a 2047 656e 6572 6174 6520  1214): Generate 
-00002bb0: 7072 6f6d 7074 2074 6f20 7368 6f77 2074  prompt to show t
-00002bc0: 6865 2070 726f 6772 6573 7320 6f66 2072  he progress of r
-00002bd0: 6561 645f 6762 712e 0a20 2020 2020 2020  ead_gbq..       
-00002be0: 2069 6620 636f 6c75 6d6e 7320 616e 6420   if columns and 
-00002bf0: 636f 6c5f 6f72 6465 723a 0a20 2020 2020  col_order:.     
-00002c00: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-00002c10: 7565 4572 726f 7228 0a20 2020 2020 2020  ueError(.       
-00002c20: 2020 2020 2020 2020 2022 4d75 7374 2073           "Must s
-00002c30: 7065 6369 6679 2065 6974 6865 7220 636f  pecify either co
-00002c40: 6c75 6d6e 7320 2870 7265 6665 7272 6564  lumns (preferred
-00002c50: 2920 6f72 2063 6f6c 5f6f 7264 6572 2c20  ) or col_order, 
-00002c60: 6e6f 7420 626f 7468 220a 2020 2020 2020  not both".      
-00002c70: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00002c80: 656c 6966 2063 6f6c 5f6f 7264 6572 3a0a  elif col_order:.
-00002c90: 2020 2020 2020 2020 2020 2020 636f 6c75              colu
-00002ca0: 6d6e 7320 3d20 636f 6c5f 6f72 6465 720a  mns = col_order.
-00002cb0: 0a20 2020 2020 2020 2066 696c 7465 7273  .        filters
-00002cc0: 203d 206c 6973 7428 6669 6c74 6572 7329   = list(filters)
-00002cd0: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
-00002ce0: 6669 6c74 6572 7329 2021 3d20 3020 6f72  filters) != 0 or
-00002cf0: 205f 6973 5f74 6162 6c65 5f77 6974 685f   _is_table_with_
-00002d00: 7769 6c64 6361 7264 5f73 7566 6669 7828  wildcard_suffix(
-00002d10: 7175 6572 795f 6f72 5f74 6162 6c65 293a  query_or_table):
-00002d20: 0a20 2020 2020 2020 2020 2020 2023 2054  .            # T
-00002d30: 4f44 4f28 622f 3333 3831 3131 3334 3429  ODO(b/338111344)
-00002d40: 3a20 5468 6973 2061 7070 6561 7273 2074  : This appears t
-00002d50: 6f20 6265 206d 6973 7369 6e67 2069 6e64  o be missing ind
-00002d60: 6578 5f63 6f6c 732c 2077 6869 6368 0a20  ex_cols, which. 
-00002d70: 2020 2020 2020 2020 2020 2023 2061 7265             # are
-00002d80: 206e 6563 6573 7361 7279 2074 6f20 6265   necessary to be
-00002d90: 2073 656c 6563 7465 642e 0a20 2020 2020   selected..     
-00002da0: 2020 2020 2020 2023 2054 4f44 4f28 622f         # TODO(b/
-00002db0: 3333 3830 3339 3531 3729 3a20 416c 736f  338039517): Also
-00002dc0: 2c20 6e65 6564 2074 6f20 6163 636f 756e  , need to accoun
-00002dd0: 7420 666f 7220 7072 696d 6172 7920 6b65  t for primary ke
-00002de0: 7973 2e0a 2020 2020 2020 2020 2020 2020  ys..            
-00002df0: 7175 6572 795f 6f72 5f74 6162 6c65 203d  query_or_table =
-00002e00: 2073 656c 662e 5f74 6f5f 7175 6572 7928   self._to_query(
-00002e10: 7175 6572 795f 6f72 5f74 6162 6c65 2c20  query_or_table, 
-00002e20: 636f 6c75 6d6e 732c 2066 696c 7465 7273  columns, filters
-00002e30: 290a 0a20 2020 2020 2020 2069 6620 5f69  )..        if _i
-00002e40: 735f 7175 6572 7928 7175 6572 795f 6f72  s_query(query_or
-00002e50: 5f74 6162 6c65 293a 0a20 2020 2020 2020  _table):.       
-00002e60: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00002e70: 2e5f 7265 6164 5f67 6271 5f71 7565 7279  ._read_gbq_query
-00002e80: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00002e90: 2020 7175 6572 795f 6f72 5f74 6162 6c65    query_or_table
-00002ea0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00002eb0: 2020 696e 6465 785f 636f 6c3d 696e 6465    index_col=inde
-00002ec0: 785f 636f 6c2c 0a20 2020 2020 2020 2020  x_col,.         
-00002ed0: 2020 2020 2020 2063 6f6c 756d 6e73 3d63         columns=c
-00002ee0: 6f6c 756d 6e73 2c0a 2020 2020 2020 2020  olumns,.        
-00002ef0: 2020 2020 2020 2020 636f 6e66 6967 7572          configur
-00002f00: 6174 696f 6e3d 636f 6e66 6967 7572 6174  ation=configurat
-00002f10: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
-00002f20: 2020 2020 206d 6178 5f72 6573 756c 7473       max_results
-00002f30: 3d6d 6178 5f72 6573 756c 7473 2c0a 2020  =max_results,.  
-00002f40: 2020 2020 2020 2020 2020 2020 2020 6170                ap
-00002f50: 695f 6e61 6d65 3d22 7265 6164 5f67 6271  i_name="read_gbq
-00002f60: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00002f70: 2020 2075 7365 5f63 6163 6865 3d75 7365     use_cache=use
-00002f80: 5f63 6163 6865 2c0a 2020 2020 2020 2020  _cache,.        
-00002f90: 2020 2020 290a 2020 2020 2020 2020 656c      ).        el
-00002fa0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00002fb0: 6966 2063 6f6e 6669 6775 7261 7469 6f6e  if configuration
-00002fc0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-00002fd0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-00002fe0: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
-00002ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003000: 2020 2020 2254 6865 2027 636f 6e66 6967      "The 'config
-00003010: 7572 6174 696f 6e27 2061 7267 756d 656e  uration' argumen
-00003020: 7420 6973 206e 6f74 2061 6c6c 6f77 6564  t is not allowed
-00003030: 2077 6865 6e20 220a 2020 2020 2020 2020   when ".        
-00003040: 2020 2020 2020 2020 2020 2020 2264 6972              "dir
-00003050: 6563 746c 7920 7265 6164 696e 6720 6672  ectly reading fr
-00003060: 6f6d 2061 2074 6162 6c65 2e20 506c 6561  om a table. Plea
-00003070: 7365 2072 656d 6f76 6520 220a 2020 2020  se remove ".    
-00003080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003090: 2227 636f 6e66 6967 7572 6174 696f 6e27  "'configuration'
-000030a0: 206f 7220 7573 6520 6120 7175 6572 792e   or use a query.
-000030b0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-000030c0: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
-000030d0: 2072 6574 7572 6e20 7365 6c66 2e5f 7265   return self._re
-000030e0: 6164 5f67 6271 5f74 6162 6c65 280a 2020  ad_gbq_table(.  
-000030f0: 2020 2020 2020 2020 2020 2020 2020 7175                qu
-00003100: 6572 795f 6f72 5f74 6162 6c65 2c0a 2020  ery_or_table,.  
-00003110: 2020 2020 2020 2020 2020 2020 2020 696e                in
-00003120: 6465 785f 636f 6c3d 696e 6465 785f 636f  dex_col=index_co
-00003130: 6c2c 0a20 2020 2020 2020 2020 2020 2020  l,.             
-00003140: 2020 2063 6f6c 756d 6e73 3d63 6f6c 756d     columns=colum
-00003150: 6e73 2c0a 2020 2020 2020 2020 2020 2020  ns,.            
-00003160: 2020 2020 6d61 785f 7265 7375 6c74 733d      max_results=
-00003170: 6d61 785f 7265 7375 6c74 732c 0a20 2020  max_results,.   
-00003180: 2020 2020 2020 2020 2020 2020 2061 7069               api
-00003190: 5f6e 616d 653d 2272 6561 645f 6762 7122  _name="read_gbq"
-000031a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000031b0: 2020 7573 655f 6361 6368 653d 7573 655f    use_cache=use_
-000031c0: 6361 6368 6520 6966 2075 7365 5f63 6163  cache if use_cac
-000031d0: 6865 2069 7320 6e6f 7420 4e6f 6e65 2065  he is not None e
-000031e0: 6c73 6520 5472 7565 2c0a 2020 2020 2020  lse True,.      
-000031f0: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-00003200: 205f 746f 5f71 7565 7279 280a 2020 2020   _to_query(.    
-00003210: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-00003220: 2020 7175 6572 795f 6f72 5f74 6162 6c65    query_or_table
-00003230: 3a20 7374 722c 0a20 2020 2020 2020 2063  : str,.        c
-00003240: 6f6c 756d 6e73 3a20 4974 6572 6162 6c65  olumns: Iterable
-00003250: 5b73 7472 5d2c 0a20 2020 2020 2020 2066  [str],.        f
-00003260: 696c 7465 7273 3a20 7468 6972 645f 7061  ilters: third_pa
-00003270: 7274 795f 7061 6e64 6173 5f67 6271 2e46  rty_pandas_gbq.F
-00003280: 696c 7465 7273 5479 7065 2c0a 2020 2020  iltersType,.    
-00003290: 2920 2d3e 2073 7472 3a0a 2020 2020 2020  ) -> str:.      
-000032a0: 2020 2222 2243 6f6d 7069 6c65 2071 7565    """Compile que
-000032b0: 7279 5f6f 725f 7461 626c 6520 7769 7468  ry_or_table with
-000032c0: 2063 6f6e 6469 7469 6f6e 7328 6669 6c74   conditions(filt
-000032d0: 6572 732c 2077 696c 6463 6172 6473 2920  ers, wildcards) 
-000032e0: 746f 2071 7565 7279 2e22 2222 0a20 2020  to query.""".   
-000032f0: 2020 2020 2066 696c 7465 7273 203d 206c       filters = l
-00003300: 6973 7428 6669 6c74 6572 7329 0a20 2020  ist(filters).   
-00003310: 2020 2020 2073 7562 5f71 7565 7279 203d       sub_query =
-00003320: 2028 0a20 2020 2020 2020 2020 2020 2066   (.            f
-00003330: 2228 7b71 7565 7279 5f6f 725f 7461 626c  "({query_or_tabl
-00003340: 657d 2922 0a20 2020 2020 2020 2020 2020  e})".           
-00003350: 2069 6620 5f69 735f 7175 6572 7928 7175   if _is_query(qu
-00003360: 6572 795f 6f72 5f74 6162 6c65 290a 2020  ery_or_table).  
-00003370: 2020 2020 2020 2020 2020 656c 7365 2066            else f
-00003380: 2260 7b71 7565 7279 5f6f 725f 7461 626c  "`{query_or_tabl
-00003390: 657d 6022 0a20 2020 2020 2020 2029 0a0a  e}`".        )..
-000033a0: 2020 2020 2020 2020 2320 544f 444f 2862          # TODO(b
-000033b0: 2f33 3338 3131 3133 3434 293a 2047 656e  /338111344): Gen
-000033c0: 6572 6174 6520 616e 2069 6e64 6578 2062  erate an index b
-000033d0: 6173 6564 206f 6e20 4465 6661 756c 7449  ased on DefaultI
-000033e0: 6e64 6578 4b69 6e64 2069 6620 7765 0a20  ndexKind if we. 
-000033f0: 2020 2020 2020 2023 2064 6f6e 2774 2068         # don't h
-00003400: 6176 6520 696e 6465 7820 636f 6c75 6d6e  ave index column
-00003410: 7320 7370 6563 6966 6965 642e 0a20 2020  s specified..   
-00003420: 2020 2020 2073 656c 6563 745f 636c 6175       select_clau
-00003430: 7365 203d 2022 5345 4c45 4354 2022 202b  se = "SELECT " +
-00003440: 2028 0a20 2020 2020 2020 2020 2020 2022   (.            "
-00003450: 2c20 222e 6a6f 696e 2866 2260 7b63 6f6c  , ".join(f"`{col
-00003460: 756d 6e7d 6022 2066 6f72 2063 6f6c 756d  umn}`" for colum
-00003470: 6e20 696e 2063 6f6c 756d 6e73 2920 6966  n in columns) if
-00003480: 2063 6f6c 756d 6e73 2065 6c73 6520 222a   columns else "*
-00003490: 220a 2020 2020 2020 2020 290a 0a20 2020  ".        )..   
-000034a0: 2020 2020 2077 6865 7265 5f63 6c61 7573       where_claus
-000034b0: 6520 3d20 2222 0a20 2020 2020 2020 2069  e = "".        i
-000034c0: 6620 6669 6c74 6572 733a 0a20 2020 2020  f filters:.     
-000034d0: 2020 2020 2020 2076 616c 6964 5f6f 7065         valid_ope
-000034e0: 7261 746f 7273 3a20 4d61 7070 696e 675b  rators: Mapping[
-000034f0: 7468 6972 645f 7061 7274 795f 7061 6e64  third_party_pand
-00003500: 6173 5f67 6271 2e46 696c 7465 724f 7073  as_gbq.FilterOps
-00003510: 2c20 7374 725d 203d 207b 0a20 2020 2020  , str] = {.     
-00003520: 2020 2020 2020 2020 2020 2022 696e 223a             "in":
-00003530: 2022 494e 222c 0a20 2020 2020 2020 2020   "IN",.         
-00003540: 2020 2020 2020 2022 6e6f 7420 696e 223a         "not in":
-00003550: 2022 4e4f 5420 494e 222c 0a20 2020 2020   "NOT IN",.     
-00003560: 2020 2020 2020 2020 2020 2022 4c49 4b45             "LIKE
-00003570: 223a 2022 4c49 4b45 222c 0a20 2020 2020  ": "LIKE",.     
-00003580: 2020 2020 2020 2020 2020 2022 3d3d 223a             "==":
-00003590: 2022 3d22 2c0a 2020 2020 2020 2020 2020   "=",.          
-000035a0: 2020 2020 2020 223e 223a 2022 3e22 2c0a        ">": ">",.
-000035b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000035c0: 223c 223a 2022 3c22 2c0a 2020 2020 2020  "<": "<",.      
-000035d0: 2020 2020 2020 2020 2020 223e 3d22 3a20            ">=": 
-000035e0: 223e 3d22 2c0a 2020 2020 2020 2020 2020  ">=",.          
-000035f0: 2020 2020 2020 223c 3d22 3a20 223c 3d22        "<=": "<="
-00003600: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00003610: 2020 2221 3d22 3a20 2221 3d22 2c0a 2020    "!=": "!=",.  
-00003620: 2020 2020 2020 2020 2020 7d0a 0a20 2020            }..   
-00003630: 2020 2020 2020 2020 2023 2049 6620 7369           # If si
-00003640: 6e67 6c65 206c 6179 6572 2066 696c 7465  ngle layer filte
-00003650: 722c 2061 6464 2061 6e6f 7468 6572 2070  r, add another p
-00003660: 7365 7564 6f20 6c61 7965 722e 2053 6f20  seudo layer. So 
-00003670: 7468 6520 7369 6e67 6c65 206c 6179 6572  the single layer
-00003680: 2072 6570 7265 7365 6e74 7320 2261 6e64   represents "and
-00003690: 2220 6c6f 6769 632e 0a20 2020 2020 2020  " logic..       
-000036a0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-000036b0: 6365 2866 696c 7465 7273 5b30 5d2c 2074  ce(filters[0], t
-000036c0: 7570 6c65 2920 616e 6420 280a 2020 2020  uple) and (.    
-000036d0: 2020 2020 2020 2020 2020 2020 6c65 6e28              len(
-000036e0: 6669 6c74 6572 735b 305d 2920 3d3d 2030  filters[0]) == 0
-000036f0: 206f 7220 6e6f 7420 6973 696e 7374 616e   or not isinstan
-00003700: 6365 286c 6973 7428 6669 6c74 6572 735b  ce(list(filters[
-00003710: 305d 295b 305d 2c20 7475 706c 6529 0a20  0])[0], tuple). 
-00003720: 2020 2020 2020 2020 2020 2029 3a0a 2020             ):.  
-00003730: 2020 2020 2020 2020 2020 2020 2020 6669                fi
-00003740: 6c74 6572 7320 3d20 7479 7069 6e67 2e63  lters = typing.c
-00003750: 6173 7428 7468 6972 645f 7061 7274 795f  ast(third_party_
-00003760: 7061 6e64 6173 5f67 6271 2e46 696c 7465  pandas_gbq.Filte
-00003770: 7273 5479 7065 2c20 5b66 696c 7465 7273  rsType, [filters
-00003780: 5d29 0a0a 2020 2020 2020 2020 2020 2020  ])..            
-00003790: 6f72 5f65 7870 7265 7373 696f 6e73 203d  or_expressions =
-000037a0: 205b 5d0a 2020 2020 2020 2020 2020 2020   [].            
-000037b0: 666f 7220 6772 6f75 7020 696e 2066 696c  for group in fil
-000037c0: 7465 7273 3a0a 2020 2020 2020 2020 2020  ters:.          
-000037d0: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
-000037e0: 6e73 7461 6e63 6528 6772 6f75 702c 2049  nstance(group, I
-000037f0: 7465 7261 626c 6529 3a0a 2020 2020 2020  terable):.      
-00003800: 2020 2020 2020 2020 2020 2020 2020 6772                gr
-00003810: 6f75 7020 3d20 5b67 726f 7570 5d0a 0a20  oup = [group].. 
-00003820: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00003830: 6e64 5f65 7870 7265 7373 696f 6e73 203d  nd_expressions =
-00003840: 205b 5d0a 2020 2020 2020 2020 2020 2020   [].            
-00003850: 2020 2020 666f 7220 6669 6c74 6572 5f69      for filter_i
-00003860: 7465 6d20 696e 2067 726f 7570 3a0a 2020  tem in group:.  
-00003870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003880: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
-00003890: 6e63 6528 6669 6c74 6572 5f69 7465 6d2c  nce(filter_item,
-000038a0: 2074 7570 6c65 2920 6f72 2028 6c65 6e28   tuple) or (len(
-000038b0: 6669 6c74 6572 5f69 7465 6d29 2021 3d20  filter_item) != 
-000038c0: 3329 3a0a 2020 2020 2020 2020 2020 2020  3):.            
-000038d0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-000038e0: 6520 5661 6c75 6545 7272 6f72 280a 2020  e ValueError(.  
-000038f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003900: 2020 2020 2020 2020 2020 6622 4669 6c74            f"Filt
-00003910: 6572 2063 6f6e 6469 7469 6f6e 2073 686f  er condition sho
-00003920: 756c 6420 6265 2061 2074 7570 6c65 206f  uld be a tuple o
-00003930: 6620 6c65 6e67 7468 2033 2c20 7b66 696c  f length 3, {fil
-00003940: 7465 725f 6974 656d 7d20 6973 206e 6f74  ter_item} is not
-00003950: 2076 616c 6964 2e22 0a20 2020 2020 2020   valid.".       
-00003960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003970: 2029 0a0a 2020 2020 2020 2020 2020 2020   )..            
-00003980: 2020 2020 2020 2020 636f 6c75 6d6e 2c20          column, 
-00003990: 6f70 6572 6174 6f72 2c20 7661 6c75 6520  operator, value 
-000039a0: 3d20 6669 6c74 6572 5f69 7465 6d0a 0a20  = filter_item.. 
-000039b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000039c0: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
-000039d0: 616e 6365 2863 6f6c 756d 6e2c 2073 7472  ance(column, str
-000039e0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-000039f0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00003a00: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
-00003a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003a20: 2020 2020 2020 2020 2066 2243 6f6c 756d           f"Colum
-00003a30: 6e20 6e61 6d65 2073 686f 756c 6420 6265  n name should be
-00003a40: 2061 2073 7472 696e 672c 2062 7574 2072   a string, but r
-00003a50: 6563 6569 7665 6420 277b 636f 6c75 6d6e  eceived '{column
-00003a60: 7d27 206f 6620 7479 7065 207b 7479 7065  }' of type {type
-00003a70: 2863 6f6c 756d 6e29 2e5f 5f6e 616d 655f  (column).__name_
-00003a80: 5f7d 2e22 0a20 2020 2020 2020 2020 2020  _}.".           
-00003a90: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
-00003aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003ab0: 2020 2020 6966 206f 7065 7261 746f 7220      if operator 
-00003ac0: 6e6f 7420 696e 2076 616c 6964 5f6f 7065  not in valid_ope
-00003ad0: 7261 746f 7273 3a0a 2020 2020 2020 2020  rators:.        
-00003ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003af0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-00003b00: 2866 224f 7065 7261 746f 7220 7b6f 7065  (f"Operator {ope
-00003b10: 7261 746f 727d 2069 7320 6e6f 7420 7661  rator} is not va
-00003b20: 6c69 642e 2229 0a0a 2020 2020 2020 2020  lid.")..        
-00003b30: 2020 2020 2020 2020 2020 2020 6f70 6572              oper
-00003b40: 6174 6f72 5f73 7472 203d 2076 616c 6964  ator_str = valid
-00003b50: 5f6f 7065 7261 746f 7273 5b6f 7065 7261  _operators[opera
-00003b60: 746f 725d 0a0a 2020 2020 2020 2020 2020  tor]..          
-00003b70: 2020 2020 2020 2020 2020 6966 206f 7065            if ope
-00003b80: 7261 746f 725f 7374 7220 696e 205b 2249  rator_str in ["I
-00003b90: 4e22 2c20 224e 4f54 2049 4e22 5d3a 0a20  N", "NOT IN"]:. 
-00003ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003bb0: 2020 2020 2020 2076 616c 7565 5f6c 6973         value_lis
-00003bc0: 7420 3d20 222c 2022 2e6a 6f69 6e28 5b72  t = ", ".join([r
-00003bd0: 6570 7228 7629 2066 6f72 2076 2069 6e20  epr(v) for v in 
-00003be0: 7661 6c75 655d 290a 2020 2020 2020 2020  value]).        
-00003bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003c00: 6578 7072 6573 7369 6f6e 203d 2066 2260  expression = f"`
-00003c10: 7b63 6f6c 756d 6e7d 6020 7b6f 7065 7261  {column}` {opera
-00003c20: 746f 725f 7374 727d 2028 7b76 616c 7565  tor_str} ({value
-00003c30: 5f6c 6973 747d 2922 0a20 2020 2020 2020  _list})".       
-00003c40: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-00003c50: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00003c60: 2020 2020 2020 2020 2020 2065 7870 7265             expre
-00003c70: 7373 696f 6e20 3d20 6622 607b 636f 6c75  ssion = f"`{colu
-00003c80: 6d6e 7d60 207b 6f70 6572 6174 6f72 5f73  mn}` {operator_s
-00003c90: 7472 7d20 7b72 6570 7228 7661 6c75 6529  tr} {repr(value)
-00003ca0: 7d22 0a20 2020 2020 2020 2020 2020 2020  }".             
-00003cb0: 2020 2020 2020 2061 6e64 5f65 7870 7265         and_expre
-00003cc0: 7373 696f 6e73 2e61 7070 656e 6428 6578  ssions.append(ex
-00003cd0: 7072 6573 7369 6f6e 290a 0a20 2020 2020  pression)..     
-00003ce0: 2020 2020 2020 2020 2020 206f 725f 6578             or_ex
-00003cf0: 7072 6573 7369 6f6e 732e 6170 7065 6e64  pressions.append
-00003d00: 2822 2041 4e44 2022 2e6a 6f69 6e28 616e  (" AND ".join(an
-00003d10: 645f 6578 7072 6573 7369 6f6e 7329 290a  d_expressions)).
-00003d20: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00003d30: 6f72 5f65 7870 7265 7373 696f 6e73 3a0a  or_expressions:.
-00003d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003d50: 7768 6572 655f 636c 6175 7365 203d 2022  where_clause = "
-00003d60: 2057 4845 5245 2022 202b 2022 204f 5220   WHERE " + " OR 
-00003d70: 222e 6a6f 696e 286f 725f 6578 7072 6573  ".join(or_expres
-00003d80: 7369 6f6e 7329 0a0a 2020 2020 2020 2020  sions)..        
-00003d90: 6675 6c6c 5f71 7565 7279 203d 2066 227b  full_query = f"{
-00003da0: 7365 6c65 6374 5f63 6c61 7573 657d 2046  select_clause} F
-00003db0: 524f 4d20 7b73 7562 5f71 7565 7279 7d20  ROM {sub_query} 
-00003dc0: 4153 2073 7562 7b77 6865 7265 5f63 6c61  AS sub{where_cla
-00003dd0: 7573 657d 220a 2020 2020 2020 2020 7265  use}".        re
-00003de0: 7475 726e 2066 756c 6c5f 7175 6572 790a  turn full_query.
-00003df0: 0a20 2020 2064 6566 205f 7175 6572 795f  .    def _query_
-00003e00: 746f 5f64 6573 7469 6e61 7469 6f6e 280a  to_destination(.
-00003e10: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-00003e20: 2020 2020 2020 7175 6572 793a 2073 7472        query: str
-00003e30: 2c0a 2020 2020 2020 2020 696e 6465 785f  ,.        index_
-00003e40: 636f 6c73 3a20 4c69 7374 5b73 7472 5d2c  cols: List[str],
-00003e50: 0a20 2020 2020 2020 2061 7069 5f6e 616d  .        api_nam
-00003e60: 653a 2073 7472 2c0a 2020 2020 2020 2020  e: str,.        
-00003e70: 636f 6e66 6967 7572 6174 696f 6e3a 2064  configuration: d
-00003e80: 6963 7420 3d20 7b22 7175 6572 7922 3a20  ict = {"query": 
-00003e90: 7b22 7573 6551 7565 7279 4361 6368 6522  {"useQueryCache"
-00003ea0: 3a20 5472 7565 7d7d 2c0a 2020 2020 2020  : True}},.      
-00003eb0: 2020 646f 5f63 6c75 7374 6572 696e 673d    do_clustering=
-00003ec0: 5472 7565 2c0a 2020 2020 2920 2d3e 2054  True,.    ) -> T
-00003ed0: 7570 6c65 5b4f 7074 696f 6e61 6c5b 6269  uple[Optional[bi
-00003ee0: 6771 7565 7279 2e54 6162 6c65 5265 6665  gquery.TableRefe
-00003ef0: 7265 6e63 655d 2c20 6269 6771 7565 7279  rence], bigquery
-00003f00: 2e51 7565 7279 4a6f 625d 3a0a 2020 2020  .QueryJob]:.    
-00003f10: 2020 2020 2320 4966 2061 2064 7279 5f72      # If a dry_r
-00003f20: 756e 2069 6e64 6963 6174 6573 2074 6869  un indicates thi
-00003f30: 7320 6973 206e 6f74 2061 2071 7565 7279  s is not a query
-00003f40: 2074 7970 6520 6a6f 622c 2074 6865 6e20   type job, then 
-00003f50: 646f 6e27 740a 2020 2020 2020 2020 2320  don't.        # 
-00003f60: 626f 7468 6572 2074 7279 696e 6720 746f  bother trying to
-00003f70: 2064 6f20 6120 4352 4541 5445 2054 454d   do a CREATE TEM
-00003f80: 5020 5441 424c 4520 2e2e 2e20 4153 2053  P TABLE ... AS S
-00003f90: 454c 4543 5420 2e2e 2e20 7374 6174 656d  ELECT ... statem
-00003fa0: 656e 742e 0a20 2020 2020 2020 2064 7279  ent..        dry
-00003fb0: 5f72 756e 5f63 6f6e 6669 6720 3d20 6269  _run_config = bi
-00003fc0: 6771 7565 7279 2e51 7565 7279 4a6f 6243  gquery.QueryJobC
-00003fd0: 6f6e 6669 6728 290a 2020 2020 2020 2020  onfig().        
-00003fe0: 6472 795f 7275 6e5f 636f 6e66 6967 2e64  dry_run_config.d
-00003ff0: 7279 5f72 756e 203d 2054 7275 650a 2020  ry_run = True.  
-00004000: 2020 2020 2020 5f2c 2064 7279 5f72 756e        _, dry_run
-00004010: 5f6a 6f62 203d 2073 656c 662e 5f73 7461  _job = self._sta
-00004020: 7274 5f71 7565 7279 2871 7565 7279 2c20  rt_query(query, 
-00004030: 6a6f 625f 636f 6e66 6967 3d64 7279 5f72  job_config=dry_r
-00004040: 756e 5f63 6f6e 6669 6729 0a20 2020 2020  un_config).     
-00004050: 2020 2069 6620 6472 795f 7275 6e5f 6a6f     if dry_run_jo
-00004060: 622e 7374 6174 656d 656e 745f 7479 7065  b.statement_type
-00004070: 2021 3d20 2253 454c 4543 5422 3a0a 2020   != "SELECT":.  
-00004080: 2020 2020 2020 2020 2020 5f2c 2071 7565            _, que
-00004090: 7279 5f6a 6f62 203d 2073 656c 662e 5f73  ry_job = self._s
-000040a0: 7461 7274 5f71 7565 7279 2871 7565 7279  tart_query(query
-000040b0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-000040c0: 7475 726e 2071 7565 7279 5f6a 6f62 2e64  turn query_job.d
-000040d0: 6573 7469 6e61 7469 6f6e 2c20 7175 6572  estination, quer
-000040e0: 795f 6a6f 620a 0a20 2020 2020 2020 2023  y_job..        #
-000040f0: 2043 7265 6174 6520 6120 7461 626c 6520   Create a table 
-00004100: 746f 2077 6f72 6b61 726f 756e 6420 4269  to workaround Bi
-00004110: 6751 7565 7279 2031 3020 4742 2071 7565  gQuery 10 GB que
-00004120: 7279 2072 6573 756c 7473 206c 696d 6974  ry results limit
-00004130: 2e20 5365 653a 0a20 2020 2020 2020 2023  . See:.        #
-00004140: 2069 6e74 6572 6e61 6c20 6973 7375 6520   internal issue 
-00004150: 3330 3330 3537 3333 362e 0a20 2020 2020  303057336..     
-00004160: 2020 2023 2053 696e 6365 2077 6520 6861     # Since we ha
-00004170: 7665 2061 2060 7374 6174 656d 656e 745f  ve a `statement_
-00004180: 7479 7065 203d 3d20 2753 454c 4543 5427  type == 'SELECT'
-00004190: 602c 2073 6368 656d 6120 7368 6f75 6c64  `, schema should
-000041a0: 2062 6520 706f 7075 6c61 7465 642e 0a20   be populated.. 
-000041b0: 2020 2020 2020 2073 6368 656d 6120 3d20         schema = 
-000041c0: 7479 7069 6e67 2e63 6173 7428 4974 6572  typing.cast(Iter
-000041d0: 6162 6c65 5b62 6967 7175 6572 792e 5363  able[bigquery.Sc
-000041e0: 6865 6d61 4669 656c 645d 2c20 6472 795f  hemaField], dry_
-000041f0: 7275 6e5f 6a6f 622e 7363 6865 6d61 290a  run_job.schema).
-00004200: 2020 2020 2020 2020 6966 2064 6f5f 636c          if do_cl
-00004210: 7573 7465 7269 6e67 3a0a 2020 2020 2020  ustering:.      
-00004220: 2020 2020 2020 636c 7573 7465 725f 636f        cluster_co
-00004230: 6c73 203d 205b 0a20 2020 2020 2020 2020  ls = [.         
-00004240: 2020 2020 2020 2069 7465 6d2e 6e61 6d65         item.name
-00004250: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004260: 2066 6f72 2069 7465 6d20 696e 2073 6368   for item in sch
-00004270: 656d 610a 2020 2020 2020 2020 2020 2020  ema.            
-00004280: 2020 2020 6966 2028 6974 656d 2e6e 616d      if (item.nam
-00004290: 6520 696e 2069 6e64 6578 5f63 6f6c 7329  e in index_cols)
-000042a0: 2061 6e64 205f 6361 6e5f 636c 7573 7465   and _can_cluste
-000042b0: 725f 6271 2869 7465 6d29 0a20 2020 2020  r_bq(item).     
-000042c0: 2020 2020 2020 205d 5b3a 5f4d 4158 5f43         ][:_MAX_C
-000042d0: 4c55 5354 4552 5f43 4f4c 554d 4e53 5d0a  LUSTER_COLUMNS].
-000042e0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-000042f0: 2020 2020 2020 2020 2020 636c 7573 7465            cluste
-00004300: 725f 636f 6c73 203d 205b 5d0a 2020 2020  r_cols = [].    
-00004310: 2020 2020 7465 6d70 5f74 6162 6c65 203d      temp_table =
-00004320: 2073 656c 662e 5f63 7265 6174 655f 656d   self._create_em
-00004330: 7074 795f 7465 6d70 5f74 6162 6c65 2873  pty_temp_table(s
-00004340: 6368 656d 612c 2063 6c75 7374 6572 5f63  chema, cluster_c
-00004350: 6f6c 7329 0a0a 2020 2020 2020 2020 7469  ols)..        ti
-00004360: 6d65 6f75 745f 6d73 203d 2063 6f6e 6669  meout_ms = confi
-00004370: 6775 7261 7469 6f6e 2e67 6574 2822 6a6f  guration.get("jo
-00004380: 6254 696d 656f 7574 4d73 2229 206f 7220  bTimeoutMs") or 
-00004390: 636f 6e66 6967 7572 6174 696f 6e5b 2271  configuration["q
-000043a0: 7565 7279 225d 2e67 6574 280a 2020 2020  uery"].get(.    
-000043b0: 2020 2020 2020 2020 2274 696d 656f 7574          "timeout
-000043c0: 4d73 220a 2020 2020 2020 2020 290a 0a20  Ms".        ).. 
-000043d0: 2020 2020 2020 2023 2043 6f6e 7665 7274         # Convert
-000043e0: 2074 696d 656f 7574 5f6d 7320 746f 2073   timeout_ms to s
-000043f0: 6563 6f6e 6473 2c20 656e 7375 7269 6e67  econds, ensuring
-00004400: 2061 206d 696e 696d 756d 206f 6620 302e   a minimum of 0.
-00004410: 3120 7365 636f 6e64 7320 746f 2061 766f  1 seconds to avo
-00004420: 6964 0a20 2020 2020 2020 2023 2074 6865  id.        # the
-00004430: 2070 726f 6772 616d 2067 6574 7469 6e67   program getting
-00004440: 2073 7475 636b 206f 6e20 746f 6f2d 7368   stuck on too-sh
-00004450: 6f72 7420 7469 6d65 6f75 7473 2e0a 2020  ort timeouts..  
-00004460: 2020 2020 2020 7469 6d65 6f75 7420 3d20        timeout = 
-00004470: 6d61 7828 696e 7428 7469 6d65 6f75 745f  max(int(timeout_
-00004480: 6d73 2920 2a20 3165 2d33 2c20 302e 3129  ms) * 1e-3, 0.1)
-00004490: 2069 6620 7469 6d65 6f75 745f 6d73 2065   if timeout_ms e
-000044a0: 6c73 6520 4e6f 6e65 0a0a 2020 2020 2020  lse None..      
-000044b0: 2020 6a6f 625f 636f 6e66 6967 203d 2074    job_config = t
-000044c0: 7970 696e 672e 6361 7374 280a 2020 2020  yping.cast(.    
-000044d0: 2020 2020 2020 2020 6269 6771 7565 7279          bigquery
-000044e0: 2e51 7565 7279 4a6f 6243 6f6e 6669 672c  .QueryJobConfig,
-000044f0: 0a20 2020 2020 2020 2020 2020 2062 6967  .            big
-00004500: 7175 6572 792e 5175 6572 794a 6f62 436f  query.QueryJobCo
-00004510: 6e66 6967 2e66 726f 6d5f 6170 695f 7265  nfig.from_api_re
-00004520: 7072 2863 6f6e 6669 6775 7261 7469 6f6e  pr(configuration
-00004530: 292c 0a20 2020 2020 2020 2029 0a20 2020  ),.        ).   
-00004540: 2020 2020 206a 6f62 5f63 6f6e 6669 672e       job_config.
-00004550: 6c61 6265 6c73 5b22 6269 6766 7261 6d65  labels["bigframe
-00004560: 732d 6170 6922 5d20 3d20 6170 695f 6e61  s-api"] = api_na
-00004570: 6d65 0a20 2020 2020 2020 206a 6f62 5f63  me.        job_c
-00004580: 6f6e 6669 672e 6465 7374 696e 6174 696f  onfig.destinatio
-00004590: 6e20 3d20 7465 6d70 5f74 6162 6c65 0a0a  n = temp_table..
-000045a0: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
-000045b0: 2020 2020 2020 2020 2023 2057 7269 7465           # Write
-000045c0: 2074 6f20 7465 6d70 2074 6162 6c65 2074   to temp table t
-000045d0: 6f20 776f 726b 6172 6f75 6e64 2042 6967  o workaround Big
-000045e0: 5175 6572 7920 3130 2047 4220 7175 6572  Query 10 GB quer
-000045f0: 7920 7265 7375 6c74 730a 2020 2020 2020  y results.      
-00004600: 2020 2020 2020 2320 6c69 6d69 742e 2053        # limit. S
-00004610: 6565 3a20 696e 7465 726e 616c 2069 7373  ee: internal iss
-00004620: 7565 2033 3033 3035 3733 3336 2e0a 2020  ue 303057336..  
-00004630: 2020 2020 2020 2020 2020 6a6f 625f 636f            job_co
-00004640: 6e66 6967 2e6c 6162 656c 735b 2265 7272  nfig.labels["err
-00004650: 6f72 5f63 6175 6768 7422 5d20 3d20 2274  or_caught"] = "t
-00004660: 7275 6522 0a20 2020 2020 2020 2020 2020  rue".           
-00004670: 205f 2c20 7175 6572 795f 6a6f 6220 3d20   _, query_job = 
-00004680: 7365 6c66 2e5f 7374 6172 745f 7175 6572  self._start_quer
-00004690: 7928 0a20 2020 2020 2020 2020 2020 2020  y(.             
-000046a0: 2020 2071 7565 7279 2c20 6a6f 625f 636f     query, job_co
-000046b0: 6e66 6967 3d6a 6f62 5f63 6f6e 6669 672c  nfig=job_config,
-000046c0: 2074 696d 656f 7574 3d74 696d 656f 7574   timeout=timeout
-000046d0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-000046e0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-000046f0: 6e20 7175 6572 795f 6a6f 622e 6465 7374  n query_job.dest
-00004700: 696e 6174 696f 6e2c 2071 7565 7279 5f6a  ination, query_j
-00004710: 6f62 0a20 2020 2020 2020 2065 7863 6570  ob.        excep
-00004720: 7420 676f 6f67 6c65 2e61 7069 5f63 6f72  t google.api_cor
-00004730: 652e 6578 6365 7074 696f 6e73 2e42 6164  e.exceptions.Bad
-00004740: 5265 7175 6573 743a 0a20 2020 2020 2020  Request:.       
-00004750: 2020 2020 2023 2053 6f6d 6520 5345 4c45       # Some SELE
-00004760: 4354 2073 7461 7465 6d65 6e74 7320 7374  CT statements st
-00004770: 696c 6c20 6172 656e 2774 2063 6f6d 7061  ill aren't compa
-00004780: 7469 626c 6520 7769 7468 2063 6c75 7374  tible with clust
-00004790: 6572 0a20 2020 2020 2020 2020 2020 2023  er.            #
-000047a0: 2074 6162 6c65 7320 6173 2074 6865 2064   tables as the d
-000047b0: 6573 7469 6e61 7469 6f6e 2e20 466f 7220  estination. For 
-000047c0: 6578 616d 706c 652c 2069 6620 7468 6520  example, if the 
-000047d0: 7175 6572 7920 6861 7320 610a 2020 2020  query has a.    
-000047e0: 2020 2020 2020 2020 2320 746f 702d 6c65          # top-le
-000047f0: 7665 6c20 4f52 4445 5220 4259 2c20 7468  vel ORDER BY, th
-00004800: 6973 2063 6f6e 666c 6963 7473 2077 6974  is conflicts wit
-00004810: 6820 6f75 7220 6162 696c 6974 7920 746f  h our ability to
-00004820: 2063 6c75 7374 6572 0a20 2020 2020 2020   cluster.       
-00004830: 2020 2020 2023 2074 6865 2074 6162 6c65       # the table
-00004840: 2062 7920 7468 6520 696e 6465 7820 636f   by the index co
-00004850: 6c75 6d6e 2873 292e 0a20 2020 2020 2020  lumn(s)..       
-00004860: 2020 2020 205f 2c20 7175 6572 795f 6a6f       _, query_jo
-00004870: 6220 3d20 7365 6c66 2e5f 7374 6172 745f  b = self._start_
-00004880: 7175 6572 7928 7175 6572 792c 2074 696d  query(query, tim
-00004890: 656f 7574 3d74 696d 656f 7574 290a 2020  eout=timeout).  
-000048a0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-000048b0: 2071 7565 7279 5f6a 6f62 2e64 6573 7469   query_job.desti
-000048c0: 6e61 7469 6f6e 2c20 7175 6572 795f 6a6f  nation, query_jo
-000048d0: 620a 0a20 2020 2064 6566 2072 6561 645f  b..    def read_
-000048e0: 6762 715f 7175 6572 7928 0a20 2020 2020  gbq_query(.     
-000048f0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00004900: 2071 7565 7279 3a20 7374 722c 0a20 2020   query: str,.   
-00004910: 2020 2020 202a 2c0a 2020 2020 2020 2020       *,.        
-00004920: 696e 6465 785f 636f 6c3a 2049 7465 7261  index_col: Itera
-00004930: 626c 655b 7374 725d 207c 2073 7472 207c  ble[str] | str |
-00004940: 2062 6967 6672 616d 6573 2e65 6e75 6d73   bigframes.enums
-00004950: 2e44 6566 6175 6c74 496e 6465 784b 696e  .DefaultIndexKin
-00004960: 6420 3d20 2829 2c0a 2020 2020 2020 2020  d = (),.        
-00004970: 636f 6c75 6d6e 733a 2049 7465 7261 626c  columns: Iterabl
-00004980: 655b 7374 725d 203d 2028 292c 0a20 2020  e[str] = (),.   
-00004990: 2020 2020 2063 6f6e 6669 6775 7261 7469       configurati
-000049a0: 6f6e 3a20 4f70 7469 6f6e 616c 5b44 6963  on: Optional[Dic
-000049b0: 745d 203d 204e 6f6e 652c 0a20 2020 2020  t] = None,.     
-000049c0: 2020 206d 6178 5f72 6573 756c 7473 3a20     max_results: 
-000049d0: 4f70 7469 6f6e 616c 5b69 6e74 5d20 3d20  Optional[int] = 
-000049e0: 4e6f 6e65 2c0a 2020 2020 2020 2020 7573  None,.        us
-000049f0: 655f 6361 6368 653a 204f 7074 696f 6e61  e_cache: Optiona
-00004a00: 6c5b 626f 6f6c 5d20 3d20 4e6f 6e65 2c0a  l[bool] = None,.
-00004a10: 2020 2020 2020 2020 636f 6c5f 6f72 6465          col_orde
-00004a20: 723a 2049 7465 7261 626c 655b 7374 725d  r: Iterable[str]
-00004a30: 203d 2028 292c 0a20 2020 2029 202d 3e20   = (),.    ) -> 
-00004a40: 6461 7461 6672 616d 652e 4461 7461 4672  dataframe.DataFr
-00004a50: 616d 653a 0a20 2020 2020 2020 2022 2222  ame:.        """
-00004a60: 5475 726e 2061 2053 514c 2071 7565 7279  Turn a SQL query
-00004a70: 2069 6e74 6f20 6120 4461 7461 4672 616d   into a DataFram
-00004a80: 652e 0a0a 2020 2020 2020 2020 4e6f 7465  e...        Note
-00004a90: 3a20 4265 6361 7573 6520 7468 6520 7265  : Because the re
-00004aa0: 7375 6c74 7320 6172 6520 7772 6974 7465  sults are writte
-00004ab0: 6e20 746f 2061 2074 656d 706f 7261 7279  n to a temporary
-00004ac0: 2074 6162 6c65 2c20 6f72 6465 7269 6e67   table, ordering
-00004ad0: 2062 790a 2020 2020 2020 2020 6060 4f52   by.        ``OR
-00004ae0: 4445 5220 4259 6060 2069 7320 6e6f 7420  DER BY`` is not 
-00004af0: 7072 6573 6572 7665 642e 2041 2075 6e69  preserved. A uni
-00004b00: 7175 6520 6069 6e64 6578 5f63 6f6c 6020  que `index_col` 
-00004b10: 6973 2072 6563 6f6d 6d65 6e64 6564 2e20  is recommended. 
-00004b20: 5573 650a 2020 2020 2020 2020 6060 726f  Use.        ``ro
-00004b30: 775f 6e75 6d62 6572 2829 206f 7665 7220  w_number() over 
-00004b40: 2829 6060 2069 6620 7468 6572 6520 6973  ()`` if there is
-00004b50: 206e 6f20 6e61 7475 7261 6c20 756e 6971   no natural uniq
-00004b60: 7565 2069 6e64 6578 206f 7220 796f 750a  ue index or you.
-00004b70: 2020 2020 2020 2020 7761 6e74 2074 6f20          want to 
-00004b80: 7072 6573 6572 7665 206f 7264 6572 696e  preserve orderin
-00004b90: 672e 0a0a 2020 2020 2020 2020 2a2a 4578  g...        **Ex
-00004ba0: 616d 706c 6573 3a2a 2a0a 0a20 2020 2020  amples:**..     
-00004bb0: 2020 2020 2020 203e 3e3e 2069 6d70 6f72         >>> impor
-00004bc0: 7420 6269 6766 7261 6d65 732e 7061 6e64  t bigframes.pand
-00004bd0: 6173 2061 7320 6270 640a 2020 2020 2020  as as bpd.      
-00004be0: 2020 2020 2020 3e3e 3e20 6270 642e 6f70        >>> bpd.op
-00004bf0: 7469 6f6e 732e 6469 7370 6c61 792e 7072  tions.display.pr
-00004c00: 6f67 7265 7373 5f62 6172 203d 204e 6f6e  ogress_bar = Non
-00004c10: 650a 0a20 2020 2020 2020 2053 696d 706c  e..        Simpl
-00004c20: 6520 7175 6572 7920 696e 7075 743a 0a0a  e query input:..
-00004c30: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-00004c40: 6466 203d 2062 7064 2e72 6561 645f 6762  df = bpd.read_gb
-00004c50: 715f 7175 6572 7928 2727 270a 2020 2020  q_query('''.    
-00004c60: 2020 2020 2020 2020 2e2e 2e20 2020 2053          ...    S
-00004c70: 454c 4543 540a 2020 2020 2020 2020 2020  ELECT.          
-00004c80: 2020 2e2e 2e20 2020 2020 2020 7069 7463    ...       pitc
-00004c90: 6865 7246 6972 7374 4e61 6d65 2c0a 2020  herFirstName,.  
-00004ca0: 2020 2020 2020 2020 2020 2e2e 2e20 2020            ...   
-00004cb0: 2020 2020 7069 7463 6865 724c 6173 744e      pitcherLastN
-00004cc0: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
-00004cd0: 202e 2e2e 2020 2020 2020 2070 6974 6368   ...       pitch
-00004ce0: 5370 6565 642c 0a20 2020 2020 2020 2020  Speed,.         
-00004cf0: 2020 202e 2e2e 2020 2020 4652 4f4d 2060     ...    FROM `
-00004d00: 6269 6771 7565 7279 2d70 7562 6c69 632d  bigquery-public-
-00004d10: 6461 7461 2e62 6173 6562 616c 6c2e 6761  data.baseball.ga
-00004d20: 6d65 735f 7769 6465 600a 2020 2020 2020  mes_wide`.      
-00004d30: 2020 2020 2020 2e2e 2e20 2727 2729 0a0a        ... ''')..
-00004d40: 2020 2020 2020 2020 5072 6573 6572 7665          Preserve
-00004d50: 206f 7264 6572 696e 6720 696e 2061 2071   ordering in a q
-00004d60: 7565 7279 2069 6e70 7574 2e0a 0a20 2020  uery input...   
-00004d70: 2020 2020 2020 2020 203e 3e3e 2064 6620           >>> df 
-00004d80: 3d20 6270 642e 7265 6164 5f67 6271 5f71  = bpd.read_gbq_q
-00004d90: 7565 7279 2827 2727 0a20 2020 2020 2020  uery('''.       
-00004da0: 2020 2020 202e 2e2e 2020 2020 5345 4c45       ...    SELE
-00004db0: 4354 0a20 2020 2020 2020 2020 2020 202e  CT.            .
-00004dc0: 2e2e 2020 2020 2020 202d 2d20 496e 7374  ..       -- Inst
-00004dd0: 6561 6420 6f66 2061 6e20 4f52 4445 5220  ead of an ORDER 
-00004de0: 4259 2063 6c61 7573 6520 6f6e 2074 6865  BY clause on the
-00004df0: 2071 7565 7279 2c20 7573 650a 2020 2020   query, use.    
-00004e00: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-00004e10: 2020 2d2d 2052 4f57 5f4e 554d 4245 5228    -- ROW_NUMBER(
-00004e20: 2920 746f 2063 7265 6174 6520 616e 206f  ) to create an o
-00004e30: 7264 6572 6564 2044 6174 6146 7261 6d65  rdered DataFrame
-00004e40: 2e0a 2020 2020 2020 2020 2020 2020 2e2e  ..            ..
-00004e50: 2e20 2020 2020 2020 524f 575f 4e55 4d42  .       ROW_NUMB
-00004e60: 4552 2829 204f 5645 5220 284f 5244 4552  ER() OVER (ORDER
-00004e70: 2042 5920 4156 4728 7069 7463 6853 7065   BY AVG(pitchSpe
-00004e80: 6564 2920 4445 5343 290a 2020 2020 2020  ed) DESC).      
-00004e90: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
-00004ea0: 2020 4153 2072 6f77 696e 6465 782c 0a20    AS rowindex,. 
-00004eb0: 2020 2020 2020 2020 2020 202e 2e2e 0a20             .... 
-00004ec0: 2020 2020 2020 2020 2020 202e 2e2e 2020             ...  
-00004ed0: 2020 2020 2070 6974 6368 6572 4669 7273       pitcherFirs
-00004ee0: 744e 616d 652c 0a20 2020 2020 2020 2020  tName,.         
-00004ef0: 2020 202e 2e2e 2020 2020 2020 2070 6974     ...       pit
-00004f00: 6368 6572 4c61 7374 4e61 6d65 2c0a 2020  cherLastName,.  
-00004f10: 2020 2020 2020 2020 2020 2e2e 2e20 2020            ...   
-00004f20: 2020 2020 4156 4728 7069 7463 6853 7065      AVG(pitchSpe
-00004f30: 6564 2920 4153 2061 7665 7261 6765 5069  ed) AS averagePi
-00004f40: 7463 6853 7065 6564 0a20 2020 2020 2020  tchSpeed.       
-00004f50: 2020 2020 202e 2e2e 2020 2020 2046 524f       ...     FRO
-00004f60: 4d20 6062 6967 7175 6572 792d 7075 626c  M `bigquery-publ
-00004f70: 6963 2d64 6174 612e 6261 7365 6261 6c6c  ic-data.baseball
-00004f80: 2e67 616d 6573 5f77 6964 6560 0a20 2020  .games_wide`.   
-00004f90: 2020 2020 2020 2020 202e 2e2e 2020 2020           ...    
-00004fa0: 2057 4845 5245 2079 6561 7220 3d20 3230   WHERE year = 20
-00004fb0: 3136 0a20 2020 2020 2020 2020 2020 202e  16.            .
-00004fc0: 2e2e 2020 2020 2047 524f 5550 2042 5920  ..     GROUP BY 
-00004fd0: 7069 7463 6865 7246 6972 7374 4e61 6d65  pitcherFirstName
-00004fe0: 2c20 7069 7463 6865 724c 6173 744e 616d  , pitcherLastNam
-00004ff0: 650a 2020 2020 2020 2020 2020 2020 2e2e  e.            ..
-00005000: 2e20 2727 272c 2069 6e64 6578 5f63 6f6c  . ''', index_col
-00005010: 3d22 726f 7769 6e64 6578 2229 0a20 2020  ="rowindex").   
-00005020: 2020 2020 2020 2020 203e 3e3e 2064 662e           >>> df.
-00005030: 6865 6164 2832 290a 2020 2020 2020 2020  head(2).        
-00005040: 2020 2020 2020 2020 2020 2020 2070 6974               pit
-00005050: 6368 6572 4669 7273 744e 616d 6520 7069  cherFirstName pi
-00005060: 7463 6865 724c 6173 744e 616d 6520 2061  tcherLastName  a
-00005070: 7665 7261 6765 5069 7463 6853 7065 6564  veragePitchSpeed
-00005080: 0a20 2020 2020 2020 2020 2020 2072 6f77  .            row
-00005090: 696e 6465 780a 2020 2020 2020 2020 2020  index.          
-000050a0: 2020 3120 2020 2020 2020 2020 2020 2020    1             
-000050b0: 2020 2041 6c62 6572 7469 6e20 2020 2020     Albertin     
-000050c0: 2020 2020 4368 6170 6d61 6e20 2020 2020      Chapman     
-000050d0: 2020 2020 2039 362e 3531 3431 3133 0a20       96.514113. 
-000050e0: 2020 2020 2020 2020 2020 2032 2020 2020             2    
-000050f0: 2020 2020 2020 2020 2020 2020 205a 6163               Zac
-00005100: 6861 7279 2020 2020 2020 2020 2042 7269  hary         Bri
-00005110: 7474 6f6e 2020 2020 2020 2020 2020 3934  tton          94
-00005120: 2e35 3931 3033 390a 2020 2020 2020 2020  .591039.        
-00005130: 2020 2020 3c42 4c41 4e4b 4c49 4e45 3e0a      <BLANKLINE>.
-00005140: 2020 2020 2020 2020 2020 2020 5b32 2072              [2 r
-00005150: 6f77 7320 7820 3320 636f 6c75 6d6e 735d  ows x 3 columns]
-00005160: 0a0a 2020 2020 2020 2020 5365 6520 616c  ..        See al
-00005170: 736f 3a20 3a6d 6574 683a 6053 6573 7369  so: :meth:`Sessi
-00005180: 6f6e 2e72 6561 645f 6762 7160 2e0a 2020  on.read_gbq`..  
-00005190: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000051a0: 2020 2320 4e4f 5445 3a20 5468 6973 206d    # NOTE: This m
-000051b0: 6574 686f 6420 646f 6573 6e27 7420 2879  ethod doesn't (y
-000051c0: 6574 2920 6578 6973 7420 696e 2070 616e  et) exist in pan
-000051d0: 6461 7320 6f72 2070 616e 6461 732d 6762  das or pandas-gb
-000051e0: 712c 2073 6f0a 2020 2020 2020 2020 2320  q, so.        # 
-000051f0: 7468 6573 6520 646f 6373 7472 696e 6773  these docstrings
-00005200: 2061 7265 2069 6e6c 696e 652e 0a20 2020   are inline..   
-00005210: 2020 2020 2069 6620 636f 6c75 6d6e 7320       if columns 
-00005220: 616e 6420 636f 6c5f 6f72 6465 723a 0a20  and col_order:. 
-00005230: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00005240: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
-00005250: 2020 2020 2020 2020 2020 2020 2022 4d75               "Mu
-00005260: 7374 2073 7065 6369 6679 2065 6974 6865  st specify eithe
-00005270: 7220 636f 6c75 6d6e 7320 2870 7265 6665  r columns (prefe
-00005280: 7272 6564 2920 6f72 2063 6f6c 5f6f 7264  rred) or col_ord
-00005290: 6572 2c20 6e6f 7420 626f 7468 220a 2020  er, not both".  
-000052a0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-000052b0: 2020 2020 656c 6966 2063 6f6c 5f6f 7264      elif col_ord
-000052c0: 6572 3a0a 2020 2020 2020 2020 2020 2020  er:.            
-000052d0: 636f 6c75 6d6e 7320 3d20 636f 6c5f 6f72  columns = col_or
-000052e0: 6465 720a 0a20 2020 2020 2020 2072 6574  der..        ret
-000052f0: 7572 6e20 7365 6c66 2e5f 7265 6164 5f67  urn self._read_g
-00005300: 6271 5f71 7565 7279 280a 2020 2020 2020  bq_query(.      
-00005310: 2020 2020 2020 7175 6572 793d 7175 6572        query=quer
-00005320: 792c 0a20 2020 2020 2020 2020 2020 2069  y,.            i
-00005330: 6e64 6578 5f63 6f6c 3d69 6e64 6578 5f63  ndex_col=index_c
-00005340: 6f6c 2c0a 2020 2020 2020 2020 2020 2020  ol,.            
-00005350: 636f 6c75 6d6e 733d 636f 6c75 6d6e 732c  columns=columns,
-00005360: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
-00005370: 6669 6775 7261 7469 6f6e 3d63 6f6e 6669  figuration=confi
-00005380: 6775 7261 7469 6f6e 2c0a 2020 2020 2020  guration,.      
-00005390: 2020 2020 2020 6d61 785f 7265 7375 6c74        max_result
-000053a0: 733d 6d61 785f 7265 7375 6c74 732c 0a20  s=max_results,. 
-000053b0: 2020 2020 2020 2020 2020 2061 7069 5f6e             api_n
-000053c0: 616d 653d 2272 6561 645f 6762 715f 7175  ame="read_gbq_qu
-000053d0: 6572 7922 2c0a 2020 2020 2020 2020 2020  ery",.          
-000053e0: 2020 7573 655f 6361 6368 653d 7573 655f    use_cache=use_
-000053f0: 6361 6368 652c 0a20 2020 2020 2020 2029  cache,.        )
-00005400: 0a0a 2020 2020 6465 6620 5f72 6561 645f  ..    def _read_
-00005410: 6762 715f 7175 6572 7928 0a20 2020 2020  gbq_query(.     
-00005420: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00005430: 2071 7565 7279 3a20 7374 722c 0a20 2020   query: str,.   
-00005440: 2020 2020 202a 2c0a 2020 2020 2020 2020       *,.        
-00005450: 696e 6465 785f 636f 6c3a 2049 7465 7261  index_col: Itera
-00005460: 626c 655b 7374 725d 207c 2073 7472 207c  ble[str] | str |
-00005470: 2062 6967 6672 616d 6573 2e65 6e75 6d73   bigframes.enums
-00005480: 2e44 6566 6175 6c74 496e 6465 784b 696e  .DefaultIndexKin
-00005490: 6420 3d20 2829 2c0a 2020 2020 2020 2020  d = (),.        
-000054a0: 636f 6c75 6d6e 733a 2049 7465 7261 626c  columns: Iterabl
-000054b0: 655b 7374 725d 203d 2028 292c 0a20 2020  e[str] = (),.   
-000054c0: 2020 2020 2063 6f6e 6669 6775 7261 7469       configurati
-000054d0: 6f6e 3a20 4f70 7469 6f6e 616c 5b44 6963  on: Optional[Dic
-000054e0: 745d 203d 204e 6f6e 652c 0a20 2020 2020  t] = None,.     
-000054f0: 2020 206d 6178 5f72 6573 756c 7473 3a20     max_results: 
-00005500: 4f70 7469 6f6e 616c 5b69 6e74 5d20 3d20  Optional[int] = 
-00005510: 4e6f 6e65 2c0a 2020 2020 2020 2020 6170  None,.        ap
-00005520: 695f 6e61 6d65 3a20 7374 7220 3d20 2272  i_name: str = "r
-00005530: 6561 645f 6762 715f 7175 6572 7922 2c0a  ead_gbq_query",.
-00005540: 2020 2020 2020 2020 7573 655f 6361 6368          use_cach
-00005550: 653a 204f 7074 696f 6e61 6c5b 626f 6f6c  e: Optional[bool
-00005560: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2920  ] = None,.    ) 
-00005570: 2d3e 2064 6174 6166 7261 6d65 2e44 6174  -> dataframe.Dat
-00005580: 6146 7261 6d65 3a0a 2020 2020 2020 2020  aFrame:.        
-00005590: 696d 706f 7274 2062 6967 6672 616d 6573  import bigframes
-000055a0: 2e64 6174 6166 7261 6d65 2061 7320 6461  .dataframe as da
-000055b0: 7461 6672 616d 650a 0a20 2020 2020 2020  taframe..       
-000055c0: 2063 6f6e 6669 6775 7261 7469 6f6e 203d   configuration =
-000055d0: 205f 7472 616e 7366 6f72 6d5f 7265 6164   _transform_read
-000055e0: 5f67 6271 5f63 6f6e 6669 6775 7261 7469  _gbq_configurati
-000055f0: 6f6e 2863 6f6e 6669 6775 7261 7469 6f6e  on(configuration
-00005600: 290a 0a20 2020 2020 2020 2069 6620 2271  )..        if "q
-00005610: 7565 7279 2220 6e6f 7420 696e 2063 6f6e  uery" not in con
-00005620: 6669 6775 7261 7469 6f6e 3a0a 2020 2020  figuration:.    
-00005630: 2020 2020 2020 2020 636f 6e66 6967 7572          configur
-00005640: 6174 696f 6e5b 2271 7565 7279 225d 203d  ation["query"] =
-00005650: 207b 7d0a 0a20 2020 2020 2020 2069 6620   {}..        if 
-00005660: 2271 7565 7279 2220 696e 2063 6f6e 6669  "query" in confi
-00005670: 6775 7261 7469 6f6e 5b22 7175 6572 7922  guration["query"
-00005680: 5d3a 0a20 2020 2020 2020 2020 2020 2072  ]:.            r
-00005690: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-000056a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000056b0: 2022 5468 6520 7175 6572 7920 7374 6174   "The query stat
-000056c0: 656d 656e 7420 6d75 7374 206e 6f74 2062  ement must not b
-000056d0: 6520 696e 636c 7564 6564 2069 6e20 7468  e included in th
-000056e0: 6520 222c 0a20 2020 2020 2020 2020 2020  e ",.           
-000056f0: 2020 2020 2022 2763 6f6e 6669 6775 7261       "'configura
-00005700: 7469 6f6e 2720 6265 6361 7573 6520 6974  tion' because it
-00005710: 2069 7320 616c 7265 6164 7920 7072 6f76   is already prov
-00005720: 6964 6564 2061 7322 2c0a 2020 2020 2020  ided as",.      
-00005730: 2020 2020 2020 2020 2020 2220 6120 7365            " a se
-00005740: 7061 7261 7465 2070 6172 616d 6574 6572  parate parameter
-00005750: 2e22 2c0a 2020 2020 2020 2020 2020 2020  .",.            
-00005760: 290a 0a20 2020 2020 2020 2069 6620 2275  )..        if "u
-00005770: 7365 5175 6572 7943 6163 6865 2220 696e  seQueryCache" in
-00005780: 2063 6f6e 6669 6775 7261 7469 6f6e 5b22   configuration["
-00005790: 7175 6572 7922 5d3a 0a20 2020 2020 2020  query"]:.       
-000057a0: 2020 2020 2069 6620 7573 655f 6361 6368       if use_cach
-000057b0: 6520 6973 206e 6f74 204e 6f6e 653a 0a20  e is not None:. 
-000057c0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-000057d0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-000057e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000057f0: 2020 2020 2022 2775 7365 5175 6572 7943       "'useQueryC
-00005800: 6163 6865 2720 696e 2027 636f 6e66 6967  ache' in 'config
-00005810: 7572 6174 696f 6e27 2063 6f6e 666c 6963  uration' conflic
-00005820: 7473 2077 6974 6822 0a20 2020 2020 2020  ts with".       
-00005830: 2020 2020 2020 2020 2020 2020 2022 2027               " '
-00005840: 7573 655f 6361 6368 6527 2070 6172 616d  use_cache' param
-00005850: 6574 6572 2e20 506c 6561 7365 2073 7065  eter. Please spe
-00005860: 6369 6679 206f 6e6c 7920 6f6e 652e 220a  cify only one.".
-00005870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005880: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-00005890: 2020 2020 2020 2020 2020 2020 636f 6e66              conf
-000058a0: 6967 7572 6174 696f 6e5b 2271 7565 7279  iguration["query
-000058b0: 225d 5b22 7573 6551 7565 7279 4361 6368  "]["useQueryCach
-000058c0: 6522 5d20 3d20 280a 2020 2020 2020 2020  e"] = (.        
-000058d0: 2020 2020 2020 2020 5472 7565 2069 6620          True if 
-000058e0: 7573 655f 6361 6368 6520 6973 204e 6f6e  use_cache is Non
-000058f0: 6520 656c 7365 2075 7365 5f63 6163 6865  e else use_cache
-00005900: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
-00005910: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-00005920: 7461 6e63 6528 696e 6465 785f 636f 6c2c  tance(index_col,
-00005930: 2062 6967 6672 616d 6573 2e65 6e75 6d73   bigframes.enums
-00005940: 2e44 6566 6175 6c74 496e 6465 784b 696e  .DefaultIndexKin
-00005950: 6429 3a0a 2020 2020 2020 2020 2020 2020  d):.            
-00005960: 696e 6465 785f 636f 6c73 203d 205b 5d0a  index_cols = [].
-00005970: 2020 2020 2020 2020 656c 6966 2069 7369          elif isi
-00005980: 6e73 7461 6e63 6528 696e 6465 785f 636f  nstance(index_co
-00005990: 6c2c 2073 7472 293a 0a20 2020 2020 2020  l, str):.       
-000059a0: 2020 2020 2069 6e64 6578 5f63 6f6c 7320       index_cols 
-000059b0: 3d20 5b69 6e64 6578 5f63 6f6c 5d0a 2020  = [index_col].  
-000059c0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-000059d0: 2020 2020 2020 2020 696e 6465 785f 636f          index_co
-000059e0: 6c73 203d 206c 6973 7428 696e 6465 785f  ls = list(index_
-000059f0: 636f 6c29 0a0a 2020 2020 2020 2020 6465  col)..        de
-00005a00: 7374 696e 6174 696f 6e2c 2071 7565 7279  stination, query
-00005a10: 5f6a 6f62 203d 2073 656c 662e 5f71 7565  _job = self._que
-00005a20: 7279 5f74 6f5f 6465 7374 696e 6174 696f  ry_to_destinatio
-00005a30: 6e28 0a20 2020 2020 2020 2020 2020 2071  n(.            q
-00005a40: 7565 7279 2c0a 2020 2020 2020 2020 2020  uery,.          
-00005a50: 2020 696e 6465 785f 636f 6c73 2c0a 2020    index_cols,.  
-00005a60: 2020 2020 2020 2020 2020 6170 695f 6e61            api_na
-00005a70: 6d65 3d61 7069 5f6e 616d 652c 0a20 2020  me=api_name,.   
-00005a80: 2020 2020 2020 2020 2063 6f6e 6669 6775           configu
-00005a90: 7261 7469 6f6e 3d63 6f6e 6669 6775 7261  ration=configura
-00005aa0: 7469 6f6e 2c0a 2020 2020 2020 2020 290a  tion,.        ).
-00005ab0: 0a20 2020 2020 2020 2023 2049 6620 7468  .        # If th
-00005ac0: 6572 6520 7761 7320 6e6f 2064 6573 7469  ere was no desti
-00005ad0: 6e61 7469 6f6e 2074 6162 6c65 2c20 7468  nation table, th
-00005ae0: 6174 206d 6561 6e73 2074 6865 2071 7565  at means the que
-00005af0: 7279 206d 7573 7420 6861 7665 0a20 2020  ry must have.   
-00005b00: 2020 2020 2023 2062 6565 6e20 4444 4c20       # been DDL 
-00005b10: 6f72 2044 4d4c 2e20 5265 7475 726e 2073  or DML. Return s
-00005b20: 6f6d 6520 6a6f 6220 6d65 7461 6461 7461  ome job metadata
-00005b30: 2c20 696e 7374 6561 642e 0a20 2020 2020  , instead..     
-00005b40: 2020 2069 6620 6e6f 7420 6465 7374 696e     if not destin
-00005b50: 6174 696f 6e3a 0a20 2020 2020 2020 2020  ation:.         
-00005b60: 2020 2072 6574 7572 6e20 6461 7461 6672     return datafr
-00005b70: 616d 652e 4461 7461 4672 616d 6528 0a20  ame.DataFrame(. 
-00005b80: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00005b90: 6174 613d 7061 6e64 6173 2e44 6174 6146  ata=pandas.DataF
-00005ba0: 7261 6d65 280a 2020 2020 2020 2020 2020  rame(.          
-00005bb0: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
-00005bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005bd0: 2020 2020 2273 7461 7465 6d65 6e74 5f74      "statement_t
-00005be0: 7970 6522 3a20 5b0a 2020 2020 2020 2020  ype": [.        
-00005bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005c00: 2020 2020 7175 6572 795f 6a6f 622e 7374      query_job.st
-00005c10: 6174 656d 656e 745f 7479 7065 2069 6620  atement_type if 
-00005c20: 7175 6572 795f 6a6f 6220 656c 7365 2022  query_job else "
-00005c30: 756e 6b6e 6f77 6e22 0a20 2020 2020 2020  unknown".       
-00005c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005c50: 205d 2c0a 2020 2020 2020 2020 2020 2020   ],.            
-00005c60: 2020 2020 2020 2020 2020 2020 226a 6f62              "job
-00005c70: 5f69 6422 3a20 5b71 7565 7279 5f6a 6f62  _id": [query_job
-00005c80: 2e6a 6f62 5f69 6420 6966 2071 7565 7279  .job_id if query
-00005c90: 5f6a 6f62 2065 6c73 6520 2275 6e6b 6e6f  _job else "unkno
-00005ca0: 776e 225d 2c0a 2020 2020 2020 2020 2020  wn"],.          
-00005cb0: 2020 2020 2020 2020 2020 2020 2020 226c                "l
-00005cc0: 6f63 6174 696f 6e22 3a20 5b71 7565 7279  ocation": [query
-00005cd0: 5f6a 6f62 2e6c 6f63 6174 696f 6e20 6966  _job.location if
-00005ce0: 2071 7565 7279 5f6a 6f62 2065 6c73 6520   query_job else 
-00005cf0: 2275 6e6b 6e6f 776e 225d 2c0a 2020 2020  "unknown"],.    
-00005d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005d10: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
-00005d20: 2020 292c 0a20 2020 2020 2020 2020 2020    ),.           
-00005d30: 2020 2020 2073 6573 7369 6f6e 3d73 656c       session=sel
-00005d40: 662c 0a20 2020 2020 2020 2020 2020 2029  f,.            )
-00005d50: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00005d60: 2073 656c 662e 7265 6164 5f67 6271 5f74   self.read_gbq_t
-00005d70: 6162 6c65 280a 2020 2020 2020 2020 2020  able(.          
-00005d80: 2020 6622 7b64 6573 7469 6e61 7469 6f6e    f"{destination
-00005d90: 2e70 726f 6a65 6374 7d2e 7b64 6573 7469  .project}.{desti
-00005da0: 6e61 7469 6f6e 2e64 6174 6173 6574 5f69  nation.dataset_i
-00005db0: 647d 2e7b 6465 7374 696e 6174 696f 6e2e  d}.{destination.
-00005dc0: 7461 626c 655f 6964 7d22 2c0a 2020 2020  table_id}",.    
-00005dd0: 2020 2020 2020 2020 696e 6465 785f 636f          index_co
-00005de0: 6c3d 696e 6465 785f 636f 6c2c 0a20 2020  l=index_col,.   
-00005df0: 2020 2020 2020 2020 2063 6f6c 756d 6e73           columns
-00005e00: 3d63 6f6c 756d 6e73 2c0a 2020 2020 2020  =columns,.      
-00005e10: 2020 2020 2020 6d61 785f 7265 7375 6c74        max_result
-00005e20: 733d 6d61 785f 7265 7375 6c74 732c 0a20  s=max_results,. 
-00005e30: 2020 2020 2020 2020 2020 2075 7365 5f63             use_c
-00005e40: 6163 6865 3d63 6f6e 6669 6775 7261 7469  ache=configurati
-00005e50: 6f6e 5b22 7175 6572 7922 5d5b 2275 7365  on["query"]["use
-00005e60: 5175 6572 7943 6163 6865 225d 2c0a 2020  QueryCache"],.  
-00005e70: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-00005e80: 2072 6561 645f 6762 715f 7461 626c 6528   read_gbq_table(
-00005e90: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-00005ea0: 2020 2020 2020 2071 7565 7279 3a20 7374         query: st
-00005eb0: 722c 0a20 2020 2020 2020 202a 2c0a 2020  r,.        *,.  
-00005ec0: 2020 2020 2020 696e 6465 785f 636f 6c3a        index_col:
-00005ed0: 2049 7465 7261 626c 655b 7374 725d 207c   Iterable[str] |
-00005ee0: 2073 7472 207c 2062 6967 6672 616d 6573   str | bigframes
-00005ef0: 2e65 6e75 6d73 2e44 6566 6175 6c74 496e  .enums.DefaultIn
-00005f00: 6465 784b 696e 6420 3d20 2829 2c0a 2020  dexKind = (),.  
-00005f10: 2020 2020 2020 636f 6c75 6d6e 733a 2049        columns: I
-00005f20: 7465 7261 626c 655b 7374 725d 203d 2028  terable[str] = (
-00005f30: 292c 0a20 2020 2020 2020 206d 6178 5f72  ),.        max_r
-00005f40: 6573 756c 7473 3a20 4f70 7469 6f6e 616c  esults: Optional
-00005f50: 5b69 6e74 5d20 3d20 4e6f 6e65 2c0a 2020  [int] = None,.  
-00005f60: 2020 2020 2020 6669 6c74 6572 733a 2074        filters: t
-00005f70: 6869 7264 5f70 6172 7479 5f70 616e 6461  hird_party_panda
-00005f80: 735f 6762 712e 4669 6c74 6572 7354 7970  s_gbq.FiltersTyp
-00005f90: 6520 3d20 2829 2c0a 2020 2020 2020 2020  e = (),.        
-00005fa0: 7573 655f 6361 6368 653a 2062 6f6f 6c20  use_cache: bool 
-00005fb0: 3d20 5472 7565 2c0a 2020 2020 2020 2020  = True,.        
-00005fc0: 636f 6c5f 6f72 6465 723a 2049 7465 7261  col_order: Itera
-00005fd0: 626c 655b 7374 725d 203d 2028 292c 0a20  ble[str] = (),. 
-00005fe0: 2020 2029 202d 3e20 6461 7461 6672 616d     ) -> datafram
-00005ff0: 652e 4461 7461 4672 616d 653a 0a20 2020  e.DataFrame:.   
-00006000: 2020 2020 2022 2222 5475 726e 2061 2042       """Turn a B
-00006010: 6967 5175 6572 7920 7461 626c 6520 696e  igQuery table in
-00006020: 746f 2061 2044 6174 6146 7261 6d65 2e0a  to a DataFrame..
-00006030: 0a20 2020 2020 2020 202a 2a45 7861 6d70  .        **Examp
-00006040: 6c65 733a 2a2a 0a0a 2020 2020 2020 2020  les:**..        
-00006050: 2020 2020 3e3e 3e20 696d 706f 7274 2062      >>> import b
-00006060: 6967 6672 616d 6573 2e70 616e 6461 7320  igframes.pandas 
-00006070: 6173 2062 7064 0a20 2020 2020 2020 2020  as bpd.         
-00006080: 2020 203e 3e3e 2062 7064 2e6f 7074 696f     >>> bpd.optio
-00006090: 6e73 2e64 6973 706c 6179 2e70 726f 6772  ns.display.progr
-000060a0: 6573 735f 6261 7220 3d20 4e6f 6e65 0a0a  ess_bar = None..
-000060b0: 2020 2020 2020 2020 5265 6164 2061 2077          Read a w
-000060c0: 686f 6c65 2074 6162 6c65 2c20 7769 7468  hole table, with
-000060d0: 2061 7262 6974 7261 7279 206f 7264 6572   arbitrary order
-000060e0: 696e 6720 6f72 206f 7264 6572 696e 6720  ing or ordering 
-000060f0: 636f 7272 6573 706f 6e64 696e 6720 746f  corresponding to
-00006100: 2074 6865 2070 7269 6d61 7279 206b 6579   the primary key
-00006110: 2873 292e 0a0a 2020 2020 2020 2020 2020  (s)...          
-00006120: 2020 3e3e 3e20 6466 203d 2062 7064 2e72    >>> df = bpd.r
-00006130: 6561 645f 6762 715f 7461 626c 6528 2262  ead_gbq_table("b
-00006140: 6967 7175 6572 792d 7075 626c 6963 2d64  igquery-public-d
-00006150: 6174 612e 6d6c 5f64 6174 6173 6574 732e  ata.ml_datasets.
-00006160: 7065 6e67 7569 6e73 2229 0a0a 2020 2020  penguins")..    
-00006170: 2020 2020 5365 6520 616c 736f 3a20 3a6d      See also: :m
-00006180: 6574 683a 6053 6573 7369 6f6e 2e72 6561  eth:`Session.rea
-00006190: 645f 6762 7160 2e0a 2020 2020 2020 2020  d_gbq`..        
-000061a0: 2222 220a 2020 2020 2020 2020 2320 4e4f  """.        # NO
-000061b0: 5445 3a20 5468 6973 206d 6574 686f 6420  TE: This method 
-000061c0: 646f 6573 6e27 7420 2879 6574 2920 6578  doesn't (yet) ex
-000061d0: 6973 7420 696e 2070 616e 6461 7320 6f72  ist in pandas or
-000061e0: 2070 616e 6461 732d 6762 712c 2073 6f0a   pandas-gbq, so.
-000061f0: 2020 2020 2020 2020 2320 7468 6573 6520          # these 
-00006200: 646f 6373 7472 696e 6773 2061 7265 2069  docstrings are i
-00006210: 6e6c 696e 652e 0a20 2020 2020 2020 2069  nline..        i
-00006220: 6620 636f 6c75 6d6e 7320 616e 6420 636f  f columns and co
-00006230: 6c5f 6f72 6465 723a 0a20 2020 2020 2020  l_order:.       
-00006240: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00006250: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-00006260: 2020 2020 2020 2022 4d75 7374 2073 7065         "Must spe
-00006270: 6369 6679 2065 6974 6865 7220 636f 6c75  cify either colu
-00006280: 6d6e 7320 2870 7265 6665 7272 6564 2920  mns (preferred) 
-00006290: 6f72 2063 6f6c 5f6f 7264 6572 2c20 6e6f  or col_order, no
-000062a0: 7420 626f 7468 220a 2020 2020 2020 2020  t both".        
-000062b0: 2020 2020 290a 2020 2020 2020 2020 656c      ).        el
-000062c0: 6966 2063 6f6c 5f6f 7264 6572 3a0a 2020  if col_order:.  
-000062d0: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
-000062e0: 7320 3d20 636f 6c5f 6f72 6465 720a 0a20  s = col_order.. 
-000062f0: 2020 2020 2020 2066 696c 7465 7273 203d         filters =
-00006300: 206c 6973 7428 6669 6c74 6572 7329 0a20   list(filters). 
-00006310: 2020 2020 2020 2069 6620 6c65 6e28 6669         if len(fi
-00006320: 6c74 6572 7329 2021 3d20 3020 6f72 205f  lters) != 0 or _
-00006330: 6973 5f74 6162 6c65 5f77 6974 685f 7769  is_table_with_wi
-00006340: 6c64 6361 7264 5f73 7566 6669 7828 7175  ldcard_suffix(qu
-00006350: 6572 7929 3a0a 2020 2020 2020 2020 2020  ery):.          
-00006360: 2020 7175 6572 7920 3d20 7365 6c66 2e5f    query = self._
-00006370: 746f 5f71 7565 7279 2871 7565 7279 2c20  to_query(query, 
-00006380: 636f 6c75 6d6e 732c 2066 696c 7465 7273  columns, filters
-00006390: 290a 0a20 2020 2020 2020 2020 2020 2072  )..            r
-000063a0: 6574 7572 6e20 7365 6c66 2e5f 7265 6164  eturn self._read
-000063b0: 5f67 6271 5f71 7565 7279 280a 2020 2020  _gbq_query(.    
-000063c0: 2020 2020 2020 2020 2020 2020 7175 6572              quer
-000063d0: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
-000063e0: 2020 2069 6e64 6578 5f63 6f6c 3d69 6e64     index_col=ind
-000063f0: 6578 5f63 6f6c 2c0a 2020 2020 2020 2020  ex_col,.        
-00006400: 2020 2020 2020 2020 636f 6c75 6d6e 733d          columns=
-00006410: 636f 6c75 6d6e 732c 0a20 2020 2020 2020  columns,.       
-00006420: 2020 2020 2020 2020 206d 6178 5f72 6573           max_res
-00006430: 756c 7473 3d6d 6178 5f72 6573 756c 7473  ults=max_results
-00006440: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00006450: 2020 6170 695f 6e61 6d65 3d22 7265 6164    api_name="read
-00006460: 5f67 6271 5f74 6162 6c65 222c 0a20 2020  _gbq_table",.   
-00006470: 2020 2020 2020 2020 2020 2020 2075 7365               use
-00006480: 5f63 6163 6865 3d75 7365 5f63 6163 6865  _cache=use_cache
-00006490: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-000064a0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000064b0: 7365 6c66 2e5f 7265 6164 5f67 6271 5f74  self._read_gbq_t
-000064c0: 6162 6c65 280a 2020 2020 2020 2020 2020  able(.          
-000064d0: 2020 7175 6572 793d 7175 6572 792c 0a20    query=query,. 
-000064e0: 2020 2020 2020 2020 2020 2069 6e64 6578             index
-000064f0: 5f63 6f6c 3d69 6e64 6578 5f63 6f6c 2c0a  _col=index_col,.
-00006500: 2020 2020 2020 2020 2020 2020 636f 6c75              colu
-00006510: 6d6e 733d 636f 6c75 6d6e 732c 0a20 2020  mns=columns,.   
-00006520: 2020 2020 2020 2020 206d 6178 5f72 6573           max_res
-00006530: 756c 7473 3d6d 6178 5f72 6573 756c 7473  ults=max_results
-00006540: 2c0a 2020 2020 2020 2020 2020 2020 6170  ,.            ap
-00006550: 695f 6e61 6d65 3d22 7265 6164 5f67 6271  i_name="read_gbq
-00006560: 5f74 6162 6c65 222c 0a20 2020 2020 2020  _table",.       
-00006570: 2020 2020 2075 7365 5f63 6163 6865 3d75       use_cache=u
-00006580: 7365 5f63 6163 6865 2c0a 2020 2020 2020  se_cache,.      
-00006590: 2020 290a 0a20 2020 2064 6566 205f 7265    )..    def _re
-000065a0: 6164 5f67 6271 5f74 6162 6c65 280a 2020  ad_gbq_table(.  
-000065b0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-000065c0: 2020 2020 7175 6572 793a 2073 7472 2c0a      query: str,.
-000065d0: 2020 2020 2020 2020 2a2c 0a20 2020 2020          *,.     
-000065e0: 2020 2069 6e64 6578 5f63 6f6c 3a20 4974     index_col: It
-000065f0: 6572 6162 6c65 5b73 7472 5d20 7c20 7374  erable[str] | st
-00006600: 7220 7c20 6269 6766 7261 6d65 732e 656e  r | bigframes.en
-00006610: 756d 732e 4465 6661 756c 7449 6e64 6578  ums.DefaultIndex
-00006620: 4b69 6e64 203d 2028 292c 0a20 2020 2020  Kind = (),.     
-00006630: 2020 2063 6f6c 756d 6e73 3a20 4974 6572     columns: Iter
-00006640: 6162 6c65 5b73 7472 5d20 3d20 2829 2c0a  able[str] = (),.
-00006650: 2020 2020 2020 2020 6d61 785f 7265 7375          max_resu
-00006660: 6c74 733a 204f 7074 696f 6e61 6c5b 696e  lts: Optional[in
-00006670: 745d 203d 204e 6f6e 652c 0a20 2020 2020  t] = None,.     
-00006680: 2020 2061 7069 5f6e 616d 653a 2073 7472     api_name: str
-00006690: 2c0a 2020 2020 2020 2020 7573 655f 6361  ,.        use_ca
-000066a0: 6368 653a 2062 6f6f 6c20 3d20 5472 7565  che: bool = True
-000066b0: 2c0a 2020 2020 2920 2d3e 2064 6174 6166  ,.    ) -> dataf
-000066c0: 7261 6d65 2e44 6174 6146 7261 6d65 3a0a  rame.DataFrame:.
-000066d0: 2020 2020 2020 2020 696d 706f 7274 2062          import b
-000066e0: 6967 6672 616d 6573 2e64 6174 6166 7261  igframes.datafra
-000066f0: 6d65 2061 7320 6461 7461 6672 616d 650a  me as dataframe.
-00006700: 0a20 2020 2020 2020 2023 202d 2d2d 2d2d  .        # -----
-00006710: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00006720: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020  ------------.   
-00006730: 2020 2020 2023 2056 616c 6964 6174 6520       # Validate 
-00006740: 616e 6420 7472 616e 7366 6f72 6d20 7061  and transform pa
-00006750: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
-00006760: 2023 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   # -------------
-00006770: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00006780: 2d2d 2d2d 0a0a 2020 2020 2020 2020 6966  ----..        if
-00006790: 206d 6178 5f72 6573 756c 7473 2061 6e64   max_results and
-000067a0: 206d 6178 5f72 6573 756c 7473 203c 3d20   max_results <= 
-000067b0: 303a 0a20 2020 2020 2020 2020 2020 2072  0:.            r
-000067c0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-000067d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000067e0: 2066 2260 6d61 785f 7265 7375 6c74 7360   f"`max_results`
-000067f0: 2073 686f 756c 6420 6265 2061 2070 6f73   should be a pos
-00006800: 6974 6976 6520 6e75 6d62 6572 2c20 676f  itive number, go
-00006810: 7420 7b6d 6178 5f72 6573 756c 7473 7d2e  t {max_results}.
-00006820: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
-00006830: 0a20 2020 2020 2020 2074 6162 6c65 5f72  .        table_r
-00006840: 6566 203d 2062 6967 7175 6572 792e 7461  ef = bigquery.ta
-00006850: 626c 652e 5461 626c 6552 6566 6572 656e  ble.TableReferen
-00006860: 6365 2e66 726f 6d5f 7374 7269 6e67 280a  ce.from_string(.
-00006870: 2020 2020 2020 2020 2020 2020 7175 6572              quer
-00006880: 792c 2064 6566 6175 6c74 5f70 726f 6a65  y, default_proje
-00006890: 6374 3d73 656c 662e 6271 636c 6965 6e74  ct=self.bqclient
-000068a0: 2e70 726f 6a65 6374 0a20 2020 2020 2020  .project.       
-000068b0: 2029 0a0a 2020 2020 2020 2020 2320 2d2d   )..        # --
-000068c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000068d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
-000068e0: 2020 2020 2020 2020 2320 4665 7463 6820          # Fetch 
-000068f0: 7461 626c 6520 6d65 7461 6461 7461 2061  table metadata a
-00006900: 6e64 2076 616c 6964 6174 650a 2020 2020  nd validate.    
-00006910: 2020 2020 2320 2d2d 2d2d 2d2d 2d2d 2d2d      # ----------
-00006920: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00006930: 2d2d 2d2d 2d2d 2d0a 0a20 2020 2020 2020  -------..       
-00006940: 2028 7469 6d65 5f74 7261 7665 6c5f 7469   (time_travel_ti
-00006950: 6d65 7374 616d 702c 2074 6162 6c65 2c29  mestamp, table,)
-00006960: 203d 2062 665f 7265 6164 5f67 6271 5f74   = bf_read_gbq_t
-00006970: 6162 6c65 2e67 6574 5f74 6162 6c65 5f6d  able.get_table_m
-00006980: 6574 6164 6174 6128 0a20 2020 2020 2020  etadata(.       
-00006990: 2020 2020 2073 656c 662e 6271 636c 6965       self.bqclie
-000069a0: 6e74 2c0a 2020 2020 2020 2020 2020 2020  nt,.            
-000069b0: 7461 626c 655f 7265 663d 7461 626c 655f  table_ref=table_
-000069c0: 7265 662c 0a20 2020 2020 2020 2020 2020  ref,.           
-000069d0: 2061 7069 5f6e 616d 653d 6170 695f 6e61   api_name=api_na
-000069e0: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
-000069f0: 6361 6368 653d 7365 6c66 2e5f 6466 5f73  cache=self._df_s
-00006a00: 6e61 7073 686f 742c 0a20 2020 2020 2020  napshot,.       
-00006a10: 2020 2020 2075 7365 5f63 6163 6865 3d75       use_cache=u
-00006a20: 7365 5f63 6163 6865 2c0a 2020 2020 2020  se_cache,.      
-00006a30: 2020 290a 0a20 2020 2020 2020 2069 6620    )..        if 
-00006a40: 7461 626c 652e 6c6f 6361 7469 6f6e 2e63  table.location.c
-00006a50: 6173 6566 6f6c 6428 2920 213d 2073 656c  asefold() != sel
-00006a60: 662e 5f6c 6f63 6174 696f 6e2e 6361 7365  f._location.case
-00006a70: 666f 6c64 2829 3a0a 2020 2020 2020 2020  fold():.        
-00006a80: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00006a90: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-00006aa0: 2020 2020 2020 6622 4375 7272 656e 7420        f"Current 
-00006ab0: 7365 7373 696f 6e20 6973 2069 6e20 7b73  session is in {s
-00006ac0: 656c 662e 5f6c 6f63 6174 696f 6e7d 2062  elf._location} b
-00006ad0: 7574 2064 6174 6173 6574 2027 7b74 6162  ut dataset '{tab
-00006ae0: 6c65 2e70 726f 6a65 6374 7d2e 7b74 6162  le.project}.{tab
-00006af0: 6c65 2e64 6174 6173 6574 5f69 647d 2720  le.dataset_id}' 
-00006b00: 6973 206c 6f63 6174 6564 2069 6e20 7b74  is located in {t
-00006b10: 6162 6c65 2e6c 6f63 6174 696f 6e7d 220a  able.location}".
-00006b20: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00006b30: 2020 2020 2020 2023 202d 2d2d 2d2d 2d2d         # -------
-00006b40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00006b50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00006b60: 2d2d 0a20 2020 2020 2020 2023 2043 7265  --.        # Cre
-00006b70: 6174 6520 4962 6973 2074 6162 6c65 2065  ate Ibis table e
-00006b80: 7870 7265 7373 696f 6e20 616e 6420 7661  xpression and va
-00006b90: 6c69 6461 7465 0a20 2020 2020 2020 2023  lidate.        #
-00006ba0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-00006bb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00006bc0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a0a 2020 2020  ----------..    
-00006bd0: 2020 2020 2320 5573 6520 6120 7469 6d65      # Use a time
-00006be0: 2074 7261 7665 6c20 746f 206d 616b 6520   travel to make 
-00006bf0: 7375 7265 2074 6865 2044 6174 6146 7261  sure the DataFra
-00006c00: 6d65 2069 7320 6465 7465 726d 696e 6973  me is determinis
-00006c10: 7469 632c 2065 7665 6e0a 2020 2020 2020  tic, even.      
-00006c20: 2020 2320 6966 2074 6865 2075 6e64 6572    # if the under
-00006c30: 6c79 696e 6720 7461 626c 6520 6368 616e  lying table chan
-00006c40: 6765 732e 0a20 2020 2020 2020 2074 6162  ges..        tab
-00006c50: 6c65 5f65 7870 7265 7373 696f 6e20 3d20  le_expression = 
-00006c60: 6266 5f72 6561 645f 6762 715f 7461 626c  bf_read_gbq_tabl
-00006c70: 652e 6765 745f 6962 6973 5f74 696d 655f  e.get_ibis_time_
-00006c80: 7472 6176 656c 5f74 6162 6c65 280a 2020  travel_table(.  
-00006c90: 2020 2020 2020 2020 2020 7365 6c66 2e69            self.i
-00006ca0: 6269 735f 636c 6965 6e74 2c0a 2020 2020  bis_client,.    
-00006cb0: 2020 2020 2020 2020 7461 626c 655f 7265          table_re
-00006cc0: 662c 0a20 2020 2020 2020 2020 2020 2074  f,.            t
-00006cd0: 696d 655f 7472 6176 656c 5f74 696d 6573  ime_travel_times
-00006ce0: 7461 6d70 2c0a 2020 2020 2020 2020 290a  tamp,.        ).
-00006cf0: 0a20 2020 2020 2020 2066 6f72 206b 6579  .        for key
-00006d00: 2069 6e20 636f 6c75 6d6e 733a 0a20 2020   in columns:.   
-00006d10: 2020 2020 2020 2020 2069 6620 6b65 7920           if key 
-00006d20: 6e6f 7420 696e 2074 6162 6c65 5f65 7870  not in table_exp
-00006d30: 7265 7373 696f 6e2e 636f 6c75 6d6e 733a  ression.columns:
-00006d40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006d50: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-00006d60: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-00006d70: 2020 2020 2020 2066 2243 6f6c 756d 6e20         f"Column 
-00006d80: 277b 6b65 797d 2720 6f66 2060 636f 6c75  '{key}' of `colu
-00006d90: 6d6e 7360 206e 6f74 2066 6f75 6e64 2069  mns` not found i
-00006da0: 6e20 7468 6973 2074 6162 6c65 2e22 0a20  n this table.". 
-00006db0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00006dc0: 0a0a 2020 2020 2020 2020 2320 2d2d 2d2d  ..        # ----
-00006dd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00006de0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00006df0: 2d2d 2d0a 2020 2020 2020 2020 2320 4372  ---.        # Cr
-00006e00: 6561 7465 2061 206e 6f6e 2d64 6566 6175  eate a non-defau
-00006e10: 6c74 2069 6e64 6578 2061 6e64 2076 616c  lt index and val
-00006e20: 6964 6174 650a 2020 2020 2020 2020 2320  idate.        # 
-00006e30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00006e40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00006e50: 2d2d 2d2d 2d2d 2d0a 0a20 2020 2020 2020  -------..       
-00006e60: 2023 2054 4f44 4f28 622f 3333 3739 3235   # TODO(b/337925
-00006e70: 3134 3229 3a20 4d6f 7665 2069 6e64 6578  142): Move index
-00006e80: 5f63 6f6c 7320 6372 6561 7469 6f6e 2074  _cols creation t
-00006e90: 6f20 6265 666f 7265 2077 6520 6372 6561  o before we crea
-00006ea0: 7465 2074 6865 0a20 2020 2020 2020 2023  te the.        #
-00006eb0: 2049 6269 7320 7461 626c 6520 6578 7072   Ibis table expr
-00006ec0: 6573 7369 6f6e 2073 6f20 7765 2064 6f6e  ession so we don
-00006ed0: 2774 2068 6176 6520 6120 2253 454c 4543  't have a "SELEC
-00006ee0: 5420 2a22 2073 7562 7175 6572 7920 696e  T *" subquery in
-00006ef0: 2074 6865 0a20 2020 2020 2020 2023 2071   the.        # q
-00006f00: 7565 7279 2074 6861 7420 6368 6563 6b73  uery that checks
-00006f10: 2066 6f72 2069 6e64 6578 2075 6e69 7175   for index uniqu
-00006f20: 656e 6573 732e 0a0a 2020 2020 2020 2020  eness...        
-00006f30: 696e 6465 785f 636f 6c73 2c20 6973 5f69  index_cols, is_i
-00006f40: 6e64 6578 5f75 6e69 7175 6520 3d20 6266  ndex_unique = bf
-00006f50: 5f72 6561 645f 6762 715f 7461 626c 652e  _read_gbq_table.
-00006f60: 6765 745f 696e 6465 785f 636f 6c73 5f61  get_index_cols_a
-00006f70: 6e64 5f75 6e69 7175 656e 6573 7328 0a20  nd_uniqueness(. 
-00006f80: 2020 2020 2020 2020 2020 2062 7163 6c69             bqcli
-00006f90: 656e 743d 7365 6c66 2e62 7163 6c69 656e  ent=self.bqclien
-00006fa0: 742c 0a20 2020 2020 2020 2020 2020 2069  t,.            i
-00006fb0: 6269 735f 636c 6965 6e74 3d73 656c 662e  bis_client=self.
-00006fc0: 6962 6973 5f63 6c69 656e 742c 0a20 2020  ibis_client,.   
-00006fd0: 2020 2020 2020 2020 2074 6162 6c65 3d74           table=t
-00006fe0: 6162 6c65 2c0a 2020 2020 2020 2020 2020  able,.          
-00006ff0: 2020 7461 626c 655f 6578 7072 6573 7369    table_expressi
-00007000: 6f6e 3d74 6162 6c65 5f65 7870 7265 7373  on=table_express
-00007010: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
-00007020: 2069 6e64 6578 5f63 6f6c 3d69 6e64 6578   index_col=index
-00007030: 5f63 6f6c 2c0a 2020 2020 2020 2020 2020  _col,.          
-00007040: 2020 6170 695f 6e61 6d65 3d61 7069 5f6e    api_name=api_n
-00007050: 616d 652c 0a20 2020 2020 2020 2029 0a0a  ame,.        )..
-00007060: 2020 2020 2020 2020 666f 7220 6b65 7920          for key 
-00007070: 696e 2069 6e64 6578 5f63 6f6c 733a 0a20  in index_cols:. 
-00007080: 2020 2020 2020 2020 2020 2069 6620 6b65             if ke
-00007090: 7920 6e6f 7420 696e 2074 6162 6c65 5f65  y not in table_e
-000070a0: 7870 7265 7373 696f 6e2e 636f 6c75 6d6e  xpression.column
-000070b0: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-000070c0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-000070d0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-000070e0: 2020 2020 2020 2020 2066 2243 6f6c 756d           f"Colum
-000070f0: 6e20 607b 6b65 797d 6020 6f66 2060 696e  n `{key}` of `in
-00007100: 6465 785f 636f 6c60 206e 6f74 2066 6f75  dex_col` not fou
-00007110: 6e64 2069 6e20 7468 6973 2074 6162 6c65  nd in this table
-00007120: 2e22 0a20 2020 2020 2020 2020 2020 2020  .".             
-00007130: 2020 2029 0a0a 2020 2020 2020 2020 2320     )..        # 
-00007140: 544f 444f 2862 2f33 3337 3932 3531 3432  TODO(b/337925142
-00007150: 293a 2057 6520 7368 6f75 6c64 2070 7573  ): We should pus
-00007160: 6820 646f 776e 2063 6f6c 756d 6e20 6669  h down column fi
-00007170: 6c74 6572 7320 7768 656e 2077 6520 6765  lters when we ge
-00007180: 7420 7468 6520 7469 6d65 0a20 2020 2020  t the time.     
-00007190: 2020 2023 2074 7261 7665 6c20 7461 626c     # travel tabl
-000071a0: 6520 746f 2061 766f 6964 2022 5345 4c45  e to avoid "SELE
-000071b0: 4354 202a 2220 7375 6271 7565 7269 6573  CT *" subqueries
-000071c0: 2e0a 2020 2020 2020 2020 6966 2063 6f6c  ..        if col
-000071d0: 756d 6e73 3a0a 2020 2020 2020 2020 2020  umns:.          
-000071e0: 2020 7461 626c 655f 6578 7072 6573 7369    table_expressi
-000071f0: 6f6e 203d 2074 6162 6c65 5f65 7870 7265  on = table_expre
-00007200: 7373 696f 6e2e 7365 6c65 6374 285b 2a69  ssion.select([*i
-00007210: 6e64 6578 5f63 6f6c 732c 202a 636f 6c75  ndex_cols, *colu
-00007220: 6d6e 735d 290a 0a20 2020 2020 2020 2023  mns])..        #
-00007230: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-00007240: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020  -------------.  
-00007250: 2020 2020 2020 2320 4372 6561 7465 206f        # Create o
-00007260: 7264 6572 696e 6720 616e 6420 7661 6c69  rdering and vali
-00007270: 6461 7465 0a20 2020 2020 2020 2023 202d  date.        # -
-00007280: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00007290: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 0a20 2020  -----------..   
-000072a0: 2020 2020 2069 6620 6973 5f69 6e64 6578       if is_index
-000072b0: 5f75 6e69 7175 653a 0a20 2020 2020 2020  _unique:.       
-000072c0: 2020 2020 2061 7272 6179 5f76 616c 7565       array_value
-000072d0: 203d 2062 665f 7265 6164 5f67 6271 5f74   = bf_read_gbq_t
-000072e0: 6162 6c65 2e74 6f5f 6172 7261 795f 7661  able.to_array_va
-000072f0: 6c75 655f 7769 7468 5f74 6f74 616c 5f6f  lue_with_total_o
-00007300: 7264 6572 696e 6728 0a20 2020 2020 2020  rdering(.       
-00007310: 2020 2020 2020 2020 2073 6573 7369 6f6e           session
-00007320: 3d73 656c 662c 0a20 2020 2020 2020 2020  =self,.         
-00007330: 2020 2020 2020 2074 6162 6c65 5f65 7870         table_exp
-00007340: 7265 7373 696f 6e3d 7461 626c 655f 6578  ression=table_ex
-00007350: 7072 6573 7369 6f6e 2c0a 2020 2020 2020  pression,.      
-00007360: 2020 2020 2020 2020 2020 746f 7461 6c5f            total_
-00007370: 6f72 6465 7269 6e67 5f63 6f6c 733d 696e  ordering_cols=in
-00007380: 6465 785f 636f 6c73 2c0a 2020 2020 2020  dex_cols,.      
-00007390: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-000073a0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-000073b0: 2020 2320 4e6f 7465 3a20 4576 656e 2074    # Note: Even t
-000073c0: 686f 7567 6820 7765 2772 6520 6164 6469  hough we're addi
-000073d0: 6e67 2061 2064 6566 6175 6c74 206f 7264  ng a default ord
-000073e0: 6572 696e 6720 6865 7265 2c20 7468 6174  ering here, that
-000073f0: 2773 0a20 2020 2020 2020 2020 2020 2023  's.            #
-00007400: 206a 7573 7420 736f 2077 6520 6861 7665   just so we have
-00007410: 2061 2064 6574 6572 6d69 6e69 7374 6963   a deterministic
-00007420: 2074 6f74 616c 206f 7264 6572 696e 672e   total ordering.
-00007430: 2049 6620 7468 6520 7573 6572 0a20 2020   If the user.   
-00007440: 2020 2020 2020 2020 2023 2073 7065 6369           # speci
-00007450: 6669 6564 2061 206e 6f6e 2d75 6e69 7175  fied a non-uniqu
-00007460: 6520 696e 6465 782c 2077 6520 7374 696c  e index, we stil
-00007470: 6c20 736f 7274 2062 7920 7468 6174 206c  l sort by that l
-00007480: 6174 6572 2e0a 2020 2020 2020 2020 2020  ater..          
-00007490: 2020 6172 7261 795f 7661 6c75 6520 3d20    array_value = 
-000074a0: 6266 5f72 6561 645f 6762 715f 7461 626c  bf_read_gbq_tabl
-000074b0: 652e 746f 5f61 7272 6179 5f76 616c 7565  e.to_array_value
-000074c0: 5f77 6974 685f 6465 6661 756c 745f 6f72  _with_default_or
-000074d0: 6465 7269 6e67 280a 2020 2020 2020 2020  dering(.        
-000074e0: 2020 2020 2020 2020 7365 7373 696f 6e3d          session=
-000074f0: 7365 6c66 2c20 7461 626c 653d 7461 626c  self, table=tabl
-00007500: 655f 6578 7072 6573 7369 6f6e 2c20 7461  e_expression, ta
-00007510: 626c 655f 726f 7773 3d74 6162 6c65 2e6e  ble_rows=table.n
-00007520: 756d 5f72 6f77 730a 2020 2020 2020 2020  um_rows.        
-00007530: 2020 2020 290a 0a20 2020 2020 2020 2023      )..        #
-00007540: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-00007550: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00007560: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00007570: 2d2d 2d2d 2d0a 2020 2020 2020 2020 2320  -----.        # 
-00007580: 4372 6561 7465 2042 6c6f 636b 2026 2064  Create Block & d
-00007590: 6566 6175 6c74 2069 6e64 6578 2069 6620  efault index if 
-000075a0: 6c65 6e28 696e 6465 785f 636f 6c73 2920  len(index_cols) 
-000075b0: 3d3d 2030 0a20 2020 2020 2020 2023 202d  == 0.        # -
-000075c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000075d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000075e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000075f0: 2d2d 2d0a 0a20 2020 2020 2020 2076 616c  ---..        val
-00007600: 7565 5f63 6f6c 756d 6e73 203d 205b 636f  ue_columns = [co
-00007610: 6c20 666f 7220 636f 6c20 696e 2061 7272  l for col in arr
-00007620: 6179 5f76 616c 7565 2e63 6f6c 756d 6e5f  ay_value.column_
-00007630: 6964 7320 6966 2063 6f6c 206e 6f74 2069  ids if col not i
-00007640: 6e20 696e 6465 785f 636f 6c73 5d0a 2020  n index_cols].  
-00007650: 2020 2020 2020 626c 6f63 6b20 3d20 626c        block = bl
-00007660: 6f63 6b73 2e42 6c6f 636b 280a 2020 2020  ocks.Block(.    
-00007670: 2020 2020 2020 2020 6172 7261 795f 7661          array_va
-00007680: 6c75 652c 0a20 2020 2020 2020 2020 2020  lue,.           
-00007690: 2069 6e64 6578 5f63 6f6c 756d 6e73 3d69   index_columns=i
-000076a0: 6e64 6578 5f63 6f6c 732c 0a20 2020 2020  ndex_cols,.     
-000076b0: 2020 2020 2020 2063 6f6c 756d 6e5f 6c61         column_la
-000076c0: 6265 6c73 3d76 616c 7565 5f63 6f6c 756d  bels=value_colum
-000076d0: 6e73 2c0a 2020 2020 2020 2020 2020 2020  ns,.            
-000076e0: 696e 6465 785f 6c61 6265 6c73 3d69 6e64  index_labels=ind
-000076f0: 6578 5f63 6f6c 732c 0a20 2020 2020 2020  ex_cols,.       
-00007700: 2029 0a20 2020 2020 2020 2069 6620 6d61   ).        if ma
-00007710: 785f 7265 7375 6c74 733a 0a20 2020 2020  x_results:.     
-00007720: 2020 2020 2020 2062 6c6f 636b 203d 2062         block = b
-00007730: 6c6f 636b 2e73 6c69 6365 2873 746f 703d  lock.slice(stop=
-00007740: 6d61 785f 7265 7375 6c74 7329 0a20 2020  max_results).   
-00007750: 2020 2020 2064 6620 3d20 6461 7461 6672       df = datafr
-00007760: 616d 652e 4461 7461 4672 616d 6528 626c  ame.DataFrame(bl
-00007770: 6f63 6b29 0a0a 2020 2020 2020 2020 2320  ock)..        # 
-00007780: 4966 2075 7365 7220 7072 6f76 6964 6564  If user provided
-00007790: 2069 6e64 6578 2063 6f6c 756d 6e73 2c20   index columns, 
-000077a0: 7368 6f75 6c64 2073 6f72 7420 6f76 6572  should sort over
-000077b0: 2069 740a 2020 2020 2020 2020 6966 206c   it.        if l
-000077c0: 656e 2869 6e64 6578 5f63 6f6c 7329 203e  en(index_cols) >
-000077d0: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
-000077e0: 6466 2e73 6f72 745f 696e 6465 7828 290a  df.sort_index().
-000077f0: 2020 2020 2020 2020 7265 7475 726e 2064          return d
-00007800: 660a 0a20 2020 2064 6566 205f 7265 6164  f..    def _read
-00007810: 5f62 6967 7175 6572 795f 6c6f 6164 5f6a  _bigquery_load_j
-00007820: 6f62 280a 2020 2020 2020 2020 7365 6c66  ob(.        self
-00007830: 2c0a 2020 2020 2020 2020 6669 6c65 7061  ,.        filepa
-00007840: 7468 5f6f 725f 6275 6666 6572 3a20 7374  th_or_buffer: st
-00007850: 7220 7c20 494f 5b22 6279 7465 7322 5d2c  r | IO["bytes"],
-00007860: 0a20 2020 2020 2020 2074 6162 6c65 3a20  .        table: 
-00007870: 556e 696f 6e5b 6269 6771 7565 7279 2e54  Union[bigquery.T
-00007880: 6162 6c65 2c20 6269 6771 7565 7279 2e54  able, bigquery.T
-00007890: 6162 6c65 5265 6665 7265 6e63 655d 2c0a  ableReference],.
-000078a0: 2020 2020 2020 2020 2a2c 0a20 2020 2020          *,.     
-000078b0: 2020 206a 6f62 5f63 6f6e 6669 673a 2062     job_config: b
-000078c0: 6967 7175 6572 792e 4c6f 6164 4a6f 6243  igquery.LoadJobC
-000078d0: 6f6e 6669 672c 0a20 2020 2020 2020 2069  onfig,.        i
-000078e0: 6e64 6578 5f63 6f6c 3a20 4974 6572 6162  ndex_col: Iterab
-000078f0: 6c65 5b73 7472 5d20 7c20 7374 7220 7c20  le[str] | str | 
-00007900: 6269 6766 7261 6d65 732e 656e 756d 732e  bigframes.enums.
-00007910: 4465 6661 756c 7449 6e64 6578 4b69 6e64  DefaultIndexKind
-00007920: 203d 2028 292c 0a20 2020 2020 2020 2063   = (),.        c
-00007930: 6f6c 756d 6e73 3a20 4974 6572 6162 6c65  olumns: Iterable
-00007940: 5b73 7472 5d20 3d20 2829 2c0a 2020 2020  [str] = (),.    
-00007950: 2920 2d3e 2064 6174 6166 7261 6d65 2e44  ) -> dataframe.D
-00007960: 6174 6146 7261 6d65 3a0a 2020 2020 2020  ataFrame:.      
-00007970: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00007980: 696e 6465 785f 636f 6c2c 2062 6967 6672  index_col, bigfr
-00007990: 616d 6573 2e65 6e75 6d73 2e44 6566 6175  ames.enums.Defau
-000079a0: 6c74 496e 6465 784b 696e 6429 3a0a 2020  ltIndexKind):.  
-000079b0: 2020 2020 2020 2020 2020 696e 6465 785f            index_
-000079c0: 636f 6c73 203d 205b 5d0a 2020 2020 2020  cols = [].      
-000079d0: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
-000079e0: 6528 696e 6465 785f 636f 6c2c 2073 7472  e(index_col, str
-000079f0: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
-00007a00: 6e64 6578 5f63 6f6c 7320 3d20 5b69 6e64  ndex_cols = [ind
-00007a10: 6578 5f63 6f6c 5d0a 2020 2020 2020 2020  ex_col].        
-00007a20: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00007a30: 2020 696e 6465 785f 636f 6c73 203d 206c    index_cols = l
-00007a40: 6973 7428 696e 6465 785f 636f 6c29 0a0a  ist(index_col)..
-00007a50: 2020 2020 2020 2020 6966 206e 6f74 206a          if not j
-00007a60: 6f62 5f63 6f6e 6669 672e 636c 7573 7465  ob_config.cluste
-00007a70: 7269 6e67 5f66 6965 6c64 7320 616e 6420  ring_fields and 
-00007a80: 696e 6465 785f 636f 6c73 3a0a 2020 2020  index_cols:.    
-00007a90: 2020 2020 2020 2020 6a6f 625f 636f 6e66          job_conf
-00007aa0: 6967 2e63 6c75 7374 6572 696e 675f 6669  ig.clustering_fi
-00007ab0: 656c 6473 203d 2069 6e64 6578 5f63 6f6c  elds = index_col
-00007ac0: 735b 3a5f 4d41 585f 434c 5553 5445 525f  s[:_MAX_CLUSTER_
-00007ad0: 434f 4c55 4d4e 535d 0a0a 2020 2020 2020  COLUMNS]..      
-00007ae0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00007af0: 6669 6c65 7061 7468 5f6f 725f 6275 6666  filepath_or_buff
-00007b00: 6572 2c20 7374 7229 3a0a 2020 2020 2020  er, str):.      
-00007b10: 2020 2020 2020 6966 2066 696c 6570 6174        if filepat
-00007b20: 685f 6f72 5f62 7566 6665 722e 7374 6172  h_or_buffer.star
-00007b30: 7473 7769 7468 2822 6773 3a2f 2f22 293a  tswith("gs://"):
-00007b40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007b50: 206c 6f61 645f 6a6f 6220 3d20 7365 6c66   load_job = self
-00007b60: 2e62 7163 6c69 656e 742e 6c6f 6164 5f74  .bqclient.load_t
-00007b70: 6162 6c65 5f66 726f 6d5f 7572 6928 0a20  able_from_uri(. 
-00007b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007b90: 2020 2066 696c 6570 6174 685f 6f72 5f62     filepath_or_b
-00007ba0: 7566 6665 722c 2074 6162 6c65 2c20 6a6f  uffer, table, jo
-00007bb0: 625f 636f 6e66 6967 3d6a 6f62 5f63 6f6e  b_config=job_con
-00007bc0: 6669 670a 2020 2020 2020 2020 2020 2020  fig.            
-00007bd0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00007be0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00007bf0: 2020 2020 2020 2020 7769 7468 206f 7065          with ope
-00007c00: 6e28 6669 6c65 7061 7468 5f6f 725f 6275  n(filepath_or_bu
-00007c10: 6666 6572 2c20 2272 6222 2920 6173 2073  ffer, "rb") as s
-00007c20: 6f75 7263 655f 6669 6c65 3a0a 2020 2020  ource_file:.    
-00007c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007c40: 6c6f 6164 5f6a 6f62 203d 2073 656c 662e  load_job = self.
-00007c50: 6271 636c 6965 6e74 2e6c 6f61 645f 7461  bqclient.load_ta
-00007c60: 626c 655f 6672 6f6d 5f66 696c 6528 0a20  ble_from_file(. 
-00007c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007c80: 2020 2020 2020 2073 6f75 7263 655f 6669         source_fi
-00007c90: 6c65 2c20 7461 626c 652c 206a 6f62 5f63  le, table, job_c
-00007ca0: 6f6e 6669 673d 6a6f 625f 636f 6e66 6967  onfig=job_config
-00007cb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007cc0: 2020 2020 2029 0a20 2020 2020 2020 2065       ).        e
-00007cd0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00007ce0: 206c 6f61 645f 6a6f 6220 3d20 7365 6c66   load_job = self
-00007cf0: 2e62 7163 6c69 656e 742e 6c6f 6164 5f74  .bqclient.load_t
-00007d00: 6162 6c65 5f66 726f 6d5f 6669 6c65 280a  able_from_file(.
-00007d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007d20: 6669 6c65 7061 7468 5f6f 725f 6275 6666  filepath_or_buff
-00007d30: 6572 2c20 7461 626c 652c 206a 6f62 5f63  er, table, job_c
-00007d40: 6f6e 6669 673d 6a6f 625f 636f 6e66 6967  onfig=job_config
-00007d50: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
-00007d60: 2020 2020 2020 2020 7365 6c66 2e5f 7374          self._st
-00007d70: 6172 745f 6765 6e65 7269 635f 6a6f 6228  art_generic_job(
-00007d80: 6c6f 6164 5f6a 6f62 290a 2020 2020 2020  load_job).      
-00007d90: 2020 7461 626c 655f 6964 203d 2066 227b    table_id = f"{
-00007da0: 7461 626c 652e 7072 6f6a 6563 747d 2e7b  table.project}.{
-00007db0: 7461 626c 652e 6461 7461 7365 745f 6964  table.dataset_id
-00007dc0: 7d2e 7b74 6162 6c65 2e74 6162 6c65 5f69  }.{table.table_i
-00007dd0: 647d 220a 0a20 2020 2020 2020 2023 2055  d}"..        # U
-00007de0: 7064 6174 6520 7468 6520 7461 626c 6520  pdate the table 
-00007df0: 6578 7069 7261 7469 6f6e 2073 6f20 7765  expiration so we
-00007e00: 2061 7265 6e27 7420 6c69 6d69 7465 6420   aren't limited 
-00007e10: 746f 2074 6865 2064 6566 6175 6c74 2032  to the default 2
-00007e20: 340a 2020 2020 2020 2020 2320 686f 7572  4.        # hour
-00007e30: 7320 6f66 2074 6865 2061 6e6f 6e79 6d6f  s of the anonymo
-00007e40: 7573 2064 6174 6173 6574 2e0a 2020 2020  us dataset..    
-00007e50: 2020 2020 7461 626c 655f 6578 7069 7261      table_expira
-00007e60: 7469 6f6e 203d 2062 6967 7175 6572 792e  tion = bigquery.
-00007e70: 5461 626c 6528 7461 626c 655f 6964 290a  Table(table_id).
-00007e80: 2020 2020 2020 2020 7461 626c 655f 6578          table_ex
-00007e90: 7069 7261 7469 6f6e 2e65 7870 6972 6573  piration.expires
-00007ea0: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
-00007eb0: 2064 6174 6574 696d 652e 6461 7465 7469   datetime.dateti
-00007ec0: 6d65 2e6e 6f77 2864 6174 6574 696d 652e  me.now(datetime.
-00007ed0: 7469 6d65 7a6f 6e65 2e75 7463 2920 2b20  timezone.utc) + 
-00007ee0: 636f 6e73 7461 6e74 732e 4445 4641 554c  constants.DEFAUL
-00007ef0: 545f 4558 5049 5241 5449 4f4e 0a20 2020  T_EXPIRATION.   
-00007f00: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
-00007f10: 656c 662e 6271 636c 6965 6e74 2e75 7064  elf.bqclient.upd
-00007f20: 6174 655f 7461 626c 6528 7461 626c 655f  ate_table(table_
-00007f30: 6578 7069 7261 7469 6f6e 2c20 5b22 6578  expiration, ["ex
-00007f40: 7069 7265 7322 5d29 0a0a 2020 2020 2020  pires"])..      
-00007f50: 2020 2320 5468 6520 4269 6751 7565 7279    # The BigQuery
-00007f60: 2052 4553 5420 4150 4920 666f 7220 7461   REST API for ta
-00007f70: 626c 6573 2e67 6574 2064 6f65 736e 2774  bles.get doesn't
-00007f80: 2074 616b 6520 6120 7365 7373 696f 6e20   take a session 
-00007f90: 4944 2c20 736f 2077 650a 2020 2020 2020  ID, so we.      
-00007fa0: 2020 2320 6361 6e27 7420 6765 7420 7468    # can't get th
-00007fb0: 6520 7363 6865 6d61 2066 6f72 2061 2074  e schema for a t
-00007fc0: 656d 7020 7461 626c 6520 7468 6174 2077  emp table that w
-00007fd0: 6179 2e0a 2020 2020 2020 2020 7265 7475  ay..        retu
-00007fe0: 726e 2073 656c 662e 7265 6164 5f67 6271  rn self.read_gbq
-00007ff0: 5f74 6162 6c65 280a 2020 2020 2020 2020  _table(.        
-00008000: 2020 2020 7461 626c 655f 6964 2c0a 2020      table_id,.  
-00008010: 2020 2020 2020 2020 2020 696e 6465 785f            index_
-00008020: 636f 6c3d 696e 6465 785f 636f 6c2c 0a20  col=index_col,. 
-00008030: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
-00008040: 6e73 3d63 6f6c 756d 6e73 2c0a 2020 2020  ns=columns,.    
-00008050: 2020 2020 290a 0a20 2020 2064 6566 2072      )..    def r
-00008060: 6561 645f 6762 715f 6d6f 6465 6c28 7365  ead_gbq_model(se
-00008070: 6c66 2c20 6d6f 6465 6c5f 6e61 6d65 3a20  lf, model_name: 
-00008080: 7374 7229 3a0a 2020 2020 2020 2020 2222  str):.        ""
-00008090: 224c 6f61 6473 2061 2042 6967 5175 6572  "Loads a BigQuer
-000080a0: 7920 4d4c 206d 6f64 656c 2066 726f 6d20  y ML model from 
-000080b0: 4269 6751 7565 7279 2e0a 0a20 2020 2020  BigQuery...     
-000080c0: 2020 202a 2a45 7861 6d70 6c65 733a 2a2a     **Examples:**
-000080d0: 0a0a 2020 2020 2020 2020 2020 2020 3e3e  ..            >>
-000080e0: 3e20 696d 706f 7274 2062 6967 6672 616d  > import bigfram
-000080f0: 6573 2e70 616e 6461 7320 6173 2062 7064  es.pandas as bpd
-00008100: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-00008110: 2062 7064 2e6f 7074 696f 6e73 2e64 6973   bpd.options.dis
-00008120: 706c 6179 2e70 726f 6772 6573 735f 6261  play.progress_ba
-00008130: 7220 3d20 4e6f 6e65 0a0a 2020 2020 2020  r = None..      
-00008140: 2020 5265 6164 2061 6e20 6578 6973 7469    Read an existi
-00008150: 6e67 2042 6967 5175 6572 7920 4d4c 206d  ng BigQuery ML m
-00008160: 6f64 656c 2e0a 0a20 2020 2020 2020 2020  odel...         
-00008170: 2020 203e 3e3e 206d 6f64 656c 5f6e 616d     >>> model_nam
-00008180: 6520 3d20 2262 6967 6672 616d 6573 2d64  e = "bigframes-d
-00008190: 6576 2e62 716d 6c5f 7475 746f 7269 616c  ev.bqml_tutorial
-000081a0: 2e70 656e 6775 696e 735f 6d6f 6465 6c22  .penguins_model"
-000081b0: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-000081c0: 206d 6f64 656c 203d 2062 7064 2e72 6561   model = bpd.rea
-000081d0: 645f 6762 715f 6d6f 6465 6c28 6d6f 6465  d_gbq_model(mode
-000081e0: 6c5f 6e61 6d65 290a 0a20 2020 2020 2020  l_name)..       
-000081f0: 2041 7267 733a 0a20 2020 2020 2020 2020   Args:.         
-00008200: 2020 206d 6f64 656c 5f6e 616d 6520 2873     model_name (s
-00008210: 7472 293a 0a20 2020 2020 2020 2020 2020  tr):.           
-00008220: 2020 2020 2074 6865 206d 6f64 656c 2773       the model's
-00008230: 206e 616d 6520 696e 2042 6967 5175 6572   name in BigQuer
-00008240: 7920 696e 2074 6865 2066 6f72 6d61 740a  y in the format.
-00008250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008260: 6070 726f 6a65 6374 5f69 642e 6461 7461  `project_id.data
-00008270: 7365 745f 6964 2e6d 6f64 656c 5f69 6460  set_id.model_id`
-00008280: 2c20 6f72 206a 7573 7420 6064 6174 6173  , or just `datas
-00008290: 6574 5f69 642e 6d6f 6465 6c5f 6964 600a  et_id.model_id`.
-000082a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000082b0: 746f 206c 6f61 6420 6672 6f6d 2074 6865  to load from the
-000082c0: 2064 6566 6175 6c74 2070 726f 6a65 6374   default project
-000082d0: 2e0a 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
-000082e0: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
-000082f0: 4120 6269 6766 7261 6d65 732e 6d6c 204d  A bigframes.ml M
-00008300: 6f64 656c 2c20 5472 616e 7366 6f72 6d65  odel, Transforme
-00008310: 7220 6f72 2050 6970 656c 696e 6520 7772  r or Pipeline wr
-00008320: 6170 7069 6e67 2074 6865 206d 6f64 656c  apping the model
-00008330: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00008340: 2020 2020 2020 696d 706f 7274 2062 6967        import big
-00008350: 6672 616d 6573 2e6d 6c2e 6c6f 6164 6572  frames.ml.loader
-00008360: 0a0a 2020 2020 2020 2020 6d6f 6465 6c5f  ..        model_
-00008370: 7265 6620 3d20 6269 6771 7565 7279 2e4d  ref = bigquery.M
-00008380: 6f64 656c 5265 6665 7265 6e63 652e 6672  odelReference.fr
-00008390: 6f6d 5f73 7472 696e 6728 0a20 2020 2020  om_string(.     
-000083a0: 2020 2020 2020 206d 6f64 656c 5f6e 616d         model_nam
-000083b0: 652c 2064 6566 6175 6c74 5f70 726f 6a65  e, default_proje
-000083c0: 6374 3d73 656c 662e 6271 636c 6965 6e74  ct=self.bqclient
-000083d0: 2e70 726f 6a65 6374 0a20 2020 2020 2020  .project.       
-000083e0: 2029 0a20 2020 2020 2020 206d 6f64 656c   ).        model
-000083f0: 203d 2073 656c 662e 6271 636c 6965 6e74   = self.bqclient
-00008400: 2e67 6574 5f6d 6f64 656c 286d 6f64 656c  .get_model(model
-00008410: 5f72 6566 290a 2020 2020 2020 2020 7265  _ref).        re
-00008420: 7475 726e 2062 6967 6672 616d 6573 2e6d  turn bigframes.m
-00008430: 6c2e 6c6f 6164 6572 2e66 726f 6d5f 6271  l.loader.from_bq
-00008440: 2873 656c 662c 206d 6f64 656c 290a 0a20  (self, model).. 
-00008450: 2020 2040 7479 7069 6e67 2e6f 7665 726c     @typing.overl
-00008460: 6f61 640a 2020 2020 6465 6620 7265 6164  oad.    def read
-00008470: 5f70 616e 6461 7328 0a20 2020 2020 2020  _pandas(.       
-00008480: 2073 656c 662c 2070 616e 6461 735f 6461   self, pandas_da
-00008490: 7461 6672 616d 653a 2070 616e 6461 732e  taframe: pandas.
-000084a0: 496e 6465 780a 2020 2020 2920 2d3e 2062  Index.    ) -> b
-000084b0: 6967 6672 616d 6573 2e63 6f72 652e 696e  igframes.core.in
-000084c0: 6465 7865 732e 496e 6465 783a 0a20 2020  dexes.Index:.   
-000084d0: 2020 2020 202e 2e2e 0a0a 2020 2020 4074       .....    @t
-000084e0: 7970 696e 672e 6f76 6572 6c6f 6164 0a20  yping.overload. 
-000084f0: 2020 2064 6566 2072 6561 645f 7061 6e64     def read_pand
-00008500: 6173 2873 656c 662c 2070 616e 6461 735f  as(self, pandas_
-00008510: 6461 7461 6672 616d 653a 2070 616e 6461  dataframe: panda
-00008520: 732e 5365 7269 6573 2920 2d3e 2062 6967  s.Series) -> big
-00008530: 6672 616d 6573 2e73 6572 6965 732e 5365  frames.series.Se
-00008540: 7269 6573 3a0a 2020 2020 2020 2020 2e2e  ries:.        ..
-00008550: 2e0a 0a20 2020 2040 7479 7069 6e67 2e6f  ...    @typing.o
-00008560: 7665 726c 6f61 640a 2020 2020 6465 6620  verload.    def 
-00008570: 7265 6164 5f70 616e 6461 7328 7365 6c66  read_pandas(self
-00008580: 2c20 7061 6e64 6173 5f64 6174 6166 7261  , pandas_datafra
-00008590: 6d65 3a20 7061 6e64 6173 2e44 6174 6146  me: pandas.DataF
-000085a0: 7261 6d65 2920 2d3e 2064 6174 6166 7261  rame) -> datafra
-000085b0: 6d65 2e44 6174 6146 7261 6d65 3a0a 2020  me.DataFrame:.  
-000085c0: 2020 2020 2020 2e2e 2e0a 0a20 2020 2064        .....    d
-000085d0: 6566 2072 6561 645f 7061 6e64 6173 280a  ef read_pandas(.
-000085e0: 2020 2020 2020 2020 7365 6c66 2c20 7061          self, pa
-000085f0: 6e64 6173 5f64 6174 6166 7261 6d65 3a20  ndas_dataframe: 
-00008600: 556e 696f 6e5b 7061 6e64 6173 2e44 6174  Union[pandas.Dat
-00008610: 6146 7261 6d65 2c20 7061 6e64 6173 2e53  aFrame, pandas.S
-00008620: 6572 6965 732c 2070 616e 6461 732e 496e  eries, pandas.In
-00008630: 6465 785d 0a20 2020 2029 3a0a 2020 2020  dex].    ):.    
-00008640: 2020 2020 2222 224c 6f61 6473 2044 6174      """Loads Dat
-00008650: 6146 7261 6d65 2066 726f 6d20 6120 7061  aFrame from a pa
-00008660: 6e64 6173 2044 6174 6146 7261 6d65 2e0a  ndas DataFrame..
-00008670: 0a20 2020 2020 2020 2054 6865 2070 616e  .        The pan
-00008680: 6461 7320 4461 7461 4672 616d 6520 7769  das DataFrame wi
-00008690: 6c6c 2062 6520 7065 7273 6973 7465 6420  ll be persisted 
-000086a0: 6173 2061 2074 656d 706f 7261 7279 2042  as a temporary B
-000086b0: 6967 5175 6572 7920 7461 626c 652c 2077  igQuery table, w
-000086c0: 6869 6368 2063 616e 2062 650a 2020 2020  hich can be.    
-000086d0: 2020 2020 6175 746f 6d61 7469 6361 6c6c      automaticall
-000086e0: 7920 7265 6379 636c 6564 2061 6674 6572  y recycled after
-000086f0: 2074 6865 2053 6573 7369 6f6e 2069 7320   the Session is 
-00008700: 636c 6f73 6564 2e0a 0a20 2020 2020 2020  closed...       
-00008710: 202a 2a45 7861 6d70 6c65 733a 2a2a 0a0a   **Examples:**..
-00008720: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-00008730: 696d 706f 7274 2062 6967 6672 616d 6573  import bigframes
-00008740: 2e70 616e 6461 7320 6173 2062 7064 0a20  .pandas as bpd. 
-00008750: 2020 2020 2020 2020 2020 203e 3e3e 2069             >>> i
-00008760: 6d70 6f72 7420 7061 6e64 6173 2061 7320  mport pandas as 
-00008770: 7064 0a20 2020 2020 2020 2020 2020 203e  pd.            >
-00008780: 3e3e 2062 7064 2e6f 7074 696f 6e73 2e64  >> bpd.options.d
-00008790: 6973 706c 6179 2e70 726f 6772 6573 735f  isplay.progress_
-000087a0: 6261 7220 3d20 4e6f 6e65 0a0a 2020 2020  bar = None..    
-000087b0: 2020 2020 2020 2020 3e3e 3e20 6420 3d20          >>> d = 
-000087c0: 7b27 636f 6c31 273a 205b 312c 2032 5d2c  {'col1': [1, 2],
-000087d0: 2027 636f 6c32 273a 205b 332c 2034 5d7d   'col2': [3, 4]}
-000087e0: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-000087f0: 2070 616e 6461 735f 6466 203d 2070 642e   pandas_df = pd.
-00008800: 4461 7461 4672 616d 6528 6461 7461 3d64  DataFrame(data=d
-00008810: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
-00008820: 3e20 6466 203d 2062 7064 2e72 6561 645f  > df = bpd.read_
-00008830: 7061 6e64 6173 2870 616e 6461 735f 6466  pandas(pandas_df
-00008840: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
-00008850: 3e20 6466 0a20 2020 2020 2020 2020 2020  > df.           
-00008860: 2020 2020 636f 6c31 2020 636f 6c32 0a20      col1  col2. 
-00008870: 2020 2020 2020 2020 2020 2030 2020 2020             0    
-00008880: 2031 2020 2020 2033 0a20 2020 2020 2020   1     3.       
-00008890: 2020 2020 2031 2020 2020 2032 2020 2020       1     2    
-000088a0: 2034 0a20 2020 2020 2020 2020 2020 203c   4.            <
-000088b0: 424c 414e 4b4c 494e 453e 0a20 2020 2020  BLANKLINE>.     
-000088c0: 2020 2020 2020 205b 3220 726f 7773 2078         [2 rows x
-000088d0: 2032 2063 6f6c 756d 6e73 5d0a 0a20 2020   2 columns]..   
-000088e0: 2020 2020 2041 7267 733a 0a20 2020 2020       Args:.     
-000088f0: 2020 2020 2020 2070 616e 6461 735f 6461         pandas_da
-00008900: 7461 6672 616d 6520 2870 616e 6461 732e  taframe (pandas.
-00008910: 4461 7461 4672 616d 652c 2070 616e 6461  DataFrame, panda
-00008920: 732e 5365 7269 6573 2c20 6f72 2070 616e  s.Series, or pan
-00008930: 6461 732e 496e 6465 7829 3a0a 2020 2020  das.Index):.    
-00008940: 2020 2020 2020 2020 2020 2020 6120 7061              a pa
-00008950: 6e64 6173 2044 6174 6146 7261 6d65 2f53  ndas DataFrame/S
-00008960: 6572 6965 732f 496e 6465 7820 6f62 6a65  eries/Index obje
-00008970: 6374 2074 6f20 6265 206c 6f61 6465 642e  ct to be loaded.
-00008980: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-00008990: 733a 0a20 2020 2020 2020 2020 2020 2041  s:.            A
-000089a0: 6e20 6571 7569 7661 6c65 6e74 2062 6967  n equivalent big
-000089b0: 6672 616d 6573 2e70 616e 6461 732e 2844  frames.pandas.(D
-000089c0: 6174 6146 7261 6d65 2f53 6572 6965 732f  ataFrame/Series/
-000089d0: 496e 6465 7829 206f 626a 6563 740a 2020  Index) object.  
-000089e0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000089f0: 2020 696d 706f 7274 2062 6967 6672 616d    import bigfram
-00008a00: 6573 2e73 6572 6965 7320 6173 2073 6572  es.series as ser
-00008a10: 6965 730a 0a20 2020 2020 2020 2023 2054  ies..        # T
-00008a20: 7279 2074 6f20 6861 6e64 6c65 206e 6f6e  ry to handle non
-00008a30: 2d64 6174 6166 7261 6d65 2070 616e 6461  -dataframe panda
-00008a40: 7320 6f62 6a65 6374 7320 6173 2077 656c  s objects as wel
-00008a50: 6c0a 2020 2020 2020 2020 6966 2069 7369  l.        if isi
-00008a60: 6e73 7461 6e63 6528 7061 6e64 6173 5f64  nstance(pandas_d
-00008a70: 6174 6166 7261 6d65 2c20 7061 6e64 6173  ataframe, pandas
-00008a80: 2e53 6572 6965 7329 3a0a 2020 2020 2020  .Series):.      
-00008a90: 2020 2020 2020 6266 5f64 6620 3d20 7365        bf_df = se
-00008aa0: 6c66 2e5f 7265 6164 5f70 616e 6461 7328  lf._read_pandas(
-00008ab0: 7061 6e64 6173 2e44 6174 6146 7261 6d65  pandas.DataFrame
-00008ac0: 2870 616e 6461 735f 6461 7461 6672 616d  (pandas_datafram
-00008ad0: 6529 2c20 2272 6561 645f 7061 6e64 6173  e), "read_pandas
-00008ae0: 2229 0a20 2020 2020 2020 2020 2020 2062  ").            b
-00008af0: 665f 7365 7269 6573 203d 2074 7970 696e  f_series = typin
-00008b00: 672e 6361 7374 2873 6572 6965 732e 5365  g.cast(series.Se
-00008b10: 7269 6573 2c20 6266 5f64 665b 6266 5f64  ries, bf_df[bf_d
-00008b20: 662e 636f 6c75 6d6e 735b 305d 5d29 0a20  f.columns[0]]). 
-00008b30: 2020 2020 2020 2020 2020 2023 2077 7261             # wra
-00008b40: 7070 696e 6720 696e 746f 2064 6620 6361  pping into df ca
-00008b50: 6e20 7365 7420 6e61 6d65 2074 6f20 3020  n set name to 0 
-00008b60: 736f 2072 6573 6574 2074 6f20 6f72 6967  so reset to orig
-00008b70: 696e 616c 206f 626a 6563 7420 6e61 6d65  inal object name
-00008b80: 0a20 2020 2020 2020 2020 2020 2062 665f  .            bf_
-00008b90: 7365 7269 6573 2e6e 616d 6520 3d20 7061  series.name = pa
-00008ba0: 6e64 6173 5f64 6174 6166 7261 6d65 2e6e  ndas_dataframe.n
-00008bb0: 616d 650a 2020 2020 2020 2020 2020 2020  ame.            
-00008bc0: 7265 7475 726e 2062 665f 7365 7269 6573  return bf_series
-00008bd0: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
-00008be0: 7374 616e 6365 2870 616e 6461 735f 6461  stance(pandas_da
-00008bf0: 7461 6672 616d 652c 2070 616e 6461 732e  taframe, pandas.
-00008c00: 496e 6465 7829 3a0a 2020 2020 2020 2020  Index):.        
-00008c10: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00008c20: 5f72 6561 645f 7061 6e64 6173 280a 2020  _read_pandas(.  
-00008c30: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-00008c40: 6e64 6173 2e44 6174 6146 7261 6d65 2869  ndas.DataFrame(i
-00008c50: 6e64 6578 3d70 616e 6461 735f 6461 7461  ndex=pandas_data
-00008c60: 6672 616d 6529 2c20 2272 6561 645f 7061  frame), "read_pa
-00008c70: 6e64 6173 220a 2020 2020 2020 2020 2020  ndas".          
-00008c80: 2020 292e 696e 6465 780a 2020 2020 2020    ).index.      
-00008c90: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00008ca0: 7061 6e64 6173 5f64 6174 6166 7261 6d65  pandas_dataframe
-00008cb0: 2c20 7061 6e64 6173 2e44 6174 6146 7261  , pandas.DataFra
-00008cc0: 6d65 293a 0a20 2020 2020 2020 2020 2020  me):.           
-00008cd0: 2072 6574 7572 6e20 7365 6c66 2e5f 7265   return self._re
-00008ce0: 6164 5f70 616e 6461 7328 7061 6e64 6173  ad_pandas(pandas
-00008cf0: 5f64 6174 6166 7261 6d65 2c20 2272 6561  _dataframe, "rea
-00008d00: 645f 7061 6e64 6173 2229 0a20 2020 2020  d_pandas").     
-00008d10: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00008d20: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00008d30: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-00008d40: 2020 2020 2020 2066 2272 6561 645f 7061         f"read_pa
-00008d50: 6e64 6173 2829 2065 7870 6563 7473 2061  ndas() expects a
-00008d60: 2070 616e 6461 732e 4461 7461 4672 616d   pandas.DataFram
-00008d70: 652c 2062 7574 2067 6f74 2061 207b 7479  e, but got a {ty
-00008d80: 7065 2870 616e 6461 735f 6461 7461 6672  pe(pandas_datafr
-00008d90: 616d 6529 7d22 0a20 2020 2020 2020 2020  ame)}".         
-00008da0: 2020 2029 0a0a 2020 2020 6465 6620 5f72     )..    def _r
-00008db0: 6561 645f 7061 6e64 6173 280a 2020 2020  ead_pandas(.    
-00008dc0: 2020 2020 7365 6c66 2c20 7061 6e64 6173      self, pandas
-00008dd0: 5f64 6174 6166 7261 6d65 3a20 7061 6e64  _dataframe: pand
-00008de0: 6173 2e44 6174 6146 7261 6d65 2c20 6170  as.DataFrame, ap
-00008df0: 695f 6e61 6d65 3a20 7374 720a 2020 2020  i_name: str.    
-00008e00: 2920 2d3e 2064 6174 6166 7261 6d65 2e44  ) -> dataframe.D
-00008e10: 6174 6146 7261 6d65 3a0a 2020 2020 2020  ataFrame:.      
-00008e20: 2020 696d 706f 7274 2062 6967 6672 616d    import bigfram
-00008e30: 6573 2e64 6174 6166 7261 6d65 2061 7320  es.dataframe as 
-00008e40: 6461 7461 6672 616d 650a 0a20 2020 2020  dataframe..     
-00008e50: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00008e60: 2870 616e 6461 735f 6461 7461 6672 616d  (pandas_datafram
-00008e70: 652c 2064 6174 6166 7261 6d65 2e44 6174  e, dataframe.Dat
-00008e80: 6146 7261 6d65 293a 0a20 2020 2020 2020  aFrame):.       
-00008e90: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00008ea0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-00008eb0: 2020 2020 2020 2022 7265 6164 5f70 616e         "read_pan
-00008ec0: 6461 7328 2920 6578 7065 6374 7320 6120  das() expects a 
-00008ed0: 7061 6e64 6173 2e44 6174 6146 7261 6d65  pandas.DataFrame
-00008ee0: 2c20 6275 7420 676f 7420 6120 220a 2020  , but got a ".  
-00008ef0: 2020 2020 2020 2020 2020 2020 2020 2262                "b
-00008f00: 6967 6672 616d 6573 2e70 616e 6461 732e  igframes.pandas.
-00008f10: 4461 7461 4672 616d 652e 220a 2020 2020  DataFrame.".    
-00008f20: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-00008f30: 2020 2069 6e6c 696e 655f 6466 203d 2073     inline_df = s
-00008f40: 656c 662e 5f72 6561 645f 7061 6e64 6173  elf._read_pandas
-00008f50: 5f69 6e6c 696e 6528 7061 6e64 6173 5f64  _inline(pandas_d
-00008f60: 6174 6166 7261 6d65 290a 2020 2020 2020  ataframe).      
-00008f70: 2020 6966 2069 6e6c 696e 655f 6466 2069    if inline_df i
-00008f80: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-00008f90: 2020 2020 2020 2020 7265 7475 726e 2069          return i
-00008fa0: 6e6c 696e 655f 6466 0a20 2020 2020 2020  nline_df.       
-00008fb0: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
-00008fc0: 2020 7265 7475 726e 2073 656c 662e 5f72    return self._r
-00008fd0: 6561 645f 7061 6e64 6173 5f6c 6f61 645f  ead_pandas_load_
-00008fe0: 6a6f 6228 7061 6e64 6173 5f64 6174 6166  job(pandas_dataf
-00008ff0: 7261 6d65 2c20 6170 695f 6e61 6d65 290a  rame, api_name).
-00009000: 2020 2020 2020 2020 6578 6365 7074 2070          except p
-00009010: 612e 4172 726f 7749 6e76 616c 6964 2061  a.ArrowInvalid a
-00009020: 7320 653a 0a20 2020 2020 2020 2020 2020  s e:.           
-00009030: 2072 6169 7365 2070 612e 4172 726f 7749   raise pa.ArrowI
-00009040: 6e76 616c 6964 280a 2020 2020 2020 2020  nvalid(.        
-00009050: 2020 2020 2020 2020 6622 436f 756c 6420          f"Could 
-00009060: 6e6f 7420 636f 6e76 6572 7420 7769 7468  not convert with
-00009070: 2061 2042 6967 5175 6572 7920 7479 7065   a BigQuery type
-00009080: 3a20 607b 657d 602e 2022 0a20 2020 2020  : `{e}`. ".     
-00009090: 2020 2020 2020 2029 2066 726f 6d20 650a         ) from e.
-000090a0: 0a20 2020 2064 6566 205f 7265 6164 5f70  .    def _read_p
-000090b0: 616e 6461 735f 696e 6c69 6e65 280a 2020  andas_inline(.  
-000090c0: 2020 2020 2020 7365 6c66 2c20 7061 6e64        self, pand
-000090d0: 6173 5f64 6174 6166 7261 6d65 3a20 7061  as_dataframe: pa
-000090e0: 6e64 6173 2e44 6174 6146 7261 6d65 0a20  ndas.DataFrame. 
-000090f0: 2020 2029 202d 3e20 4f70 7469 6f6e 616c     ) -> Optional
-00009100: 5b64 6174 6166 7261 6d65 2e44 6174 6146  [dataframe.DataF
-00009110: 7261 6d65 5d3a 0a20 2020 2020 2020 2069  rame]:.        i
-00009120: 6d70 6f72 7420 6269 6766 7261 6d65 732e  mport bigframes.
-00009130: 6461 7461 6672 616d 6520 6173 2064 6174  dataframe as dat
-00009140: 6166 7261 6d65 0a0a 2020 2020 2020 2020  aframe..        
-00009150: 6966 2070 616e 6461 735f 6461 7461 6672  if pandas_datafr
-00009160: 616d 652e 6d65 6d6f 7279 5f75 7361 6765  ame.memory_usage
-00009170: 2864 6565 703d 5472 7565 292e 7375 6d28  (deep=True).sum(
-00009180: 2920 3e20 4d41 585f 494e 4c49 4e45 5f44  ) > MAX_INLINE_D
-00009190: 465f 4259 5445 533a 0a20 2020 2020 2020  F_BYTES:.       
-000091a0: 2020 2020 2072 6574 7572 6e20 4e6f 6e65       return None
-000091b0: 0a0a 2020 2020 2020 2020 7472 793a 0a20  ..        try:. 
-000091c0: 2020 2020 2020 2020 2020 2069 6e6c 696e             inlin
-000091d0: 655f 6466 203d 2064 6174 6166 7261 6d65  e_df = dataframe
-000091e0: 2e44 6174 6146 7261 6d65 280a 2020 2020  .DataFrame(.    
-000091f0: 2020 2020 2020 2020 2020 2020 626c 6f63              bloc
-00009200: 6b73 2e42 6c6f 636b 2e66 726f 6d5f 6c6f  ks.Block.from_lo
-00009210: 6361 6c28 7061 6e64 6173 5f64 6174 6166  cal(pandas_dataf
-00009220: 7261 6d65 2c20 7365 6c66 290a 2020 2020  rame, self).    
-00009230: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00009240: 2020 6578 6365 7074 2070 612e 4172 726f    except pa.Arro
-00009250: 7749 6e76 616c 6964 2061 7320 653a 0a20  wInvalid as e:. 
-00009260: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00009270: 2070 612e 4172 726f 7749 6e76 616c 6964   pa.ArrowInvalid
-00009280: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00009290: 2020 6622 436f 756c 6420 6e6f 7420 636f    f"Could not co
-000092a0: 6e76 6572 7420 7769 7468 2061 2042 6967  nvert with a Big
-000092b0: 5175 6572 7920 7479 7065 3a20 607b 657d  Query type: `{e}
-000092c0: 602e 2022 0a20 2020 2020 2020 2020 2020  `. ".           
-000092d0: 2029 2066 726f 6d20 650a 2020 2020 2020   ) from e.      
-000092e0: 2020 6578 6365 7074 2056 616c 7565 4572    except ValueEr
-000092f0: 726f 723a 2020 2320 5468 726f 776e 2062  ror:  # Thrown b
-00009300: 7920 6962 6973 2066 6f72 2073 6f6d 6520  y ibis for some 
-00009310: 756e 6861 6e64 6c65 6420 7479 7065 730a  unhandled types.
-00009320: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00009330: 726e 204e 6f6e 650a 2020 2020 2020 2020  rn None.        
-00009340: 6578 6365 7074 2070 612e 4172 726f 7754  except pa.ArrowT
-00009350: 7970 6545 7272 6f72 3a20 2023 2054 6872  ypeError:  # Thr
-00009360: 6f77 6e20 6279 2061 7272 6f77 2066 6f72  own by arrow for
-00009370: 2074 7970 6573 2077 6974 686f 7574 206d   types without m
-00009380: 6170 7069 6e67 2028 6765 6f29 2e0a 2020  apping (geo)..  
-00009390: 2020 2020 2020 2020 2020 7265 7475 726e            return
-000093a0: 204e 6f6e 650a 0a20 2020 2020 2020 2069   None..        i
-000093b0: 6e6c 696e 655f 7479 7065 7320 3d20 696e  nline_types = in
-000093c0: 6c69 6e65 5f64 662e 5f62 6c6f 636b 2e65  line_df._block.e
-000093d0: 7870 722e 7363 6865 6d61 2e64 7479 7065  xpr.schema.dtype
-000093e0: 730a 2020 2020 2020 2020 2320 4962 6973  s.        # Ibis
-000093f0: 2068 6173 2070 726f 626c 656d 7320 6573   has problems es
-00009400: 6361 7069 6e67 2062 7974 6573 206c 6974  caping bytes lit
-00009410: 6572 616c 732c 2077 6869 6368 2077 696c  erals, which wil
-00009420: 6c20 6361 7573 6520 7379 6e74 6178 2065  l cause syntax e
-00009430: 7272 6f72 7320 7365 7276 6572 2d73 6964  rrors server-sid
-00009440: 652e 0a20 2020 2020 2020 2069 6620 616c  e..        if al
-00009450: 6c28 6474 7970 6520 696e 2049 4e4c 494e  l(dtype in INLIN
-00009460: 4142 4c45 5f44 5459 5045 5320 666f 7220  ABLE_DTYPES for 
-00009470: 6474 7970 6520 696e 2069 6e6c 696e 655f  dtype in inline_
-00009480: 7479 7065 7329 3a0a 2020 2020 2020 2020  types):.        
-00009490: 2020 2020 7265 7475 726e 2069 6e6c 696e      return inlin
-000094a0: 655f 6466 0a20 2020 2020 2020 2072 6574  e_df.        ret
-000094b0: 7572 6e20 4e6f 6e65 0a0a 2020 2020 6465  urn None..    de
-000094c0: 6620 5f72 6561 645f 7061 6e64 6173 5f6c  f _read_pandas_l
-000094d0: 6f61 645f 6a6f 6228 0a20 2020 2020 2020  oad_job(.       
-000094e0: 2073 656c 662c 2070 616e 6461 735f 6461   self, pandas_da
-000094f0: 7461 6672 616d 653a 2070 616e 6461 732e  taframe: pandas.
-00009500: 4461 7461 4672 616d 652c 2061 7069 5f6e  DataFrame, api_n
-00009510: 616d 653a 2073 7472 0a20 2020 2029 202d  ame: str.    ) -
-00009520: 3e20 6461 7461 6672 616d 652e 4461 7461  > dataframe.Data
-00009530: 4672 616d 653a 0a20 2020 2020 2020 2069  Frame:.        i
-00009540: 6d70 6f72 7420 6269 6766 7261 6d65 732e  mport bigframes.
-00009550: 6461 7461 6672 616d 6520 6173 2064 6174  dataframe as dat
-00009560: 6166 7261 6d65 0a0a 2020 2020 2020 2020  aframe..        
-00009570: 636f 6c5f 696e 6465 7820 3d20 7061 6e64  col_index = pand
-00009580: 6173 5f64 6174 6166 7261 6d65 2e63 6f6c  as_dataframe.col
-00009590: 756d 6e73 2e63 6f70 7928 290a 2020 2020  umns.copy().    
-000095a0: 2020 2020 636f 6c5f 6c61 6265 6c73 2c20      col_labels, 
-000095b0: 6964 785f 6c61 6265 6c73 203d 2028 0a20  idx_labels = (. 
-000095c0: 2020 2020 2020 2020 2020 2063 6f6c 5f69             col_i
-000095d0: 6e64 6578 2e74 6f5f 6c69 7374 2829 2c0a  ndex.to_list(),.
-000095e0: 2020 2020 2020 2020 2020 2020 7061 6e64              pand
-000095f0: 6173 5f64 6174 6166 7261 6d65 2e69 6e64  as_dataframe.ind
-00009600: 6578 2e6e 616d 6573 2c0a 2020 2020 2020  ex.names,.      
-00009610: 2020 290a 2020 2020 2020 2020 6e65 775f    ).        new_
-00009620: 636f 6c5f 6964 732c 206e 6577 5f69 6478  col_ids, new_idx
-00009630: 5f69 6473 203d 2075 7469 6c73 2e67 6574  _ids = utils.get
-00009640: 5f73 7461 6e64 6172 6469 7a65 645f 6964  _standardized_id
-00009650: 7328 0a20 2020 2020 2020 2020 2020 2063  s(.            c
-00009660: 6f6c 5f6c 6162 656c 732c 0a20 2020 2020  ol_labels,.     
-00009670: 2020 2020 2020 2069 6478 5f6c 6162 656c         idx_label
-00009680: 732c 0a20 2020 2020 2020 2020 2020 2023  s,.            #
-00009690: 204c 6f61 6469 6e67 2070 6172 7175 6574   Loading parquet
-000096a0: 2066 696c 6573 2069 6e74 6f20 4269 6751   files into BigQ
-000096b0: 7565 7279 2077 6974 6820 7370 6563 6961  uery with specia
-000096c0: 6c20 636f 6c75 6d6e 206e 616d 6573 0a20  l column names. 
-000096d0: 2020 2020 2020 2020 2020 2023 2069 7320             # is 
-000096e0: 6f6e 6c79 2073 7570 706f 7274 6564 2075  only supported u
-000096f0: 6e64 6572 2061 6e20 616c 6c6f 776c 6973  nder an allowlis
-00009700: 742e 0a20 2020 2020 2020 2020 2020 2073  t..            s
-00009710: 7472 6963 743d 5472 7565 2c0a 2020 2020  trict=True,.    
-00009720: 2020 2020 290a 0a20 2020 2020 2020 2023      )..        #
-00009730: 2041 6464 206f 7264 6572 2063 6f6c 756d   Add order colum
-00009740: 6e20 746f 2070 616e 6461 7320 4461 7461  n to pandas Data
-00009750: 4672 616d 6520 746f 2070 7265 7365 7276  Frame to preserv
-00009760: 6520 6f72 6465 7220 696e 2042 6967 5175  e order in BigQu
-00009770: 6572 790a 2020 2020 2020 2020 6f72 6465  ery.        orde
-00009780: 7269 6e67 5f63 6f6c 203d 2022 726f 7769  ring_col = "rowi
-00009790: 6422 0a20 2020 2020 2020 2063 6f6c 756d  d".        colum
-000097a0: 6e73 203d 2066 726f 7a65 6e73 6574 2863  ns = frozenset(c
-000097b0: 6f6c 5f6c 6162 656c 7320 2b20 6964 785f  ol_labels + idx_
-000097c0: 6c61 6265 6c73 290a 2020 2020 2020 2020  labels).        
-000097d0: 7375 6666 6978 203d 2032 0a20 2020 2020  suffix = 2.     
-000097e0: 2020 2077 6869 6c65 206f 7264 6572 696e     while orderin
-000097f0: 675f 636f 6c20 696e 2063 6f6c 756d 6e73  g_col in columns
-00009800: 3a0a 2020 2020 2020 2020 2020 2020 6f72  :.            or
-00009810: 6465 7269 6e67 5f63 6f6c 203d 2066 2272  dering_col = f"r
-00009820: 6f77 6964 5f7b 7375 6666 6978 7d22 0a20  owid_{suffix}". 
-00009830: 2020 2020 2020 2020 2020 2073 7566 6669             suffi
-00009840: 7820 2b3d 2031 0a0a 2020 2020 2020 2020  x += 1..        
-00009850: 7061 6e64 6173 5f64 6174 6166 7261 6d65  pandas_dataframe
-00009860: 5f63 6f70 7920 3d20 7061 6e64 6173 5f64  _copy = pandas_d
-00009870: 6174 6166 7261 6d65 2e63 6f70 7928 290a  ataframe.copy().
-00009880: 2020 2020 2020 2020 7061 6e64 6173 5f64          pandas_d
-00009890: 6174 6166 7261 6d65 5f63 6f70 792e 696e  ataframe_copy.in
-000098a0: 6465 782e 6e61 6d65 7320 3d20 6e65 775f  dex.names = new_
-000098b0: 6964 785f 6964 730a 2020 2020 2020 2020  idx_ids.        
-000098c0: 7061 6e64 6173 5f64 6174 6166 7261 6d65  pandas_dataframe
-000098d0: 5f63 6f70 792e 636f 6c75 6d6e 7320 3d20  _copy.columns = 
-000098e0: 7061 6e64 6173 2e49 6e64 6578 286e 6577  pandas.Index(new
-000098f0: 5f63 6f6c 5f69 6473 290a 2020 2020 2020  _col_ids).      
-00009900: 2020 7061 6e64 6173 5f64 6174 6166 7261    pandas_datafra
-00009910: 6d65 5f63 6f70 795b 6f72 6465 7269 6e67  me_copy[ordering
-00009920: 5f63 6f6c 5d20 3d20 6e70 2e61 7261 6e67  _col] = np.arang
-00009930: 6528 7061 6e64 6173 5f64 6174 6166 7261  e(pandas_datafra
-00009940: 6d65 5f63 6f70 792e 7368 6170 655b 305d  me_copy.shape[0]
-00009950: 290a 0a20 2020 2020 2020 206a 6f62 5f63  )..        job_c
-00009960: 6f6e 6669 6720 3d20 7365 6c66 2e5f 7072  onfig = self._pr
-00009970: 6570 6172 655f 6c6f 6164 5f6a 6f62 5f63  epare_load_job_c
-00009980: 6f6e 6669 6728 290a 0a20 2020 2020 2020  onfig()..       
-00009990: 2023 2053 7065 6369 6679 2074 6865 2064   # Specify the d
-000099a0: 6174 6574 696d 6520 6474 7970 6573 2c20  atetime dtypes, 
-000099b0: 7768 6963 6820 6973 2061 7574 6f2d 6465  which is auto-de
-000099c0: 7465 6374 6564 2061 7320 7469 6d65 7374  tected as timest
-000099d0: 616d 7020 7479 7065 732e 0a20 2020 2020  amp types..     
-000099e0: 2020 2073 6368 656d 613a 206c 6973 745b     schema: list[
-000099f0: 6269 6771 7565 7279 2e53 6368 656d 6146  bigquery.SchemaF
-00009a00: 6965 6c64 5d20 3d20 5b5d 0a20 2020 2020  ield] = [].     
-00009a10: 2020 2066 6f72 2063 6f6c 756d 6e2c 2064     for column, d
-00009a20: 7479 7065 2069 6e20 7a69 7028 6e65 775f  type in zip(new_
-00009a30: 636f 6c5f 6964 732c 2070 616e 6461 735f  col_ids, pandas_
-00009a40: 6461 7461 6672 616d 652e 6474 7970 6573  dataframe.dtypes
-00009a50: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
-00009a60: 6620 6474 7970 6520 3d3d 2022 7469 6d65  f dtype == "time
-00009a70: 7374 616d 705b 7573 5d5b 7079 6172 726f  stamp[us][pyarro
-00009a80: 775d 223a 0a20 2020 2020 2020 2020 2020  w]":.           
-00009a90: 2020 2020 2073 6368 656d 612e 6170 7065       schema.appe
-00009aa0: 6e64 280a 2020 2020 2020 2020 2020 2020  nd(.            
-00009ab0: 2020 2020 2020 2020 6269 6771 7565 7279          bigquery
-00009ac0: 2e53 6368 656d 6146 6965 6c64 2863 6f6c  .SchemaField(col
-00009ad0: 756d 6e2c 2062 6967 7175 6572 792e 656e  umn, bigquery.en
-00009ae0: 756d 732e 5371 6c54 7970 654e 616d 6573  ums.SqlTypeNames
-00009af0: 2e44 4154 4554 494d 4529 0a20 2020 2020  .DATETIME).     
-00009b00: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00009b10: 2020 2020 206a 6f62 5f63 6f6e 6669 672e       job_config.
-00009b20: 7363 6865 6d61 203d 2073 6368 656d 610a  schema = schema.
-00009b30: 0a20 2020 2020 2020 2023 2043 6c75 7374  .        # Clust
-00009b40: 6572 696e 6720 7072 6f62 6162 6c79 206e  ering probably n
-00009b50: 6f74 206e 6565 6465 6420 616e 7977 6179  ot needed anyway
-00009b60: 7320 6173 2070 616e 6461 7320 7461 626c  s as pandas tabl
-00009b70: 6573 2061 7265 2073 6d61 6c6c 0a20 2020  es are small.   
-00009b80: 2020 2020 2063 6c75 7374 6572 5f63 6f6c       cluster_col
-00009b90: 7320 3d20 5b6f 7264 6572 696e 675f 636f  s = [ordering_co
-00009ba0: 6c5d 0a20 2020 2020 2020 206a 6f62 5f63  l].        job_c
-00009bb0: 6f6e 6669 672e 636c 7573 7465 7269 6e67  onfig.clustering
-00009bc0: 5f66 6965 6c64 7320 3d20 636c 7573 7465  _fields = cluste
-00009bd0: 725f 636f 6c73 0a0a 2020 2020 2020 2020  r_cols..        
-00009be0: 6a6f 625f 636f 6e66 6967 2e6c 6162 656c  job_config.label
-00009bf0: 7320 3d20 7b22 6269 6766 7261 6d65 732d  s = {"bigframes-
-00009c00: 6170 6922 3a20 6170 695f 6e61 6d65 7d0a  api": api_name}.
-00009c10: 0a20 2020 2020 2020 206c 6f61 645f 7461  .        load_ta
-00009c20: 626c 655f 6465 7374 696e 6174 696f 6e20  ble_destination 
-00009c30: 3d20 7365 6c66 2e5f 7261 6e64 6f6d 5f74  = self._random_t
-00009c40: 6162 6c65 2829 0a20 2020 2020 2020 206c  able().        l
-00009c50: 6f61 645f 6a6f 6220 3d20 7365 6c66 2e62  oad_job = self.b
-00009c60: 7163 6c69 656e 742e 6c6f 6164 5f74 6162  qclient.load_tab
-00009c70: 6c65 5f66 726f 6d5f 6461 7461 6672 616d  le_from_datafram
-00009c80: 6528 0a20 2020 2020 2020 2020 2020 2070  e(.            p
-00009c90: 616e 6461 735f 6461 7461 6672 616d 655f  andas_dataframe_
-00009ca0: 636f 7079 2c0a 2020 2020 2020 2020 2020  copy,.          
-00009cb0: 2020 6c6f 6164 5f74 6162 6c65 5f64 6573    load_table_des
-00009cc0: 7469 6e61 7469 6f6e 2c0a 2020 2020 2020  tination,.      
-00009cd0: 2020 2020 2020 6a6f 625f 636f 6e66 6967        job_config
-00009ce0: 3d6a 6f62 5f63 6f6e 6669 672c 0a20 2020  =job_config,.   
-00009cf0: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
-00009d00: 656c 662e 5f73 7461 7274 5f67 656e 6572  elf._start_gener
-00009d10: 6963 5f6a 6f62 286c 6f61 645f 6a6f 6229  ic_job(load_job)
-00009d20: 0a0a 2020 2020 2020 2020 6f72 6465 7269  ..        orderi
-00009d30: 6e67 203d 206f 7264 6572 2e45 7870 7265  ng = order.Expre
-00009d40: 7373 696f 6e4f 7264 6572 696e 6728 0a20  ssionOrdering(. 
-00009d50: 2020 2020 2020 2020 2020 206f 7264 6572             order
-00009d60: 696e 675f 7661 6c75 655f 636f 6c75 6d6e  ing_value_column
-00009d70: 733d 7475 706c 6528 5b6f 7264 6572 2e61  s=tuple([order.a
-00009d80: 7363 656e 6469 6e67 5f6f 7665 7228 6f72  scending_over(or
-00009d90: 6465 7269 6e67 5f63 6f6c 295d 292c 0a20  dering_col)]),. 
-00009da0: 2020 2020 2020 2020 2020 2074 6f74 616c             total
-00009db0: 5f6f 7264 6572 696e 675f 636f 6c75 6d6e  _ordering_column
-00009dc0: 733d 6672 6f7a 656e 7365 7428 5b6f 7264  s=frozenset([ord
-00009dd0: 6572 696e 675f 636f 6c5d 292c 0a20 2020  ering_col]),.   
-00009de0: 2020 2020 2020 2020 2069 6e74 6567 6572           integer
-00009df0: 5f65 6e63 6f64 696e 673d 496e 7465 6765  _encoding=Intege
-00009e00: 7245 6e63 6f64 696e 6728 5472 7565 2c20  rEncoding(True, 
-00009e10: 6973 5f73 6571 7565 6e74 6961 6c3d 5472  is_sequential=Tr
-00009e20: 7565 292c 0a20 2020 2020 2020 2029 0a20  ue),.        ). 
-00009e30: 2020 2020 2020 2074 6162 6c65 5f65 7870         table_exp
-00009e40: 7265 7373 696f 6e20 3d20 7365 6c66 2e69  ression = self.i
-00009e50: 6269 735f 636c 6965 6e74 2e74 6162 6c65  bis_client.table
-00009e60: 2820 2023 2074 7970 653a 2069 676e 6f72  (  # type: ignor
-00009e70: 650a 2020 2020 2020 2020 2020 2020 6c6f  e.            lo
-00009e80: 6164 5f74 6162 6c65 5f64 6573 7469 6e61  ad_table_destina
-00009e90: 7469 6f6e 2e74 6162 6c65 5f69 642c 0a20  tion.table_id,. 
-00009ea0: 2020 2020 2020 2020 2020 2073 6368 656d             schem
-00009eb0: 613d 6c6f 6164 5f74 6162 6c65 5f64 6573  a=load_table_des
-00009ec0: 7469 6e61 7469 6f6e 2e64 6174 6173 6574  tination.dataset
-00009ed0: 5f69 642c 0a20 2020 2020 2020 2020 2020  _id,.           
-00009ee0: 2064 6174 6162 6173 653d 6c6f 6164 5f74   database=load_t
-00009ef0: 6162 6c65 5f64 6573 7469 6e61 7469 6f6e  able_destination
-00009f00: 2e70 726f 6a65 6374 2c0a 2020 2020 2020  .project,.      
-00009f10: 2020 290a 0a20 2020 2020 2020 2023 2062    )..        # b
-00009f20: 2f32 3937 3539 3031 3738 2050 6f74 656e  /297590178 Poten
-00009f30: 7469 616c 6c79 2061 2062 7567 2069 6e20  tially a bug in 
-00009f40: 6271 636c 6965 6e74 2e6c 6f61 645f 7461  bqclient.load_ta
-00009f50: 626c 655f 6672 6f6d 5f64 6174 6166 7261  ble_from_datafra
-00009f60: 6d65 2829 2c20 7468 6174 206f 6e6c 7920  me(), that only 
-00009f70: 7768 656e 2074 6865 2044 4620 6973 2065  when the DF is e
-00009f80: 6d70 7479 2c20 7468 6520 696e 6465 7820  mpty, the index 
-00009f90: 636f 6c75 6d6e 7320 6469 7361 7070 6561  columns disappea
-00009fa0: 7220 696e 2074 6162 6c65 5f65 7870 7265  r in table_expre
-00009fb0: 7373 696f 6e2e 0a20 2020 2020 2020 2069  ssion..        i
-00009fc0: 6620 616e 7928 0a20 2020 2020 2020 2020  f any(.         
-00009fd0: 2020 205b 6e65 775f 6964 785f 6964 206e     [new_idx_id n
-00009fe0: 6f74 2069 6e20 7461 626c 655f 6578 7072  ot in table_expr
-00009ff0: 6573 7369 6f6e 2e63 6f6c 756d 6e73 2066  ession.columns f
-0000a000: 6f72 206e 6577 5f69 6478 5f69 6420 696e  or new_idx_id in
-0000a010: 206e 6577 5f69 6478 5f69 6473 5d0a 2020   new_idx_ids].  
-0000a020: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
-0000a030: 2020 2020 206e 6577 5f69 6478 5f69 6473       new_idx_ids
-0000a040: 2c20 6964 785f 6c61 6265 6c73 203d 205b  , idx_labels = [
-0000a050: 5d2c 205b 5d0a 0a20 2020 2020 2020 2063  ], []..        c
-0000a060: 6f6c 756d 6e5f 7661 6c75 6573 203d 205b  olumn_values = [
-0000a070: 0a20 2020 2020 2020 2020 2020 2074 6162  .            tab
-0000a080: 6c65 5f65 7870 7265 7373 696f 6e5b 636f  le_expression[co
-0000a090: 6c5d 0a20 2020 2020 2020 2020 2020 2066  l].            f
-0000a0a0: 6f72 2063 6f6c 2069 6e20 7461 626c 655f  or col in table_
-0000a0b0: 6578 7072 6573 7369 6f6e 2e63 6f6c 756d  expression.colum
-0000a0c0: 6e73 0a20 2020 2020 2020 2020 2020 2069  ns.            i
-0000a0d0: 6620 636f 6c20 213d 206f 7264 6572 696e  f col != orderin
-0000a0e0: 675f 636f 6c0a 2020 2020 2020 2020 5d0a  g_col.        ].
-0000a0f0: 2020 2020 2020 2020 6172 7261 795f 7661          array_va
-0000a100: 6c75 6520 3d20 636f 7265 2e41 7272 6179  lue = core.Array
-0000a110: 5661 6c75 652e 6672 6f6d 5f69 6269 7328  Value.from_ibis(
-0000a120: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0000a130: 662c 0a20 2020 2020 2020 2020 2020 2074  f,.            t
-0000a140: 6162 6c65 5f65 7870 7265 7373 696f 6e2c  able_expression,
-0000a150: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
-0000a160: 756d 6e73 3d63 6f6c 756d 6e5f 7661 6c75  umns=column_valu
-0000a170: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
-0000a180: 6869 6464 656e 5f6f 7264 6572 696e 675f  hidden_ordering_
-0000a190: 636f 6c75 6d6e 733d 5b74 6162 6c65 5f65  columns=[table_e
-0000a1a0: 7870 7265 7373 696f 6e5b 6f72 6465 7269  xpression[orderi
-0000a1b0: 6e67 5f63 6f6c 5d5d 2c0a 2020 2020 2020  ng_col]],.      
-0000a1c0: 2020 2020 2020 6f72 6465 7269 6e67 3d6f        ordering=o
-0000a1d0: 7264 6572 696e 672c 0a20 2020 2020 2020  rdering,.       
-0000a1e0: 2029 0a0a 2020 2020 2020 2020 626c 6f63   )..        bloc
-0000a1f0: 6b20 3d20 626c 6f63 6b73 2e42 6c6f 636b  k = blocks.Block
-0000a200: 280a 2020 2020 2020 2020 2020 2020 6172  (.            ar
-0000a210: 7261 795f 7661 6c75 652c 0a20 2020 2020  ray_value,.     
-0000a220: 2020 2020 2020 2069 6e64 6578 5f63 6f6c         index_col
-0000a230: 756d 6e73 3d6e 6577 5f69 6478 5f69 6473  umns=new_idx_ids
-0000a240: 2c0a 2020 2020 2020 2020 2020 2020 636f  ,.            co
-0000a250: 6c75 6d6e 5f6c 6162 656c 733d 636f 6c5f  lumn_labels=col_
-0000a260: 696e 6465 782c 0a20 2020 2020 2020 2020  index,.         
-0000a270: 2020 2069 6e64 6578 5f6c 6162 656c 733d     index_labels=
-0000a280: 6964 785f 6c61 6265 6c73 2c0a 2020 2020  idx_labels,.    
-0000a290: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
-0000a2a0: 7475 726e 2064 6174 6166 7261 6d65 2e44  turn dataframe.D
-0000a2b0: 6174 6146 7261 6d65 2862 6c6f 636b 290a  ataFrame(block).
-0000a2c0: 0a20 2020 2064 6566 2072 6561 645f 6373  .    def read_cs
-0000a2d0: 7628 0a20 2020 2020 2020 2073 656c 662c  v(.        self,
-0000a2e0: 0a20 2020 2020 2020 2066 696c 6570 6174  .        filepat
-0000a2f0: 685f 6f72 5f62 7566 6665 723a 2073 7472  h_or_buffer: str
-0000a300: 207c 2049 4f5b 2262 7974 6573 225d 2c0a   | IO["bytes"],.
-0000a310: 2020 2020 2020 2020 2a2c 0a20 2020 2020          *,.     
-0000a320: 2020 2073 6570 3a20 4f70 7469 6f6e 616c     sep: Optional
-0000a330: 5b73 7472 5d20 3d20 222c 222c 0a20 2020  [str] = ",",.   
-0000a340: 2020 2020 2068 6561 6465 723a 204f 7074       header: Opt
-0000a350: 696f 6e61 6c5b 696e 745d 203d 2030 2c0a  ional[int] = 0,.
-0000a360: 2020 2020 2020 2020 6e61 6d65 733a 204f          names: O
-0000a370: 7074 696f 6e61 6c5b 0a20 2020 2020 2020  ptional[.       
-0000a380: 2020 2020 2055 6e69 6f6e 5b4d 7574 6162       Union[Mutab
-0000a390: 6c65 5365 7175 656e 6365 5b41 6e79 5d2c  leSequence[Any],
-0000a3a0: 206e 702e 6e64 6172 7261 795b 416e 792c   np.ndarray[Any,
-0000a3b0: 2041 6e79 5d2c 2054 7570 6c65 5b41 6e79   Any], Tuple[Any
-0000a3c0: 2c20 2e2e 2e5d 2c20 7261 6e67 655d 0a20  , ...], range]. 
-0000a3d0: 2020 2020 2020 205d 203d 204e 6f6e 652c         ] = None,
-0000a3e0: 0a20 2020 2020 2020 2069 6e64 6578 5f63  .        index_c
-0000a3f0: 6f6c 3a20 4f70 7469 6f6e 616c 5b0a 2020  ol: Optional[.  
-0000a400: 2020 2020 2020 2020 2020 556e 696f 6e5b            Union[
-0000a410: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a420: 2069 6e74 2c0a 2020 2020 2020 2020 2020   int,.          
-0000a430: 2020 2020 2020 7374 722c 0a20 2020 2020        str,.     
-0000a440: 2020 2020 2020 2020 2020 2053 6571 7565             Seque
-0000a450: 6e63 655b 556e 696f 6e5b 7374 722c 2069  nce[Union[str, i
-0000a460: 6e74 5d5d 2c0a 2020 2020 2020 2020 2020  nt]],.          
-0000a470: 2020 2020 2020 6269 6766 7261 6d65 732e        bigframes.
-0000a480: 656e 756d 732e 4465 6661 756c 7449 6e64  enums.DefaultInd
-0000a490: 6578 4b69 6e64 2c0a 2020 2020 2020 2020  exKind,.        
-0000a4a0: 2020 2020 2020 2020 4c69 7465 7261 6c5b          Literal[
-0000a4b0: 4661 6c73 655d 2c0a 2020 2020 2020 2020  False],.        
-0000a4c0: 2020 2020 5d0a 2020 2020 2020 2020 5d20      ].        ] 
-0000a4d0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-0000a4e0: 7573 6563 6f6c 733a 204f 7074 696f 6e61  usecols: Optiona
-0000a4f0: 6c5b 0a20 2020 2020 2020 2020 2020 2055  l[.            U
-0000a500: 6e69 6f6e 5b0a 2020 2020 2020 2020 2020  nion[.          
-0000a510: 2020 2020 2020 4d75 7461 626c 6553 6571        MutableSeq
-0000a520: 7565 6e63 655b 7374 725d 2c0a 2020 2020  uence[str],.    
-0000a530: 2020 2020 2020 2020 2020 2020 5475 706c              Tupl
-0000a540: 655b 7374 722c 202e 2e2e 5d2c 0a20 2020  e[str, ...],.   
-0000a550: 2020 2020 2020 2020 2020 2020 2053 6571               Seq
-0000a560: 7565 6e63 655b 696e 745d 2c0a 2020 2020  uence[int],.    
-0000a570: 2020 2020 2020 2020 2020 2020 7061 6e64              pand
-0000a580: 6173 2e53 6572 6965 732c 0a20 2020 2020  as.Series,.     
-0000a590: 2020 2020 2020 2020 2020 2070 616e 6461             panda
-0000a5a0: 732e 496e 6465 782c 0a20 2020 2020 2020  s.Index,.       
-0000a5b0: 2020 2020 2020 2020 206e 702e 6e64 6172           np.ndar
-0000a5c0: 7261 795b 416e 792c 2041 6e79 5d2c 0a20  ray[Any, Any],. 
-0000a5d0: 2020 2020 2020 2020 2020 2020 2020 2043                 C
-0000a5e0: 616c 6c61 626c 655b 5b41 6e79 5d2c 2062  allable[[Any], b
-0000a5f0: 6f6f 6c5d 2c0a 2020 2020 2020 2020 2020  ool],.          
-0000a600: 2020 5d0a 2020 2020 2020 2020 5d20 3d20    ].        ] = 
-0000a610: 4e6f 6e65 2c0a 2020 2020 2020 2020 6474  None,.        dt
-0000a620: 7970 653a 204f 7074 696f 6e61 6c5b 4469  ype: Optional[Di
-0000a630: 6374 5d20 3d20 4e6f 6e65 2c0a 2020 2020  ct] = None,.    
-0000a640: 2020 2020 656e 6769 6e65 3a20 4f70 7469      engine: Opti
-0000a650: 6f6e 616c 5b0a 2020 2020 2020 2020 2020  onal[.          
-0000a660: 2020 4c69 7465 7261 6c5b 2263 222c 2022    Literal["c", "
-0000a670: 7079 7468 6f6e 222c 2022 7079 6172 726f  python", "pyarro
-0000a680: 7722 2c20 2270 7974 686f 6e2d 6677 6622  w", "python-fwf"
-0000a690: 2c20 2262 6967 7175 6572 7922 5d0a 2020  , "bigquery"].  
-0000a6a0: 2020 2020 2020 5d20 3d20 4e6f 6e65 2c0a        ] = None,.
-0000a6b0: 2020 2020 2020 2020 656e 636f 6469 6e67          encoding
-0000a6c0: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
-0000a6d0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-0000a6e0: 2a2a 6b77 6172 6773 2c0a 2020 2020 2920  **kwargs,.    ) 
-0000a6f0: 2d3e 2064 6174 6166 7261 6d65 2e44 6174  -> dataframe.Dat
-0000a700: 6146 7261 6d65 3a0a 2020 2020 2020 2020  aFrame:.        
-0000a710: 7461 626c 6520 3d20 7365 6c66 2e5f 7261  table = self._ra
-0000a720: 6e64 6f6d 5f74 6162 6c65 2829 0a0a 2020  ndom_table()..  
-0000a730: 2020 2020 2020 6966 2065 6e67 696e 6520        if engine 
-0000a740: 6973 206e 6f74 204e 6f6e 6520 616e 6420  is not None and 
-0000a750: 656e 6769 6e65 203d 3d20 2262 6967 7175  engine == "bigqu
-0000a760: 6572 7922 3a0a 2020 2020 2020 2020 2020  ery":.          
-0000a770: 2020 6966 2061 6e79 2870 6172 616d 2069    if any(param i
-0000a780: 7320 6e6f 7420 4e6f 6e65 2066 6f72 2070  s not None for p
-0000a790: 6172 616d 2069 6e20 2864 7479 7065 2c20  aram in (dtype, 
-0000a7a0: 6e61 6d65 7329 293a 0a20 2020 2020 2020  names)):.       
-0000a7b0: 2020 2020 2020 2020 206e 6f74 5f73 7570           not_sup
-0000a7c0: 706f 7274 6564 203d 2028 2264 7479 7065  ported = ("dtype
-0000a7d0: 222c 2022 6e61 6d65 7322 290a 2020 2020  ", "names").    
-0000a7e0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0000a7f0: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
-0000a800: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-0000a810: 2020 2020 2020 2020 2020 2066 2242 6967             f"Big
-0000a820: 5175 6572 7920 656e 6769 6e65 2064 6f65  Query engine doe
-0000a830: 7320 6e6f 7420 7375 7070 6f72 7420 7468  s not support th
-0000a840: 6573 6520 6172 6775 6d65 6e74 733a 207b  ese arguments: {
-0000a850: 6e6f 745f 7375 7070 6f72 7465 647d 2e20  not_supported}. 
-0000a860: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0000a870: 2020 2020 2020 6622 7b63 6f6e 7374 616e        f"{constan
-0000a880: 7473 2e46 4545 4442 4143 4b5f 4c49 4e4b  ts.FEEDBACK_LINK
-0000a890: 7d22 0a20 2020 2020 2020 2020 2020 2020  }".             
-0000a8a0: 2020 2029 0a0a 2020 2020 2020 2020 2020     )..          
-0000a8b0: 2020 2320 544f 444f 2862 2f33 3338 3038    # TODO(b/33808
-0000a8c0: 3936 3539 293a 204c 6f6f 6b73 206c 696b  9659): Looks lik
-0000a8d0: 6520 7765 2063 616e 2072 656c 6178 2074  e we can relax t
-0000a8e0: 6869 7320 3120 636f 6c75 6d6e 0a20 2020  his 1 column.   
-0000a8f0: 2020 2020 2020 2020 2023 2072 6573 7472           # restr
-0000a900: 6963 7469 6f6e 2069 6620 7765 2063 6865  iction if we che
-0000a910: 636b 2074 6865 2063 6f6e 7465 6e74 7320  ck the contents 
-0000a920: 6f66 2061 6e20 6974 6572 6162 6c65 2061  of an iterable a
-0000a930: 7265 2073 7472 696e 6773 0a20 2020 2020  re strings.     
-0000a940: 2020 2020 2020 2023 206e 6f74 2069 6e74         # not int
-0000a950: 6567 6572 732e 0a20 2020 2020 2020 2020  egers..         
-0000a960: 2020 2069 6620 280a 2020 2020 2020 2020     if (.        
-0000a970: 2020 2020 2020 2020 2320 456d 7074 7920          # Empty 
-0000a980: 7475 706c 6573 2c20 4e6f 6e65 2c20 616e  tuples, None, an
-0000a990: 6420 4661 6c73 6520 6172 6520 616c 6c6f  d False are allo
-0000a9a0: 7765 6420 616e 6420 6661 6c73 6579 2e0a  wed and falsey..
-0000a9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a9c0: 696e 6465 785f 636f 6c0a 2020 2020 2020  index_col.      
-0000a9d0: 2020 2020 2020 2020 2020 616e 6420 6e6f            and no
-0000a9e0: 7420 6973 696e 7374 616e 6365 2869 6e64  t isinstance(ind
-0000a9f0: 6578 5f63 6f6c 2c20 6269 6766 7261 6d65  ex_col, bigframe
-0000aa00: 732e 656e 756d 732e 4465 6661 756c 7449  s.enums.DefaultI
-0000aa10: 6e64 6578 4b69 6e64 290a 2020 2020 2020  ndexKind).      
-0000aa20: 2020 2020 2020 2020 2020 616e 6420 6e6f            and no
-0000aa30: 7420 6973 696e 7374 616e 6365 2869 6e64  t isinstance(ind
-0000aa40: 6578 5f63 6f6c 2c20 7374 7229 0a20 2020  ex_col, str).   
-0000aa50: 2020 2020 2020 2020 2029 3a0a 2020 2020           ):.    
-0000aa60: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0000aa70: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
-0000aa80: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-0000aa90: 2020 2020 2020 2020 2020 2022 4269 6751             "BigQ
-0000aaa0: 7565 7279 2065 6e67 696e 6520 6f6e 6c79  uery engine only
-0000aab0: 2073 7570 706f 7274 7320 6120 7369 6e67   supports a sing
-0000aac0: 6c65 2063 6f6c 756d 6e20 6e61 6d65 2066  le column name f
-0000aad0: 6f72 2060 696e 6465 785f 636f 6c60 2c20  or `index_col`, 
-0000aae0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0000aaf0: 2020 2020 2020 6622 676f 743a 207b 7265        f"got: {re
-0000ab00: 7072 2869 6e64 6578 5f63 6f6c 297d 2e20  pr(index_col)}. 
-0000ab10: 7b63 6f6e 7374 616e 7473 2e46 4545 4442  {constants.FEEDB
-0000ab20: 4143 4b5f 4c49 4e4b 7d22 0a20 2020 2020  ACK_LINK}".     
-0000ab30: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-0000ab40: 2020 2020 2020 2020 2020 2320 4e6f 6e65            # None
-0000ab50: 2061 6e64 2046 616c 7365 2063 616e 6e6f   and False canno
-0000ab60: 7420 6265 2070 6173 7365 6420 746f 2072  t be passed to r
-0000ab70: 6561 645f 6762 712e 0a20 2020 2020 2020  ead_gbq..       
-0000ab80: 2020 2020 2023 2054 4f44 4f28 622f 3333       # TODO(b/33
-0000ab90: 3834 3030 3133 3329 3a20 5768 656e 2069  8400133): When i
-0000aba0: 6e64 6578 5f63 6f6c 2069 7320 4e6f 6e65  ndex_col is None
-0000abb0: 2c20 7765 2073 686f 756c 6420 6265 2075  , we should be u
-0000abc0: 7369 6e67 2074 6865 0a20 2020 2020 2020  sing the.       
-0000abd0: 2020 2020 2023 2066 6972 7374 2063 6f6c       # first col
-0000abe0: 756d 6e20 6f66 2074 6865 2043 5356 2061  umn of the CSV a
-0000abf0: 7320 7468 6520 696e 6465 7820 746f 2062  s the index to b
-0000ac00: 6520 636f 6d70 6174 6962 6c65 2077 6974  e compatible wit
-0000ac10: 6820 7468 650a 2020 2020 2020 2020 2020  h the.          
-0000ac20: 2020 2320 7061 6e64 6173 2065 6e67 696e    # pandas engin
-0000ac30: 652e 2041 6363 6f72 6469 6e67 2074 6f20  e. According to 
-0000ac40: 7468 6520 7061 6e64 6173 2064 6f63 732c  the pandas docs,
-0000ac50: 206f 6e6c 7920 2246 616c 7365 220a 2020   only "False".  
-0000ac60: 2020 2020 2020 2020 2020 2320 696e 6469            # indi
-0000ac70: 6361 7465 7320 6120 6465 6661 756c 7420  cates a default 
-0000ac80: 7365 7175 656e 7469 616c 2069 6e64 6578  sequential index
-0000ac90: 2e0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-0000aca0: 206e 6f74 2069 6e64 6578 5f63 6f6c 3a0a   not index_col:.
-0000acb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000acc0: 696e 6465 785f 636f 6c20 3d20 2829 0a0a  index_col = ()..
-0000acd0: 2020 2020 2020 2020 2020 2020 696e 6465              inde
-0000ace0: 785f 636f 6c20 3d20 7479 7069 6e67 2e63  x_col = typing.c
-0000acf0: 6173 7428 0a20 2020 2020 2020 2020 2020  ast(.           
-0000ad00: 2020 2020 2055 6e69 6f6e 5b0a 2020 2020       Union[.    
-0000ad10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ad20: 5365 7175 656e 6365 5b73 7472 5d2c 2020  Sequence[str],  
-0000ad30: 2320 4661 6c73 6579 2076 616c 7565 730a  # Falsey values.
-0000ad40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ad50: 2020 2020 6269 6766 7261 6d65 732e 656e      bigframes.en
-0000ad60: 756d 732e 4465 6661 756c 7449 6e64 6578  ums.DefaultIndex
-0000ad70: 4b69 6e64 2c0a 2020 2020 2020 2020 2020  Kind,.          
-0000ad80: 2020 2020 2020 2020 2020 7374 722c 0a20            str,. 
-0000ad90: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
-0000ada0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000adb0: 2020 696e 6465 785f 636f 6c2c 0a20 2020    index_col,.   
-0000adc0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-0000add0: 2020 2020 2020 2020 2320 7573 6563 6f6c          # usecol
-0000ade0: 7320 7368 6f75 6c64 206f 6e6c 7920 6265  s should only be
-0000adf0: 2061 6e20 6974 6572 6162 6c65 206f 6620   an iterable of 
-0000ae00: 7374 7269 6e67 7320 2863 6f6c 756d 6e20  strings (column 
-0000ae10: 6e61 6d65 7329 2066 6f72 2075 7365 2061  names) for use a
-0000ae20: 7320 636f 6c75 6d6e 7320 696e 2072 6561  s columns in rea
-0000ae30: 645f 6762 712e 0a20 2020 2020 2020 2020  d_gbq..         
-0000ae40: 2020 2063 6f6c 756d 6e73 3a20 5475 706c     columns: Tupl
-0000ae50: 655b 416e 792c 202e 2e2e 5d20 3d20 7475  e[Any, ...] = tu
-0000ae60: 706c 6528 290a 2020 2020 2020 2020 2020  ple().          
-0000ae70: 2020 6966 2075 7365 636f 6c73 2069 7320    if usecols is 
-0000ae80: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-0000ae90: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
-0000aea0: 6e73 7461 6e63 6528 7573 6563 6f6c 732c  nstance(usecols,
-0000aeb0: 2049 7465 7261 626c 6529 2061 6e64 2061   Iterable) and a
-0000aec0: 6c6c 280a 2020 2020 2020 2020 2020 2020  ll(.            
-0000aed0: 2020 2020 2020 2020 6973 696e 7374 616e          isinstan
-0000aee0: 6365 2863 6f6c 2c20 7374 7229 2066 6f72  ce(col, str) for
-0000aef0: 2063 6f6c 2069 6e20 7573 6563 6f6c 730a   col in usecols.
-0000af00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000af10: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-0000af20: 2020 2020 2020 2063 6f6c 756d 6e73 203d         columns =
-0000af30: 2074 7570 6c65 2863 6f6c 2066 6f72 2063   tuple(col for c
-0000af40: 6f6c 2069 6e20 7573 6563 6f6c 7329 0a20  ol in usecols). 
-0000af50: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0000af60: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0000af70: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
-0000af80: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
-0000af90: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-0000afa0: 2020 2020 2020 2020 2020 2020 2242 6967              "Big
-0000afb0: 5175 6572 7920 656e 6769 6e65 206f 6e6c  Query engine onl
-0000afc0: 7920 7375 7070 6f72 7473 2061 6e20 6974  y supports an it
-0000afd0: 6572 6162 6c65 206f 6620 7374 7269 6e67  erable of string
-0000afe0: 7320 666f 7220 6075 7365 636f 6c73 602e  s for `usecols`.
-0000aff0: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
-0000b000: 2020 2020 2020 2020 2020 2066 227b 636f             f"{co
-0000b010: 6e73 7461 6e74 732e 4645 4544 4241 434b  nstants.FEEDBACK
-0000b020: 5f4c 494e 4b7d 220a 2020 2020 2020 2020  _LINK}".        
-0000b030: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-0000b040: 2020 2020 2020 2020 2020 2069 6620 656e             if en
-0000b050: 636f 6469 6e67 2069 7320 6e6f 7420 4e6f  coding is not No
-0000b060: 6e65 2061 6e64 2065 6e63 6f64 696e 6720  ne and encoding 
-0000b070: 6e6f 7420 696e 205f 5641 4c49 445f 454e  not in _VALID_EN
-0000b080: 434f 4449 4e47 533a 0a20 2020 2020 2020  CODINGS:.       
-0000b090: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
-0000b0a0: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
-0000b0b0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-0000b0c0: 2020 2020 2020 2020 6622 4269 6751 7565          f"BigQue
-0000b0d0: 7279 2065 6e67 696e 6520 6f6e 6c79 2073  ry engine only s
-0000b0e0: 7570 706f 7274 7320 7468 6520 666f 6c6c  upports the foll
-0000b0f0: 6f77 696e 6720 656e 636f 6469 6e67 733a  owing encodings:
-0000b100: 207b 5f56 414c 4944 5f45 4e43 4f44 494e   {_VALID_ENCODIN
-0000b110: 4753 7d2e 2022 0a20 2020 2020 2020 2020  GS}. ".         
-0000b120: 2020 2020 2020 2020 2020 2066 227b 636f             f"{co
-0000b130: 6e73 7461 6e74 732e 4645 4544 4241 434b  nstants.FEEDBACK
-0000b140: 5f4c 494e 4b7d 220a 2020 2020 2020 2020  _LINK}".        
-0000b150: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-0000b160: 2020 2020 2020 206a 6f62 5f63 6f6e 6669         job_confi
-0000b170: 6720 3d20 7365 6c66 2e5f 7072 6570 6172  g = self._prepar
-0000b180: 655f 6c6f 6164 5f6a 6f62 5f63 6f6e 6669  e_load_job_confi
-0000b190: 6728 290a 2020 2020 2020 2020 2020 2020  g().            
-0000b1a0: 6a6f 625f 636f 6e66 6967 2e63 7265 6174  job_config.creat
-0000b1b0: 655f 6469 7370 6f73 6974 696f 6e20 3d20  e_disposition = 
-0000b1c0: 6269 6771 7565 7279 2e43 7265 6174 6544  bigquery.CreateD
-0000b1d0: 6973 706f 7369 7469 6f6e 2e43 5245 4154  isposition.CREAT
-0000b1e0: 455f 4946 5f4e 4545 4445 440a 2020 2020  E_IF_NEEDED.    
-0000b1f0: 2020 2020 2020 2020 6a6f 625f 636f 6e66          job_conf
-0000b200: 6967 2e73 6f75 7263 655f 666f 726d 6174  ig.source_format
-0000b210: 203d 2062 6967 7175 6572 792e 536f 7572   = bigquery.Sour
-0000b220: 6365 466f 726d 6174 2e43 5356 0a20 2020  ceFormat.CSV.   
-0000b230: 2020 2020 2020 2020 206a 6f62 5f63 6f6e           job_con
-0000b240: 6669 672e 7772 6974 655f 6469 7370 6f73  fig.write_dispos
-0000b250: 6974 696f 6e20 3d20 6269 6771 7565 7279  ition = bigquery
-0000b260: 2e57 7269 7465 4469 7370 6f73 6974 696f  .WriteDispositio
-0000b270: 6e2e 5752 4954 455f 454d 5054 590a 2020  n.WRITE_EMPTY.  
-0000b280: 2020 2020 2020 2020 2020 6a6f 625f 636f            job_co
-0000b290: 6e66 6967 2e61 7574 6f64 6574 6563 7420  nfig.autodetect 
-0000b2a0: 3d20 5472 7565 0a20 2020 2020 2020 2020  = True.         
-0000b2b0: 2020 206a 6f62 5f63 6f6e 6669 672e 6669     job_config.fi
-0000b2c0: 656c 645f 6465 6c69 6d69 7465 7220 3d20  eld_delimiter = 
-0000b2d0: 7365 700a 2020 2020 2020 2020 2020 2020  sep.            
-0000b2e0: 6a6f 625f 636f 6e66 6967 2e65 6e63 6f64  job_config.encod
-0000b2f0: 696e 6720 3d20 656e 636f 6469 6e67 0a20  ing = encoding. 
-0000b300: 2020 2020 2020 2020 2020 206a 6f62 5f63             job_c
-0000b310: 6f6e 6669 672e 6c61 6265 6c73 203d 207b  onfig.labels = {
-0000b320: 2262 6967 6672 616d 6573 2d61 7069 223a  "bigframes-api":
-0000b330: 2022 7265 6164 5f63 7376 227d 0a0a 2020   "read_csv"}..  
-0000b340: 2020 2020 2020 2020 2020 2320 5765 2077            # We w
-0000b350: 616e 7420 746f 206d 6174 6368 2070 616e  ant to match pan
-0000b360: 6461 7320 6265 6861 7669 6f72 2e20 4966  das behavior. If
-0000b370: 2068 6561 6465 7220 6973 2030 2c20 6e6f   header is 0, no
-0000b380: 2072 6f77 7320 7368 6f75 6c64 2062 6520   rows should be 
-0000b390: 736b 6970 7065 642c 2073 6f20 7765 0a20  skipped, so we. 
-0000b3a0: 2020 2020 2020 2020 2020 2023 2064 6f20             # do 
-0000b3b0: 6e6f 7420 6e65 6564 2074 6f20 7365 7420  not need to set 
-0000b3c0: 6073 6b69 705f 6c65 6164 696e 675f 726f  `skip_leading_ro
-0000b3d0: 7773 602e 2049 6620 6865 6164 6572 2069  ws`. If header i
-0000b3e0: 7320 4e6f 6e65 2c20 7468 656e 2074 6865  s None, then the
-0000b3f0: 7265 2069 7320 6e6f 2068 6561 6465 722e  re is no header.
-0000b400: 0a20 2020 2020 2020 2020 2020 2023 2053  .            # S
-0000b410: 6574 7469 6e67 2073 6b69 705f 6c65 6164  etting skip_lead
-0000b420: 696e 675f 726f 7773 2074 6f20 3020 646f  ing_rows to 0 do
-0000b430: 6573 2074 6861 742e 2049 6620 6865 6164  es that. If head
-0000b440: 6572 3d4e 2061 6e64 204e 3e30 2c20 7765  er=N and N>0, we
-0000b450: 2077 616e 7420 746f 2073 6b69 7020 4e20   want to skip N 
-0000b460: 726f 7773 2e0a 2020 2020 2020 2020 2020  rows..          
-0000b470: 2020 6966 2068 6561 6465 7220 6973 204e    if header is N
-0000b480: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-0000b490: 2020 2020 206a 6f62 5f63 6f6e 6669 672e       job_config.
-0000b4a0: 736b 6970 5f6c 6561 6469 6e67 5f72 6f77  skip_leading_row
-0000b4b0: 7320 3d20 300a 2020 2020 2020 2020 2020  s = 0.          
-0000b4c0: 2020 656c 6966 2068 6561 6465 7220 3e20    elif header > 
-0000b4d0: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
-0000b4e0: 2020 206a 6f62 5f63 6f6e 6669 672e 736b     job_config.sk
-0000b4f0: 6970 5f6c 6561 6469 6e67 5f72 6f77 7320  ip_leading_rows 
-0000b500: 3d20 6865 6164 6572 0a0a 2020 2020 2020  = header..      
-0000b510: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0000b520: 662e 5f72 6561 645f 6269 6771 7565 7279  f._read_bigquery
-0000b530: 5f6c 6f61 645f 6a6f 6228 0a20 2020 2020  _load_job(.     
-0000b540: 2020 2020 2020 2020 2020 2066 696c 6570             filep
-0000b550: 6174 685f 6f72 5f62 7566 6665 722c 0a20  ath_or_buffer,. 
-0000b560: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-0000b570: 6162 6c65 2c0a 2020 2020 2020 2020 2020  able,.          
-0000b580: 2020 2020 2020 6a6f 625f 636f 6e66 6967        job_config
-0000b590: 3d6a 6f62 5f63 6f6e 6669 672c 0a20 2020  =job_config,.   
-0000b5a0: 2020 2020 2020 2020 2020 2020 2069 6e64               ind
-0000b5b0: 6578 5f63 6f6c 3d69 6e64 6578 5f63 6f6c  ex_col=index_col
-0000b5c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000b5d0: 2020 636f 6c75 6d6e 733d 636f 6c75 6d6e    columns=column
-0000b5e0: 732c 0a20 2020 2020 2020 2020 2020 2029  s,.            )
-0000b5f0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-0000b600: 2020 2020 2020 2020 2020 2069 6620 6973             if is
-0000b610: 696e 7374 616e 6365 2869 6e64 6578 5f63  instance(index_c
-0000b620: 6f6c 2c20 6269 6766 7261 6d65 732e 656e  ol, bigframes.en
-0000b630: 756d 732e 4465 6661 756c 7449 6e64 6578  ums.DefaultIndex
-0000b640: 4b69 6e64 293a 0a20 2020 2020 2020 2020  Kind):.         
-0000b650: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
-0000b660: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
-0000b670: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0000b680: 2020 2020 2020 6622 5769 7468 2069 6e64        f"With ind
-0000b690: 6578 5f63 6f6c 3d7b 7265 7072 2869 6e64  ex_col={repr(ind
-0000b6a0: 6578 5f63 6f6c 297d 2c20 6f6e 6c79 2065  ex_col)}, only e
-0000b6b0: 6e67 696e 653d 2762 6967 7175 6572 7927  ngine='bigquery'
-0000b6c0: 2069 7320 7375 7070 6f72 7465 642e 2022   is supported. "
-0000b6d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b6e0: 2020 2020 2066 227b 636f 6e73 7461 6e74       f"{constant
-0000b6f0: 732e 4645 4544 4241 434b 5f4c 494e 4b7d  s.FEEDBACK_LINK}
-0000b700: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0000b710: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-0000b720: 6966 2061 6e79 2861 7267 2069 6e20 6b77  if any(arg in kw
-0000b730: 6172 6773 2066 6f72 2061 7267 2069 6e20  args for arg in 
-0000b740: 2822 6368 756e 6b73 697a 6522 2c20 2269  ("chunksize", "i
-0000b750: 7465 7261 746f 7222 2929 3a0a 2020 2020  terator")):.    
-0000b760: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0000b770: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
-0000b780: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-0000b790: 2020 2020 2020 2020 2020 2022 2763 6875             "'chu
-0000b7a0: 6e6b 7369 7a65 2720 616e 6420 2769 7465  nksize' and 'ite
-0000b7b0: 7261 746f 7227 2061 7267 756d 656e 7473  rator' arguments
-0000b7c0: 2061 7265 206e 6f74 2073 7570 706f 7274   are not support
-0000b7d0: 6564 2e20 220a 2020 2020 2020 2020 2020  ed. ".          
-0000b7e0: 2020 2020 2020 2020 2020 6622 7b63 6f6e            f"{con
-0000b7f0: 7374 616e 7473 2e46 4545 4442 4143 4b5f  stants.FEEDBACK_
-0000b800: 4c49 4e4b 7d22 0a20 2020 2020 2020 2020  LINK}".         
-0000b810: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-0000b820: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-0000b830: 6e63 6528 6669 6c65 7061 7468 5f6f 725f  nce(filepath_or_
-0000b840: 6275 6666 6572 2c20 7374 7229 3a0a 2020  buffer, str):.  
-0000b850: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0000b860: 6c66 2e5f 6368 6563 6b5f 6669 6c65 5f73  lf._check_file_s
-0000b870: 697a 6528 6669 6c65 7061 7468 5f6f 725f  ize(filepath_or_
-0000b880: 6275 6666 6572 290a 2020 2020 2020 2020  buffer).        
-0000b890: 2020 2020 7061 6e64 6173 5f64 6620 3d20      pandas_df = 
-0000b8a0: 7061 6e64 6173 2e72 6561 645f 6373 7628  pandas.read_csv(
-0000b8b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b8c0: 2066 696c 6570 6174 685f 6f72 5f62 7566   filepath_or_buf
-0000b8d0: 6665 722c 0a20 2020 2020 2020 2020 2020  fer,.           
-0000b8e0: 2020 2020 2073 6570 3d73 6570 2c0a 2020       sep=sep,.  
-0000b8f0: 2020 2020 2020 2020 2020 2020 2020 6865                he
-0000b900: 6164 6572 3d68 6561 6465 722c 0a20 2020  ader=header,.   
-0000b910: 2020 2020 2020 2020 2020 2020 206e 616d               nam
-0000b920: 6573 3d6e 616d 6573 2c0a 2020 2020 2020  es=names,.      
-0000b930: 2020 2020 2020 2020 2020 696e 6465 785f            index_
-0000b940: 636f 6c3d 696e 6465 785f 636f 6c2c 0a20  col=index_col,. 
-0000b950: 2020 2020 2020 2020 2020 2020 2020 2075                 u
-0000b960: 7365 636f 6c73 3d75 7365 636f 6c73 2c20  secols=usecols, 
-0000b970: 2023 2074 7970 653a 2069 676e 6f72 650a   # type: ignore.
-0000b980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b990: 6474 7970 653d 6474 7970 652c 0a20 2020  dtype=dtype,.   
-0000b9a0: 2020 2020 2020 2020 2020 2020 2065 6e67               eng
-0000b9b0: 696e 653d 656e 6769 6e65 2c0a 2020 2020  ine=engine,.    
-0000b9c0: 2020 2020 2020 2020 2020 2020 656e 636f              enco
-0000b9d0: 6469 6e67 3d65 6e63 6f64 696e 672c 0a20  ding=encoding,. 
-0000b9e0: 2020 2020 2020 2020 2020 2020 2020 202a                 *
-0000b9f0: 2a6b 7761 7267 732c 0a20 2020 2020 2020  *kwargs,.       
-0000ba00: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-0000ba10: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-0000ba20: 7265 6164 5f70 616e 6461 7328 7061 6e64  read_pandas(pand
-0000ba30: 6173 5f64 662c 2022 7265 6164 5f63 7376  as_df, "read_csv
-0000ba40: 2229 2020 2320 7479 7065 3a20 6967 6e6f  ")  # type: igno
-0000ba50: 7265 0a0a 2020 2020 6465 6620 7265 6164  re..    def read
-0000ba60: 5f70 6963 6b6c 6528 0a20 2020 2020 2020  _pickle(.       
-0000ba70: 2073 656c 662c 0a20 2020 2020 2020 2066   self,.        f
-0000ba80: 696c 6570 6174 685f 6f72 5f62 7566 6665  ilepath_or_buffe
-0000ba90: 723a 2046 696c 6550 6174 6820 7c20 5265  r: FilePath | Re
-0000baa0: 6164 5069 636b 6c65 4275 6666 6572 2c0a  adPickleBuffer,.
-0000bab0: 2020 2020 2020 2020 636f 6d70 7265 7373          compress
-0000bac0: 696f 6e3a 2043 6f6d 7072 6573 7369 6f6e  ion: Compression
-0000bad0: 4f70 7469 6f6e 7320 3d20 2269 6e66 6572  Options = "infer
-0000bae0: 222c 0a20 2020 2020 2020 2073 746f 7261  ",.        stora
-0000baf0: 6765 5f6f 7074 696f 6e73 3a20 5374 6f72  ge_options: Stor
-0000bb00: 6167 654f 7074 696f 6e73 203d 204e 6f6e  ageOptions = Non
-0000bb10: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
-0000bb20: 2020 7061 6e64 6173 5f6f 626a 203d 2070    pandas_obj = p
-0000bb30: 616e 6461 732e 7265 6164 5f70 6963 6b6c  andas.read_pickl
-0000bb40: 6528 0a20 2020 2020 2020 2020 2020 2066  e(.            f
-0000bb50: 696c 6570 6174 685f 6f72 5f62 7566 6665  ilepath_or_buffe
-0000bb60: 722c 0a20 2020 2020 2020 2020 2020 2063  r,.            c
-0000bb70: 6f6d 7072 6573 7369 6f6e 3d63 6f6d 7072  ompression=compr
-0000bb80: 6573 7369 6f6e 2c0a 2020 2020 2020 2020  ession,.        
-0000bb90: 2020 2020 7374 6f72 6167 655f 6f70 7469      storage_opti
-0000bba0: 6f6e 733d 7374 6f72 6167 655f 6f70 7469  ons=storage_opti
-0000bbb0: 6f6e 732c 0a20 2020 2020 2020 2029 0a0a  ons,.        )..
-0000bbc0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-0000bbd0: 7461 6e63 6528 7061 6e64 6173 5f6f 626a  tance(pandas_obj
-0000bbe0: 2c20 7061 6e64 6173 2e53 6572 6965 7329  , pandas.Series)
-0000bbf0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-0000bc00: 2070 616e 6461 735f 6f62 6a2e 6e61 6d65   pandas_obj.name
-0000bc10: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-0000bc20: 2020 2020 2020 2020 2020 7061 6e64 6173            pandas
-0000bc30: 5f6f 626a 2e6e 616d 6520 3d20 2230 220a  _obj.name = "0".
-0000bc40: 2020 2020 2020 2020 2020 2020 6269 6766              bigf
-0000bc50: 7261 6d65 735f 6466 203d 2073 656c 662e  rames_df = self.
-0000bc60: 5f72 6561 645f 7061 6e64 6173 2870 616e  _read_pandas(pan
-0000bc70: 6461 735f 6f62 6a2e 746f 5f66 7261 6d65  das_obj.to_frame
-0000bc80: 2829 2c20 2272 6561 645f 7069 636b 6c65  (), "read_pickle
-0000bc90: 2229 0a20 2020 2020 2020 2020 2020 2072  ").            r
-0000bca0: 6574 7572 6e20 6269 6766 7261 6d65 735f  eturn bigframes_
-0000bcb0: 6466 5b62 6967 6672 616d 6573 5f64 662e  df[bigframes_df.
-0000bcc0: 636f 6c75 6d6e 735b 305d 5d0a 2020 2020  columns[0]].    
-0000bcd0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0000bce0: 5f72 6561 645f 7061 6e64 6173 2870 616e  _read_pandas(pan
-0000bcf0: 6461 735f 6f62 6a2c 2022 7265 6164 5f70  das_obj, "read_p
-0000bd00: 6963 6b6c 6522 290a 0a20 2020 2064 6566  ickle")..    def
-0000bd10: 2072 6561 645f 7061 7271 7565 7428 0a20   read_parquet(. 
-0000bd20: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-0000bd30: 2020 2020 2070 6174 683a 2073 7472 207c       path: str |
-0000bd40: 2049 4f5b 2262 7974 6573 225d 2c0a 2020   IO["bytes"],.  
-0000bd50: 2020 2020 2020 2a2c 0a20 2020 2020 2020        *,.       
-0000bd60: 2065 6e67 696e 653a 2073 7472 203d 2022   engine: str = "
-0000bd70: 6175 746f 222c 0a20 2020 2029 202d 3e20  auto",.    ) -> 
-0000bd80: 6461 7461 6672 616d 652e 4461 7461 4672  dataframe.DataFr
-0000bd90: 616d 653a 0a20 2020 2020 2020 2074 6162  ame:.        tab
-0000bda0: 6c65 203d 2073 656c 662e 5f72 616e 646f  le = self._rando
-0000bdb0: 6d5f 7461 626c 6528 290a 0a20 2020 2020  m_table()..     
-0000bdc0: 2020 2069 6620 656e 6769 6e65 203d 3d20     if engine == 
-0000bdd0: 2262 6967 7175 6572 7922 3a0a 2020 2020  "bigquery":.    
-0000bde0: 2020 2020 2020 2020 6a6f 625f 636f 6e66          job_conf
-0000bdf0: 6967 203d 2073 656c 662e 5f70 7265 7061  ig = self._prepa
-0000be00: 7265 5f6c 6f61 645f 6a6f 625f 636f 6e66  re_load_job_conf
-0000be10: 6967 2829 0a20 2020 2020 2020 2020 2020  ig().           
-0000be20: 206a 6f62 5f63 6f6e 6669 672e 6372 6561   job_config.crea
-0000be30: 7465 5f64 6973 706f 7369 7469 6f6e 203d  te_disposition =
-0000be40: 2062 6967 7175 6572 792e 4372 6561 7465   bigquery.Create
-0000be50: 4469 7370 6f73 6974 696f 6e2e 4352 4541  Disposition.CREA
-0000be60: 5445 5f49 465f 4e45 4544 4544 0a20 2020  TE_IF_NEEDED.   
-0000be70: 2020 2020 2020 2020 206a 6f62 5f63 6f6e           job_con
-0000be80: 6669 672e 736f 7572 6365 5f66 6f72 6d61  fig.source_forma
-0000be90: 7420 3d20 6269 6771 7565 7279 2e53 6f75  t = bigquery.Sou
-0000bea0: 7263 6546 6f72 6d61 742e 5041 5251 5545  rceFormat.PARQUE
-0000beb0: 540a 2020 2020 2020 2020 2020 2020 6a6f  T.            jo
-0000bec0: 625f 636f 6e66 6967 2e77 7269 7465 5f64  b_config.write_d
-0000bed0: 6973 706f 7369 7469 6f6e 203d 2062 6967  isposition = big
-0000bee0: 7175 6572 792e 5772 6974 6544 6973 706f  query.WriteDispo
-0000bef0: 7369 7469 6f6e 2e57 5249 5445 5f45 4d50  sition.WRITE_EMP
-0000bf00: 5459 0a20 2020 2020 2020 2020 2020 206a  TY.            j
-0000bf10: 6f62 5f63 6f6e 6669 672e 6c61 6265 6c73  ob_config.labels
-0000bf20: 203d 207b 2262 6967 6672 616d 6573 2d61   = {"bigframes-a
-0000bf30: 7069 223a 2022 7265 6164 5f70 6172 7175  pi": "read_parqu
-0000bf40: 6574 227d 0a0a 2020 2020 2020 2020 2020  et"}..          
-0000bf50: 2020 7265 7475 726e 2073 656c 662e 5f72    return self._r
-0000bf60: 6561 645f 6269 6771 7565 7279 5f6c 6f61  ead_bigquery_loa
-0000bf70: 645f 6a6f 6228 7061 7468 2c20 7461 626c  d_job(path, tabl
-0000bf80: 652c 206a 6f62 5f63 6f6e 6669 673d 6a6f  e, job_config=jo
-0000bf90: 625f 636f 6e66 6967 290a 2020 2020 2020  b_config).      
-0000bfa0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0000bfb0: 2020 2020 7265 6164 5f70 6172 7175 6574      read_parquet
-0000bfc0: 5f6b 7761 7267 733a 2044 6963 745b 7374  _kwargs: Dict[st
-0000bfd0: 722c 2041 6e79 5d20 3d20 7b7d 0a20 2020  r, Any] = {}.   
-0000bfe0: 2020 2020 2020 2020 2069 6620 7061 6e64           if pand
-0000bff0: 6173 2e5f 5f76 6572 7369 6f6e 5f5f 2e73  as.__version__.s
-0000c000: 7461 7274 7377 6974 6828 2231 2e22 293a  tartswith("1."):
-0000c010: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000c020: 2072 6561 645f 7061 7271 7565 745f 6b77   read_parquet_kw
-0000c030: 6172 6773 5b22 7573 655f 6e75 6c6c 6162  args["use_nullab
-0000c040: 6c65 5f64 7479 7065 7322 5d20 3d20 5472  le_dtypes"] = Tr
-0000c050: 7565 0a20 2020 2020 2020 2020 2020 2065  ue.            e
-0000c060: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0000c070: 2020 2020 2072 6561 645f 7061 7271 7565       read_parque
-0000c080: 745f 6b77 6172 6773 5b22 6474 7970 655f  t_kwargs["dtype_
-0000c090: 6261 636b 656e 6422 5d20 3d20 2270 7961  backend"] = "pya
-0000c0a0: 7272 6f77 220a 0a20 2020 2020 2020 2020  rrow"..         
-0000c0b0: 2020 2070 616e 6461 735f 6f62 6a20 3d20     pandas_obj = 
-0000c0c0: 7061 6e64 6173 2e72 6561 645f 7061 7271  pandas.read_parq
-0000c0d0: 7565 7428 0a20 2020 2020 2020 2020 2020  uet(.           
-0000c0e0: 2020 2020 2070 6174 682c 0a20 2020 2020       path,.     
-0000c0f0: 2020 2020 2020 2020 2020 2065 6e67 696e             engin
-0000c100: 653d 656e 6769 6e65 2c20 2023 2074 7970  e=engine,  # typ
-0000c110: 653a 2069 676e 6f72 650a 2020 2020 2020  e: ignore.      
-0000c120: 2020 2020 2020 2020 2020 2a2a 7265 6164            **read
-0000c130: 5f70 6172 7175 6574 5f6b 7761 7267 732c  _parquet_kwargs,
-0000c140: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0000c150: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0000c160: 6e20 7365 6c66 2e5f 7265 6164 5f70 616e  n self._read_pan
-0000c170: 6461 7328 7061 6e64 6173 5f6f 626a 2c20  das(pandas_obj, 
-0000c180: 2272 6561 645f 7061 7271 7565 7422 290a  "read_parquet").
-0000c190: 0a20 2020 2064 6566 2072 6561 645f 6a73  .    def read_js
-0000c1a0: 6f6e 280a 2020 2020 2020 2020 7365 6c66  on(.        self
-0000c1b0: 2c0a 2020 2020 2020 2020 7061 7468 5f6f  ,.        path_o
-0000c1c0: 725f 6275 663a 2073 7472 207c 2049 4f5b  r_buf: str | IO[
-0000c1d0: 2262 7974 6573 225d 2c0a 2020 2020 2020  "bytes"],.      
-0000c1e0: 2020 2a2c 0a20 2020 2020 2020 206f 7269    *,.        ori
-0000c1f0: 656e 743a 204c 6974 6572 616c 5b0a 2020  ent: Literal[.  
-0000c200: 2020 2020 2020 2020 2020 2273 706c 6974            "split
-0000c210: 222c 2022 7265 636f 7264 7322 2c20 2269  ", "records", "i
-0000c220: 6e64 6578 222c 2022 636f 6c75 6d6e 7322  ndex", "columns"
-0000c230: 2c20 2276 616c 7565 7322 2c20 2274 6162  , "values", "tab
-0000c240: 6c65 220a 2020 2020 2020 2020 5d20 3d20  le".        ] = 
-0000c250: 2263 6f6c 756d 6e73 222c 0a20 2020 2020  "columns",.     
-0000c260: 2020 2064 7479 7065 3a20 4f70 7469 6f6e     dtype: Option
-0000c270: 616c 5b44 6963 745d 203d 204e 6f6e 652c  al[Dict] = None,
-0000c280: 0a20 2020 2020 2020 2065 6e63 6f64 696e  .        encodin
-0000c290: 673a 204f 7074 696f 6e61 6c5b 7374 725d  g: Optional[str]
-0000c2a0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-0000c2b0: 206c 696e 6573 3a20 626f 6f6c 203d 2046   lines: bool = F
-0000c2c0: 616c 7365 2c0a 2020 2020 2020 2020 656e  alse,.        en
-0000c2d0: 6769 6e65 3a20 4c69 7465 7261 6c5b 2275  gine: Literal["u
-0000c2e0: 6a73 6f6e 222c 2022 7079 6172 726f 7722  json", "pyarrow"
-0000c2f0: 2c20 2262 6967 7175 6572 7922 5d20 3d20  , "bigquery"] = 
-0000c300: 2275 6a73 6f6e 222c 0a20 2020 2020 2020  "ujson",.       
-0000c310: 202a 2a6b 7761 7267 732c 0a20 2020 2029   **kwargs,.    )
-0000c320: 202d 3e20 6461 7461 6672 616d 652e 4461   -> dataframe.Da
-0000c330: 7461 4672 616d 653a 0a20 2020 2020 2020  taFrame:.       
-0000c340: 2074 6162 6c65 203d 2073 656c 662e 5f72   table = self._r
-0000c350: 616e 646f 6d5f 7461 626c 6528 290a 0a20  andom_table().. 
-0000c360: 2020 2020 2020 2069 6620 656e 6769 6e65         if engine
-0000c370: 203d 3d20 2262 6967 7175 6572 7922 3a0a   == "bigquery":.
-0000c380: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0000c390: 6474 7970 6520 6973 206e 6f74 204e 6f6e  dtype is not Non
-0000c3a0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-0000c3b0: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
-0000c3c0: 656d 656e 7465 6445 7272 6f72 280a 2020  ementedError(.  
-0000c3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c3e0: 2020 2242 6967 5175 6572 7920 656e 6769    "BigQuery engi
-0000c3f0: 6e65 2064 6f65 7320 6e6f 7420 7375 7070  ne does not supp
-0000c400: 6f72 7420 7468 6520 6474 7970 6520 6172  ort the dtype ar
-0000c410: 6775 6d65 6e74 732e 220a 2020 2020 2020  guments.".      
-0000c420: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-0000c430: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
-0000c440: 6c69 6e65 733a 0a20 2020 2020 2020 2020  lines:.         
-0000c450: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
-0000c460: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
-0000c470: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0000c480: 2020 2020 2020 224f 6e6c 7920 6e65 776c        "Only newl
-0000c490: 696e 6520 6465 6c69 6d69 7465 6420 4a53  ine delimited JS
-0000c4a0: 4f4e 2066 6f72 6d61 7420 6973 2073 7570  ON format is sup
-0000c4b0: 706f 7274 6564 2e22 0a20 2020 2020 2020  ported.".       
-0000c4c0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-0000c4d0: 2020 2020 2020 2020 6966 2065 6e63 6f64          if encod
-0000c4e0: 696e 6720 6973 206e 6f74 204e 6f6e 6520  ing is not None 
-0000c4f0: 616e 6420 656e 636f 6469 6e67 206e 6f74  and encoding not
-0000c500: 2069 6e20 5f56 414c 4944 5f45 4e43 4f44   in _VALID_ENCOD
-0000c510: 494e 4753 3a0a 2020 2020 2020 2020 2020  INGS:.          
-0000c520: 2020 2020 2020 7261 6973 6520 4e6f 7449        raise NotI
-0000c530: 6d70 6c65 6d65 6e74 6564 4572 726f 7228  mplementedError(
-0000c540: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000c550: 2020 2020 2066 2242 6967 5175 6572 7920       f"BigQuery 
-0000c560: 656e 6769 6e65 206f 6e6c 7920 7375 7070  engine only supp
-0000c570: 6f72 7473 2074 6865 2066 6f6c 6c6f 7769  orts the followi
-0000c580: 6e67 2065 6e63 6f64 696e 6773 3a20 7b5f  ng encodings: {_
-0000c590: 5641 4c49 445f 454e 434f 4449 4e47 537d  VALID_ENCODINGS}
-0000c5a0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0000c5b0: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
-0000c5c0: 2069 6620 6c69 6e65 7320 616e 6420 6f72   if lines and or
-0000c5d0: 6965 6e74 2021 3d20 2272 6563 6f72 6473  ient != "records
-0000c5e0: 223a 0a20 2020 2020 2020 2020 2020 2020  ":.             
-0000c5f0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-0000c600: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-0000c610: 2020 2020 2020 2020 2022 276c 696e 6573           "'lines
-0000c620: 2720 6b65 7977 6f72 6420 6973 206f 6e6c  ' keyword is onl
-0000c630: 7920 7661 6c69 6420 7768 656e 2027 6f72  y valid when 'or
-0000c640: 6965 6e74 2720 6973 2027 7265 636f 7264  ient' is 'record
-0000c650: 7327 2e22 0a20 2020 2020 2020 2020 2020  s'.".           
-0000c660: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-0000c670: 2020 2020 6a6f 625f 636f 6e66 6967 203d      job_config =
-0000c680: 2073 656c 662e 5f70 7265 7061 7265 5f6c   self._prepare_l
-0000c690: 6f61 645f 6a6f 625f 636f 6e66 6967 2829  oad_job_config()
-0000c6a0: 0a20 2020 2020 2020 2020 2020 206a 6f62  .            job
-0000c6b0: 5f63 6f6e 6669 672e 6372 6561 7465 5f64  _config.create_d
-0000c6c0: 6973 706f 7369 7469 6f6e 203d 2062 6967  isposition = big
-0000c6d0: 7175 6572 792e 4372 6561 7465 4469 7370  query.CreateDisp
-0000c6e0: 6f73 6974 696f 6e2e 4352 4541 5445 5f49  osition.CREATE_I
-0000c6f0: 465f 4e45 4544 4544 0a20 2020 2020 2020  F_NEEDED.       
-0000c700: 2020 2020 206a 6f62 5f63 6f6e 6669 672e       job_config.
-0000c710: 736f 7572 6365 5f66 6f72 6d61 7420 3d20  source_format = 
-0000c720: 6269 6771 7565 7279 2e53 6f75 7263 6546  bigquery.SourceF
-0000c730: 6f72 6d61 742e 4e45 574c 494e 455f 4445  ormat.NEWLINE_DE
-0000c740: 4c49 4d49 5445 445f 4a53 4f4e 0a20 2020  LIMITED_JSON.   
-0000c750: 2020 2020 2020 2020 206a 6f62 5f63 6f6e           job_con
-0000c760: 6669 672e 7772 6974 655f 6469 7370 6f73  fig.write_dispos
-0000c770: 6974 696f 6e20 3d20 6269 6771 7565 7279  ition = bigquery
-0000c780: 2e57 7269 7465 4469 7370 6f73 6974 696f  .WriteDispositio
-0000c790: 6e2e 5752 4954 455f 454d 5054 590a 2020  n.WRITE_EMPTY.  
-0000c7a0: 2020 2020 2020 2020 2020 6a6f 625f 636f            job_co
-0000c7b0: 6e66 6967 2e61 7574 6f64 6574 6563 7420  nfig.autodetect 
-0000c7c0: 3d20 5472 7565 0a20 2020 2020 2020 2020  = True.         
-0000c7d0: 2020 206a 6f62 5f63 6f6e 6669 672e 656e     job_config.en
-0000c7e0: 636f 6469 6e67 203d 2065 6e63 6f64 696e  coding = encodin
-0000c7f0: 670a 2020 2020 2020 2020 2020 2020 6a6f  g.            jo
-0000c800: 625f 636f 6e66 6967 2e6c 6162 656c 7320  b_config.labels 
-0000c810: 3d20 7b22 6269 6766 7261 6d65 732d 6170  = {"bigframes-ap
-0000c820: 6922 3a20 2272 6561 645f 6a73 6f6e 227d  i": "read_json"}
-0000c830: 0a0a 2020 2020 2020 2020 2020 2020 7265  ..            re
-0000c840: 7475 726e 2073 656c 662e 5f72 6561 645f  turn self._read_
-0000c850: 6269 6771 7565 7279 5f6c 6f61 645f 6a6f  bigquery_load_jo
-0000c860: 6228 0a20 2020 2020 2020 2020 2020 2020  b(.             
-0000c870: 2020 2070 6174 685f 6f72 5f62 7566 2c0a     path_or_buf,.
-0000c880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c890: 7461 626c 652c 0a20 2020 2020 2020 2020  table,.         
-0000c8a0: 2020 2020 2020 206a 6f62 5f63 6f6e 6669         job_confi
-0000c8b0: 673d 6a6f 625f 636f 6e66 6967 2c0a 2020  g=job_config,.  
-0000c8c0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0000c8d0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0000c8e0: 2020 2020 2020 6966 2061 6e79 2861 7267        if any(arg
-0000c8f0: 2069 6e20 6b77 6172 6773 2066 6f72 2061   in kwargs for a
-0000c900: 7267 2069 6e20 2822 6368 756e 6b73 697a  rg in ("chunksiz
-0000c910: 6522 2c20 2269 7465 7261 746f 7222 2929  e", "iterator"))
-0000c920: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000c930: 2020 7261 6973 6520 4e6f 7449 6d70 6c65    raise NotImple
-0000c940: 6d65 6e74 6564 4572 726f 7228 0a20 2020  mentedError(.   
-0000c950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c960: 2022 2763 6875 6e6b 7369 7a65 2720 616e   "'chunksize' an
-0000c970: 6420 2769 7465 7261 746f 7227 2061 7267  d 'iterator' arg
-0000c980: 756d 656e 7473 2061 7265 206e 6f74 2073  uments are not s
-0000c990: 7570 706f 7274 6564 2e22 0a20 2020 2020  upported.".     
-0000c9a0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-0000c9b0: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
-0000c9c0: 6e73 7461 6e63 6528 7061 7468 5f6f 725f  nstance(path_or_
-0000c9d0: 6275 662c 2073 7472 293a 0a20 2020 2020  buf, str):.     
-0000c9e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000c9f0: 5f63 6865 636b 5f66 696c 655f 7369 7a65  _check_file_size
-0000ca00: 2870 6174 685f 6f72 5f62 7566 290a 0a20  (path_or_buf).. 
-0000ca10: 2020 2020 2020 2020 2020 2069 6620 656e             if en
-0000ca20: 6769 6e65 203d 3d20 2275 6a73 6f6e 223a  gine == "ujson":
-0000ca30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ca40: 2070 616e 6461 735f 6466 203d 2070 616e   pandas_df = pan
-0000ca50: 6461 732e 7265 6164 5f6a 736f 6e28 2020  das.read_json(  
-0000ca60: 2320 7479 7065 3a20 6967 6e6f 7265 0a20  # type: ignore. 
-0000ca70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ca80: 2020 2070 6174 685f 6f72 5f62 7566 2c0a     path_or_buf,.
-0000ca90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000caa0: 2020 2020 6f72 6965 6e74 3d6f 7269 656e      orient=orien
-0000cab0: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
-0000cac0: 2020 2020 2020 2064 7479 7065 3d64 7479         dtype=dty
-0000cad0: 7065 2c0a 2020 2020 2020 2020 2020 2020  pe,.            
-0000cae0: 2020 2020 2020 2020 656e 636f 6469 6e67          encoding
-0000caf0: 3d65 6e63 6f64 696e 672c 0a20 2020 2020  =encoding,.     
-0000cb00: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-0000cb10: 696e 6573 3d6c 696e 6573 2c0a 2020 2020  ines=lines,.    
-0000cb20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cb30: 2a2a 6b77 6172 6773 2c0a 2020 2020 2020  **kwargs,.      
-0000cb40: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-0000cb50: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-0000cb60: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0000cb70: 616e 6461 735f 6466 203d 2070 616e 6461  andas_df = panda
-0000cb80: 732e 7265 6164 5f6a 736f 6e28 2020 2320  s.read_json(  # 
-0000cb90: 7479 7065 3a20 6967 6e6f 7265 0a20 2020  type: ignore.   
-0000cba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cbb0: 2070 6174 685f 6f72 5f62 7566 2c0a 2020   path_or_buf,.  
-0000cbc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cbd0: 2020 6f72 6965 6e74 3d6f 7269 656e 742c    orient=orient,
-0000cbe0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000cbf0: 2020 2020 2064 7479 7065 3d64 7479 7065       dtype=dtype
-0000cc00: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000cc10: 2020 2020 2020 656e 636f 6469 6e67 3d65        encoding=e
-0000cc20: 6e63 6f64 696e 672c 0a20 2020 2020 2020  ncoding,.       
-0000cc30: 2020 2020 2020 2020 2020 2020 206c 696e               lin
-0000cc40: 6573 3d6c 696e 6573 2c0a 2020 2020 2020  es=lines,.      
-0000cc50: 2020 2020 2020 2020 2020 2020 2020 656e                en
-0000cc60: 6769 6e65 3d65 6e67 696e 652c 0a20 2020  gine=engine,.   
-0000cc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cc80: 202a 2a6b 7761 7267 732c 0a20 2020 2020   **kwargs,.     
-0000cc90: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0000cca0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0000ccb0: 7365 6c66 2e5f 7265 6164 5f70 616e 6461  self._read_panda
-0000ccc0: 7328 7061 6e64 6173 5f64 662c 2022 7265  s(pandas_df, "re
-0000ccd0: 6164 5f6a 736f 6e22 290a 0a20 2020 2064  ad_json")..    d
-0000cce0: 6566 205f 6368 6563 6b5f 6669 6c65 5f73  ef _check_file_s
-0000ccf0: 697a 6528 7365 6c66 2c20 6669 6c65 7061  ize(self, filepa
-0000cd00: 7468 3a20 7374 7229 3a0a 2020 2020 2020  th: str):.      
-0000cd10: 2020 6d61 785f 7369 7a65 203d 2031 3032    max_size = 102
-0000cd20: 3420 2a20 3130 3234 202a 2031 3032 3420  4 * 1024 * 1024 
-0000cd30: 2023 2031 2047 4220 696e 2062 7974 6573   # 1 GB in bytes
-0000cd40: 0a20 2020 2020 2020 2069 6620 6669 6c65  .        if file
-0000cd50: 7061 7468 2e73 7461 7274 7377 6974 6828  path.startswith(
-0000cd60: 2267 733a 2f2f 2229 3a20 2023 2047 4353  "gs://"):  # GCS
-0000cd70: 2066 696c 6520 7061 7468 0a20 2020 2020   file path.     
-0000cd80: 2020 2020 2020 2063 6c69 656e 7420 3d20         client = 
-0000cd90: 7374 6f72 6167 652e 436c 6965 6e74 2829  storage.Client()
-0000cda0: 0a20 2020 2020 2020 2020 2020 2062 7563  .            buc
-0000cdb0: 6b65 745f 6e61 6d65 2c20 626c 6f62 5f6e  ket_name, blob_n
-0000cdc0: 616d 6520 3d20 6669 6c65 7061 7468 2e73  ame = filepath.s
-0000cdd0: 706c 6974 2822 2f22 2c20 3329 5b32 3a5d  plit("/", 3)[2:]
-0000cde0: 0a20 2020 2020 2020 2020 2020 2062 7563  .            buc
-0000cdf0: 6b65 7420 3d20 636c 6965 6e74 2e62 7563  ket = client.buc
-0000ce00: 6b65 7428 6275 636b 6574 5f6e 616d 6529  ket(bucket_name)
-0000ce10: 0a20 2020 2020 2020 2020 2020 2062 6c6f  .            blo
-0000ce20: 6220 3d20 6275 636b 6574 2e62 6c6f 6228  b = bucket.blob(
-0000ce30: 626c 6f62 5f6e 616d 6529 0a20 2020 2020  blob_name).     
-0000ce40: 2020 2020 2020 2062 6c6f 622e 7265 6c6f         blob.relo
-0000ce50: 6164 2829 0a20 2020 2020 2020 2020 2020  ad().           
-0000ce60: 2066 696c 655f 7369 7a65 203d 2062 6c6f   file_size = blo
-0000ce70: 622e 7369 7a65 0a20 2020 2020 2020 2065  b.size.        e
-0000ce80: 6c73 653a 2020 2320 6c6f 6361 6c20 6669  lse:  # local fi
-0000ce90: 6c65 2070 6174 680a 2020 2020 2020 2020  le path.        
-0000cea0: 2020 2020 6669 6c65 5f73 697a 6520 3d20      file_size = 
-0000ceb0: 6f73 2e70 6174 682e 6765 7473 697a 6528  os.path.getsize(
-0000cec0: 6669 6c65 7061 7468 290a 0a20 2020 2020  filepath)..     
-0000ced0: 2020 2069 6620 6669 6c65 5f73 697a 6520     if file_size 
-0000cee0: 3e20 6d61 785f 7369 7a65 3a0a 2020 2020  > max_size:.    
-0000cef0: 2020 2020 2020 2020 2320 436f 6e76 6572          # Conver
-0000cf00: 7420 746f 2047 420a 2020 2020 2020 2020  t to GB.        
-0000cf10: 2020 2020 6669 6c65 5f73 697a 6520 3d20      file_size = 
-0000cf20: 726f 756e 6428 6669 6c65 5f73 697a 6520  round(file_size 
-0000cf30: 2f20 2831 3032 342a 2a33 292c 2031 290a  / (1024**3), 1).
-0000cf40: 2020 2020 2020 2020 2020 2020 6d61 785f              max_
-0000cf50: 7369 7a65 203d 2069 6e74 286d 6178 5f73  size = int(max_s
-0000cf60: 697a 6520 2f20 3130 3234 2a2a 3329 0a20  ize / 1024**3). 
-0000cf70: 2020 2020 2020 2020 2020 206c 6f67 6765             logge
-0000cf80: 722e 7761 726e 696e 6728 0a20 2020 2020  r.warning(.     
-0000cf90: 2020 2020 2020 2020 2020 2066 2246 696c             f"Fil
-0000cfa0: 6520 7369 7a65 207b 6669 6c65 5f73 697a  e size {file_siz
-0000cfb0: 657d 4742 2065 7863 6565 6473 207b 6d61  e}GB exceeds {ma
-0000cfc0: 785f 7369 7a65 7d47 422e 2022 0a20 2020  x_size}GB. ".   
-0000cfd0: 2020 2020 2020 2020 2020 2020 2022 4974               "It
-0000cfe0: 2069 7320 7265 636f 6d6d 656e 6465 6420   is recommended 
-0000cff0: 746f 2075 7365 2065 6e67 696e 653d 2762  to use engine='b
-0000d000: 6967 7175 6572 7927 2022 0a20 2020 2020  igquery' ".     
-0000d010: 2020 2020 2020 2020 2020 2022 666f 7220             "for 
-0000d020: 6c61 7267 6520 6669 6c65 7320 746f 2061  large files to a
-0000d030: 766f 6964 206c 6f61 6469 6e67 2074 6865  void loading the
-0000d040: 2066 696c 6520 696e 746f 206c 6f63 616c   file into local
-0000d050: 206d 656d 6f72 792e 220a 2020 2020 2020   memory.".      
-0000d060: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-0000d070: 205f 6372 6561 7465 5f65 6d70 7479 5f74   _create_empty_t
-0000d080: 656d 705f 7461 626c 6528 0a20 2020 2020  emp_table(.     
-0000d090: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-0000d0a0: 2073 6368 656d 613a 2049 7465 7261 626c   schema: Iterabl
-0000d0b0: 655b 6269 6771 7565 7279 2e53 6368 656d  e[bigquery.Schem
-0000d0c0: 6146 6965 6c64 5d2c 0a20 2020 2020 2020  aField],.       
-0000d0d0: 2063 6c75 7374 6572 5f63 6f6c 733a 204c   cluster_cols: L
-0000d0e0: 6973 745b 7374 725d 2c0a 2020 2020 2920  ist[str],.    ) 
-0000d0f0: 2d3e 2062 6967 7175 6572 792e 5461 626c  -> bigquery.Tabl
-0000d100: 6552 6566 6572 656e 6365 3a0a 2020 2020  eReference:.    
-0000d110: 2020 2020 2320 4361 6e27 7420 7365 7420      # Can't set 
-0000d120: 6120 7461 626c 6520 696e 205f 5345 5353  a table in _SESS
-0000d130: 494f 4e20 6173 2064 6573 7469 6e61 7469  ION as destinati
-0000d140: 6f6e 2076 6961 2071 7565 7279 206a 6f62  on via query job
-0000d150: 2041 5049 2c20 736f 2077 650a 2020 2020   API, so we.    
-0000d160: 2020 2020 2320 7275 6e20 4444 4c2c 2069      # run DDL, i
-0000d170: 6e73 7465 6164 2e0a 2020 2020 2020 2020  nstead..        
-0000d180: 6578 7069 7261 7469 6f6e 203d 2028 0a20  expiration = (. 
-0000d190: 2020 2020 2020 2020 2020 2064 6174 6574             datet
-0000d1a0: 696d 652e 6461 7465 7469 6d65 2e6e 6f77  ime.datetime.now
-0000d1b0: 2864 6174 6574 696d 652e 7469 6d65 7a6f  (datetime.timezo
-0000d1c0: 6e65 2e75 7463 2920 2b20 636f 6e73 7461  ne.utc) + consta
-0000d1d0: 6e74 732e 4445 4641 554c 545f 4558 5049  nts.DEFAULT_EXPI
-0000d1e0: 5241 5449 4f4e 0a20 2020 2020 2020 2029  RATION.        )
-0000d1f0: 0a0a 2020 2020 2020 2020 7461 626c 6520  ..        table 
-0000d200: 3d20 6269 6766 7261 6d65 735f 696f 2e63  = bigframes_io.c
-0000d210: 7265 6174 655f 7465 6d70 5f74 6162 6c65  reate_temp_table
-0000d220: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
-0000d230: 6c66 2c0a 2020 2020 2020 2020 2020 2020  lf,.            
-0000d240: 6578 7069 7261 7469 6f6e 2c0a 2020 2020  expiration,.    
-0000d250: 2020 2020 2020 2020 7363 6865 6d61 3d73          schema=s
-0000d260: 6368 656d 612c 0a20 2020 2020 2020 2020  chema,.         
-0000d270: 2020 2063 6c75 7374 6572 5f63 6f6c 756d     cluster_colum
-0000d280: 6e73 3d63 6c75 7374 6572 5f63 6f6c 732c  ns=cluster_cols,
-0000d290: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-0000d2a0: 2020 2072 6574 7572 6e20 6269 6771 7565     return bigque
-0000d2b0: 7279 2e54 6162 6c65 5265 6665 7265 6e63  ry.TableReferenc
-0000d2c0: 652e 6672 6f6d 5f73 7472 696e 6728 7461  e.from_string(ta
-0000d2d0: 626c 6529 0a0a 2020 2020 6465 6620 5f69  ble)..    def _i
-0000d2e0: 6269 735f 746f 5f74 656d 705f 7461 626c  bis_to_temp_tabl
-0000d2f0: 6528 0a20 2020 2020 2020 2073 656c 662c  e(.        self,
-0000d300: 0a20 2020 2020 2020 2074 6162 6c65 3a20  .        table: 
-0000d310: 6962 6973 5f74 7970 6573 2e54 6162 6c65  ibis_types.Table
-0000d320: 2c0a 2020 2020 2020 2020 636c 7573 7465  ,.        cluste
-0000d330: 725f 636f 6c73 3a20 4974 6572 6162 6c65  r_cols: Iterable
-0000d340: 5b73 7472 5d2c 0a20 2020 2020 2020 2061  [str],.        a
-0000d350: 7069 5f6e 616d 653a 2073 7472 2c0a 2020  pi_name: str,.  
-0000d360: 2020 2920 2d3e 2062 6967 7175 6572 792e    ) -> bigquery.
-0000d370: 5461 626c 6552 6566 6572 656e 6365 3a0a  TableReference:.
-0000d380: 2020 2020 2020 2020 6465 7374 696e 6174          destinat
-0000d390: 696f 6e2c 205f 203d 2073 656c 662e 5f71  ion, _ = self._q
-0000d3a0: 7565 7279 5f74 6f5f 6465 7374 696e 6174  uery_to_destinat
-0000d3b0: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
-0000d3c0: 2073 656c 662e 6962 6973 5f63 6c69 656e   self.ibis_clien
-0000d3d0: 742e 636f 6d70 696c 6528 7461 626c 6529  t.compile(table)
-0000d3e0: 2c0a 2020 2020 2020 2020 2020 2020 696e  ,.            in
-0000d3f0: 6465 785f 636f 6c73 3d6c 6973 7428 636c  dex_cols=list(cl
-0000d400: 7573 7465 725f 636f 6c73 292c 0a20 2020  uster_cols),.   
-0000d410: 2020 2020 2020 2020 2061 7069 5f6e 616d           api_nam
-0000d420: 653d 6170 695f 6e61 6d65 2c0a 2020 2020  e=api_name,.    
-0000d430: 2020 2020 290a 2020 2020 2020 2020 2320      ).        # 
-0000d440: 5468 6572 6520 7368 6f75 6c64 2061 6c77  There should alw
-0000d450: 6179 7320 6265 2061 2064 6573 7469 6e61  ays be a destina
-0000d460: 7469 6f6e 2074 6162 6c65 2066 6f72 2074  tion table for t
-0000d470: 6869 7320 7175 6572 7920 7479 7065 2e0a  his query type..
-0000d480: 2020 2020 2020 2020 7265 7475 726e 2074          return t
-0000d490: 7970 696e 672e 6361 7374 2862 6967 7175  yping.cast(bigqu
-0000d4a0: 6572 792e 5461 626c 6552 6566 6572 656e  ery.TableReferen
-0000d4b0: 6365 2c20 6465 7374 696e 6174 696f 6e29  ce, destination)
-0000d4c0: 0a0a 2020 2020 6465 6620 7265 6d6f 7465  ..    def remote
-0000d4d0: 5f66 756e 6374 696f 6e28 0a20 2020 2020  _function(.     
-0000d4e0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-0000d4f0: 2069 6e70 7574 5f74 7970 6573 3a20 556e   input_types: Un
-0000d500: 696f 6e5b 7479 7065 2c20 5365 7175 656e  ion[type, Sequen
-0000d510: 6365 5b74 7970 655d 5d2c 0a20 2020 2020  ce[type]],.     
-0000d520: 2020 206f 7574 7075 745f 7479 7065 3a20     output_type: 
-0000d530: 7479 7065 2c0a 2020 2020 2020 2020 6461  type,.        da
-0000d540: 7461 7365 743a 204f 7074 696f 6e61 6c5b  taset: Optional[
-0000d550: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
-0000d560: 2020 2020 2062 6967 7175 6572 795f 636f       bigquery_co
-0000d570: 6e6e 6563 7469 6f6e 3a20 4f70 7469 6f6e  nnection: Option
-0000d580: 616c 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  al[str] = None,.
-0000d590: 2020 2020 2020 2020 7265 7573 653a 2062          reuse: b
-0000d5a0: 6f6f 6c20 3d20 5472 7565 2c0a 2020 2020  ool = True,.    
-0000d5b0: 2020 2020 6e61 6d65 3a20 4f70 7469 6f6e      name: Option
-0000d5c0: 616c 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  al[str] = None,.
-0000d5d0: 2020 2020 2020 2020 7061 636b 6167 6573          packages
-0000d5e0: 3a20 4f70 7469 6f6e 616c 5b53 6571 7565  : Optional[Seque
-0000d5f0: 6e63 655b 7374 725d 5d20 3d20 4e6f 6e65  nce[str]] = None
-0000d600: 2c0a 2020 2020 2020 2020 636c 6f75 645f  ,.        cloud_
-0000d610: 6675 6e63 7469 6f6e 5f73 6572 7669 6365  function_service
-0000d620: 5f61 6363 6f75 6e74 3a20 4f70 7469 6f6e  _account: Option
-0000d630: 616c 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  al[str] = None,.
-0000d640: 2020 2020 2020 2020 636c 6f75 645f 6675          cloud_fu
-0000d650: 6e63 7469 6f6e 5f6b 6d73 5f6b 6579 5f6e  nction_kms_key_n
-0000d660: 616d 653a 204f 7074 696f 6e61 6c5b 7374  ame: Optional[st
-0000d670: 725d 203d 204e 6f6e 652c 0a20 2020 2020  r] = None,.     
-0000d680: 2020 2063 6c6f 7564 5f66 756e 6374 696f     cloud_functio
-0000d690: 6e5f 646f 636b 6572 5f72 6570 6f73 6974  n_docker_reposit
-0000d6a0: 6f72 793a 204f 7074 696f 6e61 6c5b 7374  ory: Optional[st
-0000d6b0: 725d 203d 204e 6f6e 652c 0a20 2020 2020  r] = None,.     
-0000d6c0: 2020 206d 6178 5f62 6174 6368 696e 675f     max_batching_
-0000d6d0: 726f 7773 3a20 4f70 7469 6f6e 616c 5b69  rows: Optional[i
-0000d6e0: 6e74 5d20 3d20 3130 3030 2c0a 2020 2020  nt] = 1000,.    
-0000d6f0: 2020 2020 636c 6f75 645f 6675 6e63 7469      cloud_functi
-0000d700: 6f6e 5f74 696d 656f 7574 3a20 4f70 7469  on_timeout: Opti
-0000d710: 6f6e 616c 5b69 6e74 5d20 3d20 3630 302c  onal[int] = 600,
-0000d720: 0a20 2020 2020 2020 2063 6c6f 7564 5f66  .        cloud_f
-0000d730: 756e 6374 696f 6e5f 6d61 785f 696e 7374  unction_max_inst
-0000d740: 616e 6365 733a 204f 7074 696f 6e61 6c5b  ances: Optional[
-0000d750: 696e 745d 203d 204e 6f6e 652c 0a20 2020  int] = None,.   
-0000d760: 2029 3a0a 2020 2020 2020 2020 2222 2244   ):.        """D
-0000d770: 6563 6f72 6174 6f72 2074 6f20 7475 726e  ecorator to turn
-0000d780: 2061 2075 7365 7220 6465 6669 6e65 6420   a user defined 
-0000d790: 6675 6e63 7469 6f6e 2069 6e74 6f20 6120  function into a 
-0000d7a0: 4269 6751 7565 7279 2072 656d 6f74 6520  BigQuery remote 
-0000d7b0: 6675 6e63 7469 6f6e 2e20 4368 6563 6b20  function. Check 
-0000d7c0: 6f75 740a 2020 2020 2020 2020 7468 6520  out.        the 
-0000d7d0: 636f 6465 2073 616d 706c 6573 2061 743a  code samples at:
-0000d7e0: 2068 7474 7073 3a2f 2f63 6c6f 7564 2e67   https://cloud.g
-0000d7f0: 6f6f 676c 652e 636f 6d2f 6269 6771 7565  oogle.com/bigque
-0000d800: 7279 2f64 6f63 732f 7265 6d6f 7465 2d66  ry/docs/remote-f
-0000d810: 756e 6374 696f 6e73 2362 6967 7175 6572  unctions#bigquer
-0000d820: 792d 6461 7461 6672 616d 6573 2e0a 0a20  y-dataframes... 
-0000d830: 2020 2020 2020 202e 2e20 6e6f 7465 3a3a         .. note::
-0000d840: 0a20 2020 2020 2020 2020 2020 2050 6c65  .            Ple
-0000d850: 6173 6520 6d61 6b65 2073 7572 6520 666f  ase make sure fo
-0000d860: 6c6c 6f77 696e 6720 6973 2073 6574 7570  llowing is setup
-0000d870: 2062 6566 6f72 6520 7573 696e 6720 7468   before using th
-0000d880: 6973 2041 5049 3a0a 0a20 2020 2020 2020  is API:..       
-0000d890: 2031 2e20 4861 7665 2074 6865 2062 656c   1. Have the bel
-0000d8a0: 6f77 2041 5049 7320 656e 6162 6c65 6420  ow APIs enabled 
-0000d8b0: 666f 7220 796f 7572 2070 726f 6a65 6374  for your project
-0000d8c0: 3a0a 0a20 2020 2020 2020 2020 2020 202a  :..            *
-0000d8d0: 2042 6967 5175 6572 7920 436f 6e6e 6563   BigQuery Connec
-0000d8e0: 7469 6f6e 2041 5049 0a20 2020 2020 2020  tion API.       
-0000d8f0: 2020 2020 202a 2043 6c6f 7564 2046 756e       * Cloud Fun
-0000d900: 6374 696f 6e73 2041 5049 0a20 2020 2020  ctions API.     
-0000d910: 2020 2020 2020 202a 2043 6c6f 7564 2052         * Cloud R
-0000d920: 756e 2041 5049 0a20 2020 2020 2020 2020  un API.         
-0000d930: 2020 202a 2043 6c6f 7564 2042 7569 6c64     * Cloud Build
-0000d940: 2041 5049 0a20 2020 2020 2020 2020 2020   API.           
-0000d950: 202a 2041 7274 6966 6163 7420 5265 6769   * Artifact Regi
-0000d960: 7374 7279 2041 5049 0a20 2020 2020 2020  stry API.       
-0000d970: 2020 2020 202a 2043 6c6f 7564 2052 6573       * Cloud Res
-0000d980: 6f75 7263 6520 4d61 6e61 6765 7220 4150  ource Manager AP
-0000d990: 490a 0a20 2020 2020 2020 2020 2020 5468  I..           Th
-0000d9a0: 6973 2063 616e 2062 6520 646f 6e65 2066  is can be done f
-0000d9b0: 726f 6d20 7468 6520 636c 6f75 6420 636f  rom the cloud co
-0000d9c0: 6e73 6f6c 6520 2863 6861 6e67 6520 6050  nsole (change `P
-0000d9d0: 524f 4a45 4354 5f49 4460 2074 6f20 796f  ROJECT_ID` to yo
-0000d9e0: 7572 7329 3a0a 2020 2020 2020 2020 2020  urs):.          
-0000d9f0: 2068 7474 7073 3a2f 2f63 6f6e 736f 6c65   https://console
-0000da00: 2e63 6c6f 7564 2e67 6f6f 676c 652e 636f  .cloud.google.co
-0000da10: 6d2f 6170 6973 2f65 6e61 626c 6566 6c6f  m/apis/enableflo
-0000da20: 773f 6170 6969 643d 6269 6771 7565 7279  w?apiid=bigquery
-0000da30: 636f 6e6e 6563 7469 6f6e 2e67 6f6f 676c  connection.googl
-0000da40: 6561 7069 732e 636f 6d2c 636c 6f75 6466  eapis.com,cloudf
-0000da50: 756e 6374 696f 6e73 2e67 6f6f 676c 6561  unctions.googlea
-0000da60: 7069 732e 636f 6d2c 7275 6e2e 676f 6f67  pis.com,run.goog
-0000da70: 6c65 6170 6973 2e63 6f6d 2c63 6c6f 7564  leapis.com,cloud
-0000da80: 6275 696c 642e 676f 6f67 6c65 6170 6973  build.googleapis
-0000da90: 2e63 6f6d 2c61 7274 6966 6163 7472 6567  .com,artifactreg
-0000daa0: 6973 7472 792e 676f 6f67 6c65 6170 6973  istry.googleapis
-0000dab0: 2e63 6f6d 2c63 6c6f 7564 7265 736f 7572  .com,cloudresour
-0000dac0: 6365 6d61 6e61 6765 722e 676f 6f67 6c65  cemanager.google
-0000dad0: 6170 6973 2e63 6f6d 2670 726f 6a65 6374  apis.com&project
-0000dae0: 3d50 524f 4a45 4354 5f49 440a 0a20 2020  =PROJECT_ID..   
-0000daf0: 2020 2020 2020 2020 4f72 2066 726f 6d20          Or from 
-0000db00: 7468 6520 6763 6c6f 7564 2043 4c49 3a0a  the gcloud CLI:.
-0000db10: 0a20 2020 2020 2020 2020 2020 6024 2067  .           `$ g
-0000db20: 636c 6f75 6420 7365 7276 6963 6573 2065  cloud services e
-0000db30: 6e61 626c 6520 6269 6771 7565 7279 636f  nable bigqueryco
-0000db40: 6e6e 6563 7469 6f6e 2e67 6f6f 676c 6561  nnection.googlea
-0000db50: 7069 732e 636f 6d20 636c 6f75 6466 756e  pis.com cloudfun
-0000db60: 6374 696f 6e73 2e67 6f6f 676c 6561 7069  ctions.googleapi
-0000db70: 732e 636f 6d20 7275 6e2e 676f 6f67 6c65  s.com run.google
-0000db80: 6170 6973 2e63 6f6d 2063 6c6f 7564 6275  apis.com cloudbu
-0000db90: 696c 642e 676f 6f67 6c65 6170 6973 2e63  ild.googleapis.c
-0000dba0: 6f6d 2061 7274 6966 6163 7472 6567 6973  om artifactregis
-0000dbb0: 7472 792e 676f 6f67 6c65 6170 6973 2e63  try.googleapis.c
-0000dbc0: 6f6d 2063 6c6f 7564 7265 736f 7572 6365  om cloudresource
-0000dbd0: 6d61 6e61 6765 722e 676f 6f67 6c65 6170  manager.googleap
-0000dbe0: 6973 2e63 6f6d 600a 0a20 2020 2020 2020  is.com`..       
-0000dbf0: 2032 2e20 4861 7665 2066 6f6c 6c6f 7769   2. Have followi
-0000dc00: 6e67 2049 414d 2072 6f6c 6573 2065 6e61  ng IAM roles ena
-0000dc10: 626c 6564 2066 6f72 2079 6f75 3a0a 0a20  bled for you:.. 
-0000dc20: 2020 2020 2020 2020 2020 202a 2042 6967             * Big
-0000dc30: 5175 6572 7920 4461 7461 2045 6469 746f  Query Data Edito
-0000dc40: 7220 2872 6f6c 6573 2f62 6967 7175 6572  r (roles/bigquer
-0000dc50: 792e 6461 7461 4564 6974 6f72 290a 2020  y.dataEditor).  
-0000dc60: 2020 2020 2020 2020 2020 2a20 4269 6751            * BigQ
-0000dc70: 7565 7279 2043 6f6e 6e65 6374 696f 6e20  uery Connection 
-0000dc80: 4164 6d69 6e20 2872 6f6c 6573 2f62 6967  Admin (roles/big
-0000dc90: 7175 6572 792e 636f 6e6e 6563 7469 6f6e  query.connection
-0000dca0: 4164 6d69 6e29 0a20 2020 2020 2020 2020  Admin).         
-0000dcb0: 2020 202a 2043 6c6f 7564 2046 756e 6374     * Cloud Funct
-0000dcc0: 696f 6e73 2044 6576 656c 6f70 6572 2028  ions Developer (
-0000dcd0: 726f 6c65 732f 636c 6f75 6466 756e 6374  roles/cloudfunct
-0000dce0: 696f 6e73 2e64 6576 656c 6f70 6572 290a  ions.developer).
-0000dcf0: 2020 2020 2020 2020 2020 2020 2a20 5365              * Se
-0000dd00: 7276 6963 6520 4163 636f 756e 7420 5573  rvice Account Us
-0000dd10: 6572 2028 726f 6c65 732f 6961 6d2e 7365  er (roles/iam.se
-0000dd20: 7276 6963 6541 6363 6f75 6e74 5573 6572  rviceAccountUser
-0000dd30: 2920 6f6e 2074 6865 2073 6572 7669 6365  ) on the service
-0000dd40: 2061 6363 6f75 6e74 2060 5052 4f4a 4543   account `PROJEC
-0000dd50: 545f 4e55 4d42 4552 2d63 6f6d 7075 7465  T_NUMBER-compute
-0000dd60: 4064 6576 656c 6f70 6572 2e67 7365 7276  @developer.gserv
-0000dd70: 6963 6561 6363 6f75 6e74 2e63 6f6d 600a  iceaccount.com`.
-0000dd80: 2020 2020 2020 2020 2020 2020 2a20 5374              * St
-0000dd90: 6f72 6167 6520 4f62 6a65 6374 2056 6965  orage Object Vie
-0000dda0: 7765 7220 2872 6f6c 6573 2f73 746f 7261  wer (roles/stora
-0000ddb0: 6765 2e6f 626a 6563 7456 6965 7765 7229  ge.objectViewer)
-0000ddc0: 0a20 2020 2020 2020 2020 2020 202a 2050  .            * P
-0000ddd0: 726f 6a65 6374 2049 414d 2041 646d 696e  roject IAM Admin
-0000dde0: 2028 726f 6c65 732f 7265 736f 7572 6365   (roles/resource
-0000ddf0: 6d61 6e61 6765 722e 7072 6f6a 6563 7449  manager.projectI
-0000de00: 616d 4164 6d69 6e29 2028 4f6e 6c79 2072  amAdmin) (Only r
-0000de10: 6571 7569 7265 6420 6966 2074 6865 2062  equired if the b
-0000de20: 6967 7175 6572 7920 636f 6e6e 6563 7469  igquery connecti
-0000de30: 6f6e 2062 6569 6e67 2075 7365 6420 6973  on being used is
-0000de40: 206e 6f74 2070 7265 2d63 7265 6174 6564   not pre-created
-0000de50: 2061 6e64 2069 7320 6372 6561 7465 6420   and is created 
-0000de60: 6479 6e61 6d69 6361 6c6c 7920 7769 7468  dynamically with
-0000de70: 2075 7365 7220 6372 6564 656e 7469 616c   user credential
-0000de80: 732e 290a 0a20 2020 2020 2020 2033 2e20  s.)..        3. 
-0000de90: 4569 7468 6572 2074 6865 2075 7365 7220  Either the user 
-0000dea0: 6861 7320 7365 7449 616d 506f 6c69 6379  has setIamPolicy
-0000deb0: 2070 7269 7669 6c65 6765 206f 6e20 7468   privilege on th
-0000dec0: 6520 7072 6f6a 6563 742c 206f 7220 6120  e project, or a 
-0000ded0: 4269 6751 7565 7279 2063 6f6e 6e65 6374  BigQuery connect
-0000dee0: 696f 6e20 6973 2070 7265 2d63 7265 6174  ion is pre-creat
-0000def0: 6564 2077 6974 6820 6e65 6365 7373 6172  ed with necessar
-0000df00: 7920 4941 4d20 726f 6c65 2073 6574 3a0a  y IAM role set:.
-0000df10: 0a20 2020 2020 2020 2020 2020 2031 2e20  .            1. 
-0000df20: 546f 2063 7265 6174 6520 6120 636f 6e6e  To create a conn
-0000df30: 6563 7469 6f6e 2c20 666f 6c6c 6f77 2068  ection, follow h
-0000df40: 7474 7073 3a2f 2f63 6c6f 7564 2e67 6f6f  ttps://cloud.goo
-0000df50: 676c 652e 636f 6d2f 6269 6771 7565 7279  gle.com/bigquery
-0000df60: 2f64 6f63 732f 7265 6665 7265 6e63 652f  /docs/reference/
-0000df70: 7374 616e 6461 7264 2d73 716c 2f72 656d  standard-sql/rem
-0000df80: 6f74 652d 6675 6e63 7469 6f6e 7323 6372  ote-functions#cr
-0000df90: 6561 7465 5f61 5f63 6f6e 6e65 6374 696f  eate_a_connectio
-0000dfa0: 6e0a 2020 2020 2020 2020 2020 2020 322e  n.            2.
-0000dfb0: 2054 6f20 7365 7420 7570 2049 414d 2c20   To set up IAM, 
-0000dfc0: 666f 6c6c 6f77 2068 7474 7073 3a2f 2f63  follow https://c
-0000dfd0: 6c6f 7564 2e67 6f6f 676c 652e 636f 6d2f  loud.google.com/
-0000dfe0: 6269 6771 7565 7279 2f64 6f63 732f 7265  bigquery/docs/re
-0000dff0: 6665 7265 6e63 652f 7374 616e 6461 7264  ference/standard
-0000e000: 2d73 716c 2f72 656d 6f74 652d 6675 6e63  -sql/remote-func
-0000e010: 7469 6f6e 7323 6772 616e 745f 7065 726d  tions#grant_perm
-0000e020: 6973 7369 6f6e 5f6f 6e5f 6675 6e63 7469  ission_on_functi
-0000e030: 6f6e 0a0a 2020 2020 2020 2020 2020 2020  on..            
-0000e040: 2020 2041 6c74 6572 6e61 7469 7665 6c79     Alternatively
-0000e050: 2c20 7468 6520 4941 4d20 636f 756c 6420  , the IAM could 
-0000e060: 616c 736f 2062 6520 7365 7475 7020 7669  also be setup vi
-0000e070: 6120 7468 6520 6763 6c6f 7564 2043 4c49  a the gcloud CLI
-0000e080: 3a0a 0a20 2020 2020 2020 2020 2020 2020  :..             
-0000e090: 2020 6024 2067 636c 6f75 6420 7072 6f6a    `$ gcloud proj
-0000e0a0: 6563 7473 2061 6464 2d69 616d 2d70 6f6c  ects add-iam-pol
-0000e0b0: 6963 792d 6269 6e64 696e 6720 5052 4f4a  icy-binding PROJ
-0000e0c0: 4543 545f 4944 202d 2d6d 656d 6265 723d  ECT_ID --member=
-0000e0d0: 2273 6572 7669 6365 4163 636f 756e 743a  "serviceAccount:
-0000e0e0: 434f 4e4e 4543 5449 4f4e 5f53 4552 5649  CONNECTION_SERVI
-0000e0f0: 4345 5f41 4343 4f55 4e54 5f49 4422 202d  CE_ACCOUNT_ID" -
-0000e100: 2d72 6f6c 653d 2272 6f6c 6573 2f72 756e  -role="roles/run
-0000e110: 2e69 6e76 6f6b 6572 2260 2e0a 0a20 2020  .invoker"`...   
-0000e120: 2020 2020 2041 7267 733a 0a20 2020 2020       Args:.     
-0000e130: 2020 2020 2020 2069 6e70 7574 5f74 7970         input_typ
-0000e140: 6573 2028 7479 7065 206f 7220 7365 7175  es (type or sequ
-0000e150: 656e 6365 2874 7970 6529 293a 0a20 2020  ence(type)):.   
-0000e160: 2020 2020 2020 2020 2020 2020 2049 6e70               Inp
-0000e170: 7574 2064 6174 6120 7479 7065 2c20 6f72  ut data type, or
-0000e180: 2073 6571 7565 6e63 6520 6f66 2069 6e70   sequence of inp
-0000e190: 7574 2064 6174 6120 7479 7065 7320 696e  ut data types in
-0000e1a0: 2074 6865 2075 7365 720a 2020 2020 2020   the user.      
-0000e1b0: 2020 2020 2020 2020 2020 6465 6669 6e65            define
-0000e1c0: 6420 6675 6e63 7469 6f6e 2e0a 2020 2020  d function..    
-0000e1d0: 2020 2020 2020 2020 6f75 7470 7574 5f74          output_t
-0000e1e0: 7970 6520 2874 7970 6529 3a0a 2020 2020  ype (type):.    
-0000e1f0: 2020 2020 2020 2020 2020 2020 4461 7461              Data
-0000e200: 2074 7970 6520 6f66 2074 6865 206f 7574   type of the out
-0000e210: 7075 7420 696e 2074 6865 2075 7365 7220  put in the user 
-0000e220: 6465 6669 6e65 6420 6675 6e63 7469 6f6e  defined function
-0000e230: 2e0a 2020 2020 2020 2020 2020 2020 6461  ..            da
-0000e240: 7461 7365 7420 2873 7472 2c20 4f70 7469  taset (str, Opti
-0000e250: 6f6e 616c 293a 0a20 2020 2020 2020 2020  onal):.         
-0000e260: 2020 2020 2020 2044 6174 6173 6574 2069         Dataset i
-0000e270: 6e20 7768 6963 6820 746f 2063 7265 6174  n which to creat
-0000e280: 6520 6120 4269 6751 7565 7279 2072 656d  e a BigQuery rem
-0000e290: 6f74 6520 6675 6e63 7469 6f6e 2e20 4974  ote function. It
-0000e2a0: 2073 686f 756c 6420 6265 2069 6e0a 2020   should be in.  
-0000e2b0: 2020 2020 2020 2020 2020 2020 2020 603c                `<
-0000e2c0: 7072 6f6a 6563 745f 6964 3e2e 3c64 6174  project_id>.<dat
-0000e2d0: 6173 6574 5f6e 616d 653e 6020 6f72 2060  aset_name>` or `
-0000e2e0: 3c64 6174 6173 6574 5f6e 616d 653e 6020  <dataset_name>` 
-0000e2f0: 666f 726d 6174 2e20 4966 2074 6869 730a  format. If this.
-0000e300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e310: 7061 7261 6d65 7465 7220 6973 206e 6f74  parameter is not
-0000e320: 2070 726f 7669 6465 6420 7468 656e 2073   provided then s
-0000e330: 6573 7369 6f6e 2064 6174 6173 6574 2069  ession dataset i
-0000e340: 6420 6973 2075 7365 642e 0a20 2020 2020  d is used..     
-0000e350: 2020 2020 2020 2062 6967 7175 6572 795f         bigquery_
-0000e360: 636f 6e6e 6563 7469 6f6e 2028 7374 722c  connection (str,
-0000e370: 204f 7074 696f 6e61 6c29 3a0a 2020 2020   Optional):.    
-0000e380: 2020 2020 2020 2020 2020 2020 4e61 6d65              Name
-0000e390: 206f 6620 7468 6520 4269 6751 7565 7279   of the BigQuery
-0000e3a0: 2063 6f6e 6e65 6374 696f 6e2e 2059 6f75   connection. You
-0000e3b0: 2073 686f 756c 6420 6569 7468 6572 2068   should either h
-0000e3c0: 6176 6520 7468 650a 2020 2020 2020 2020  ave the.        
-0000e3d0: 2020 2020 2020 2020 636f 6e6e 6563 7469          connecti
-0000e3e0: 6f6e 2061 6c72 6561 6479 2063 7265 6174  on already creat
-0000e3f0: 6564 2069 6e20 7468 6520 606c 6f63 6174  ed in the `locat
-0000e400: 696f 6e60 2079 6f75 2068 6176 6520 6368  ion` you have ch
-0000e410: 6f73 656e 2c20 6f72 0a20 2020 2020 2020  osen, or.       
-0000e420: 2020 2020 2020 2020 2079 6f75 2073 686f           you sho
-0000e430: 756c 6420 6861 7665 2074 6865 2050 726f  uld have the Pro
-0000e440: 6a65 6374 2049 414d 2041 646d 696e 2072  ject IAM Admin r
-0000e450: 6f6c 6520 746f 2065 6e61 626c 6520 7468  ole to enable th
-0000e460: 6520 7365 7276 6963 650a 2020 2020 2020  e service.      
-0000e470: 2020 2020 2020 2020 2020 746f 2063 7265            to cre
-0000e480: 6174 6520 7468 6520 636f 6e6e 6563 7469  ate the connecti
-0000e490: 6f6e 2066 6f72 2079 6f75 2069 6620 796f  on for you if yo
-0000e4a0: 7520 6e65 6564 2069 742e 2049 6620 7468  u need it. If th
-0000e4b0: 6973 2070 6172 616d 6574 6572 2069 730a  is parameter is.
-0000e4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e4d0: 6e6f 7420 7072 6f76 6964 6564 2074 6865  not provided the
-0000e4e0: 6e20 7468 6520 4269 6751 7565 7279 2063  n the BigQuery c
-0000e4f0: 6f6e 6e65 6374 696f 6e20 6672 6f6d 2074  onnection from t
-0000e500: 6865 2073 6573 7369 6f6e 2069 7320 7573  he session is us
-0000e510: 6564 2e0a 2020 2020 2020 2020 2020 2020  ed..            
-0000e520: 7265 7573 6520 2862 6f6f 6c2c 204f 7074  reuse (bool, Opt
-0000e530: 696f 6e61 6c29 3a0a 2020 2020 2020 2020  ional):.        
-0000e540: 2020 2020 2020 2020 5265 7573 6520 7468          Reuse th
-0000e550: 6520 7265 6d6f 7465 2066 756e 6374 696f  e remote functio
-0000e560: 6e20 6966 2061 6c72 6561 6479 2065 7869  n if already exi
-0000e570: 7374 732e 0a20 2020 2020 2020 2020 2020  sts..           
-0000e580: 2020 2020 2060 5472 7565 6020 6279 2064       `True` by d
-0000e590: 6566 6175 6c74 2c20 7768 6963 6820 7769  efault, which wi
-0000e5a0: 6c6c 2072 6573 756c 7420 696e 2072 6575  ll result in reu
-0000e5b0: 7369 6e67 2061 6e20 6578 6973 7469 6e67  sing an existing
-0000e5c0: 2072 656d 6f74 650a 2020 2020 2020 2020   remote.        
-0000e5d0: 2020 2020 2020 2020 6675 6e63 7469 6f6e          function
-0000e5e0: 2061 6e64 2063 6f72 7265 7370 6f6e 6469   and correspondi
-0000e5f0: 6e67 2063 6c6f 7564 2066 756e 6374 696f  ng cloud functio
-0000e600: 6e20 2869 6620 616e 7929 2074 6861 7420  n (if any) that 
-0000e610: 7761 730a 2020 2020 2020 2020 2020 2020  was.            
-0000e620: 2020 2020 7072 6576 696f 7573 6c79 2063      previously c
-0000e630: 7265 6174 6564 2066 6f72 2074 6865 2073  reated for the s
-0000e640: 616d 6520 7564 662e 0a20 2020 2020 2020  ame udf..       
-0000e650: 2020 2020 2020 2020 2053 6574 7469 6e67           Setting
-0000e660: 2069 7420 746f 2060 4661 6c73 6560 2077   it to `False` w
-0000e670: 6f75 6c64 2066 6f72 6365 2063 7265 6174  ould force creat
-0000e680: 696e 6720 6120 756e 6971 7565 2072 656d  ing a unique rem
-0000e690: 6f74 6520 6675 6e63 7469 6f6e 2e0a 2020  ote function..  
-0000e6a0: 2020 2020 2020 2020 2020 2020 2020 4966                If
-0000e6b0: 2074 6865 2072 6571 7569 7265 6420 7265   the required re
-0000e6c0: 6d6f 7465 2066 756e 6374 696f 6e20 646f  mote function do
-0000e6d0: 6573 206e 6f74 2065 7869 7374 2074 6865  es not exist the
-0000e6e0: 6e20 6974 2077 6f75 6c64 2062 650a 2020  n it would be.  
-0000e6f0: 2020 2020 2020 2020 2020 2020 2020 6372                cr
-0000e700: 6561 7465 6420 6972 7265 7370 6563 7469  eated irrespecti
-0000e710: 7665 206f 6620 7468 6973 2070 6172 616d  ve of this param
-0000e720: 2e0a 2020 2020 2020 2020 2020 2020 6e61  ..            na
-0000e730: 6d65 2028 7374 722c 204f 7074 696f 6e61  me (str, Optiona
-0000e740: 6c29 3a0a 2020 2020 2020 2020 2020 2020  l):.            
-0000e750: 2020 2020 4578 706c 6963 6974 206e 616d      Explicit nam
-0000e760: 6520 6f66 2074 6865 2070 6572 7369 7374  e of the persist
-0000e770: 6564 2042 6967 5175 6572 7920 7265 6d6f  ed BigQuery remo
-0000e780: 7465 2066 756e 6374 696f 6e2e 2055 7365  te function. Use
-0000e790: 2069 7420 7769 7468 0a20 2020 2020 2020   it with.       
-0000e7a0: 2020 2020 2020 2020 2063 6175 7469 6f6e           caution
-0000e7b0: 2c20 6265 6361 7573 6520 7477 6f20 7573  , because two us
-0000e7c0: 6572 7320 776f 726b 696e 6720 696e 2074  ers working in t
-0000e7d0: 6865 2073 616d 6520 7072 6f6a 6563 7420  he same project 
-0000e7e0: 616e 6420 6461 7461 7365 740a 2020 2020  and dataset.    
-0000e7f0: 2020 2020 2020 2020 2020 2020 636f 756c              coul
-0000e800: 6420 6f76 6572 7772 6974 6520 6561 6368  d overwrite each
-0000e810: 206f 7468 6572 2773 2072 656d 6f74 6520   other's remote 
-0000e820: 6675 6e63 7469 6f6e 7320 6966 2074 6865  functions if the
-0000e830: 7920 7573 6520 7468 6520 7361 6d65 0a20  y use the same. 
-0000e840: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0000e850: 6572 7369 7374 656e 7420 6e61 6d65 2e0a  ersistent name..
-0000e860: 2020 2020 2020 2020 2020 2020 7061 636b              pack
-0000e870: 6167 6573 2028 7374 725b 5d2c 204f 7074  ages (str[], Opt
-0000e880: 696f 6e61 6c29 3a0a 2020 2020 2020 2020  ional):.        
-0000e890: 2020 2020 2020 2020 4578 706c 6963 6974          Explicit
-0000e8a0: 206e 616d 6520 6f66 2074 6865 2065 7874   name of the ext
-0000e8b0: 6572 6e61 6c20 7061 636b 6167 6520 6465  ernal package de
-0000e8c0: 7065 6e64 656e 6369 6573 2e20 4561 6368  pendencies. Each
-0000e8d0: 2064 6570 656e 6465 6e63 790a 2020 2020   dependency.    
-0000e8e0: 2020 2020 2020 2020 2020 2020 6973 2061              is a
-0000e8f0: 6464 6564 2074 6f20 7468 6520 6072 6571  dded to the `req
-0000e900: 7569 7265 6d65 6e74 732e 7478 7460 2061  uirements.txt` a
-0000e910: 7320 6973 2c20 616e 6420 6361 6e20 6265  s is, and can be
-0000e920: 206f 6620 7468 6520 666f 726d 0a20 2020   of the form.   
-0000e930: 2020 2020 2020 2020 2020 2020 2073 7570               sup
-0000e940: 706f 7274 6564 2069 6e20 6874 7470 733a  ported in https:
-0000e950: 2f2f 7069 702e 7079 7061 2e69 6f2f 656e  //pip.pypa.io/en
-0000e960: 2f73 7461 626c 652f 7265 6665 7265 6e63  /stable/referenc
-0000e970: 652f 7265 7175 6972 656d 656e 7473 2d66  e/requirements-f
-0000e980: 696c 652d 666f 726d 6174 2f2e 0a20 2020  ile-format/..   
-0000e990: 2020 2020 2020 2020 2063 6c6f 7564 5f66           cloud_f
-0000e9a0: 756e 6374 696f 6e5f 7365 7276 6963 655f  unction_service_
-0000e9b0: 6163 636f 756e 7420 2873 7472 2c20 4f70  account (str, Op
-0000e9c0: 7469 6f6e 616c 293a 0a20 2020 2020 2020  tional):.       
-0000e9d0: 2020 2020 2020 2020 2053 6572 7669 6365           Service
-0000e9e0: 2061 6363 6f75 6e74 2074 6f20 7573 6520   account to use 
-0000e9f0: 666f 7220 7468 6520 636c 6f75 6420 6675  for the cloud fu
-0000ea00: 6e63 7469 6f6e 732e 2049 6620 6e6f 7420  nctions. If not 
-0000ea10: 7072 6f76 6964 6564 0a20 2020 2020 2020  provided.       
-0000ea20: 2020 2020 2020 2020 2074 6865 6e20 7468           then th
-0000ea30: 6520 6465 6661 756c 7420 7365 7276 6963  e default servic
-0000ea40: 6520 6163 636f 756e 7420 776f 756c 6420  e account would 
-0000ea50: 6265 2075 7365 642e 2053 6565 0a20 2020  be used. See.   
-0000ea60: 2020 2020 2020 2020 2020 2020 2068 7474               htt
-0000ea70: 7073 3a2f 2f63 6c6f 7564 2e67 6f6f 676c  ps://cloud.googl
-0000ea80: 652e 636f 6d2f 6675 6e63 7469 6f6e 732f  e.com/functions/
-0000ea90: 646f 6373 2f73 6563 7572 696e 672f 6675  docs/securing/fu
-0000eaa0: 6e63 7469 6f6e 2d69 6465 6e74 6974 790a  nction-identity.
-0000eab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000eac0: 666f 7220 6d6f 7265 2064 6574 6169 6c73  for more details
-0000ead0: 2e20 506c 6561 7365 206d 616b 6520 7375  . Please make su
-0000eae0: 7265 2074 6865 2073 6572 7669 6365 2061  re the service a
-0000eaf0: 6363 6f75 6e74 2068 6173 2074 6865 0a20  ccount has the. 
-0000eb00: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0000eb10: 6563 6573 7361 7279 2049 414d 2070 6572  ecessary IAM per
-0000eb20: 6d69 7373 696f 6e73 2063 6f6e 6669 6775  missions configu
-0000eb30: 7265 6420 6173 2064 6573 6372 6962 6564  red as described
-0000eb40: 2069 6e0a 2020 2020 2020 2020 2020 2020   in.            
-0000eb50: 2020 2020 6874 7470 733a 2f2f 636c 6f75      https://clou
-0000eb60: 642e 676f 6f67 6c65 2e63 6f6d 2f66 756e  d.google.com/fun
-0000eb70: 6374 696f 6e73 2f64 6f63 732f 7265 6665  ctions/docs/refe
-0000eb80: 7265 6e63 652f 6961 6d2f 726f 6c65 7323  rence/iam/roles#
-0000eb90: 6164 6469 7469 6f6e 616c 2d63 6f6e 6669  additional-confi
-0000eba0: 6775 7261 7469 6f6e 2e0a 2020 2020 2020  guration..      
-0000ebb0: 2020 2020 2020 636c 6f75 645f 6675 6e63        cloud_func
-0000ebc0: 7469 6f6e 5f6b 6d73 5f6b 6579 5f6e 616d  tion_kms_key_nam
-0000ebd0: 6520 2873 7472 2c20 4f70 7469 6f6e 616c  e (str, Optional
-0000ebe0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-0000ebf0: 2020 2043 7573 746f 6d65 7220 6d61 6e61     Customer mana
-0000ec00: 6765 6420 656e 6372 7970 7469 6f6e 206b  ged encryption k
-0000ec10: 6579 2074 6f20 7072 6f74 6563 7420 636c  ey to protect cl
-0000ec20: 6f75 6420 6675 6e63 7469 6f6e 7320 616e  oud functions an
-0000ec30: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
-0000ec40: 2020 7265 6c61 7465 6420 6461 7461 2061    related data a
-0000ec50: 7420 7265 7374 2e20 5468 6973 2069 7320  t rest. This is 
-0000ec60: 6f66 2074 6865 2066 6f72 6d61 740a 2020  of the format.  
-0000ec70: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-0000ec80: 6f6a 6563 7473 2f50 524f 4a45 4354 5f49  ojects/PROJECT_I
-0000ec90: 442f 6c6f 6361 7469 6f6e 732f 4c4f 4341  D/locations/LOCA
-0000eca0: 5449 4f4e 2f6b 6579 5269 6e67 732f 4b45  TION/keyRings/KE
-0000ecb0: 5952 494e 472f 6372 7970 746f 4b65 7973  YRING/cryptoKeys
-0000ecc0: 2f4b 4559 2e0a 2020 2020 2020 2020 2020  /KEY..          
-0000ecd0: 2020 2020 2020 5265 6164 2068 7474 7073        Read https
-0000ece0: 3a2f 2f63 6c6f 7564 2e67 6f6f 676c 652e  ://cloud.google.
-0000ecf0: 636f 6d2f 6675 6e63 7469 6f6e 732f 646f  com/functions/do
-0000ed00: 6373 2f73 6563 7572 696e 672f 636d 656b  cs/securing/cmek
-0000ed10: 2066 6f72 0a20 2020 2020 2020 2020 2020   for.           
-0000ed20: 2020 2020 206d 6f72 6520 6465 7461 696c       more detail
-0000ed30: 7320 696e 636c 7564 696e 6720 6772 616e  s including gran
-0000ed40: 7469 6e67 206e 6563 6573 7361 7279 2073  ting necessary s
-0000ed50: 6572 7669 6365 2061 6363 6f75 6e74 730a  ervice accounts.
-0000ed60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ed70: 6163 6365 7373 2074 6f20 7468 6520 6b65  access to the ke
-0000ed80: 792e 0a20 2020 2020 2020 2020 2020 2063  y..            c
-0000ed90: 6c6f 7564 5f66 756e 6374 696f 6e5f 646f  loud_function_do
-0000eda0: 636b 6572 5f72 6570 6f73 6974 6f72 7920  cker_repository 
-0000edb0: 2873 7472 2c20 4f70 7469 6f6e 616c 293a  (str, Optional):
-0000edc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000edd0: 2044 6f63 6b65 7220 7265 706f 7369 746f   Docker reposito
-0000ede0: 7279 2063 7265 6174 6564 2077 6974 6820  ry created with 
-0000edf0: 7468 6520 7361 6d65 2065 6e63 7279 7074  the same encrypt
-0000ee00: 696f 6e20 6b65 7920 6173 0a20 2020 2020  ion key as.     
-0000ee10: 2020 2020 2020 2020 2020 2060 636c 6f75             `clou
-0000ee20: 645f 6675 6e63 7469 6f6e 5f6b 6d73 5f6b  d_function_kms_k
-0000ee30: 6579 5f6e 616d 6560 2074 6f20 7374 6f72  ey_name` to stor
-0000ee40: 6520 656e 6372 7970 7465 6420 6172 7469  e encrypted arti
-0000ee50: 6661 6374 730a 2020 2020 2020 2020 2020  facts.          
-0000ee60: 2020 2020 2020 6372 6561 7465 6420 746f        created to
-0000ee70: 2073 7570 706f 7274 2074 6865 2063 6c6f   support the clo
-0000ee80: 7564 2066 756e 6374 696f 6e2e 2054 6869  ud function. Thi
-0000ee90: 7320 6973 206f 6620 7468 6520 666f 726d  s is of the form
-0000eea0: 6174 0a20 2020 2020 2020 2020 2020 2020  at.             
-0000eeb0: 2020 2070 726f 6a65 6374 732f 5052 4f4a     projects/PROJ
-0000eec0: 4543 545f 4944 2f6c 6f63 6174 696f 6e73  ECT_ID/locations
-0000eed0: 2f4c 4f43 4154 494f 4e2f 7265 706f 7369  /LOCATION/reposi
-0000eee0: 746f 7269 6573 2f52 4550 4f53 4954 4f52  tories/REPOSITOR
-0000eef0: 595f 4e41 4d45 2e0a 2020 2020 2020 2020  Y_NAME..        
-0000ef00: 2020 2020 2020 2020 466f 7220 6d6f 7265          For more
-0000ef10: 2064 6574 6169 6c73 2073 6565 0a20 2020   details see.   
-0000ef20: 2020 2020 2020 2020 2020 2020 2068 7474               htt
-0000ef30: 7073 3a2f 2f63 6c6f 7564 2e67 6f6f 676c  ps://cloud.googl
-0000ef40: 652e 636f 6d2f 6675 6e63 7469 6f6e 732f  e.com/functions/
-0000ef50: 646f 6373 2f73 6563 7572 696e 672f 636d  docs/securing/cm
-0000ef60: 656b 2362 6566 6f72 655f 796f 755f 6265  ek#before_you_be
-0000ef70: 6769 6e2e 0a20 2020 2020 2020 2020 2020  gin..           
-0000ef80: 206d 6178 5f62 6174 6368 696e 675f 726f   max_batching_ro
-0000ef90: 7773 2028 696e 742c 204f 7074 696f 6e61  ws (int, Optiona
-0000efa0: 6c29 3a0a 2020 2020 2020 2020 2020 2020  l):.            
-0000efb0: 2020 2020 5468 6520 6d61 7869 6d75 6d20      The maximum 
-0000efc0: 6e75 6d62 6572 206f 6620 726f 7773 2074  number of rows t
-0000efd0: 6f20 6265 2062 6174 6368 6564 2066 6f72  o be batched for
-0000efe0: 2070 726f 6365 7373 696e 6720 696e 2074   processing in t
-0000eff0: 6865 0a20 2020 2020 2020 2020 2020 2020  he.             
-0000f000: 2020 2042 5120 7265 6d6f 7465 2066 756e     BQ remote fun
-0000f010: 6374 696f 6e2e 2044 6566 6175 6c74 2076  ction. Default v
-0000f020: 616c 7565 2069 7320 3130 3030 2e20 4120  alue is 1000. A 
-0000f030: 6c6f 7765 7220 6e75 6d62 6572 2063 616e  lower number can
-0000f040: 2062 650a 2020 2020 2020 2020 2020 2020   be.            
-0000f050: 2020 2020 7061 7373 6564 2074 6f20 6176      passed to av
-0000f060: 6f69 6420 7469 6d65 6f75 7473 2069 6e20  oid timeouts in 
-0000f070: 6361 7365 2074 6865 2075 7365 7220 636f  case the user co
-0000f080: 6465 2069 7320 746f 6f20 636f 6d70 6c65  de is too comple
-0000f090: 7820 746f 0a20 2020 2020 2020 2020 2020  x to.           
-0000f0a0: 2020 2020 2070 726f 6365 7373 206c 6172       process lar
-0000f0b0: 6765 206e 756d 6265 7220 6f66 2072 6f77  ge number of row
-0000f0c0: 7320 6661 7374 2065 6e6f 7567 682e 2041  s fast enough. A
-0000f0d0: 2068 6967 6865 7220 6e75 6d62 6572 2063   higher number c
-0000f0e0: 616e 2062 650a 2020 2020 2020 2020 2020  an be.          
-0000f0f0: 2020 2020 2020 7573 6564 2074 6f20 696e        used to in
-0000f100: 6372 6561 7365 2074 6872 6f75 6768 7075  crease throughpu
-0000f110: 7420 696e 2063 6173 6520 7468 6520 7573  t in case the us
-0000f120: 6572 2063 6f64 6520 6973 2066 6173 7420  er code is fast 
-0000f130: 656e 6f75 6768 2e0a 2020 2020 2020 2020  enough..        
-0000f140: 2020 2020 2020 2020 604e 6f6e 6560 2063          `None` c
-0000f150: 616e 2062 6520 7061 7373 6564 2074 6f20  an be passed to 
-0000f160: 6c65 7420 4251 2072 656d 6f74 6520 6675  let BQ remote fu
-0000f170: 6e63 7469 6f6e 7320 7365 7276 6963 6520  nctions service 
-0000f180: 6170 706c 790a 2020 2020 2020 2020 2020  apply.          
-0000f190: 2020 2020 2020 6465 6661 756c 7420 6261        default ba
-0000f1a0: 7463 6869 6e67 2e20 5365 6520 666f 7220  tching. See for 
-0000f1b0: 6d6f 7265 2064 6574 6169 6c73 0a20 2020  more details.   
-0000f1c0: 2020 2020 2020 2020 2020 2020 2068 7474               htt
-0000f1d0: 7073 3a2f 2f63 6c6f 7564 2e67 6f6f 676c  ps://cloud.googl
-0000f1e0: 652e 636f 6d2f 6269 6771 7565 7279 2f64  e.com/bigquery/d
-0000f1f0: 6f63 732f 7265 6d6f 7465 2d66 756e 6374  ocs/remote-funct
-0000f200: 696f 6e73 236c 696d 6974 696e 675f 6e75  ions#limiting_nu
-0000f210: 6d62 6572 5f6f 665f 726f 7773 5f69 6e5f  mber_of_rows_in_
-0000f220: 615f 6261 7463 685f 7265 7175 6573 742e  a_batch_request.
-0000f230: 0a20 2020 2020 2020 2020 2020 2063 6c6f  .            clo
-0000f240: 7564 5f66 756e 6374 696f 6e5f 7469 6d65  ud_function_time
-0000f250: 6f75 7420 2869 6e74 2c20 4f70 7469 6f6e  out (int, Option
-0000f260: 616c 293a 0a20 2020 2020 2020 2020 2020  al):.           
-0000f270: 2020 2020 2054 6865 206d 6178 696d 756d       The maximum
-0000f280: 2061 6d6f 756e 7420 6f66 2074 696d 6520   amount of time 
-0000f290: 2869 6e20 7365 636f 6e64 7329 2042 6967  (in seconds) Big
-0000f2a0: 5175 6572 7920 7368 6f75 6c64 2077 6169  Query should wai
-0000f2b0: 7420 666f 720a 2020 2020 2020 2020 2020  t for.          
-0000f2c0: 2020 2020 2020 7468 6520 636c 6f75 6420        the cloud 
-0000f2d0: 6675 6e63 7469 6f6e 2074 6f20 7265 7475  function to retu
-0000f2e0: 726e 2061 2072 6573 706f 6e73 652e 2053  rn a response. S
-0000f2f0: 6565 2066 6f72 206d 6f72 6520 6465 7461  ee for more deta
-0000f300: 696c 730a 2020 2020 2020 2020 2020 2020  ils.            
-0000f310: 2020 2020 6874 7470 733a 2f2f 636c 6f75      https://clou
-0000f320: 642e 676f 6f67 6c65 2e63 6f6d 2f66 756e  d.google.com/fun
-0000f330: 6374 696f 6e73 2f64 6f63 732f 636f 6e66  ctions/docs/conf
-0000f340: 6967 7572 696e 672f 7469 6d65 6f75 742e  iguring/timeout.
-0000f350: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f360: 2050 6c65 6173 6520 6e6f 7465 2074 6861   Please note tha
-0000f370: 7420 6576 656e 2074 686f 7567 6820 7468  t even though th
-0000f380: 6520 636c 6f75 6420 6675 6e63 7469 6f6e  e cloud function
-0000f390: 2028 326e 6420 6765 6e29 2069 7473 656c   (2nd gen) itsel
-0000f3a0: 660a 2020 2020 2020 2020 2020 2020 2020  f.              
-0000f3b0: 2020 616c 6c6f 7773 2073 6565 7469 6e67    allows seeting
-0000f3c0: 2075 7020 746f 2036 3020 6d69 6e75 7465   up to 60 minute
-0000f3d0: 7320 6f66 2074 696d 656f 7574 2c20 4269  s of timeout, Bi
-0000f3e0: 6751 7565 7279 2072 656d 6f74 650a 2020  gQuery remote.  
-0000f3f0: 2020 2020 2020 2020 2020 2020 2020 6675                fu
-0000f400: 6e63 7469 6f6e 2063 616e 2077 6169 7420  nction can wait 
-0000f410: 6f6e 6c79 2075 7020 746f 2032 3020 6d69  only up to 20 mi
-0000f420: 6e75 7465 732c 2073 6565 2066 6f72 206d  nutes, see for m
-0000f430: 6f72 6520 6465 7461 696c 730a 2020 2020  ore details.    
-0000f440: 2020 2020 2020 2020 2020 2020 6874 7470              http
-0000f450: 733a 2f2f 636c 6f75 642e 676f 6f67 6c65  s://cloud.google
-0000f460: 2e63 6f6d 2f62 6967 7175 6572 792f 7175  .com/bigquery/qu
-0000f470: 6f74 6173 2372 656d 6f74 655f 6675 6e63  otas#remote_func
-0000f480: 7469 6f6e 5f6c 696d 6974 732e 0a20 2020  tion_limits..   
-0000f490: 2020 2020 2020 2020 2020 2020 2042 7920               By 
-0000f4a0: 6465 6661 756c 7420 4269 6751 7565 7279  default BigQuery
-0000f4b0: 2044 6174 6146 7261 6d65 7320 7573 6573   DataFrames uses
-0000f4c0: 2061 2031 3020 6d69 6e75 7465 2074 696d   a 10 minute tim
-0000f4d0: 656f 7574 2e20 604e 6f6e 6560 0a20 2020  eout. `None`.   
-0000f4e0: 2020 2020 2020 2020 2020 2020 2063 616e               can
-0000f4f0: 2062 6520 7061 7373 6564 2074 6f20 6c65   be passed to le
-0000f500: 7420 7468 6520 636c 6f75 6420 6675 6e63  t the cloud func
-0000f510: 7469 6f6e 7320 6465 6661 756c 7420 7469  tions default ti
-0000f520: 6d65 6f75 7420 7461 6b65 2065 6666 6563  meout take effec
-0000f530: 742e 0a20 2020 2020 2020 2020 2020 2063  t..            c
-0000f540: 6c6f 7564 5f66 756e 6374 696f 6e5f 6d61  loud_function_ma
-0000f550: 785f 696e 7374 616e 6365 7320 2869 6e74  x_instances (int
-0000f560: 2c20 4f70 7469 6f6e 616c 293a 0a20 2020  , Optional):.   
-0000f570: 2020 2020 2020 2020 2020 2020 2054 6865               The
-0000f580: 206d 6178 696d 756d 6d20 696e 7374 616e   maximumm instan
-0000f590: 6365 2063 6f75 6e74 2066 6f72 2074 6865  ce count for the
-0000f5a0: 2063 6c6f 7564 2066 756e 6374 696f 6e20   cloud function 
-0000f5b0: 6372 6561 7465 642e 2054 6869 730a 2020  created. This.  
-0000f5c0: 2020 2020 2020 2020 2020 2020 2020 6361                ca
-0000f5d0: 6e20 6265 2075 7365 6420 746f 2063 6f6e  n be used to con
-0000f5e0: 7472 6f6c 2068 6f77 206d 616e 7920 636c  trol how many cl
-0000f5f0: 6f75 6420 6675 6e63 7469 6f6e 2069 6e73  oud function ins
-0000f600: 7461 6e63 6573 2063 616e 2062 650a 2020  tances can be.  
-0000f610: 2020 2020 2020 2020 2020 2020 2020 6163                ac
-0000f620: 7469 7665 2061 7420 6d61 7820 6174 2061  tive at max at a
-0000f630: 6e79 2067 6976 656e 2070 6f69 6e74 206f  ny given point o
-0000f640: 6620 7469 6d65 2e20 4c6f 7765 7220 7365  f time. Lower se
-0000f650: 7474 696e 6720 6361 6e20 6865 6c70 0a20  tting can help. 
-0000f660: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-0000f670: 6f6e 7472 6f6c 2074 6865 2073 7069 6b65  ontrol the spike
-0000f680: 2069 6e20 7468 6520 6269 6c6c 696e 672e   in the billing.
-0000f690: 2048 6967 6865 7220 7365 7474 696e 6720   Higher setting 
-0000f6a0: 6361 6e20 6865 6c70 0a20 2020 2020 2020  can help.       
-0000f6b0: 2020 2020 2020 2020 2073 7570 706f 7274           support
-0000f6c0: 2070 726f 6365 7373 696e 6720 6c61 7267   processing larg
-0000f6d0: 6572 2073 6361 6c65 2064 6174 612e 2057  er scale data. W
-0000f6e0: 6865 6e20 6e6f 7420 7370 6563 6966 6965  hen not specifie
-0000f6f0: 642c 2063 6c6f 7564 0a20 2020 2020 2020  d, cloud.       
-0000f700: 2020 2020 2020 2020 2066 756e 6374 696f           functio
-0000f710: 6e27 7320 6465 6661 756c 7420 7365 7474  n's default sett
-0000f720: 696e 6720 6170 706c 6965 732e 2046 6f72  ing applies. For
-0000f730: 206d 6f72 6520 6465 7461 696c 7320 7365   more details se
-0000f740: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-0000f750: 2020 6874 7470 733a 2f2f 636c 6f75 642e    https://cloud.
-0000f760: 676f 6f67 6c65 2e63 6f6d 2f66 756e 6374  google.com/funct
-0000f770: 696f 6e73 2f64 6f63 732f 636f 6e66 6967  ions/docs/config
-0000f780: 7572 696e 672f 6d61 782d 696e 7374 616e  uring/max-instan
-0000f790: 6365 730a 2020 2020 2020 2020 5265 7475  ces.        Retu
-0000f7a0: 726e 733a 0a20 2020 2020 2020 2020 2020  rns:.           
-0000f7b0: 2063 616c 6c61 626c 653a 2041 2072 656d   callable: A rem
-0000f7c0: 6f74 6520 6675 6e63 7469 6f6e 206f 626a  ote function obj
-0000f7d0: 6563 7420 706f 696e 7469 6e67 2074 6f20  ect pointing to 
-0000f7e0: 7468 6520 636c 6f75 6420 6173 7365 7473  the cloud assets
-0000f7f0: 2063 7265 6174 6564 0a20 2020 2020 2020   created.       
-0000f800: 2020 2020 2069 6e20 7468 6520 6261 636b       in the back
-0000f810: 6772 6f75 6e64 2074 6f20 7375 7070 6f72  ground to suppor
-0000f820: 7420 7468 6520 7265 6d6f 7465 2065 7865  t the remote exe
-0000f830: 6375 7469 6f6e 2e20 5468 6520 636c 6f75  cution. The clou
-0000f840: 6420 6173 7365 7473 2063 616e 2062 650a  d assets can be.
-0000f850: 2020 2020 2020 2020 2020 2020 6c6f 6361              loca
-0000f860: 7465 6420 7468 726f 7567 6820 7468 6520  ted through the 
-0000f870: 666f 6c6c 6f77 696e 6720 7072 6f70 6572  following proper
-0000f880: 7469 6573 2073 6574 2069 6e20 7468 6520  ties set in the 
-0000f890: 6f62 6a65 6374 3a0a 0a20 2020 2020 2020  object:..       
-0000f8a0: 2020 2020 2060 6269 6766 7261 6d65 735f       `bigframes_
-0000f8b0: 636c 6f75 645f 6675 6e63 7469 6f6e 6020  cloud_function` 
-0000f8c0: 2d20 5468 6520 676f 6f67 6c65 2063 6c6f  - The google clo
-0000f8d0: 7564 2066 756e 6374 696f 6e20 6465 706c  ud function depl
-0000f8e0: 6f79 6564 2066 6f72 2074 6865 2075 7365  oyed for the use
-0000f8f0: 7220 6465 6669 6e65 6420 636f 6465 2e0a  r defined code..
-0000f900: 0a20 2020 2020 2020 2020 2020 2060 6269  .            `bi
-0000f910: 6766 7261 6d65 735f 7265 6d6f 7465 5f66  gframes_remote_f
-0000f920: 756e 6374 696f 6e60 202d 2054 6865 2062  unction` - The b
-0000f930: 6967 7175 6572 7920 7265 6d6f 7465 2066  igquery remote f
-0000f940: 756e 6374 696f 6e20 6361 7061 626c 6520  unction capable 
-0000f950: 6f66 2063 616c 6c69 6e67 2069 6e74 6f20  of calling into 
-0000f960: 6062 6967 6672 616d 6573 5f63 6c6f 7564  `bigframes_cloud
-0000f970: 5f66 756e 6374 696f 6e60 2e0a 2020 2020  _function`..    
-0000f980: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000f990: 7265 7475 726e 2062 6967 6672 616d 6573  return bigframes
-0000f9a0: 5f72 6628 0a20 2020 2020 2020 2020 2020  _rf(.           
-0000f9b0: 2069 6e70 7574 5f74 7970 6573 2c0a 2020   input_types,.  
-0000f9c0: 2020 2020 2020 2020 2020 6f75 7470 7574            output
-0000f9d0: 5f74 7970 652c 0a20 2020 2020 2020 2020  _type,.         
-0000f9e0: 2020 2073 6573 7369 6f6e 3d73 656c 662c     session=self,
-0000f9f0: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
-0000fa00: 6173 6574 3d64 6174 6173 6574 2c0a 2020  aset=dataset,.  
-0000fa10: 2020 2020 2020 2020 2020 6269 6771 7565            bigque
-0000fa20: 7279 5f63 6f6e 6e65 6374 696f 6e3d 6269  ry_connection=bi
-0000fa30: 6771 7565 7279 5f63 6f6e 6e65 6374 696f  gquery_connectio
-0000fa40: 6e2c 0a20 2020 2020 2020 2020 2020 2072  n,.            r
-0000fa50: 6575 7365 3d72 6575 7365 2c0a 2020 2020  euse=reuse,.    
-0000fa60: 2020 2020 2020 2020 6e61 6d65 3d6e 616d          name=nam
-0000fa70: 652c 0a20 2020 2020 2020 2020 2020 2070  e,.            p
-0000fa80: 6163 6b61 6765 733d 7061 636b 6167 6573  ackages=packages
-0000fa90: 2c0a 2020 2020 2020 2020 2020 2020 636c  ,.            cl
-0000faa0: 6f75 645f 6675 6e63 7469 6f6e 5f73 6572  oud_function_ser
-0000fab0: 7669 6365 5f61 6363 6f75 6e74 3d63 6c6f  vice_account=clo
-0000fac0: 7564 5f66 756e 6374 696f 6e5f 7365 7276  ud_function_serv
-0000fad0: 6963 655f 6163 636f 756e 742c 0a20 2020  ice_account,.   
-0000fae0: 2020 2020 2020 2020 2063 6c6f 7564 5f66           cloud_f
-0000faf0: 756e 6374 696f 6e5f 6b6d 735f 6b65 795f  unction_kms_key_
-0000fb00: 6e61 6d65 3d63 6c6f 7564 5f66 756e 6374  name=cloud_funct
-0000fb10: 696f 6e5f 6b6d 735f 6b65 795f 6e61 6d65  ion_kms_key_name
-0000fb20: 2c0a 2020 2020 2020 2020 2020 2020 636c  ,.            cl
-0000fb30: 6f75 645f 6675 6e63 7469 6f6e 5f64 6f63  oud_function_doc
-0000fb40: 6b65 725f 7265 706f 7369 746f 7279 3d63  ker_repository=c
-0000fb50: 6c6f 7564 5f66 756e 6374 696f 6e5f 646f  loud_function_do
-0000fb60: 636b 6572 5f72 6570 6f73 6974 6f72 792c  cker_repository,
-0000fb70: 0a20 2020 2020 2020 2020 2020 206d 6178  .            max
-0000fb80: 5f62 6174 6368 696e 675f 726f 7773 3d6d  _batching_rows=m
-0000fb90: 6178 5f62 6174 6368 696e 675f 726f 7773  ax_batching_rows
-0000fba0: 2c0a 2020 2020 2020 2020 2020 2020 636c  ,.            cl
-0000fbb0: 6f75 645f 6675 6e63 7469 6f6e 5f74 696d  oud_function_tim
-0000fbc0: 656f 7574 3d63 6c6f 7564 5f66 756e 6374  eout=cloud_funct
-0000fbd0: 696f 6e5f 7469 6d65 6f75 742c 0a20 2020  ion_timeout,.   
-0000fbe0: 2020 2020 2020 2020 2063 6c6f 7564 5f66           cloud_f
-0000fbf0: 756e 6374 696f 6e5f 6d61 785f 696e 7374  unction_max_inst
-0000fc00: 616e 6365 733d 636c 6f75 645f 6675 6e63  ances=cloud_func
-0000fc10: 7469 6f6e 5f6d 6178 5f69 6e73 7461 6e63  tion_max_instanc
-0000fc20: 6573 2c0a 2020 2020 2020 2020 290a 0a20  es,.        ).. 
-0000fc30: 2020 2064 6566 2072 6561 645f 6762 715f     def read_gbq_
-0000fc40: 6675 6e63 7469 6f6e 280a 2020 2020 2020  function(.      
-0000fc50: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-0000fc60: 6675 6e63 7469 6f6e 5f6e 616d 653a 2073  function_name: s
-0000fc70: 7472 2c0a 2020 2020 293a 0a20 2020 2020  tr,.    ):.     
-0000fc80: 2020 2022 2222 4c6f 6164 7320 6120 4269     """Loads a Bi
-0000fc90: 6751 7565 7279 2066 756e 6374 696f 6e20  gQuery function 
-0000fca0: 6672 6f6d 2042 6967 5175 6572 792e 0a0a  from BigQuery...
-0000fcb0: 2020 2020 2020 2020 5468 656e 2069 7420          Then it 
-0000fcc0: 6361 6e20 6265 2061 7070 6c69 6564 2074  can be applied t
-0000fcd0: 6f20 6120 4461 7461 4672 616d 6520 6f72  o a DataFrame or
-0000fce0: 2053 6572 6965 732e 0a0a 2020 2020 2020   Series...      
-0000fcf0: 2020 2e2e 206e 6f74 653a 3a0a 2020 2020    .. note::.    
-0000fd00: 2020 2020 2020 2020 5468 6520 7265 7475          The retu
-0000fd10: 726e 2074 7970 6520 6f66 2074 6865 2066  rn type of the f
-0000fd20: 756e 6374 696f 6e20 6d75 7374 2062 6520  unction must be 
-0000fd30: 6578 706c 6963 6974 6c79 2073 7065 6369  explicitly speci
-0000fd40: 6669 6564 2069 6e20 7468 650a 2020 2020  fied in the.    
-0000fd50: 2020 2020 2020 2020 6675 6e63 7469 6f6e          function
-0000fd60: 2773 206f 7269 6769 6e61 6c20 6465 6669  's original defi
-0000fd70: 6e69 7469 6f6e 2065 7665 6e20 6966 206e  nition even if n
-0000fd80: 6f74 206f 7468 6572 7769 7365 2072 6571  ot otherwise req
-0000fd90: 7569 7265 642e 0a0a 2020 2020 2020 2020  uired...        
-0000fda0: 4269 6751 7565 7279 2055 7469 6c73 2070  BigQuery Utils p
-0000fdb0: 726f 7669 6465 7320 6d61 6e79 2070 7562  rovides many pub
-0000fdc0: 6c69 6320 6675 6e63 7469 6f6e 7320 756e  lic functions un
-0000fdd0: 6465 7220 7468 6520 6060 6271 7574 696c  der the ``bqutil
-0000fde0: 6060 2070 726f 6a65 6374 206f 6e20 476f  `` project on Go
-0000fdf0: 6f67 6c65 2043 6c6f 7564 2050 6c61 7466  ogle Cloud Platf
-0000fe00: 6f72 6d20 7072 6f6a 6563 740a 2020 2020  orm project.    
-0000fe10: 2020 2020 2853 6565 3a20 6874 7470 733a      (See: https:
-0000fe20: 2f2f 6769 7468 7562 2e63 6f6d 2f47 6f6f  //github.com/Goo
-0000fe30: 676c 6543 6c6f 7564 506c 6174 666f 726d  gleCloudPlatform
-0000fe40: 2f62 6967 7175 6572 792d 7574 696c 732f  /bigquery-utils/
-0000fe50: 7472 6565 2f6d 6173 7465 722f 7564 6673  tree/master/udfs
-0000fe60: 2375 7369 6e67 2d74 6865 2d75 6466 7329  #using-the-udfs)
-0000fe70: 2e0a 2020 2020 2020 2020 596f 7520 6361  ..        You ca
-0000fe80: 6e20 6368 6563 6b6f 7574 2043 6f6d 6d75  n checkout Commu
-0000fe90: 6e69 7479 2055 4446 7320 746f 2075 7365  nity UDFs to use
-0000fea0: 2063 6f6d 6d75 6e69 7479 2d63 6f6e 7472   community-contr
-0000feb0: 6962 7574 6564 2066 756e 6374 696f 6e73  ibuted functions
-0000fec0: 2e0a 2020 2020 2020 2020 2853 6565 3a20  ..        (See: 
-0000fed0: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
-0000fee0: 6f6d 2f47 6f6f 676c 6543 6c6f 7564 506c  om/GoogleCloudPl
-0000fef0: 6174 666f 726d 2f62 6967 7175 6572 792d  atform/bigquery-
-0000ff00: 7574 696c 732f 7472 6565 2f6d 6173 7465  utils/tree/maste
-0000ff10: 722f 7564 6673 2f63 6f6d 6d75 6e69 7479  r/udfs/community
-0000ff20: 2363 6f6d 6d75 6e69 7479 2d75 6466 7329  #community-udfs)
-0000ff30: 2e0a 0a20 2020 2020 2020 202a 2a45 7861  ...        **Exa
-0000ff40: 6d70 6c65 733a 2a2a 0a0a 2020 2020 2020  mples:**..      
-0000ff50: 2020 5573 6520 7468 6520 6060 6377 5f6c    Use the ``cw_l
-0000ff60: 6f77 6572 5f63 6173 655f 6173 6369 695f  ower_case_ascii_
-0000ff70: 6f6e 6c79 6060 2066 756e 6374 696f 6e20  only`` function 
-0000ff80: 6672 6f6d 2043 6f6d 6d75 6e69 7479 2055  from Community U
-0000ff90: 4446 732e 0a20 2020 2020 2020 2028 6874  DFs..        (ht
-0000ffa0: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
-0000ffb0: 2f47 6f6f 676c 6543 6c6f 7564 506c 6174  /GoogleCloudPlat
-0000ffc0: 666f 726d 2f62 6967 7175 6572 792d 7574  form/bigquery-ut
-0000ffd0: 696c 732f 626c 6f62 2f6d 6173 7465 722f  ils/blob/master/
-0000ffe0: 7564 6673 2f63 6f6d 6d75 6e69 7479 2f63  udfs/community/c
-0000fff0: 775f 6c6f 7765 725f 6361 7365 5f61 7363  w_lower_case_asc
-00010000: 6969 5f6f 6e6c 792e 7371 6c78 290a 0a20  ii_only.sqlx).. 
-00010010: 2020 2020 2020 2020 2020 203e 3e3e 2069             >>> i
-00010020: 6d70 6f72 7420 6269 6766 7261 6d65 732e  mport bigframes.
-00010030: 7061 6e64 6173 2061 7320 6270 640a 2020  pandas as bpd.  
-00010040: 2020 2020 2020 2020 2020 3e3e 3e20 6270            >>> bp
-00010050: 642e 6f70 7469 6f6e 732e 6469 7370 6c61  d.options.displa
-00010060: 792e 7072 6f67 7265 7373 5f62 6172 203d  y.progress_bar =
-00010070: 204e 6f6e 650a 0a20 2020 2020 2020 2020   None..         
-00010080: 2020 203e 3e3e 2064 6620 3d20 6270 642e     >>> df = bpd.
-00010090: 4461 7461 4672 616d 6528 7b27 6964 273a  DataFrame({'id':
-000100a0: 205b 312c 2032 2c20 335d 2c20 276e 616d   [1, 2, 3], 'nam
-000100b0: 6527 3a20 5b27 4155 52c3 894c 4945 272c  e': ['AUR..LIE',
-000100c0: 2027 43c3 894c 4553 5449 4e45 272c 2027   'C..LESTINE', '
-000100d0: 4441 5048 4ec3 8927 5d7d 290a 2020 2020  DAPHN..']}).    
-000100e0: 2020 2020 2020 2020 3e3e 3e20 6466 0a20          >>> df. 
-000100f0: 2020 2020 2020 2020 2020 2020 2020 6964                id
-00010100: 2020 2020 2020 206e 616d 650a 2020 2020         name.    
-00010110: 2020 2020 2020 2020 3020 2020 3120 2020          0   1   
-00010120: 2041 5552 c389 4c49 450a 2020 2020 2020   AUR..LIE.      
-00010130: 2020 2020 2020 3120 2020 3220 2043 c389        1   2  C..
-00010140: 4c45 5354 494e 450a 2020 2020 2020 2020  LESTINE.        
-00010150: 2020 2020 3220 2020 3320 2020 2020 4441      2   3     DA
-00010160: 5048 4ec3 890a 2020 2020 2020 2020 2020  PHN...          
-00010170: 2020 3c42 4c41 4e4b 4c49 4e45 3e0a 2020    <BLANKLINE>.  
-00010180: 2020 2020 2020 2020 2020 5b33 2072 6f77            [3 row
-00010190: 7320 7820 3220 636f 6c75 6d6e 735d 0a0a  s x 2 columns]..
-000101a0: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-000101b0: 6675 6e63 203d 2062 7064 2e72 6561 645f  func = bpd.read_
-000101c0: 6762 715f 6675 6e63 7469 6f6e 2822 6271  gbq_function("bq
-000101d0: 7574 696c 2e66 6e2e 6377 5f6c 6f77 6572  util.fn.cw_lower
-000101e0: 5f63 6173 655f 6173 6369 695f 6f6e 6c79  _case_ascii_only
-000101f0: 2229 0a20 2020 2020 2020 2020 2020 203e  ").            >
-00010200: 3e3e 2064 6631 203d 2064 662e 6173 7369  >> df1 = df.assi
-00010210: 676e 286e 6577 5f6e 616d 653d 6466 5b27  gn(new_name=df['
-00010220: 6e61 6d65 275d 2e61 7070 6c79 2866 756e  name'].apply(fun
-00010230: 6329 290a 2020 2020 2020 2020 2020 2020  c)).            
-00010240: 3e3e 3e20 6466 310a 2020 2020 2020 2020  >>> df1.        
-00010250: 2020 2020 2020 2069 6420 2020 2020 2020         id       
-00010260: 6e61 6d65 2020 206e 6577 5f6e 616d 650a  name   new_name.
-00010270: 2020 2020 2020 2020 2020 2020 3020 2020              0   
-00010280: 3120 2020 2041 5552 c389 4c49 4520 2020  1    AUR..LIE   
-00010290: 2061 7572 c389 6c69 650a 2020 2020 2020   aur..lie.      
-000102a0: 2020 2020 2020 3120 2020 3220 2043 c389        1   2  C..
-000102b0: 4c45 5354 494e 4520 2063 c389 6c65 7374  LESTINE  c..lest
-000102c0: 696e 650a 2020 2020 2020 2020 2020 2020  ine.            
-000102d0: 3220 2020 3320 2020 2020 4441 5048 4ec3  2   3     DAPHN.
-000102e0: 8920 2020 2020 6461 7068 6ec3 890a 2020  .     daphn...  
-000102f0: 2020 2020 2020 2020 2020 3c42 4c41 4e4b            <BLANK
-00010300: 4c49 4e45 3e0a 2020 2020 2020 2020 2020  LINE>.          
-00010310: 2020 5b33 2072 6f77 7320 7820 3320 636f    [3 rows x 3 co
-00010320: 6c75 6d6e 735d 0a0a 2020 2020 2020 2020  lumns]..        
-00010330: 4172 6773 3a0a 2020 2020 2020 2020 2020  Args:.          
-00010340: 2020 6675 6e63 7469 6f6e 5f6e 616d 6520    function_name 
-00010350: 2873 7472 293a 0a20 2020 2020 2020 2020  (str):.         
-00010360: 2020 2020 2020 2074 6865 2066 756e 6374         the funct
-00010370: 696f 6e27 7320 6e61 6d65 2069 6e20 4269  ion's name in Bi
-00010380: 6751 7565 7279 2069 6e20 7468 6520 666f  gQuery in the fo
-00010390: 726d 6174 0a20 2020 2020 2020 2020 2020  rmat.           
-000103a0: 2020 2020 2060 7072 6f6a 6563 745f 6964       `project_id
-000103b0: 2e64 6174 6173 6574 5f69 642e 6675 6e63  .dataset_id.func
-000103c0: 7469 6f6e 5f6e 616d 6560 2c20 6f72 0a20  tion_name`, or. 
-000103d0: 2020 2020 2020 2020 2020 2020 2020 2060                 `
-000103e0: 6461 7461 7365 745f 6964 2e66 756e 6374  dataset_id.funct
-000103f0: 696f 6e5f 6e61 6d65 6020 746f 206c 6f61  ion_name` to loa
-00010400: 6420 6672 6f6d 2074 6865 2064 6566 6175  d from the defau
-00010410: 6c74 2070 726f 6a65 6374 2c20 6f72 0a20  lt project, or. 
-00010420: 2020 2020 2020 2020 2020 2020 2020 2060                 `
-00010430: 6675 6e63 7469 6f6e 5f6e 616d 6560 2074  function_name` t
-00010440: 6f20 6c6f 6164 2066 726f 6d20 7468 6520  o load from the 
-00010450: 6465 6661 756c 7420 7072 6f6a 6563 7420  default project 
-00010460: 616e 6420 7468 6520 6461 7461 7365 740a  and the dataset.
-00010470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010480: 6173 736f 6369 6174 6564 2077 6974 6820  associated with 
-00010490: 7468 6520 6375 7272 656e 7420 7365 7373  the current sess
-000104a0: 696f 6e2e 0a0a 2020 2020 2020 2020 5265  ion...        Re
-000104b0: 7475 726e 733a 0a20 2020 2020 2020 2020  turns:.         
-000104c0: 2020 2063 616c 6c61 626c 653a 2041 2066     callable: A f
-000104d0: 756e 6374 696f 6e20 6f62 6a65 6374 2070  unction object p
-000104e0: 6f69 6e74 696e 6720 746f 2074 6865 2042  ointing to the B
-000104f0: 6967 5175 6572 7920 6675 6e63 7469 6f6e  igQuery function
-00010500: 2072 6561 640a 2020 2020 2020 2020 2020   read.          
-00010510: 2020 6672 6f6d 2042 6967 5175 6572 792e    from BigQuery.
-00010520: 0a0a 2020 2020 2020 2020 2020 2020 5468  ..            Th
-00010530: 6520 6f62 6a65 6374 2069 7320 7369 6d69  e object is simi
-00010540: 6c61 7220 746f 2074 6865 206f 6e65 2063  lar to the one c
-00010550: 7265 6174 6564 2062 7920 7468 6520 6072  reated by the `r
-00010560: 656d 6f74 655f 6675 6e63 7469 6f6e 600a  emote_function`.
-00010570: 2020 2020 2020 2020 2020 2020 6465 636f              deco
-00010580: 7261 746f 722c 2069 6e63 6c75 6469 6e67  rator, including
-00010590: 2074 6865 2060 6269 6766 7261 6d65 735f   the `bigframes_
-000105a0: 7265 6d6f 7465 5f66 756e 6374 696f 6e60  remote_function`
-000105b0: 2070 726f 7065 7274 792c 2062 7574 0a20   property, but. 
-000105c0: 2020 2020 2020 2020 2020 206e 6f74 2069             not i
-000105d0: 6e63 6c75 6469 6e67 2074 6865 2060 6269  ncluding the `bi
-000105e0: 6766 7261 6d65 735f 636c 6f75 645f 6675  gframes_cloud_fu
-000105f0: 6e63 7469 6f6e 6020 7072 6f70 6572 7479  nction` property
-00010600: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
-00010610: 2020 2020 2020 2072 6574 7572 6e20 6269         return bi
-00010620: 6766 7261 6d65 735f 7267 6628 0a20 2020  gframes_rgf(.   
-00010630: 2020 2020 2020 2020 2066 756e 6374 696f           functio
-00010640: 6e5f 6e61 6d65 3d66 756e 6374 696f 6e5f  n_name=function_
-00010650: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
-00010660: 2020 7365 7373 696f 6e3d 7365 6c66 2c0a    session=self,.
-00010670: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-00010680: 6566 205f 7072 6570 6172 655f 7175 6572  ef _prepare_quer
-00010690: 795f 6a6f 625f 636f 6e66 6967 280a 2020  y_job_config(.  
-000106a0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-000106b0: 2020 2020 6a6f 625f 636f 6e66 6967 3a20      job_config: 
-000106c0: 4f70 7469 6f6e 616c 5b62 6967 7175 6572  Optional[bigquer
-000106d0: 792e 5175 6572 794a 6f62 436f 6e66 6967  y.QueryJobConfig
-000106e0: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2920  ] = None,.    ) 
-000106f0: 2d3e 2062 6967 7175 6572 792e 5175 6572  -> bigquery.Quer
-00010700: 794a 6f62 436f 6e66 6967 3a0a 2020 2020  yJobConfig:.    
-00010710: 2020 2020 6966 206a 6f62 5f63 6f6e 6669      if job_confi
-00010720: 6720 6973 204e 6f6e 653a 0a20 2020 2020  g is None:.     
-00010730: 2020 2020 2020 206a 6f62 5f63 6f6e 6669         job_confi
-00010740: 6720 3d20 6269 6771 7565 7279 2e51 7565  g = bigquery.Que
-00010750: 7279 4a6f 6243 6f6e 6669 6728 290a 2020  ryJobConfig().  
-00010760: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00010770: 2020 2020 2020 2020 2320 4372 6561 7465          # Create
-00010780: 2061 2063 6f70 7920 736f 2074 6861 7420   a copy so that 
-00010790: 7765 2064 6f6e 2774 206d 7574 6174 6520  we don't mutate 
-000107a0: 7468 6520 6f72 6967 696e 616c 2063 6f6e  the original con
-000107b0: 6669 6720 7061 7373 6564 0a20 2020 2020  fig passed.     
+000002d0: 7420 7365 6372 6574 730a 696d 706f 7274  t secrets.import
+000002e0: 2074 7970 696e 670a 6672 6f6d 2074 7970   typing.from typ
+000002f0: 696e 6720 696d 706f 7274 2028 0a20 2020  ing import (.   
+00000300: 2041 6e79 2c0a 2020 2020 4361 6c6c 6162   Any,.    Callab
+00000310: 6c65 2c0a 2020 2020 4469 6374 2c0a 2020  le,.    Dict,.  
+00000320: 2020 494f 2c0a 2020 2020 4974 6572 6162    IO,.    Iterab
+00000330: 6c65 2c0a 2020 2020 4c69 7374 2c0a 2020  le,.    List,.  
+00000340: 2020 4c69 7465 7261 6c2c 0a20 2020 204d    Literal,.    M
+00000350: 6170 7069 6e67 2c0a 2020 2020 4d75 7461  apping,.    Muta
+00000360: 626c 6553 6571 7565 6e63 652c 0a20 2020  bleSequence,.   
+00000370: 204f 7074 696f 6e61 6c2c 0a20 2020 2053   Optional,.    S
+00000380: 6571 7565 6e63 652c 0a20 2020 2054 7570  equence,.    Tup
+00000390: 6c65 2c0a 2020 2020 556e 696f 6e2c 0a29  le,.    Union,.)
+000003a0: 0a69 6d70 6f72 7420 7575 6964 0a69 6d70  .import uuid.imp
+000003b0: 6f72 7420 7761 726e 696e 6773 0a0a 2320  ort warnings..# 
+000003c0: 4576 656e 2074 686f 7567 6820 7468 6520  Even though the 
+000003d0: 6962 6973 2e62 6163 6b65 6e64 732e 6269  ibis.backends.bi
+000003e0: 6771 7565 7279 2069 6d70 6f72 7420 6973  gquery import is
+000003f0: 2075 6e75 7365 642c 2069 7427 7320 6e65   unused, it's ne
+00000400: 6564 6564 0a23 2074 6f20 7265 6769 7374  eded.# to regist
+00000410: 6572 206e 6577 2061 6e64 2072 6570 6c61  er new and repla
+00000420: 6365 6d65 6e74 206f 7073 2077 6974 6820  cement ops with 
+00000430: 7468 6520 4962 6973 2042 6967 5175 6572  the Ibis BigQuer
+00000440: 7920 6261 636b 656e 642e 0a69 6d70 6f72  y backend..impor
+00000450: 7420 6269 6766 7261 6d65 735f 7665 6e64  t bigframes_vend
+00000460: 6f72 6564 2e69 6269 732e 6261 636b 656e  ored.ibis.backen
+00000470: 6473 2e62 6967 7175 6572 7920 2023 206e  ds.bigquery  # n
+00000480: 6f71 610a 696d 706f 7274 2062 6967 6672  oqa.import bigfr
+00000490: 616d 6573 5f76 656e 646f 7265 642e 7061  ames_vendored.pa
+000004a0: 6e64 6173 2e69 6f2e 6762 7120 6173 2074  ndas.io.gbq as t
+000004b0: 6869 7264 5f70 6172 7479 5f70 616e 6461  hird_party_panda
+000004c0: 735f 6762 710a 696d 706f 7274 2062 6967  s_gbq.import big
+000004d0: 6672 616d 6573 5f76 656e 646f 7265 642e  frames_vendored.
+000004e0: 7061 6e64 6173 2e69 6f2e 7061 7271 7565  pandas.io.parque
+000004f0: 7420 6173 2074 6869 7264 5f70 6172 7479  t as third_party
+00000500: 5f70 616e 6461 735f 7061 7271 7565 740a  _pandas_parquet.
+00000510: 696d 706f 7274 2062 6967 6672 616d 6573  import bigframes
+00000520: 5f76 656e 646f 7265 642e 7061 6e64 6173  _vendored.pandas
+00000530: 2e69 6f2e 7061 7273 6572 732e 7265 6164  .io.parsers.read
+00000540: 6572 7320 6173 2074 6869 7264 5f70 6172  ers as third_par
+00000550: 7479 5f70 616e 6461 735f 7265 6164 6572  ty_pandas_reader
+00000560: 730a 696d 706f 7274 2062 6967 6672 616d  s.import bigfram
+00000570: 6573 5f76 656e 646f 7265 642e 7061 6e64  es_vendored.pand
+00000580: 6173 2e69 6f2e 7069 636b 6c65 2061 7320  as.io.pickle as 
+00000590: 7468 6972 645f 7061 7274 795f 7061 6e64  third_party_pand
+000005a0: 6173 5f70 6963 6b6c 650a 696d 706f 7274  as_pickle.import
+000005b0: 2067 6f6f 676c 652e 6170 695f 636f 7265   google.api_core
+000005c0: 2e63 6c69 656e 745f 696e 666f 0a69 6d70  .client_info.imp
+000005d0: 6f72 7420 676f 6f67 6c65 2e61 7069 5f63  ort google.api_c
+000005e0: 6f72 652e 636c 6965 6e74 5f6f 7074 696f  ore.client_optio
+000005f0: 6e73 0a69 6d70 6f72 7420 676f 6f67 6c65  ns.import google
+00000600: 2e61 7069 5f63 6f72 652e 6578 6365 7074  .api_core.except
+00000610: 696f 6e73 0a69 6d70 6f72 7420 676f 6f67  ions.import goog
+00000620: 6c65 2e61 7069 5f63 6f72 652e 6761 7069  le.api_core.gapi
+00000630: 635f 7631 2e63 6c69 656e 745f 696e 666f  c_v1.client_info
+00000640: 0a69 6d70 6f72 7420 676f 6f67 6c65 2e61  .import google.a
+00000650: 7574 682e 6372 6564 656e 7469 616c 730a  uth.credentials.
+00000660: 696d 706f 7274 2067 6f6f 676c 652e 636c  import google.cl
+00000670: 6f75 642e 6269 6771 7565 7279 2061 7320  oud.bigquery as 
+00000680: 6269 6771 7565 7279 0a69 6d70 6f72 7420  bigquery.import 
+00000690: 676f 6f67 6c65 2e63 6c6f 7564 2e62 6967  google.cloud.big
+000006a0: 7175 6572 792e 7461 626c 650a 696d 706f  query.table.impo
+000006b0: 7274 2067 6f6f 676c 652e 636c 6f75 642e  rt google.cloud.
+000006c0: 6269 6771 7565 7279 5f63 6f6e 6e65 6374  bigquery_connect
+000006d0: 696f 6e5f 7631 0a69 6d70 6f72 7420 676f  ion_v1.import go
+000006e0: 6f67 6c65 2e63 6c6f 7564 2e62 6967 7175  ogle.cloud.bigqu
+000006f0: 6572 795f 7374 6f72 6167 655f 7631 0a69  ery_storage_v1.i
+00000700: 6d70 6f72 7420 676f 6f67 6c65 2e63 6c6f  mport google.clo
+00000710: 7564 2e66 756e 6374 696f 6e73 5f76 320a  ud.functions_v2.
+00000720: 696d 706f 7274 2067 6f6f 676c 652e 636c  import google.cl
+00000730: 6f75 642e 7265 736f 7572 6365 6d61 6e61  oud.resourcemana
+00000740: 6765 725f 7633 0a69 6d70 6f72 7420 676f  ger_v3.import go
+00000750: 6f67 6c65 2e63 6c6f 7564 2e73 746f 7261  ogle.cloud.stora
+00000760: 6765 2061 7320 7374 6f72 6167 6520 2023  ge as storage  #
+00000770: 2074 7970 653a 2069 676e 6f72 650a 696d   type: ignore.im
+00000780: 706f 7274 2069 6269 730a 696d 706f 7274  port ibis.import
+00000790: 2069 6269 732e 6261 636b 656e 6473 2e62   ibis.backends.b
+000007a0: 6967 7175 6572 7920 6173 2069 6269 735f  igquery as ibis_
+000007b0: 6269 6771 7565 7279 0a69 6d70 6f72 7420  bigquery.import 
+000007c0: 6962 6973 2e65 7870 722e 7479 7065 7320  ibis.expr.types 
+000007d0: 6173 2069 6269 735f 7479 7065 730a 696d  as ibis_types.im
+000007e0: 706f 7274 206e 756d 7079 2061 7320 6e70  port numpy as np
+000007f0: 0a69 6d70 6f72 7420 7061 6e64 6173 0a66  .import pandas.f
+00000800: 726f 6d20 7061 6e64 6173 2e5f 7479 7069  rom pandas._typi
+00000810: 6e67 2069 6d70 6f72 7420 280a 2020 2020  ng import (.    
+00000820: 436f 6d70 7265 7373 696f 6e4f 7074 696f  CompressionOptio
+00000830: 6e73 2c0a 2020 2020 4669 6c65 5061 7468  ns,.    FilePath
+00000840: 2c0a 2020 2020 5265 6164 5069 636b 6c65  ,.    ReadPickle
+00000850: 4275 6666 6572 2c0a 2020 2020 5374 6f72  Buffer,.    Stor
+00000860: 6167 654f 7074 696f 6e73 2c0a 290a 696d  ageOptions,.).im
+00000870: 706f 7274 2070 7961 7272 6f77 2061 7320  port pyarrow as 
+00000880: 7061 0a0a 696d 706f 7274 2062 6967 6672  pa..import bigfr
+00000890: 616d 6573 2e5f 636f 6e66 6967 2e62 6967  ames._config.big
+000008a0: 7175 6572 795f 6f70 7469 6f6e 7320 6173  query_options as
+000008b0: 2062 6967 7175 6572 795f 6f70 7469 6f6e   bigquery_option
+000008c0: 730a 696d 706f 7274 2062 6967 6672 616d  s.import bigfram
+000008d0: 6573 2e63 6c69 656e 7473 0a69 6d70 6f72  es.clients.impor
+000008e0: 7420 6269 6766 7261 6d65 732e 636f 6e73  t bigframes.cons
+000008f0: 7461 6e74 7320 6173 2063 6f6e 7374 616e  tants as constan
+00000900: 7473 0a69 6d70 6f72 7420 6269 6766 7261  ts.import bigfra
+00000910: 6d65 732e 636f 7265 2061 7320 636f 7265  mes.core as core
+00000920: 0a69 6d70 6f72 7420 6269 6766 7261 6d65  .import bigframe
+00000930: 732e 636f 7265 2e62 6c6f 636b 7320 6173  s.core.blocks as
+00000940: 2062 6c6f 636b 730a 696d 706f 7274 2062   blocks.import b
+00000950: 6967 6672 616d 6573 2e63 6f72 652e 636f  igframes.core.co
+00000960: 6d70 696c 650a 696d 706f 7274 2062 6967  mpile.import big
+00000970: 6672 616d 6573 2e63 6f72 652e 6e6f 6465  frames.core.node
+00000980: 7320 6173 206e 6f64 6573 0a66 726f 6d20  s as nodes.from 
+00000990: 6269 6766 7261 6d65 732e 636f 7265 2e6f  bigframes.core.o
+000009a0: 7264 6572 696e 6720 696d 706f 7274 2049  rdering import I
+000009b0: 6e74 6567 6572 456e 636f 6469 6e67 0a69  ntegerEncoding.i
+000009c0: 6d70 6f72 7420 6269 6766 7261 6d65 732e  mport bigframes.
+000009d0: 636f 7265 2e6f 7264 6572 696e 6720 6173  core.ordering as
+000009e0: 206f 7264 6572 0a69 6d70 6f72 7420 6269   order.import bi
+000009f0: 6766 7261 6d65 732e 636f 7265 2e74 7265  gframes.core.tre
+00000a00: 655f 7072 6f70 6572 7469 6573 2061 7320  e_properties as 
+00000a10: 7472 6176 6572 7361 6c73 0a69 6d70 6f72  traversals.impor
+00000a20: 7420 6269 6766 7261 6d65 732e 636f 7265  t bigframes.core
+00000a30: 2e74 7265 655f 7072 6f70 6572 7469 6573  .tree_properties
+00000a40: 2061 7320 7472 6565 5f70 726f 7065 7274   as tree_propert
+00000a50: 6965 730a 696d 706f 7274 2062 6967 6672  ies.import bigfr
+00000a60: 616d 6573 2e63 6f72 652e 7574 696c 7320  ames.core.utils 
+00000a70: 6173 2075 7469 6c73 0a69 6d70 6f72 7420  as utils.import 
+00000a80: 6269 6766 7261 6d65 732e 6474 7970 6573  bigframes.dtypes
+00000a90: 0a69 6d70 6f72 7420 6269 6766 7261 6d65  .import bigframe
+00000aa0: 732e 6578 6365 7074 696f 6e73 0a69 6d70  s.exceptions.imp
+00000ab0: 6f72 7420 6269 6766 7261 6d65 732e 666f  ort bigframes.fo
+00000ac0: 726d 6174 7469 6e67 5f68 656c 7065 7273  rmatting_helpers
+00000ad0: 2061 7320 666f 726d 6174 7469 6e67 5f68   as formatting_h
+00000ae0: 656c 7065 7273 0a66 726f 6d20 6269 6766  elpers.from bigf
+00000af0: 7261 6d65 732e 6675 6e63 7469 6f6e 732e  rames.functions.
+00000b00: 7265 6d6f 7465 5f66 756e 6374 696f 6e20  remote_function 
+00000b10: 696d 706f 7274 2072 6561 645f 6762 715f  import read_gbq_
+00000b20: 6675 6e63 7469 6f6e 2061 7320 6269 6766  function as bigf
+00000b30: 7261 6d65 735f 7267 660a 6672 6f6d 2062  rames_rgf.from b
+00000b40: 6967 6672 616d 6573 2e66 756e 6374 696f  igframes.functio
+00000b50: 6e73 2e72 656d 6f74 655f 6675 6e63 7469  ns.remote_functi
+00000b60: 6f6e 2069 6d70 6f72 7420 7265 6d6f 7465  on import remote
+00000b70: 5f66 756e 6374 696f 6e20 6173 2062 6967  _function as big
+00000b80: 6672 616d 6573 5f72 660a 696d 706f 7274  frames_rf.import
+00000b90: 2062 6967 6672 616d 6573 2e73 6573 7369   bigframes.sessi
+00000ba0: 6f6e 2e5f 696f 2e62 6967 7175 6572 7920  on._io.bigquery 
+00000bb0: 6173 2062 665f 696f 5f62 6967 7175 6572  as bf_io_bigquer
+00000bc0: 790a 696d 706f 7274 2062 6967 6672 616d  y.import bigfram
+00000bd0: 6573 2e73 6573 7369 6f6e 2e5f 696f 2e62  es.session._io.b
+00000be0: 6967 7175 6572 792e 7265 6164 5f67 6271  igquery.read_gbq
+00000bf0: 5f74 6162 6c65 2061 7320 6266 5f72 6561  _table as bf_rea
+00000c00: 645f 6762 715f 7461 626c 650a 696d 706f  d_gbq_table.impo
+00000c10: 7274 2062 6967 6672 616d 6573 2e73 6573  rt bigframes.ses
+00000c20: 7369 6f6e 2e63 6c69 656e 7473 0a69 6d70  sion.clients.imp
+00000c30: 6f72 7420 6269 6766 7261 6d65 732e 7665  ort bigframes.ve
+00000c40: 7273 696f 6e0a 0a23 2041 766f 6964 2063  rsion..# Avoid c
+00000c50: 6972 6375 6c61 7220 696d 706f 7274 732e  ircular imports.
+00000c60: 0a69 6620 7479 7069 6e67 2e54 5950 455f  .if typing.TYPE_
+00000c70: 4348 4543 4b49 4e47 3a0a 2020 2020 696d  CHECKING:.    im
+00000c80: 706f 7274 2062 6967 6672 616d 6573 2e63  port bigframes.c
+00000c90: 6f72 652e 696e 6465 7865 730a 2020 2020  ore.indexes.    
+00000ca0: 696d 706f 7274 2062 6967 6672 616d 6573  import bigframes
+00000cb0: 2e64 6174 6166 7261 6d65 2061 7320 6461  .dataframe as da
+00000cc0: 7461 6672 616d 650a 2020 2020 696d 706f  taframe.    impo
+00000cd0: 7274 2062 6967 6672 616d 6573 2e73 6572  rt bigframes.ser
+00000ce0: 6965 730a 0a5f 4249 4746 5241 4d45 535f  ies.._BIGFRAMES_
+00000cf0: 4445 4641 554c 545f 434f 4e4e 4543 5449  DEFAULT_CONNECTI
+00000d00: 4f4e 5f49 4420 3d20 2262 6967 6672 616d  ON_ID = "bigfram
+00000d10: 6573 2d64 6566 6175 6c74 2d63 6f6e 6e65  es-default-conne
+00000d20: 6374 696f 6e22 0a0a 5f54 454d 505f 5441  ction".._TEMP_TA
+00000d30: 424c 455f 4944 5f46 4f52 4d41 5420 3d20  BLE_ID_FORMAT = 
+00000d40: 2262 7164 667b 6461 7465 7d5f 7b73 6573  "bqdf{date}_{ses
+00000d50: 7369 6f6e 5f69 647d 5f7b 7261 6e64 6f6d  sion_id}_{random
+00000d60: 5f69 647d 220a 0a5f 4d41 585f 434c 5553  _id}".._MAX_CLUS
+00000d70: 5445 525f 434f 4c55 4d4e 5320 3d20 340a  TER_COLUMNS = 4.
+00000d80: 0a23 2054 4f44 4f28 7377 6173 7429 3a20  .# TODO(swast): 
+00000d90: 4e65 6564 2074 6f20 636f 6e6e 6563 7420  Need to connect 
+00000da0: 746f 2072 6567 696f 6e61 6c20 656e 6470  to regional endp
+00000db0: 6f69 6e74 7320 7768 656e 2070 6572 666f  oints when perfo
+00000dc0: 726d 696e 6720 7265 6d6f 7465 0a23 2066  rming remote.# f
+00000dd0: 756e 6374 696f 6e73 206f 7065 7261 7469  unctions operati
+00000de0: 6f6e 7320 2842 5120 436f 6e6e 6563 7469  ons (BQ Connecti
+00000df0: 6f6e 2049 414d 2c20 436c 6f75 6420 5275  on IAM, Cloud Ru
+00000e00: 6e20 2f20 436c 6f75 6420 4675 6e63 7469  n / Cloud Functi
+00000e10: 6f6e 7329 2e0a 2320 416c 736f 2073 6565  ons)..# Also see
+00000e20: 2069 6620 7265 736f 7572 6365 206d 616e   if resource man
+00000e30: 6167 6572 2063 6c69 656e 7420 6c69 6272  ager client libr
+00000e40: 6172 7920 7375 7070 6f72 7473 2072 6567  ary supports reg
+00000e50: 696f 6e61 6c20 656e 6470 6f69 6e74 732e  ional endpoints.
+00000e60: 0a0a 5f56 414c 4944 5f45 4e43 4f44 494e  .._VALID_ENCODIN
+00000e70: 4753 203d 207b 0a20 2020 2022 5554 462d  GS = {.    "UTF-
+00000e80: 3822 2c0a 2020 2020 2249 534f 2d38 3835  8",.    "ISO-885
+00000e90: 392d 3122 2c0a 2020 2020 2255 5446 2d31  9-1",.    "UTF-1
+00000ea0: 3642 4522 2c0a 2020 2020 2255 5446 2d31  6BE",.    "UTF-1
+00000eb0: 364c 4522 2c0a 2020 2020 2255 5446 2d33  6LE",.    "UTF-3
+00000ec0: 3242 4522 2c0a 2020 2020 2255 5446 2d33  2BE",.    "UTF-3
+00000ed0: 324c 4522 2c0a 7d0a 0a23 2042 6967 5175  2LE",.}..# BigQu
+00000ee0: 6572 7920 6861 7320 3120 4d42 2071 7565  ery has 1 MB que
+00000ef0: 7279 2073 697a 6520 6c69 6d69 742e 2044  ry size limit. D
+00000f00: 6f6e 2774 2077 616e 7420 746f 2074 616b  on't want to tak
+00000f10: 6520 7570 206d 6f72 6520 7468 616e 2061  e up more than a
+00000f20: 2066 6577 2025 206f 6620 7468 6174 2069   few % of that i
+00000f30: 6e6c 696e 696e 6720 6120 7461 626c 652e  nlining a table.
+00000f40: 0a23 2041 6c73 6f20 6d75 7374 2061 7373  .# Also must ass
+00000f50: 756d 6520 7468 6174 2074 6578 7420 656e  ume that text en
+00000f60: 636f 6469 6e67 2061 7320 6c69 7465 7261  coding as litera
+00000f70: 6c73 2069 7320 6d75 6368 206c 6573 7320  ls is much less 
+00000f80: 6566 6669 6369 656e 7420 7468 616e 2069  efficient than i
+00000f90: 6e2d 6d65 6d6f 7279 2072 6570 7265 7365  n-memory represe
+00000fa0: 6e74 6174 696f 6e2e 0a4d 4158 5f49 4e4c  ntation..MAX_INL
+00000fb0: 494e 455f 4446 5f42 5954 4553 203d 2035  INE_DF_BYTES = 5
+00000fc0: 3030 300a 0a23 204d 6178 2063 6f6d 706c  000..# Max compl
+00000fd0: 6578 6974 7920 7468 6174 2073 686f 756c  exity that shoul
+00000fe0: 6420 6265 2065 7865 6375 7465 6420 6173  d be executed as
+00000ff0: 2061 2073 696e 676c 6520 7175 6572 790a   a single query.
+00001000: 5155 4552 595f 434f 4d50 4c45 5849 5459  QUERY_COMPLEXITY
+00001010: 5f4c 494d 4954 203d 2031 6537 0a23 204e  _LIMIT = 1e7.# N
+00001020: 756d 6265 7220 6f66 2074 696d 6573 2074  umber of times t
+00001030: 6f20 6661 6374 6f72 206f 7574 2073 7562  o factor out sub
+00001040: 7175 6572 6965 7320 6265 666f 7265 2067  queries before g
+00001050: 6976 696e 6720 7570 2e0a 4d41 585f 5355  iving up..MAX_SU
+00001060: 4254 5245 455f 4641 4354 4f52 494e 4753  BTREE_FACTORINGS
+00001070: 203d 2035 0a0a 6c6f 6767 6572 203d 206c   = 5..logger = l
+00001080: 6f67 6769 6e67 2e67 6574 4c6f 6767 6572  ogging.getLogger
+00001090: 285f 5f6e 616d 655f 5f29 0a0a 2320 4578  (__name__)..# Ex
+000010a0: 636c 7564 6573 2067 656f 6772 6170 6879  cludes geography
+000010b0: 2c20 6279 7465 732c 2061 6e64 206e 6573  , bytes, and nes
+000010c0: 7465 6420 2861 7272 6179 2c20 7374 7275  ted (array, stru
+000010d0: 6374 2920 6461 7461 7479 7065 730a 494e  ct) datatypes.IN
+000010e0: 4c49 4e41 424c 455f 4454 5950 4553 3a20  LINABLE_DTYPES: 
+000010f0: 5365 7175 656e 6365 5b62 6967 6672 616d  Sequence[bigfram
+00001100: 6573 2e64 7479 7065 732e 4474 7970 655d  es.dtypes.Dtype]
+00001110: 203d 2028 0a20 2020 2070 616e 6461 732e   = (.    pandas.
+00001120: 426f 6f6c 6561 6e44 7479 7065 2829 2c0a  BooleanDtype(),.
+00001130: 2020 2020 7061 6e64 6173 2e46 6c6f 6174      pandas.Float
+00001140: 3634 4474 7970 6528 292c 0a20 2020 2070  64Dtype(),.    p
+00001150: 616e 6461 732e 496e 7436 3444 7479 7065  andas.Int64Dtype
+00001160: 2829 2c0a 2020 2020 7061 6e64 6173 2e53  (),.    pandas.S
+00001170: 7472 696e 6744 7479 7065 2873 746f 7261  tringDtype(stora
+00001180: 6765 3d22 7079 6172 726f 7722 292c 0a20  ge="pyarrow"),. 
+00001190: 2020 2070 616e 6461 732e 4172 726f 7744     pandas.ArrowD
+000011a0: 7479 7065 2870 612e 6461 7465 3332 2829  type(pa.date32()
+000011b0: 292c 0a20 2020 2070 616e 6461 732e 4172  ),.    pandas.Ar
+000011c0: 726f 7744 7479 7065 2870 612e 7469 6d65  rowDtype(pa.time
+000011d0: 3634 2822 7573 2229 292c 0a20 2020 2070  64("us")),.    p
+000011e0: 616e 6461 732e 4172 726f 7744 7479 7065  andas.ArrowDtype
+000011f0: 2870 612e 7469 6d65 7374 616d 7028 2275  (pa.timestamp("u
+00001200: 7322 2929 2c0a 2020 2020 7061 6e64 6173  s")),.    pandas
+00001210: 2e41 7272 6f77 4474 7970 6528 7061 2e74  .ArrowDtype(pa.t
+00001220: 696d 6573 7461 6d70 2822 7573 222c 2074  imestamp("us", t
+00001230: 7a3d 2255 5443 2229 292c 0a20 2020 2070  z="UTC")),.    p
+00001240: 616e 6461 732e 4172 726f 7744 7479 7065  andas.ArrowDtype
+00001250: 2870 612e 6465 6369 6d61 6c31 3238 2833  (pa.decimal128(3
+00001260: 382c 2039 2929 2c0a 2020 2020 7061 6e64  8, 9)),.    pand
+00001270: 6173 2e41 7272 6f77 4474 7970 6528 7061  as.ArrowDtype(pa
+00001280: 2e64 6563 696d 616c 3235 3628 3736 2c20  .decimal256(76, 
+00001290: 3338 2929 2c0a 290a 0a0a 6465 6620 5f74  38)),.)...def _t
+000012a0: 6f5f 696e 6465 785f 636f 6c73 280a 2020  o_index_cols(.  
+000012b0: 2020 696e 6465 785f 636f 6c3a 2049 7465    index_col: Ite
+000012c0: 7261 626c 655b 7374 725d 207c 2073 7472  rable[str] | str
+000012d0: 207c 2062 6967 6672 616d 6573 2e65 6e75   | bigframes.enu
+000012e0: 6d73 2e44 6566 6175 6c74 496e 6465 784b  ms.DefaultIndexK
+000012f0: 696e 6420 3d20 2829 2c0a 2920 2d3e 204c  ind = (),.) -> L
+00001300: 6973 745b 7374 725d 3a0a 2020 2020 2222  ist[str]:.    ""
+00001310: 2243 6f6e 7665 7274 2069 6e64 6578 5f63  "Convert index_c
+00001320: 6f6c 2069 6e74 6f20 6120 6c69 7374 206f  ol into a list o
+00001330: 6620 636f 6c75 6d6e 206e 616d 6573 2e22  f column names."
+00001340: 2222 0a20 2020 2069 6620 6973 696e 7374  "".    if isinst
+00001350: 616e 6365 2869 6e64 6578 5f63 6f6c 2c20  ance(index_col, 
+00001360: 6269 6766 7261 6d65 732e 656e 756d 732e  bigframes.enums.
+00001370: 4465 6661 756c 7449 6e64 6578 4b69 6e64  DefaultIndexKind
+00001380: 293a 0a20 2020 2020 2020 2069 6e64 6578  ):.        index
+00001390: 5f63 6f6c 733a 204c 6973 745b 7374 725d  _cols: List[str]
+000013a0: 203d 205b 5d0a 2020 2020 656c 6966 2069   = [].    elif i
+000013b0: 7369 6e73 7461 6e63 6528 696e 6465 785f  sinstance(index_
+000013c0: 636f 6c2c 2073 7472 293a 0a20 2020 2020  col, str):.     
+000013d0: 2020 2069 6e64 6578 5f63 6f6c 7320 3d20     index_cols = 
+000013e0: 5b69 6e64 6578 5f63 6f6c 5d0a 2020 2020  [index_col].    
+000013f0: 656c 7365 3a0a 2020 2020 2020 2020 696e  else:.        in
+00001400: 6465 785f 636f 6c73 203d 206c 6973 7428  dex_cols = list(
+00001410: 696e 6465 785f 636f 6c29 0a0a 2020 2020  index_col)..    
+00001420: 7265 7475 726e 2069 6e64 6578 5f63 6f6c  return index_col
+00001430: 730a 0a0a 636c 6173 7320 5365 7373 696f  s...class Sessio
+00001440: 6e28 0a20 2020 2074 6869 7264 5f70 6172  n(.    third_par
+00001450: 7479 5f70 616e 6461 735f 6762 712e 4742  ty_pandas_gbq.GB
+00001460: 5149 4f4d 6978 696e 2c0a 2020 2020 7468  QIOMixin,.    th
+00001470: 6972 645f 7061 7274 795f 7061 6e64 6173  ird_party_pandas
+00001480: 5f70 6172 7175 6574 2e50 6172 7175 6574  _parquet.Parquet
+00001490: 494f 4d69 7869 6e2c 0a20 2020 2074 6869  IOMixin,.    thi
+000014a0: 7264 5f70 6172 7479 5f70 616e 6461 735f  rd_party_pandas_
+000014b0: 7069 636b 6c65 2e50 6963 6b6c 6549 4f4d  pickle.PickleIOM
+000014c0: 6978 696e 2c0a 2020 2020 7468 6972 645f  ixin,.    third_
+000014d0: 7061 7274 795f 7061 6e64 6173 5f72 6561  party_pandas_rea
+000014e0: 6465 7273 2e52 6561 6465 7249 4f4d 6978  ders.ReaderIOMix
+000014f0: 696e 2c0a 293a 0a20 2020 2022 2222 4573  in,.):.    """Es
+00001500: 7461 626c 6973 6865 7320 6120 4269 6751  tablishes a BigQ
+00001510: 7565 7279 2063 6f6e 6e65 6374 696f 6e20  uery connection 
+00001520: 746f 2063 6170 7475 7265 2061 2067 726f  to capture a gro
+00001530: 7570 206f 6620 6a6f 6220 6163 7469 7669  up of job activi
+00001540: 7469 6573 2072 656c 6174 6564 2074 6f0a  ties related to.
+00001550: 2020 2020 4461 7461 4672 616d 6573 2e0a      DataFrames..
+00001560: 0a20 2020 2041 7267 733a 0a20 2020 2020  .    Args:.     
+00001570: 2020 2063 6f6e 7465 7874 2028 6269 6766     context (bigf
+00001580: 7261 6d65 732e 5f63 6f6e 6669 672e 6269  rames._config.bi
+00001590: 6771 7565 7279 5f6f 7074 696f 6e73 2e42  gquery_options.B
+000015a0: 6967 5175 6572 794f 7074 696f 6e73 293a  igQueryOptions):
+000015b0: 0a20 2020 2020 2020 2020 2020 2043 6f6e  .            Con
+000015c0: 6669 6775 7261 7469 6f6e 2061 646a 7573  figuration adjus
+000015d0: 7469 6e67 2068 6f77 2074 6f20 636f 6e6e  ting how to conn
+000015e0: 6563 7420 746f 2042 6967 5175 6572 7920  ect to BigQuery 
+000015f0: 616e 6420 7265 6c61 7465 640a 2020 2020  and related.    
+00001600: 2020 2020 2020 2020 4150 4973 2e20 4e6f          APIs. No
+00001610: 7465 2074 6861 7420 736f 6d65 206f 7074  te that some opt
+00001620: 696f 6e73 2061 7265 2069 676e 6f72 6564  ions are ignored
+00001630: 2069 6620 6060 636c 6965 6e74 735f 7072   if ``clients_pr
+00001640: 6f76 6964 6572 6060 2069 730a 2020 2020  ovider`` is.    
+00001650: 2020 2020 2020 2020 7365 742e 0a20 2020          set..   
+00001660: 2020 2020 2063 6c69 656e 7473 5f70 726f       clients_pro
+00001670: 7669 6465 7220 2862 6967 6672 616d 6573  vider (bigframes
+00001680: 2e73 6573 7369 6f6e 2e63 6c69 656e 7473  .session.clients
+00001690: 2e43 6c69 656e 7473 5072 6f76 6964 6572  .ClientsProvider
+000016a0: 293a 0a20 2020 2020 2020 2020 2020 2041  ):.            A
+000016b0: 6e20 6f62 6a65 6374 2070 726f 7669 6469  n object providi
+000016c0: 6e67 2063 6c69 656e 7420 6c69 6272 6172  ng client librar
+000016d0: 7920 6f62 6a65 6374 732e 0a20 2020 2022  y objects..    "
+000016e0: 2222 0a0a 2020 2020 6465 6620 5f5f 696e  ""..    def __in
+000016f0: 6974 5f5f 280a 2020 2020 2020 2020 7365  it__(.        se
+00001700: 6c66 2c0a 2020 2020 2020 2020 636f 6e74  lf,.        cont
+00001710: 6578 743a 204f 7074 696f 6e61 6c5b 6269  ext: Optional[bi
+00001720: 6771 7565 7279 5f6f 7074 696f 6e73 2e42  gquery_options.B
+00001730: 6967 5175 6572 794f 7074 696f 6e73 5d20  igQueryOptions] 
+00001740: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+00001750: 636c 6965 6e74 735f 7072 6f76 6964 6572  clients_provider
+00001760: 3a20 4f70 7469 6f6e 616c 5b62 6967 6672  : Optional[bigfr
+00001770: 616d 6573 2e73 6573 7369 6f6e 2e63 6c69  ames.session.cli
+00001780: 656e 7473 2e43 6c69 656e 7473 5072 6f76  ents.ClientsProv
+00001790: 6964 6572 5d20 3d20 4e6f 6e65 2c0a 2020  ider] = None,.  
+000017a0: 2020 293a 0a20 2020 2020 2020 2069 6620    ):.        if 
+000017b0: 636f 6e74 6578 7420 6973 204e 6f6e 653a  context is None:
+000017c0: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
+000017d0: 7465 7874 203d 2062 6967 7175 6572 795f  text = bigquery_
+000017e0: 6f70 7469 6f6e 732e 4269 6751 7565 7279  options.BigQuery
+000017f0: 4f70 7469 6f6e 7328 290a 0a20 2020 2020  Options()..     
+00001800: 2020 2069 6620 636f 6e74 6578 742e 6c6f     if context.lo
+00001810: 6361 7469 6f6e 2069 7320 4e6f 6e65 3a0a  cation is None:.
+00001820: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00001830: 2e5f 6c6f 6361 7469 6f6e 203d 2022 5553  ._location = "US
+00001840: 220a 2020 2020 2020 2020 2020 2020 7761  ".            wa
+00001850: 726e 696e 6773 2e77 6172 6e28 0a20 2020  rnings.warn(.   
+00001860: 2020 2020 2020 2020 2020 2020 2066 224e               f"N
+00001870: 6f20 6578 706c 6963 6974 206c 6f63 6174  o explicit locat
+00001880: 696f 6e20 6973 2073 6574 2c20 736f 2075  ion is set, so u
+00001890: 7369 6e67 206c 6f63 6174 696f 6e20 7b73  sing location {s
+000018a0: 656c 662e 5f6c 6f63 6174 696f 6e7d 2066  elf._location} f
+000018b0: 6f72 2074 6865 2073 6573 7369 6f6e 2e22  or the session."
+000018c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000018d0: 2020 2320 5573 6572 2773 2063 6f64 650a    # User's code.
+000018e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000018f0: 2320 2d3e 2067 6574 5f67 6c6f 6261 6c5f  # -> get_global_
+00001900: 7365 7373 696f 6e28 290a 2020 2020 2020  session().      
+00001910: 2020 2020 2020 2020 2020 2320 2d3e 2063            # -> c
+00001920: 6f6e 6e65 6374 2829 0a20 2020 2020 2020  onnect().       
+00001930: 2020 2020 2020 2020 2023 202d 3e20 5365           # -> Se
+00001940: 7373 696f 6e28 290a 2020 2020 2020 2020  ssion().        
+00001950: 2020 2020 2020 2020 230a 2020 2020 2020          #.      
+00001960: 2020 2020 2020 2020 2020 2320 4e6f 7465            # Note
+00001970: 3a20 5765 2063 6f75 6c64 2061 6c73 6f20  : We could also 
+00001980: 6861 7665 3a0a 2020 2020 2020 2020 2020  have:.          
+00001990: 2020 2020 2020 2320 5573 6572 2773 2063        # User's c
+000019a0: 6f64 650a 2020 2020 2020 2020 2020 2020  ode.            
+000019b0: 2020 2020 2320 2d3e 2072 6561 645f 6762      # -> read_gb
+000019c0: 7128 290a 2020 2020 2020 2020 2020 2020  q().            
+000019d0: 2020 2020 2320 2d3e 2077 6974 685f 6465      # -> with_de
+000019e0: 6661 756c 745f 7365 7373 696f 6e28 290a  fault_session().
+000019f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001a00: 2320 2d3e 2067 6574 5f67 6c6f 6261 6c5f  # -> get_global_
+00001a10: 7365 7373 696f 6e28 290a 2020 2020 2020  session().      
+00001a20: 2020 2020 2020 2020 2020 2320 2d3e 2063            # -> c
+00001a30: 6f6e 6e65 6374 2829 0a20 2020 2020 2020  onnect().       
+00001a40: 2020 2020 2020 2020 2023 202d 3e20 5365           # -> Se
+00001a50: 7373 696f 6e28 290a 2020 2020 2020 2020  ssion().        
+00001a60: 2020 2020 2020 2020 2320 6275 7420 7765          # but we
+00001a70: 2063 7572 7265 6e74 6c79 2068 6176 6520   currently have 
+00001a80: 6e6f 2077 6179 2074 6f20 6469 7361 6d62  no way to disamb
+00001a90: 6967 7561 7465 2074 6865 7365 0a20 2020  iguate these.   
+00001aa0: 2020 2020 2020 2020 2020 2020 2023 2073               # s
+00001ab0: 6974 7561 7469 6f6e 732e 0a20 2020 2020  ituations..     
+00001ac0: 2020 2020 2020 2020 2020 2073 7461 636b             stack
+00001ad0: 6c65 7665 6c3d 342c 0a20 2020 2020 2020  level=4,.       
+00001ae0: 2020 2020 2020 2020 2063 6174 6567 6f72           categor
+00001af0: 793d 6269 6766 7261 6d65 732e 6578 6365  y=bigframes.exce
+00001b00: 7074 696f 6e73 2e44 6566 6175 6c74 4c6f  ptions.DefaultLo
+00001b10: 6361 7469 6f6e 5761 726e 696e 672c 0a20  cationWarning,. 
+00001b20: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00001b30: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00001b40: 2020 2020 2020 2073 656c 662e 5f6c 6f63         self._loc
+00001b50: 6174 696f 6e20 3d20 636f 6e74 6578 742e  ation = context.
+00001b60: 6c6f 6361 7469 6f6e 0a0a 2020 2020 2020  location..      
+00001b70: 2020 7365 6c66 2e5f 6271 5f6b 6d73 5f6b    self._bq_kms_k
+00001b80: 6579 5f6e 616d 6520 3d20 636f 6e74 6578  ey_name = contex
+00001b90: 742e 6b6d 735f 6b65 795f 6e61 6d65 0a0a  t.kms_key_name..
+00001ba0: 2020 2020 2020 2020 2320 496e 7374 616e          # Instan
+00001bb0: 7469 6174 6520 6120 636c 6965 6e74 7320  tiate a clients 
+00001bc0: 7072 6f76 6964 6572 2074 6f20 6865 6c70  provider to help
+00001bd0: 2077 6974 6820 636c 6f75 6420 636c 6965   with cloud clie
+00001be0: 6e74 7320 7468 6174 2077 696c 6c20 6265  nts that will be
+00001bf0: 0a20 2020 2020 2020 2023 2075 7365 6420  .        # used 
+00001c00: 696e 2074 6865 2066 7574 7572 6520 6f70  in the future op
+00001c10: 6572 6174 696f 6e73 2069 6e20 7468 6520  erations in the 
+00001c20: 7365 7373 696f 6e0a 2020 2020 2020 2020  session.        
+00001c30: 6966 2063 6c69 656e 7473 5f70 726f 7669  if clients_provi
+00001c40: 6465 723a 0a20 2020 2020 2020 2020 2020  der:.           
+00001c50: 2073 656c 662e 5f63 6c69 656e 7473 5f70   self._clients_p
+00001c60: 726f 7669 6465 7220 3d20 636c 6965 6e74  rovider = client
+00001c70: 735f 7072 6f76 6964 6572 0a20 2020 2020  s_provider.     
+00001c80: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00001c90: 2020 2020 2073 656c 662e 5f63 6c69 656e       self._clien
+00001ca0: 7473 5f70 726f 7669 6465 7220 3d20 6269  ts_provider = bi
+00001cb0: 6766 7261 6d65 732e 7365 7373 696f 6e2e  gframes.session.
+00001cc0: 636c 6965 6e74 732e 436c 6965 6e74 7350  clients.ClientsP
+00001cd0: 726f 7669 6465 7228 0a20 2020 2020 2020  rovider(.       
+00001ce0: 2020 2020 2020 2020 2070 726f 6a65 6374           project
+00001cf0: 3d63 6f6e 7465 7874 2e70 726f 6a65 6374  =context.project
+00001d00: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00001d10: 2020 6c6f 6361 7469 6f6e 3d73 656c 662e    location=self.
+00001d20: 5f6c 6f63 6174 696f 6e2c 0a20 2020 2020  _location,.     
+00001d30: 2020 2020 2020 2020 2020 2075 7365 5f72             use_r
+00001d40: 6567 696f 6e61 6c5f 656e 6470 6f69 6e74  egional_endpoint
+00001d50: 733d 636f 6e74 6578 742e 7573 655f 7265  s=context.use_re
+00001d60: 6769 6f6e 616c 5f65 6e64 706f 696e 7473  gional_endpoints
+00001d70: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00001d80: 2020 6372 6564 656e 7469 616c 733d 636f    credentials=co
+00001d90: 6e74 6578 742e 6372 6564 656e 7469 616c  ntext.credential
+00001da0: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+00001db0: 2020 2061 7070 6c69 6361 7469 6f6e 5f6e     application_n
+00001dc0: 616d 653d 636f 6e74 6578 742e 6170 706c  ame=context.appl
+00001dd0: 6963 6174 696f 6e5f 6e61 6d65 2c0a 2020  ication_name,.  
+00001de0: 2020 2020 2020 2020 2020 2020 2020 6271                bq
+00001df0: 5f6b 6d73 5f6b 6579 5f6e 616d 653d 7365  _kms_key_name=se
+00001e00: 6c66 2e5f 6271 5f6b 6d73 5f6b 6579 5f6e  lf._bq_kms_key_n
+00001e10: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
+00001e20: 2029 0a0a 2020 2020 2020 2020 7365 6c66   )..        self
+00001e30: 2e5f 616e 6f6e 796d 6f75 735f 6461 7461  ._anonymous_data
+00001e40: 7365 7420 3d20 280a 2020 2020 2020 2020  set = (.        
+00001e50: 2020 2020 6269 6766 7261 6d65 732e 7365      bigframes.se
+00001e60: 7373 696f 6e2e 5f69 6f2e 6269 6771 7565  ssion._io.bigque
+00001e70: 7279 2e63 7265 6174 655f 6271 5f64 6174  ry.create_bq_dat
+00001e80: 6173 6574 5f72 6566 6572 656e 6365 280a  aset_reference(.
+00001e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001ea0: 7365 6c66 2e62 7163 6c69 656e 742c 206c  self.bqclient, l
+00001eb0: 6f63 6174 696f 6e3d 7365 6c66 2e5f 6c6f  ocation=self._lo
+00001ec0: 6361 7469 6f6e 0a20 2020 2020 2020 2020  cation.         
+00001ed0: 2020 2029 0a20 2020 2020 2020 2029 0a0a     ).        )..
+00001ee0: 2020 2020 2020 2020 2320 544f 444f 2873          # TODO(s
+00001ef0: 686f 6273 293a 2052 656d 6f76 6520 7468  hobs): Remove th
+00001f00: 6973 206c 6f67 6963 2061 6674 6572 2068  is logic after h
+00001f10: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
+00001f20: 6d2f 6962 6973 2d70 726f 6a65 6374 2f69  m/ibis-project/i
+00001f30: 6269 732f 6973 7375 6573 2f38 3439 340a  bis/issues/8494.
+00001f40: 2020 2020 2020 2020 2320 6861 7320 6265          # has be
+00001f50: 656e 2066 6978 6564 2e20 5468 6520 6962  en fixed. The ib
+00001f60: 6973 2063 6c69 656e 7420 6368 616e 6765  is client change
+00001f70: 7320 7468 6520 6465 6661 756c 7420 7175  s the default qu
+00001f80: 6572 7920 6a6f 6220 636f 6e66 6967 0a20  ery job config. 
+00001f90: 2020 2020 2020 2023 2073 6f20 7765 2061         # so we a
+00001fa0: 7265 2067 6f69 6e67 2074 6f20 7265 6d65  re going to reme
+00001fb0: 6d62 6572 2074 6865 2063 7572 7265 6e74  mber the current
+00001fc0: 2063 6f6e 6669 6720 616e 6420 7265 7374   config and rest
+00001fd0: 6f72 6520 6974 2061 6674 6572 0a20 2020  ore it after.   
+00001fe0: 2020 2020 2023 2074 6865 2069 6269 7320       # the ibis 
+00001ff0: 636c 6965 6e74 2068 6173 2062 6565 6e20  client has been 
+00002000: 6372 6561 7465 640a 2020 2020 2020 2020  created.        
+00002010: 6f72 6967 696e 616c 5f64 6566 6175 6c74  original_default
+00002020: 5f71 7565 7279 5f6a 6f62 5f63 6f6e 6669  _query_job_confi
+00002030: 6720 3d20 7365 6c66 2e62 7163 6c69 656e  g = self.bqclien
+00002040: 742e 6465 6661 756c 745f 7175 6572 795f  t.default_query_
+00002050: 6a6f 625f 636f 6e66 6967 0a0a 2020 2020  job_config..    
+00002060: 2020 2020 7365 6c66 2e69 6269 735f 636c      self.ibis_cl
+00002070: 6965 6e74 203d 2074 7970 696e 672e 6361  ient = typing.ca
+00002080: 7374 280a 2020 2020 2020 2020 2020 2020  st(.            
+00002090: 6962 6973 5f62 6967 7175 6572 792e 4261  ibis_bigquery.Ba
+000020a0: 636b 656e 642c 0a20 2020 2020 2020 2020  ckend,.         
+000020b0: 2020 2069 6269 732e 6269 6771 7565 7279     ibis.bigquery
+000020c0: 2e63 6f6e 6e65 6374 280a 2020 2020 2020  .connect(.      
+000020d0: 2020 2020 2020 2020 2020 7072 6f6a 6563            projec
+000020e0: 745f 6964 3d63 6f6e 7465 7874 2e70 726f  t_id=context.pro
+000020f0: 6a65 6374 2c0a 2020 2020 2020 2020 2020  ject,.          
+00002100: 2020 2020 2020 636c 6965 6e74 3d73 656c        client=sel
+00002110: 662e 6271 636c 6965 6e74 2c0a 2020 2020  f.bqclient,.    
+00002120: 2020 2020 2020 2020 2020 2020 7374 6f72              stor
+00002130: 6167 655f 636c 6965 6e74 3d73 656c 662e  age_client=self.
+00002140: 6271 7374 6f72 6167 6572 6561 6463 6c69  bqstoragereadcli
+00002150: 656e 742c 0a20 2020 2020 2020 2020 2020  ent,.           
+00002160: 2029 2c0a 2020 2020 2020 2020 290a 0a20   ),.        ).. 
+00002170: 2020 2020 2020 2073 656c 662e 6271 636c         self.bqcl
+00002180: 6965 6e74 2e64 6566 6175 6c74 5f71 7565  ient.default_que
+00002190: 7279 5f6a 6f62 5f63 6f6e 6669 6720 3d20  ry_job_config = 
+000021a0: 6f72 6967 696e 616c 5f64 6566 6175 6c74  original_default
+000021b0: 5f71 7565 7279 5f6a 6f62 5f63 6f6e 6669  _query_job_confi
+000021c0: 670a 0a20 2020 2020 2020 2023 2052 6573  g..        # Res
+000021d0: 6f6c 7665 2074 6865 2042 5120 636f 6e6e  olve the BQ conn
+000021e0: 6563 7469 6f6e 2066 6f72 2072 656d 6f74  ection for remot
+000021f0: 6520 6675 6e63 7469 6f6e 2061 6e64 2056  e function and V
+00002200: 6572 7465 7820 4149 2069 6e74 6567 7261  ertex AI integra
+00002210: 7469 6f6e 0a20 2020 2020 2020 2073 656c  tion.        sel
+00002220: 662e 5f62 715f 636f 6e6e 6563 7469 6f6e  f._bq_connection
+00002230: 203d 2063 6f6e 7465 7874 2e62 715f 636f   = context.bq_co
+00002240: 6e6e 6563 7469 6f6e 206f 7220 5f42 4947  nnection or _BIG
+00002250: 4652 414d 4553 5f44 4546 4155 4c54 5f43  FRAMES_DEFAULT_C
+00002260: 4f4e 4e45 4354 494f 4e5f 4944 0a20 2020  ONNECTION_ID.   
+00002270: 2020 2020 2073 656c 662e 5f73 6b69 705f       self._skip_
+00002280: 6271 5f63 6f6e 6e65 6374 696f 6e5f 6368  bq_connection_ch
+00002290: 6563 6b20 3d20 636f 6e74 6578 742e 5f73  eck = context._s
+000022a0: 6b69 705f 6271 5f63 6f6e 6e65 6374 696f  kip_bq_connectio
+000022b0: 6e5f 6368 6563 6b0a 0a20 2020 2020 2020  n_check..       
+000022c0: 2023 204e 6f77 2074 6861 7420 7765 2772   # Now that we'r
+000022d0: 6520 7374 6172 7469 6e67 2074 6865 2073  e starting the s
+000022e0: 6573 7369 6f6e 2c20 646f 6e27 7420 616c  ession, don't al
+000022f0: 6c6f 7720 7468 6520 6f70 7469 6f6e 7320  low the options 
+00002300: 746f 2062 650a 2020 2020 2020 2020 2320  to be.        # 
+00002310: 6368 616e 6765 642e 0a20 2020 2020 2020  changed..       
+00002320: 2063 6f6e 7465 7874 2e5f 7365 7373 696f   context._sessio
+00002330: 6e5f 7374 6172 7465 6420 3d20 5472 7565  n_started = True
+00002340: 0a20 2020 2020 2020 2073 656c 662e 5f64  .        self._d
+00002350: 665f 736e 6170 7368 6f74 3a20 4469 6374  f_snapshot: Dict
+00002360: 5b0a 2020 2020 2020 2020 2020 2020 6269  [.            bi
+00002370: 6771 7565 7279 2e54 6162 6c65 5265 6665  gquery.TableRefe
+00002380: 7265 6e63 652c 2054 7570 6c65 5b64 6174  rence, Tuple[dat
+00002390: 6574 696d 652e 6461 7465 7469 6d65 2c20  etime.datetime, 
+000023a0: 6269 6771 7565 7279 2e54 6162 6c65 5d0a  bigquery.Table].
+000023b0: 2020 2020 2020 2020 5d20 3d20 7b7d 0a0a          ] = {}..
+000023c0: 2020 2020 2020 2020 2320 756e 6971 7565          # unique
+000023d0: 2073 6573 7369 6f6e 2069 6465 6e74 6966   session identif
+000023e0: 6965 722c 2073 686f 7274 2065 6e6f 7567  ier, short enoug
+000023f0: 6820 746f 2062 6520 6875 6d61 6e20 7265  h to be human re
+00002400: 6164 6162 6c65 0a20 2020 2020 2020 2023  adable.        #
+00002410: 206f 6e6c 7920 6e65 6564 7320 746f 2062   only needs to b
+00002420: 6520 756e 6971 7565 2061 6d6f 6e67 2073  e unique among s
+00002430: 6573 7369 6f6e 7320 6372 6561 7465 6420  essions created 
+00002440: 6279 2074 6865 2073 616d 6520 7573 6572  by the same user
+00002450: 0a20 2020 2020 2020 2023 2061 7420 7468  .        # at th
+00002460: 6520 7361 6d65 2074 696d 6520 696e 2074  e same time in t
+00002470: 6865 2073 616d 6520 7265 6769 6f6e 0a20  he same region. 
+00002480: 2020 2020 2020 2073 656c 662e 5f73 6573         self._ses
+00002490: 7369 6f6e 5f69 643a 2073 7472 203d 2022  sion_id: str = "
+000024a0: 7365 7373 696f 6e22 202b 2073 6563 7265  session" + secre
+000024b0: 7473 2e74 6f6b 656e 5f68 6578 2833 290a  ts.token_hex(3).
+000024c0: 2020 2020 2020 2020 7365 6c66 2e5f 7461          self._ta
+000024d0: 626c 655f 6964 733a 204c 6973 745b 7374  ble_ids: List[st
+000024e0: 725d 203d 205b 5d0a 2020 2020 2020 2020  r] = [].        
+000024f0: 2320 7374 6f72 6520 7461 626c 6520 6964  # store table id
+00002500: 7320 616e 6420 6465 6c65 7465 2074 6865  s and delete the
+00002510: 6d20 7768 656e 2074 6865 2073 6573 7369  m when the sessi
+00002520: 6f6e 2069 7320 636c 6f73 6564 0a0a 2020  on is closed..  
+00002530: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+00002540: 6465 6620 6271 636c 6965 6e74 2873 656c  def bqclient(sel
+00002550: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
+00002560: 726e 2073 656c 662e 5f63 6c69 656e 7473  rn self._clients
+00002570: 5f70 726f 7669 6465 722e 6271 636c 6965  _provider.bqclie
+00002580: 6e74 0a0a 2020 2020 4070 726f 7065 7274  nt..    @propert
+00002590: 790a 2020 2020 6465 6620 6271 636f 6e6e  y.    def bqconn
+000025a0: 6563 7469 6f6e 636c 6965 6e74 2873 656c  ectionclient(sel
+000025b0: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
+000025c0: 726e 2073 656c 662e 5f63 6c69 656e 7473  rn self._clients
+000025d0: 5f70 726f 7669 6465 722e 6271 636f 6e6e  _provider.bqconn
+000025e0: 6563 7469 6f6e 636c 6965 6e74 0a0a 2020  ectionclient..  
+000025f0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+00002600: 6465 6620 6271 7374 6f72 6167 6572 6561  def bqstoragerea
+00002610: 6463 6c69 656e 7428 7365 6c66 293a 0a20  dclient(self):. 
+00002620: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00002630: 6c66 2e5f 636c 6965 6e74 735f 7072 6f76  lf._clients_prov
+00002640: 6964 6572 2e62 7173 746f 7261 6765 7265  ider.bqstoragere
+00002650: 6164 636c 6965 6e74 0a0a 2020 2020 4070  adclient..    @p
+00002660: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+00002670: 636c 6f75 6466 756e 6374 696f 6e73 636c  cloudfunctionscl
+00002680: 6965 6e74 2873 656c 6629 3a0a 2020 2020  ient(self):.    
+00002690: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+000026a0: 5f63 6c69 656e 7473 5f70 726f 7669 6465  _clients_provide
+000026b0: 722e 636c 6f75 6466 756e 6374 696f 6e73  r.cloudfunctions
+000026c0: 636c 6965 6e74 0a0a 2020 2020 4070 726f  client..    @pro
+000026d0: 7065 7274 790a 2020 2020 6465 6620 7265  perty.    def re
+000026e0: 736f 7572 6365 6d61 6e61 6765 7263 6c69  sourcemanagercli
+000026f0: 656e 7428 7365 6c66 293a 0a20 2020 2020  ent(self):.     
+00002700: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+00002710: 636c 6965 6e74 735f 7072 6f76 6964 6572  clients_provider
+00002720: 2e72 6573 6f75 7263 656d 616e 6167 6572  .resourcemanager
+00002730: 636c 6965 6e74 0a0a 2020 2020 5f62 715f  client..    _bq_
+00002740: 636f 6e6e 6563 7469 6f6e 5f6d 616e 6167  connection_manag
+00002750: 6572 3a20 4f70 7469 6f6e 616c 5b62 6967  er: Optional[big
+00002760: 6672 616d 6573 2e63 6c69 656e 7473 2e42  frames.clients.B
+00002770: 7143 6f6e 6e65 6374 696f 6e4d 616e 6167  qConnectionManag
+00002780: 6572 5d20 3d20 4e6f 6e65 0a0a 2020 2020  er] = None..    
+00002790: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+000027a0: 6620 6271 636f 6e6e 6563 7469 6f6e 6d61  f bqconnectionma
+000027b0: 6e61 6765 7228 7365 6c66 293a 0a20 2020  nager(self):.   
+000027c0: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
+000027d0: 2e5f 736b 6970 5f62 715f 636f 6e6e 6563  ._skip_bq_connec
+000027e0: 7469 6f6e 5f63 6865 636b 2061 6e64 206e  tion_check and n
+000027f0: 6f74 2073 656c 662e 5f62 715f 636f 6e6e  ot self._bq_conn
+00002800: 6563 7469 6f6e 5f6d 616e 6167 6572 3a0a  ection_manager:.
+00002810: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00002820: 2e5f 6271 5f63 6f6e 6e65 6374 696f 6e5f  ._bq_connection_
+00002830: 6d61 6e61 6765 7220 3d20 6269 6766 7261  manager = bigfra
+00002840: 6d65 732e 636c 6965 6e74 732e 4271 436f  mes.clients.BqCo
+00002850: 6e6e 6563 7469 6f6e 4d61 6e61 6765 7228  nnectionManager(
+00002860: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002870: 2073 656c 662e 6271 636f 6e6e 6563 7469   self.bqconnecti
+00002880: 6f6e 636c 6965 6e74 2c20 7365 6c66 2e72  onclient, self.r
+00002890: 6573 6f75 7263 656d 616e 6167 6572 636c  esourcemanagercl
+000028a0: 6965 6e74 0a20 2020 2020 2020 2020 2020  ient.           
+000028b0: 2029 0a20 2020 2020 2020 2072 6574 7572   ).        retur
+000028c0: 6e20 7365 6c66 2e5f 6271 5f63 6f6e 6e65  n self._bq_conne
+000028d0: 6374 696f 6e5f 6d61 6e61 6765 720a 0a20  ction_manager.. 
+000028e0: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+000028f0: 2064 6566 2073 6573 7369 6f6e 5f69 6428   def session_id(
+00002900: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
+00002910: 6574 7572 6e20 7365 6c66 2e5f 7365 7373  eturn self._sess
+00002920: 696f 6e5f 6964 0a0a 2020 2020 4070 726f  ion_id..    @pro
+00002930: 7065 7274 790a 2020 2020 6465 6620 5f70  perty.    def _p
+00002940: 726f 6a65 6374 2873 656c 6629 3a0a 2020  roject(self):.  
+00002950: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00002960: 662e 6271 636c 6965 6e74 2e70 726f 6a65  f.bqclient.proje
+00002970: 6374 0a0a 2020 2020 6465 6620 5f5f 6861  ct..    def __ha
+00002980: 7368 5f5f 2873 656c 6629 3a0a 2020 2020  sh__(self):.    
+00002990: 2020 2020 2320 5374 6162 6c65 2068 6173      # Stable has
+000029a0: 6820 6e65 6564 6564 2074 6f20 7573 6520  h needed to use 
+000029b0: 696e 2065 7870 7265 7373 696f 6e20 7472  in expression tr
+000029c0: 6565 0a20 2020 2020 2020 2072 6574 7572  ee.        retur
+000029d0: 6e20 6861 7368 2873 7472 2873 656c 662e  n hash(str(self.
+000029e0: 5f61 6e6f 6e79 6d6f 7573 5f64 6174 6173  _anonymous_datas
+000029f0: 6574 2929 0a0a 2020 2020 6465 6620 636c  et))..    def cl
+00002a00: 6f73 6528 7365 6c66 293a 0a20 2020 2020  ose(self):.     
+00002a10: 2020 2022 2222 4465 6c65 7465 2074 6162     """Delete tab
+00002a20: 6c65 7320 7468 6174 2077 6572 6520 6372  les that were cr
+00002a30: 6561 7465 6420 7769 7468 2074 6869 7320  eated with this 
+00002a40: 7365 7373 696f 6e27 7320 7365 7373 696f  session's sessio
+00002a50: 6e5f 6964 2e22 2222 0a20 2020 2020 2020  n_id.""".       
+00002a60: 2063 6c69 656e 7420 3d20 7365 6c66 2e62   client = self.b
+00002a70: 7163 6c69 656e 740a 2020 2020 2020 2020  qclient.        
+00002a80: 7072 6f6a 6563 745f 6964 203d 2073 656c  project_id = sel
+00002a90: 662e 5f61 6e6f 6e79 6d6f 7573 5f64 6174  f._anonymous_dat
+00002aa0: 6173 6574 2e70 726f 6a65 6374 0a20 2020  aset.project.   
+00002ab0: 2020 2020 2064 6174 6173 6574 5f69 6420       dataset_id 
+00002ac0: 3d20 7365 6c66 2e5f 616e 6f6e 796d 6f75  = self._anonymou
+00002ad0: 735f 6461 7461 7365 742e 6461 7461 7365  s_dataset.datase
+00002ae0: 745f 6964 0a0a 2020 2020 2020 2020 666f  t_id..        fo
+00002af0: 7220 7461 626c 655f 6964 2069 6e20 7365  r table_id in se
+00002b00: 6c66 2e5f 7461 626c 655f 6964 733a 0a20  lf._table_ids:. 
+00002b10: 2020 2020 2020 2020 2020 2066 756c 6c5f             full_
+00002b20: 6964 203d 2022 2e22 2e6a 6f69 6e28 5b70  id = ".".join([p
+00002b30: 726f 6a65 6374 5f69 642c 2064 6174 6173  roject_id, datas
+00002b40: 6574 5f69 642c 2074 6162 6c65 5f69 645d  et_id, table_id]
+00002b50: 290a 2020 2020 2020 2020 2020 2020 636c  ).            cl
+00002b60: 6965 6e74 2e64 656c 6574 655f 7461 626c  ient.delete_tabl
+00002b70: 6528 6675 6c6c 5f69 642c 206e 6f74 5f66  e(full_id, not_f
+00002b80: 6f75 6e64 5f6f 6b3d 5472 7565 290a 0a20  ound_ok=True).. 
+00002b90: 2020 2064 6566 2072 6561 645f 6762 7128     def read_gbq(
+00002ba0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00002bb0: 2020 2020 2020 2071 7565 7279 5f6f 725f         query_or_
+00002bc0: 7461 626c 653a 2073 7472 2c0a 2020 2020  table: str,.    
+00002bd0: 2020 2020 2a2c 0a20 2020 2020 2020 2069      *,.        i
+00002be0: 6e64 6578 5f63 6f6c 3a20 4974 6572 6162  ndex_col: Iterab
+00002bf0: 6c65 5b73 7472 5d20 7c20 7374 7220 7c20  le[str] | str | 
+00002c00: 6269 6766 7261 6d65 732e 656e 756d 732e  bigframes.enums.
+00002c10: 4465 6661 756c 7449 6e64 6578 4b69 6e64  DefaultIndexKind
+00002c20: 203d 2028 292c 0a20 2020 2020 2020 2063   = (),.        c
+00002c30: 6f6c 756d 6e73 3a20 4974 6572 6162 6c65  olumns: Iterable
+00002c40: 5b73 7472 5d20 3d20 2829 2c0a 2020 2020  [str] = (),.    
+00002c50: 2020 2020 636f 6e66 6967 7572 6174 696f      configuratio
+00002c60: 6e3a 204f 7074 696f 6e61 6c5b 4469 6374  n: Optional[Dict
+00002c70: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
+00002c80: 2020 6d61 785f 7265 7375 6c74 733a 204f    max_results: O
+00002c90: 7074 696f 6e61 6c5b 696e 745d 203d 204e  ptional[int] = N
+00002ca0: 6f6e 652c 0a20 2020 2020 2020 2066 696c  one,.        fil
+00002cb0: 7465 7273 3a20 7468 6972 645f 7061 7274  ters: third_part
+00002cc0: 795f 7061 6e64 6173 5f67 6271 2e46 696c  y_pandas_gbq.Fil
+00002cd0: 7465 7273 5479 7065 203d 2028 292c 0a20  tersType = (),. 
+00002ce0: 2020 2020 2020 2075 7365 5f63 6163 6865         use_cache
+00002cf0: 3a20 4f70 7469 6f6e 616c 5b62 6f6f 6c5d  : Optional[bool]
+00002d00: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+00002d10: 2063 6f6c 5f6f 7264 6572 3a20 4974 6572   col_order: Iter
+00002d20: 6162 6c65 5b73 7472 5d20 3d20 2829 2c0a  able[str] = (),.
+00002d30: 2020 2020 2020 2020 2320 4164 6420 6120          # Add a 
+00002d40: 7665 7269 6679 2069 6e64 6578 2061 7267  verify index arg
+00002d50: 756d 656e 7420 7468 6174 2066 6169 6c73  ument that fails
+00002d60: 2069 6620 7468 6520 696e 6465 7820 6973   if the index is
+00002d70: 206e 6f74 2075 6e69 7175 652e 0a20 2020   not unique..   
+00002d80: 2029 202d 3e20 6461 7461 6672 616d 652e   ) -> dataframe.
+00002d90: 4461 7461 4672 616d 653a 0a20 2020 2020  DataFrame:.     
+00002da0: 2020 2023 2054 4f44 4f28 622f 3238 3135     # TODO(b/2815
+00002db0: 3731 3231 3429 3a20 4765 6e65 7261 7465  71214): Generate
+00002dc0: 2070 726f 6d70 7420 746f 2073 686f 7720   prompt to show 
+00002dd0: 7468 6520 7072 6f67 7265 7373 206f 6620  the progress of 
+00002de0: 7265 6164 5f67 6271 2e0a 2020 2020 2020  read_gbq..      
+00002df0: 2020 6966 2063 6f6c 756d 6e73 2061 6e64    if columns and
+00002e00: 2063 6f6c 5f6f 7264 6572 3a0a 2020 2020   col_order:.    
+00002e10: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00002e20: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
+00002e30: 2020 2020 2020 2020 2020 224d 7573 7420            "Must 
+00002e40: 7370 6563 6966 7920 6569 7468 6572 2063  specify either c
+00002e50: 6f6c 756d 6e73 2028 7072 6566 6572 7265  olumns (preferre
+00002e60: 6429 206f 7220 636f 6c5f 6f72 6465 722c  d) or col_order,
+00002e70: 206e 6f74 2062 6f74 6822 0a20 2020 2020   not both".     
+00002e80: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00002e90: 2065 6c69 6620 636f 6c5f 6f72 6465 723a   elif col_order:
+00002ea0: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
+00002eb0: 756d 6e73 203d 2063 6f6c 5f6f 7264 6572  umns = col_order
+00002ec0: 0a0a 2020 2020 2020 2020 6669 6c74 6572  ..        filter
+00002ed0: 7320 3d20 6c69 7374 2866 696c 7465 7273  s = list(filters
+00002ee0: 290a 2020 2020 2020 2020 6966 206c 656e  ).        if len
+00002ef0: 2866 696c 7465 7273 2920 213d 2030 206f  (filters) != 0 o
+00002f00: 7220 6266 5f69 6f5f 6269 6771 7565 7279  r bf_io_bigquery
+00002f10: 2e69 735f 7461 626c 655f 7769 7468 5f77  .is_table_with_w
+00002f20: 696c 6463 6172 645f 7375 6666 6978 280a  ildcard_suffix(.
+00002f30: 2020 2020 2020 2020 2020 2020 7175 6572              quer
+00002f40: 795f 6f72 5f74 6162 6c65 0a20 2020 2020  y_or_table.     
+00002f50: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
+00002f60: 2020 2320 544f 444f 2862 2f33 3338 3131    # TODO(b/33811
+00002f70: 3133 3434 293a 2054 6869 7320 6170 7065  1344): This appe
+00002f80: 6172 7320 746f 2062 6520 6d69 7373 696e  ars to be missin
+00002f90: 6720 696e 6465 785f 636f 6c73 2c20 7768  g index_cols, wh
+00002fa0: 6963 680a 2020 2020 2020 2020 2020 2020  ich.            
+00002fb0: 2320 6172 6520 6e65 6365 7373 6172 7920  # are necessary 
+00002fc0: 746f 2062 6520 7365 6c65 6374 6564 2e0a  to be selected..
+00002fd0: 2020 2020 2020 2020 2020 2020 2320 544f              # TO
+00002fe0: 444f 2862 2f33 3338 3033 3935 3137 293a  DO(b/338039517):
+00002ff0: 2052 6566 6163 746f 7220 7468 6973 2074   Refactor this t
+00003000: 6f20 6265 2063 616c 6c65 6420 696e 7369  o be called insi
+00003010: 6465 2062 6f74 680a 2020 2020 2020 2020  de both.        
+00003020: 2020 2020 2320 5f72 6561 645f 6762 715f      # _read_gbq_
+00003030: 7175 6572 7920 616e 6420 5f72 6561 645f  query and _read_
+00003040: 6762 715f 7461 626c 6520 2861 6674 6572  gbq_table (after
+00003050: 2064 6574 6563 7469 6e67 2070 7269 6d61   detecting prima
+00003060: 7279 206b 6579 7329 0a20 2020 2020 2020  ry keys).       
+00003070: 2020 2020 2023 2073 6f20 7765 2063 616e       # so we can
+00003080: 206d 616b 6520 7375 7265 2069 6e64 6578   make sure index
+00003090: 5f63 6f6c 2f69 6e64 6578 5f63 6f6c 7320  _col/index_cols 
+000030a0: 7265 666c 6563 7473 2070 7269 6d61 7279  reflects primary
+000030b0: 206b 6579 732e 0a20 2020 2020 2020 2020   keys..         
+000030c0: 2020 2071 7565 7279 5f6f 725f 7461 626c     query_or_tabl
+000030d0: 6520 3d20 6266 5f69 6f5f 6269 6771 7565  e = bf_io_bigque
+000030e0: 7279 2e74 6f5f 7175 6572 7928 0a20 2020  ry.to_query(.   
+000030f0: 2020 2020 2020 2020 2020 2020 2071 7565               que
+00003100: 7279 5f6f 725f 7461 626c 652c 205f 746f  ry_or_table, _to
+00003110: 5f69 6e64 6578 5f63 6f6c 7328 696e 6465  _index_cols(inde
+00003120: 785f 636f 6c29 2c20 636f 6c75 6d6e 732c  x_col), columns,
+00003130: 2066 696c 7465 7273 0a20 2020 2020 2020   filters.       
+00003140: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00003150: 6966 2062 665f 696f 5f62 6967 7175 6572  if bf_io_bigquer
+00003160: 792e 6973 5f71 7565 7279 2871 7565 7279  y.is_query(query
+00003170: 5f6f 725f 7461 626c 6529 3a0a 2020 2020  _or_table):.    
+00003180: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00003190: 656c 662e 5f72 6561 645f 6762 715f 7175  elf._read_gbq_qu
+000031a0: 6572 7928 0a20 2020 2020 2020 2020 2020  ery(.           
+000031b0: 2020 2020 2071 7565 7279 5f6f 725f 7461       query_or_ta
+000031c0: 626c 652c 0a20 2020 2020 2020 2020 2020  ble,.           
+000031d0: 2020 2020 2069 6e64 6578 5f63 6f6c 3d69       index_col=i
+000031e0: 6e64 6578 5f63 6f6c 2c0a 2020 2020 2020  ndex_col,.      
+000031f0: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
+00003200: 733d 636f 6c75 6d6e 732c 0a20 2020 2020  s=columns,.     
+00003210: 2020 2020 2020 2020 2020 2063 6f6e 6669             confi
+00003220: 6775 7261 7469 6f6e 3d63 6f6e 6669 6775  guration=configu
+00003230: 7261 7469 6f6e 2c0a 2020 2020 2020 2020  ration,.        
+00003240: 2020 2020 2020 2020 6d61 785f 7265 7375          max_resu
+00003250: 6c74 733d 6d61 785f 7265 7375 6c74 732c  lts=max_results,
+00003260: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003270: 2061 7069 5f6e 616d 653d 2272 6561 645f   api_name="read_
+00003280: 6762 7122 2c0a 2020 2020 2020 2020 2020  gbq",.          
+00003290: 2020 2020 2020 7573 655f 6361 6368 653d        use_cache=
+000032a0: 7573 655f 6361 6368 652c 0a20 2020 2020  use_cache,.     
+000032b0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+000032c0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+000032d0: 2020 2069 6620 636f 6e66 6967 7572 6174     if configurat
+000032e0: 696f 6e20 6973 206e 6f74 204e 6f6e 653a  ion is not None:
+000032f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003300: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00003310: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+00003320: 2020 2020 2020 2022 5468 6520 2763 6f6e         "The 'con
+00003330: 6669 6775 7261 7469 6f6e 2720 6172 6775  figuration' argu
+00003340: 6d65 6e74 2069 7320 6e6f 7420 616c 6c6f  ment is not allo
+00003350: 7765 6420 7768 656e 2022 0a20 2020 2020  wed when ".     
+00003360: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00003370: 6469 7265 6374 6c79 2072 6561 6469 6e67  directly reading
+00003380: 2066 726f 6d20 6120 7461 626c 652e 2050   from a table. P
+00003390: 6c65 6173 6520 7265 6d6f 7665 2022 0a20  lease remove ". 
+000033a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000033b0: 2020 2022 2763 6f6e 6669 6775 7261 7469     "'configurati
+000033c0: 6f6e 2720 6f72 2075 7365 2061 2071 7565  on' or use a que
+000033d0: 7279 2e22 0a20 2020 2020 2020 2020 2020  ry.".           
+000033e0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+000033f0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00003400: 5f72 6561 645f 6762 715f 7461 626c 6528  _read_gbq_table(
+00003410: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003420: 2071 7565 7279 5f6f 725f 7461 626c 652c   query_or_table,
+00003430: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003440: 2069 6e64 6578 5f63 6f6c 3d69 6e64 6578   index_col=index
+00003450: 5f63 6f6c 2c0a 2020 2020 2020 2020 2020  _col,.          
+00003460: 2020 2020 2020 636f 6c75 6d6e 733d 636f        columns=co
+00003470: 6c75 6d6e 732c 0a20 2020 2020 2020 2020  lumns,.         
+00003480: 2020 2020 2020 206d 6178 5f72 6573 756c         max_resul
+00003490: 7473 3d6d 6178 5f72 6573 756c 7473 2c0a  ts=max_results,.
+000034a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000034b0: 6170 695f 6e61 6d65 3d22 7265 6164 5f67  api_name="read_g
+000034c0: 6271 222c 0a20 2020 2020 2020 2020 2020  bq",.           
+000034d0: 2020 2020 2075 7365 5f63 6163 6865 3d75       use_cache=u
+000034e0: 7365 5f63 6163 6865 2069 6620 7573 655f  se_cache if use_
+000034f0: 6361 6368 6520 6973 206e 6f74 204e 6f6e  cache is not Non
+00003500: 6520 656c 7365 2054 7275 652c 0a20 2020  e else True,.   
+00003510: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+00003520: 6465 6620 5f71 7565 7279 5f74 6f5f 6465  def _query_to_de
+00003530: 7374 696e 6174 696f 6e28 0a20 2020 2020  stination(.     
+00003540: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+00003550: 2071 7565 7279 3a20 7374 722c 0a20 2020   query: str,.   
+00003560: 2020 2020 2069 6e64 6578 5f63 6f6c 733a       index_cols:
+00003570: 204c 6973 745b 7374 725d 2c0a 2020 2020   List[str],.    
+00003580: 2020 2020 6170 695f 6e61 6d65 3a20 7374      api_name: st
+00003590: 722c 0a20 2020 2020 2020 2063 6f6e 6669  r,.        confi
+000035a0: 6775 7261 7469 6f6e 3a20 6469 6374 203d  guration: dict =
+000035b0: 207b 2271 7565 7279 223a 207b 2275 7365   {"query": {"use
+000035c0: 5175 6572 7943 6163 6865 223a 2054 7275  QueryCache": Tru
+000035d0: 657d 7d2c 0a20 2020 2020 2020 2064 6f5f  e}},.        do_
+000035e0: 636c 7573 7465 7269 6e67 3d54 7275 652c  clustering=True,
+000035f0: 0a20 2020 2029 202d 3e20 5475 706c 655b  .    ) -> Tuple[
+00003600: 4f70 7469 6f6e 616c 5b62 6967 7175 6572  Optional[bigquer
+00003610: 792e 5461 626c 6552 6566 6572 656e 6365  y.TableReference
+00003620: 5d2c 2062 6967 7175 6572 792e 5175 6572  ], bigquery.Quer
+00003630: 794a 6f62 5d3a 0a20 2020 2020 2020 2023  yJob]:.        #
+00003640: 2049 6620 6120 6472 795f 7275 6e20 696e   If a dry_run in
+00003650: 6469 6361 7465 7320 7468 6973 2069 7320  dicates this is 
+00003660: 6e6f 7420 6120 7175 6572 7920 7479 7065  not a query type
+00003670: 206a 6f62 2c20 7468 656e 2064 6f6e 2774   job, then don't
+00003680: 0a20 2020 2020 2020 2023 2062 6f74 6865  .        # bothe
+00003690: 7220 7472 7969 6e67 2074 6f20 646f 2061  r trying to do a
+000036a0: 2043 5245 4154 4520 5445 4d50 2054 4142   CREATE TEMP TAB
+000036b0: 4c45 202e 2e2e 2041 5320 5345 4c45 4354  LE ... AS SELECT
+000036c0: 202e 2e2e 2073 7461 7465 6d65 6e74 2e0a   ... statement..
+000036d0: 2020 2020 2020 2020 6472 795f 7275 6e5f          dry_run_
+000036e0: 636f 6e66 6967 203d 2062 6967 7175 6572  config = bigquer
+000036f0: 792e 5175 6572 794a 6f62 436f 6e66 6967  y.QueryJobConfig
+00003700: 2829 0a20 2020 2020 2020 2064 7279 5f72  ().        dry_r
+00003710: 756e 5f63 6f6e 6669 672e 6472 795f 7275  un_config.dry_ru
+00003720: 6e20 3d20 5472 7565 0a20 2020 2020 2020  n = True.       
+00003730: 205f 2c20 6472 795f 7275 6e5f 6a6f 6220   _, dry_run_job 
+00003740: 3d20 7365 6c66 2e5f 7374 6172 745f 7175  = self._start_qu
+00003750: 6572 7928 7175 6572 792c 206a 6f62 5f63  ery(query, job_c
+00003760: 6f6e 6669 673d 6472 795f 7275 6e5f 636f  onfig=dry_run_co
+00003770: 6e66 6967 290a 2020 2020 2020 2020 6966  nfig).        if
+00003780: 2064 7279 5f72 756e 5f6a 6f62 2e73 7461   dry_run_job.sta
+00003790: 7465 6d65 6e74 5f74 7970 6520 213d 2022  tement_type != "
+000037a0: 5345 4c45 4354 223a 0a20 2020 2020 2020  SELECT":.       
+000037b0: 2020 2020 205f 2c20 7175 6572 795f 6a6f       _, query_jo
+000037c0: 6220 3d20 7365 6c66 2e5f 7374 6172 745f  b = self._start_
+000037d0: 7175 6572 7928 7175 6572 7929 0a20 2020  query(query).   
+000037e0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+000037f0: 7175 6572 795f 6a6f 622e 6465 7374 696e  query_job.destin
+00003800: 6174 696f 6e2c 2071 7565 7279 5f6a 6f62  ation, query_job
+00003810: 0a0a 2020 2020 2020 2020 2320 4372 6561  ..        # Crea
+00003820: 7465 2061 2074 6162 6c65 2074 6f20 776f  te a table to wo
+00003830: 726b 6172 6f75 6e64 2042 6967 5175 6572  rkaround BigQuer
+00003840: 7920 3130 2047 4220 7175 6572 7920 7265  y 10 GB query re
+00003850: 7375 6c74 7320 6c69 6d69 742e 2053 6565  sults limit. See
+00003860: 3a0a 2020 2020 2020 2020 2320 696e 7465  :.        # inte
+00003870: 726e 616c 2069 7373 7565 2033 3033 3035  rnal issue 30305
+00003880: 3733 3336 2e0a 2020 2020 2020 2020 2320  7336..        # 
+00003890: 5369 6e63 6520 7765 2068 6176 6520 6120  Since we have a 
+000038a0: 6073 7461 7465 6d65 6e74 5f74 7970 6520  `statement_type 
+000038b0: 3d3d 2027 5345 4c45 4354 2760 2c20 7363  == 'SELECT'`, sc
+000038c0: 6865 6d61 2073 686f 756c 6420 6265 2070  hema should be p
+000038d0: 6f70 756c 6174 6564 2e0a 2020 2020 2020  opulated..      
+000038e0: 2020 7363 6865 6d61 203d 2074 7970 696e    schema = typin
+000038f0: 672e 6361 7374 2849 7465 7261 626c 655b  g.cast(Iterable[
+00003900: 6269 6771 7565 7279 2e53 6368 656d 6146  bigquery.SchemaF
+00003910: 6965 6c64 5d2c 2064 7279 5f72 756e 5f6a  ield], dry_run_j
+00003920: 6f62 2e73 6368 656d 6129 0a20 2020 2020  ob.schema).     
+00003930: 2020 2069 6620 646f 5f63 6c75 7374 6572     if do_cluster
+00003940: 696e 673a 0a20 2020 2020 2020 2020 2020  ing:.           
+00003950: 2063 6c75 7374 6572 5f63 6f6c 7320 3d20   cluster_cols = 
+00003960: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+00003970: 2020 6974 656d 2e6e 616d 650a 2020 2020    item.name.    
+00003980: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00003990: 6974 656d 2069 6e20 7363 6865 6d61 0a20  item in schema. 
+000039a0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000039b0: 6620 2869 7465 6d2e 6e61 6d65 2069 6e20  f (item.name in 
+000039c0: 696e 6465 785f 636f 6c73 2920 616e 6420  index_cols) and 
+000039d0: 5f63 616e 5f63 6c75 7374 6572 5f62 7128  _can_cluster_bq(
+000039e0: 6974 656d 290a 2020 2020 2020 2020 2020  item).          
+000039f0: 2020 5d5b 3a5f 4d41 585f 434c 5553 5445    ][:_MAX_CLUSTE
+00003a00: 525f 434f 4c55 4d4e 535d 0a20 2020 2020  R_COLUMNS].     
+00003a10: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00003a20: 2020 2020 2063 6c75 7374 6572 5f63 6f6c       cluster_col
+00003a30: 7320 3d20 5b5d 0a20 2020 2020 2020 2074  s = [].        t
+00003a40: 656d 705f 7461 626c 6520 3d20 7365 6c66  emp_table = self
+00003a50: 2e5f 6372 6561 7465 5f65 6d70 7479 5f74  ._create_empty_t
+00003a60: 656d 705f 7461 626c 6528 7363 6865 6d61  emp_table(schema
+00003a70: 2c20 636c 7573 7465 725f 636f 6c73 290a  , cluster_cols).
+00003a80: 0a20 2020 2020 2020 2074 696d 656f 7574  .        timeout
+00003a90: 5f6d 7320 3d20 636f 6e66 6967 7572 6174  _ms = configurat
+00003aa0: 696f 6e2e 6765 7428 226a 6f62 5469 6d65  ion.get("jobTime
+00003ab0: 6f75 744d 7322 2920 6f72 2063 6f6e 6669  outMs") or confi
+00003ac0: 6775 7261 7469 6f6e 5b22 7175 6572 7922  guration["query"
+00003ad0: 5d2e 6765 7428 0a20 2020 2020 2020 2020  ].get(.         
+00003ae0: 2020 2022 7469 6d65 6f75 744d 7322 0a20     "timeoutMs". 
+00003af0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+00003b00: 2020 2320 436f 6e76 6572 7420 7469 6d65    # Convert time
+00003b10: 6f75 745f 6d73 2074 6f20 7365 636f 6e64  out_ms to second
+00003b20: 732c 2065 6e73 7572 696e 6720 6120 6d69  s, ensuring a mi
+00003b30: 6e69 6d75 6d20 6f66 2030 2e31 2073 6563  nimum of 0.1 sec
+00003b40: 6f6e 6473 2074 6f20 6176 6f69 640a 2020  onds to avoid.  
+00003b50: 2020 2020 2020 2320 7468 6520 7072 6f67        # the prog
+00003b60: 7261 6d20 6765 7474 696e 6720 7374 7563  ram getting stuc
+00003b70: 6b20 6f6e 2074 6f6f 2d73 686f 7274 2074  k on too-short t
+00003b80: 696d 656f 7574 732e 0a20 2020 2020 2020  imeouts..       
+00003b90: 2074 696d 656f 7574 203d 206d 6178 2869   timeout = max(i
+00003ba0: 6e74 2874 696d 656f 7574 5f6d 7329 202a  nt(timeout_ms) *
+00003bb0: 2031 652d 332c 2030 2e31 2920 6966 2074   1e-3, 0.1) if t
+00003bc0: 696d 656f 7574 5f6d 7320 656c 7365 204e  imeout_ms else N
+00003bd0: 6f6e 650a 0a20 2020 2020 2020 206a 6f62  one..        job
+00003be0: 5f63 6f6e 6669 6720 3d20 7479 7069 6e67  _config = typing
+00003bf0: 2e63 6173 7428 0a20 2020 2020 2020 2020  .cast(.         
+00003c00: 2020 2062 6967 7175 6572 792e 5175 6572     bigquery.Quer
+00003c10: 794a 6f62 436f 6e66 6967 2c0a 2020 2020  yJobConfig,.    
+00003c20: 2020 2020 2020 2020 6269 6771 7565 7279          bigquery
+00003c30: 2e51 7565 7279 4a6f 6243 6f6e 6669 672e  .QueryJobConfig.
+00003c40: 6672 6f6d 5f61 7069 5f72 6570 7228 636f  from_api_repr(co
+00003c50: 6e66 6967 7572 6174 696f 6e29 2c0a 2020  nfiguration),.  
+00003c60: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00003c70: 6a6f 625f 636f 6e66 6967 2e6c 6162 656c  job_config.label
+00003c80: 735b 2262 6967 6672 616d 6573 2d61 7069  s["bigframes-api
+00003c90: 225d 203d 2061 7069 5f6e 616d 650a 2020  "] = api_name.  
+00003ca0: 2020 2020 2020 6a6f 625f 636f 6e66 6967        job_config
+00003cb0: 2e64 6573 7469 6e61 7469 6f6e 203d 2074  .destination = t
+00003cc0: 656d 705f 7461 626c 650a 0a20 2020 2020  emp_table..     
+00003cd0: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
+00003ce0: 2020 2020 2320 5772 6974 6520 746f 2074      # Write to t
+00003cf0: 656d 7020 7461 626c 6520 746f 2077 6f72  emp table to wor
+00003d00: 6b61 726f 756e 6420 4269 6751 7565 7279  karound BigQuery
+00003d10: 2031 3020 4742 2071 7565 7279 2072 6573   10 GB query res
+00003d20: 756c 7473 0a20 2020 2020 2020 2020 2020  ults.           
+00003d30: 2023 206c 696d 6974 2e20 5365 653a 2069   # limit. See: i
+00003d40: 6e74 6572 6e61 6c20 6973 7375 6520 3330  nternal issue 30
+00003d50: 3330 3537 3333 362e 0a20 2020 2020 2020  3057336..       
+00003d60: 2020 2020 206a 6f62 5f63 6f6e 6669 672e       job_config.
+00003d70: 6c61 6265 6c73 5b22 6572 726f 725f 6361  labels["error_ca
+00003d80: 7567 6874 225d 203d 2022 7472 7565 220a  ught"] = "true".
+00003d90: 2020 2020 2020 2020 2020 2020 5f2c 2071              _, q
+00003da0: 7565 7279 5f6a 6f62 203d 2073 656c 662e  uery_job = self.
+00003db0: 5f73 7461 7274 5f71 7565 7279 280a 2020  _start_query(.  
+00003dc0: 2020 2020 2020 2020 2020 2020 2020 7175                qu
+00003dd0: 6572 792c 206a 6f62 5f63 6f6e 6669 673d  ery, job_config=
+00003de0: 6a6f 625f 636f 6e66 6967 2c20 7469 6d65  job_config, time
+00003df0: 6f75 743d 7469 6d65 6f75 740a 2020 2020  out=timeout.    
+00003e00: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00003e10: 2020 2020 2020 7265 7475 726e 2071 7565        return que
+00003e20: 7279 5f6a 6f62 2e64 6573 7469 6e61 7469  ry_job.destinati
+00003e30: 6f6e 2c20 7175 6572 795f 6a6f 620a 2020  on, query_job.  
+00003e40: 2020 2020 2020 6578 6365 7074 2067 6f6f        except goo
+00003e50: 676c 652e 6170 695f 636f 7265 2e65 7863  gle.api_core.exc
+00003e60: 6570 7469 6f6e 732e 4261 6452 6571 7565  eptions.BadReque
+00003e70: 7374 3a0a 2020 2020 2020 2020 2020 2020  st:.            
+00003e80: 2320 536f 6d65 2053 454c 4543 5420 7374  # Some SELECT st
+00003e90: 6174 656d 656e 7473 2073 7469 6c6c 2061  atements still a
+00003ea0: 7265 6e27 7420 636f 6d70 6174 6962 6c65  ren't compatible
+00003eb0: 2077 6974 6820 636c 7573 7465 720a 2020   with cluster.  
+00003ec0: 2020 2020 2020 2020 2020 2320 7461 626c            # tabl
+00003ed0: 6573 2061 7320 7468 6520 6465 7374 696e  es as the destin
+00003ee0: 6174 696f 6e2e 2046 6f72 2065 7861 6d70  ation. For examp
+00003ef0: 6c65 2c20 6966 2074 6865 2071 7565 7279  le, if the query
+00003f00: 2068 6173 2061 0a20 2020 2020 2020 2020   has a.         
+00003f10: 2020 2023 2074 6f70 2d6c 6576 656c 204f     # top-level O
+00003f20: 5244 4552 2042 592c 2074 6869 7320 636f  RDER BY, this co
+00003f30: 6e66 6c69 6374 7320 7769 7468 206f 7572  nflicts with our
+00003f40: 2061 6269 6c69 7479 2074 6f20 636c 7573   ability to clus
+00003f50: 7465 720a 2020 2020 2020 2020 2020 2020  ter.            
+00003f60: 2320 7468 6520 7461 626c 6520 6279 2074  # the table by t
+00003f70: 6865 2069 6e64 6578 2063 6f6c 756d 6e28  he index column(
+00003f80: 7329 2e0a 2020 2020 2020 2020 2020 2020  s)..            
+00003f90: 5f2c 2071 7565 7279 5f6a 6f62 203d 2073  _, query_job = s
+00003fa0: 656c 662e 5f73 7461 7274 5f71 7565 7279  elf._start_query
+00003fb0: 2871 7565 7279 2c20 7469 6d65 6f75 743d  (query, timeout=
+00003fc0: 7469 6d65 6f75 7429 0a20 2020 2020 2020  timeout).       
+00003fd0: 2020 2020 2072 6574 7572 6e20 7175 6572       return quer
+00003fe0: 795f 6a6f 622e 6465 7374 696e 6174 696f  y_job.destinatio
+00003ff0: 6e2c 2071 7565 7279 5f6a 6f62 0a0a 2020  n, query_job..  
+00004000: 2020 6465 6620 7265 6164 5f67 6271 5f71    def read_gbq_q
+00004010: 7565 7279 280a 2020 2020 2020 2020 7365  uery(.        se
+00004020: 6c66 2c0a 2020 2020 2020 2020 7175 6572  lf,.        quer
+00004030: 793a 2073 7472 2c0a 2020 2020 2020 2020  y: str,.        
+00004040: 2a2c 0a20 2020 2020 2020 2069 6e64 6578  *,.        index
+00004050: 5f63 6f6c 3a20 4974 6572 6162 6c65 5b73  _col: Iterable[s
+00004060: 7472 5d20 7c20 7374 7220 7c20 6269 6766  tr] | str | bigf
+00004070: 7261 6d65 732e 656e 756d 732e 4465 6661  rames.enums.Defa
+00004080: 756c 7449 6e64 6578 4b69 6e64 203d 2028  ultIndexKind = (
+00004090: 292c 0a20 2020 2020 2020 2063 6f6c 756d  ),.        colum
+000040a0: 6e73 3a20 4974 6572 6162 6c65 5b73 7472  ns: Iterable[str
+000040b0: 5d20 3d20 2829 2c0a 2020 2020 2020 2020  ] = (),.        
+000040c0: 636f 6e66 6967 7572 6174 696f 6e3a 204f  configuration: O
+000040d0: 7074 696f 6e61 6c5b 4469 6374 5d20 3d20  ptional[Dict] = 
+000040e0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6d61  None,.        ma
+000040f0: 785f 7265 7375 6c74 733a 204f 7074 696f  x_results: Optio
+00004100: 6e61 6c5b 696e 745d 203d 204e 6f6e 652c  nal[int] = None,
+00004110: 0a20 2020 2020 2020 2075 7365 5f63 6163  .        use_cac
+00004120: 6865 3a20 4f70 7469 6f6e 616c 5b62 6f6f  he: Optional[boo
+00004130: 6c5d 203d 204e 6f6e 652c 0a20 2020 2020  l] = None,.     
+00004140: 2020 2063 6f6c 5f6f 7264 6572 3a20 4974     col_order: It
+00004150: 6572 6162 6c65 5b73 7472 5d20 3d20 2829  erable[str] = ()
+00004160: 2c0a 2020 2020 2920 2d3e 2064 6174 6166  ,.    ) -> dataf
+00004170: 7261 6d65 2e44 6174 6146 7261 6d65 3a0a  rame.DataFrame:.
+00004180: 2020 2020 2020 2020 2222 2254 7572 6e20          """Turn 
+00004190: 6120 5351 4c20 7175 6572 7920 696e 746f  a SQL query into
+000041a0: 2061 2044 6174 6146 7261 6d65 2e0a 0a20   a DataFrame... 
+000041b0: 2020 2020 2020 204e 6f74 653a 2042 6563         Note: Bec
+000041c0: 6175 7365 2074 6865 2072 6573 756c 7473  ause the results
+000041d0: 2061 7265 2077 7269 7474 656e 2074 6f20   are written to 
+000041e0: 6120 7465 6d70 6f72 6172 7920 7461 626c  a temporary tabl
+000041f0: 652c 206f 7264 6572 696e 6720 6279 0a20  e, ordering by. 
+00004200: 2020 2020 2020 2060 604f 5244 4552 2042         ``ORDER B
+00004210: 5960 6020 6973 206e 6f74 2070 7265 7365  Y`` is not prese
+00004220: 7276 6564 2e20 4120 756e 6971 7565 2060  rved. A unique `
+00004230: 696e 6465 785f 636f 6c60 2069 7320 7265  index_col` is re
+00004240: 636f 6d6d 656e 6465 642e 2055 7365 0a20  commended. Use. 
+00004250: 2020 2020 2020 2060 6072 6f77 5f6e 756d         ``row_num
+00004260: 6265 7228 2920 6f76 6572 2028 2960 6020  ber() over ()`` 
+00004270: 6966 2074 6865 7265 2069 7320 6e6f 206e  if there is no n
+00004280: 6174 7572 616c 2075 6e69 7175 6520 696e  atural unique in
+00004290: 6465 7820 6f72 2079 6f75 0a20 2020 2020  dex or you.     
+000042a0: 2020 2077 616e 7420 746f 2070 7265 7365     want to prese
+000042b0: 7276 6520 6f72 6465 7269 6e67 2e0a 0a20  rve ordering... 
+000042c0: 2020 2020 2020 202a 2a45 7861 6d70 6c65         **Example
+000042d0: 733a 2a2a 0a0a 2020 2020 2020 2020 2020  s:**..          
+000042e0: 2020 3e3e 3e20 696d 706f 7274 2062 6967    >>> import big
+000042f0: 6672 616d 6573 2e70 616e 6461 7320 6173  frames.pandas as
+00004300: 2062 7064 0a20 2020 2020 2020 2020 2020   bpd.           
+00004310: 203e 3e3e 2062 7064 2e6f 7074 696f 6e73   >>> bpd.options
+00004320: 2e64 6973 706c 6179 2e70 726f 6772 6573  .display.progres
+00004330: 735f 6261 7220 3d20 4e6f 6e65 0a0a 2020  s_bar = None..  
+00004340: 2020 2020 2020 5369 6d70 6c65 2071 7565        Simple que
+00004350: 7279 2069 6e70 7574 3a0a 0a20 2020 2020  ry input:..     
+00004360: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+00004370: 6270 642e 7265 6164 5f67 6271 5f71 7565  bpd.read_gbq_que
+00004380: 7279 2827 2727 0a20 2020 2020 2020 2020  ry('''.         
+00004390: 2020 202e 2e2e 2020 2020 5345 4c45 4354     ...    SELECT
+000043a0: 0a20 2020 2020 2020 2020 2020 202e 2e2e  .            ...
+000043b0: 2020 2020 2020 2070 6974 6368 6572 4669         pitcherFi
+000043c0: 7273 744e 616d 652c 0a20 2020 2020 2020  rstName,.       
+000043d0: 2020 2020 202e 2e2e 2020 2020 2020 2070       ...       p
+000043e0: 6974 6368 6572 4c61 7374 4e61 6d65 2c0a  itcherLastName,.
+000043f0: 2020 2020 2020 2020 2020 2020 2e2e 2e20              ... 
+00004400: 2020 2020 2020 7069 7463 6853 7065 6564        pitchSpeed
+00004410: 2c0a 2020 2020 2020 2020 2020 2020 2e2e  ,.            ..
+00004420: 2e20 2020 2046 524f 4d20 6062 6967 7175  .    FROM `bigqu
+00004430: 6572 792d 7075 626c 6963 2d64 6174 612e  ery-public-data.
+00004440: 6261 7365 6261 6c6c 2e67 616d 6573 5f77  baseball.games_w
+00004450: 6964 6560 0a20 2020 2020 2020 2020 2020  ide`.           
+00004460: 202e 2e2e 2027 2727 290a 0a20 2020 2020   ... ''')..     
+00004470: 2020 2050 7265 7365 7276 6520 6f72 6465     Preserve orde
+00004480: 7269 6e67 2069 6e20 6120 7175 6572 7920  ring in a query 
+00004490: 696e 7075 742e 0a0a 2020 2020 2020 2020  input...        
+000044a0: 2020 2020 3e3e 3e20 6466 203d 2062 7064      >>> df = bpd
+000044b0: 2e72 6561 645f 6762 715f 7175 6572 7928  .read_gbq_query(
+000044c0: 2727 270a 2020 2020 2020 2020 2020 2020  '''.            
+000044d0: 2e2e 2e20 2020 2053 454c 4543 540a 2020  ...    SELECT.  
+000044e0: 2020 2020 2020 2020 2020 2e2e 2e20 2020            ...   
+000044f0: 2020 2020 2d2d 2049 6e73 7465 6164 206f      -- Instead o
+00004500: 6620 616e 204f 5244 4552 2042 5920 636c  f an ORDER BY cl
+00004510: 6175 7365 206f 6e20 7468 6520 7175 6572  ause on the quer
+00004520: 792c 2075 7365 0a20 2020 2020 2020 2020  y, use.         
+00004530: 2020 202e 2e2e 2020 2020 2020 202d 2d20     ...       -- 
+00004540: 524f 575f 4e55 4d42 4552 2829 2074 6f20  ROW_NUMBER() to 
+00004550: 6372 6561 7465 2061 6e20 6f72 6465 7265  create an ordere
+00004560: 6420 4461 7461 4672 616d 652e 0a20 2020  d DataFrame..   
+00004570: 2020 2020 2020 2020 202e 2e2e 2020 2020           ...    
+00004580: 2020 2052 4f57 5f4e 554d 4245 5228 2920     ROW_NUMBER() 
+00004590: 4f56 4552 2028 4f52 4445 5220 4259 2041  OVER (ORDER BY A
+000045a0: 5647 2870 6974 6368 5370 6565 6429 2044  VG(pitchSpeed) D
+000045b0: 4553 4329 0a20 2020 2020 2020 2020 2020  ESC).           
+000045c0: 202e 2e2e 2020 2020 2020 2020 2041 5320   ...         AS 
+000045d0: 726f 7769 6e64 6578 2c0a 2020 2020 2020  rowindex,.      
+000045e0: 2020 2020 2020 2e2e 2e0a 2020 2020 2020        ....      
+000045f0: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
+00004600: 7069 7463 6865 7246 6972 7374 4e61 6d65  pitcherFirstName
+00004610: 2c0a 2020 2020 2020 2020 2020 2020 2e2e  ,.            ..
+00004620: 2e20 2020 2020 2020 7069 7463 6865 724c  .       pitcherL
+00004630: 6173 744e 616d 652c 0a20 2020 2020 2020  astName,.       
+00004640: 2020 2020 202e 2e2e 2020 2020 2020 2041       ...       A
+00004650: 5647 2870 6974 6368 5370 6565 6429 2041  VG(pitchSpeed) A
+00004660: 5320 6176 6572 6167 6550 6974 6368 5370  S averagePitchSp
+00004670: 6565 640a 2020 2020 2020 2020 2020 2020  eed.            
+00004680: 2e2e 2e20 2020 2020 4652 4f4d 2060 6269  ...     FROM `bi
+00004690: 6771 7565 7279 2d70 7562 6c69 632d 6461  gquery-public-da
+000046a0: 7461 2e62 6173 6562 616c 6c2e 6761 6d65  ta.baseball.game
+000046b0: 735f 7769 6465 600a 2020 2020 2020 2020  s_wide`.        
+000046c0: 2020 2020 2e2e 2e20 2020 2020 5748 4552      ...     WHER
+000046d0: 4520 7965 6172 203d 2032 3031 360a 2020  E year = 2016.  
+000046e0: 2020 2020 2020 2020 2020 2e2e 2e20 2020            ...   
+000046f0: 2020 4752 4f55 5020 4259 2070 6974 6368    GROUP BY pitch
+00004700: 6572 4669 7273 744e 616d 652c 2070 6974  erFirstName, pit
+00004710: 6368 6572 4c61 7374 4e61 6d65 0a20 2020  cherLastName.   
+00004720: 2020 2020 2020 2020 202e 2e2e 2027 2727           ... '''
+00004730: 2c20 696e 6465 785f 636f 6c3d 2272 6f77  , index_col="row
+00004740: 696e 6465 7822 290a 2020 2020 2020 2020  index").        
+00004750: 2020 2020 3e3e 3e20 6466 2e68 6561 6428      >>> df.head(
+00004760: 3229 0a20 2020 2020 2020 2020 2020 2020  2).             
+00004770: 2020 2020 2020 2020 7069 7463 6865 7246          pitcherF
+00004780: 6972 7374 4e61 6d65 2070 6974 6368 6572  irstName pitcher
+00004790: 4c61 7374 4e61 6d65 2020 6176 6572 6167  LastName  averag
+000047a0: 6550 6974 6368 5370 6565 640a 2020 2020  ePitchSpeed.    
+000047b0: 2020 2020 2020 2020 726f 7769 6e64 6578          rowindex
+000047c0: 0a20 2020 2020 2020 2020 2020 2031 2020  .            1  
+000047d0: 2020 2020 2020 2020 2020 2020 2020 416c                Al
+000047e0: 6265 7274 696e 2020 2020 2020 2020 2043  bertin         C
+000047f0: 6861 706d 616e 2020 2020 2020 2020 2020  hapman          
+00004800: 3936 2e35 3134 3131 330a 2020 2020 2020  96.514113.      
+00004810: 2020 2020 2020 3220 2020 2020 2020 2020        2         
+00004820: 2020 2020 2020 2020 5a61 6368 6172 7920          Zachary 
+00004830: 2020 2020 2020 2020 4272 6974 746f 6e20          Britton 
+00004840: 2020 2020 2020 2020 2039 342e 3539 3130           94.5910
+00004850: 3339 0a20 2020 2020 2020 2020 2020 203c  39.            <
+00004860: 424c 414e 4b4c 494e 453e 0a20 2020 2020  BLANKLINE>.     
+00004870: 2020 2020 2020 205b 3220 726f 7773 2078         [2 rows x
+00004880: 2033 2063 6f6c 756d 6e73 5d0a 0a20 2020   3 columns]..   
+00004890: 2020 2020 2053 6565 2061 6c73 6f3a 203a       See also: :
+000048a0: 6d65 7468 3a60 5365 7373 696f 6e2e 7265  meth:`Session.re
+000048b0: 6164 5f67 6271 602e 0a20 2020 2020 2020  ad_gbq`..       
+000048c0: 2022 2222 0a20 2020 2020 2020 2023 204e   """.        # N
+000048d0: 4f54 453a 2054 6869 7320 6d65 7468 6f64  OTE: This method
+000048e0: 2064 6f65 736e 2774 2028 7965 7429 2065   doesn't (yet) e
+000048f0: 7869 7374 2069 6e20 7061 6e64 6173 206f  xist in pandas o
+00004900: 7220 7061 6e64 6173 2d67 6271 2c20 736f  r pandas-gbq, so
+00004910: 0a20 2020 2020 2020 2023 2074 6865 7365  .        # these
+00004920: 2064 6f63 7374 7269 6e67 7320 6172 6520   docstrings are 
+00004930: 696e 6c69 6e65 2e0a 2020 2020 2020 2020  inline..        
+00004940: 6966 2063 6f6c 756d 6e73 2061 6e64 2063  if columns and c
+00004950: 6f6c 5f6f 7264 6572 3a0a 2020 2020 2020  ol_order:.      
+00004960: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+00004970: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
+00004980: 2020 2020 2020 2020 224d 7573 7420 7370          "Must sp
+00004990: 6563 6966 7920 6569 7468 6572 2063 6f6c  ecify either col
+000049a0: 756d 6e73 2028 7072 6566 6572 7265 6429  umns (preferred)
+000049b0: 206f 7220 636f 6c5f 6f72 6465 722c 206e   or col_order, n
+000049c0: 6f74 2062 6f74 6822 0a20 2020 2020 2020  ot both".       
+000049d0: 2020 2020 2029 0a20 2020 2020 2020 2065       ).        e
+000049e0: 6c69 6620 636f 6c5f 6f72 6465 723a 0a20  lif col_order:. 
+000049f0: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
+00004a00: 6e73 203d 2063 6f6c 5f6f 7264 6572 0a0a  ns = col_order..
+00004a10: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00004a20: 656c 662e 5f72 6561 645f 6762 715f 7175  elf._read_gbq_qu
+00004a30: 6572 7928 0a20 2020 2020 2020 2020 2020  ery(.           
+00004a40: 2071 7565 7279 3d71 7565 7279 2c0a 2020   query=query,.  
+00004a50: 2020 2020 2020 2020 2020 696e 6465 785f            index_
+00004a60: 636f 6c3d 696e 6465 785f 636f 6c2c 0a20  col=index_col,. 
+00004a70: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
+00004a80: 6e73 3d63 6f6c 756d 6e73 2c0a 2020 2020  ns=columns,.    
+00004a90: 2020 2020 2020 2020 636f 6e66 6967 7572          configur
+00004aa0: 6174 696f 6e3d 636f 6e66 6967 7572 6174  ation=configurat
+00004ab0: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
+00004ac0: 206d 6178 5f72 6573 756c 7473 3d6d 6178   max_results=max
+00004ad0: 5f72 6573 756c 7473 2c0a 2020 2020 2020  _results,.      
+00004ae0: 2020 2020 2020 6170 695f 6e61 6d65 3d22        api_name="
+00004af0: 7265 6164 5f67 6271 5f71 7565 7279 222c  read_gbq_query",
+00004b00: 0a20 2020 2020 2020 2020 2020 2075 7365  .            use
+00004b10: 5f63 6163 6865 3d75 7365 5f63 6163 6865  _cache=use_cache
+00004b20: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+00004b30: 2064 6566 205f 7265 6164 5f67 6271 5f71   def _read_gbq_q
+00004b40: 7565 7279 280a 2020 2020 2020 2020 7365  uery(.        se
+00004b50: 6c66 2c0a 2020 2020 2020 2020 7175 6572  lf,.        quer
+00004b60: 793a 2073 7472 2c0a 2020 2020 2020 2020  y: str,.        
+00004b70: 2a2c 0a20 2020 2020 2020 2069 6e64 6578  *,.        index
+00004b80: 5f63 6f6c 3a20 4974 6572 6162 6c65 5b73  _col: Iterable[s
+00004b90: 7472 5d20 7c20 7374 7220 7c20 6269 6766  tr] | str | bigf
+00004ba0: 7261 6d65 732e 656e 756d 732e 4465 6661  rames.enums.Defa
+00004bb0: 756c 7449 6e64 6578 4b69 6e64 203d 2028  ultIndexKind = (
+00004bc0: 292c 0a20 2020 2020 2020 2063 6f6c 756d  ),.        colum
+00004bd0: 6e73 3a20 4974 6572 6162 6c65 5b73 7472  ns: Iterable[str
+00004be0: 5d20 3d20 2829 2c0a 2020 2020 2020 2020  ] = (),.        
+00004bf0: 636f 6e66 6967 7572 6174 696f 6e3a 204f  configuration: O
+00004c00: 7074 696f 6e61 6c5b 4469 6374 5d20 3d20  ptional[Dict] = 
+00004c10: 4e6f 6e65 2c0a 2020 2020 2020 2020 6d61  None,.        ma
+00004c20: 785f 7265 7375 6c74 733a 204f 7074 696f  x_results: Optio
+00004c30: 6e61 6c5b 696e 745d 203d 204e 6f6e 652c  nal[int] = None,
+00004c40: 0a20 2020 2020 2020 2061 7069 5f6e 616d  .        api_nam
+00004c50: 653a 2073 7472 203d 2022 7265 6164 5f67  e: str = "read_g
+00004c60: 6271 5f71 7565 7279 222c 0a20 2020 2020  bq_query",.     
+00004c70: 2020 2075 7365 5f63 6163 6865 3a20 4f70     use_cache: Op
+00004c80: 7469 6f6e 616c 5b62 6f6f 6c5d 203d 204e  tional[bool] = N
+00004c90: 6f6e 652c 0a20 2020 2029 202d 3e20 6461  one,.    ) -> da
+00004ca0: 7461 6672 616d 652e 4461 7461 4672 616d  taframe.DataFram
+00004cb0: 653a 0a20 2020 2020 2020 2069 6d70 6f72  e:.        impor
+00004cc0: 7420 6269 6766 7261 6d65 732e 6461 7461  t bigframes.data
+00004cd0: 6672 616d 6520 6173 2064 6174 6166 7261  frame as datafra
+00004ce0: 6d65 0a0a 2020 2020 2020 2020 636f 6e66  me..        conf
+00004cf0: 6967 7572 6174 696f 6e20 3d20 5f74 7261  iguration = _tra
+00004d00: 6e73 666f 726d 5f72 6561 645f 6762 715f  nsform_read_gbq_
+00004d10: 636f 6e66 6967 7572 6174 696f 6e28 636f  configuration(co
+00004d20: 6e66 6967 7572 6174 696f 6e29 0a0a 2020  nfiguration)..  
+00004d30: 2020 2020 2020 6966 2022 7175 6572 7922        if "query"
+00004d40: 206e 6f74 2069 6e20 636f 6e66 6967 7572   not in configur
+00004d50: 6174 696f 6e3a 0a20 2020 2020 2020 2020  ation:.         
+00004d60: 2020 2063 6f6e 6669 6775 7261 7469 6f6e     configuration
+00004d70: 5b22 7175 6572 7922 5d20 3d20 7b7d 0a0a  ["query"] = {}..
+00004d80: 2020 2020 2020 2020 6966 2022 7175 6572          if "quer
+00004d90: 7922 2069 6e20 636f 6e66 6967 7572 6174  y" in configurat
+00004da0: 696f 6e5b 2271 7565 7279 225d 3a0a 2020  ion["query"]:.  
+00004db0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00004dc0: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
+00004dd0: 2020 2020 2020 2020 2020 2020 2254 6865              "The
+00004de0: 2071 7565 7279 2073 7461 7465 6d65 6e74   query statement
+00004df0: 206d 7573 7420 6e6f 7420 6265 2069 6e63   must not be inc
+00004e00: 6c75 6465 6420 696e 2074 6865 2022 2c0a  luded in the ",.
+00004e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004e20: 2227 636f 6e66 6967 7572 6174 696f 6e27  "'configuration'
+00004e30: 2062 6563 6175 7365 2069 7420 6973 2061   because it is a
+00004e40: 6c72 6561 6479 2070 726f 7669 6465 6420  lready provided 
+00004e50: 6173 222c 0a20 2020 2020 2020 2020 2020  as",.           
+00004e60: 2020 2020 2022 2061 2073 6570 6172 6174       " a separat
+00004e70: 6520 7061 7261 6d65 7465 722e 222c 0a20  e parameter.",. 
+00004e80: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+00004e90: 2020 2020 2020 6966 2022 7573 6551 7565        if "useQue
+00004ea0: 7279 4361 6368 6522 2069 6e20 636f 6e66  ryCache" in conf
+00004eb0: 6967 7572 6174 696f 6e5b 2271 7565 7279  iguration["query
+00004ec0: 225d 3a0a 2020 2020 2020 2020 2020 2020  "]:.            
+00004ed0: 6966 2075 7365 5f63 6163 6865 2069 7320  if use_cache is 
+00004ee0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+00004ef0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00004f00: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
+00004f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004f20: 2227 7573 6551 7565 7279 4361 6368 6527  "'useQueryCache'
+00004f30: 2069 6e20 2763 6f6e 6669 6775 7261 7469   in 'configurati
+00004f40: 6f6e 2720 636f 6e66 6c69 6374 7320 7769  on' conflicts wi
+00004f50: 7468 220a 2020 2020 2020 2020 2020 2020  th".            
+00004f60: 2020 2020 2020 2020 2220 2775 7365 5f63          " 'use_c
+00004f70: 6163 6865 2720 7061 7261 6d65 7465 722e  ache' parameter.
+00004f80: 2050 6c65 6173 6520 7370 6563 6966 7920   Please specify 
+00004f90: 6f6e 6c79 206f 6e65 2e22 0a20 2020 2020  only one.".     
+00004fa0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00004fb0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00004fc0: 2020 2020 2020 2063 6f6e 6669 6775 7261         configura
+00004fd0: 7469 6f6e 5b22 7175 6572 7922 5d5b 2275  tion["query"]["u
+00004fe0: 7365 5175 6572 7943 6163 6865 225d 203d  seQueryCache"] =
+00004ff0: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
+00005000: 2020 2054 7275 6520 6966 2075 7365 5f63     True if use_c
+00005010: 6163 6865 2069 7320 4e6f 6e65 2065 6c73  ache is None els
+00005020: 6520 7573 655f 6361 6368 650a 2020 2020  e use_cache.    
+00005030: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+00005040: 2020 2069 6e64 6578 5f63 6f6c 7320 3d20     index_cols = 
+00005050: 5f74 6f5f 696e 6465 785f 636f 6c73 2869  _to_index_cols(i
+00005060: 6e64 6578 5f63 6f6c 290a 0a20 2020 2020  ndex_col)..     
+00005070: 2020 2064 6573 7469 6e61 7469 6f6e 2c20     destination, 
+00005080: 7175 6572 795f 6a6f 6220 3d20 7365 6c66  query_job = self
+00005090: 2e5f 7175 6572 795f 746f 5f64 6573 7469  ._query_to_desti
+000050a0: 6e61 7469 6f6e 280a 2020 2020 2020 2020  nation(.        
+000050b0: 2020 2020 7175 6572 792c 0a20 2020 2020      query,.     
+000050c0: 2020 2020 2020 2069 6e64 6578 5f63 6f6c         index_col
+000050d0: 732c 0a20 2020 2020 2020 2020 2020 2061  s,.            a
+000050e0: 7069 5f6e 616d 653d 6170 695f 6e61 6d65  pi_name=api_name
+000050f0: 2c0a 2020 2020 2020 2020 2020 2020 636f  ,.            co
+00005100: 6e66 6967 7572 6174 696f 6e3d 636f 6e66  nfiguration=conf
+00005110: 6967 7572 6174 696f 6e2c 0a20 2020 2020  iguration,.     
+00005120: 2020 2029 0a0a 2020 2020 2020 2020 2320     )..        # 
+00005130: 4966 2074 6865 7265 2077 6173 206e 6f20  If there was no 
+00005140: 6465 7374 696e 6174 696f 6e20 7461 626c  destination tabl
+00005150: 652c 2074 6861 7420 6d65 616e 7320 7468  e, that means th
+00005160: 6520 7175 6572 7920 6d75 7374 2068 6176  e query must hav
+00005170: 650a 2020 2020 2020 2020 2320 6265 656e  e.        # been
+00005180: 2044 444c 206f 7220 444d 4c2e 2052 6574   DDL or DML. Ret
+00005190: 7572 6e20 736f 6d65 206a 6f62 206d 6574  urn some job met
+000051a0: 6164 6174 612c 2069 6e73 7465 6164 2e0a  adata, instead..
+000051b0: 2020 2020 2020 2020 6966 206e 6f74 2064          if not d
+000051c0: 6573 7469 6e61 7469 6f6e 3a0a 2020 2020  estination:.    
+000051d0: 2020 2020 2020 2020 7265 7475 726e 2064          return d
+000051e0: 6174 6166 7261 6d65 2e44 6174 6146 7261  ataframe.DataFra
+000051f0: 6d65 280a 2020 2020 2020 2020 2020 2020  me(.            
+00005200: 2020 2020 6461 7461 3d70 616e 6461 732e      data=pandas.
+00005210: 4461 7461 4672 616d 6528 0a20 2020 2020  DataFrame(.     
+00005220: 2020 2020 2020 2020 2020 2020 2020 207b                 {
+00005230: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005240: 2020 2020 2020 2020 2022 7374 6174 656d           "statem
+00005250: 656e 745f 7479 7065 223a 205b 0a20 2020  ent_type": [.   
+00005260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005270: 2020 2020 2020 2020 2071 7565 7279 5f6a           query_j
+00005280: 6f62 2e73 7461 7465 6d65 6e74 5f74 7970  ob.statement_typ
+00005290: 6520 6966 2071 7565 7279 5f6a 6f62 2065  e if query_job e
+000052a0: 6c73 6520 2275 6e6b 6e6f 776e 220a 2020  lse "unknown".  
+000052b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000052c0: 2020 2020 2020 5d2c 0a20 2020 2020 2020        ],.       
+000052d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000052e0: 2022 6a6f 625f 6964 223a 205b 7175 6572   "job_id": [quer
+000052f0: 795f 6a6f 622e 6a6f 625f 6964 2069 6620  y_job.job_id if 
+00005300: 7175 6572 795f 6a6f 6220 656c 7365 2022  query_job else "
+00005310: 756e 6b6e 6f77 6e22 5d2c 0a20 2020 2020  unknown"],.     
+00005320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005330: 2020 2022 6c6f 6361 7469 6f6e 223a 205b     "location": [
+00005340: 7175 6572 795f 6a6f 622e 6c6f 6361 7469  query_job.locati
+00005350: 6f6e 2069 6620 7175 6572 795f 6a6f 6220  on if query_job 
+00005360: 656c 7365 2022 756e 6b6e 6f77 6e22 5d2c  else "unknown"],
+00005370: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005380: 2020 2020 207d 0a20 2020 2020 2020 2020       }.         
+00005390: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
+000053a0: 2020 2020 2020 2020 2020 7365 7373 696f            sessio
+000053b0: 6e3d 7365 6c66 2c0a 2020 2020 2020 2020  n=self,.        
+000053c0: 2020 2020 290a 0a20 2020 2020 2020 2072      )..        r
+000053d0: 6574 7572 6e20 7365 6c66 2e72 6561 645f  eturn self.read_
+000053e0: 6762 715f 7461 626c 6528 0a20 2020 2020  gbq_table(.     
+000053f0: 2020 2020 2020 2066 227b 6465 7374 696e         f"{destin
+00005400: 6174 696f 6e2e 7072 6f6a 6563 747d 2e7b  ation.project}.{
+00005410: 6465 7374 696e 6174 696f 6e2e 6461 7461  destination.data
+00005420: 7365 745f 6964 7d2e 7b64 6573 7469 6e61  set_id}.{destina
+00005430: 7469 6f6e 2e74 6162 6c65 5f69 647d 222c  tion.table_id}",
+00005440: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
+00005450: 6578 5f63 6f6c 3d69 6e64 6578 5f63 6f6c  ex_col=index_col
+00005460: 2c0a 2020 2020 2020 2020 2020 2020 636f  ,.            co
+00005470: 6c75 6d6e 733d 636f 6c75 6d6e 732c 0a20  lumns=columns,. 
+00005480: 2020 2020 2020 2020 2020 206d 6178 5f72             max_r
+00005490: 6573 756c 7473 3d6d 6178 5f72 6573 756c  esults=max_resul
+000054a0: 7473 2c0a 2020 2020 2020 2020 2020 2020  ts,.            
+000054b0: 7573 655f 6361 6368 653d 636f 6e66 6967  use_cache=config
+000054c0: 7572 6174 696f 6e5b 2271 7565 7279 225d  uration["query"]
+000054d0: 5b22 7573 6551 7565 7279 4361 6368 6522  ["useQueryCache"
+000054e0: 5d2c 0a20 2020 2020 2020 2029 0a0a 2020  ],.        )..  
+000054f0: 2020 6465 6620 7265 6164 5f67 6271 5f74    def read_gbq_t
+00005500: 6162 6c65 280a 2020 2020 2020 2020 7365  able(.        se
+00005510: 6c66 2c0a 2020 2020 2020 2020 7175 6572  lf,.        quer
+00005520: 793a 2073 7472 2c0a 2020 2020 2020 2020  y: str,.        
+00005530: 2a2c 0a20 2020 2020 2020 2069 6e64 6578  *,.        index
+00005540: 5f63 6f6c 3a20 4974 6572 6162 6c65 5b73  _col: Iterable[s
+00005550: 7472 5d20 7c20 7374 7220 7c20 6269 6766  tr] | str | bigf
+00005560: 7261 6d65 732e 656e 756d 732e 4465 6661  rames.enums.Defa
+00005570: 756c 7449 6e64 6578 4b69 6e64 203d 2028  ultIndexKind = (
+00005580: 292c 0a20 2020 2020 2020 2063 6f6c 756d  ),.        colum
+00005590: 6e73 3a20 4974 6572 6162 6c65 5b73 7472  ns: Iterable[str
+000055a0: 5d20 3d20 2829 2c0a 2020 2020 2020 2020  ] = (),.        
+000055b0: 6d61 785f 7265 7375 6c74 733a 204f 7074  max_results: Opt
+000055c0: 696f 6e61 6c5b 696e 745d 203d 204e 6f6e  ional[int] = Non
+000055d0: 652c 0a20 2020 2020 2020 2066 696c 7465  e,.        filte
+000055e0: 7273 3a20 7468 6972 645f 7061 7274 795f  rs: third_party_
+000055f0: 7061 6e64 6173 5f67 6271 2e46 696c 7465  pandas_gbq.Filte
+00005600: 7273 5479 7065 203d 2028 292c 0a20 2020  rsType = (),.   
+00005610: 2020 2020 2075 7365 5f63 6163 6865 3a20       use_cache: 
+00005620: 626f 6f6c 203d 2054 7275 652c 0a20 2020  bool = True,.   
+00005630: 2020 2020 2063 6f6c 5f6f 7264 6572 3a20       col_order: 
+00005640: 4974 6572 6162 6c65 5b73 7472 5d20 3d20  Iterable[str] = 
+00005650: 2829 2c0a 2020 2020 2920 2d3e 2064 6174  (),.    ) -> dat
+00005660: 6166 7261 6d65 2e44 6174 6146 7261 6d65  aframe.DataFrame
+00005670: 3a0a 2020 2020 2020 2020 2222 2254 7572  :.        """Tur
+00005680: 6e20 6120 4269 6751 7565 7279 2074 6162  n a BigQuery tab
+00005690: 6c65 2069 6e74 6f20 6120 4461 7461 4672  le into a DataFr
+000056a0: 616d 652e 0a0a 2020 2020 2020 2020 2a2a  ame...        **
+000056b0: 4578 616d 706c 6573 3a2a 2a0a 0a20 2020  Examples:**..   
+000056c0: 2020 2020 2020 2020 203e 3e3e 2069 6d70           >>> imp
+000056d0: 6f72 7420 6269 6766 7261 6d65 732e 7061  ort bigframes.pa
+000056e0: 6e64 6173 2061 7320 6270 640a 2020 2020  ndas as bpd.    
+000056f0: 2020 2020 2020 2020 3e3e 3e20 6270 642e          >>> bpd.
+00005700: 6f70 7469 6f6e 732e 6469 7370 6c61 792e  options.display.
+00005710: 7072 6f67 7265 7373 5f62 6172 203d 204e  progress_bar = N
+00005720: 6f6e 650a 0a20 2020 2020 2020 2052 6561  one..        Rea
+00005730: 6420 6120 7768 6f6c 6520 7461 626c 652c  d a whole table,
+00005740: 2077 6974 6820 6172 6269 7472 6172 7920   with arbitrary 
+00005750: 6f72 6465 7269 6e67 206f 7220 6f72 6465  ordering or orde
+00005760: 7269 6e67 2063 6f72 7265 7370 6f6e 6469  ring correspondi
+00005770: 6e67 2074 6f20 7468 6520 7072 696d 6172  ng to the primar
+00005780: 7920 6b65 7928 7329 2e0a 0a20 2020 2020  y key(s)...     
+00005790: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+000057a0: 6270 642e 7265 6164 5f67 6271 5f74 6162  bpd.read_gbq_tab
+000057b0: 6c65 2822 6269 6771 7565 7279 2d70 7562  le("bigquery-pub
+000057c0: 6c69 632d 6461 7461 2e6d 6c5f 6461 7461  lic-data.ml_data
+000057d0: 7365 7473 2e70 656e 6775 696e 7322 290a  sets.penguins").
+000057e0: 0a20 2020 2020 2020 2053 6565 2061 6c73  .        See als
+000057f0: 6f3a 203a 6d65 7468 3a60 5365 7373 696f  o: :meth:`Sessio
+00005800: 6e2e 7265 6164 5f67 6271 602e 0a20 2020  n.read_gbq`..   
+00005810: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00005820: 2023 204e 4f54 453a 2054 6869 7320 6d65   # NOTE: This me
+00005830: 7468 6f64 2064 6f65 736e 2774 2028 7965  thod doesn't (ye
+00005840: 7429 2065 7869 7374 2069 6e20 7061 6e64  t) exist in pand
+00005850: 6173 206f 7220 7061 6e64 6173 2d67 6271  as or pandas-gbq
+00005860: 2c20 736f 0a20 2020 2020 2020 2023 2074  , so.        # t
+00005870: 6865 7365 2064 6f63 7374 7269 6e67 7320  hese docstrings 
+00005880: 6172 6520 696e 6c69 6e65 2e0a 2020 2020  are inline..    
+00005890: 2020 2020 6966 2063 6f6c 756d 6e73 2061      if columns a
+000058a0: 6e64 2063 6f6c 5f6f 7264 6572 3a0a 2020  nd col_order:.  
+000058b0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+000058c0: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
+000058d0: 2020 2020 2020 2020 2020 2020 224d 7573              "Mus
+000058e0: 7420 7370 6563 6966 7920 6569 7468 6572  t specify either
+000058f0: 2063 6f6c 756d 6e73 2028 7072 6566 6572   columns (prefer
+00005900: 7265 6429 206f 7220 636f 6c5f 6f72 6465  red) or col_orde
+00005910: 722c 206e 6f74 2062 6f74 6822 0a20 2020  r, not both".   
+00005920: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00005930: 2020 2065 6c69 6620 636f 6c5f 6f72 6465     elif col_orde
+00005940: 723a 0a20 2020 2020 2020 2020 2020 2063  r:.            c
+00005950: 6f6c 756d 6e73 203d 2063 6f6c 5f6f 7264  olumns = col_ord
+00005960: 6572 0a0a 2020 2020 2020 2020 6669 6c74  er..        filt
+00005970: 6572 7320 3d20 6c69 7374 2866 696c 7465  ers = list(filte
+00005980: 7273 290a 2020 2020 2020 2020 6966 206c  rs).        if l
+00005990: 656e 2866 696c 7465 7273 2920 213d 2030  en(filters) != 0
+000059a0: 206f 7220 6266 5f69 6f5f 6269 6771 7565   or bf_io_bigque
+000059b0: 7279 2e69 735f 7461 626c 655f 7769 7468  ry.is_table_with
+000059c0: 5f77 696c 6463 6172 645f 7375 6666 6978  _wildcard_suffix
+000059d0: 2871 7565 7279 293a 0a20 2020 2020 2020  (query):.       
+000059e0: 2020 2020 2023 2054 4f44 4f28 622f 3333       # TODO(b/33
+000059f0: 3830 3339 3531 3729 3a20 5265 6661 6374  8039517): Refact
+00005a00: 6f72 2074 6869 7320 746f 2062 6520 6361  or this to be ca
+00005a10: 6c6c 6564 2069 6e73 6964 6520 626f 7468  lled inside both
+00005a20: 0a20 2020 2020 2020 2020 2020 2023 205f  .            # _
+00005a30: 7265 6164 5f67 6271 5f71 7565 7279 2061  read_gbq_query a
+00005a40: 6e64 205f 7265 6164 5f67 6271 5f74 6162  nd _read_gbq_tab
+00005a50: 6c65 2028 6166 7465 7220 6465 7465 6374  le (after detect
+00005a60: 696e 6720 7072 696d 6172 7920 6b65 7973  ing primary keys
+00005a70: 290a 2020 2020 2020 2020 2020 2020 2320  ).            # 
+00005a80: 736f 2077 6520 6361 6e20 6d61 6b65 2073  so we can make s
+00005a90: 7572 6520 696e 6465 785f 636f 6c2f 696e  ure index_col/in
+00005aa0: 6465 785f 636f 6c73 2072 6566 6c65 6374  dex_cols reflect
+00005ab0: 7320 7072 696d 6172 7920 6b65 7973 2e0a  s primary keys..
+00005ac0: 2020 2020 2020 2020 2020 2020 7175 6572              quer
+00005ad0: 7920 3d20 6266 5f69 6f5f 6269 6771 7565  y = bf_io_bigque
+00005ae0: 7279 2e74 6f5f 7175 6572 7928 0a20 2020  ry.to_query(.   
+00005af0: 2020 2020 2020 2020 2020 2020 2071 7565               que
+00005b00: 7279 2c20 5f74 6f5f 696e 6465 785f 636f  ry, _to_index_co
+00005b10: 6c73 2869 6e64 6578 5f63 6f6c 292c 2063  ls(index_col), c
+00005b20: 6f6c 756d 6e73 2c20 6669 6c74 6572 730a  olumns, filters.
+00005b30: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00005b40: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00005b50: 6e20 7365 6c66 2e5f 7265 6164 5f67 6271  n self._read_gbq
+00005b60: 5f71 7565 7279 280a 2020 2020 2020 2020  _query(.        
+00005b70: 2020 2020 2020 2020 7175 6572 792c 0a20          query,. 
+00005b80: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00005b90: 6e64 6578 5f63 6f6c 3d69 6e64 6578 5f63  ndex_col=index_c
+00005ba0: 6f6c 2c0a 2020 2020 2020 2020 2020 2020  ol,.            
+00005bb0: 2020 2020 636f 6c75 6d6e 733d 636f 6c75      columns=colu
+00005bc0: 6d6e 732c 0a20 2020 2020 2020 2020 2020  mns,.           
+00005bd0: 2020 2020 206d 6178 5f72 6573 756c 7473       max_results
+00005be0: 3d6d 6178 5f72 6573 756c 7473 2c0a 2020  =max_results,.  
+00005bf0: 2020 2020 2020 2020 2020 2020 2020 6170                ap
+00005c00: 695f 6e61 6d65 3d22 7265 6164 5f67 6271  i_name="read_gbq
+00005c10: 5f74 6162 6c65 222c 0a20 2020 2020 2020  _table",.       
+00005c20: 2020 2020 2020 2020 2075 7365 5f63 6163           use_cac
+00005c30: 6865 3d75 7365 5f63 6163 6865 2c0a 2020  he=use_cache,.  
+00005c40: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+00005c50: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00005c60: 2e5f 7265 6164 5f67 6271 5f74 6162 6c65  ._read_gbq_table
+00005c70: 280a 2020 2020 2020 2020 2020 2020 7175  (.            qu
+00005c80: 6572 793d 7175 6572 792c 0a20 2020 2020  ery=query,.     
+00005c90: 2020 2020 2020 2069 6e64 6578 5f63 6f6c         index_col
+00005ca0: 3d69 6e64 6578 5f63 6f6c 2c0a 2020 2020  =index_col,.    
+00005cb0: 2020 2020 2020 2020 636f 6c75 6d6e 733d          columns=
+00005cc0: 636f 6c75 6d6e 732c 0a20 2020 2020 2020  columns,.       
+00005cd0: 2020 2020 206d 6178 5f72 6573 756c 7473       max_results
+00005ce0: 3d6d 6178 5f72 6573 756c 7473 2c0a 2020  =max_results,.  
+00005cf0: 2020 2020 2020 2020 2020 6170 695f 6e61            api_na
+00005d00: 6d65 3d22 7265 6164 5f67 6271 5f74 6162  me="read_gbq_tab
+00005d10: 6c65 222c 0a20 2020 2020 2020 2020 2020  le",.           
+00005d20: 2075 7365 5f63 6163 6865 3d75 7365 5f63   use_cache=use_c
+00005d30: 6163 6865 2c0a 2020 2020 2020 2020 290a  ache,.        ).
+00005d40: 0a20 2020 2064 6566 205f 7265 6164 5f67  .    def _read_g
+00005d50: 6271 5f74 6162 6c65 280a 2020 2020 2020  bq_table(.      
+00005d60: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+00005d70: 7175 6572 793a 2073 7472 2c0a 2020 2020  query: str,.    
+00005d80: 2020 2020 2a2c 0a20 2020 2020 2020 2069      *,.        i
+00005d90: 6e64 6578 5f63 6f6c 3a20 4974 6572 6162  ndex_col: Iterab
+00005da0: 6c65 5b73 7472 5d20 7c20 7374 7220 7c20  le[str] | str | 
+00005db0: 6269 6766 7261 6d65 732e 656e 756d 732e  bigframes.enums.
+00005dc0: 4465 6661 756c 7449 6e64 6578 4b69 6e64  DefaultIndexKind
+00005dd0: 203d 2028 292c 0a20 2020 2020 2020 2063   = (),.        c
+00005de0: 6f6c 756d 6e73 3a20 4974 6572 6162 6c65  olumns: Iterable
+00005df0: 5b73 7472 5d20 3d20 2829 2c0a 2020 2020  [str] = (),.    
+00005e00: 2020 2020 6d61 785f 7265 7375 6c74 733a      max_results:
+00005e10: 204f 7074 696f 6e61 6c5b 696e 745d 203d   Optional[int] =
+00005e20: 204e 6f6e 652c 0a20 2020 2020 2020 2061   None,.        a
+00005e30: 7069 5f6e 616d 653a 2073 7472 2c0a 2020  pi_name: str,.  
+00005e40: 2020 2020 2020 7573 655f 6361 6368 653a        use_cache:
+00005e50: 2062 6f6f 6c20 3d20 5472 7565 2c0a 2020   bool = True,.  
+00005e60: 2020 2920 2d3e 2064 6174 6166 7261 6d65    ) -> dataframe
+00005e70: 2e44 6174 6146 7261 6d65 3a0a 2020 2020  .DataFrame:.    
+00005e80: 2020 2020 696d 706f 7274 2062 6967 6672      import bigfr
+00005e90: 616d 6573 2e64 6174 6166 7261 6d65 2061  ames.dataframe a
+00005ea0: 7320 6461 7461 6672 616d 650a 0a20 2020  s dataframe..   
+00005eb0: 2020 2020 2023 202d 2d2d 2d2d 2d2d 2d2d       # ---------
+00005ec0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005ed0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00005ee0: 2023 2056 616c 6964 6174 6520 616e 6420   # Validate and 
+00005ef0: 7472 616e 7366 6f72 6d20 7061 7261 6d65  transform parame
+00005f00: 7465 7273 0a20 2020 2020 2020 2023 202d  ters.        # -
+00005f10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005f20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005f30: 0a0a 2020 2020 2020 2020 6966 206d 6178  ..        if max
+00005f40: 5f72 6573 756c 7473 2061 6e64 206d 6178  _results and max
+00005f50: 5f72 6573 756c 7473 203c 3d20 303a 0a20  _results <= 0:. 
+00005f60: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00005f70: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
+00005f80: 2020 2020 2020 2020 2020 2020 2066 2260               f"`
+00005f90: 6d61 785f 7265 7375 6c74 7360 2073 686f  max_results` sho
+00005fa0: 756c 6420 6265 2061 2070 6f73 6974 6976  uld be a positiv
+00005fb0: 6520 6e75 6d62 6572 2c20 676f 7420 7b6d  e number, got {m
+00005fc0: 6178 5f72 6573 756c 7473 7d2e 220a 2020  ax_results}.".  
+00005fd0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+00005fe0: 2020 2020 2074 6162 6c65 5f72 6566 203d       table_ref =
+00005ff0: 2062 6967 7175 6572 792e 7461 626c 652e   bigquery.table.
+00006000: 5461 626c 6552 6566 6572 656e 6365 2e66  TableReference.f
+00006010: 726f 6d5f 7374 7269 6e67 280a 2020 2020  rom_string(.    
+00006020: 2020 2020 2020 2020 7175 6572 792c 2064          query, d
+00006030: 6566 6175 6c74 5f70 726f 6a65 6374 3d73  efault_project=s
+00006040: 656c 662e 6271 636c 6965 6e74 2e70 726f  elf.bqclient.pro
+00006050: 6a65 6374 0a20 2020 2020 2020 2029 0a0a  ject.        )..
+00006060: 2020 2020 2020 2020 2320 2d2d 2d2d 2d2d          # ------
+00006070: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00006080: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
+00006090: 2020 2020 2320 4665 7463 6820 7461 626c      # Fetch tabl
+000060a0: 6520 6d65 7461 6461 7461 2061 6e64 2076  e metadata and v
+000060b0: 616c 6964 6174 650a 2020 2020 2020 2020  alidate.        
+000060c0: 2320 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  # --------------
+000060d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000060e0: 2d2d 2d0a 0a20 2020 2020 2020 2028 7469  ---..        (ti
+000060f0: 6d65 5f74 7261 7665 6c5f 7469 6d65 7374  me_travel_timest
+00006100: 616d 702c 2074 6162 6c65 2c29 203d 2062  amp, table,) = b
+00006110: 665f 7265 6164 5f67 6271 5f74 6162 6c65  f_read_gbq_table
+00006120: 2e67 6574 5f74 6162 6c65 5f6d 6574 6164  .get_table_metad
+00006130: 6174 6128 0a20 2020 2020 2020 2020 2020  ata(.           
+00006140: 2073 656c 662e 6271 636c 6965 6e74 2c0a   self.bqclient,.
+00006150: 2020 2020 2020 2020 2020 2020 7461 626c              tabl
+00006160: 655f 7265 663d 7461 626c 655f 7265 662c  e_ref=table_ref,
+00006170: 0a20 2020 2020 2020 2020 2020 2061 7069  .            api
+00006180: 5f6e 616d 653d 6170 695f 6e61 6d65 2c0a  _name=api_name,.
+00006190: 2020 2020 2020 2020 2020 2020 6361 6368              cach
+000061a0: 653d 7365 6c66 2e5f 6466 5f73 6e61 7073  e=self._df_snaps
+000061b0: 686f 742c 0a20 2020 2020 2020 2020 2020  hot,.           
+000061c0: 2075 7365 5f63 6163 6865 3d75 7365 5f63   use_cache=use_c
+000061d0: 6163 6865 2c0a 2020 2020 2020 2020 290a  ache,.        ).
+000061e0: 0a20 2020 2020 2020 2069 6620 7461 626c  .        if tabl
+000061f0: 652e 6c6f 6361 7469 6f6e 2e63 6173 6566  e.location.casef
+00006200: 6f6c 6428 2920 213d 2073 656c 662e 5f6c  old() != self._l
+00006210: 6f63 6174 696f 6e2e 6361 7365 666f 6c64  ocation.casefold
+00006220: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+00006230: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+00006240: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00006250: 2020 6622 4375 7272 656e 7420 7365 7373    f"Current sess
+00006260: 696f 6e20 6973 2069 6e20 7b73 656c 662e  ion is in {self.
+00006270: 5f6c 6f63 6174 696f 6e7d 2062 7574 2064  _location} but d
+00006280: 6174 6173 6574 2027 7b74 6162 6c65 2e70  ataset '{table.p
+00006290: 726f 6a65 6374 7d2e 7b74 6162 6c65 2e64  roject}.{table.d
+000062a0: 6174 6173 6574 5f69 647d 2720 6973 206c  ataset_id}' is l
+000062b0: 6f63 6174 6564 2069 6e20 7b74 6162 6c65  ocated in {table
+000062c0: 2e6c 6f63 6174 696f 6e7d 220a 2020 2020  .location}".    
+000062d0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+000062e0: 2020 2023 202d 2d2d 2d2d 2d2d 2d2d 2d2d     # -----------
+000062f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00006300: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0a20  --------------. 
+00006310: 2020 2020 2020 2023 2043 7265 6174 6520         # Create 
+00006320: 4962 6973 2074 6162 6c65 2065 7870 7265  Ibis table expre
+00006330: 7373 696f 6e20 616e 6420 7661 6c69 6461  ssion and valida
+00006340: 7465 0a20 2020 2020 2020 2023 202d 2d2d  te.        # ---
+00006350: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00006360: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00006370: 2d2d 2d2d 2d2d 0a0a 2020 2020 2020 2020  ------..        
+00006380: 2320 5573 6520 6120 7469 6d65 2074 7261  # Use a time tra
+00006390: 7665 6c20 746f 206d 616b 6520 7375 7265  vel to make sure
+000063a0: 2074 6865 2044 6174 6146 7261 6d65 2069   the DataFrame i
+000063b0: 7320 6465 7465 726d 696e 6973 7469 632c  s deterministic,
+000063c0: 2065 7665 6e0a 2020 2020 2020 2020 2320   even.        # 
+000063d0: 6966 2074 6865 2075 6e64 6572 6c79 696e  if the underlyin
+000063e0: 6720 7461 626c 6520 6368 616e 6765 732e  g table changes.
+000063f0: 0a20 2020 2020 2020 2074 6162 6c65 5f65  .        table_e
+00006400: 7870 7265 7373 696f 6e20 3d20 6266 5f72  xpression = bf_r
+00006410: 6561 645f 6762 715f 7461 626c 652e 6765  ead_gbq_table.ge
+00006420: 745f 6962 6973 5f74 696d 655f 7472 6176  t_ibis_time_trav
+00006430: 656c 5f74 6162 6c65 280a 2020 2020 2020  el_table(.      
+00006440: 2020 2020 2020 7365 6c66 2e69 6269 735f        self.ibis_
+00006450: 636c 6965 6e74 2c0a 2020 2020 2020 2020  client,.        
+00006460: 2020 2020 7461 626c 655f 7265 662c 0a20      table_ref,. 
+00006470: 2020 2020 2020 2020 2020 2074 696d 655f             time_
+00006480: 7472 6176 656c 5f74 696d 6573 7461 6d70  travel_timestamp
+00006490: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+000064a0: 2020 2020 2066 6f72 206b 6579 2069 6e20       for key in 
+000064b0: 636f 6c75 6d6e 733a 0a20 2020 2020 2020  columns:.       
+000064c0: 2020 2020 2069 6620 6b65 7920 6e6f 7420       if key not 
+000064d0: 696e 2074 6162 6c65 5f65 7870 7265 7373  in table_express
+000064e0: 696f 6e2e 636f 6c75 6d6e 733a 0a20 2020  ion.columns:.   
+000064f0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+00006500: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
+00006510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006520: 2020 2066 2243 6f6c 756d 6e20 277b 6b65     f"Column '{ke
+00006530: 797d 2720 6f66 2060 636f 6c75 6d6e 7360  y}' of `columns`
+00006540: 206e 6f74 2066 6f75 6e64 2069 6e20 7468   not found in th
+00006550: 6973 2074 6162 6c65 2e22 0a20 2020 2020  is table.".     
+00006560: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+00006570: 2020 2020 2020 2320 2d2d 2d2d 2d2d 2d2d        # --------
+00006580: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00006590: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
+000065a0: 2020 2020 2020 2020 2320 4372 6561 7465          # Create
+000065b0: 2061 206e 6f6e 2d64 6566 6175 6c74 2069   a non-default i
+000065c0: 6e64 6578 2061 6e64 2076 616c 6964 6174  ndex and validat
+000065d0: 650a 2020 2020 2020 2020 2320 2d2d 2d2d  e.        # ----
+000065e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000065f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00006600: 2d2d 2d0a 0a20 2020 2020 2020 2023 2054  ---..        # T
+00006610: 4f44 4f28 622f 3333 3739 3235 3134 3229  ODO(b/337925142)
+00006620: 3a20 4d6f 7665 2069 6e64 6578 5f63 6f6c  : Move index_col
+00006630: 7320 6372 6561 7469 6f6e 2074 6f20 6265  s creation to be
+00006640: 666f 7265 2077 6520 6372 6561 7465 2074  fore we create t
+00006650: 6865 0a20 2020 2020 2020 2023 2049 6269  he.        # Ibi
+00006660: 7320 7461 626c 6520 6578 7072 6573 7369  s table expressi
+00006670: 6f6e 2073 6f20 7765 2064 6f6e 2774 2068  on so we don't h
+00006680: 6176 6520 6120 2253 454c 4543 5420 2a22  ave a "SELECT *"
+00006690: 2073 7562 7175 6572 7920 696e 2074 6865   subquery in the
+000066a0: 0a20 2020 2020 2020 2023 2071 7565 7279  .        # query
+000066b0: 2074 6861 7420 6368 6563 6b73 2066 6f72   that checks for
+000066c0: 2069 6e64 6578 2075 6e69 7175 656e 6573   index uniquenes
+000066d0: 732e 0a0a 2020 2020 2020 2020 696e 6465  s...        inde
+000066e0: 785f 636f 6c73 2c20 6973 5f69 6e64 6578  x_cols, is_index
+000066f0: 5f75 6e69 7175 6520 3d20 6266 5f72 6561  _unique = bf_rea
+00006700: 645f 6762 715f 7461 626c 652e 6765 745f  d_gbq_table.get_
+00006710: 696e 6465 785f 636f 6c73 5f61 6e64 5f75  index_cols_and_u
+00006720: 6e69 7175 656e 6573 7328 0a20 2020 2020  niqueness(.     
+00006730: 2020 2020 2020 2062 7163 6c69 656e 743d         bqclient=
+00006740: 7365 6c66 2e62 7163 6c69 656e 742c 0a20  self.bqclient,. 
+00006750: 2020 2020 2020 2020 2020 2069 6269 735f             ibis_
+00006760: 636c 6965 6e74 3d73 656c 662e 6962 6973  client=self.ibis
+00006770: 5f63 6c69 656e 742c 0a20 2020 2020 2020  _client,.       
+00006780: 2020 2020 2074 6162 6c65 3d74 6162 6c65       table=table
+00006790: 2c0a 2020 2020 2020 2020 2020 2020 7461  ,.            ta
+000067a0: 626c 655f 6578 7072 6573 7369 6f6e 3d74  ble_expression=t
+000067b0: 6162 6c65 5f65 7870 7265 7373 696f 6e2c  able_expression,
+000067c0: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
+000067d0: 6578 5f63 6f6c 3d69 6e64 6578 5f63 6f6c  ex_col=index_col
+000067e0: 2c0a 2020 2020 2020 2020 2020 2020 6170  ,.            ap
+000067f0: 695f 6e61 6d65 3d61 7069 5f6e 616d 652c  i_name=api_name,
+00006800: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00006810: 2020 2020 666f 7220 6b65 7920 696e 2069      for key in i
+00006820: 6e64 6578 5f63 6f6c 733a 0a20 2020 2020  ndex_cols:.     
+00006830: 2020 2020 2020 2069 6620 6b65 7920 6e6f         if key no
+00006840: 7420 696e 2074 6162 6c65 5f65 7870 7265  t in table_expre
+00006850: 7373 696f 6e2e 636f 6c75 6d6e 733a 0a20  ssion.columns:. 
+00006860: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00006870: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00006880: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006890: 2020 2020 2066 2243 6f6c 756d 6e20 607b       f"Column `{
+000068a0: 6b65 797d 6020 6f66 2060 696e 6465 785f  key}` of `index_
+000068b0: 636f 6c60 206e 6f74 2066 6f75 6e64 2069  col` not found i
+000068c0: 6e20 7468 6973 2074 6162 6c65 2e22 0a20  n this table.". 
+000068d0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+000068e0: 0a0a 2020 2020 2020 2020 2320 544f 444f  ..        # TODO
+000068f0: 2862 2f33 3337 3932 3531 3432 293a 2057  (b/337925142): W
+00006900: 6520 7368 6f75 6c64 2070 7573 6820 646f  e should push do
+00006910: 776e 2063 6f6c 756d 6e20 6669 6c74 6572  wn column filter
+00006920: 7320 7768 656e 2077 6520 6765 7420 7468  s when we get th
+00006930: 6520 7469 6d65 0a20 2020 2020 2020 2023  e time.        #
+00006940: 2074 7261 7665 6c20 7461 626c 6520 746f   travel table to
+00006950: 2061 766f 6964 2022 5345 4c45 4354 202a   avoid "SELECT *
+00006960: 2220 7375 6271 7565 7269 6573 2e0a 2020  " subqueries..  
+00006970: 2020 2020 2020 6966 2063 6f6c 756d 6e73        if columns
+00006980: 3a0a 2020 2020 2020 2020 2020 2020 7461  :.            ta
+00006990: 626c 655f 6578 7072 6573 7369 6f6e 203d  ble_expression =
+000069a0: 2074 6162 6c65 5f65 7870 7265 7373 696f   table_expressio
+000069b0: 6e2e 7365 6c65 6374 285b 2a69 6e64 6578  n.select([*index
+000069c0: 5f63 6f6c 732c 202a 636f 6c75 6d6e 735d  _cols, *columns]
+000069d0: 290a 0a20 2020 2020 2020 2023 202d 2d2d  )..        # ---
+000069e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000069f0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00006a00: 2020 2320 4372 6561 7465 206f 7264 6572    # Create order
+00006a10: 696e 6720 616e 6420 7661 6c69 6461 7465  ing and validate
+00006a20: 0a20 2020 2020 2020 2023 202d 2d2d 2d2d  .        # -----
+00006a30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00006a40: 2d2d 2d2d 2d2d 2d0a 0a20 2020 2020 2020  -------..       
+00006a50: 2069 6620 6973 5f69 6e64 6578 5f75 6e69   if is_index_uni
+00006a60: 7175 653a 0a20 2020 2020 2020 2020 2020  que:.           
+00006a70: 2061 7272 6179 5f76 616c 7565 203d 2062   array_value = b
+00006a80: 665f 7265 6164 5f67 6271 5f74 6162 6c65  f_read_gbq_table
+00006a90: 2e74 6f5f 6172 7261 795f 7661 6c75 655f  .to_array_value_
+00006aa0: 7769 7468 5f74 6f74 616c 5f6f 7264 6572  with_total_order
+00006ab0: 696e 6728 0a20 2020 2020 2020 2020 2020  ing(.           
+00006ac0: 2020 2020 2073 6573 7369 6f6e 3d73 656c       session=sel
+00006ad0: 662c 0a20 2020 2020 2020 2020 2020 2020  f,.             
+00006ae0: 2020 2074 6162 6c65 5f65 7870 7265 7373     table_express
+00006af0: 696f 6e3d 7461 626c 655f 6578 7072 6573  ion=table_expres
+00006b00: 7369 6f6e 2c0a 2020 2020 2020 2020 2020  sion,.          
+00006b10: 2020 2020 2020 746f 7461 6c5f 6f72 6465        total_orde
+00006b20: 7269 6e67 5f63 6f6c 733d 696e 6465 785f  ring_cols=index_
+00006b30: 636f 6c73 2c0a 2020 2020 2020 2020 2020  cols,.          
+00006b40: 2020 290a 2020 2020 2020 2020 656c 7365    ).        else
+00006b50: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+00006b60: 4e6f 7465 3a20 4576 656e 2074 686f 7567  Note: Even thoug
+00006b70: 6820 7765 2772 6520 6164 6469 6e67 2061  h we're adding a
+00006b80: 2064 6566 6175 6c74 206f 7264 6572 696e   default orderin
+00006b90: 6720 6865 7265 2c20 7468 6174 2773 0a20  g here, that's. 
+00006ba0: 2020 2020 2020 2020 2020 2023 206a 7573             # jus
+00006bb0: 7420 736f 2077 6520 6861 7665 2061 2064  t so we have a d
+00006bc0: 6574 6572 6d69 6e69 7374 6963 2074 6f74  eterministic tot
+00006bd0: 616c 206f 7264 6572 696e 672e 2049 6620  al ordering. If 
+00006be0: 7468 6520 7573 6572 0a20 2020 2020 2020  the user.       
+00006bf0: 2020 2020 2023 2073 7065 6369 6669 6564       # specified
+00006c00: 2061 206e 6f6e 2d75 6e69 7175 6520 696e   a non-unique in
+00006c10: 6465 782c 2077 6520 7374 696c 6c20 736f  dex, we still so
+00006c20: 7274 2062 7920 7468 6174 206c 6174 6572  rt by that later
+00006c30: 2e0a 2020 2020 2020 2020 2020 2020 6172  ..            ar
+00006c40: 7261 795f 7661 6c75 6520 3d20 6266 5f72  ray_value = bf_r
+00006c50: 6561 645f 6762 715f 7461 626c 652e 746f  ead_gbq_table.to
+00006c60: 5f61 7272 6179 5f76 616c 7565 5f77 6974  _array_value_wit
+00006c70: 685f 6465 6661 756c 745f 6f72 6465 7269  h_default_orderi
+00006c80: 6e67 280a 2020 2020 2020 2020 2020 2020  ng(.            
+00006c90: 2020 2020 7365 7373 696f 6e3d 7365 6c66      session=self
+00006ca0: 2c20 7461 626c 653d 7461 626c 655f 6578  , table=table_ex
+00006cb0: 7072 6573 7369 6f6e 2c20 7461 626c 655f  pression, table_
+00006cc0: 726f 7773 3d74 6162 6c65 2e6e 756d 5f72  rows=table.num_r
+00006cd0: 6f77 730a 2020 2020 2020 2020 2020 2020  ows.            
+00006ce0: 290a 0a20 2020 2020 2020 2023 202d 2d2d  )..        # ---
+00006cf0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00006d00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00006d10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00006d20: 2d0a 2020 2020 2020 2020 2320 4372 6561  -.        # Crea
+00006d30: 7465 2042 6c6f 636b 2026 2064 6566 6175  te Block & defau
+00006d40: 6c74 2069 6e64 6578 2069 6620 6c65 6e28  lt index if len(
+00006d50: 696e 6465 785f 636f 6c73 2920 3d3d 2030  index_cols) == 0
+00006d60: 0a20 2020 2020 2020 2023 202d 2d2d 2d2d  .        # -----
+00006d70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00006d80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00006d90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a  ---------------.
+00006da0: 0a20 2020 2020 2020 2076 616c 7565 5f63  .        value_c
+00006db0: 6f6c 756d 6e73 203d 205b 636f 6c20 666f  olumns = [col fo
+00006dc0: 7220 636f 6c20 696e 2061 7272 6179 5f76  r col in array_v
+00006dd0: 616c 7565 2e63 6f6c 756d 6e5f 6964 7320  alue.column_ids 
+00006de0: 6966 2063 6f6c 206e 6f74 2069 6e20 696e  if col not in in
+00006df0: 6465 785f 636f 6c73 5d0a 2020 2020 2020  dex_cols].      
+00006e00: 2020 626c 6f63 6b20 3d20 626c 6f63 6b73    block = blocks
+00006e10: 2e42 6c6f 636b 280a 2020 2020 2020 2020  .Block(.        
+00006e20: 2020 2020 6172 7261 795f 7661 6c75 652c      array_value,
+00006e30: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
+00006e40: 6578 5f63 6f6c 756d 6e73 3d69 6e64 6578  ex_columns=index
+00006e50: 5f63 6f6c 732c 0a20 2020 2020 2020 2020  _cols,.         
+00006e60: 2020 2063 6f6c 756d 6e5f 6c61 6265 6c73     column_labels
+00006e70: 3d76 616c 7565 5f63 6f6c 756d 6e73 2c0a  =value_columns,.
+00006e80: 2020 2020 2020 2020 2020 2020 696e 6465              inde
+00006e90: 785f 6c61 6265 6c73 3d69 6e64 6578 5f63  x_labels=index_c
+00006ea0: 6f6c 732c 0a20 2020 2020 2020 2029 0a20  ols,.        ). 
+00006eb0: 2020 2020 2020 2069 6620 6d61 785f 7265         if max_re
+00006ec0: 7375 6c74 733a 0a20 2020 2020 2020 2020  sults:.         
+00006ed0: 2020 2062 6c6f 636b 203d 2062 6c6f 636b     block = block
+00006ee0: 2e73 6c69 6365 2873 746f 703d 6d61 785f  .slice(stop=max_
+00006ef0: 7265 7375 6c74 7329 0a20 2020 2020 2020  results).       
+00006f00: 2064 6620 3d20 6461 7461 6672 616d 652e   df = dataframe.
+00006f10: 4461 7461 4672 616d 6528 626c 6f63 6b29  DataFrame(block)
+00006f20: 0a0a 2020 2020 2020 2020 2320 4966 2075  ..        # If u
+00006f30: 7365 7220 7072 6f76 6964 6564 2069 6e64  ser provided ind
+00006f40: 6578 2063 6f6c 756d 6e73 2c20 7368 6f75  ex columns, shou
+00006f50: 6c64 2073 6f72 7420 6f76 6572 2069 740a  ld sort over it.
+00006f60: 2020 2020 2020 2020 6966 206c 656e 2869          if len(i
+00006f70: 6e64 6578 5f63 6f6c 7329 203e 2030 3a0a  ndex_cols) > 0:.
+00006f80: 2020 2020 2020 2020 2020 2020 6466 2e73              df.s
+00006f90: 6f72 745f 696e 6465 7828 290a 2020 2020  ort_index().    
+00006fa0: 2020 2020 7265 7475 726e 2064 660a 0a20      return df.. 
+00006fb0: 2020 2064 6566 205f 7265 6164 5f62 6967     def _read_big
+00006fc0: 7175 6572 795f 6c6f 6164 5f6a 6f62 280a  query_load_job(.
+00006fd0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+00006fe0: 2020 2020 2020 6669 6c65 7061 7468 5f6f        filepath_o
+00006ff0: 725f 6275 6666 6572 3a20 7374 7220 7c20  r_buffer: str | 
+00007000: 494f 5b22 6279 7465 7322 5d2c 0a20 2020  IO["bytes"],.   
+00007010: 2020 2020 2074 6162 6c65 3a20 556e 696f       table: Unio
+00007020: 6e5b 6269 6771 7565 7279 2e54 6162 6c65  n[bigquery.Table
+00007030: 2c20 6269 6771 7565 7279 2e54 6162 6c65  , bigquery.Table
+00007040: 5265 6665 7265 6e63 655d 2c0a 2020 2020  Reference],.    
+00007050: 2020 2020 2a2c 0a20 2020 2020 2020 206a      *,.        j
+00007060: 6f62 5f63 6f6e 6669 673a 2062 6967 7175  ob_config: bigqu
+00007070: 6572 792e 4c6f 6164 4a6f 6243 6f6e 6669  ery.LoadJobConfi
+00007080: 672c 0a20 2020 2020 2020 2069 6e64 6578  g,.        index
+00007090: 5f63 6f6c 3a20 4974 6572 6162 6c65 5b73  _col: Iterable[s
+000070a0: 7472 5d20 7c20 7374 7220 7c20 6269 6766  tr] | str | bigf
+000070b0: 7261 6d65 732e 656e 756d 732e 4465 6661  rames.enums.Defa
+000070c0: 756c 7449 6e64 6578 4b69 6e64 203d 2028  ultIndexKind = (
+000070d0: 292c 0a20 2020 2020 2020 2063 6f6c 756d  ),.        colum
+000070e0: 6e73 3a20 4974 6572 6162 6c65 5b73 7472  ns: Iterable[str
+000070f0: 5d20 3d20 2829 2c0a 2020 2020 2920 2d3e  ] = (),.    ) ->
+00007100: 2064 6174 6166 7261 6d65 2e44 6174 6146   dataframe.DataF
+00007110: 7261 6d65 3a0a 2020 2020 2020 2020 696e  rame:.        in
+00007120: 6465 785f 636f 6c73 203d 205f 746f 5f69  dex_cols = _to_i
+00007130: 6e64 6578 5f63 6f6c 7328 696e 6465 785f  ndex_cols(index_
+00007140: 636f 6c29 0a0a 2020 2020 2020 2020 6966  col)..        if
+00007150: 206e 6f74 206a 6f62 5f63 6f6e 6669 672e   not job_config.
+00007160: 636c 7573 7465 7269 6e67 5f66 6965 6c64  clustering_field
+00007170: 7320 616e 6420 696e 6465 785f 636f 6c73  s and index_cols
+00007180: 3a0a 2020 2020 2020 2020 2020 2020 6a6f  :.            jo
+00007190: 625f 636f 6e66 6967 2e63 6c75 7374 6572  b_config.cluster
+000071a0: 696e 675f 6669 656c 6473 203d 2069 6e64  ing_fields = ind
+000071b0: 6578 5f63 6f6c 735b 3a5f 4d41 585f 434c  ex_cols[:_MAX_CL
+000071c0: 5553 5445 525f 434f 4c55 4d4e 535d 0a0a  USTER_COLUMNS]..
+000071d0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+000071e0: 7461 6e63 6528 6669 6c65 7061 7468 5f6f  tance(filepath_o
+000071f0: 725f 6275 6666 6572 2c20 7374 7229 3a0a  r_buffer, str):.
+00007200: 2020 2020 2020 2020 2020 2020 6966 2066              if f
+00007210: 696c 6570 6174 685f 6f72 5f62 7566 6665  ilepath_or_buffe
+00007220: 722e 7374 6172 7473 7769 7468 2822 6773  r.startswith("gs
+00007230: 3a2f 2f22 293a 0a20 2020 2020 2020 2020  ://"):.         
+00007240: 2020 2020 2020 206c 6f61 645f 6a6f 6220         load_job 
+00007250: 3d20 7365 6c66 2e62 7163 6c69 656e 742e  = self.bqclient.
+00007260: 6c6f 6164 5f74 6162 6c65 5f66 726f 6d5f  load_table_from_
+00007270: 7572 6928 0a20 2020 2020 2020 2020 2020  uri(.           
+00007280: 2020 2020 2020 2020 2066 696c 6570 6174           filepat
+00007290: 685f 6f72 5f62 7566 6665 722c 2074 6162  h_or_buffer, tab
+000072a0: 6c65 2c20 6a6f 625f 636f 6e66 6967 3d6a  le, job_config=j
+000072b0: 6f62 5f63 6f6e 6669 670a 2020 2020 2020  ob_config.      
+000072c0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+000072d0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+000072e0: 2020 2020 2020 2020 2020 2020 2020 7769                wi
+000072f0: 7468 206f 7065 6e28 6669 6c65 7061 7468  th open(filepath
+00007300: 5f6f 725f 6275 6666 6572 2c20 2272 6222  _or_buffer, "rb"
+00007310: 2920 6173 2073 6f75 7263 655f 6669 6c65  ) as source_file
+00007320: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00007330: 2020 2020 2020 6c6f 6164 5f6a 6f62 203d        load_job =
+00007340: 2073 656c 662e 6271 636c 6965 6e74 2e6c   self.bqclient.l
+00007350: 6f61 645f 7461 626c 655f 6672 6f6d 5f66  oad_table_from_f
+00007360: 696c 6528 0a20 2020 2020 2020 2020 2020  ile(.           
+00007370: 2020 2020 2020 2020 2020 2020 2073 6f75               sou
+00007380: 7263 655f 6669 6c65 2c20 7461 626c 652c  rce_file, table,
+00007390: 206a 6f62 5f63 6f6e 6669 673d 6a6f 625f   job_config=job_
+000073a0: 636f 6e66 6967 0a20 2020 2020 2020 2020  config.         
+000073b0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+000073c0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+000073d0: 2020 2020 2020 206c 6f61 645f 6a6f 6220         load_job 
+000073e0: 3d20 7365 6c66 2e62 7163 6c69 656e 742e  = self.bqclient.
+000073f0: 6c6f 6164 5f74 6162 6c65 5f66 726f 6d5f  load_table_from_
+00007400: 6669 6c65 280a 2020 2020 2020 2020 2020  file(.          
+00007410: 2020 2020 2020 6669 6c65 7061 7468 5f6f        filepath_o
+00007420: 725f 6275 6666 6572 2c20 7461 626c 652c  r_buffer, table,
+00007430: 206a 6f62 5f63 6f6e 6669 673d 6a6f 625f   job_config=job_
+00007440: 636f 6e66 6967 0a20 2020 2020 2020 2020  config.         
+00007450: 2020 2029 0a0a 2020 2020 2020 2020 7365     )..        se
+00007460: 6c66 2e5f 7374 6172 745f 6765 6e65 7269  lf._start_generi
+00007470: 635f 6a6f 6228 6c6f 6164 5f6a 6f62 290a  c_job(load_job).
+00007480: 2020 2020 2020 2020 7461 626c 655f 6964          table_id
+00007490: 203d 2066 227b 7461 626c 652e 7072 6f6a   = f"{table.proj
+000074a0: 6563 747d 2e7b 7461 626c 652e 6461 7461  ect}.{table.data
+000074b0: 7365 745f 6964 7d2e 7b74 6162 6c65 2e74  set_id}.{table.t
+000074c0: 6162 6c65 5f69 647d 220a 0a20 2020 2020  able_id}"..     
+000074d0: 2020 2023 2055 7064 6174 6520 7468 6520     # Update the 
+000074e0: 7461 626c 6520 6578 7069 7261 7469 6f6e  table expiration
+000074f0: 2073 6f20 7765 2061 7265 6e27 7420 6c69   so we aren't li
+00007500: 6d69 7465 6420 746f 2074 6865 2064 6566  mited to the def
+00007510: 6175 6c74 2032 340a 2020 2020 2020 2020  ault 24.        
+00007520: 2320 686f 7572 7320 6f66 2074 6865 2061  # hours of the a
+00007530: 6e6f 6e79 6d6f 7573 2064 6174 6173 6574  nonymous dataset
+00007540: 2e0a 2020 2020 2020 2020 7461 626c 655f  ..        table_
+00007550: 6578 7069 7261 7469 6f6e 203d 2062 6967  expiration = big
+00007560: 7175 6572 792e 5461 626c 6528 7461 626c  query.Table(tabl
+00007570: 655f 6964 290a 2020 2020 2020 2020 7461  e_id).        ta
+00007580: 626c 655f 6578 7069 7261 7469 6f6e 2e65  ble_expiration.e
+00007590: 7870 6972 6573 203d 2028 0a20 2020 2020  xpires = (.     
+000075a0: 2020 2020 2020 2064 6174 6574 696d 652e         datetime.
+000075b0: 6461 7465 7469 6d65 2e6e 6f77 2864 6174  datetime.now(dat
+000075c0: 6574 696d 652e 7469 6d65 7a6f 6e65 2e75  etime.timezone.u
+000075d0: 7463 2920 2b20 636f 6e73 7461 6e74 732e  tc) + constants.
+000075e0: 4445 4641 554c 545f 4558 5049 5241 5449  DEFAULT_EXPIRATI
+000075f0: 4f4e 0a20 2020 2020 2020 2029 0a20 2020  ON.        ).   
+00007600: 2020 2020 2073 656c 662e 6271 636c 6965       self.bqclie
+00007610: 6e74 2e75 7064 6174 655f 7461 626c 6528  nt.update_table(
+00007620: 7461 626c 655f 6578 7069 7261 7469 6f6e  table_expiration
+00007630: 2c20 5b22 6578 7069 7265 7322 5d29 0a0a  , ["expires"])..
+00007640: 2020 2020 2020 2020 2320 5468 6520 4269          # The Bi
+00007650: 6751 7565 7279 2052 4553 5420 4150 4920  gQuery REST API 
+00007660: 666f 7220 7461 626c 6573 2e67 6574 2064  for tables.get d
+00007670: 6f65 736e 2774 2074 616b 6520 6120 7365  oesn't take a se
+00007680: 7373 696f 6e20 4944 2c20 736f 2077 650a  ssion ID, so we.
+00007690: 2020 2020 2020 2020 2320 6361 6e27 7420          # can't 
+000076a0: 6765 7420 7468 6520 7363 6865 6d61 2066  get the schema f
+000076b0: 6f72 2061 2074 656d 7020 7461 626c 6520  or a temp table 
+000076c0: 7468 6174 2077 6179 2e0a 2020 2020 2020  that way..      
+000076d0: 2020 7265 7475 726e 2073 656c 662e 7265    return self.re
+000076e0: 6164 5f67 6271 5f74 6162 6c65 280a 2020  ad_gbq_table(.  
+000076f0: 2020 2020 2020 2020 2020 7461 626c 655f            table_
+00007700: 6964 2c0a 2020 2020 2020 2020 2020 2020  id,.            
+00007710: 696e 6465 785f 636f 6c3d 696e 6465 785f  index_col=index_
+00007720: 636f 6c2c 0a20 2020 2020 2020 2020 2020  col,.           
+00007730: 2063 6f6c 756d 6e73 3d63 6f6c 756d 6e73   columns=columns
+00007740: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+00007750: 2064 6566 2072 6561 645f 6762 715f 6d6f   def read_gbq_mo
+00007760: 6465 6c28 7365 6c66 2c20 6d6f 6465 6c5f  del(self, model_
+00007770: 6e61 6d65 3a20 7374 7229 3a0a 2020 2020  name: str):.    
+00007780: 2020 2020 2222 224c 6f61 6473 2061 2042      """Loads a B
+00007790: 6967 5175 6572 7920 4d4c 206d 6f64 656c  igQuery ML model
+000077a0: 2066 726f 6d20 4269 6751 7565 7279 2e0a   from BigQuery..
+000077b0: 0a20 2020 2020 2020 202a 2a45 7861 6d70  .        **Examp
+000077c0: 6c65 733a 2a2a 0a0a 2020 2020 2020 2020  les:**..        
+000077d0: 2020 2020 3e3e 3e20 696d 706f 7274 2062      >>> import b
+000077e0: 6967 6672 616d 6573 2e70 616e 6461 7320  igframes.pandas 
+000077f0: 6173 2062 7064 0a20 2020 2020 2020 2020  as bpd.         
+00007800: 2020 203e 3e3e 2062 7064 2e6f 7074 696f     >>> bpd.optio
+00007810: 6e73 2e64 6973 706c 6179 2e70 726f 6772  ns.display.progr
+00007820: 6573 735f 6261 7220 3d20 4e6f 6e65 0a0a  ess_bar = None..
+00007830: 2020 2020 2020 2020 5265 6164 2061 6e20          Read an 
+00007840: 6578 6973 7469 6e67 2042 6967 5175 6572  existing BigQuer
+00007850: 7920 4d4c 206d 6f64 656c 2e0a 0a20 2020  y ML model...   
+00007860: 2020 2020 2020 2020 203e 3e3e 206d 6f64           >>> mod
+00007870: 656c 5f6e 616d 6520 3d20 2262 6967 6672  el_name = "bigfr
+00007880: 616d 6573 2d64 6576 2e62 716d 6c5f 7475  ames-dev.bqml_tu
+00007890: 746f 7269 616c 2e70 656e 6775 696e 735f  torial.penguins_
+000078a0: 6d6f 6465 6c22 0a20 2020 2020 2020 2020  model".         
+000078b0: 2020 203e 3e3e 206d 6f64 656c 203d 2062     >>> model = b
+000078c0: 7064 2e72 6561 645f 6762 715f 6d6f 6465  pd.read_gbq_mode
+000078d0: 6c28 6d6f 6465 6c5f 6e61 6d65 290a 0a20  l(model_name).. 
+000078e0: 2020 2020 2020 2041 7267 733a 0a20 2020         Args:.   
+000078f0: 2020 2020 2020 2020 206d 6f64 656c 5f6e           model_n
+00007900: 616d 6520 2873 7472 293a 0a20 2020 2020  ame (str):.     
+00007910: 2020 2020 2020 2020 2020 2074 6865 206d             the m
+00007920: 6f64 656c 2773 206e 616d 6520 696e 2042  odel's name in B
+00007930: 6967 5175 6572 7920 696e 2074 6865 2066  igQuery in the f
+00007940: 6f72 6d61 740a 2020 2020 2020 2020 2020  ormat.          
+00007950: 2020 2020 2020 6070 726f 6a65 6374 5f69        `project_i
+00007960: 642e 6461 7461 7365 745f 6964 2e6d 6f64  d.dataset_id.mod
+00007970: 656c 5f69 6460 2c20 6f72 206a 7573 7420  el_id`, or just 
+00007980: 6064 6174 6173 6574 5f69 642e 6d6f 6465  `dataset_id.mode
+00007990: 6c5f 6964 600a 2020 2020 2020 2020 2020  l_id`.          
+000079a0: 2020 2020 2020 746f 206c 6f61 6420 6672        to load fr
+000079b0: 6f6d 2074 6865 2064 6566 6175 6c74 2070  om the default p
+000079c0: 726f 6a65 6374 2e0a 0a20 2020 2020 2020  roject...       
+000079d0: 2052 6574 7572 6e73 3a0a 2020 2020 2020   Returns:.      
+000079e0: 2020 2020 2020 4120 6269 6766 7261 6d65        A bigframe
+000079f0: 732e 6d6c 204d 6f64 656c 2c20 5472 616e  s.ml Model, Tran
+00007a00: 7366 6f72 6d65 7220 6f72 2050 6970 656c  sformer or Pipel
+00007a10: 696e 6520 7772 6170 7069 6e67 2074 6865  ine wrapping the
+00007a20: 206d 6f64 656c 2e0a 2020 2020 2020 2020   model..        
+00007a30: 2222 220a 2020 2020 2020 2020 696d 706f  """.        impo
+00007a40: 7274 2062 6967 6672 616d 6573 2e6d 6c2e  rt bigframes.ml.
+00007a50: 6c6f 6164 6572 0a0a 2020 2020 2020 2020  loader..        
+00007a60: 6d6f 6465 6c5f 7265 6620 3d20 6269 6771  model_ref = bigq
+00007a70: 7565 7279 2e4d 6f64 656c 5265 6665 7265  uery.ModelRefere
+00007a80: 6e63 652e 6672 6f6d 5f73 7472 696e 6728  nce.from_string(
+00007a90: 0a20 2020 2020 2020 2020 2020 206d 6f64  .            mod
+00007aa0: 656c 5f6e 616d 652c 2064 6566 6175 6c74  el_name, default
+00007ab0: 5f70 726f 6a65 6374 3d73 656c 662e 6271  _project=self.bq
+00007ac0: 636c 6965 6e74 2e70 726f 6a65 6374 0a20  client.project. 
+00007ad0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00007ae0: 206d 6f64 656c 203d 2073 656c 662e 6271   model = self.bq
+00007af0: 636c 6965 6e74 2e67 6574 5f6d 6f64 656c  client.get_model
+00007b00: 286d 6f64 656c 5f72 6566 290a 2020 2020  (model_ref).    
+00007b10: 2020 2020 7265 7475 726e 2062 6967 6672      return bigfr
+00007b20: 616d 6573 2e6d 6c2e 6c6f 6164 6572 2e66  ames.ml.loader.f
+00007b30: 726f 6d5f 6271 2873 656c 662c 206d 6f64  rom_bq(self, mod
+00007b40: 656c 290a 0a20 2020 2040 7479 7069 6e67  el)..    @typing
+00007b50: 2e6f 7665 726c 6f61 640a 2020 2020 6465  .overload.    de
+00007b60: 6620 7265 6164 5f70 616e 6461 7328 0a20  f read_pandas(. 
+00007b70: 2020 2020 2020 2073 656c 662c 2070 616e         self, pan
+00007b80: 6461 735f 6461 7461 6672 616d 653a 2070  das_dataframe: p
+00007b90: 616e 6461 732e 496e 6465 780a 2020 2020  andas.Index.    
+00007ba0: 2920 2d3e 2062 6967 6672 616d 6573 2e63  ) -> bigframes.c
+00007bb0: 6f72 652e 696e 6465 7865 732e 496e 6465  ore.indexes.Inde
+00007bc0: 783a 0a20 2020 2020 2020 202e 2e2e 0a0a  x:.        .....
+00007bd0: 2020 2020 4074 7970 696e 672e 6f76 6572      @typing.over
+00007be0: 6c6f 6164 0a20 2020 2064 6566 2072 6561  load.    def rea
+00007bf0: 645f 7061 6e64 6173 2873 656c 662c 2070  d_pandas(self, p
+00007c00: 616e 6461 735f 6461 7461 6672 616d 653a  andas_dataframe:
+00007c10: 2070 616e 6461 732e 5365 7269 6573 2920   pandas.Series) 
+00007c20: 2d3e 2062 6967 6672 616d 6573 2e73 6572  -> bigframes.ser
+00007c30: 6965 732e 5365 7269 6573 3a0a 2020 2020  ies.Series:.    
+00007c40: 2020 2020 2e2e 2e0a 0a20 2020 2040 7479      .....    @ty
+00007c50: 7069 6e67 2e6f 7665 726c 6f61 640a 2020  ping.overload.  
+00007c60: 2020 6465 6620 7265 6164 5f70 616e 6461    def read_panda
+00007c70: 7328 7365 6c66 2c20 7061 6e64 6173 5f64  s(self, pandas_d
+00007c80: 6174 6166 7261 6d65 3a20 7061 6e64 6173  ataframe: pandas
+00007c90: 2e44 6174 6146 7261 6d65 2920 2d3e 2064  .DataFrame) -> d
+00007ca0: 6174 6166 7261 6d65 2e44 6174 6146 7261  ataframe.DataFra
+00007cb0: 6d65 3a0a 2020 2020 2020 2020 2e2e 2e0a  me:.        ....
+00007cc0: 0a20 2020 2064 6566 2072 6561 645f 7061  .    def read_pa
+00007cd0: 6e64 6173 280a 2020 2020 2020 2020 7365  ndas(.        se
+00007ce0: 6c66 2c20 7061 6e64 6173 5f64 6174 6166  lf, pandas_dataf
+00007cf0: 7261 6d65 3a20 556e 696f 6e5b 7061 6e64  rame: Union[pand
+00007d00: 6173 2e44 6174 6146 7261 6d65 2c20 7061  as.DataFrame, pa
+00007d10: 6e64 6173 2e53 6572 6965 732c 2070 616e  ndas.Series, pan
+00007d20: 6461 732e 496e 6465 785d 0a20 2020 2029  das.Index].    )
+00007d30: 3a0a 2020 2020 2020 2020 2222 224c 6f61  :.        """Loa
+00007d40: 6473 2044 6174 6146 7261 6d65 2066 726f  ds DataFrame fro
+00007d50: 6d20 6120 7061 6e64 6173 2044 6174 6146  m a pandas DataF
+00007d60: 7261 6d65 2e0a 0a20 2020 2020 2020 2054  rame...        T
+00007d70: 6865 2070 616e 6461 7320 4461 7461 4672  he pandas DataFr
+00007d80: 616d 6520 7769 6c6c 2062 6520 7065 7273  ame will be pers
+00007d90: 6973 7465 6420 6173 2061 2074 656d 706f  isted as a tempo
+00007da0: 7261 7279 2042 6967 5175 6572 7920 7461  rary BigQuery ta
+00007db0: 626c 652c 2077 6869 6368 2063 616e 2062  ble, which can b
+00007dc0: 650a 2020 2020 2020 2020 6175 746f 6d61  e.        automa
+00007dd0: 7469 6361 6c6c 7920 7265 6379 636c 6564  tically recycled
+00007de0: 2061 6674 6572 2074 6865 2053 6573 7369   after the Sessi
+00007df0: 6f6e 2069 7320 636c 6f73 6564 2e0a 0a20  on is closed... 
+00007e00: 2020 2020 2020 202e 2e20 6e6f 7465 3a3a         .. note::
+00007e10: 0a20 2020 2020 2020 2020 2020 2044 6174  .            Dat
+00007e20: 6120 6973 2069 6e6c 696e 6564 2069 6e20  a is inlined in 
+00007e30: 7468 6520 7175 6572 7920 5351 4c20 6966  the query SQL if
+00007e40: 2069 7420 6973 2073 6d61 6c6c 2065 6e6f   it is small eno
+00007e50: 7567 6820 2872 6f75 6768 6c79 2035 4d42  ugh (roughly 5MB
+00007e60: 0a20 2020 2020 2020 2020 2020 206f 7220  .            or 
+00007e70: 6c65 7373 2069 6e20 6d65 6d6f 7279 292e  less in memory).
+00007e80: 204c 6172 6765 7220 7369 7a65 2064 6174   Larger size dat
+00007e90: 6120 6973 206c 6f61 6465 6420 746f 2061  a is loaded to a
+00007ea0: 2042 6967 5175 6572 7920 7461 626c 650a   BigQuery table.
+00007eb0: 2020 2020 2020 2020 2020 2020 696e 7374              inst
+00007ec0: 6561 642e 0a0a 2020 2020 2020 2020 2a2a  ead...        **
+00007ed0: 4578 616d 706c 6573 3a2a 2a0a 0a20 2020  Examples:**..   
+00007ee0: 2020 2020 2020 2020 203e 3e3e 2069 6d70           >>> imp
+00007ef0: 6f72 7420 6269 6766 7261 6d65 732e 7061  ort bigframes.pa
+00007f00: 6e64 6173 2061 7320 6270 640a 2020 2020  ndas as bpd.    
+00007f10: 2020 2020 2020 2020 3e3e 3e20 696d 706f          >>> impo
+00007f20: 7274 2070 616e 6461 7320 6173 2070 640a  rt pandas as pd.
+00007f30: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+00007f40: 6270 642e 6f70 7469 6f6e 732e 6469 7370  bpd.options.disp
+00007f50: 6c61 792e 7072 6f67 7265 7373 5f62 6172  lay.progress_bar
+00007f60: 203d 204e 6f6e 650a 0a20 2020 2020 2020   = None..       
+00007f70: 2020 2020 203e 3e3e 2064 203d 207b 2763       >>> d = {'c
+00007f80: 6f6c 3127 3a20 5b31 2c20 325d 2c20 2763  ol1': [1, 2], 'c
+00007f90: 6f6c 3227 3a20 5b33 2c20 345d 7d0a 2020  ol2': [3, 4]}.  
+00007fa0: 2020 2020 2020 2020 2020 3e3e 3e20 7061            >>> pa
+00007fb0: 6e64 6173 5f64 6620 3d20 7064 2e44 6174  ndas_df = pd.Dat
+00007fc0: 6146 7261 6d65 2864 6174 613d 6429 0a20  aFrame(data=d). 
+00007fd0: 2020 2020 2020 2020 2020 203e 3e3e 2064             >>> d
+00007fe0: 6620 3d20 6270 642e 7265 6164 5f70 616e  f = bpd.read_pan
+00007ff0: 6461 7328 7061 6e64 6173 5f64 6629 0a20  das(pandas_df). 
+00008000: 2020 2020 2020 2020 2020 203e 3e3e 2064             >>> d
+00008010: 660a 2020 2020 2020 2020 2020 2020 2020  f.              
+00008020: 2063 6f6c 3120 2063 6f6c 320a 2020 2020   col1  col2.    
+00008030: 2020 2020 2020 2020 3020 2020 2020 3120          0     1 
+00008040: 2020 2020 330a 2020 2020 2020 2020 2020      3.          
+00008050: 2020 3120 2020 2020 3220 2020 2020 340a    1     2     4.
+00008060: 2020 2020 2020 2020 2020 2020 3c42 4c41              <BLA
+00008070: 4e4b 4c49 4e45 3e0a 2020 2020 2020 2020  NKLINE>.        
+00008080: 2020 2020 5b32 2072 6f77 7320 7820 3220      [2 rows x 2 
+00008090: 636f 6c75 6d6e 735d 0a0a 2020 2020 2020  columns]..      
+000080a0: 2020 4172 6773 3a0a 2020 2020 2020 2020    Args:.        
+000080b0: 2020 2020 7061 6e64 6173 5f64 6174 6166      pandas_dataf
+000080c0: 7261 6d65 2028 7061 6e64 6173 2e44 6174  rame (pandas.Dat
+000080d0: 6146 7261 6d65 2c20 7061 6e64 6173 2e53  aFrame, pandas.S
+000080e0: 6572 6965 732c 206f 7220 7061 6e64 6173  eries, or pandas
+000080f0: 2e49 6e64 6578 293a 0a20 2020 2020 2020  .Index):.       
+00008100: 2020 2020 2020 2020 2061 2070 616e 6461           a panda
+00008110: 7320 4461 7461 4672 616d 652f 5365 7269  s DataFrame/Seri
+00008120: 6573 2f49 6e64 6578 206f 626a 6563 7420  es/Index object 
+00008130: 746f 2062 6520 6c6f 6164 6564 2e0a 0a20  to be loaded... 
+00008140: 2020 2020 2020 2052 6574 7572 6e73 3a0a         Returns:.
+00008150: 2020 2020 2020 2020 2020 2020 416e 2065              An e
+00008160: 7175 6976 616c 656e 7420 6269 6766 7261  quivalent bigfra
+00008170: 6d65 732e 7061 6e64 6173 2e28 4461 7461  mes.pandas.(Data
+00008180: 4672 616d 652f 5365 7269 6573 2f49 6e64  Frame/Series/Ind
+00008190: 6578 2920 6f62 6a65 6374 0a20 2020 2020  ex) object.     
+000081a0: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
+000081b0: 6d70 6f72 7420 6269 6766 7261 6d65 732e  mport bigframes.
+000081c0: 7365 7269 6573 2061 7320 7365 7269 6573  series as series
+000081d0: 0a0a 2020 2020 2020 2020 2320 5472 7920  ..        # Try 
+000081e0: 746f 2068 616e 646c 6520 6e6f 6e2d 6461  to handle non-da
+000081f0: 7461 6672 616d 6520 7061 6e64 6173 206f  taframe pandas o
+00008200: 626a 6563 7473 2061 7320 7765 6c6c 0a20  bjects as well. 
+00008210: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+00008220: 616e 6365 2870 616e 6461 735f 6461 7461  ance(pandas_data
+00008230: 6672 616d 652c 2070 616e 6461 732e 5365  frame, pandas.Se
+00008240: 7269 6573 293a 0a20 2020 2020 2020 2020  ries):.         
+00008250: 2020 2062 665f 6466 203d 2073 656c 662e     bf_df = self.
+00008260: 5f72 6561 645f 7061 6e64 6173 2870 616e  _read_pandas(pan
+00008270: 6461 732e 4461 7461 4672 616d 6528 7061  das.DataFrame(pa
+00008280: 6e64 6173 5f64 6174 6166 7261 6d65 292c  ndas_dataframe),
+00008290: 2022 7265 6164 5f70 616e 6461 7322 290a   "read_pandas").
+000082a0: 2020 2020 2020 2020 2020 2020 6266 5f73              bf_s
+000082b0: 6572 6965 7320 3d20 7479 7069 6e67 2e63  eries = typing.c
+000082c0: 6173 7428 7365 7269 6573 2e53 6572 6965  ast(series.Serie
+000082d0: 732c 2062 665f 6466 5b62 665f 6466 2e63  s, bf_df[bf_df.c
+000082e0: 6f6c 756d 6e73 5b30 5d5d 290a 2020 2020  olumns[0]]).    
+000082f0: 2020 2020 2020 2020 2320 7772 6170 7069          # wrappi
+00008300: 6e67 2069 6e74 6f20 6466 2063 616e 2073  ng into df can s
+00008310: 6574 206e 616d 6520 746f 2030 2073 6f20  et name to 0 so 
+00008320: 7265 7365 7420 746f 206f 7269 6769 6e61  reset to origina
+00008330: 6c20 6f62 6a65 6374 206e 616d 650a 2020  l object name.  
+00008340: 2020 2020 2020 2020 2020 6266 5f73 6572            bf_ser
+00008350: 6965 732e 6e61 6d65 203d 2070 616e 6461  ies.name = panda
+00008360: 735f 6461 7461 6672 616d 652e 6e61 6d65  s_dataframe.name
+00008370: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00008380: 7572 6e20 6266 5f73 6572 6965 730a 2020  urn bf_series.  
+00008390: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+000083a0: 6e63 6528 7061 6e64 6173 5f64 6174 6166  nce(pandas_dataf
+000083b0: 7261 6d65 2c20 7061 6e64 6173 2e49 6e64  rame, pandas.Ind
+000083c0: 6578 293a 0a20 2020 2020 2020 2020 2020  ex):.           
+000083d0: 2072 6574 7572 6e20 7365 6c66 2e5f 7265   return self._re
+000083e0: 6164 5f70 616e 6461 7328 0a20 2020 2020  ad_pandas(.     
+000083f0: 2020 2020 2020 2020 2020 2070 616e 6461             panda
+00008400: 732e 4461 7461 4672 616d 6528 696e 6465  s.DataFrame(inde
+00008410: 783d 7061 6e64 6173 5f64 6174 6166 7261  x=pandas_datafra
+00008420: 6d65 292c 2022 7265 6164 5f70 616e 6461  me), "read_panda
+00008430: 7322 0a20 2020 2020 2020 2020 2020 2029  s".            )
+00008440: 2e69 6e64 6578 0a20 2020 2020 2020 2069  .index.        i
+00008450: 6620 6973 696e 7374 616e 6365 2870 616e  f isinstance(pan
+00008460: 6461 735f 6461 7461 6672 616d 652c 2070  das_dataframe, p
+00008470: 616e 6461 732e 4461 7461 4672 616d 6529  andas.DataFrame)
+00008480: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00008490: 7475 726e 2073 656c 662e 5f72 6561 645f  turn self._read_
+000084a0: 7061 6e64 6173 2870 616e 6461 735f 6461  pandas(pandas_da
+000084b0: 7461 6672 616d 652c 2022 7265 6164 5f70  taframe, "read_p
+000084c0: 616e 6461 7322 290a 2020 2020 2020 2020  andas").        
+000084d0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+000084e0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+000084f0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+00008500: 2020 2020 6622 7265 6164 5f70 616e 6461      f"read_panda
+00008510: 7328 2920 6578 7065 6374 7320 6120 7061  s() expects a pa
+00008520: 6e64 6173 2e44 6174 6146 7261 6d65 2c20  ndas.DataFrame, 
+00008530: 6275 7420 676f 7420 6120 7b74 7970 6528  but got a {type(
+00008540: 7061 6e64 6173 5f64 6174 6166 7261 6d65  pandas_dataframe
+00008550: 297d 220a 2020 2020 2020 2020 2020 2020  )}".            
+00008560: 290a 0a20 2020 2064 6566 205f 7265 6164  )..    def _read
+00008570: 5f70 616e 6461 7328 0a20 2020 2020 2020  _pandas(.       
+00008580: 2073 656c 662c 2070 616e 6461 735f 6461   self, pandas_da
+00008590: 7461 6672 616d 653a 2070 616e 6461 732e  taframe: pandas.
+000085a0: 4461 7461 4672 616d 652c 2061 7069 5f6e  DataFrame, api_n
+000085b0: 616d 653a 2073 7472 0a20 2020 2029 202d  ame: str.    ) -
+000085c0: 3e20 6461 7461 6672 616d 652e 4461 7461  > dataframe.Data
+000085d0: 4672 616d 653a 0a20 2020 2020 2020 2069  Frame:.        i
+000085e0: 6d70 6f72 7420 6269 6766 7261 6d65 732e  mport bigframes.
+000085f0: 6461 7461 6672 616d 6520 6173 2064 6174  dataframe as dat
+00008600: 6166 7261 6d65 0a0a 2020 2020 2020 2020  aframe..        
+00008610: 6966 2069 7369 6e73 7461 6e63 6528 7061  if isinstance(pa
+00008620: 6e64 6173 5f64 6174 6166 7261 6d65 2c20  ndas_dataframe, 
+00008630: 6461 7461 6672 616d 652e 4461 7461 4672  dataframe.DataFr
+00008640: 616d 6529 3a0a 2020 2020 2020 2020 2020  ame):.          
+00008650: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00008660: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+00008670: 2020 2020 2272 6561 645f 7061 6e64 6173      "read_pandas
+00008680: 2829 2065 7870 6563 7473 2061 2070 616e  () expects a pan
+00008690: 6461 732e 4461 7461 4672 616d 652c 2062  das.DataFrame, b
+000086a0: 7574 2067 6f74 2061 2022 0a20 2020 2020  ut got a ".     
+000086b0: 2020 2020 2020 2020 2020 2022 6269 6766             "bigf
+000086c0: 7261 6d65 732e 7061 6e64 6173 2e44 6174  rames.pandas.Dat
+000086d0: 6146 7261 6d65 2e22 0a20 2020 2020 2020  aFrame.".       
+000086e0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+000086f0: 696e 6c69 6e65 5f64 6620 3d20 7365 6c66  inline_df = self
+00008700: 2e5f 7265 6164 5f70 616e 6461 735f 696e  ._read_pandas_in
+00008710: 6c69 6e65 2870 616e 6461 735f 6461 7461  line(pandas_data
+00008720: 6672 616d 6529 0a20 2020 2020 2020 2069  frame).        i
+00008730: 6620 696e 6c69 6e65 5f64 6620 6973 206e  f inline_df is n
+00008740: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+00008750: 2020 2020 2072 6574 7572 6e20 696e 6c69       return inli
+00008760: 6e65 5f64 660a 2020 2020 2020 2020 7472  ne_df.        tr
+00008770: 793a 0a20 2020 2020 2020 2020 2020 2072  y:.            r
+00008780: 6574 7572 6e20 7365 6c66 2e5f 7265 6164  eturn self._read
+00008790: 5f70 616e 6461 735f 6c6f 6164 5f6a 6f62  _pandas_load_job
+000087a0: 2870 616e 6461 735f 6461 7461 6672 616d  (pandas_datafram
+000087b0: 652c 2061 7069 5f6e 616d 6529 0a20 2020  e, api_name).   
+000087c0: 2020 2020 2065 7863 6570 7420 7061 2e41       except pa.A
+000087d0: 7272 6f77 496e 7661 6c69 6420 6173 2065  rrowInvalid as e
+000087e0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+000087f0: 6973 6520 7061 2e41 7272 6f77 496e 7661  ise pa.ArrowInva
+00008800: 6c69 6428 0a20 2020 2020 2020 2020 2020  lid(.           
+00008810: 2020 2020 2066 2243 6f75 6c64 206e 6f74       f"Could not
+00008820: 2063 6f6e 7665 7274 2077 6974 6820 6120   convert with a 
+00008830: 4269 6751 7565 7279 2074 7970 653a 2060  BigQuery type: `
+00008840: 7b65 7d60 2e20 220a 2020 2020 2020 2020  {e}`. ".        
+00008850: 2020 2020 2920 6672 6f6d 2065 0a0a 2020      ) from e..  
+00008860: 2020 6465 6620 5f72 6561 645f 7061 6e64    def _read_pand
+00008870: 6173 5f69 6e6c 696e 6528 0a20 2020 2020  as_inline(.     
+00008880: 2020 2073 656c 662c 2070 616e 6461 735f     self, pandas_
+00008890: 6461 7461 6672 616d 653a 2070 616e 6461  dataframe: panda
+000088a0: 732e 4461 7461 4672 616d 650a 2020 2020  s.DataFrame.    
+000088b0: 2920 2d3e 204f 7074 696f 6e61 6c5b 6461  ) -> Optional[da
+000088c0: 7461 6672 616d 652e 4461 7461 4672 616d  taframe.DataFram
+000088d0: 655d 3a0a 2020 2020 2020 2020 696d 706f  e]:.        impo
+000088e0: 7274 2062 6967 6672 616d 6573 2e64 6174  rt bigframes.dat
+000088f0: 6166 7261 6d65 2061 7320 6461 7461 6672  aframe as datafr
+00008900: 616d 650a 0a20 2020 2020 2020 2069 6620  ame..        if 
+00008910: 7061 6e64 6173 5f64 6174 6166 7261 6d65  pandas_dataframe
+00008920: 2e6d 656d 6f72 795f 7573 6167 6528 6465  .memory_usage(de
+00008930: 6570 3d54 7275 6529 2e73 756d 2829 203e  ep=True).sum() >
+00008940: 204d 4158 5f49 4e4c 494e 455f 4446 5f42   MAX_INLINE_DF_B
+00008950: 5954 4553 3a0a 2020 2020 2020 2020 2020  YTES:.          
+00008960: 2020 7265 7475 726e 204e 6f6e 650a 0a20    return None.. 
+00008970: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+00008980: 2020 2020 2020 2020 696e 6c69 6e65 5f64          inline_d
+00008990: 6620 3d20 6461 7461 6672 616d 652e 4461  f = dataframe.Da
+000089a0: 7461 4672 616d 6528 0a20 2020 2020 2020  taFrame(.       
+000089b0: 2020 2020 2020 2020 2062 6c6f 636b 732e           blocks.
+000089c0: 426c 6f63 6b2e 6672 6f6d 5f6c 6f63 616c  Block.from_local
+000089d0: 2870 616e 6461 735f 6461 7461 6672 616d  (pandas_datafram
+000089e0: 652c 2073 656c 6629 0a20 2020 2020 2020  e, self).       
+000089f0: 2020 2020 2029 0a20 2020 2020 2020 2065       ).        e
+00008a00: 7863 6570 7420 7061 2e41 7272 6f77 496e  xcept pa.ArrowIn
+00008a10: 7661 6c69 6420 6173 2065 3a0a 2020 2020  valid as e:.    
+00008a20: 2020 2020 2020 2020 7261 6973 6520 7061          raise pa
+00008a30: 2e41 7272 6f77 496e 7661 6c69 6428 0a20  .ArrowInvalid(. 
+00008a40: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00008a50: 2243 6f75 6c64 206e 6f74 2063 6f6e 7665  "Could not conve
+00008a60: 7274 2077 6974 6820 6120 4269 6751 7565  rt with a BigQue
+00008a70: 7279 2074 7970 653a 2060 7b65 7d60 2e20  ry type: `{e}`. 
+00008a80: 220a 2020 2020 2020 2020 2020 2020 2920  ".            ) 
+00008a90: 6672 6f6d 2065 0a20 2020 2020 2020 2065  from e.        e
+00008aa0: 7863 6570 7420 5661 6c75 6545 7272 6f72  xcept ValueError
+00008ab0: 3a20 2023 2054 6872 6f77 6e20 6279 2069  :  # Thrown by i
+00008ac0: 6269 7320 666f 7220 736f 6d65 2075 6e68  bis for some unh
+00008ad0: 616e 646c 6564 2074 7970 6573 0a20 2020  andled types.   
+00008ae0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00008af0: 4e6f 6e65 0a20 2020 2020 2020 2065 7863  None.        exc
+00008b00: 6570 7420 7061 2e41 7272 6f77 5479 7065  ept pa.ArrowType
+00008b10: 4572 726f 723a 2020 2320 5468 726f 776e  Error:  # Thrown
+00008b20: 2062 7920 6172 726f 7720 666f 7220 7479   by arrow for ty
+00008b30: 7065 7320 7769 7468 6f75 7420 6d61 7070  pes without mapp
+00008b40: 696e 6720 2867 656f 292e 0a20 2020 2020  ing (geo)..     
+00008b50: 2020 2020 2020 2072 6574 7572 6e20 4e6f         return No
+00008b60: 6e65 0a0a 2020 2020 2020 2020 696e 6c69  ne..        inli
+00008b70: 6e65 5f74 7970 6573 203d 2069 6e6c 696e  ne_types = inlin
+00008b80: 655f 6466 2e5f 626c 6f63 6b2e 6578 7072  e_df._block.expr
+00008b90: 2e73 6368 656d 612e 6474 7970 6573 0a20  .schema.dtypes. 
+00008ba0: 2020 2020 2020 2023 2049 6269 7320 6861         # Ibis ha
+00008bb0: 7320 7072 6f62 6c65 6d73 2065 7363 6170  s problems escap
+00008bc0: 696e 6720 6279 7465 7320 6c69 7465 7261  ing bytes litera
+00008bd0: 6c73 2c20 7768 6963 6820 7769 6c6c 2063  ls, which will c
+00008be0: 6175 7365 2073 796e 7461 7820 6572 726f  ause syntax erro
+00008bf0: 7273 2073 6572 7665 722d 7369 6465 2e0a  rs server-side..
+00008c00: 2020 2020 2020 2020 6966 2061 6c6c 2864          if all(d
+00008c10: 7479 7065 2069 6e20 494e 4c49 4e41 424c  type in INLINABL
+00008c20: 455f 4454 5950 4553 2066 6f72 2064 7479  E_DTYPES for dty
+00008c30: 7065 2069 6e20 696e 6c69 6e65 5f74 7970  pe in inline_typ
+00008c40: 6573 293a 0a20 2020 2020 2020 2020 2020  es):.           
+00008c50: 2072 6574 7572 6e20 696e 6c69 6e65 5f64   return inline_d
+00008c60: 660a 2020 2020 2020 2020 7265 7475 726e  f.        return
+00008c70: 204e 6f6e 650a 0a20 2020 2064 6566 205f   None..    def _
+00008c80: 7265 6164 5f70 616e 6461 735f 6c6f 6164  read_pandas_load
+00008c90: 5f6a 6f62 280a 2020 2020 2020 2020 7365  _job(.        se
+00008ca0: 6c66 2c20 7061 6e64 6173 5f64 6174 6166  lf, pandas_dataf
+00008cb0: 7261 6d65 3a20 7061 6e64 6173 2e44 6174  rame: pandas.Dat
+00008cc0: 6146 7261 6d65 2c20 6170 695f 6e61 6d65  aFrame, api_name
+00008cd0: 3a20 7374 720a 2020 2020 2920 2d3e 2064  : str.    ) -> d
+00008ce0: 6174 6166 7261 6d65 2e44 6174 6146 7261  ataframe.DataFra
+00008cf0: 6d65 3a0a 2020 2020 2020 2020 696d 706f  me:.        impo
+00008d00: 7274 2062 6967 6672 616d 6573 2e64 6174  rt bigframes.dat
+00008d10: 6166 7261 6d65 2061 7320 6461 7461 6672  aframe as datafr
+00008d20: 616d 650a 0a20 2020 2020 2020 2063 6f6c  ame..        col
+00008d30: 5f69 6e64 6578 203d 2070 616e 6461 735f  _index = pandas_
+00008d40: 6461 7461 6672 616d 652e 636f 6c75 6d6e  dataframe.column
+00008d50: 732e 636f 7079 2829 0a20 2020 2020 2020  s.copy().       
+00008d60: 2063 6f6c 5f6c 6162 656c 732c 2069 6478   col_labels, idx
+00008d70: 5f6c 6162 656c 7320 3d20 280a 2020 2020  _labels = (.    
+00008d80: 2020 2020 2020 2020 636f 6c5f 696e 6465          col_inde
+00008d90: 782e 746f 5f6c 6973 7428 292c 0a20 2020  x.to_list(),.   
+00008da0: 2020 2020 2020 2020 2070 616e 6461 735f           pandas_
+00008db0: 6461 7461 6672 616d 652e 696e 6465 782e  dataframe.index.
+00008dc0: 6e61 6d65 732c 0a20 2020 2020 2020 2029  names,.        )
+00008dd0: 0a20 2020 2020 2020 206e 6577 5f63 6f6c  .        new_col
+00008de0: 5f69 6473 2c20 6e65 775f 6964 785f 6964  _ids, new_idx_id
+00008df0: 7320 3d20 7574 696c 732e 6765 745f 7374  s = utils.get_st
+00008e00: 616e 6461 7264 697a 6564 5f69 6473 280a  andardized_ids(.
+00008e10: 2020 2020 2020 2020 2020 2020 636f 6c5f              col_
+00008e20: 6c61 6265 6c73 2c0a 2020 2020 2020 2020  labels,.        
+00008e30: 2020 2020 6964 785f 6c61 6265 6c73 2c0a      idx_labels,.
+00008e40: 2020 2020 2020 2020 2020 2020 2320 4c6f              # Lo
+00008e50: 6164 696e 6720 7061 7271 7565 7420 6669  ading parquet fi
+00008e60: 6c65 7320 696e 746f 2042 6967 5175 6572  les into BigQuer
+00008e70: 7920 7769 7468 2073 7065 6369 616c 2063  y with special c
+00008e80: 6f6c 756d 6e20 6e61 6d65 730a 2020 2020  olumn names.    
+00008e90: 2020 2020 2020 2020 2320 6973 206f 6e6c          # is onl
+00008ea0: 7920 7375 7070 6f72 7465 6420 756e 6465  y supported unde
+00008eb0: 7220 616e 2061 6c6c 6f77 6c69 7374 2e0a  r an allowlist..
+00008ec0: 2020 2020 2020 2020 2020 2020 7374 7269              stri
+00008ed0: 6374 3d54 7275 652c 0a20 2020 2020 2020  ct=True,.       
+00008ee0: 2029 0a0a 2020 2020 2020 2020 2320 4164   )..        # Ad
+00008ef0: 6420 6f72 6465 7220 636f 6c75 6d6e 2074  d order column t
+00008f00: 6f20 7061 6e64 6173 2044 6174 6146 7261  o pandas DataFra
+00008f10: 6d65 2074 6f20 7072 6573 6572 7665 206f  me to preserve o
+00008f20: 7264 6572 2069 6e20 4269 6751 7565 7279  rder in BigQuery
+00008f30: 0a20 2020 2020 2020 206f 7264 6572 696e  .        orderin
+00008f40: 675f 636f 6c20 3d20 2272 6f77 6964 220a  g_col = "rowid".
+00008f50: 2020 2020 2020 2020 636f 6c75 6d6e 7320          columns 
+00008f60: 3d20 6672 6f7a 656e 7365 7428 636f 6c5f  = frozenset(col_
+00008f70: 6c61 6265 6c73 202b 2069 6478 5f6c 6162  labels + idx_lab
+00008f80: 656c 7329 0a20 2020 2020 2020 2073 7566  els).        suf
+00008f90: 6669 7820 3d20 320a 2020 2020 2020 2020  fix = 2.        
+00008fa0: 7768 696c 6520 6f72 6465 7269 6e67 5f63  while ordering_c
+00008fb0: 6f6c 2069 6e20 636f 6c75 6d6e 733a 0a20  ol in columns:. 
+00008fc0: 2020 2020 2020 2020 2020 206f 7264 6572             order
+00008fd0: 696e 675f 636f 6c20 3d20 6622 726f 7769  ing_col = f"rowi
+00008fe0: 645f 7b73 7566 6669 787d 220a 2020 2020  d_{suffix}".    
+00008ff0: 2020 2020 2020 2020 7375 6666 6978 202b          suffix +
+00009000: 3d20 310a 0a20 2020 2020 2020 2070 616e  = 1..        pan
+00009010: 6461 735f 6461 7461 6672 616d 655f 636f  das_dataframe_co
+00009020: 7079 203d 2070 616e 6461 735f 6461 7461  py = pandas_data
+00009030: 6672 616d 652e 636f 7079 2829 0a20 2020  frame.copy().   
+00009040: 2020 2020 2070 616e 6461 735f 6461 7461       pandas_data
+00009050: 6672 616d 655f 636f 7079 2e69 6e64 6578  frame_copy.index
+00009060: 2e6e 616d 6573 203d 206e 6577 5f69 6478  .names = new_idx
+00009070: 5f69 6473 0a20 2020 2020 2020 2070 616e  _ids.        pan
+00009080: 6461 735f 6461 7461 6672 616d 655f 636f  das_dataframe_co
+00009090: 7079 2e63 6f6c 756d 6e73 203d 2070 616e  py.columns = pan
+000090a0: 6461 732e 496e 6465 7828 6e65 775f 636f  das.Index(new_co
+000090b0: 6c5f 6964 7329 0a20 2020 2020 2020 2070  l_ids).        p
+000090c0: 616e 6461 735f 6461 7461 6672 616d 655f  andas_dataframe_
+000090d0: 636f 7079 5b6f 7264 6572 696e 675f 636f  copy[ordering_co
+000090e0: 6c5d 203d 206e 702e 6172 616e 6765 2870  l] = np.arange(p
+000090f0: 616e 6461 735f 6461 7461 6672 616d 655f  andas_dataframe_
+00009100: 636f 7079 2e73 6861 7065 5b30 5d29 0a0a  copy.shape[0])..
+00009110: 2020 2020 2020 2020 6a6f 625f 636f 6e66          job_conf
+00009120: 6967 203d 2073 656c 662e 5f70 7265 7061  ig = self._prepa
+00009130: 7265 5f6c 6f61 645f 6a6f 625f 636f 6e66  re_load_job_conf
+00009140: 6967 2829 0a0a 2020 2020 2020 2020 2320  ig()..        # 
+00009150: 5370 6563 6966 7920 7468 6520 6461 7465  Specify the date
+00009160: 7469 6d65 2064 7479 7065 732c 2077 6869  time dtypes, whi
+00009170: 6368 2069 7320 6175 746f 2d64 6574 6563  ch is auto-detec
+00009180: 7465 6420 6173 2074 696d 6573 7461 6d70  ted as timestamp
+00009190: 2074 7970 6573 2e0a 2020 2020 2020 2020   types..        
+000091a0: 7363 6865 6d61 3a20 6c69 7374 5b62 6967  schema: list[big
+000091b0: 7175 6572 792e 5363 6865 6d61 4669 656c  query.SchemaFiel
+000091c0: 645d 203d 205b 5d0a 2020 2020 2020 2020  d] = [].        
+000091d0: 666f 7220 636f 6c75 6d6e 2c20 6474 7970  for column, dtyp
+000091e0: 6520 696e 207a 6970 286e 6577 5f63 6f6c  e in zip(new_col
+000091f0: 5f69 6473 2c20 7061 6e64 6173 5f64 6174  _ids, pandas_dat
+00009200: 6166 7261 6d65 2e64 7479 7065 7329 3a0a  aframe.dtypes):.
+00009210: 2020 2020 2020 2020 2020 2020 6966 2064              if d
+00009220: 7479 7065 203d 3d20 2274 696d 6573 7461  type == "timesta
+00009230: 6d70 5b75 735d 5b70 7961 7272 6f77 5d22  mp[us][pyarrow]"
+00009240: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00009250: 2020 7363 6865 6d61 2e61 7070 656e 6428    schema.append(
+00009260: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009270: 2020 2020 2062 6967 7175 6572 792e 5363       bigquery.Sc
+00009280: 6865 6d61 4669 656c 6428 636f 6c75 6d6e  hemaField(column
+00009290: 2c20 6269 6771 7565 7279 2e65 6e75 6d73  , bigquery.enums
+000092a0: 2e53 716c 5479 7065 4e61 6d65 732e 4441  .SqlTypeNames.DA
+000092b0: 5445 5449 4d45 290a 2020 2020 2020 2020  TETIME).        
+000092c0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000092d0: 2020 6a6f 625f 636f 6e66 6967 2e73 6368    job_config.sch
+000092e0: 656d 6120 3d20 7363 6865 6d61 0a0a 2020  ema = schema..  
+000092f0: 2020 2020 2020 2320 436c 7573 7465 7269        # Clusteri
+00009300: 6e67 2070 726f 6261 626c 7920 6e6f 7420  ng probably not 
+00009310: 6e65 6564 6564 2061 6e79 7761 7973 2061  needed anyways a
+00009320: 7320 7061 6e64 6173 2074 6162 6c65 7320  s pandas tables 
+00009330: 6172 6520 736d 616c 6c0a 2020 2020 2020  are small.      
+00009340: 2020 636c 7573 7465 725f 636f 6c73 203d    cluster_cols =
+00009350: 205b 6f72 6465 7269 6e67 5f63 6f6c 5d0a   [ordering_col].
+00009360: 2020 2020 2020 2020 6a6f 625f 636f 6e66          job_conf
+00009370: 6967 2e63 6c75 7374 6572 696e 675f 6669  ig.clustering_fi
+00009380: 656c 6473 203d 2063 6c75 7374 6572 5f63  elds = cluster_c
+00009390: 6f6c 730a 0a20 2020 2020 2020 206a 6f62  ols..        job
+000093a0: 5f63 6f6e 6669 672e 6c61 6265 6c73 203d  _config.labels =
+000093b0: 207b 2262 6967 6672 616d 6573 2d61 7069   {"bigframes-api
+000093c0: 223a 2061 7069 5f6e 616d 657d 0a0a 2020  ": api_name}..  
+000093d0: 2020 2020 2020 6c6f 6164 5f74 6162 6c65        load_table
+000093e0: 5f64 6573 7469 6e61 7469 6f6e 203d 2073  _destination = s
+000093f0: 656c 662e 5f72 616e 646f 6d5f 7461 626c  elf._random_tabl
+00009400: 6528 290a 2020 2020 2020 2020 6c6f 6164  e().        load
+00009410: 5f6a 6f62 203d 2073 656c 662e 6271 636c  _job = self.bqcl
+00009420: 6965 6e74 2e6c 6f61 645f 7461 626c 655f  ient.load_table_
+00009430: 6672 6f6d 5f64 6174 6166 7261 6d65 280a  from_dataframe(.
+00009440: 2020 2020 2020 2020 2020 2020 7061 6e64              pand
+00009450: 6173 5f64 6174 6166 7261 6d65 5f63 6f70  as_dataframe_cop
+00009460: 792c 0a20 2020 2020 2020 2020 2020 206c  y,.            l
+00009470: 6f61 645f 7461 626c 655f 6465 7374 696e  oad_table_destin
+00009480: 6174 696f 6e2c 0a20 2020 2020 2020 2020  ation,.         
+00009490: 2020 206a 6f62 5f63 6f6e 6669 673d 6a6f     job_config=jo
+000094a0: 625f 636f 6e66 6967 2c0a 2020 2020 2020  b_config,.      
+000094b0: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
+000094c0: 2e5f 7374 6172 745f 6765 6e65 7269 635f  ._start_generic_
+000094d0: 6a6f 6228 6c6f 6164 5f6a 6f62 290a 0a20  job(load_job).. 
+000094e0: 2020 2020 2020 206f 7264 6572 696e 6720         ordering 
+000094f0: 3d20 6f72 6465 722e 4578 7072 6573 7369  = order.Expressi
+00009500: 6f6e 4f72 6465 7269 6e67 280a 2020 2020  onOrdering(.    
+00009510: 2020 2020 2020 2020 6f72 6465 7269 6e67          ordering
+00009520: 5f76 616c 7565 5f63 6f6c 756d 6e73 3d74  _value_columns=t
+00009530: 7570 6c65 285b 6f72 6465 722e 6173 6365  uple([order.asce
+00009540: 6e64 696e 675f 6f76 6572 286f 7264 6572  nding_over(order
+00009550: 696e 675f 636f 6c29 5d29 2c0a 2020 2020  ing_col)]),.    
+00009560: 2020 2020 2020 2020 746f 7461 6c5f 6f72          total_or
+00009570: 6465 7269 6e67 5f63 6f6c 756d 6e73 3d66  dering_columns=f
+00009580: 726f 7a65 6e73 6574 285b 6f72 6465 7269  rozenset([orderi
+00009590: 6e67 5f63 6f6c 5d29 2c0a 2020 2020 2020  ng_col]),.      
+000095a0: 2020 2020 2020 696e 7465 6765 725f 656e        integer_en
+000095b0: 636f 6469 6e67 3d49 6e74 6567 6572 456e  coding=IntegerEn
+000095c0: 636f 6469 6e67 2854 7275 652c 2069 735f  coding(True, is_
+000095d0: 7365 7175 656e 7469 616c 3d54 7275 6529  sequential=True)
+000095e0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+000095f0: 2020 2020 7461 626c 655f 6578 7072 6573      table_expres
+00009600: 7369 6f6e 203d 2073 656c 662e 6962 6973  sion = self.ibis
+00009610: 5f63 6c69 656e 742e 7461 626c 6528 2020  _client.table(  
+00009620: 2320 7479 7065 3a20 6967 6e6f 7265 0a20  # type: ignore. 
+00009630: 2020 2020 2020 2020 2020 206c 6f61 645f             load_
+00009640: 7461 626c 655f 6465 7374 696e 6174 696f  table_destinatio
+00009650: 6e2e 7461 626c 655f 6964 2c0a 2020 2020  n.table_id,.    
+00009660: 2020 2020 2020 2020 7363 6865 6d61 3d6c          schema=l
+00009670: 6f61 645f 7461 626c 655f 6465 7374 696e  oad_table_destin
+00009680: 6174 696f 6e2e 6461 7461 7365 745f 6964  ation.dataset_id
+00009690: 2c0a 2020 2020 2020 2020 2020 2020 6461  ,.            da
+000096a0: 7461 6261 7365 3d6c 6f61 645f 7461 626c  tabase=load_tabl
+000096b0: 655f 6465 7374 696e 6174 696f 6e2e 7072  e_destination.pr
+000096c0: 6f6a 6563 742c 0a20 2020 2020 2020 2029  oject,.        )
+000096d0: 0a0a 2020 2020 2020 2020 2320 622f 3239  ..        # b/29
+000096e0: 3735 3930 3137 3820 506f 7465 6e74 6961  7590178 Potentia
+000096f0: 6c6c 7920 6120 6275 6720 696e 2062 7163  lly a bug in bqc
+00009700: 6c69 656e 742e 6c6f 6164 5f74 6162 6c65  lient.load_table
+00009710: 5f66 726f 6d5f 6461 7461 6672 616d 6528  _from_dataframe(
+00009720: 292c 2074 6861 7420 6f6e 6c79 2077 6865  ), that only whe
+00009730: 6e20 7468 6520 4446 2069 7320 656d 7074  n the DF is empt
+00009740: 792c 2074 6865 2069 6e64 6578 2063 6f6c  y, the index col
+00009750: 756d 6e73 2064 6973 6170 7065 6172 2069  umns disappear i
+00009760: 6e20 7461 626c 655f 6578 7072 6573 7369  n table_expressi
+00009770: 6f6e 2e0a 2020 2020 2020 2020 6966 2061  on..        if a
+00009780: 6e79 280a 2020 2020 2020 2020 2020 2020  ny(.            
+00009790: 5b6e 6577 5f69 6478 5f69 6420 6e6f 7420  [new_idx_id not 
+000097a0: 696e 2074 6162 6c65 5f65 7870 7265 7373  in table_express
+000097b0: 696f 6e2e 636f 6c75 6d6e 7320 666f 7220  ion.columns for 
+000097c0: 6e65 775f 6964 785f 6964 2069 6e20 6e65  new_idx_id in ne
+000097d0: 775f 6964 785f 6964 735d 0a20 2020 2020  w_idx_ids].     
+000097e0: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
+000097f0: 2020 6e65 775f 6964 785f 6964 732c 2069    new_idx_ids, i
+00009800: 6478 5f6c 6162 656c 7320 3d20 5b5d 2c20  dx_labels = [], 
+00009810: 5b5d 0a0a 2020 2020 2020 2020 636f 6c75  []..        colu
+00009820: 6d6e 5f76 616c 7565 7320 3d20 5b0a 2020  mn_values = [.  
+00009830: 2020 2020 2020 2020 2020 7461 626c 655f            table_
+00009840: 6578 7072 6573 7369 6f6e 5b63 6f6c 5d0a  expression[col].
+00009850: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00009860: 636f 6c20 696e 2074 6162 6c65 5f65 7870  col in table_exp
+00009870: 7265 7373 696f 6e2e 636f 6c75 6d6e 730a  ression.columns.
+00009880: 2020 2020 2020 2020 2020 2020 6966 2063              if c
+00009890: 6f6c 2021 3d20 6f72 6465 7269 6e67 5f63  ol != ordering_c
+000098a0: 6f6c 0a20 2020 2020 2020 205d 0a20 2020  ol.        ].   
+000098b0: 2020 2020 2061 7272 6179 5f76 616c 7565       array_value
+000098c0: 203d 2063 6f72 652e 4172 7261 7956 616c   = core.ArrayVal
+000098d0: 7565 2e66 726f 6d5f 6962 6973 280a 2020  ue.from_ibis(.  
+000098e0: 2020 2020 2020 2020 2020 7365 6c66 2c0a            self,.
+000098f0: 2020 2020 2020 2020 2020 2020 7461 626c              tabl
+00009900: 655f 6578 7072 6573 7369 6f6e 2c0a 2020  e_expression,.  
+00009910: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
+00009920: 733d 636f 6c75 6d6e 5f76 616c 7565 732c  s=column_values,
+00009930: 0a20 2020 2020 2020 2020 2020 2068 6964  .            hid
+00009940: 6465 6e5f 6f72 6465 7269 6e67 5f63 6f6c  den_ordering_col
+00009950: 756d 6e73 3d5b 7461 626c 655f 6578 7072  umns=[table_expr
+00009960: 6573 7369 6f6e 5b6f 7264 6572 696e 675f  ession[ordering_
+00009970: 636f 6c5d 5d2c 0a20 2020 2020 2020 2020  col]],.         
+00009980: 2020 206f 7264 6572 696e 673d 6f72 6465     ordering=orde
+00009990: 7269 6e67 2c0a 2020 2020 2020 2020 290a  ring,.        ).
+000099a0: 0a20 2020 2020 2020 2062 6c6f 636b 203d  .        block =
+000099b0: 2062 6c6f 636b 732e 426c 6f63 6b28 0a20   blocks.Block(. 
+000099c0: 2020 2020 2020 2020 2020 2061 7272 6179             array
+000099d0: 5f76 616c 7565 2c0a 2020 2020 2020 2020  _value,.        
+000099e0: 2020 2020 696e 6465 785f 636f 6c75 6d6e      index_column
+000099f0: 733d 6e65 775f 6964 785f 6964 732c 0a20  s=new_idx_ids,. 
+00009a00: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
+00009a10: 6e5f 6c61 6265 6c73 3d63 6f6c 5f69 6e64  n_labels=col_ind
+00009a20: 6578 2c0a 2020 2020 2020 2020 2020 2020  ex,.            
+00009a30: 696e 6465 785f 6c61 6265 6c73 3d69 6478  index_labels=idx
+00009a40: 5f6c 6162 656c 732c 0a20 2020 2020 2020  _labels,.       
+00009a50: 2029 0a20 2020 2020 2020 2072 6574 7572   ).        retur
+00009a60: 6e20 6461 7461 6672 616d 652e 4461 7461  n dataframe.Data
+00009a70: 4672 616d 6528 626c 6f63 6b29 0a0a 2020  Frame(block)..  
+00009a80: 2020 6465 6620 7265 6164 5f63 7376 280a    def read_csv(.
+00009a90: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+00009aa0: 2020 2020 2020 6669 6c65 7061 7468 5f6f        filepath_o
+00009ab0: 725f 6275 6666 6572 3a20 7374 7220 7c20  r_buffer: str | 
+00009ac0: 494f 5b22 6279 7465 7322 5d2c 0a20 2020  IO["bytes"],.   
+00009ad0: 2020 2020 202a 2c0a 2020 2020 2020 2020       *,.        
+00009ae0: 7365 703a 204f 7074 696f 6e61 6c5b 7374  sep: Optional[st
+00009af0: 725d 203d 2022 2c22 2c0a 2020 2020 2020  r] = ",",.      
+00009b00: 2020 6865 6164 6572 3a20 4f70 7469 6f6e    header: Option
+00009b10: 616c 5b69 6e74 5d20 3d20 302c 0a20 2020  al[int] = 0,.   
+00009b20: 2020 2020 206e 616d 6573 3a20 4f70 7469       names: Opti
+00009b30: 6f6e 616c 5b0a 2020 2020 2020 2020 2020  onal[.          
+00009b40: 2020 556e 696f 6e5b 4d75 7461 626c 6553    Union[MutableS
+00009b50: 6571 7565 6e63 655b 416e 795d 2c20 6e70  equence[Any], np
+00009b60: 2e6e 6461 7272 6179 5b41 6e79 2c20 416e  .ndarray[Any, An
+00009b70: 795d 2c20 5475 706c 655b 416e 792c 202e  y], Tuple[Any, .
+00009b80: 2e2e 5d2c 2072 616e 6765 5d0a 2020 2020  ..], range].    
+00009b90: 2020 2020 5d20 3d20 4e6f 6e65 2c0a 2020      ] = None,.  
+00009ba0: 2020 2020 2020 696e 6465 785f 636f 6c3a        index_col:
+00009bb0: 204f 7074 696f 6e61 6c5b 0a20 2020 2020   Optional[.     
+00009bc0: 2020 2020 2020 2055 6e69 6f6e 5b0a 2020         Union[.  
+00009bd0: 2020 2020 2020 2020 2020 2020 2020 696e                in
+00009be0: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
+00009bf0: 2020 2073 7472 2c0a 2020 2020 2020 2020     str,.        
+00009c00: 2020 2020 2020 2020 5365 7175 656e 6365          Sequence
+00009c10: 5b55 6e69 6f6e 5b73 7472 2c20 696e 745d  [Union[str, int]
+00009c20: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+00009c30: 2020 2062 6967 6672 616d 6573 2e65 6e75     bigframes.enu
+00009c40: 6d73 2e44 6566 6175 6c74 496e 6465 784b  ms.DefaultIndexK
+00009c50: 696e 642c 0a20 2020 2020 2020 2020 2020  ind,.           
+00009c60: 2020 2020 204c 6974 6572 616c 5b46 616c       Literal[Fal
+00009c70: 7365 5d2c 0a20 2020 2020 2020 2020 2020  se],.           
+00009c80: 205d 0a20 2020 2020 2020 205d 203d 204e   ].        ] = N
+00009c90: 6f6e 652c 0a20 2020 2020 2020 2075 7365  one,.        use
+00009ca0: 636f 6c73 3a20 4f70 7469 6f6e 616c 5b0a  cols: Optional[.
+00009cb0: 2020 2020 2020 2020 2020 2020 556e 696f              Unio
+00009cc0: 6e5b 0a20 2020 2020 2020 2020 2020 2020  n[.             
+00009cd0: 2020 204d 7574 6162 6c65 5365 7175 656e     MutableSequen
+00009ce0: 6365 5b73 7472 5d2c 0a20 2020 2020 2020  ce[str],.       
+00009cf0: 2020 2020 2020 2020 2054 7570 6c65 5b73           Tuple[s
+00009d00: 7472 2c20 2e2e 2e5d 2c0a 2020 2020 2020  tr, ...],.      
+00009d10: 2020 2020 2020 2020 2020 5365 7175 656e            Sequen
+00009d20: 6365 5b69 6e74 5d2c 0a20 2020 2020 2020  ce[int],.       
+00009d30: 2020 2020 2020 2020 2070 616e 6461 732e           pandas.
+00009d40: 5365 7269 6573 2c0a 2020 2020 2020 2020  Series,.        
+00009d50: 2020 2020 2020 2020 7061 6e64 6173 2e49          pandas.I
+00009d60: 6e64 6578 2c0a 2020 2020 2020 2020 2020  ndex,.          
+00009d70: 2020 2020 2020 6e70 2e6e 6461 7272 6179        np.ndarray
+00009d80: 5b41 6e79 2c20 416e 795d 2c0a 2020 2020  [Any, Any],.    
+00009d90: 2020 2020 2020 2020 2020 2020 4361 6c6c              Call
+00009da0: 6162 6c65 5b5b 416e 795d 2c20 626f 6f6c  able[[Any], bool
+00009db0: 5d2c 0a20 2020 2020 2020 2020 2020 205d  ],.            ]
+00009dc0: 0a20 2020 2020 2020 205d 203d 204e 6f6e  .        ] = Non
+00009dd0: 652c 0a20 2020 2020 2020 2064 7479 7065  e,.        dtype
+00009de0: 3a20 4f70 7469 6f6e 616c 5b44 6963 745d  : Optional[Dict]
+00009df0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+00009e00: 2065 6e67 696e 653a 204f 7074 696f 6e61   engine: Optiona
+00009e10: 6c5b 0a20 2020 2020 2020 2020 2020 204c  l[.            L
+00009e20: 6974 6572 616c 5b22 6322 2c20 2270 7974  iteral["c", "pyt
+00009e30: 686f 6e22 2c20 2270 7961 7272 6f77 222c  hon", "pyarrow",
+00009e40: 2022 7079 7468 6f6e 2d66 7766 222c 2022   "python-fwf", "
+00009e50: 6269 6771 7565 7279 225d 0a20 2020 2020  bigquery"].     
+00009e60: 2020 205d 203d 204e 6f6e 652c 0a20 2020     ] = None,.   
+00009e70: 2020 2020 2065 6e63 6f64 696e 673a 204f       encoding: O
+00009e80: 7074 696f 6e61 6c5b 7374 725d 203d 204e  ptional[str] = N
+00009e90: 6f6e 652c 0a20 2020 2020 2020 202a 2a6b  one,.        **k
+00009ea0: 7761 7267 732c 0a20 2020 2029 202d 3e20  wargs,.    ) -> 
+00009eb0: 6461 7461 6672 616d 652e 4461 7461 4672  dataframe.DataFr
+00009ec0: 616d 653a 0a20 2020 2020 2020 2074 6162  ame:.        tab
+00009ed0: 6c65 203d 2073 656c 662e 5f72 616e 646f  le = self._rando
+00009ee0: 6d5f 7461 626c 6528 290a 0a20 2020 2020  m_table()..     
+00009ef0: 2020 2069 6620 656e 6769 6e65 2069 7320     if engine is 
+00009f00: 6e6f 7420 4e6f 6e65 2061 6e64 2065 6e67  not None and eng
+00009f10: 696e 6520 3d3d 2022 6269 6771 7565 7279  ine == "bigquery
+00009f20: 223a 0a20 2020 2020 2020 2020 2020 2069  ":.            i
+00009f30: 6620 616e 7928 7061 7261 6d20 6973 206e  f any(param is n
+00009f40: 6f74 204e 6f6e 6520 666f 7220 7061 7261  ot None for para
+00009f50: 6d20 696e 2028 6474 7970 652c 206e 616d  m in (dtype, nam
+00009f60: 6573 2929 3a0a 2020 2020 2020 2020 2020  es)):.          
+00009f70: 2020 2020 2020 6e6f 745f 7375 7070 6f72        not_suppor
+00009f80: 7465 6420 3d20 2822 6474 7970 6522 2c20  ted = ("dtype", 
+00009f90: 226e 616d 6573 2229 0a20 2020 2020 2020  "names").       
+00009fa0: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
+00009fb0: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
+00009fc0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+00009fd0: 2020 2020 2020 2020 6622 4269 6751 7565          f"BigQue
+00009fe0: 7279 2065 6e67 696e 6520 646f 6573 206e  ry engine does n
+00009ff0: 6f74 2073 7570 706f 7274 2074 6865 7365  ot support these
+0000a000: 2061 7267 756d 656e 7473 3a20 7b6e 6f74   arguments: {not
+0000a010: 5f73 7570 706f 7274 6564 7d2e 2022 0a20  _supported}. ". 
+0000a020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a030: 2020 2066 227b 636f 6e73 7461 6e74 732e     f"{constants.
+0000a040: 4645 4544 4241 434b 5f4c 494e 4b7d 220a  FEEDBACK_LINK}".
+0000a050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a060: 290a 0a20 2020 2020 2020 2020 2020 2023  )..            #
+0000a070: 2054 4f44 4f28 622f 3333 3830 3839 3635   TODO(b/33808965
+0000a080: 3929 3a20 4c6f 6f6b 7320 6c69 6b65 2077  9): Looks like w
+0000a090: 6520 6361 6e20 7265 6c61 7820 7468 6973  e can relax this
+0000a0a0: 2031 2063 6f6c 756d 6e0a 2020 2020 2020   1 column.      
+0000a0b0: 2020 2020 2020 2320 7265 7374 7269 6374        # restrict
+0000a0c0: 696f 6e20 6966 2077 6520 6368 6563 6b20  ion if we check 
+0000a0d0: 7468 6520 636f 6e74 656e 7473 206f 6620  the contents of 
+0000a0e0: 616e 2069 7465 7261 626c 6520 6172 6520  an iterable are 
+0000a0f0: 7374 7269 6e67 730a 2020 2020 2020 2020  strings.        
+0000a100: 2020 2020 2320 6e6f 7420 696e 7465 6765      # not intege
+0000a110: 7273 2e0a 2020 2020 2020 2020 2020 2020  rs..            
+0000a120: 6966 2028 0a20 2020 2020 2020 2020 2020  if (.           
+0000a130: 2020 2020 2023 2045 6d70 7479 2074 7570       # Empty tup
+0000a140: 6c65 732c 204e 6f6e 652c 2061 6e64 2046  les, None, and F
+0000a150: 616c 7365 2061 7265 2061 6c6c 6f77 6564  alse are allowed
+0000a160: 2061 6e64 2066 616c 7365 792e 0a20 2020   and falsey..   
+0000a170: 2020 2020 2020 2020 2020 2020 2069 6e64               ind
+0000a180: 6578 5f63 6f6c 0a20 2020 2020 2020 2020  ex_col.         
+0000a190: 2020 2020 2020 2061 6e64 206e 6f74 2069         and not i
+0000a1a0: 7369 6e73 7461 6e63 6528 696e 6465 785f  sinstance(index_
+0000a1b0: 636f 6c2c 2062 6967 6672 616d 6573 2e65  col, bigframes.e
+0000a1c0: 6e75 6d73 2e44 6566 6175 6c74 496e 6465  nums.DefaultInde
+0000a1d0: 784b 696e 6429 0a20 2020 2020 2020 2020  xKind).         
+0000a1e0: 2020 2020 2020 2061 6e64 206e 6f74 2069         and not i
+0000a1f0: 7369 6e73 7461 6e63 6528 696e 6465 785f  sinstance(index_
+0000a200: 636f 6c2c 2073 7472 290a 2020 2020 2020  col, str).      
+0000a210: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
+0000a220: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
+0000a230: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
+0000a240: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+0000a250: 2020 2020 2020 2020 2242 6967 5175 6572          "BigQuer
+0000a260: 7920 656e 6769 6e65 206f 6e6c 7920 7375  y engine only su
+0000a270: 7070 6f72 7473 2061 2073 696e 676c 6520  pports a single 
+0000a280: 636f 6c75 6d6e 206e 616d 6520 666f 7220  column name for 
+0000a290: 6069 6e64 6578 5f63 6f6c 602c 2022 0a20  `index_col`, ". 
+0000a2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a2b0: 2020 2066 2267 6f74 3a20 7b72 6570 7228     f"got: {repr(
+0000a2c0: 696e 6465 785f 636f 6c29 7d2e 207b 636f  index_col)}. {co
+0000a2d0: 6e73 7461 6e74 732e 4645 4544 4241 434b  nstants.FEEDBACK
+0000a2e0: 5f4c 494e 4b7d 220a 2020 2020 2020 2020  _LINK}".        
+0000a2f0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+0000a300: 2020 2020 2020 2023 204e 6f6e 6520 616e         # None an
+0000a310: 6420 4661 6c73 6520 6361 6e6e 6f74 2062  d False cannot b
+0000a320: 6520 7061 7373 6564 2074 6f20 7265 6164  e passed to read
+0000a330: 5f67 6271 2e0a 2020 2020 2020 2020 2020  _gbq..          
+0000a340: 2020 2320 544f 444f 2862 2f33 3338 3430    # TODO(b/33840
+0000a350: 3031 3333 293a 2057 6865 6e20 696e 6465  0133): When inde
+0000a360: 785f 636f 6c20 6973 204e 6f6e 652c 2077  x_col is None, w
+0000a370: 6520 7368 6f75 6c64 2062 6520 7573 696e  e should be usin
+0000a380: 6720 7468 650a 2020 2020 2020 2020 2020  g the.          
+0000a390: 2020 2320 6669 7273 7420 636f 6c75 6d6e    # first column
+0000a3a0: 206f 6620 7468 6520 4353 5620 6173 2074   of the CSV as t
+0000a3b0: 6865 2069 6e64 6578 2074 6f20 6265 2063  he index to be c
+0000a3c0: 6f6d 7061 7469 626c 6520 7769 7468 2074  ompatible with t
+0000a3d0: 6865 0a20 2020 2020 2020 2020 2020 2023  he.            #
+0000a3e0: 2070 616e 6461 7320 656e 6769 6e65 2e20   pandas engine. 
+0000a3f0: 4163 636f 7264 696e 6720 746f 2074 6865  According to the
+0000a400: 2070 616e 6461 7320 646f 6373 2c20 6f6e   pandas docs, on
+0000a410: 6c79 2022 4661 6c73 6522 0a20 2020 2020  ly "False".     
+0000a420: 2020 2020 2020 2023 2069 6e64 6963 6174         # indicat
+0000a430: 6573 2061 2064 6566 6175 6c74 2073 6571  es a default seq
+0000a440: 7565 6e74 6961 6c20 696e 6465 782e 0a20  uential index.. 
+0000a450: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+0000a460: 7420 696e 6465 785f 636f 6c3a 0a20 2020  t index_col:.   
+0000a470: 2020 2020 2020 2020 2020 2020 2069 6e64               ind
+0000a480: 6578 5f63 6f6c 203d 2028 290a 0a20 2020  ex_col = ()..   
+0000a490: 2020 2020 2020 2020 2069 6e64 6578 5f63           index_c
+0000a4a0: 6f6c 203d 2074 7970 696e 672e 6361 7374  ol = typing.cast
+0000a4b0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0000a4c0: 2020 556e 696f 6e5b 0a20 2020 2020 2020    Union[.       
+0000a4d0: 2020 2020 2020 2020 2020 2020 2053 6571               Seq
+0000a4e0: 7565 6e63 655b 7374 725d 2c20 2023 2046  uence[str],  # F
+0000a4f0: 616c 7365 7920 7661 6c75 6573 0a20 2020  alsey values.   
+0000a500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a510: 2062 6967 6672 616d 6573 2e65 6e75 6d73   bigframes.enums
+0000a520: 2e44 6566 6175 6c74 496e 6465 784b 696e  .DefaultIndexKin
+0000a530: 642c 0a20 2020 2020 2020 2020 2020 2020  d,.             
+0000a540: 2020 2020 2020 2073 7472 2c0a 2020 2020         str,.    
+0000a550: 2020 2020 2020 2020 2020 2020 5d2c 0a20              ],. 
+0000a560: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0000a570: 6e64 6578 5f63 6f6c 2c0a 2020 2020 2020  ndex_col,.      
+0000a580: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+0000a590: 2020 2020 2023 2075 7365 636f 6c73 2073       # usecols s
+0000a5a0: 686f 756c 6420 6f6e 6c79 2062 6520 616e  hould only be an
+0000a5b0: 2069 7465 7261 626c 6520 6f66 2073 7472   iterable of str
+0000a5c0: 696e 6773 2028 636f 6c75 6d6e 206e 616d  ings (column nam
+0000a5d0: 6573 2920 666f 7220 7573 6520 6173 2063  es) for use as c
+0000a5e0: 6f6c 756d 6e73 2069 6e20 7265 6164 5f67  olumns in read_g
+0000a5f0: 6271 2e0a 2020 2020 2020 2020 2020 2020  bq..            
+0000a600: 636f 6c75 6d6e 733a 2054 7570 6c65 5b41  columns: Tuple[A
+0000a610: 6e79 2c20 2e2e 2e5d 203d 2074 7570 6c65  ny, ...] = tuple
+0000a620: 2829 0a20 2020 2020 2020 2020 2020 2069  ().            i
+0000a630: 6620 7573 6563 6f6c 7320 6973 206e 6f74  f usecols is not
+0000a640: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+0000a650: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+0000a660: 616e 6365 2875 7365 636f 6c73 2c20 4974  ance(usecols, It
+0000a670: 6572 6162 6c65 2920 616e 6420 616c 6c28  erable) and all(
+0000a680: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a690: 2020 2020 2069 7369 6e73 7461 6e63 6528       isinstance(
+0000a6a0: 636f 6c2c 2073 7472 2920 666f 7220 636f  col, str) for co
+0000a6b0: 6c20 696e 2075 7365 636f 6c73 0a20 2020  l in usecols.   
+0000a6c0: 2020 2020 2020 2020 2020 2020 2029 3a0a               ):.
+0000a6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a6e0: 2020 2020 636f 6c75 6d6e 7320 3d20 7475      columns = tu
+0000a6f0: 706c 6528 636f 6c20 666f 7220 636f 6c20  ple(col for col 
+0000a700: 696e 2075 7365 636f 6c73 290a 2020 2020  in usecols).    
+0000a710: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0000a720: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000a730: 2020 2020 2020 7261 6973 6520 4e6f 7449        raise NotI
+0000a740: 6d70 6c65 6d65 6e74 6564 4572 726f 7228  mplementedError(
+0000a750: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a760: 2020 2020 2020 2020 2022 4269 6751 7565           "BigQue
+0000a770: 7279 2065 6e67 696e 6520 6f6e 6c79 2073  ry engine only s
+0000a780: 7570 706f 7274 7320 616e 2069 7465 7261  upports an itera
+0000a790: 626c 6520 6f66 2073 7472 696e 6773 2066  ble of strings f
+0000a7a0: 6f72 2060 7573 6563 6f6c 7360 2e20 220a  or `usecols`. ".
+0000a7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a7c0: 2020 2020 2020 2020 6622 7b63 6f6e 7374          f"{const
+0000a7d0: 616e 7473 2e46 4545 4442 4143 4b5f 4c49  ants.FEEDBACK_LI
+0000a7e0: 4e4b 7d22 0a20 2020 2020 2020 2020 2020  NK}".           
+0000a7f0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+0000a800: 2020 2020 2020 2020 6966 2065 6e63 6f64          if encod
+0000a810: 696e 6720 6973 206e 6f74 204e 6f6e 6520  ing is not None 
+0000a820: 616e 6420 656e 636f 6469 6e67 206e 6f74  and encoding not
+0000a830: 2069 6e20 5f56 414c 4944 5f45 4e43 4f44   in _VALID_ENCOD
+0000a840: 494e 4753 3a0a 2020 2020 2020 2020 2020  INGS:.          
+0000a850: 2020 2020 2020 7261 6973 6520 4e6f 7449        raise NotI
+0000a860: 6d70 6c65 6d65 6e74 6564 4572 726f 7228  mplementedError(
+0000a870: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a880: 2020 2020 2066 2242 6967 5175 6572 7920       f"BigQuery 
+0000a890: 656e 6769 6e65 206f 6e6c 7920 7375 7070  engine only supp
+0000a8a0: 6f72 7473 2074 6865 2066 6f6c 6c6f 7769  orts the followi
+0000a8b0: 6e67 2065 6e63 6f64 696e 6773 3a20 7b5f  ng encodings: {_
+0000a8c0: 5641 4c49 445f 454e 434f 4449 4e47 537d  VALID_ENCODINGS}
+0000a8d0: 2e20 220a 2020 2020 2020 2020 2020 2020  . ".            
+0000a8e0: 2020 2020 2020 2020 6622 7b63 6f6e 7374          f"{const
+0000a8f0: 616e 7473 2e46 4545 4442 4143 4b5f 4c49  ants.FEEDBACK_LI
+0000a900: 4e4b 7d22 0a20 2020 2020 2020 2020 2020  NK}".           
+0000a910: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0000a920: 2020 2020 6a6f 625f 636f 6e66 6967 203d      job_config =
+0000a930: 2073 656c 662e 5f70 7265 7061 7265 5f6c   self._prepare_l
+0000a940: 6f61 645f 6a6f 625f 636f 6e66 6967 2829  oad_job_config()
+0000a950: 0a20 2020 2020 2020 2020 2020 206a 6f62  .            job
+0000a960: 5f63 6f6e 6669 672e 6372 6561 7465 5f64  _config.create_d
+0000a970: 6973 706f 7369 7469 6f6e 203d 2062 6967  isposition = big
+0000a980: 7175 6572 792e 4372 6561 7465 4469 7370  query.CreateDisp
+0000a990: 6f73 6974 696f 6e2e 4352 4541 5445 5f49  osition.CREATE_I
+0000a9a0: 465f 4e45 4544 4544 0a20 2020 2020 2020  F_NEEDED.       
+0000a9b0: 2020 2020 206a 6f62 5f63 6f6e 6669 672e       job_config.
+0000a9c0: 736f 7572 6365 5f66 6f72 6d61 7420 3d20  source_format = 
+0000a9d0: 6269 6771 7565 7279 2e53 6f75 7263 6546  bigquery.SourceF
+0000a9e0: 6f72 6d61 742e 4353 560a 2020 2020 2020  ormat.CSV.      
+0000a9f0: 2020 2020 2020 6a6f 625f 636f 6e66 6967        job_config
+0000aa00: 2e77 7269 7465 5f64 6973 706f 7369 7469  .write_dispositi
+0000aa10: 6f6e 203d 2062 6967 7175 6572 792e 5772  on = bigquery.Wr
+0000aa20: 6974 6544 6973 706f 7369 7469 6f6e 2e57  iteDisposition.W
+0000aa30: 5249 5445 5f45 4d50 5459 0a20 2020 2020  RITE_EMPTY.     
+0000aa40: 2020 2020 2020 206a 6f62 5f63 6f6e 6669         job_confi
+0000aa50: 672e 6175 746f 6465 7465 6374 203d 2054  g.autodetect = T
+0000aa60: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
+0000aa70: 6a6f 625f 636f 6e66 6967 2e66 6965 6c64  job_config.field
+0000aa80: 5f64 656c 696d 6974 6572 203d 2073 6570  _delimiter = sep
+0000aa90: 0a20 2020 2020 2020 2020 2020 206a 6f62  .            job
+0000aaa0: 5f63 6f6e 6669 672e 656e 636f 6469 6e67  _config.encoding
+0000aab0: 203d 2065 6e63 6f64 696e 670a 2020 2020   = encoding.    
+0000aac0: 2020 2020 2020 2020 6a6f 625f 636f 6e66          job_conf
+0000aad0: 6967 2e6c 6162 656c 7320 3d20 7b22 6269  ig.labels = {"bi
+0000aae0: 6766 7261 6d65 732d 6170 6922 3a20 2272  gframes-api": "r
+0000aaf0: 6561 645f 6373 7622 7d0a 0a20 2020 2020  ead_csv"}..     
+0000ab00: 2020 2020 2020 2023 2057 6520 7761 6e74         # We want
+0000ab10: 2074 6f20 6d61 7463 6820 7061 6e64 6173   to match pandas
+0000ab20: 2062 6568 6176 696f 722e 2049 6620 6865   behavior. If he
+0000ab30: 6164 6572 2069 7320 302c 206e 6f20 726f  ader is 0, no ro
+0000ab40: 7773 2073 686f 756c 6420 6265 2073 6b69  ws should be ski
+0000ab50: 7070 6564 2c20 736f 2077 650a 2020 2020  pped, so we.    
+0000ab60: 2020 2020 2020 2020 2320 646f 206e 6f74          # do not
+0000ab70: 206e 6565 6420 746f 2073 6574 2060 736b   need to set `sk
+0000ab80: 6970 5f6c 6561 6469 6e67 5f72 6f77 7360  ip_leading_rows`
+0000ab90: 2e20 4966 2068 6561 6465 7220 6973 204e  . If header is N
+0000aba0: 6f6e 652c 2074 6865 6e20 7468 6572 6520  one, then there 
+0000abb0: 6973 206e 6f20 6865 6164 6572 2e0a 2020  is no header..  
+0000abc0: 2020 2020 2020 2020 2020 2320 5365 7474            # Sett
+0000abd0: 696e 6720 736b 6970 5f6c 6561 6469 6e67  ing skip_leading
+0000abe0: 5f72 6f77 7320 746f 2030 2064 6f65 7320  _rows to 0 does 
+0000abf0: 7468 6174 2e20 4966 2068 6561 6465 723d  that. If header=
+0000ac00: 4e20 616e 6420 4e3e 302c 2077 6520 7761  N and N>0, we wa
+0000ac10: 6e74 2074 6f20 736b 6970 204e 2072 6f77  nt to skip N row
+0000ac20: 732e 0a20 2020 2020 2020 2020 2020 2069  s..            i
+0000ac30: 6620 6865 6164 6572 2069 7320 4e6f 6e65  f header is None
+0000ac40: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000ac50: 2020 6a6f 625f 636f 6e66 6967 2e73 6b69    job_config.ski
+0000ac60: 705f 6c65 6164 696e 675f 726f 7773 203d  p_leading_rows =
+0000ac70: 2030 0a20 2020 2020 2020 2020 2020 2065   0.            e
+0000ac80: 6c69 6620 6865 6164 6572 203e 2030 3a0a  lif header > 0:.
+0000ac90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000aca0: 6a6f 625f 636f 6e66 6967 2e73 6b69 705f  job_config.skip_
+0000acb0: 6c65 6164 696e 675f 726f 7773 203d 2068  leading_rows = h
+0000acc0: 6561 6465 720a 0a20 2020 2020 2020 2020  eader..         
+0000acd0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+0000ace0: 7265 6164 5f62 6967 7175 6572 795f 6c6f  read_bigquery_lo
+0000acf0: 6164 5f6a 6f62 280a 2020 2020 2020 2020  ad_job(.        
+0000ad00: 2020 2020 2020 2020 6669 6c65 7061 7468          filepath
+0000ad10: 5f6f 725f 6275 6666 6572 2c0a 2020 2020  _or_buffer,.    
+0000ad20: 2020 2020 2020 2020 2020 2020 7461 626c              tabl
+0000ad30: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+0000ad40: 2020 206a 6f62 5f63 6f6e 6669 673d 6a6f     job_config=jo
+0000ad50: 625f 636f 6e66 6967 2c0a 2020 2020 2020  b_config,.      
+0000ad60: 2020 2020 2020 2020 2020 696e 6465 785f            index_
+0000ad70: 636f 6c3d 696e 6465 785f 636f 6c2c 0a20  col=index_col,. 
+0000ad80: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0000ad90: 6f6c 756d 6e73 3d63 6f6c 756d 6e73 2c0a  olumns=columns,.
+0000ada0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0000adb0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0000adc0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+0000add0: 7461 6e63 6528 696e 6465 785f 636f 6c2c  tance(index_col,
+0000ade0: 2062 6967 6672 616d 6573 2e65 6e75 6d73   bigframes.enums
+0000adf0: 2e44 6566 6175 6c74 496e 6465 784b 696e  .DefaultIndexKin
+0000ae00: 6429 3a0a 2020 2020 2020 2020 2020 2020  d):.            
+0000ae10: 2020 2020 7261 6973 6520 4e6f 7449 6d70      raise NotImp
+0000ae20: 6c65 6d65 6e74 6564 4572 726f 7228 0a20  lementedError(. 
+0000ae30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ae40: 2020 2066 2257 6974 6820 696e 6465 785f     f"With index_
+0000ae50: 636f 6c3d 7b72 6570 7228 696e 6465 785f  col={repr(index_
+0000ae60: 636f 6c29 7d2c 206f 6e6c 7920 656e 6769  col)}, only engi
+0000ae70: 6e65 3d27 6269 6771 7565 7279 2720 6973  ne='bigquery' is
+0000ae80: 2073 7570 706f 7274 6564 2e20 220a 2020   supported. ".  
+0000ae90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000aea0: 2020 6622 7b63 6f6e 7374 616e 7473 2e46    f"{constants.F
+0000aeb0: 4545 4442 4143 4b5f 4c49 4e4b 7d22 0a20  EEDBACK_LINK}". 
+0000aec0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0000aed0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0000aee0: 616e 7928 6172 6720 696e 206b 7761 7267  any(arg in kwarg
+0000aef0: 7320 666f 7220 6172 6720 696e 2028 2263  s for arg in ("c
+0000af00: 6875 6e6b 7369 7a65 222c 2022 6974 6572  hunksize", "iter
+0000af10: 6174 6f72 2229 293a 0a20 2020 2020 2020  ator")):.       
+0000af20: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
+0000af30: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
+0000af40: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+0000af50: 2020 2020 2020 2020 2227 6368 756e 6b73          "'chunks
+0000af60: 697a 6527 2061 6e64 2027 6974 6572 6174  ize' and 'iterat
+0000af70: 6f72 2720 6172 6775 6d65 6e74 7320 6172  or' arguments ar
+0000af80: 6520 6e6f 7420 7375 7070 6f72 7465 642e  e not supported.
+0000af90: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
+0000afa0: 2020 2020 2020 2066 227b 636f 6e73 7461         f"{consta
+0000afb0: 6e74 732e 4645 4544 4241 434b 5f4c 494e  nts.FEEDBACK_LIN
+0000afc0: 4b7d 220a 2020 2020 2020 2020 2020 2020  K}".            
+0000afd0: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
+0000afe0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+0000aff0: 2866 696c 6570 6174 685f 6f72 5f62 7566  (filepath_or_buf
+0000b000: 6665 722c 2073 7472 293a 0a20 2020 2020  fer, str):.     
+0000b010: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000b020: 5f63 6865 636b 5f66 696c 655f 7369 7a65  _check_file_size
+0000b030: 2866 696c 6570 6174 685f 6f72 5f62 7566  (filepath_or_buf
+0000b040: 6665 7229 0a20 2020 2020 2020 2020 2020  fer).           
+0000b050: 2070 616e 6461 735f 6466 203d 2070 616e   pandas_df = pan
+0000b060: 6461 732e 7265 6164 5f63 7376 280a 2020  das.read_csv(.  
+0000b070: 2020 2020 2020 2020 2020 2020 2020 6669                fi
+0000b080: 6c65 7061 7468 5f6f 725f 6275 6666 6572  lepath_or_buffer
+0000b090: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000b0a0: 2020 7365 703d 7365 702c 0a20 2020 2020    sep=sep,.     
+0000b0b0: 2020 2020 2020 2020 2020 2068 6561 6465             heade
+0000b0c0: 723d 6865 6164 6572 2c0a 2020 2020 2020  r=header,.      
+0000b0d0: 2020 2020 2020 2020 2020 6e61 6d65 733d            names=
+0000b0e0: 6e61 6d65 732c 0a20 2020 2020 2020 2020  names,.         
+0000b0f0: 2020 2020 2020 2069 6e64 6578 5f63 6f6c         index_col
+0000b100: 3d69 6e64 6578 5f63 6f6c 2c0a 2020 2020  =index_col,.    
+0000b110: 2020 2020 2020 2020 2020 2020 7573 6563              usec
+0000b120: 6f6c 733d 7573 6563 6f6c 732c 2020 2320  ols=usecols,  # 
+0000b130: 7479 7065 3a20 6967 6e6f 7265 0a20 2020  type: ignore.   
+0000b140: 2020 2020 2020 2020 2020 2020 2064 7479               dty
+0000b150: 7065 3d64 7479 7065 2c0a 2020 2020 2020  pe=dtype,.      
+0000b160: 2020 2020 2020 2020 2020 656e 6769 6e65            engine
+0000b170: 3d65 6e67 696e 652c 0a20 2020 2020 2020  =engine,.       
+0000b180: 2020 2020 2020 2020 2065 6e63 6f64 696e           encodin
+0000b190: 673d 656e 636f 6469 6e67 2c0a 2020 2020  g=encoding,.    
+0000b1a0: 2020 2020 2020 2020 2020 2020 2a2a 6b77              **kw
+0000b1b0: 6172 6773 2c0a 2020 2020 2020 2020 2020  args,.          
+0000b1c0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0000b1d0: 7265 7475 726e 2073 656c 662e 5f72 6561  return self._rea
+0000b1e0: 645f 7061 6e64 6173 2870 616e 6461 735f  d_pandas(pandas_
+0000b1f0: 6466 2c20 2272 6561 645f 6373 7622 2920  df, "read_csv") 
+0000b200: 2023 2074 7970 653a 2069 676e 6f72 650a   # type: ignore.
+0000b210: 0a20 2020 2064 6566 2072 6561 645f 7069  .    def read_pi
+0000b220: 636b 6c65 280a 2020 2020 2020 2020 7365  ckle(.        se
+0000b230: 6c66 2c0a 2020 2020 2020 2020 6669 6c65  lf,.        file
+0000b240: 7061 7468 5f6f 725f 6275 6666 6572 3a20  path_or_buffer: 
+0000b250: 4669 6c65 5061 7468 207c 2052 6561 6450  FilePath | ReadP
+0000b260: 6963 6b6c 6542 7566 6665 722c 0a20 2020  ickleBuffer,.   
+0000b270: 2020 2020 2063 6f6d 7072 6573 7369 6f6e       compression
+0000b280: 3a20 436f 6d70 7265 7373 696f 6e4f 7074  : CompressionOpt
+0000b290: 696f 6e73 203d 2022 696e 6665 7222 2c0a  ions = "infer",.
+0000b2a0: 2020 2020 2020 2020 7374 6f72 6167 655f          storage_
+0000b2b0: 6f70 7469 6f6e 733a 2053 746f 7261 6765  options: Storage
+0000b2c0: 4f70 7469 6f6e 7320 3d20 4e6f 6e65 2c0a  Options = None,.
+0000b2d0: 2020 2020 293a 0a20 2020 2020 2020 2070      ):.        p
+0000b2e0: 616e 6461 735f 6f62 6a20 3d20 7061 6e64  andas_obj = pand
+0000b2f0: 6173 2e72 6561 645f 7069 636b 6c65 280a  as.read_pickle(.
+0000b300: 2020 2020 2020 2020 2020 2020 6669 6c65              file
+0000b310: 7061 7468 5f6f 725f 6275 6666 6572 2c0a  path_or_buffer,.
+0000b320: 2020 2020 2020 2020 2020 2020 636f 6d70              comp
+0000b330: 7265 7373 696f 6e3d 636f 6d70 7265 7373  ression=compress
+0000b340: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
+0000b350: 2073 746f 7261 6765 5f6f 7074 696f 6e73   storage_options
+0000b360: 3d73 746f 7261 6765 5f6f 7074 696f 6e73  =storage_options
+0000b370: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+0000b380: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+0000b390: 6365 2870 616e 6461 735f 6f62 6a2c 2070  ce(pandas_obj, p
+0000b3a0: 616e 6461 732e 5365 7269 6573 293a 0a20  andas.Series):. 
+0000b3b0: 2020 2020 2020 2020 2020 2069 6620 7061             if pa
+0000b3c0: 6e64 6173 5f6f 626a 2e6e 616d 6520 6973  ndas_obj.name is
+0000b3d0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+0000b3e0: 2020 2020 2020 2070 616e 6461 735f 6f62         pandas_ob
+0000b3f0: 6a2e 6e61 6d65 203d 2022 3022 0a20 2020  j.name = "0".   
+0000b400: 2020 2020 2020 2020 2062 6967 6672 616d           bigfram
+0000b410: 6573 5f64 6620 3d20 7365 6c66 2e5f 7265  es_df = self._re
+0000b420: 6164 5f70 616e 6461 7328 7061 6e64 6173  ad_pandas(pandas
+0000b430: 5f6f 626a 2e74 6f5f 6672 616d 6528 292c  _obj.to_frame(),
+0000b440: 2022 7265 6164 5f70 6963 6b6c 6522 290a   "read_pickle").
+0000b450: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0000b460: 726e 2062 6967 6672 616d 6573 5f64 665b  rn bigframes_df[
+0000b470: 6269 6766 7261 6d65 735f 6466 2e63 6f6c  bigframes_df.col
+0000b480: 756d 6e73 5b30 5d5d 0a20 2020 2020 2020  umns[0]].       
+0000b490: 2072 6574 7572 6e20 7365 6c66 2e5f 7265   return self._re
+0000b4a0: 6164 5f70 616e 6461 7328 7061 6e64 6173  ad_pandas(pandas
+0000b4b0: 5f6f 626a 2c20 2272 6561 645f 7069 636b  _obj, "read_pick
+0000b4c0: 6c65 2229 0a0a 2020 2020 6465 6620 7265  le")..    def re
+0000b4d0: 6164 5f70 6172 7175 6574 280a 2020 2020  ad_parquet(.    
+0000b4e0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+0000b4f0: 2020 7061 7468 3a20 7374 7220 7c20 494f    path: str | IO
+0000b500: 5b22 6279 7465 7322 5d2c 0a20 2020 2020  ["bytes"],.     
+0000b510: 2020 202a 2c0a 2020 2020 2020 2020 656e     *,.        en
+0000b520: 6769 6e65 3a20 7374 7220 3d20 2261 7574  gine: str = "aut
+0000b530: 6f22 2c0a 2020 2020 2920 2d3e 2064 6174  o",.    ) -> dat
+0000b540: 6166 7261 6d65 2e44 6174 6146 7261 6d65  aframe.DataFrame
+0000b550: 3a0a 2020 2020 2020 2020 7461 626c 6520  :.        table 
+0000b560: 3d20 7365 6c66 2e5f 7261 6e64 6f6d 5f74  = self._random_t
+0000b570: 6162 6c65 2829 0a0a 2020 2020 2020 2020  able()..        
+0000b580: 6966 2065 6e67 696e 6520 3d3d 2022 6269  if engine == "bi
+0000b590: 6771 7565 7279 223a 0a20 2020 2020 2020  gquery":.       
+0000b5a0: 2020 2020 206a 6f62 5f63 6f6e 6669 6720       job_config 
+0000b5b0: 3d20 7365 6c66 2e5f 7072 6570 6172 655f  = self._prepare_
+0000b5c0: 6c6f 6164 5f6a 6f62 5f63 6f6e 6669 6728  load_job_config(
+0000b5d0: 290a 2020 2020 2020 2020 2020 2020 6a6f  ).            jo
+0000b5e0: 625f 636f 6e66 6967 2e63 7265 6174 655f  b_config.create_
+0000b5f0: 6469 7370 6f73 6974 696f 6e20 3d20 6269  disposition = bi
+0000b600: 6771 7565 7279 2e43 7265 6174 6544 6973  gquery.CreateDis
+0000b610: 706f 7369 7469 6f6e 2e43 5245 4154 455f  position.CREATE_
+0000b620: 4946 5f4e 4545 4445 440a 2020 2020 2020  IF_NEEDED.      
+0000b630: 2020 2020 2020 6a6f 625f 636f 6e66 6967        job_config
+0000b640: 2e73 6f75 7263 655f 666f 726d 6174 203d  .source_format =
+0000b650: 2062 6967 7175 6572 792e 536f 7572 6365   bigquery.Source
+0000b660: 466f 726d 6174 2e50 4152 5155 4554 0a20  Format.PARQUET. 
+0000b670: 2020 2020 2020 2020 2020 206a 6f62 5f63             job_c
+0000b680: 6f6e 6669 672e 7772 6974 655f 6469 7370  onfig.write_disp
+0000b690: 6f73 6974 696f 6e20 3d20 6269 6771 7565  osition = bigque
+0000b6a0: 7279 2e57 7269 7465 4469 7370 6f73 6974  ry.WriteDisposit
+0000b6b0: 696f 6e2e 5752 4954 455f 454d 5054 590a  ion.WRITE_EMPTY.
+0000b6c0: 2020 2020 2020 2020 2020 2020 6a6f 625f              job_
+0000b6d0: 636f 6e66 6967 2e6c 6162 656c 7320 3d20  config.labels = 
+0000b6e0: 7b22 6269 6766 7261 6d65 732d 6170 6922  {"bigframes-api"
+0000b6f0: 3a20 2272 6561 645f 7061 7271 7565 7422  : "read_parquet"
+0000b700: 7d0a 0a20 2020 2020 2020 2020 2020 2072  }..            r
+0000b710: 6574 7572 6e20 7365 6c66 2e5f 7265 6164  eturn self._read
+0000b720: 5f62 6967 7175 6572 795f 6c6f 6164 5f6a  _bigquery_load_j
+0000b730: 6f62 2870 6174 682c 2074 6162 6c65 2c20  ob(path, table, 
+0000b740: 6a6f 625f 636f 6e66 6967 3d6a 6f62 5f63  job_config=job_c
+0000b750: 6f6e 6669 6729 0a20 2020 2020 2020 2065  onfig).        e
+0000b760: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0000b770: 2072 6561 645f 7061 7271 7565 745f 6b77   read_parquet_kw
+0000b780: 6172 6773 3a20 4469 6374 5b73 7472 2c20  args: Dict[str, 
+0000b790: 416e 795d 203d 207b 7d0a 2020 2020 2020  Any] = {}.      
+0000b7a0: 2020 2020 2020 6966 2070 616e 6461 732e        if pandas.
+0000b7b0: 5f5f 7665 7273 696f 6e5f 5f2e 7374 6172  __version__.star
+0000b7c0: 7473 7769 7468 2822 312e 2229 3a0a 2020  tswith("1."):.  
+0000b7d0: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0000b7e0: 6164 5f70 6172 7175 6574 5f6b 7761 7267  ad_parquet_kwarg
+0000b7f0: 735b 2275 7365 5f6e 756c 6c61 626c 655f  s["use_nullable_
+0000b800: 6474 7970 6573 225d 203d 2054 7275 650a  dtypes"] = True.
+0000b810: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0000b820: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000b830: 2020 7265 6164 5f70 6172 7175 6574 5f6b    read_parquet_k
+0000b840: 7761 7267 735b 2264 7479 7065 5f62 6163  wargs["dtype_bac
+0000b850: 6b65 6e64 225d 203d 2022 7079 6172 726f  kend"] = "pyarro
+0000b860: 7722 0a0a 2020 2020 2020 2020 2020 2020  w"..            
+0000b870: 7061 6e64 6173 5f6f 626a 203d 2070 616e  pandas_obj = pan
+0000b880: 6461 732e 7265 6164 5f70 6172 7175 6574  das.read_parquet
+0000b890: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0000b8a0: 2020 7061 7468 2c0a 2020 2020 2020 2020    path,.        
+0000b8b0: 2020 2020 2020 2020 656e 6769 6e65 3d65          engine=e
+0000b8c0: 6e67 696e 652c 2020 2320 7479 7065 3a20  ngine,  # type: 
+0000b8d0: 6967 6e6f 7265 0a20 2020 2020 2020 2020  ignore.         
+0000b8e0: 2020 2020 2020 202a 2a72 6561 645f 7061         **read_pa
+0000b8f0: 7271 7565 745f 6b77 6172 6773 2c0a 2020  rquet_kwargs,.  
+0000b900: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0000b910: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0000b920: 656c 662e 5f72 6561 645f 7061 6e64 6173  elf._read_pandas
+0000b930: 2870 616e 6461 735f 6f62 6a2c 2022 7265  (pandas_obj, "re
+0000b940: 6164 5f70 6172 7175 6574 2229 0a0a 2020  ad_parquet")..  
+0000b950: 2020 6465 6620 7265 6164 5f6a 736f 6e28    def read_json(
+0000b960: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+0000b970: 2020 2020 2020 2070 6174 685f 6f72 5f62         path_or_b
+0000b980: 7566 3a20 7374 7220 7c20 494f 5b22 6279  uf: str | IO["by
+0000b990: 7465 7322 5d2c 0a20 2020 2020 2020 202a  tes"],.        *
+0000b9a0: 2c0a 2020 2020 2020 2020 6f72 6965 6e74  ,.        orient
+0000b9b0: 3a20 4c69 7465 7261 6c5b 0a20 2020 2020  : Literal[.     
+0000b9c0: 2020 2020 2020 2022 7370 6c69 7422 2c20         "split", 
+0000b9d0: 2272 6563 6f72 6473 222c 2022 696e 6465  "records", "inde
+0000b9e0: 7822 2c20 2263 6f6c 756d 6e73 222c 2022  x", "columns", "
+0000b9f0: 7661 6c75 6573 222c 2022 7461 626c 6522  values", "table"
+0000ba00: 0a20 2020 2020 2020 205d 203d 2022 636f  .        ] = "co
+0000ba10: 6c75 6d6e 7322 2c0a 2020 2020 2020 2020  lumns",.        
+0000ba20: 6474 7970 653a 204f 7074 696f 6e61 6c5b  dtype: Optional[
+0000ba30: 4469 6374 5d20 3d20 4e6f 6e65 2c0a 2020  Dict] = None,.  
+0000ba40: 2020 2020 2020 656e 636f 6469 6e67 3a20        encoding: 
+0000ba50: 4f70 7469 6f6e 616c 5b73 7472 5d20 3d20  Optional[str] = 
+0000ba60: 4e6f 6e65 2c0a 2020 2020 2020 2020 6c69  None,.        li
+0000ba70: 6e65 733a 2062 6f6f 6c20 3d20 4661 6c73  nes: bool = Fals
+0000ba80: 652c 0a20 2020 2020 2020 2065 6e67 696e  e,.        engin
+0000ba90: 653a 204c 6974 6572 616c 5b22 756a 736f  e: Literal["ujso
+0000baa0: 6e22 2c20 2270 7961 7272 6f77 222c 2022  n", "pyarrow", "
+0000bab0: 6269 6771 7565 7279 225d 203d 2022 756a  bigquery"] = "uj
+0000bac0: 736f 6e22 2c0a 2020 2020 2020 2020 2a2a  son",.        **
+0000bad0: 6b77 6172 6773 2c0a 2020 2020 2920 2d3e  kwargs,.    ) ->
+0000bae0: 2064 6174 6166 7261 6d65 2e44 6174 6146   dataframe.DataF
+0000baf0: 7261 6d65 3a0a 2020 2020 2020 2020 7461  rame:.        ta
+0000bb00: 626c 6520 3d20 7365 6c66 2e5f 7261 6e64  ble = self._rand
+0000bb10: 6f6d 5f74 6162 6c65 2829 0a0a 2020 2020  om_table()..    
+0000bb20: 2020 2020 6966 2065 6e67 696e 6520 3d3d      if engine ==
+0000bb30: 2022 6269 6771 7565 7279 223a 0a0a 2020   "bigquery":..  
+0000bb40: 2020 2020 2020 2020 2020 6966 2064 7479            if dty
+0000bb50: 7065 2069 7320 6e6f 7420 4e6f 6e65 3a0a  pe is not None:.
+0000bb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bb70: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
+0000bb80: 6e74 6564 4572 726f 7228 0a20 2020 2020  ntedError(.     
+0000bb90: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0000bba0: 4269 6751 7565 7279 2065 6e67 696e 6520  BigQuery engine 
+0000bbb0: 646f 6573 206e 6f74 2073 7570 706f 7274  does not support
+0000bbc0: 2074 6865 2064 7479 7065 2061 7267 756d   the dtype argum
+0000bbd0: 656e 7473 2e22 0a20 2020 2020 2020 2020  ents.".         
+0000bbe0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+0000bbf0: 2020 2020 2020 6966 206e 6f74 206c 696e        if not lin
+0000bc00: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
+0000bc10: 2020 2020 7261 6973 6520 4e6f 7449 6d70      raise NotImp
+0000bc20: 6c65 6d65 6e74 6564 4572 726f 7228 0a20  lementedError(. 
+0000bc30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bc40: 2020 2022 4f6e 6c79 206e 6577 6c69 6e65     "Only newline
+0000bc50: 2064 656c 696d 6974 6564 204a 534f 4e20   delimited JSON 
+0000bc60: 666f 726d 6174 2069 7320 7375 7070 6f72  format is suppor
+0000bc70: 7465 642e 220a 2020 2020 2020 2020 2020  ted.".          
+0000bc80: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+0000bc90: 2020 2020 2069 6620 656e 636f 6469 6e67       if encoding
+0000bca0: 2069 7320 6e6f 7420 4e6f 6e65 2061 6e64   is not None and
+0000bcb0: 2065 6e63 6f64 696e 6720 6e6f 7420 696e   encoding not in
+0000bcc0: 205f 5641 4c49 445f 454e 434f 4449 4e47   _VALID_ENCODING
+0000bcd0: 533a 0a20 2020 2020 2020 2020 2020 2020  S:.             
+0000bce0: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
+0000bcf0: 656d 656e 7465 6445 7272 6f72 280a 2020  ementedError(.  
+0000bd00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bd10: 2020 6622 4269 6751 7565 7279 2065 6e67    f"BigQuery eng
+0000bd20: 696e 6520 6f6e 6c79 2073 7570 706f 7274  ine only support
+0000bd30: 7320 7468 6520 666f 6c6c 6f77 696e 6720  s the following 
+0000bd40: 656e 636f 6469 6e67 733a 207b 5f56 414c  encodings: {_VAL
+0000bd50: 4944 5f45 4e43 4f44 494e 4753 7d22 0a20  ID_ENCODINGS}". 
+0000bd60: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0000bd70: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+0000bd80: 206c 696e 6573 2061 6e64 206f 7269 656e   lines and orien
+0000bd90: 7420 213d 2022 7265 636f 7264 7322 3a0a  t != "records":.
+0000bda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bdb0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+0000bdc0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0000bdd0: 2020 2020 2020 2227 6c69 6e65 7327 206b        "'lines' k
+0000bde0: 6579 776f 7264 2069 7320 6f6e 6c79 2076  eyword is only v
+0000bdf0: 616c 6964 2077 6865 6e20 276f 7269 656e  alid when 'orien
+0000be00: 7427 2069 7320 2772 6563 6f72 6473 272e  t' is 'records'.
+0000be10: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+0000be20: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
+0000be30: 206a 6f62 5f63 6f6e 6669 6720 3d20 7365   job_config = se
+0000be40: 6c66 2e5f 7072 6570 6172 655f 6c6f 6164  lf._prepare_load
+0000be50: 5f6a 6f62 5f63 6f6e 6669 6728 290a 2020  _job_config().  
+0000be60: 2020 2020 2020 2020 2020 6a6f 625f 636f            job_co
+0000be70: 6e66 6967 2e63 7265 6174 655f 6469 7370  nfig.create_disp
+0000be80: 6f73 6974 696f 6e20 3d20 6269 6771 7565  osition = bigque
+0000be90: 7279 2e43 7265 6174 6544 6973 706f 7369  ry.CreateDisposi
+0000bea0: 7469 6f6e 2e43 5245 4154 455f 4946 5f4e  tion.CREATE_IF_N
+0000beb0: 4545 4445 440a 2020 2020 2020 2020 2020  EEDED.          
+0000bec0: 2020 6a6f 625f 636f 6e66 6967 2e73 6f75    job_config.sou
+0000bed0: 7263 655f 666f 726d 6174 203d 2062 6967  rce_format = big
+0000bee0: 7175 6572 792e 536f 7572 6365 466f 726d  query.SourceForm
+0000bef0: 6174 2e4e 4557 4c49 4e45 5f44 454c 494d  at.NEWLINE_DELIM
+0000bf00: 4954 4544 5f4a 534f 4e0a 2020 2020 2020  ITED_JSON.      
+0000bf10: 2020 2020 2020 6a6f 625f 636f 6e66 6967        job_config
+0000bf20: 2e77 7269 7465 5f64 6973 706f 7369 7469  .write_dispositi
+0000bf30: 6f6e 203d 2062 6967 7175 6572 792e 5772  on = bigquery.Wr
+0000bf40: 6974 6544 6973 706f 7369 7469 6f6e 2e57  iteDisposition.W
+0000bf50: 5249 5445 5f45 4d50 5459 0a20 2020 2020  RITE_EMPTY.     
+0000bf60: 2020 2020 2020 206a 6f62 5f63 6f6e 6669         job_confi
+0000bf70: 672e 6175 746f 6465 7465 6374 203d 2054  g.autodetect = T
+0000bf80: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
+0000bf90: 6a6f 625f 636f 6e66 6967 2e65 6e63 6f64  job_config.encod
+0000bfa0: 696e 6720 3d20 656e 636f 6469 6e67 0a20  ing = encoding. 
+0000bfb0: 2020 2020 2020 2020 2020 206a 6f62 5f63             job_c
+0000bfc0: 6f6e 6669 672e 6c61 6265 6c73 203d 207b  onfig.labels = {
+0000bfd0: 2262 6967 6672 616d 6573 2d61 7069 223a  "bigframes-api":
+0000bfe0: 2022 7265 6164 5f6a 736f 6e22 7d0a 0a20   "read_json"}.. 
+0000bff0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0000c000: 6e20 7365 6c66 2e5f 7265 6164 5f62 6967  n self._read_big
+0000c010: 7175 6572 795f 6c6f 6164 5f6a 6f62 280a  query_load_job(.
+0000c020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c030: 7061 7468 5f6f 725f 6275 662c 0a20 2020  path_or_buf,.   
+0000c040: 2020 2020 2020 2020 2020 2020 2074 6162               tab
+0000c050: 6c65 2c0a 2020 2020 2020 2020 2020 2020  le,.            
+0000c060: 2020 2020 6a6f 625f 636f 6e66 6967 3d6a      job_config=j
+0000c070: 6f62 5f63 6f6e 6669 672c 0a20 2020 2020  ob_config,.     
+0000c080: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0000c090: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0000c0a0: 2020 2069 6620 616e 7928 6172 6720 696e     if any(arg in
+0000c0b0: 206b 7761 7267 7320 666f 7220 6172 6720   kwargs for arg 
+0000c0c0: 696e 2028 2263 6875 6e6b 7369 7a65 222c  in ("chunksize",
+0000c0d0: 2022 6974 6572 6174 6f72 2229 293a 0a20   "iterator")):. 
+0000c0e0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0000c0f0: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
+0000c100: 7465 6445 7272 6f72 280a 2020 2020 2020  tedError(.      
+0000c110: 2020 2020 2020 2020 2020 2020 2020 2227                "'
+0000c120: 6368 756e 6b73 697a 6527 2061 6e64 2027  chunksize' and '
+0000c130: 6974 6572 6174 6f72 2720 6172 6775 6d65  iterator' argume
+0000c140: 6e74 7320 6172 6520 6e6f 7420 7375 7070  nts are not supp
+0000c150: 6f72 7465 642e 220a 2020 2020 2020 2020  orted.".        
+0000c160: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+0000c170: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+0000c180: 616e 6365 2870 6174 685f 6f72 5f62 7566  ance(path_or_buf
+0000c190: 2c20 7374 7229 3a0a 2020 2020 2020 2020  , str):.        
+0000c1a0: 2020 2020 2020 2020 7365 6c66 2e5f 6368          self._ch
+0000c1b0: 6563 6b5f 6669 6c65 5f73 697a 6528 7061  eck_file_size(pa
+0000c1c0: 7468 5f6f 725f 6275 6629 0a0a 2020 2020  th_or_buf)..    
+0000c1d0: 2020 2020 2020 2020 6966 2065 6e67 696e          if engin
+0000c1e0: 6520 3d3d 2022 756a 736f 6e22 3a0a 2020  e == "ujson":.  
+0000c1f0: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+0000c200: 6e64 6173 5f64 6620 3d20 7061 6e64 6173  ndas_df = pandas
+0000c210: 2e72 6561 645f 6a73 6f6e 2820 2023 2074  .read_json(  # t
+0000c220: 7970 653a 2069 676e 6f72 650a 2020 2020  ype: ignore.    
+0000c230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c240: 7061 7468 5f6f 725f 6275 662c 0a20 2020  path_or_buf,.   
+0000c250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c260: 206f 7269 656e 743d 6f72 6965 6e74 2c0a   orient=orient,.
+0000c270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c280: 2020 2020 6474 7970 653d 6474 7970 652c      dtype=dtype,
+0000c290: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000c2a0: 2020 2020 2065 6e63 6f64 696e 673d 656e       encoding=en
+0000c2b0: 636f 6469 6e67 2c0a 2020 2020 2020 2020  coding,.        
+0000c2c0: 2020 2020 2020 2020 2020 2020 6c69 6e65              line
+0000c2d0: 733d 6c69 6e65 732c 0a20 2020 2020 2020  s=lines,.       
+0000c2e0: 2020 2020 2020 2020 2020 2020 202a 2a6b               **k
+0000c2f0: 7761 7267 732c 0a20 2020 2020 2020 2020  wargs,.         
+0000c300: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+0000c310: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0000c320: 2020 2020 2020 2020 2020 2020 7061 6e64              pand
+0000c330: 6173 5f64 6620 3d20 7061 6e64 6173 2e72  as_df = pandas.r
+0000c340: 6561 645f 6a73 6f6e 2820 2023 2074 7970  ead_json(  # typ
+0000c350: 653a 2069 676e 6f72 650a 2020 2020 2020  e: ignore.      
+0000c360: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+0000c370: 7468 5f6f 725f 6275 662c 0a20 2020 2020  th_or_buf,.     
+0000c380: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+0000c390: 7269 656e 743d 6f72 6965 6e74 2c0a 2020  rient=orient,.  
+0000c3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c3b0: 2020 6474 7970 653d 6474 7970 652c 0a20    dtype=dtype,. 
+0000c3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c3d0: 2020 2065 6e63 6f64 696e 673d 656e 636f     encoding=enco
+0000c3e0: 6469 6e67 2c0a 2020 2020 2020 2020 2020  ding,.          
+0000c3f0: 2020 2020 2020 2020 2020 6c69 6e65 733d            lines=
+0000c400: 6c69 6e65 732c 0a20 2020 2020 2020 2020  lines,.         
+0000c410: 2020 2020 2020 2020 2020 2065 6e67 696e             engin
+0000c420: 653d 656e 6769 6e65 2c0a 2020 2020 2020  e=engine,.      
+0000c430: 2020 2020 2020 2020 2020 2020 2020 2a2a                **
+0000c440: 6b77 6172 6773 2c0a 2020 2020 2020 2020  kwargs,.        
+0000c450: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0000c460: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0000c470: 662e 5f72 6561 645f 7061 6e64 6173 2870  f._read_pandas(p
+0000c480: 616e 6461 735f 6466 2c20 2272 6561 645f  andas_df, "read_
+0000c490: 6a73 6f6e 2229 0a0a 2020 2020 6465 6620  json")..    def 
+0000c4a0: 5f63 6865 636b 5f66 696c 655f 7369 7a65  _check_file_size
+0000c4b0: 2873 656c 662c 2066 696c 6570 6174 683a  (self, filepath:
+0000c4c0: 2073 7472 293a 0a20 2020 2020 2020 206d   str):.        m
+0000c4d0: 6178 5f73 697a 6520 3d20 3130 3234 202a  ax_size = 1024 *
+0000c4e0: 2031 3032 3420 2a20 3130 3234 2020 2320   1024 * 1024  # 
+0000c4f0: 3120 4742 2069 6e20 6279 7465 730a 2020  1 GB in bytes.  
+0000c500: 2020 2020 2020 6966 2066 696c 6570 6174        if filepat
+0000c510: 682e 7374 6172 7473 7769 7468 2822 6773  h.startswith("gs
+0000c520: 3a2f 2f22 293a 2020 2320 4743 5320 6669  ://"):  # GCS fi
+0000c530: 6c65 2070 6174 680a 2020 2020 2020 2020  le path.        
+0000c540: 2020 2020 636c 6965 6e74 203d 2073 746f      client = sto
+0000c550: 7261 6765 2e43 6c69 656e 7428 290a 2020  rage.Client().  
+0000c560: 2020 2020 2020 2020 2020 6275 636b 6574            bucket
+0000c570: 5f6e 616d 652c 2062 6c6f 625f 6e61 6d65  _name, blob_name
+0000c580: 203d 2066 696c 6570 6174 682e 7370 6c69   = filepath.spli
+0000c590: 7428 222f 222c 2033 295b 323a 5d0a 2020  t("/", 3)[2:].  
+0000c5a0: 2020 2020 2020 2020 2020 6275 636b 6574            bucket
+0000c5b0: 203d 2063 6c69 656e 742e 6275 636b 6574   = client.bucket
+0000c5c0: 2862 7563 6b65 745f 6e61 6d65 290a 2020  (bucket_name).  
+0000c5d0: 2020 2020 2020 2020 2020 626c 6f62 203d            blob =
+0000c5e0: 2062 7563 6b65 742e 626c 6f62 2862 6c6f   bucket.blob(blo
+0000c5f0: 625f 6e61 6d65 290a 2020 2020 2020 2020  b_name).        
+0000c600: 2020 2020 626c 6f62 2e72 656c 6f61 6428      blob.reload(
+0000c610: 290a 2020 2020 2020 2020 2020 2020 6669  ).            fi
+0000c620: 6c65 5f73 697a 6520 3d20 626c 6f62 2e73  le_size = blob.s
+0000c630: 697a 650a 2020 2020 2020 2020 656c 7365  ize.        else
+0000c640: 3a20 2023 206c 6f63 616c 2066 696c 6520  :  # local file 
+0000c650: 7061 7468 0a20 2020 2020 2020 2020 2020  path.           
+0000c660: 2066 696c 655f 7369 7a65 203d 206f 732e   file_size = os.
+0000c670: 7061 7468 2e67 6574 7369 7a65 2866 696c  path.getsize(fil
+0000c680: 6570 6174 6829 0a0a 2020 2020 2020 2020  epath)..        
+0000c690: 6966 2066 696c 655f 7369 7a65 203e 206d  if file_size > m
+0000c6a0: 6178 5f73 697a 653a 0a20 2020 2020 2020  ax_size:.       
+0000c6b0: 2020 2020 2023 2043 6f6e 7665 7274 2074       # Convert t
+0000c6c0: 6f20 4742 0a20 2020 2020 2020 2020 2020  o GB.           
+0000c6d0: 2066 696c 655f 7369 7a65 203d 2072 6f75   file_size = rou
+0000c6e0: 6e64 2866 696c 655f 7369 7a65 202f 2028  nd(file_size / (
+0000c6f0: 3130 3234 2a2a 3329 2c20 3129 0a20 2020  1024**3), 1).   
+0000c700: 2020 2020 2020 2020 206d 6178 5f73 697a           max_siz
+0000c710: 6520 3d20 696e 7428 6d61 785f 7369 7a65  e = int(max_size
+0000c720: 202f 2031 3032 342a 2a33 290a 2020 2020   / 1024**3).    
+0000c730: 2020 2020 2020 2020 6c6f 6767 6572 2e77          logger.w
+0000c740: 6172 6e69 6e67 280a 2020 2020 2020 2020  arning(.        
+0000c750: 2020 2020 2020 2020 6622 4669 6c65 2073          f"File s
+0000c760: 697a 6520 7b66 696c 655f 7369 7a65 7d47  ize {file_size}G
+0000c770: 4220 6578 6365 6564 7320 7b6d 6178 5f73  B exceeds {max_s
+0000c780: 697a 657d 4742 2e20 220a 2020 2020 2020  ize}GB. ".      
+0000c790: 2020 2020 2020 2020 2020 2249 7420 6973            "It is
+0000c7a0: 2072 6563 6f6d 6d65 6e64 6564 2074 6f20   recommended to 
+0000c7b0: 7573 6520 656e 6769 6e65 3d27 6269 6771  use engine='bigq
+0000c7c0: 7565 7279 2720 220a 2020 2020 2020 2020  uery' ".        
+0000c7d0: 2020 2020 2020 2020 2266 6f72 206c 6172          "for lar
+0000c7e0: 6765 2066 696c 6573 2074 6f20 6176 6f69  ge files to avoi
+0000c7f0: 6420 6c6f 6164 696e 6720 7468 6520 6669  d loading the fi
+0000c800: 6c65 2069 6e74 6f20 6c6f 6361 6c20 6d65  le into local me
+0000c810: 6d6f 7279 2e22 0a20 2020 2020 2020 2020  mory.".         
+0000c820: 2020 2029 0a0a 2020 2020 6465 6620 5f63     )..    def _c
+0000c830: 7265 6174 655f 656d 7074 795f 7465 6d70  reate_empty_temp
+0000c840: 5f74 6162 6c65 280a 2020 2020 2020 2020  _table(.        
+0000c850: 7365 6c66 2c0a 2020 2020 2020 2020 7363  self,.        sc
+0000c860: 6865 6d61 3a20 4974 6572 6162 6c65 5b62  hema: Iterable[b
+0000c870: 6967 7175 6572 792e 5363 6865 6d61 4669  igquery.SchemaFi
+0000c880: 656c 645d 2c0a 2020 2020 2020 2020 636c  eld],.        cl
+0000c890: 7573 7465 725f 636f 6c73 3a20 4c69 7374  uster_cols: List
+0000c8a0: 5b73 7472 5d2c 0a20 2020 2029 202d 3e20  [str],.    ) -> 
+0000c8b0: 6269 6771 7565 7279 2e54 6162 6c65 5265  bigquery.TableRe
+0000c8c0: 6665 7265 6e63 653a 0a20 2020 2020 2020  ference:.       
+0000c8d0: 2023 2043 616e 2774 2073 6574 2061 2074   # Can't set a t
+0000c8e0: 6162 6c65 2069 6e20 5f53 4553 5349 4f4e  able in _SESSION
+0000c8f0: 2061 7320 6465 7374 696e 6174 696f 6e20   as destination 
+0000c900: 7669 6120 7175 6572 7920 6a6f 6220 4150  via query job AP
+0000c910: 492c 2073 6f20 7765 0a20 2020 2020 2020  I, so we.       
+0000c920: 2023 2072 756e 2044 444c 2c20 696e 7374   # run DDL, inst
+0000c930: 6561 642e 0a20 2020 2020 2020 2065 7870  ead..        exp
+0000c940: 6972 6174 696f 6e20 3d20 280a 2020 2020  iration = (.    
+0000c950: 2020 2020 2020 2020 6461 7465 7469 6d65          datetime
+0000c960: 2e64 6174 6574 696d 652e 6e6f 7728 6461  .datetime.now(da
+0000c970: 7465 7469 6d65 2e74 696d 657a 6f6e 652e  tetime.timezone.
+0000c980: 7574 6329 202b 2063 6f6e 7374 616e 7473  utc) + constants
+0000c990: 2e44 4546 4155 4c54 5f45 5850 4952 4154  .DEFAULT_EXPIRAT
+0000c9a0: 494f 4e0a 2020 2020 2020 2020 290a 0a20  ION.        ).. 
+0000c9b0: 2020 2020 2020 2074 6162 6c65 203d 2062         table = b
+0000c9c0: 665f 696f 5f62 6967 7175 6572 792e 6372  f_io_bigquery.cr
+0000c9d0: 6561 7465 5f74 656d 705f 7461 626c 6528  eate_temp_table(
+0000c9e0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0000c9f0: 662c 0a20 2020 2020 2020 2020 2020 2065  f,.            e
+0000ca00: 7870 6972 6174 696f 6e2c 0a20 2020 2020  xpiration,.     
+0000ca10: 2020 2020 2020 2073 6368 656d 613d 7363         schema=sc
+0000ca20: 6865 6d61 2c0a 2020 2020 2020 2020 2020  hema,.          
+0000ca30: 2020 636c 7573 7465 725f 636f 6c75 6d6e    cluster_column
+0000ca40: 733d 636c 7573 7465 725f 636f 6c73 2c0a  s=cluster_cols,.
+0000ca50: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0000ca60: 2020 7265 7475 726e 2062 6967 7175 6572    return bigquer
+0000ca70: 792e 5461 626c 6552 6566 6572 656e 6365  y.TableReference
+0000ca80: 2e66 726f 6d5f 7374 7269 6e67 2874 6162  .from_string(tab
+0000ca90: 6c65 290a 0a20 2020 2064 6566 205f 6962  le)..    def _ib
+0000caa0: 6973 5f74 6f5f 7465 6d70 5f74 6162 6c65  is_to_temp_table
+0000cab0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+0000cac0: 2020 2020 2020 2020 7461 626c 653a 2069          table: i
+0000cad0: 6269 735f 7479 7065 732e 5461 626c 652c  bis_types.Table,
+0000cae0: 0a20 2020 2020 2020 2063 6c75 7374 6572  .        cluster
+0000caf0: 5f63 6f6c 733a 2049 7465 7261 626c 655b  _cols: Iterable[
+0000cb00: 7374 725d 2c0a 2020 2020 2020 2020 6170  str],.        ap
+0000cb10: 695f 6e61 6d65 3a20 7374 722c 0a20 2020  i_name: str,.   
+0000cb20: 2029 202d 3e20 6269 6771 7565 7279 2e54   ) -> bigquery.T
+0000cb30: 6162 6c65 5265 6665 7265 6e63 653a 0a20  ableReference:. 
+0000cb40: 2020 2020 2020 2064 6573 7469 6e61 7469         destinati
+0000cb50: 6f6e 2c20 5f20 3d20 7365 6c66 2e5f 7175  on, _ = self._qu
+0000cb60: 6572 795f 746f 5f64 6573 7469 6e61 7469  ery_to_destinati
+0000cb70: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
+0000cb80: 7365 6c66 2e69 6269 735f 636c 6965 6e74  self.ibis_client
+0000cb90: 2e63 6f6d 7069 6c65 2874 6162 6c65 292c  .compile(table),
+0000cba0: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
+0000cbb0: 6578 5f63 6f6c 733d 6c69 7374 2863 6c75  ex_cols=list(clu
+0000cbc0: 7374 6572 5f63 6f6c 7329 2c0a 2020 2020  ster_cols),.    
+0000cbd0: 2020 2020 2020 2020 6170 695f 6e61 6d65          api_name
+0000cbe0: 3d61 7069 5f6e 616d 652c 0a20 2020 2020  =api_name,.     
+0000cbf0: 2020 2029 0a20 2020 2020 2020 2023 2054     ).        # T
+0000cc00: 6865 7265 2073 686f 756c 6420 616c 7761  here should alwa
+0000cc10: 7973 2062 6520 6120 6465 7374 696e 6174  ys be a destinat
+0000cc20: 696f 6e20 7461 626c 6520 666f 7220 7468  ion table for th
+0000cc30: 6973 2071 7565 7279 2074 7970 652e 0a20  is query type.. 
+0000cc40: 2020 2020 2020 2072 6574 7572 6e20 7479         return ty
+0000cc50: 7069 6e67 2e63 6173 7428 6269 6771 7565  ping.cast(bigque
+0000cc60: 7279 2e54 6162 6c65 5265 6665 7265 6e63  ry.TableReferenc
+0000cc70: 652c 2064 6573 7469 6e61 7469 6f6e 290a  e, destination).
+0000cc80: 0a20 2020 2064 6566 2072 656d 6f74 655f  .    def remote_
+0000cc90: 6675 6e63 7469 6f6e 280a 2020 2020 2020  function(.      
+0000cca0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+0000ccb0: 696e 7075 745f 7479 7065 733a 2055 6e69  input_types: Uni
+0000ccc0: 6f6e 5b74 7970 652c 2053 6571 7565 6e63  on[type, Sequenc
+0000ccd0: 655b 7479 7065 5d5d 2c0a 2020 2020 2020  e[type]],.      
+0000cce0: 2020 6f75 7470 7574 5f74 7970 653a 2074    output_type: t
+0000ccf0: 7970 652c 0a20 2020 2020 2020 2064 6174  ype,.        dat
+0000cd00: 6173 6574 3a20 4f70 7469 6f6e 616c 5b73  aset: Optional[s
+0000cd10: 7472 5d20 3d20 4e6f 6e65 2c0a 2020 2020  tr] = None,.    
+0000cd20: 2020 2020 6269 6771 7565 7279 5f63 6f6e      bigquery_con
+0000cd30: 6e65 6374 696f 6e3a 204f 7074 696f 6e61  nection: Optiona
+0000cd40: 6c5b 7374 725d 203d 204e 6f6e 652c 0a20  l[str] = None,. 
+0000cd50: 2020 2020 2020 2072 6575 7365 3a20 626f         reuse: bo
+0000cd60: 6f6c 203d 2054 7275 652c 0a20 2020 2020  ol = True,.     
+0000cd70: 2020 206e 616d 653a 204f 7074 696f 6e61     name: Optiona
+0000cd80: 6c5b 7374 725d 203d 204e 6f6e 652c 0a20  l[str] = None,. 
+0000cd90: 2020 2020 2020 2070 6163 6b61 6765 733a         packages:
+0000cda0: 204f 7074 696f 6e61 6c5b 5365 7175 656e   Optional[Sequen
+0000cdb0: 6365 5b73 7472 5d5d 203d 204e 6f6e 652c  ce[str]] = None,
+0000cdc0: 0a20 2020 2020 2020 2063 6c6f 7564 5f66  .        cloud_f
+0000cdd0: 756e 6374 696f 6e5f 7365 7276 6963 655f  unction_service_
+0000cde0: 6163 636f 756e 743a 204f 7074 696f 6e61  account: Optiona
+0000cdf0: 6c5b 7374 725d 203d 204e 6f6e 652c 0a20  l[str] = None,. 
+0000ce00: 2020 2020 2020 2063 6c6f 7564 5f66 756e         cloud_fun
+0000ce10: 6374 696f 6e5f 6b6d 735f 6b65 795f 6e61  ction_kms_key_na
+0000ce20: 6d65 3a20 4f70 7469 6f6e 616c 5b73 7472  me: Optional[str
+0000ce30: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
+0000ce40: 2020 636c 6f75 645f 6675 6e63 7469 6f6e    cloud_function
+0000ce50: 5f64 6f63 6b65 725f 7265 706f 7369 746f  _docker_reposito
+0000ce60: 7279 3a20 4f70 7469 6f6e 616c 5b73 7472  ry: Optional[str
+0000ce70: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
+0000ce80: 2020 6d61 785f 6261 7463 6869 6e67 5f72    max_batching_r
+0000ce90: 6f77 733a 204f 7074 696f 6e61 6c5b 696e  ows: Optional[in
+0000cea0: 745d 203d 2031 3030 302c 0a20 2020 2020  t] = 1000,.     
+0000ceb0: 2020 2063 6c6f 7564 5f66 756e 6374 696f     cloud_functio
+0000cec0: 6e5f 7469 6d65 6f75 743a 204f 7074 696f  n_timeout: Optio
+0000ced0: 6e61 6c5b 696e 745d 203d 2036 3030 2c0a  nal[int] = 600,.
+0000cee0: 2020 2020 2020 2020 636c 6f75 645f 6675          cloud_fu
+0000cef0: 6e63 7469 6f6e 5f6d 6178 5f69 6e73 7461  nction_max_insta
+0000cf00: 6e63 6573 3a20 4f70 7469 6f6e 616c 5b69  nces: Optional[i
+0000cf10: 6e74 5d20 3d20 4e6f 6e65 2c0a 2020 2020  nt] = None,.    
+0000cf20: 2020 2020 636c 6f75 645f 6675 6e63 7469      cloud_functi
+0000cf30: 6f6e 5f76 7063 5f63 6f6e 6e65 6374 6f72  on_vpc_connector
+0000cf40: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
+0000cf50: 3d20 4e6f 6e65 2c0a 2020 2020 293a 0a20  = None,.    ):. 
+0000cf60: 2020 2020 2020 2022 2222 4465 636f 7261         """Decora
+0000cf70: 746f 7220 746f 2074 7572 6e20 6120 7573  tor to turn a us
+0000cf80: 6572 2064 6566 696e 6564 2066 756e 6374  er defined funct
+0000cf90: 696f 6e20 696e 746f 2061 2042 6967 5175  ion into a BigQu
+0000cfa0: 6572 7920 7265 6d6f 7465 2066 756e 6374  ery remote funct
+0000cfb0: 696f 6e2e 2043 6865 636b 206f 7574 0a20  ion. Check out. 
+0000cfc0: 2020 2020 2020 2074 6865 2063 6f64 6520         the code 
+0000cfd0: 7361 6d70 6c65 7320 6174 3a20 6874 7470  samples at: http
+0000cfe0: 733a 2f2f 636c 6f75 642e 676f 6f67 6c65  s://cloud.google
+0000cff0: 2e63 6f6d 2f62 6967 7175 6572 792f 646f  .com/bigquery/do
+0000d000: 6373 2f72 656d 6f74 652d 6675 6e63 7469  cs/remote-functi
+0000d010: 6f6e 7323 6269 6771 7565 7279 2d64 6174  ons#bigquery-dat
+0000d020: 6166 7261 6d65 732e 0a0a 2020 2020 2020  aframes...      
+0000d030: 2020 2e2e 206e 6f74 653a 3a0a 2020 2020    .. note::.    
+0000d040: 2020 2020 2020 2020 6060 696e 7075 745f          ``input_
+0000d050: 7479 7065 733d 5365 7269 6573 6060 2073  types=Series`` s
+0000d060: 6365 6e61 7269 6f20 6973 2069 6e20 7072  cenario is in pr
+0000d070: 6576 6965 772e 0a0a 2020 2020 2020 2020  eview...        
+0000d080: 2e2e 206e 6f74 653a 3a0a 2020 2020 2020  .. note::.      
+0000d090: 2020 2020 2020 506c 6561 7365 206d 616b        Please mak
+0000d0a0: 6520 7375 7265 2066 6f6c 6c6f 7769 6e67  e sure following
+0000d0b0: 2069 7320 7365 7475 7020 6265 666f 7265   is setup before
+0000d0c0: 2075 7369 6e67 2074 6869 7320 4150 493a   using this API:
+0000d0d0: 0a0a 2020 2020 2020 2020 312e 2048 6176  ..        1. Hav
+0000d0e0: 6520 7468 6520 6265 6c6f 7720 4150 4973  e the below APIs
+0000d0f0: 2065 6e61 626c 6564 2066 6f72 2079 6f75   enabled for you
+0000d100: 7220 7072 6f6a 6563 743a 0a0a 2020 2020  r project:..    
+0000d110: 2020 2020 2020 2020 2a20 4269 6751 7565          * BigQue
+0000d120: 7279 2043 6f6e 6e65 6374 696f 6e20 4150  ry Connection AP
+0000d130: 490a 2020 2020 2020 2020 2020 2020 2a20  I.            * 
+0000d140: 436c 6f75 6420 4675 6e63 7469 6f6e 7320  Cloud Functions 
+0000d150: 4150 490a 2020 2020 2020 2020 2020 2020  API.            
+0000d160: 2a20 436c 6f75 6420 5275 6e20 4150 490a  * Cloud Run API.
+0000d170: 2020 2020 2020 2020 2020 2020 2a20 436c              * Cl
+0000d180: 6f75 6420 4275 696c 6420 4150 490a 2020  oud Build API.  
+0000d190: 2020 2020 2020 2020 2020 2a20 4172 7469            * Arti
+0000d1a0: 6661 6374 2052 6567 6973 7472 7920 4150  fact Registry AP
+0000d1b0: 490a 2020 2020 2020 2020 2020 2020 2a20  I.            * 
+0000d1c0: 436c 6f75 6420 5265 736f 7572 6365 204d  Cloud Resource M
+0000d1d0: 616e 6167 6572 2041 5049 0a0a 2020 2020  anager API..    
+0000d1e0: 2020 2020 2020 2054 6869 7320 6361 6e20         This can 
+0000d1f0: 6265 2064 6f6e 6520 6672 6f6d 2074 6865  be done from the
+0000d200: 2063 6c6f 7564 2063 6f6e 736f 6c65 2028   cloud console (
+0000d210: 6368 616e 6765 2060 5052 4f4a 4543 545f  change `PROJECT_
+0000d220: 4944 6020 746f 2079 6f75 7273 293a 0a20  ID` to yours):. 
+0000d230: 2020 2020 2020 2020 2020 6874 7470 733a            https:
+0000d240: 2f2f 636f 6e73 6f6c 652e 636c 6f75 642e  //console.cloud.
+0000d250: 676f 6f67 6c65 2e63 6f6d 2f61 7069 732f  google.com/apis/
+0000d260: 656e 6162 6c65 666c 6f77 3f61 7069 6964  enableflow?apiid
+0000d270: 3d62 6967 7175 6572 7963 6f6e 6e65 6374  =bigqueryconnect
+0000d280: 696f 6e2e 676f 6f67 6c65 6170 6973 2e63  ion.googleapis.c
+0000d290: 6f6d 2c63 6c6f 7564 6675 6e63 7469 6f6e  om,cloudfunction
+0000d2a0: 732e 676f 6f67 6c65 6170 6973 2e63 6f6d  s.googleapis.com
+0000d2b0: 2c72 756e 2e67 6f6f 676c 6561 7069 732e  ,run.googleapis.
+0000d2c0: 636f 6d2c 636c 6f75 6462 7569 6c64 2e67  com,cloudbuild.g
+0000d2d0: 6f6f 676c 6561 7069 732e 636f 6d2c 6172  oogleapis.com,ar
+0000d2e0: 7469 6661 6374 7265 6769 7374 7279 2e67  tifactregistry.g
+0000d2f0: 6f6f 676c 6561 7069 732e 636f 6d2c 636c  oogleapis.com,cl
+0000d300: 6f75 6472 6573 6f75 7263 656d 616e 6167  oudresourcemanag
+0000d310: 6572 2e67 6f6f 676c 6561 7069 732e 636f  er.googleapis.co
+0000d320: 6d26 7072 6f6a 6563 743d 5052 4f4a 4543  m&project=PROJEC
+0000d330: 545f 4944 0a0a 2020 2020 2020 2020 2020  T_ID..          
+0000d340: 204f 7220 6672 6f6d 2074 6865 2067 636c   Or from the gcl
+0000d350: 6f75 6420 434c 493a 0a0a 2020 2020 2020  oud CLI:..      
+0000d360: 2020 2020 2060 2420 6763 6c6f 7564 2073       `$ gcloud s
+0000d370: 6572 7669 6365 7320 656e 6162 6c65 2062  ervices enable b
+0000d380: 6967 7175 6572 7963 6f6e 6e65 6374 696f  igqueryconnectio
+0000d390: 6e2e 676f 6f67 6c65 6170 6973 2e63 6f6d  n.googleapis.com
+0000d3a0: 2063 6c6f 7564 6675 6e63 7469 6f6e 732e   cloudfunctions.
+0000d3b0: 676f 6f67 6c65 6170 6973 2e63 6f6d 2072  googleapis.com r
+0000d3c0: 756e 2e67 6f6f 676c 6561 7069 732e 636f  un.googleapis.co
+0000d3d0: 6d20 636c 6f75 6462 7569 6c64 2e67 6f6f  m cloudbuild.goo
+0000d3e0: 676c 6561 7069 732e 636f 6d20 6172 7469  gleapis.com arti
+0000d3f0: 6661 6374 7265 6769 7374 7279 2e67 6f6f  factregistry.goo
+0000d400: 676c 6561 7069 732e 636f 6d20 636c 6f75  gleapis.com clou
+0000d410: 6472 6573 6f75 7263 656d 616e 6167 6572  dresourcemanager
+0000d420: 2e67 6f6f 676c 6561 7069 732e 636f 6d60  .googleapis.com`
+0000d430: 0a0a 2020 2020 2020 2020 322e 2048 6176  ..        2. Hav
+0000d440: 6520 666f 6c6c 6f77 696e 6720 4941 4d20  e following IAM 
+0000d450: 726f 6c65 7320 656e 6162 6c65 6420 666f  roles enabled fo
+0000d460: 7220 796f 753a 0a0a 2020 2020 2020 2020  r you:..        
+0000d470: 2020 2020 2a20 4269 6751 7565 7279 2044      * BigQuery D
+0000d480: 6174 6120 4564 6974 6f72 2028 726f 6c65  ata Editor (role
+0000d490: 732f 6269 6771 7565 7279 2e64 6174 6145  s/bigquery.dataE
+0000d4a0: 6469 746f 7229 0a20 2020 2020 2020 2020  ditor).         
+0000d4b0: 2020 202a 2042 6967 5175 6572 7920 436f     * BigQuery Co
+0000d4c0: 6e6e 6563 7469 6f6e 2041 646d 696e 2028  nnection Admin (
+0000d4d0: 726f 6c65 732f 6269 6771 7565 7279 2e63  roles/bigquery.c
+0000d4e0: 6f6e 6e65 6374 696f 6e41 646d 696e 290a  onnectionAdmin).
+0000d4f0: 2020 2020 2020 2020 2020 2020 2a20 436c              * Cl
+0000d500: 6f75 6420 4675 6e63 7469 6f6e 7320 4465  oud Functions De
+0000d510: 7665 6c6f 7065 7220 2872 6f6c 6573 2f63  veloper (roles/c
+0000d520: 6c6f 7564 6675 6e63 7469 6f6e 732e 6465  loudfunctions.de
+0000d530: 7665 6c6f 7065 7229 0a20 2020 2020 2020  veloper).       
+0000d540: 2020 2020 202a 2053 6572 7669 6365 2041       * Service A
+0000d550: 6363 6f75 6e74 2055 7365 7220 2872 6f6c  ccount User (rol
+0000d560: 6573 2f69 616d 2e73 6572 7669 6365 4163  es/iam.serviceAc
+0000d570: 636f 756e 7455 7365 7229 206f 6e20 7468  countUser) on th
+0000d580: 6520 7365 7276 6963 6520 6163 636f 756e  e service accoun
+0000d590: 7420 6050 524f 4a45 4354 5f4e 554d 4245  t `PROJECT_NUMBE
+0000d5a0: 522d 636f 6d70 7574 6540 6465 7665 6c6f  R-compute@develo
+0000d5b0: 7065 722e 6773 6572 7669 6365 6163 636f  per.gserviceacco
+0000d5c0: 756e 742e 636f 6d60 0a20 2020 2020 2020  unt.com`.       
+0000d5d0: 2020 2020 202a 2053 746f 7261 6765 204f       * Storage O
+0000d5e0: 626a 6563 7420 5669 6577 6572 2028 726f  bject Viewer (ro
+0000d5f0: 6c65 732f 7374 6f72 6167 652e 6f62 6a65  les/storage.obje
+0000d600: 6374 5669 6577 6572 290a 2020 2020 2020  ctViewer).      
+0000d610: 2020 2020 2020 2a20 5072 6f6a 6563 7420        * Project 
+0000d620: 4941 4d20 4164 6d69 6e20 2872 6f6c 6573  IAM Admin (roles
+0000d630: 2f72 6573 6f75 7263 656d 616e 6167 6572  /resourcemanager
+0000d640: 2e70 726f 6a65 6374 4961 6d41 646d 696e  .projectIamAdmin
+0000d650: 2920 284f 6e6c 7920 7265 7175 6972 6564  ) (Only required
+0000d660: 2069 6620 7468 6520 6269 6771 7565 7279   if the bigquery
+0000d670: 2063 6f6e 6e65 6374 696f 6e20 6265 696e   connection bein
+0000d680: 6720 7573 6564 2069 7320 6e6f 7420 7072  g used is not pr
+0000d690: 652d 6372 6561 7465 6420 616e 6420 6973  e-created and is
+0000d6a0: 2063 7265 6174 6564 2064 796e 616d 6963   created dynamic
+0000d6b0: 616c 6c79 2077 6974 6820 7573 6572 2063  ally with user c
+0000d6c0: 7265 6465 6e74 6961 6c73 2e29 0a0a 2020  redentials.)..  
+0000d6d0: 2020 2020 2020 332e 2045 6974 6865 7220        3. Either 
+0000d6e0: 7468 6520 7573 6572 2068 6173 2073 6574  the user has set
+0000d6f0: 4961 6d50 6f6c 6963 7920 7072 6976 696c  IamPolicy privil
+0000d700: 6567 6520 6f6e 2074 6865 2070 726f 6a65  ege on the proje
+0000d710: 6374 2c20 6f72 2061 2042 6967 5175 6572  ct, or a BigQuer
+0000d720: 7920 636f 6e6e 6563 7469 6f6e 2069 7320  y connection is 
+0000d730: 7072 652d 6372 6561 7465 6420 7769 7468  pre-created with
+0000d740: 206e 6563 6573 7361 7279 2049 414d 2072   necessary IAM r
+0000d750: 6f6c 6520 7365 743a 0a0a 2020 2020 2020  ole set:..      
+0000d760: 2020 2020 2020 312e 2054 6f20 6372 6561        1. To crea
+0000d770: 7465 2061 2063 6f6e 6e65 6374 696f 6e2c  te a connection,
+0000d780: 2066 6f6c 6c6f 7720 6874 7470 733a 2f2f   follow https://
+0000d790: 636c 6f75 642e 676f 6f67 6c65 2e63 6f6d  cloud.google.com
+0000d7a0: 2f62 6967 7175 6572 792f 646f 6373 2f72  /bigquery/docs/r
+0000d7b0: 6566 6572 656e 6365 2f73 7461 6e64 6172  eference/standar
+0000d7c0: 642d 7371 6c2f 7265 6d6f 7465 2d66 756e  d-sql/remote-fun
+0000d7d0: 6374 696f 6e73 2363 7265 6174 655f 615f  ctions#create_a_
+0000d7e0: 636f 6e6e 6563 7469 6f6e 0a20 2020 2020  connection.     
+0000d7f0: 2020 2020 2020 2032 2e20 546f 2073 6574         2. To set
+0000d800: 2075 7020 4941 4d2c 2066 6f6c 6c6f 7720   up IAM, follow 
+0000d810: 6874 7470 733a 2f2f 636c 6f75 642e 676f  https://cloud.go
+0000d820: 6f67 6c65 2e63 6f6d 2f62 6967 7175 6572  ogle.com/bigquer
+0000d830: 792f 646f 6373 2f72 6566 6572 656e 6365  y/docs/reference
+0000d840: 2f73 7461 6e64 6172 642d 7371 6c2f 7265  /standard-sql/re
+0000d850: 6d6f 7465 2d66 756e 6374 696f 6e73 2367  mote-functions#g
+0000d860: 7261 6e74 5f70 6572 6d69 7373 696f 6e5f  rant_permission_
+0000d870: 6f6e 5f66 756e 6374 696f 6e0a 0a20 2020  on_function..   
+0000d880: 2020 2020 2020 2020 2020 2020 416c 7465              Alte
+0000d890: 726e 6174 6976 656c 792c 2074 6865 2049  rnatively, the I
+0000d8a0: 414d 2063 6f75 6c64 2061 6c73 6f20 6265  AM could also be
+0000d8b0: 2073 6574 7570 2076 6961 2074 6865 2067   setup via the g
+0000d8c0: 636c 6f75 6420 434c 493a 0a0a 2020 2020  cloud CLI:..    
+0000d8d0: 2020 2020 2020 2020 2020 2060 2420 6763             `$ gc
+0000d8e0: 6c6f 7564 2070 726f 6a65 6374 7320 6164  loud projects ad
+0000d8f0: 642d 6961 6d2d 706f 6c69 6379 2d62 696e  d-iam-policy-bin
+0000d900: 6469 6e67 2050 524f 4a45 4354 5f49 4420  ding PROJECT_ID 
+0000d910: 2d2d 6d65 6d62 6572 3d22 7365 7276 6963  --member="servic
+0000d920: 6541 6363 6f75 6e74 3a43 4f4e 4e45 4354  eAccount:CONNECT
+0000d930: 494f 4e5f 5345 5256 4943 455f 4143 434f  ION_SERVICE_ACCO
+0000d940: 554e 545f 4944 2220 2d2d 726f 6c65 3d22  UNT_ID" --role="
+0000d950: 726f 6c65 732f 7275 6e2e 696e 766f 6b65  roles/run.invoke
+0000d960: 7222 602e 0a0a 2020 2020 2020 2020 4172  r"`...        Ar
+0000d970: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
+0000d980: 696e 7075 745f 7479 7065 7320 2874 7970  input_types (typ
+0000d990: 6520 6f72 2073 6571 7565 6e63 6528 7479  e or sequence(ty
+0000d9a0: 7065 2929 3a0a 2020 2020 2020 2020 2020  pe)):.          
+0000d9b0: 2020 2020 2020 466f 7220 7363 616c 6172        For scalar
+0000d9c0: 2075 7365 7220 6465 6669 6e65 6420 6675   user defined fu
+0000d9d0: 6e63 7469 6f6e 2069 7420 7368 6f75 6c64  nction it should
+0000d9e0: 2062 6520 7468 6520 696e 7075 7420 7479   be the input ty
+0000d9f0: 7065 206f 720a 2020 2020 2020 2020 2020  pe or.          
+0000da00: 2020 2020 2020 7365 7175 656e 6365 206f        sequence o
+0000da10: 6620 696e 7075 7420 7479 7065 732e 2046  f input types. F
+0000da20: 6f72 2072 6f77 2070 726f 6365 7373 696e  or row processin
+0000da30: 6720 7573 6572 2064 6566 696e 6564 2066  g user defined f
+0000da40: 756e 6374 696f 6e2c 0a20 2020 2020 2020  unction,.       
+0000da50: 2020 2020 2020 2020 2074 7970 6520 6053           type `S
+0000da60: 6572 6965 7360 2073 686f 756c 6420 6265  eries` should be
+0000da70: 2073 7065 6369 6669 6564 2e0a 2020 2020   specified..    
+0000da80: 2020 2020 2020 2020 6f75 7470 7574 5f74          output_t
+0000da90: 7970 6520 2874 7970 6529 3a0a 2020 2020  ype (type):.    
+0000daa0: 2020 2020 2020 2020 2020 2020 4461 7461              Data
+0000dab0: 2074 7970 6520 6f66 2074 6865 206f 7574   type of the out
+0000dac0: 7075 7420 696e 2074 6865 2075 7365 7220  put in the user 
+0000dad0: 6465 6669 6e65 6420 6675 6e63 7469 6f6e  defined function
+0000dae0: 2e0a 2020 2020 2020 2020 2020 2020 6461  ..            da
+0000daf0: 7461 7365 7420 2873 7472 2c20 4f70 7469  taset (str, Opti
+0000db00: 6f6e 616c 293a 0a20 2020 2020 2020 2020  onal):.         
+0000db10: 2020 2020 2020 2044 6174 6173 6574 2069         Dataset i
+0000db20: 6e20 7768 6963 6820 746f 2063 7265 6174  n which to creat
+0000db30: 6520 6120 4269 6751 7565 7279 2072 656d  e a BigQuery rem
+0000db40: 6f74 6520 6675 6e63 7469 6f6e 2e20 4974  ote function. It
+0000db50: 2073 686f 756c 6420 6265 2069 6e0a 2020   should be in.  
+0000db60: 2020 2020 2020 2020 2020 2020 2020 603c                `<
+0000db70: 7072 6f6a 6563 745f 6964 3e2e 3c64 6174  project_id>.<dat
+0000db80: 6173 6574 5f6e 616d 653e 6020 6f72 2060  aset_name>` or `
+0000db90: 3c64 6174 6173 6574 5f6e 616d 653e 6020  <dataset_name>` 
+0000dba0: 666f 726d 6174 2e20 4966 2074 6869 730a  format. If this.
+0000dbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dbc0: 7061 7261 6d65 7465 7220 6973 206e 6f74  parameter is not
+0000dbd0: 2070 726f 7669 6465 6420 7468 656e 2073   provided then s
+0000dbe0: 6573 7369 6f6e 2064 6174 6173 6574 2069  ession dataset i
+0000dbf0: 6420 6973 2075 7365 642e 0a20 2020 2020  d is used..     
+0000dc00: 2020 2020 2020 2062 6967 7175 6572 795f         bigquery_
+0000dc10: 636f 6e6e 6563 7469 6f6e 2028 7374 722c  connection (str,
+0000dc20: 204f 7074 696f 6e61 6c29 3a0a 2020 2020   Optional):.    
+0000dc30: 2020 2020 2020 2020 2020 2020 4e61 6d65              Name
+0000dc40: 206f 6620 7468 6520 4269 6751 7565 7279   of the BigQuery
+0000dc50: 2063 6f6e 6e65 6374 696f 6e2e 2059 6f75   connection. You
+0000dc60: 2073 686f 756c 6420 6569 7468 6572 2068   should either h
+0000dc70: 6176 6520 7468 650a 2020 2020 2020 2020  ave the.        
+0000dc80: 2020 2020 2020 2020 636f 6e6e 6563 7469          connecti
+0000dc90: 6f6e 2061 6c72 6561 6479 2063 7265 6174  on already creat
+0000dca0: 6564 2069 6e20 7468 6520 606c 6f63 6174  ed in the `locat
+0000dcb0: 696f 6e60 2079 6f75 2068 6176 6520 6368  ion` you have ch
+0000dcc0: 6f73 656e 2c20 6f72 0a20 2020 2020 2020  osen, or.       
+0000dcd0: 2020 2020 2020 2020 2079 6f75 2073 686f           you sho
+0000dce0: 756c 6420 6861 7665 2074 6865 2050 726f  uld have the Pro
+0000dcf0: 6a65 6374 2049 414d 2041 646d 696e 2072  ject IAM Admin r
+0000dd00: 6f6c 6520 746f 2065 6e61 626c 6520 7468  ole to enable th
+0000dd10: 6520 7365 7276 6963 650a 2020 2020 2020  e service.      
+0000dd20: 2020 2020 2020 2020 2020 746f 2063 7265            to cre
+0000dd30: 6174 6520 7468 6520 636f 6e6e 6563 7469  ate the connecti
+0000dd40: 6f6e 2066 6f72 2079 6f75 2069 6620 796f  on for you if yo
+0000dd50: 7520 6e65 6564 2069 742e 2049 6620 7468  u need it. If th
+0000dd60: 6973 2070 6172 616d 6574 6572 2069 730a  is parameter is.
+0000dd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dd80: 6e6f 7420 7072 6f76 6964 6564 2074 6865  not provided the
+0000dd90: 6e20 7468 6520 4269 6751 7565 7279 2063  n the BigQuery c
+0000dda0: 6f6e 6e65 6374 696f 6e20 6672 6f6d 2074  onnection from t
+0000ddb0: 6865 2073 6573 7369 6f6e 2069 7320 7573  he session is us
+0000ddc0: 6564 2e0a 2020 2020 2020 2020 2020 2020  ed..            
+0000ddd0: 7265 7573 6520 2862 6f6f 6c2c 204f 7074  reuse (bool, Opt
+0000dde0: 696f 6e61 6c29 3a0a 2020 2020 2020 2020  ional):.        
+0000ddf0: 2020 2020 2020 2020 5265 7573 6520 7468          Reuse th
+0000de00: 6520 7265 6d6f 7465 2066 756e 6374 696f  e remote functio
+0000de10: 6e20 6966 2061 6c72 6561 6479 2065 7869  n if already exi
+0000de20: 7374 732e 0a20 2020 2020 2020 2020 2020  sts..           
+0000de30: 2020 2020 2060 5472 7565 6020 6279 2064       `True` by d
+0000de40: 6566 6175 6c74 2c20 7768 6963 6820 7769  efault, which wi
+0000de50: 6c6c 2072 6573 756c 7420 696e 2072 6575  ll result in reu
+0000de60: 7369 6e67 2061 6e20 6578 6973 7469 6e67  sing an existing
+0000de70: 2072 656d 6f74 650a 2020 2020 2020 2020   remote.        
+0000de80: 2020 2020 2020 2020 6675 6e63 7469 6f6e          function
+0000de90: 2061 6e64 2063 6f72 7265 7370 6f6e 6469   and correspondi
+0000dea0: 6e67 2063 6c6f 7564 2066 756e 6374 696f  ng cloud functio
+0000deb0: 6e20 2869 6620 616e 7929 2074 6861 7420  n (if any) that 
+0000dec0: 7761 730a 2020 2020 2020 2020 2020 2020  was.            
+0000ded0: 2020 2020 7072 6576 696f 7573 6c79 2063      previously c
+0000dee0: 7265 6174 6564 2066 6f72 2074 6865 2073  reated for the s
+0000def0: 616d 6520 7564 662e 0a20 2020 2020 2020  ame udf..       
+0000df00: 2020 2020 2020 2020 2053 6574 7469 6e67           Setting
+0000df10: 2069 7420 746f 2060 4661 6c73 6560 2077   it to `False` w
+0000df20: 6f75 6c64 2066 6f72 6365 2063 7265 6174  ould force creat
+0000df30: 696e 6720 6120 756e 6971 7565 2072 656d  ing a unique rem
+0000df40: 6f74 6520 6675 6e63 7469 6f6e 2e0a 2020  ote function..  
+0000df50: 2020 2020 2020 2020 2020 2020 2020 4966                If
+0000df60: 2074 6865 2072 6571 7569 7265 6420 7265   the required re
+0000df70: 6d6f 7465 2066 756e 6374 696f 6e20 646f  mote function do
+0000df80: 6573 206e 6f74 2065 7869 7374 2074 6865  es not exist the
+0000df90: 6e20 6974 2077 6f75 6c64 2062 650a 2020  n it would be.  
+0000dfa0: 2020 2020 2020 2020 2020 2020 2020 6372                cr
+0000dfb0: 6561 7465 6420 6972 7265 7370 6563 7469  eated irrespecti
+0000dfc0: 7665 206f 6620 7468 6973 2070 6172 616d  ve of this param
+0000dfd0: 2e0a 2020 2020 2020 2020 2020 2020 6e61  ..            na
+0000dfe0: 6d65 2028 7374 722c 204f 7074 696f 6e61  me (str, Optiona
+0000dff0: 6c29 3a0a 2020 2020 2020 2020 2020 2020  l):.            
+0000e000: 2020 2020 4578 706c 6963 6974 206e 616d      Explicit nam
+0000e010: 6520 6f66 2074 6865 2070 6572 7369 7374  e of the persist
+0000e020: 6564 2042 6967 5175 6572 7920 7265 6d6f  ed BigQuery remo
+0000e030: 7465 2066 756e 6374 696f 6e2e 2055 7365  te function. Use
+0000e040: 2069 7420 7769 7468 0a20 2020 2020 2020   it with.       
+0000e050: 2020 2020 2020 2020 2063 6175 7469 6f6e           caution
+0000e060: 2c20 6265 6361 7573 6520 7477 6f20 7573  , because two us
+0000e070: 6572 7320 776f 726b 696e 6720 696e 2074  ers working in t
+0000e080: 6865 2073 616d 6520 7072 6f6a 6563 7420  he same project 
+0000e090: 616e 6420 6461 7461 7365 740a 2020 2020  and dataset.    
+0000e0a0: 2020 2020 2020 2020 2020 2020 636f 756c              coul
+0000e0b0: 6420 6f76 6572 7772 6974 6520 6561 6368  d overwrite each
+0000e0c0: 206f 7468 6572 2773 2072 656d 6f74 6520   other's remote 
+0000e0d0: 6675 6e63 7469 6f6e 7320 6966 2074 6865  functions if the
+0000e0e0: 7920 7573 6520 7468 6520 7361 6d65 0a20  y use the same. 
+0000e0f0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0000e100: 6572 7369 7374 656e 7420 6e61 6d65 2e0a  ersistent name..
+0000e110: 2020 2020 2020 2020 2020 2020 7061 636b              pack
+0000e120: 6167 6573 2028 7374 725b 5d2c 204f 7074  ages (str[], Opt
+0000e130: 696f 6e61 6c29 3a0a 2020 2020 2020 2020  ional):.        
+0000e140: 2020 2020 2020 2020 4578 706c 6963 6974          Explicit
+0000e150: 206e 616d 6520 6f66 2074 6865 2065 7874   name of the ext
+0000e160: 6572 6e61 6c20 7061 636b 6167 6520 6465  ernal package de
+0000e170: 7065 6e64 656e 6369 6573 2e20 4561 6368  pendencies. Each
+0000e180: 2064 6570 656e 6465 6e63 790a 2020 2020   dependency.    
+0000e190: 2020 2020 2020 2020 2020 2020 6973 2061              is a
+0000e1a0: 6464 6564 2074 6f20 7468 6520 6072 6571  dded to the `req
+0000e1b0: 7569 7265 6d65 6e74 732e 7478 7460 2061  uirements.txt` a
+0000e1c0: 7320 6973 2c20 616e 6420 6361 6e20 6265  s is, and can be
+0000e1d0: 206f 6620 7468 6520 666f 726d 0a20 2020   of the form.   
+0000e1e0: 2020 2020 2020 2020 2020 2020 2073 7570               sup
+0000e1f0: 706f 7274 6564 2069 6e20 6874 7470 733a  ported in https:
+0000e200: 2f2f 7069 702e 7079 7061 2e69 6f2f 656e  //pip.pypa.io/en
+0000e210: 2f73 7461 626c 652f 7265 6665 7265 6e63  /stable/referenc
+0000e220: 652f 7265 7175 6972 656d 656e 7473 2d66  e/requirements-f
+0000e230: 696c 652d 666f 726d 6174 2f2e 0a20 2020  ile-format/..   
+0000e240: 2020 2020 2020 2020 2063 6c6f 7564 5f66           cloud_f
+0000e250: 756e 6374 696f 6e5f 7365 7276 6963 655f  unction_service_
+0000e260: 6163 636f 756e 7420 2873 7472 2c20 4f70  account (str, Op
+0000e270: 7469 6f6e 616c 293a 0a20 2020 2020 2020  tional):.       
+0000e280: 2020 2020 2020 2020 2053 6572 7669 6365           Service
+0000e290: 2061 6363 6f75 6e74 2074 6f20 7573 6520   account to use 
+0000e2a0: 666f 7220 7468 6520 636c 6f75 6420 6675  for the cloud fu
+0000e2b0: 6e63 7469 6f6e 732e 2049 6620 6e6f 7420  nctions. If not 
+0000e2c0: 7072 6f76 6964 6564 0a20 2020 2020 2020  provided.       
+0000e2d0: 2020 2020 2020 2020 2074 6865 6e20 7468           then th
+0000e2e0: 6520 6465 6661 756c 7420 7365 7276 6963  e default servic
+0000e2f0: 6520 6163 636f 756e 7420 776f 756c 6420  e account would 
+0000e300: 6265 2075 7365 642e 2053 6565 0a20 2020  be used. See.   
+0000e310: 2020 2020 2020 2020 2020 2020 2068 7474               htt
+0000e320: 7073 3a2f 2f63 6c6f 7564 2e67 6f6f 676c  ps://cloud.googl
+0000e330: 652e 636f 6d2f 6675 6e63 7469 6f6e 732f  e.com/functions/
+0000e340: 646f 6373 2f73 6563 7572 696e 672f 6675  docs/securing/fu
+0000e350: 6e63 7469 6f6e 2d69 6465 6e74 6974 790a  nction-identity.
+0000e360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e370: 666f 7220 6d6f 7265 2064 6574 6169 6c73  for more details
+0000e380: 2e20 506c 6561 7365 206d 616b 6520 7375  . Please make su
+0000e390: 7265 2074 6865 2073 6572 7669 6365 2061  re the service a
+0000e3a0: 6363 6f75 6e74 2068 6173 2074 6865 0a20  ccount has the. 
+0000e3b0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+0000e3c0: 6563 6573 7361 7279 2049 414d 2070 6572  ecessary IAM per
+0000e3d0: 6d69 7373 696f 6e73 2063 6f6e 6669 6775  missions configu
+0000e3e0: 7265 6420 6173 2064 6573 6372 6962 6564  red as described
+0000e3f0: 2069 6e0a 2020 2020 2020 2020 2020 2020   in.            
+0000e400: 2020 2020 6874 7470 733a 2f2f 636c 6f75      https://clou
+0000e410: 642e 676f 6f67 6c65 2e63 6f6d 2f66 756e  d.google.com/fun
+0000e420: 6374 696f 6e73 2f64 6f63 732f 7265 6665  ctions/docs/refe
+0000e430: 7265 6e63 652f 6961 6d2f 726f 6c65 7323  rence/iam/roles#
+0000e440: 6164 6469 7469 6f6e 616c 2d63 6f6e 6669  additional-confi
+0000e450: 6775 7261 7469 6f6e 2e0a 2020 2020 2020  guration..      
+0000e460: 2020 2020 2020 636c 6f75 645f 6675 6e63        cloud_func
+0000e470: 7469 6f6e 5f6b 6d73 5f6b 6579 5f6e 616d  tion_kms_key_nam
+0000e480: 6520 2873 7472 2c20 4f70 7469 6f6e 616c  e (str, Optional
+0000e490: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0000e4a0: 2020 2043 7573 746f 6d65 7220 6d61 6e61     Customer mana
+0000e4b0: 6765 6420 656e 6372 7970 7469 6f6e 206b  ged encryption k
+0000e4c0: 6579 2074 6f20 7072 6f74 6563 7420 636c  ey to protect cl
+0000e4d0: 6f75 6420 6675 6e63 7469 6f6e 7320 616e  oud functions an
+0000e4e0: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
+0000e4f0: 2020 7265 6c61 7465 6420 6461 7461 2061    related data a
+0000e500: 7420 7265 7374 2e20 5468 6973 2069 7320  t rest. This is 
+0000e510: 6f66 2074 6865 2066 6f72 6d61 740a 2020  of the format.  
+0000e520: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+0000e530: 6f6a 6563 7473 2f50 524f 4a45 4354 5f49  ojects/PROJECT_I
+0000e540: 442f 6c6f 6361 7469 6f6e 732f 4c4f 4341  D/locations/LOCA
+0000e550: 5449 4f4e 2f6b 6579 5269 6e67 732f 4b45  TION/keyRings/KE
+0000e560: 5952 494e 472f 6372 7970 746f 4b65 7973  YRING/cryptoKeys
+0000e570: 2f4b 4559 2e0a 2020 2020 2020 2020 2020  /KEY..          
+0000e580: 2020 2020 2020 5265 6164 2068 7474 7073        Read https
+0000e590: 3a2f 2f63 6c6f 7564 2e67 6f6f 676c 652e  ://cloud.google.
+0000e5a0: 636f 6d2f 6675 6e63 7469 6f6e 732f 646f  com/functions/do
+0000e5b0: 6373 2f73 6563 7572 696e 672f 636d 656b  cs/securing/cmek
+0000e5c0: 2066 6f72 0a20 2020 2020 2020 2020 2020   for.           
+0000e5d0: 2020 2020 206d 6f72 6520 6465 7461 696c       more detail
+0000e5e0: 7320 696e 636c 7564 696e 6720 6772 616e  s including gran
+0000e5f0: 7469 6e67 206e 6563 6573 7361 7279 2073  ting necessary s
+0000e600: 6572 7669 6365 2061 6363 6f75 6e74 730a  ervice accounts.
+0000e610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e620: 6163 6365 7373 2074 6f20 7468 6520 6b65  access to the ke
+0000e630: 792e 0a20 2020 2020 2020 2020 2020 2063  y..            c
+0000e640: 6c6f 7564 5f66 756e 6374 696f 6e5f 646f  loud_function_do
+0000e650: 636b 6572 5f72 6570 6f73 6974 6f72 7920  cker_repository 
+0000e660: 2873 7472 2c20 4f70 7469 6f6e 616c 293a  (str, Optional):
+0000e670: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000e680: 2044 6f63 6b65 7220 7265 706f 7369 746f   Docker reposito
+0000e690: 7279 2063 7265 6174 6564 2077 6974 6820  ry created with 
+0000e6a0: 7468 6520 7361 6d65 2065 6e63 7279 7074  the same encrypt
+0000e6b0: 696f 6e20 6b65 7920 6173 0a20 2020 2020  ion key as.     
+0000e6c0: 2020 2020 2020 2020 2020 2060 636c 6f75             `clou
+0000e6d0: 645f 6675 6e63 7469 6f6e 5f6b 6d73 5f6b  d_function_kms_k
+0000e6e0: 6579 5f6e 616d 6560 2074 6f20 7374 6f72  ey_name` to stor
+0000e6f0: 6520 656e 6372 7970 7465 6420 6172 7469  e encrypted arti
+0000e700: 6661 6374 730a 2020 2020 2020 2020 2020  facts.          
+0000e710: 2020 2020 2020 6372 6561 7465 6420 746f        created to
+0000e720: 2073 7570 706f 7274 2074 6865 2063 6c6f   support the clo
+0000e730: 7564 2066 756e 6374 696f 6e2e 2054 6869  ud function. Thi
+0000e740: 7320 6973 206f 6620 7468 6520 666f 726d  s is of the form
+0000e750: 6174 0a20 2020 2020 2020 2020 2020 2020  at.             
+0000e760: 2020 2070 726f 6a65 6374 732f 5052 4f4a     projects/PROJ
+0000e770: 4543 545f 4944 2f6c 6f63 6174 696f 6e73  ECT_ID/locations
+0000e780: 2f4c 4f43 4154 494f 4e2f 7265 706f 7369  /LOCATION/reposi
+0000e790: 746f 7269 6573 2f52 4550 4f53 4954 4f52  tories/REPOSITOR
+0000e7a0: 595f 4e41 4d45 2e0a 2020 2020 2020 2020  Y_NAME..        
+0000e7b0: 2020 2020 2020 2020 466f 7220 6d6f 7265          For more
+0000e7c0: 2064 6574 6169 6c73 2073 6565 0a20 2020   details see.   
+0000e7d0: 2020 2020 2020 2020 2020 2020 2068 7474               htt
+0000e7e0: 7073 3a2f 2f63 6c6f 7564 2e67 6f6f 676c  ps://cloud.googl
+0000e7f0: 652e 636f 6d2f 6675 6e63 7469 6f6e 732f  e.com/functions/
+0000e800: 646f 6373 2f73 6563 7572 696e 672f 636d  docs/securing/cm
+0000e810: 656b 2362 6566 6f72 655f 796f 755f 6265  ek#before_you_be
+0000e820: 6769 6e2e 0a20 2020 2020 2020 2020 2020  gin..           
+0000e830: 206d 6178 5f62 6174 6368 696e 675f 726f   max_batching_ro
+0000e840: 7773 2028 696e 742c 204f 7074 696f 6e61  ws (int, Optiona
+0000e850: 6c29 3a0a 2020 2020 2020 2020 2020 2020  l):.            
+0000e860: 2020 2020 5468 6520 6d61 7869 6d75 6d20      The maximum 
+0000e870: 6e75 6d62 6572 206f 6620 726f 7773 2074  number of rows t
+0000e880: 6f20 6265 2062 6174 6368 6564 2066 6f72  o be batched for
+0000e890: 2070 726f 6365 7373 696e 6720 696e 2074   processing in t
+0000e8a0: 6865 0a20 2020 2020 2020 2020 2020 2020  he.             
+0000e8b0: 2020 2042 5120 7265 6d6f 7465 2066 756e     BQ remote fun
+0000e8c0: 6374 696f 6e2e 2044 6566 6175 6c74 2076  ction. Default v
+0000e8d0: 616c 7565 2069 7320 3130 3030 2e20 4120  alue is 1000. A 
+0000e8e0: 6c6f 7765 7220 6e75 6d62 6572 2063 616e  lower number can
+0000e8f0: 2062 650a 2020 2020 2020 2020 2020 2020   be.            
+0000e900: 2020 2020 7061 7373 6564 2074 6f20 6176      passed to av
+0000e910: 6f69 6420 7469 6d65 6f75 7473 2069 6e20  oid timeouts in 
+0000e920: 6361 7365 2074 6865 2075 7365 7220 636f  case the user co
+0000e930: 6465 2069 7320 746f 6f20 636f 6d70 6c65  de is too comple
+0000e940: 7820 746f 0a20 2020 2020 2020 2020 2020  x to.           
+0000e950: 2020 2020 2070 726f 6365 7373 206c 6172       process lar
+0000e960: 6765 206e 756d 6265 7220 6f66 2072 6f77  ge number of row
+0000e970: 7320 6661 7374 2065 6e6f 7567 682e 2041  s fast enough. A
+0000e980: 2068 6967 6865 7220 6e75 6d62 6572 2063   higher number c
+0000e990: 616e 2062 650a 2020 2020 2020 2020 2020  an be.          
+0000e9a0: 2020 2020 2020 7573 6564 2074 6f20 696e        used to in
+0000e9b0: 6372 6561 7365 2074 6872 6f75 6768 7075  crease throughpu
+0000e9c0: 7420 696e 2063 6173 6520 7468 6520 7573  t in case the us
+0000e9d0: 6572 2063 6f64 6520 6973 2066 6173 7420  er code is fast 
+0000e9e0: 656e 6f75 6768 2e0a 2020 2020 2020 2020  enough..        
+0000e9f0: 2020 2020 2020 2020 604e 6f6e 6560 2063          `None` c
+0000ea00: 616e 2062 6520 7061 7373 6564 2074 6f20  an be passed to 
+0000ea10: 6c65 7420 4251 2072 656d 6f74 6520 6675  let BQ remote fu
+0000ea20: 6e63 7469 6f6e 7320 7365 7276 6963 6520  nctions service 
+0000ea30: 6170 706c 790a 2020 2020 2020 2020 2020  apply.          
+0000ea40: 2020 2020 2020 6465 6661 756c 7420 6261        default ba
+0000ea50: 7463 6869 6e67 2e20 5365 6520 666f 7220  tching. See for 
+0000ea60: 6d6f 7265 2064 6574 6169 6c73 0a20 2020  more details.   
+0000ea70: 2020 2020 2020 2020 2020 2020 2068 7474               htt
+0000ea80: 7073 3a2f 2f63 6c6f 7564 2e67 6f6f 676c  ps://cloud.googl
+0000ea90: 652e 636f 6d2f 6269 6771 7565 7279 2f64  e.com/bigquery/d
+0000eaa0: 6f63 732f 7265 6d6f 7465 2d66 756e 6374  ocs/remote-funct
+0000eab0: 696f 6e73 236c 696d 6974 696e 675f 6e75  ions#limiting_nu
+0000eac0: 6d62 6572 5f6f 665f 726f 7773 5f69 6e5f  mber_of_rows_in_
+0000ead0: 615f 6261 7463 685f 7265 7175 6573 742e  a_batch_request.
+0000eae0: 0a20 2020 2020 2020 2020 2020 2063 6c6f  .            clo
+0000eaf0: 7564 5f66 756e 6374 696f 6e5f 7469 6d65  ud_function_time
+0000eb00: 6f75 7420 2869 6e74 2c20 4f70 7469 6f6e  out (int, Option
+0000eb10: 616c 293a 0a20 2020 2020 2020 2020 2020  al):.           
+0000eb20: 2020 2020 2054 6865 206d 6178 696d 756d       The maximum
+0000eb30: 2061 6d6f 756e 7420 6f66 2074 696d 6520   amount of time 
+0000eb40: 2869 6e20 7365 636f 6e64 7329 2042 6967  (in seconds) Big
+0000eb50: 5175 6572 7920 7368 6f75 6c64 2077 6169  Query should wai
+0000eb60: 7420 666f 720a 2020 2020 2020 2020 2020  t for.          
+0000eb70: 2020 2020 2020 7468 6520 636c 6f75 6420        the cloud 
+0000eb80: 6675 6e63 7469 6f6e 2074 6f20 7265 7475  function to retu
+0000eb90: 726e 2061 2072 6573 706f 6e73 652e 2053  rn a response. S
+0000eba0: 6565 2066 6f72 206d 6f72 6520 6465 7461  ee for more deta
+0000ebb0: 696c 730a 2020 2020 2020 2020 2020 2020  ils.            
+0000ebc0: 2020 2020 6874 7470 733a 2f2f 636c 6f75      https://clou
+0000ebd0: 642e 676f 6f67 6c65 2e63 6f6d 2f66 756e  d.google.com/fun
+0000ebe0: 6374 696f 6e73 2f64 6f63 732f 636f 6e66  ctions/docs/conf
+0000ebf0: 6967 7572 696e 672f 7469 6d65 6f75 742e  iguring/timeout.
+0000ec00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ec10: 2050 6c65 6173 6520 6e6f 7465 2074 6861   Please note tha
+0000ec20: 7420 6576 656e 2074 686f 7567 6820 7468  t even though th
+0000ec30: 6520 636c 6f75 6420 6675 6e63 7469 6f6e  e cloud function
+0000ec40: 2028 326e 6420 6765 6e29 2069 7473 656c   (2nd gen) itsel
+0000ec50: 660a 2020 2020 2020 2020 2020 2020 2020  f.              
+0000ec60: 2020 616c 6c6f 7773 2073 6565 7469 6e67    allows seeting
+0000ec70: 2075 7020 746f 2036 3020 6d69 6e75 7465   up to 60 minute
+0000ec80: 7320 6f66 2074 696d 656f 7574 2c20 4269  s of timeout, Bi
+0000ec90: 6751 7565 7279 2072 656d 6f74 650a 2020  gQuery remote.  
+0000eca0: 2020 2020 2020 2020 2020 2020 2020 6675                fu
+0000ecb0: 6e63 7469 6f6e 2063 616e 2077 6169 7420  nction can wait 
+0000ecc0: 6f6e 6c79 2075 7020 746f 2032 3020 6d69  only up to 20 mi
+0000ecd0: 6e75 7465 732c 2073 6565 2066 6f72 206d  nutes, see for m
+0000ece0: 6f72 6520 6465 7461 696c 730a 2020 2020  ore details.    
+0000ecf0: 2020 2020 2020 2020 2020 2020 6874 7470              http
+0000ed00: 733a 2f2f 636c 6f75 642e 676f 6f67 6c65  s://cloud.google
+0000ed10: 2e63 6f6d 2f62 6967 7175 6572 792f 7175  .com/bigquery/qu
+0000ed20: 6f74 6173 2372 656d 6f74 655f 6675 6e63  otas#remote_func
+0000ed30: 7469 6f6e 5f6c 696d 6974 732e 0a20 2020  tion_limits..   
+0000ed40: 2020 2020 2020 2020 2020 2020 2042 7920               By 
+0000ed50: 6465 6661 756c 7420 4269 6751 7565 7279  default BigQuery
+0000ed60: 2044 6174 6146 7261 6d65 7320 7573 6573   DataFrames uses
+0000ed70: 2061 2031 3020 6d69 6e75 7465 2074 696d   a 10 minute tim
+0000ed80: 656f 7574 2e20 604e 6f6e 6560 0a20 2020  eout. `None`.   
+0000ed90: 2020 2020 2020 2020 2020 2020 2063 616e               can
+0000eda0: 2062 6520 7061 7373 6564 2074 6f20 6c65   be passed to le
+0000edb0: 7420 7468 6520 636c 6f75 6420 6675 6e63  t the cloud func
+0000edc0: 7469 6f6e 7320 6465 6661 756c 7420 7469  tions default ti
+0000edd0: 6d65 6f75 7420 7461 6b65 2065 6666 6563  meout take effec
+0000ede0: 742e 0a20 2020 2020 2020 2020 2020 2063  t..            c
+0000edf0: 6c6f 7564 5f66 756e 6374 696f 6e5f 6d61  loud_function_ma
+0000ee00: 785f 696e 7374 616e 6365 7320 2869 6e74  x_instances (int
+0000ee10: 2c20 4f70 7469 6f6e 616c 293a 0a20 2020  , Optional):.   
+0000ee20: 2020 2020 2020 2020 2020 2020 2054 6865               The
+0000ee30: 206d 6178 696d 756d 6d20 696e 7374 616e   maximumm instan
+0000ee40: 6365 2063 6f75 6e74 2066 6f72 2074 6865  ce count for the
+0000ee50: 2063 6c6f 7564 2066 756e 6374 696f 6e20   cloud function 
+0000ee60: 6372 6561 7465 642e 2054 6869 730a 2020  created. This.  
+0000ee70: 2020 2020 2020 2020 2020 2020 2020 6361                ca
+0000ee80: 6e20 6265 2075 7365 6420 746f 2063 6f6e  n be used to con
+0000ee90: 7472 6f6c 2068 6f77 206d 616e 7920 636c  trol how many cl
+0000eea0: 6f75 6420 6675 6e63 7469 6f6e 2069 6e73  oud function ins
+0000eeb0: 7461 6e63 6573 2063 616e 2062 650a 2020  tances can be.  
+0000eec0: 2020 2020 2020 2020 2020 2020 2020 6163                ac
+0000eed0: 7469 7665 2061 7420 6d61 7820 6174 2061  tive at max at a
+0000eee0: 6e79 2067 6976 656e 2070 6f69 6e74 206f  ny given point o
+0000eef0: 6620 7469 6d65 2e20 4c6f 7765 7220 7365  f time. Lower se
+0000ef00: 7474 696e 6720 6361 6e20 6865 6c70 0a20  tting can help. 
+0000ef10: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0000ef20: 6f6e 7472 6f6c 2074 6865 2073 7069 6b65  ontrol the spike
+0000ef30: 2069 6e20 7468 6520 6269 6c6c 696e 672e   in the billing.
+0000ef40: 2048 6967 6865 7220 7365 7474 696e 6720   Higher setting 
+0000ef50: 6361 6e20 6865 6c70 0a20 2020 2020 2020  can help.       
+0000ef60: 2020 2020 2020 2020 2073 7570 706f 7274           support
+0000ef70: 2070 726f 6365 7373 696e 6720 6c61 7267   processing larg
+0000ef80: 6572 2073 6361 6c65 2064 6174 612e 2057  er scale data. W
+0000ef90: 6865 6e20 6e6f 7420 7370 6563 6966 6965  hen not specifie
+0000efa0: 642c 2063 6c6f 7564 0a20 2020 2020 2020  d, cloud.       
+0000efb0: 2020 2020 2020 2020 2066 756e 6374 696f           functio
+0000efc0: 6e27 7320 6465 6661 756c 7420 7365 7474  n's default sett
+0000efd0: 696e 6720 6170 706c 6965 732e 2046 6f72  ing applies. For
+0000efe0: 206d 6f72 6520 6465 7461 696c 7320 7365   more details se
+0000eff0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+0000f000: 2020 6874 7470 733a 2f2f 636c 6f75 642e    https://cloud.
+0000f010: 676f 6f67 6c65 2e63 6f6d 2f66 756e 6374  google.com/funct
+0000f020: 696f 6e73 2f64 6f63 732f 636f 6e66 6967  ions/docs/config
+0000f030: 7572 696e 672f 6d61 782d 696e 7374 616e  uring/max-instan
+0000f040: 6365 732e 0a20 2020 2020 2020 2020 2020  ces..           
+0000f050: 2063 6c6f 7564 5f66 756e 6374 696f 6e5f   cloud_function_
+0000f060: 7670 635f 636f 6e6e 6563 746f 7220 2873  vpc_connector (s
+0000f070: 7472 2c20 4f70 7469 6f6e 616c 293a 0a20  tr, Optional):. 
+0000f080: 2020 2020 2020 2020 2020 2020 2020 2054                 T
+0000f090: 6865 2056 5043 2063 6f6e 6e65 6374 6f72  he VPC connector
+0000f0a0: 2079 6f75 2077 6f75 6c64 206c 696b 6520   you would like 
+0000f0b0: 746f 2063 6f6e 6669 6775 7265 2066 6f72  to configure for
+0000f0c0: 2079 6f75 7220 636c 6f75 640a 2020 2020   your cloud.    
+0000f0d0: 2020 2020 2020 2020 2020 2020 6675 6e63              func
+0000f0e0: 7469 6f6e 2e20 5468 6973 2069 7320 7573  tion. This is us
+0000f0f0: 6566 756c 2069 6620 796f 7572 2063 6f64  eful if your cod
+0000f100: 6520 6e65 6564 7320 6163 6365 7373 2074  e needs access t
+0000f110: 6f20 6461 7461 206f 720a 2020 2020 2020  o data or.      
+0000f120: 2020 2020 2020 2020 2020 7365 7276 6963            servic
+0000f130: 6528 7329 2074 6861 7420 6172 6520 6f6e  e(s) that are on
+0000f140: 2061 2056 5043 206e 6574 776f 726b 2e20   a VPC network. 
+0000f150: 5365 6520 666f 7220 6d6f 7265 2064 6574  See for more det
+0000f160: 6169 6c73 0a20 2020 2020 2020 2020 2020  ails.           
+0000f170: 2020 2020 2068 7474 7073 3a2f 2f63 6c6f       https://clo
+0000f180: 7564 2e67 6f6f 676c 652e 636f 6d2f 6675  ud.google.com/fu
+0000f190: 6e63 7469 6f6e 732f 646f 6373 2f6e 6574  nctions/docs/net
+0000f1a0: 776f 726b 696e 672f 636f 6e6e 6563 7469  working/connecti
+0000f1b0: 6e67 2d76 7063 2e0a 2020 2020 2020 2020  ng-vpc..        
+0000f1c0: 5265 7475 726e 733a 0a20 2020 2020 2020  Returns:.       
+0000f1d0: 2020 2020 2063 616c 6c61 626c 653a 2041       callable: A
+0000f1e0: 2072 656d 6f74 6520 6675 6e63 7469 6f6e   remote function
+0000f1f0: 206f 626a 6563 7420 706f 696e 7469 6e67   object pointing
+0000f200: 2074 6f20 7468 6520 636c 6f75 6420 6173   to the cloud as
+0000f210: 7365 7473 2063 7265 6174 6564 0a20 2020  sets created.   
+0000f220: 2020 2020 2020 2020 2069 6e20 7468 6520           in the 
+0000f230: 6261 636b 6772 6f75 6e64 2074 6f20 7375  background to su
+0000f240: 7070 6f72 7420 7468 6520 7265 6d6f 7465  pport the remote
+0000f250: 2065 7865 6375 7469 6f6e 2e20 5468 6520   execution. The 
+0000f260: 636c 6f75 6420 6173 7365 7473 2063 616e  cloud assets can
+0000f270: 2062 650a 2020 2020 2020 2020 2020 2020   be.            
+0000f280: 6c6f 6361 7465 6420 7468 726f 7567 6820  located through 
+0000f290: 7468 6520 666f 6c6c 6f77 696e 6720 7072  the following pr
+0000f2a0: 6f70 6572 7469 6573 2073 6574 2069 6e20  operties set in 
+0000f2b0: 7468 6520 6f62 6a65 6374 3a0a 0a20 2020  the object:..   
+0000f2c0: 2020 2020 2020 2020 2060 6269 6766 7261           `bigfra
+0000f2d0: 6d65 735f 636c 6f75 645f 6675 6e63 7469  mes_cloud_functi
+0000f2e0: 6f6e 6020 2d20 5468 6520 676f 6f67 6c65  on` - The google
+0000f2f0: 2063 6c6f 7564 2066 756e 6374 696f 6e20   cloud function 
+0000f300: 6465 706c 6f79 6564 2066 6f72 2074 6865  deployed for the
+0000f310: 2075 7365 7220 6465 6669 6e65 6420 636f   user defined co
+0000f320: 6465 2e0a 0a20 2020 2020 2020 2020 2020  de...           
+0000f330: 2060 6269 6766 7261 6d65 735f 7265 6d6f   `bigframes_remo
+0000f340: 7465 5f66 756e 6374 696f 6e60 202d 2054  te_function` - T
+0000f350: 6865 2062 6967 7175 6572 7920 7265 6d6f  he bigquery remo
+0000f360: 7465 2066 756e 6374 696f 6e20 6361 7061  te function capa
+0000f370: 626c 6520 6f66 2063 616c 6c69 6e67 2069  ble of calling i
+0000f380: 6e74 6f20 6062 6967 6672 616d 6573 5f63  nto `bigframes_c
+0000f390: 6c6f 7564 5f66 756e 6374 696f 6e60 2e0a  loud_function`..
+0000f3a0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0000f3b0: 2020 2020 7265 7475 726e 2062 6967 6672      return bigfr
+0000f3c0: 616d 6573 5f72 6628 0a20 2020 2020 2020  ames_rf(.       
+0000f3d0: 2020 2020 2069 6e70 7574 5f74 7970 6573       input_types
+0000f3e0: 2c0a 2020 2020 2020 2020 2020 2020 6f75  ,.            ou
+0000f3f0: 7470 7574 5f74 7970 652c 0a20 2020 2020  tput_type,.     
+0000f400: 2020 2020 2020 2073 6573 7369 6f6e 3d73         session=s
+0000f410: 656c 662c 0a20 2020 2020 2020 2020 2020  elf,.           
+0000f420: 2064 6174 6173 6574 3d64 6174 6173 6574   dataset=dataset
+0000f430: 2c0a 2020 2020 2020 2020 2020 2020 6269  ,.            bi
+0000f440: 6771 7565 7279 5f63 6f6e 6e65 6374 696f  gquery_connectio
+0000f450: 6e3d 6269 6771 7565 7279 5f63 6f6e 6e65  n=bigquery_conne
+0000f460: 6374 696f 6e2c 0a20 2020 2020 2020 2020  ction,.         
+0000f470: 2020 2072 6575 7365 3d72 6575 7365 2c0a     reuse=reuse,.
+0000f480: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+0000f490: 3d6e 616d 652c 0a20 2020 2020 2020 2020  =name,.         
+0000f4a0: 2020 2070 6163 6b61 6765 733d 7061 636b     packages=pack
+0000f4b0: 6167 6573 2c0a 2020 2020 2020 2020 2020  ages,.          
+0000f4c0: 2020 636c 6f75 645f 6675 6e63 7469 6f6e    cloud_function
+0000f4d0: 5f73 6572 7669 6365 5f61 6363 6f75 6e74  _service_account
+0000f4e0: 3d63 6c6f 7564 5f66 756e 6374 696f 6e5f  =cloud_function_
+0000f4f0: 7365 7276 6963 655f 6163 636f 756e 742c  service_account,
+0000f500: 0a20 2020 2020 2020 2020 2020 2063 6c6f  .            clo
+0000f510: 7564 5f66 756e 6374 696f 6e5f 6b6d 735f  ud_function_kms_
+0000f520: 6b65 795f 6e61 6d65 3d63 6c6f 7564 5f66  key_name=cloud_f
+0000f530: 756e 6374 696f 6e5f 6b6d 735f 6b65 795f  unction_kms_key_
+0000f540: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
+0000f550: 2020 636c 6f75 645f 6675 6e63 7469 6f6e    cloud_function
+0000f560: 5f64 6f63 6b65 725f 7265 706f 7369 746f  _docker_reposito
+0000f570: 7279 3d63 6c6f 7564 5f66 756e 6374 696f  ry=cloud_functio
+0000f580: 6e5f 646f 636b 6572 5f72 6570 6f73 6974  n_docker_reposit
+0000f590: 6f72 792c 0a20 2020 2020 2020 2020 2020  ory,.           
+0000f5a0: 206d 6178 5f62 6174 6368 696e 675f 726f   max_batching_ro
+0000f5b0: 7773 3d6d 6178 5f62 6174 6368 696e 675f  ws=max_batching_
+0000f5c0: 726f 7773 2c0a 2020 2020 2020 2020 2020  rows,.          
+0000f5d0: 2020 636c 6f75 645f 6675 6e63 7469 6f6e    cloud_function
+0000f5e0: 5f74 696d 656f 7574 3d63 6c6f 7564 5f66  _timeout=cloud_f
+0000f5f0: 756e 6374 696f 6e5f 7469 6d65 6f75 742c  unction_timeout,
+0000f600: 0a20 2020 2020 2020 2020 2020 2063 6c6f  .            clo
+0000f610: 7564 5f66 756e 6374 696f 6e5f 6d61 785f  ud_function_max_
+0000f620: 696e 7374 616e 6365 733d 636c 6f75 645f  instances=cloud_
+0000f630: 6675 6e63 7469 6f6e 5f6d 6178 5f69 6e73  function_max_ins
+0000f640: 7461 6e63 6573 2c0a 2020 2020 2020 2020  tances,.        
+0000f650: 2020 2020 636c 6f75 645f 6675 6e63 7469      cloud_functi
+0000f660: 6f6e 5f76 7063 5f63 6f6e 6e65 6374 6f72  on_vpc_connector
+0000f670: 3d63 6c6f 7564 5f66 756e 6374 696f 6e5f  =cloud_function_
+0000f680: 7670 635f 636f 6e6e 6563 746f 722c 0a20  vpc_connector,. 
+0000f690: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
+0000f6a0: 6620 7265 6164 5f67 6271 5f66 756e 6374  f read_gbq_funct
+0000f6b0: 696f 6e28 0a20 2020 2020 2020 2073 656c  ion(.        sel
+0000f6c0: 662c 0a20 2020 2020 2020 2066 756e 6374  f,.        funct
+0000f6d0: 696f 6e5f 6e61 6d65 3a20 7374 722c 0a20  ion_name: str,. 
+0000f6e0: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
+0000f6f0: 224c 6f61 6473 2061 2042 6967 5175 6572  "Loads a BigQuer
+0000f700: 7920 6675 6e63 7469 6f6e 2066 726f 6d20  y function from 
+0000f710: 4269 6751 7565 7279 2e0a 0a20 2020 2020  BigQuery...     
+0000f720: 2020 2054 6865 6e20 6974 2063 616e 2062     Then it can b
+0000f730: 6520 6170 706c 6965 6420 746f 2061 2044  e applied to a D
+0000f740: 6174 6146 7261 6d65 206f 7220 5365 7269  ataFrame or Seri
+0000f750: 6573 2e0a 0a20 2020 2020 2020 202e 2e20  es...        .. 
+0000f760: 6e6f 7465 3a3a 0a20 2020 2020 2020 2020  note::.         
+0000f770: 2020 2054 6865 2072 6574 7572 6e20 7479     The return ty
+0000f780: 7065 206f 6620 7468 6520 6675 6e63 7469  pe of the functi
+0000f790: 6f6e 206d 7573 7420 6265 2065 7870 6c69  on must be expli
+0000f7a0: 6369 746c 7920 7370 6563 6966 6965 6420  citly specified 
+0000f7b0: 696e 2074 6865 0a20 2020 2020 2020 2020  in the.         
+0000f7c0: 2020 2066 756e 6374 696f 6e27 7320 6f72     function's or
+0000f7d0: 6967 696e 616c 2064 6566 696e 6974 696f  iginal definitio
+0000f7e0: 6e20 6576 656e 2069 6620 6e6f 7420 6f74  n even if not ot
+0000f7f0: 6865 7277 6973 6520 7265 7175 6972 6564  herwise required
+0000f800: 2e0a 0a20 2020 2020 2020 2042 6967 5175  ...        BigQu
+0000f810: 6572 7920 5574 696c 7320 7072 6f76 6964  ery Utils provid
+0000f820: 6573 206d 616e 7920 7075 626c 6963 2066  es many public f
+0000f830: 756e 6374 696f 6e73 2075 6e64 6572 2074  unctions under t
+0000f840: 6865 2060 6062 7175 7469 6c60 6020 7072  he ``bqutil`` pr
+0000f850: 6f6a 6563 7420 6f6e 2047 6f6f 676c 6520  oject on Google 
+0000f860: 436c 6f75 6420 506c 6174 666f 726d 2070  Cloud Platform p
+0000f870: 726f 6a65 6374 0a20 2020 2020 2020 2028  roject.        (
+0000f880: 5365 653a 2068 7474 7073 3a2f 2f67 6974  See: https://git
+0000f890: 6875 622e 636f 6d2f 476f 6f67 6c65 436c  hub.com/GoogleCl
+0000f8a0: 6f75 6450 6c61 7466 6f72 6d2f 6269 6771  oudPlatform/bigq
+0000f8b0: 7565 7279 2d75 7469 6c73 2f74 7265 652f  uery-utils/tree/
+0000f8c0: 6d61 7374 6572 2f75 6466 7323 7573 696e  master/udfs#usin
+0000f8d0: 672d 7468 652d 7564 6673 292e 0a20 2020  g-the-udfs)..   
+0000f8e0: 2020 2020 2059 6f75 2063 616e 2063 6865       You can che
+0000f8f0: 636b 6f75 7420 436f 6d6d 756e 6974 7920  ckout Community 
+0000f900: 5544 4673 2074 6f20 7573 6520 636f 6d6d  UDFs to use comm
+0000f910: 756e 6974 792d 636f 6e74 7269 6275 7465  unity-contribute
+0000f920: 6420 6675 6e63 7469 6f6e 732e 0a20 2020  d functions..   
+0000f930: 2020 2020 2028 5365 653a 2068 7474 7073       (See: https
+0000f940: 3a2f 2f67 6974 6875 622e 636f 6d2f 476f  ://github.com/Go
+0000f950: 6f67 6c65 436c 6f75 6450 6c61 7466 6f72  ogleCloudPlatfor
+0000f960: 6d2f 6269 6771 7565 7279 2d75 7469 6c73  m/bigquery-utils
+0000f970: 2f74 7265 652f 6d61 7374 6572 2f75 6466  /tree/master/udf
+0000f980: 732f 636f 6d6d 756e 6974 7923 636f 6d6d  s/community#comm
+0000f990: 756e 6974 792d 7564 6673 292e 0a0a 2020  unity-udfs)...  
+0000f9a0: 2020 2020 2020 2a2a 4578 616d 706c 6573        **Examples
+0000f9b0: 3a2a 2a0a 0a20 2020 2020 2020 2055 7365  :**..        Use
+0000f9c0: 2074 6865 2060 6063 775f 6c6f 7765 725f   the ``cw_lower_
+0000f9d0: 6361 7365 5f61 7363 6969 5f6f 6e6c 7960  case_ascii_only`
+0000f9e0: 6020 6675 6e63 7469 6f6e 2066 726f 6d20  ` function from 
+0000f9f0: 436f 6d6d 756e 6974 7920 5544 4673 2e0a  Community UDFs..
+0000fa00: 2020 2020 2020 2020 2868 7474 7073 3a2f          (https:/
+0000fa10: 2f67 6974 6875 622e 636f 6d2f 476f 6f67  /github.com/Goog
+0000fa20: 6c65 436c 6f75 6450 6c61 7466 6f72 6d2f  leCloudPlatform/
+0000fa30: 6269 6771 7565 7279 2d75 7469 6c73 2f62  bigquery-utils/b
+0000fa40: 6c6f 622f 6d61 7374 6572 2f75 6466 732f  lob/master/udfs/
+0000fa50: 636f 6d6d 756e 6974 792f 6377 5f6c 6f77  community/cw_low
+0000fa60: 6572 5f63 6173 655f 6173 6369 695f 6f6e  er_case_ascii_on
+0000fa70: 6c79 2e73 716c 7829 0a0a 2020 2020 2020  ly.sqlx)..      
+0000fa80: 2020 2020 2020 3e3e 3e20 696d 706f 7274        >>> import
+0000fa90: 2062 6967 6672 616d 6573 2e70 616e 6461   bigframes.panda
+0000faa0: 7320 6173 2062 7064 0a20 2020 2020 2020  s as bpd.       
+0000fab0: 2020 2020 203e 3e3e 2062 7064 2e6f 7074       >>> bpd.opt
+0000fac0: 696f 6e73 2e64 6973 706c 6179 2e70 726f  ions.display.pro
+0000fad0: 6772 6573 735f 6261 7220 3d20 4e6f 6e65  gress_bar = None
+0000fae0: 0a0a 2020 2020 2020 2020 2020 2020 3e3e  ..            >>
+0000faf0: 3e20 6466 203d 2062 7064 2e44 6174 6146  > df = bpd.DataF
+0000fb00: 7261 6d65 287b 2769 6427 3a20 5b31 2c20  rame({'id': [1, 
+0000fb10: 322c 2033 5d2c 2027 6e61 6d65 273a 205b  2, 3], 'name': [
+0000fb20: 2741 5552 c389 4c49 4527 2c20 2743 c389  'AUR..LIE', 'C..
+0000fb30: 4c45 5354 494e 4527 2c20 2744 4150 484e  LESTINE', 'DAPHN
+0000fb40: c389 275d 7d29 0a20 2020 2020 2020 2020  ..']}).         
+0000fb50: 2020 203e 3e3e 2064 660a 2020 2020 2020     >>> df.      
+0000fb60: 2020 2020 2020 2020 2069 6420 2020 2020           id     
+0000fb70: 2020 6e61 6d65 0a20 2020 2020 2020 2020    name.         
+0000fb80: 2020 2030 2020 2031 2020 2020 4155 52c3     0   1    AUR.
+0000fb90: 894c 4945 0a20 2020 2020 2020 2020 2020  .LIE.           
+0000fba0: 2031 2020 2032 2020 43c3 894c 4553 5449   1   2  C..LESTI
+0000fbb0: 4e45 0a20 2020 2020 2020 2020 2020 2032  NE.            2
+0000fbc0: 2020 2033 2020 2020 2044 4150 484e c389     3     DAPHN..
+0000fbd0: 0a20 2020 2020 2020 2020 2020 203c 424c  .            <BL
+0000fbe0: 414e 4b4c 494e 453e 0a20 2020 2020 2020  ANKLINE>.       
+0000fbf0: 2020 2020 205b 3320 726f 7773 2078 2032       [3 rows x 2
+0000fc00: 2063 6f6c 756d 6e73 5d0a 0a20 2020 2020   columns]..     
+0000fc10: 2020 2020 2020 203e 3e3e 2066 756e 6320         >>> func 
+0000fc20: 3d20 6270 642e 7265 6164 5f67 6271 5f66  = bpd.read_gbq_f
+0000fc30: 756e 6374 696f 6e28 2262 7175 7469 6c2e  unction("bqutil.
+0000fc40: 666e 2e63 775f 6c6f 7765 725f 6361 7365  fn.cw_lower_case
+0000fc50: 5f61 7363 6969 5f6f 6e6c 7922 290a 2020  _ascii_only").  
+0000fc60: 2020 2020 2020 2020 2020 3e3e 3e20 6466            >>> df
+0000fc70: 3120 3d20 6466 2e61 7373 6967 6e28 6e65  1 = df.assign(ne
+0000fc80: 775f 6e61 6d65 3d64 665b 276e 616d 6527  w_name=df['name'
+0000fc90: 5d2e 6170 706c 7928 6675 6e63 2929 0a20  ].apply(func)). 
+0000fca0: 2020 2020 2020 2020 2020 203e 3e3e 2064             >>> d
+0000fcb0: 6631 0a20 2020 2020 2020 2020 2020 2020  f1.             
+0000fcc0: 2020 6964 2020 2020 2020 206e 616d 6520    id       name 
+0000fcd0: 2020 6e65 775f 6e61 6d65 0a20 2020 2020    new_name.     
+0000fce0: 2020 2020 2020 2030 2020 2031 2020 2020         0   1    
+0000fcf0: 4155 52c3 894c 4945 2020 2020 6175 72c3  AUR..LIE    aur.
+0000fd00: 896c 6965 0a20 2020 2020 2020 2020 2020  .lie.           
+0000fd10: 2031 2020 2032 2020 43c3 894c 4553 5449   1   2  C..LESTI
+0000fd20: 4e45 2020 63c3 896c 6573 7469 6e65 0a20  NE  c..lestine. 
+0000fd30: 2020 2020 2020 2020 2020 2032 2020 2033             2   3
+0000fd40: 2020 2020 2044 4150 484e c389 2020 2020       DAPHN..    
+0000fd50: 2064 6170 686e c389 0a20 2020 2020 2020   daphn...       
+0000fd60: 2020 2020 203c 424c 414e 4b4c 494e 453e       <BLANKLINE>
+0000fd70: 0a20 2020 2020 2020 2020 2020 205b 3320  .            [3 
+0000fd80: 726f 7773 2078 2033 2063 6f6c 756d 6e73  rows x 3 columns
+0000fd90: 5d0a 0a20 2020 2020 2020 2041 7267 733a  ]..        Args:
+0000fda0: 0a20 2020 2020 2020 2020 2020 2066 756e  .            fun
+0000fdb0: 6374 696f 6e5f 6e61 6d65 2028 7374 7229  ction_name (str)
+0000fdc0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000fdd0: 2020 7468 6520 6675 6e63 7469 6f6e 2773    the function's
+0000fde0: 206e 616d 6520 696e 2042 6967 5175 6572   name in BigQuer
+0000fdf0: 7920 696e 2074 6865 2066 6f72 6d61 740a  y in the format.
+0000fe00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fe10: 6070 726f 6a65 6374 5f69 642e 6461 7461  `project_id.data
+0000fe20: 7365 745f 6964 2e66 756e 6374 696f 6e5f  set_id.function_
+0000fe30: 6e61 6d65 602c 206f 720a 2020 2020 2020  name`, or.      
+0000fe40: 2020 2020 2020 2020 2020 6064 6174 6173            `datas
+0000fe50: 6574 5f69 642e 6675 6e63 7469 6f6e 5f6e  et_id.function_n
+0000fe60: 616d 6560 2074 6f20 6c6f 6164 2066 726f  ame` to load fro
+0000fe70: 6d20 7468 6520 6465 6661 756c 7420 7072  m the default pr
+0000fe80: 6f6a 6563 742c 206f 720a 2020 2020 2020  oject, or.      
+0000fe90: 2020 2020 2020 2020 2020 6066 756e 6374            `funct
+0000fea0: 696f 6e5f 6e61 6d65 6020 746f 206c 6f61  ion_name` to loa
+0000feb0: 6420 6672 6f6d 2074 6865 2064 6566 6175  d from the defau
+0000fec0: 6c74 2070 726f 6a65 6374 2061 6e64 2074  lt project and t
+0000fed0: 6865 2064 6174 6173 6574 0a20 2020 2020  he dataset.     
+0000fee0: 2020 2020 2020 2020 2020 2061 7373 6f63             assoc
+0000fef0: 6961 7465 6420 7769 7468 2074 6865 2063  iated with the c
+0000ff00: 7572 7265 6e74 2073 6573 7369 6f6e 2e0a  urrent session..
+0000ff10: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+0000ff20: 3a0a 2020 2020 2020 2020 2020 2020 6361  :.            ca
+0000ff30: 6c6c 6162 6c65 3a20 4120 6675 6e63 7469  llable: A functi
+0000ff40: 6f6e 206f 626a 6563 7420 706f 696e 7469  on object pointi
+0000ff50: 6e67 2074 6f20 7468 6520 4269 6751 7565  ng to the BigQue
+0000ff60: 7279 2066 756e 6374 696f 6e20 7265 6164  ry function read
+0000ff70: 0a20 2020 2020 2020 2020 2020 2066 726f  .            fro
+0000ff80: 6d20 4269 6751 7565 7279 2e0a 0a20 2020  m BigQuery...   
+0000ff90: 2020 2020 2020 2020 2054 6865 206f 626a           The obj
+0000ffa0: 6563 7420 6973 2073 696d 696c 6172 2074  ect is similar t
+0000ffb0: 6f20 7468 6520 6f6e 6520 6372 6561 7465  o the one create
+0000ffc0: 6420 6279 2074 6865 2060 7265 6d6f 7465  d by the `remote
+0000ffd0: 5f66 756e 6374 696f 6e60 0a20 2020 2020  _function`.     
+0000ffe0: 2020 2020 2020 2064 6563 6f72 6174 6f72         decorator
+0000fff0: 2c20 696e 636c 7564 696e 6720 7468 6520  , including the 
+00010000: 6062 6967 6672 616d 6573 5f72 656d 6f74  `bigframes_remot
+00010010: 655f 6675 6e63 7469 6f6e 6020 7072 6f70  e_function` prop
+00010020: 6572 7479 2c20 6275 740a 2020 2020 2020  erty, but.      
+00010030: 2020 2020 2020 6e6f 7420 696e 636c 7564        not includ
+00010040: 696e 6720 7468 6520 6062 6967 6672 616d  ing the `bigfram
+00010050: 6573 5f63 6c6f 7564 5f66 756e 6374 696f  es_cloud_functio
+00010060: 6e60 2070 726f 7065 7274 792e 0a20 2020  n` property..   
+00010070: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
+00010080: 2020 7265 7475 726e 2062 6967 6672 616d    return bigfram
+00010090: 6573 5f72 6766 280a 2020 2020 2020 2020  es_rgf(.        
+000100a0: 2020 2020 6675 6e63 7469 6f6e 5f6e 616d      function_nam
+000100b0: 653d 6675 6e63 7469 6f6e 5f6e 616d 652c  e=function_name,
+000100c0: 0a20 2020 2020 2020 2020 2020 2073 6573  .            ses
+000100d0: 7369 6f6e 3d73 656c 662c 0a20 2020 2020  sion=self,.     
+000100e0: 2020 2029 0a0a 2020 2020 6465 6620 5f70     )..    def _p
+000100f0: 7265 7061 7265 5f71 7565 7279 5f6a 6f62  repare_query_job
+00010100: 5f63 6f6e 6669 6728 0a20 2020 2020 2020  _config(.       
+00010110: 2073 656c 662c 0a20 2020 2020 2020 206a   self,.        j
+00010120: 6f62 5f63 6f6e 6669 673a 204f 7074 696f  ob_config: Optio
+00010130: 6e61 6c5b 6269 6771 7565 7279 2e51 7565  nal[bigquery.Que
+00010140: 7279 4a6f 6243 6f6e 6669 675d 203d 204e  ryJobConfig] = N
+00010150: 6f6e 652c 0a20 2020 2029 202d 3e20 6269  one,.    ) -> bi
+00010160: 6771 7565 7279 2e51 7565 7279 4a6f 6243  gquery.QueryJobC
+00010170: 6f6e 6669 673a 0a20 2020 2020 2020 2069  onfig:.        i
+00010180: 6620 6a6f 625f 636f 6e66 6967 2069 7320  f job_config is 
+00010190: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+000101a0: 2020 6a6f 625f 636f 6e66 6967 203d 2062    job_config = b
+000101b0: 6967 7175 6572 792e 5175 6572 794a 6f62  igquery.QueryJob
+000101c0: 436f 6e66 6967 2829 0a20 2020 2020 2020  Config().       
+000101d0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+000101e0: 2020 2023 2043 7265 6174 6520 6120 636f     # Create a co
+000101f0: 7079 2073 6f20 7468 6174 2077 6520 646f  py so that we do
+00010200: 6e27 7420 6d75 7461 7465 2074 6865 206f  n't mutate the o
+00010210: 7269 6769 6e61 6c20 636f 6e66 6967 2070  riginal config p
+00010220: 6173 7365 640a 2020 2020 2020 2020 2020  assed.          
+00010230: 2020 6a6f 625f 636f 6e66 6967 203d 2074    job_config = t
+00010240: 7970 696e 672e 6361 7374 280a 2020 2020  yping.cast(.    
+00010250: 2020 2020 2020 2020 2020 2020 6269 6771              bigq
+00010260: 7565 7279 2e51 7565 7279 4a6f 6243 6f6e  uery.QueryJobCon
+00010270: 6669 672c 0a20 2020 2020 2020 2020 2020  fig,.           
+00010280: 2020 2020 2062 6967 7175 6572 792e 5175       bigquery.Qu
+00010290: 6572 794a 6f62 436f 6e66 6967 2e66 726f  eryJobConfig.fro
+000102a0: 6d5f 6170 695f 7265 7072 286a 6f62 5f63  m_api_repr(job_c
+000102b0: 6f6e 6669 672e 746f 5f61 7069 5f72 6570  onfig.to_api_rep
+000102c0: 7228 2929 2c0a 2020 2020 2020 2020 2020  r()),.          
+000102d0: 2020 290a 0a20 2020 2020 2020 2069 6620    )..        if 
+000102e0: 6269 6766 7261 6d65 732e 6f70 7469 6f6e  bigframes.option
+000102f0: 732e 636f 6d70 7574 652e 6d61 7869 6d75  s.compute.maximu
+00010300: 6d5f 6279 7465 735f 6269 6c6c 6564 2069  m_bytes_billed i
+00010310: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+00010320: 2020 2020 2020 2020 6a6f 625f 636f 6e66          job_conf
+00010330: 6967 2e6d 6178 696d 756d 5f62 7974 6573  ig.maximum_bytes
+00010340: 5f62 696c 6c65 6420 3d20 280a 2020 2020  _billed = (.    
+00010350: 2020 2020 2020 2020 2020 2020 6269 6766              bigf
+00010360: 7261 6d65 732e 6f70 7469 6f6e 732e 636f  rames.options.co
+00010370: 6d70 7574 652e 6d61 7869 6d75 6d5f 6279  mpute.maximum_by
+00010380: 7465 735f 6269 6c6c 6564 0a20 2020 2020  tes_billed.     
+00010390: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+000103a0: 2020 6375 7272 656e 745f 6c61 6265 6c73    current_labels
+000103b0: 203d 206a 6f62 5f63 6f6e 6669 672e 6c61   = job_config.la
+000103c0: 6265 6c73 2069 6620 6a6f 625f 636f 6e66  bels if job_conf
+000103d0: 6967 2e6c 6162 656c 7320 656c 7365 207b  ig.labels else {
+000103e0: 7d0a 2020 2020 2020 2020 666f 7220 6b65  }.        for ke
+000103f0: 792c 2076 616c 7565 2069 6e20 6269 6766  y, value in bigf
+00010400: 7261 6d65 732e 6f70 7469 6f6e 732e 636f  rames.options.co
+00010410: 6d70 7574 652e 6578 7472 615f 7175 6572  mpute.extra_quer
+00010420: 795f 6c61 6265 6c73 2e69 7465 6d73 2829  y_labels.items()
+00010430: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00010440: 206b 6579 206e 6f74 2069 6e20 6375 7272   key not in curr
+00010450: 656e 745f 6c61 6265 6c73 3a0a 2020 2020  ent_labels:.    
+00010460: 2020 2020 2020 2020 2020 2020 6375 7272              curr
+00010470: 656e 745f 6c61 6265 6c73 5b6b 6579 5d20  ent_labels[key] 
+00010480: 3d20 7661 6c75 650a 2020 2020 2020 2020  = value.        
+00010490: 6a6f 625f 636f 6e66 6967 2e6c 6162 656c  job_config.label
+000104a0: 7320 3d20 6375 7272 656e 745f 6c61 6265  s = current_labe
+000104b0: 6c73 0a0a 2020 2020 2020 2020 6966 2073  ls..        if s
+000104c0: 656c 662e 5f62 715f 6b6d 735f 6b65 795f  elf._bq_kms_key_
+000104d0: 6e61 6d65 3a0a 2020 2020 2020 2020 2020  name:.          
+000104e0: 2020 6a6f 625f 636f 6e66 6967 2e64 6573    job_config.des
+000104f0: 7469 6e61 7469 6f6e 5f65 6e63 7279 7074  tination_encrypt
+00010500: 696f 6e5f 636f 6e66 6967 7572 6174 696f  ion_configuratio
+00010510: 6e20 3d20 280a 2020 2020 2020 2020 2020  n = (.          
+00010520: 2020 2020 2020 6269 6771 7565 7279 2e45        bigquery.E
+00010530: 6e63 7279 7074 696f 6e43 6f6e 6669 6775  ncryptionConfigu
+00010540: 7261 7469 6f6e 286b 6d73 5f6b 6579 5f6e  ration(kms_key_n
+00010550: 616d 653d 7365 6c66 2e5f 6271 5f6b 6d73  ame=self._bq_kms
+00010560: 5f6b 6579 5f6e 616d 6529 0a20 2020 2020  _key_name).     
+00010570: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+00010580: 2020 7265 7475 726e 206a 6f62 5f63 6f6e    return job_con
+00010590: 6669 670a 0a20 2020 2064 6566 205f 7072  fig..    def _pr
+000105a0: 6570 6172 655f 6c6f 6164 5f6a 6f62 5f63  epare_load_job_c
+000105b0: 6f6e 6669 6728 7365 6c66 2920 2d3e 2062  onfig(self) -> b
+000105c0: 6967 7175 6572 792e 4c6f 6164 4a6f 6243  igquery.LoadJobC
+000105d0: 6f6e 6669 673a 0a20 2020 2020 2020 2023  onfig:.        #
+000105e0: 2043 7265 6174 6520 6120 636f 7079 2073   Create a copy s
+000105f0: 6f20 7468 6174 2077 6520 646f 6e27 7420  o that we don't 
+00010600: 6d75 7461 7465 2074 6865 206f 7269 6769  mutate the origi
+00010610: 6e61 6c20 636f 6e66 6967 2070 6173 7365  nal config passe
+00010620: 640a 2020 2020 2020 2020 6a6f 625f 636f  d.        job_co
+00010630: 6e66 6967 203d 2062 6967 7175 6572 792e  nfig = bigquery.
+00010640: 4c6f 6164 4a6f 6243 6f6e 6669 6728 290a  LoadJobConfig().
+00010650: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+00010660: 2e5f 6271 5f6b 6d73 5f6b 6579 5f6e 616d  ._bq_kms_key_nam
+00010670: 653a 0a20 2020 2020 2020 2020 2020 206a  e:.            j
+00010680: 6f62 5f63 6f6e 6669 672e 6465 7374 696e  ob_config.destin
+00010690: 6174 696f 6e5f 656e 6372 7970 7469 6f6e  ation_encryption
+000106a0: 5f63 6f6e 6669 6775 7261 7469 6f6e 203d  _configuration =
+000106b0: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
+000106c0: 2020 2062 6967 7175 6572 792e 456e 6372     bigquery.Encr
+000106d0: 7970 7469 6f6e 436f 6e66 6967 7572 6174  yptionConfigurat
+000106e0: 696f 6e28 6b6d 735f 6b65 795f 6e61 6d65  ion(kms_key_name
+000106f0: 3d73 656c 662e 5f62 715f 6b6d 735f 6b65  =self._bq_kms_ke
+00010700: 795f 6e61 6d65 290a 2020 2020 2020 2020  y_name).        
+00010710: 2020 2020 290a 0a20 2020 2020 2020 2072      )..        r
+00010720: 6574 7572 6e20 6a6f 625f 636f 6e66 6967  eturn job_config
+00010730: 0a0a 2020 2020 6465 6620 5f70 7265 7061  ..    def _prepa
+00010740: 7265 5f63 6f70 795f 6a6f 625f 636f 6e66  re_copy_job_conf
+00010750: 6967 2873 656c 6629 202d 3e20 6269 6771  ig(self) -> bigq
+00010760: 7565 7279 2e43 6f70 794a 6f62 436f 6e66  uery.CopyJobConf
+00010770: 6967 3a0a 2020 2020 2020 2020 2320 4372  ig:.        # Cr
+00010780: 6561 7465 2061 2063 6f70 7920 736f 2074  eate a copy so t
+00010790: 6861 7420 7765 2064 6f6e 2774 206d 7574  hat we don't mut
+000107a0: 6174 6520 7468 6520 6f72 6967 696e 616c  ate the original
+000107b0: 2063 6f6e 6669 6720 7061 7373 6564 0a20   config passed. 
 000107c0: 2020 2020 2020 206a 6f62 5f63 6f6e 6669         job_confi
-000107d0: 6720 3d20 7479 7069 6e67 2e63 6173 7428  g = typing.cast(
-000107e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000107f0: 2062 6967 7175 6572 792e 5175 6572 794a   bigquery.QueryJ
-00010800: 6f62 436f 6e66 6967 2c0a 2020 2020 2020  obConfig,.      
-00010810: 2020 2020 2020 2020 2020 6269 6771 7565            bigque
-00010820: 7279 2e51 7565 7279 4a6f 6243 6f6e 6669  ry.QueryJobConfi
-00010830: 672e 6672 6f6d 5f61 7069 5f72 6570 7228  g.from_api_repr(
-00010840: 6a6f 625f 636f 6e66 6967 2e74 6f5f 6170  job_config.to_ap
-00010850: 695f 7265 7072 2829 292c 0a20 2020 2020  i_repr()),.     
-00010860: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-00010870: 2020 6966 2062 6967 6672 616d 6573 2e6f    if bigframes.o
-00010880: 7074 696f 6e73 2e63 6f6d 7075 7465 2e6d  ptions.compute.m
-00010890: 6178 696d 756d 5f62 7974 6573 5f62 696c  aximum_bytes_bil
-000108a0: 6c65 6420 6973 206e 6f74 204e 6f6e 653a  led is not None:
-000108b0: 0a20 2020 2020 2020 2020 2020 206a 6f62  .            job
-000108c0: 5f63 6f6e 6669 672e 6d61 7869 6d75 6d5f  _config.maximum_
-000108d0: 6279 7465 735f 6269 6c6c 6564 203d 2028  bytes_billed = (
-000108e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000108f0: 2062 6967 6672 616d 6573 2e6f 7074 696f   bigframes.optio
-00010900: 6e73 2e63 6f6d 7075 7465 2e6d 6178 696d  ns.compute.maxim
-00010910: 756d 5f62 7974 6573 5f62 696c 6c65 640a  um_bytes_billed.
-00010920: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00010930: 2020 2020 2020 2063 7572 7265 6e74 5f6c         current_l
-00010940: 6162 656c 7320 3d20 6a6f 625f 636f 6e66  abels = job_conf
-00010950: 6967 2e6c 6162 656c 7320 6966 206a 6f62  ig.labels if job
-00010960: 5f63 6f6e 6669 672e 6c61 6265 6c73 2065  _config.labels e
-00010970: 6c73 6520 7b7d 0a20 2020 2020 2020 2066  lse {}.        f
-00010980: 6f72 206b 6579 2c20 7661 6c75 6520 696e  or key, value in
-00010990: 2062 6967 6672 616d 6573 2e6f 7074 696f   bigframes.optio
-000109a0: 6e73 2e63 6f6d 7075 7465 2e65 7874 7261  ns.compute.extra
-000109b0: 5f71 7565 7279 5f6c 6162 656c 732e 6974  _query_labels.it
-000109c0: 656d 7328 293a 0a20 2020 2020 2020 2020  ems():.         
-000109d0: 2020 2069 6620 6b65 7920 6e6f 7420 696e     if key not in
-000109e0: 2063 7572 7265 6e74 5f6c 6162 656c 733a   current_labels:
-000109f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010a00: 2063 7572 7265 6e74 5f6c 6162 656c 735b   current_labels[
-00010a10: 6b65 795d 203d 2076 616c 7565 0a20 2020  key] = value.   
-00010a20: 2020 2020 206a 6f62 5f63 6f6e 6669 672e       job_config.
-00010a30: 6c61 6265 6c73 203d 2063 7572 7265 6e74  labels = current
-00010a40: 5f6c 6162 656c 730a 0a20 2020 2020 2020  _labels..       
-00010a50: 2069 6620 7365 6c66 2e5f 6271 5f6b 6d73   if self._bq_kms
-00010a60: 5f6b 6579 5f6e 616d 653a 0a20 2020 2020  _key_name:.     
-00010a70: 2020 2020 2020 206a 6f62 5f63 6f6e 6669         job_confi
-00010a80: 672e 6465 7374 696e 6174 696f 6e5f 656e  g.destination_en
-00010a90: 6372 7970 7469 6f6e 5f63 6f6e 6669 6775  cryption_configu
-00010aa0: 7261 7469 6f6e 203d 2028 0a20 2020 2020  ration = (.     
-00010ab0: 2020 2020 2020 2020 2020 2062 6967 7175             bigqu
-00010ac0: 6572 792e 456e 6372 7970 7469 6f6e 436f  ery.EncryptionCo
-00010ad0: 6e66 6967 7572 6174 696f 6e28 6b6d 735f  nfiguration(kms_
-00010ae0: 6b65 795f 6e61 6d65 3d73 656c 662e 5f62  key_name=self._b
-00010af0: 715f 6b6d 735f 6b65 795f 6e61 6d65 290a  q_kms_key_name).
-00010b00: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00010b10: 2020 2020 2020 2072 6574 7572 6e20 6a6f         return jo
-00010b20: 625f 636f 6e66 6967 0a0a 2020 2020 6465  b_config..    de
-00010b30: 6620 5f70 7265 7061 7265 5f6c 6f61 645f  f _prepare_load_
-00010b40: 6a6f 625f 636f 6e66 6967 2873 656c 6629  job_config(self)
-00010b50: 202d 3e20 6269 6771 7565 7279 2e4c 6f61   -> bigquery.Loa
-00010b60: 644a 6f62 436f 6e66 6967 3a0a 2020 2020  dJobConfig:.    
-00010b70: 2020 2020 2320 4372 6561 7465 2061 2063      # Create a c
-00010b80: 6f70 7920 736f 2074 6861 7420 7765 2064  opy so that we d
-00010b90: 6f6e 2774 206d 7574 6174 6520 7468 6520  on't mutate the 
-00010ba0: 6f72 6967 696e 616c 2063 6f6e 6669 6720  original config 
-00010bb0: 7061 7373 6564 0a20 2020 2020 2020 206a  passed.        j
-00010bc0: 6f62 5f63 6f6e 6669 6720 3d20 6269 6771  ob_config = bigq
-00010bd0: 7565 7279 2e4c 6f61 644a 6f62 436f 6e66  uery.LoadJobConf
-00010be0: 6967 2829 0a0a 2020 2020 2020 2020 6966  ig()..        if
-00010bf0: 2073 656c 662e 5f62 715f 6b6d 735f 6b65   self._bq_kms_ke
-00010c00: 795f 6e61 6d65 3a0a 2020 2020 2020 2020  y_name:.        
-00010c10: 2020 2020 6a6f 625f 636f 6e66 6967 2e64      job_config.d
-00010c20: 6573 7469 6e61 7469 6f6e 5f65 6e63 7279  estination_encry
-00010c30: 7074 696f 6e5f 636f 6e66 6967 7572 6174  ption_configurat
-00010c40: 696f 6e20 3d20 280a 2020 2020 2020 2020  ion = (.        
-00010c50: 2020 2020 2020 2020 6269 6771 7565 7279          bigquery
-00010c60: 2e45 6e63 7279 7074 696f 6e43 6f6e 6669  .EncryptionConfi
-00010c70: 6775 7261 7469 6f6e 286b 6d73 5f6b 6579  guration(kms_key
-00010c80: 5f6e 616d 653d 7365 6c66 2e5f 6271 5f6b  _name=self._bq_k
-00010c90: 6d73 5f6b 6579 5f6e 616d 6529 0a20 2020  ms_key_name).   
-00010ca0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-00010cb0: 2020 2020 7265 7475 726e 206a 6f62 5f63      return job_c
-00010cc0: 6f6e 6669 670a 0a20 2020 2064 6566 205f  onfig..    def _
-00010cd0: 7072 6570 6172 655f 636f 7079 5f6a 6f62  prepare_copy_job
-00010ce0: 5f63 6f6e 6669 6728 7365 6c66 2920 2d3e  _config(self) ->
-00010cf0: 2062 6967 7175 6572 792e 436f 7079 4a6f   bigquery.CopyJo
-00010d00: 6243 6f6e 6669 673a 0a20 2020 2020 2020  bConfig:.       
-00010d10: 2023 2043 7265 6174 6520 6120 636f 7079   # Create a copy
-00010d20: 2073 6f20 7468 6174 2077 6520 646f 6e27   so that we don'
-00010d30: 7420 6d75 7461 7465 2074 6865 206f 7269  t mutate the ori
-00010d40: 6769 6e61 6c20 636f 6e66 6967 2070 6173  ginal config pas
-00010d50: 7365 640a 2020 2020 2020 2020 6a6f 625f  sed.        job_
-00010d60: 636f 6e66 6967 203d 2062 6967 7175 6572  config = bigquer
-00010d70: 792e 436f 7079 4a6f 6243 6f6e 6669 6728  y.CopyJobConfig(
-00010d80: 290a 0a20 2020 2020 2020 2069 6620 7365  )..        if se
-00010d90: 6c66 2e5f 6271 5f6b 6d73 5f6b 6579 5f6e  lf._bq_kms_key_n
-00010da0: 616d 653a 0a20 2020 2020 2020 2020 2020  ame:.           
-00010db0: 206a 6f62 5f63 6f6e 6669 672e 6465 7374   job_config.dest
-00010dc0: 696e 6174 696f 6e5f 656e 6372 7970 7469  ination_encrypti
-00010dd0: 6f6e 5f63 6f6e 6669 6775 7261 7469 6f6e  on_configuration
-00010de0: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
-00010df0: 2020 2020 2062 6967 7175 6572 792e 456e       bigquery.En
-00010e00: 6372 7970 7469 6f6e 436f 6e66 6967 7572  cryptionConfigur
-00010e10: 6174 696f 6e28 6b6d 735f 6b65 795f 6e61  ation(kms_key_na
-00010e20: 6d65 3d73 656c 662e 5f62 715f 6b6d 735f  me=self._bq_kms_
-00010e30: 6b65 795f 6e61 6d65 290a 2020 2020 2020  key_name).      
-00010e40: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00010e50: 2072 6574 7572 6e20 6a6f 625f 636f 6e66   return job_conf
-00010e60: 6967 0a0a 2020 2020 6465 6620 5f73 7461  ig..    def _sta
-00010e70: 7274 5f71 7565 7279 280a 2020 2020 2020  rt_query(.      
-00010e80: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00010e90: 7371 6c3a 2073 7472 2c0a 2020 2020 2020  sql: str,.      
-00010ea0: 2020 6a6f 625f 636f 6e66 6967 3a20 4f70    job_config: Op
-00010eb0: 7469 6f6e 616c 5b62 6967 7175 6572 792e  tional[bigquery.
-00010ec0: 6a6f 622e 5175 6572 794a 6f62 436f 6e66  job.QueryJobConf
-00010ed0: 6967 5d20 3d20 4e6f 6e65 2c0a 2020 2020  ig] = None,.    
-00010ee0: 2020 2020 6d61 785f 7265 7375 6c74 733a      max_results:
-00010ef0: 204f 7074 696f 6e61 6c5b 696e 745d 203d   Optional[int] =
-00010f00: 204e 6f6e 652c 0a20 2020 2020 2020 2074   None,.        t
-00010f10: 696d 656f 7574 3a20 4f70 7469 6f6e 616c  imeout: Optional
-00010f20: 5b66 6c6f 6174 5d20 3d20 4e6f 6e65 2c0a  [float] = None,.
-00010f30: 2020 2020 2920 2d3e 2054 7570 6c65 5b62      ) -> Tuple[b
-00010f40: 6967 7175 6572 792e 7461 626c 652e 526f  igquery.table.Ro
-00010f50: 7749 7465 7261 746f 722c 2062 6967 7175  wIterator, bigqu
-00010f60: 6572 792e 5175 6572 794a 6f62 5d3a 0a20  ery.QueryJob]:. 
-00010f70: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00010f80: 2020 2053 7461 7274 7320 4269 6751 7565     Starts BigQue
-00010f90: 7279 2071 7565 7279 206a 6f62 2061 6e64  ry query job and
-00010fa0: 2077 6169 7473 2066 6f72 2072 6573 756c   waits for resul
-00010fb0: 7473 2e0a 2020 2020 2020 2020 2222 220a  ts..        """.
-00010fc0: 2020 2020 2020 2020 6a6f 625f 636f 6e66          job_conf
-00010fd0: 6967 203d 2073 656c 662e 5f70 7265 7061  ig = self._prepa
-00010fe0: 7265 5f71 7565 7279 5f6a 6f62 5f63 6f6e  re_query_job_con
-00010ff0: 6669 6728 6a6f 625f 636f 6e66 6967 290a  fig(job_config).
-00011000: 2020 2020 2020 2020 7265 7475 726e 2062          return b
-00011010: 6967 6672 616d 6573 2e73 6573 7369 6f6e  igframes.session
-00011020: 2e5f 696f 2e62 6967 7175 6572 792e 7374  ._io.bigquery.st
-00011030: 6172 745f 7175 6572 795f 7769 7468 5f63  art_query_with_c
-00011040: 6c69 656e 7428 0a20 2020 2020 2020 2020  lient(.         
-00011050: 2020 2073 656c 662e 6271 636c 6965 6e74     self.bqclient
-00011060: 2c20 7371 6c2c 206a 6f62 5f63 6f6e 6669  , sql, job_confi
-00011070: 672c 206d 6178 5f72 6573 756c 7473 2c20  g, max_results, 
-00011080: 7469 6d65 6f75 740a 2020 2020 2020 2020  timeout.        
-00011090: 290a 0a20 2020 2064 6566 205f 7374 6172  )..    def _star
-000110a0: 745f 7175 6572 795f 6d6c 5f64 646c 280a  t_query_ml_ddl(.
-000110b0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-000110c0: 2020 2020 2020 7371 6c3a 2073 7472 2c0a        sql: str,.
-000110d0: 2020 2020 2920 2d3e 2054 7570 6c65 5b62      ) -> Tuple[b
-000110e0: 6967 7175 6572 792e 7461 626c 652e 526f  igquery.table.Ro
-000110f0: 7749 7465 7261 746f 722c 2062 6967 7175  wIterator, bigqu
-00011100: 6572 792e 5175 6572 794a 6f62 5d3a 0a20  ery.QueryJob]:. 
-00011110: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00011120: 2020 2053 7461 7274 7320 4269 6751 7565     Starts BigQue
-00011130: 7279 204d 4c20 4444 4c20 7175 6572 7920  ry ML DDL query 
-00011140: 6a6f 6220 2843 5245 4154 4520 4d4f 4445  job (CREATE MODE
-00011150: 4c2f 414c 5445 5220 4d4f 4445 4c2f 2e2e  L/ALTER MODEL/..
-00011160: 2e29 2061 6e64 0a20 2020 2020 2020 2077  .) and.        w
-00011170: 6169 7473 2066 6f72 2072 6573 756c 7473  aits for results
-00011180: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00011190: 2020 2020 2020 6a6f 625f 636f 6e66 6967        job_config
-000111a0: 203d 2073 656c 662e 5f70 7265 7061 7265   = self._prepare
-000111b0: 5f71 7565 7279 5f6a 6f62 5f63 6f6e 6669  _query_job_confi
-000111c0: 6728 290a 0a20 2020 2020 2020 2023 2042  g()..        # B
-000111d0: 514d 4c20 6578 7065 6374 7320 6b6d 735f  QML expects kms_
-000111e0: 6b65 795f 6e61 6d65 2074 6872 6f75 6768  key_name through
-000111f0: 204f 5054 494f 4e53 2061 6e64 206e 6f74   OPTIONS and not
-00011200: 2074 6872 6f75 6768 206a 6f62 2063 6f6e   through job con
-00011210: 6669 672c 0a20 2020 2020 2020 2023 2073  fig,.        # s
-00011220: 6f20 7765 206d 7573 7420 7265 7365 7420  o we must reset 
-00011230: 616e 7920 656e 6372 7970 7469 6f6e 2073  any encryption s
-00011240: 6574 2069 6e20 7468 6520 6a6f 6220 636f  et in the job co
-00011250: 6e66 6967 0a20 2020 2020 2020 2023 2068  nfig.        # h
-00011260: 7474 7073 3a2f 2f63 6c6f 7564 2e67 6f6f  ttps://cloud.goo
-00011270: 676c 652e 636f 6d2f 6269 6771 7565 7279  gle.com/bigquery
-00011280: 2f64 6f63 732f 6375 7374 6f6d 6572 2d6d  /docs/customer-m
-00011290: 616e 6167 6564 2d65 6e63 7279 7074 696f  anaged-encryptio
-000112a0: 6e23 656e 6372 7970 742d 6d6f 6465 6c0a  n#encrypt-model.
-000112b0: 2020 2020 2020 2020 6a6f 625f 636f 6e66          job_conf
-000112c0: 6967 2e64 6573 7469 6e61 7469 6f6e 5f65  ig.destination_e
-000112d0: 6e63 7279 7074 696f 6e5f 636f 6e66 6967  ncryption_config
-000112e0: 7572 6174 696f 6e20 3d20 4e6f 6e65 0a0a  uration = None..
-000112f0: 2020 2020 2020 2020 7265 7475 726e 2062          return b
-00011300: 6967 6672 616d 6573 2e73 6573 7369 6f6e  igframes.session
-00011310: 2e5f 696f 2e62 6967 7175 6572 792e 7374  ._io.bigquery.st
-00011320: 6172 745f 7175 6572 795f 7769 7468 5f63  art_query_with_c
-00011330: 6c69 656e 7428 0a20 2020 2020 2020 2020  lient(.         
-00011340: 2020 2073 656c 662e 6271 636c 6965 6e74     self.bqclient
-00011350: 2c20 7371 6c2c 206a 6f62 5f63 6f6e 6669  , sql, job_confi
-00011360: 670a 2020 2020 2020 2020 290a 0a20 2020  g.        )..   
-00011370: 2064 6566 205f 6361 6368 655f 7769 7468   def _cache_with
-00011380: 5f63 6c75 7374 6572 5f63 6f6c 7328 0a20  _cluster_cols(. 
-00011390: 2020 2020 2020 2073 656c 662c 2061 7272         self, arr
-000113a0: 6179 5f76 616c 7565 3a20 636f 7265 2e41  ay_value: core.A
-000113b0: 7272 6179 5661 6c75 652c 2063 6c75 7374  rrayValue, clust
-000113c0: 6572 5f63 6f6c 733a 2074 7970 696e 672e  er_cols: typing.
-000113d0: 5365 7175 656e 6365 5b73 7472 5d0a 2020  Sequence[str].  
-000113e0: 2020 2920 2d3e 2063 6f72 652e 4172 7261    ) -> core.Arra
-000113f0: 7956 616c 7565 3a0a 2020 2020 2020 2020  yValue:.        
-00011400: 2222 2245 7865 6375 7465 7320 7468 6520  """Executes the 
-00011410: 7175 6572 7920 616e 6420 7573 6573 2074  query and uses t
-00011420: 6865 2072 6573 756c 7469 6e67 2074 6162  he resulting tab
-00011430: 6c65 2074 6f20 7265 7772 6974 6520 6675  le to rewrite fu
-00011440: 7475 7265 2065 7865 6375 7469 6f6e 732e  ture executions.
-00011450: 2222 220a 2020 2020 2020 2020 2320 544f  """.        # TO
-00011460: 444f 3a20 5573 6520 7468 6973 2066 6f72  DO: Use this for
-00011470: 2061 6c6c 2065 7865 6375 7469 6f6e 733f   all executions?
-00011480: 2050 726f 626c 656d 2069 7320 7468 6174   Problem is that
-00011490: 2063 6163 6869 6e67 206d 6174 6572 6961   caching materia
-000114a0: 6c69 7a65 7320 6578 7472 610a 2020 2020  lizes extra.    
-000114b0: 2020 2020 2320 6f72 6465 7269 6e67 2063      # ordering c
-000114c0: 6f6c 756d 6e73 0a20 2020 2020 2020 2063  olumns.        c
-000114d0: 6f6d 7069 6c65 645f 7661 6c75 6520 3d20  ompiled_value = 
-000114e0: 7365 6c66 2e5f 636f 6d70 696c 655f 6f72  self._compile_or
-000114f0: 6465 7265 6428 6172 7261 795f 7661 6c75  dered(array_valu
-00011500: 6529 0a0a 2020 2020 2020 2020 6962 6973  e)..        ibis
-00011510: 5f65 7870 7220 3d20 636f 6d70 696c 6564  _expr = compiled
-00011520: 5f76 616c 7565 2e5f 746f 5f69 6269 735f  _value._to_ibis_
-00011530: 6578 7072 280a 2020 2020 2020 2020 2020  expr(.          
-00011540: 2020 6f72 6465 7269 6e67 5f6d 6f64 653d    ordering_mode=
-00011550: 2275 6e6f 7264 6572 6564 222c 2065 7870  "unordered", exp
-00011560: 6f73 655f 6869 6464 656e 5f63 6f6c 733d  ose_hidden_cols=
-00011570: 5472 7565 0a20 2020 2020 2020 2029 0a20  True.        ). 
-00011580: 2020 2020 2020 2074 6d70 5f74 6162 6c65         tmp_table
-00011590: 203d 2073 656c 662e 5f69 6269 735f 746f   = self._ibis_to
-000115a0: 5f74 656d 705f 7461 626c 6528 0a20 2020  _temp_table(.   
-000115b0: 2020 2020 2020 2020 2069 6269 735f 6578           ibis_ex
-000115c0: 7072 2c20 636c 7573 7465 725f 636f 6c73  pr, cluster_cols
-000115d0: 3d63 6c75 7374 6572 5f63 6f6c 732c 2061  =cluster_cols, a
-000115e0: 7069 5f6e 616d 653d 2263 6163 6865 6422  pi_name="cached"
-000115f0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00011600: 2020 2074 6162 6c65 5f65 7870 7265 7373     table_express
-00011610: 696f 6e20 3d20 7365 6c66 2e69 6269 735f  ion = self.ibis_
-00011620: 636c 6965 6e74 2e74 6162 6c65 280a 2020  client.table(.  
-00011630: 2020 2020 2020 2020 2020 746d 705f 7461            tmp_ta
-00011640: 626c 652e 7461 626c 655f 6964 2c0a 2020  ble.table_id,.  
-00011650: 2020 2020 2020 2020 2020 7363 6865 6d61            schema
-00011660: 3d74 6d70 5f74 6162 6c65 2e64 6174 6173  =tmp_table.datas
-00011670: 6574 5f69 642c 0a20 2020 2020 2020 2020  et_id,.         
-00011680: 2020 2064 6174 6162 6173 653d 746d 705f     database=tmp_
-00011690: 7461 626c 652e 7072 6f6a 6563 742c 0a20  table.project,. 
-000116a0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-000116b0: 206e 6577 5f63 6f6c 756d 6e73 203d 205b   new_columns = [
-000116c0: 7461 626c 655f 6578 7072 6573 7369 6f6e  table_expression
-000116d0: 5b63 6f6c 756d 6e5d 2066 6f72 2063 6f6c  [column] for col
-000116e0: 756d 6e20 696e 2063 6f6d 7069 6c65 645f  umn in compiled_
-000116f0: 7661 6c75 652e 636f 6c75 6d6e 5f69 6473  value.column_ids
-00011700: 5d0a 2020 2020 2020 2020 6e65 775f 6869  ].        new_hi
-00011710: 6464 656e 5f63 6f6c 756d 6e73 203d 205b  dden_columns = [
-00011720: 0a20 2020 2020 2020 2020 2020 2074 6162  .            tab
-00011730: 6c65 5f65 7870 7265 7373 696f 6e5b 636f  le_expression[co
-00011740: 6c75 6d6e 5d0a 2020 2020 2020 2020 2020  lumn].          
-00011750: 2020 666f 7220 636f 6c75 6d6e 2069 6e20    for column in 
-00011760: 636f 6d70 696c 6564 5f76 616c 7565 2e5f  compiled_value._
-00011770: 6869 6464 656e 5f6f 7264 6572 696e 675f  hidden_ordering_
-00011780: 636f 6c75 6d6e 5f6e 616d 6573 0a20 2020  column_names.   
-00011790: 2020 2020 205d 0a20 2020 2020 2020 2023       ].        #
-000117a0: 2054 4f44 4f3a 2049 6e73 7465 6164 2c20   TODO: Instead, 
-000117b0: 6b65 6570 2073 6573 7369 6f6e 2d77 6964  keep session-wid
-000117c0: 6520 6d61 7020 6f66 2063 6163 6865 6420  e map of cached 
-000117d0: 7265 7375 6c74 7320 616e 6420 6175 746f  results and auto
-000117e0: 6d61 7469 6361 6c6c 7920 7265 7573 650a  matically reuse.
-000117f0: 2020 2020 2020 2020 7265 7475 726e 2063          return c
-00011800: 6f72 652e 4172 7261 7956 616c 7565 2e66  ore.ArrayValue.f
-00011810: 726f 6d5f 6962 6973 280a 2020 2020 2020  rom_ibis(.      
-00011820: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-00011830: 2020 2020 2020 2020 7461 626c 655f 6578          table_ex
-00011840: 7072 6573 7369 6f6e 2c0a 2020 2020 2020  pression,.      
-00011850: 2020 2020 2020 636f 6c75 6d6e 733d 6e65        columns=ne
-00011860: 775f 636f 6c75 6d6e 732c 0a20 2020 2020  w_columns,.     
-00011870: 2020 2020 2020 2068 6964 6465 6e5f 6f72         hidden_or
-00011880: 6465 7269 6e67 5f63 6f6c 756d 6e73 3d6e  dering_columns=n
-00011890: 6577 5f68 6964 6465 6e5f 636f 6c75 6d6e  ew_hidden_column
-000118a0: 732c 0a20 2020 2020 2020 2020 2020 206f  s,.            o
-000118b0: 7264 6572 696e 673d 636f 6d70 696c 6564  rdering=compiled
-000118c0: 5f76 616c 7565 2e5f 6f72 6465 7269 6e67  _value._ordering
-000118d0: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-000118e0: 2064 6566 205f 6361 6368 655f 7769 7468   def _cache_with
-000118f0: 5f6f 6666 7365 7473 2873 656c 662c 2061  _offsets(self, a
-00011900: 7272 6179 5f76 616c 7565 3a20 636f 7265  rray_value: core
-00011910: 2e41 7272 6179 5661 6c75 6529 202d 3e20  .ArrayValue) -> 
-00011920: 636f 7265 2e41 7272 6179 5661 6c75 653a  core.ArrayValue:
-00011930: 0a20 2020 2020 2020 2022 2222 4578 6563  .        """Exec
-00011940: 7574 6573 2074 6865 2071 7565 7279 2061  utes the query a
-00011950: 6e64 2075 7365 7320 7468 6520 7265 7375  nd uses the resu
-00011960: 6c74 696e 6720 7461 626c 6520 746f 2072  lting table to r
-00011970: 6577 7269 7465 2066 7574 7572 6520 6578  ewrite future ex
-00011980: 6563 7574 696f 6e73 2e22 2222 0a20 2020  ecutions.""".   
-00011990: 2020 2020 2023 2054 4f44 4f3a 2055 7365       # TODO: Use
-000119a0: 2074 6869 7320 666f 7220 616c 6c20 6578   this for all ex
-000119b0: 6563 7574 696f 6e73 3f20 5072 6f62 6c65  ecutions? Proble
-000119c0: 6d20 6973 2074 6861 7420 6361 6368 696e  m is that cachin
-000119d0: 6720 6d61 7465 7269 616c 697a 6573 2065  g materializes e
-000119e0: 7874 7261 0a20 2020 2020 2020 2023 206f  xtra.        # o
-000119f0: 7264 6572 696e 6720 636f 6c75 6d6e 730a  rdering columns.
-00011a00: 2020 2020 2020 2020 636f 6d70 696c 6564          compiled
-00011a10: 5f76 616c 7565 203d 2073 656c 662e 5f63  _value = self._c
-00011a20: 6f6d 7069 6c65 5f6f 7264 6572 6564 2861  ompile_ordered(a
-00011a30: 7272 6179 5f76 616c 7565 290a 0a20 2020  rray_value)..   
-00011a40: 2020 2020 2069 6269 735f 6578 7072 203d       ibis_expr =
-00011a50: 2063 6f6d 7069 6c65 645f 7661 6c75 652e   compiled_value.
-00011a60: 5f74 6f5f 6962 6973 5f65 7870 7228 0a20  _to_ibis_expr(. 
-00011a70: 2020 2020 2020 2020 2020 206f 7264 6572             order
-00011a80: 696e 675f 6d6f 6465 3d22 6f66 6673 6574  ing_mode="offset
-00011a90: 5f63 6f6c 222c 206f 7264 6572 5f63 6f6c  _col", order_col
-00011aa0: 5f6e 616d 653d 2262 6967 6672 616d 6573  _name="bigframes
-00011ab0: 5f6f 6666 7365 7473 220a 2020 2020 2020  _offsets".      
-00011ac0: 2020 290a 2020 2020 2020 2020 746d 705f    ).        tmp_
-00011ad0: 7461 626c 6520 3d20 7365 6c66 2e5f 6962  table = self._ib
-00011ae0: 6973 5f74 6f5f 7465 6d70 5f74 6162 6c65  is_to_temp_table
-00011af0: 280a 2020 2020 2020 2020 2020 2020 6962  (.            ib
-00011b00: 6973 5f65 7870 722c 2063 6c75 7374 6572  is_expr, cluster
-00011b10: 5f63 6f6c 733d 5b22 6269 6766 7261 6d65  _cols=["bigframe
-00011b20: 735f 6f66 6673 6574 7322 5d2c 2061 7069  s_offsets"], api
-00011b30: 5f6e 616d 653d 2263 6163 6865 6422 0a20  _name="cached". 
-00011b40: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00011b50: 2074 6162 6c65 5f65 7870 7265 7373 696f   table_expressio
-00011b60: 6e20 3d20 7365 6c66 2e69 6269 735f 636c  n = self.ibis_cl
-00011b70: 6965 6e74 2e74 6162 6c65 280a 2020 2020  ient.table(.    
-00011b80: 2020 2020 2020 2020 746d 705f 7461 626c          tmp_tabl
-00011b90: 652e 7461 626c 655f 6964 2c0a 2020 2020  e.table_id,.    
-00011ba0: 2020 2020 2020 2020 7363 6865 6d61 3d74          schema=t
-00011bb0: 6d70 5f74 6162 6c65 2e64 6174 6173 6574  mp_table.dataset
-00011bc0: 5f69 642c 0a20 2020 2020 2020 2020 2020  _id,.           
-00011bd0: 2064 6174 6162 6173 653d 746d 705f 7461   database=tmp_ta
-00011be0: 626c 652e 7072 6f6a 6563 742c 0a20 2020  ble.project,.   
-00011bf0: 2020 2020 2029 0a20 2020 2020 2020 206e       ).        n
-00011c00: 6577 5f63 6f6c 756d 6e73 203d 205b 7461  ew_columns = [ta
-00011c10: 626c 655f 6578 7072 6573 7369 6f6e 5b63  ble_expression[c
-00011c20: 6f6c 756d 6e5d 2066 6f72 2063 6f6c 756d  olumn] for colum
-00011c30: 6e20 696e 2063 6f6d 7069 6c65 645f 7661  n in compiled_va
-00011c40: 6c75 652e 636f 6c75 6d6e 5f69 6473 5d0a  lue.column_ids].
-00011c50: 2020 2020 2020 2020 6e65 775f 6869 6464          new_hidd
-00011c60: 656e 5f63 6f6c 756d 6e73 203d 205b 7461  en_columns = [ta
-00011c70: 626c 655f 6578 7072 6573 7369 6f6e 5b22  ble_expression["
-00011c80: 6269 6766 7261 6d65 735f 6f66 6673 6574  bigframes_offset
-00011c90: 7322 5d5d 0a20 2020 2020 2020 2023 2054  s"]].        # T
-00011ca0: 4f44 4f3a 2049 6e73 7465 6164 2c20 6b65  ODO: Instead, ke
-00011cb0: 6570 2073 6573 7369 6f6e 2d77 6964 6520  ep session-wide 
-00011cc0: 6d61 7020 6f66 2063 6163 6865 6420 7265  map of cached re
-00011cd0: 7375 6c74 7320 616e 6420 6175 746f 6d61  sults and automa
-00011ce0: 7469 6361 6c6c 7920 7265 7573 650a 2020  tically reuse.  
-00011cf0: 2020 2020 2020 7265 7475 726e 2063 6f72        return cor
-00011d00: 652e 4172 7261 7956 616c 7565 2e66 726f  e.ArrayValue.fro
-00011d10: 6d5f 6962 6973 280a 2020 2020 2020 2020  m_ibis(.        
-00011d20: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-00011d30: 2020 2020 2020 7461 626c 655f 6578 7072        table_expr
-00011d40: 6573 7369 6f6e 2c0a 2020 2020 2020 2020  ession,.        
-00011d50: 2020 2020 636f 6c75 6d6e 733d 6e65 775f      columns=new_
-00011d60: 636f 6c75 6d6e 732c 0a20 2020 2020 2020  columns,.       
-00011d70: 2020 2020 2068 6964 6465 6e5f 6f72 6465       hidden_orde
-00011d80: 7269 6e67 5f63 6f6c 756d 6e73 3d6e 6577  ring_columns=new
-00011d90: 5f68 6964 6465 6e5f 636f 6c75 6d6e 732c  _hidden_columns,
-00011da0: 0a20 2020 2020 2020 2020 2020 206f 7264  .            ord
-00011db0: 6572 696e 673d 6f72 6465 722e 4578 7072  ering=order.Expr
-00011dc0: 6573 7369 6f6e 4f72 6465 7269 6e67 2e66  essionOrdering.f
-00011dd0: 726f 6d5f 6f66 6673 6574 5f63 6f6c 2822  rom_offset_col("
-00011de0: 6269 6766 7261 6d65 735f 6f66 6673 6574  bigframes_offset
-00011df0: 7322 292c 0a20 2020 2020 2020 2029 0a0a  s"),.        )..
-00011e00: 2020 2020 6465 6620 5f73 696d 706c 6966      def _simplif
-00011e10: 795f 7769 7468 5f63 6163 6869 6e67 2873  y_with_caching(s
-00011e20: 656c 662c 2061 7272 6179 5f76 616c 7565  elf, array_value
-00011e30: 3a20 636f 7265 2e41 7272 6179 5661 6c75  : core.ArrayValu
-00011e40: 6529 202d 3e20 636f 7265 2e41 7272 6179  e) -> core.Array
-00011e50: 5661 6c75 653a 0a20 2020 2020 2020 2022  Value:.        "
-00011e60: 2222 4174 7465 6d70 7473 2074 6f20 6861  ""Attempts to ha
-00011e70: 6e64 6c65 2074 6865 2063 6f6d 706c 6578  ndle the complex
-00011e80: 6974 7920 6279 2063 6163 6869 6e67 2064  ity by caching d
-00011e90: 7570 6c69 6361 7465 6420 7375 6274 7265  uplicated subtre
-00011ea0: 6573 2061 6e64 2062 7265 616b 696e 6720  es and breaking 
-00011eb0: 7468 6520 7175 6572 7920 696e 746f 2070  the query into p
-00011ec0: 6965 6365 732e 2222 220a 2020 2020 2020  ieces.""".      
-00011ed0: 2020 6966 206e 6f74 2062 6967 6672 616d    if not bigfram
-00011ee0: 6573 2e6f 7074 696f 6e73 2e63 6f6d 7075  es.options.compu
-00011ef0: 7465 2e65 6e61 626c 655f 6d75 6c74 695f  te.enable_multi_
-00011f00: 7175 6572 795f 6578 6563 7574 696f 6e3a  query_execution:
-00011f10: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00011f20: 7572 6e20 6172 7261 795f 7661 6c75 650a  urn array_value.
-00011f30: 2020 2020 2020 2020 6e6f 6465 203d 2061          node = a
-00011f40: 7272 6179 5f76 616c 7565 2e6e 6f64 650a  rray_value.node.
-00011f50: 2020 2020 2020 2020 6966 206e 6f64 652e          if node.
-00011f60: 706c 616e 6e69 6e67 5f63 6f6d 706c 6578  planning_complex
-00011f70: 6974 7920 3c20 5155 4552 595f 434f 4d50  ity < QUERY_COMP
-00011f80: 4c45 5849 5459 5f4c 494d 4954 3a0a 2020  LEXITY_LIMIT:.  
-00011f90: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00011fa0: 2061 7272 6179 5f76 616c 7565 0a0a 2020   array_value..  
-00011fb0: 2020 2020 2020 666f 7220 5f20 696e 2072        for _ in r
-00011fc0: 616e 6765 284d 4158 5f53 5542 5452 4545  ange(MAX_SUBTREE
-00011fd0: 5f46 4143 544f 5249 4e47 5329 3a0a 2020  _FACTORINGS):.  
-00011fe0: 2020 2020 2020 2020 2020 7570 6461 7465            update
-00011ff0: 6420 3d20 7365 6c66 2e5f 6361 6368 655f  d = self._cache_
-00012000: 6d6f 7374 5f63 6f6d 706c 6578 5f73 7562  most_complex_sub
-00012010: 7472 6565 286e 6f64 6529 0a20 2020 2020  tree(node).     
-00012020: 2020 2020 2020 2069 6620 7570 6461 7465         if update
-00012030: 6420 6973 204e 6f6e 653a 0a20 2020 2020  d is None:.     
-00012040: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00012050: 6e20 636f 7265 2e41 7272 6179 5661 6c75  n core.ArrayValu
-00012060: 6528 6e6f 6465 290a 2020 2020 2020 2020  e(node).        
-00012070: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00012080: 2020 2020 2020 2020 2020 6e6f 6465 203d            node =
-00012090: 2075 7064 6174 6564 0a0a 2020 2020 2020   updated..      
-000120a0: 2020 7265 7475 726e 2063 6f72 652e 4172    return core.Ar
-000120b0: 7261 7956 616c 7565 286e 6f64 6529 0a0a  rayValue(node)..
-000120c0: 2020 2020 6465 6620 5f63 6163 6865 5f6d      def _cache_m
-000120d0: 6f73 745f 636f 6d70 6c65 785f 7375 6274  ost_complex_subt
-000120e0: 7265 6528 0a20 2020 2020 2020 2073 656c  ree(.        sel
-000120f0: 662c 206e 6f64 653a 206e 6f64 6573 2e42  f, node: nodes.B
-00012100: 6967 4672 616d 654e 6f64 650a 2020 2020  igFrameNode.    
-00012110: 2920 2d3e 204f 7074 696f 6e61 6c5b 6e6f  ) -> Optional[no
-00012120: 6465 732e 4269 6746 7261 6d65 4e6f 6465  des.BigFrameNode
-00012130: 5d3a 0a20 2020 2020 2020 2023 2054 4f44  ]:.        # TOD
-00012140: 4f3a 2049 6620 7175 6572 7920 6661 696c  O: If query fail
-00012150: 732c 2072 6574 7279 2077 6974 6820 6c6f  s, retry with lo
-00012160: 7765 7220 636f 6d70 6c65 7869 7479 206c  wer complexity l
-00012170: 696d 6974 0a20 2020 2020 2020 2076 616c  imit.        val
-00012180: 6964 5f63 616e 6469 6461 7465 7320 3d20  id_candidates = 
-00012190: 7472 6176 6572 7361 6c73 2e63 6f75 6e74  traversals.count
-000121a0: 5f63 6f6d 706c 6578 5f6e 6f64 6573 280a  _complex_nodes(.
-000121b0: 2020 2020 2020 2020 2020 2020 6e6f 6465              node
-000121c0: 2c0a 2020 2020 2020 2020 2020 2020 6d69  ,.            mi
-000121d0: 6e5f 636f 6d70 6c65 7869 7479 3d28 5155  n_complexity=(QU
-000121e0: 4552 595f 434f 4d50 4c45 5849 5459 5f4c  ERY_COMPLEXITY_L
-000121f0: 494d 4954 202f 2035 3030 292c 0a20 2020  IMIT / 500),.   
-00012200: 2020 2020 2020 2020 206d 6178 5f63 6f6d           max_com
-00012210: 706c 6578 6974 793d 5155 4552 595f 434f  plexity=QUERY_CO
-00012220: 4d50 4c45 5849 5459 5f4c 494d 4954 2c0a  MPLEXITY_LIMIT,.
-00012230: 2020 2020 2020 2020 292e 6974 656d 7328          ).items(
-00012240: 290a 2020 2020 2020 2020 2320 4865 7572  ).        # Heur
-00012250: 6973 7469 633a 2073 7562 7472 6565 5f63  istic: subtree_c
-00012260: 6f6d 706c 6569 7874 7920 2a20 2863 6f70  ompleixty * (cop
-00012270: 6965 7320 6f66 2073 7562 7472 6565 295e  ies of subtree)^
-00012280: 320a 2020 2020 2020 2020 6265 7374 5f63  2.        best_c
-00012290: 616e 6469 6461 7465 203d 206d 6178 280a  andidate = max(.
-000122a0: 2020 2020 2020 2020 2020 2020 7661 6c69              vali
-000122b0: 645f 6361 6e64 6964 6174 6573 2c0a 2020  d_candidates,.  
-000122c0: 2020 2020 2020 2020 2020 6b65 793d 6c61            key=la
-000122d0: 6d62 6461 2069 3a20 695b 305d 2e70 6c61  mbda i: i[0].pla
-000122e0: 6e6e 696e 675f 636f 6d70 6c65 7869 7479  nning_complexity
-000122f0: 202b 2028 695b 315d 202a 2a20 3229 2c0a   + (i[1] ** 2),.
-00012300: 2020 2020 2020 2020 2020 2020 6465 6661              defa
-00012310: 756c 743d 4e6f 6e65 2c0a 2020 2020 2020  ult=None,.      
-00012320: 2020 290a 0a20 2020 2020 2020 2069 6620    )..        if 
-00012330: 6265 7374 5f63 616e 6469 6461 7465 2069  best_candidate i
-00012340: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-00012350: 2020 2020 2320 4e6f 2067 6f6f 6420 7375      # No good su
-00012360: 6274 7265 6573 2074 6f20 6361 6368 652c  btrees to cache,
-00012370: 206a 7573 7420 7265 7475 726e 206f 7269   just return ori
-00012380: 6769 6e61 6c20 7472 6565 0a20 2020 2020  ginal tree.     
-00012390: 2020 2020 2020 2072 6574 7572 6e20 4e6f         return No
-000123a0: 6e65 0a0a 2020 2020 2020 2020 2320 544f  ne..        # TO
-000123b0: 444f 3a20 4164 6420 636c 7573 7465 7269  DO: Add clusteri
-000123c0: 6e67 2063 6f6c 756d 6e73 2062 6173 6564  ng columns based
-000123d0: 206f 6e20 6163 6365 7373 2070 6174 7465   on access patte
-000123e0: 726e 730a 2020 2020 2020 2020 6d61 7465  rns.        mate
-000123f0: 7269 616c 697a 6564 203d 2073 656c 662e  rialized = self.
-00012400: 5f63 6163 6865 5f77 6974 685f 636c 7573  _cache_with_clus
-00012410: 7465 725f 636f 6c73 280a 2020 2020 2020  ter_cols(.      
-00012420: 2020 2020 2020 636f 7265 2e41 7272 6179        core.Array
-00012430: 5661 6c75 6528 6265 7374 5f63 616e 6469  Value(best_candi
-00012440: 6461 7465 5b30 5d29 2c20 5b5d 0a20 2020  date[0]), [].   
-00012450: 2020 2020 2029 2e6e 6f64 650a 0a20 2020       ).node..   
-00012460: 2020 2020 2072 6574 7572 6e20 7472 6176       return trav
-00012470: 6572 7361 6c73 2e72 6570 6c61 6365 5f6e  ersals.replace_n
-00012480: 6f64 6573 280a 2020 2020 2020 2020 2020  odes(.          
-00012490: 2020 6e6f 6465 2c20 746f 5f72 6570 6c61    node, to_repla
-000124a0: 6365 3d62 6573 745f 6361 6e64 6964 6174  ce=best_candidat
-000124b0: 655b 305d 2c20 7265 706c 6163 656d 656e  e[0], replacemen
-000124c0: 6574 3d6d 6174 6572 6961 6c69 7a65 640a  et=materialized.
-000124d0: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-000124e0: 6566 205f 6973 5f74 7269 7669 616c 6c79  ef _is_trivially
-000124f0: 5f65 7865 6375 7461 626c 6528 7365 6c66  _executable(self
-00012500: 2c20 6172 7261 795f 7661 6c75 653a 2063  , array_value: c
-00012510: 6f72 652e 4172 7261 7956 616c 7565 293a  ore.ArrayValue):
-00012520: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00012530: 2020 2020 2043 616e 2074 6865 2062 6c6f       Can the blo
-00012540: 636b 2062 6520 6576 616c 7561 7465 6420  ck be evaluated 
-00012550: 7665 7279 2063 6865 6170 6c79 3f0a 2020  very cheaply?.  
-00012560: 2020 2020 2020 4966 2054 7275 652c 2074        If True, t
-00012570: 6865 2061 7272 6179 5f76 616c 7565 2070  he array_value p
-00012580: 726f 6261 626c 7920 6973 206e 6f74 2077  robably is not w
-00012590: 6f72 7468 2063 6163 6869 6e67 2e0a 2020  orth caching..  
-000125a0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000125b0: 2020 2320 4f6e 6365 2072 6577 7269 7469    # Once rewriti
-000125c0: 6e67 2069 7320 6176 6169 6c61 626c 652c  ng is available,
-000125d0: 2077 696c 6c20 7761 6e74 2074 6f20 7265   will want to re
-000125e0: 7772 6974 6520 6265 666f 7265 0a20 2020  write before.   
-000125f0: 2020 2020 2023 2065 7661 6c75 6174 696e       # evaluatin
-00012600: 6720 6578 6563 7574 696f 6e20 636f 7374  g execution cost
-00012610: 2e0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00012620: 2074 7261 7665 7273 616c 732e 6973 5f74   traversals.is_t
-00012630: 7269 7669 616c 6c79 5f65 7865 6375 7461  rivially_executa
-00012640: 626c 6528 6172 7261 795f 7661 6c75 652e  ble(array_value.
-00012650: 6e6f 6465 290a 0a20 2020 2064 6566 205f  node)..    def _
-00012660: 6578 6563 7574 6528 0a20 2020 2020 2020  execute(.       
-00012670: 2073 656c 662c 0a20 2020 2020 2020 2061   self,.        a
-00012680: 7272 6179 5f76 616c 7565 3a20 636f 7265  rray_value: core
-00012690: 2e41 7272 6179 5661 6c75 652c 0a20 2020  .ArrayValue,.   
-000126a0: 2020 2020 206a 6f62 5f63 6f6e 6669 673a       job_config:
-000126b0: 204f 7074 696f 6e61 6c5b 6269 6771 7565   Optional[bigque
-000126c0: 7279 2e6a 6f62 2e51 7565 7279 4a6f 6243  ry.job.QueryJobC
-000126d0: 6f6e 6669 675d 203d 204e 6f6e 652c 0a20  onfig] = None,. 
-000126e0: 2020 2020 2020 202a 2c0a 2020 2020 2020         *,.      
-000126f0: 2020 736f 7274 6564 3a20 626f 6f6c 203d    sorted: bool =
-00012700: 2054 7275 652c 0a20 2020 2020 2020 2064   True,.        d
-00012710: 7279 5f72 756e 3d46 616c 7365 2c0a 2020  ry_run=False,.  
-00012720: 2020 2020 2020 636f 6c5f 6964 5f6f 7665        col_id_ove
-00012730: 7272 6964 6573 3a20 4d61 7070 696e 675b  rrides: Mapping[
-00012740: 7374 722c 2073 7472 5d20 3d20 7b7d 2c0a  str, str] = {},.
-00012750: 2020 2020 2920 2d3e 2074 7570 6c65 5b62      ) -> tuple[b
-00012760: 6967 7175 6572 792e 7461 626c 652e 526f  igquery.table.Ro
-00012770: 7749 7465 7261 746f 722c 2062 6967 7175  wIterator, bigqu
-00012780: 6572 792e 5175 6572 794a 6f62 5d3a 0a20  ery.QueryJob]:. 
-00012790: 2020 2020 2020 2073 716c 203d 2073 656c         sql = sel
-000127a0: 662e 5f74 6f5f 7371 6c28 0a20 2020 2020  f._to_sql(.     
-000127b0: 2020 2020 2020 2061 7272 6179 5f76 616c         array_val
-000127c0: 7565 2c20 736f 7274 6564 3d73 6f72 7465  ue, sorted=sorte
-000127d0: 642c 2063 6f6c 5f69 645f 6f76 6572 7269  d, col_id_overri
-000127e0: 6465 733d 636f 6c5f 6964 5f6f 7665 7272  des=col_id_overr
-000127f0: 6964 6573 0a20 2020 2020 2020 2029 2020  ides.        )  
-00012800: 2320 7479 7065 3a69 676e 6f72 650a 2020  # type:ignore.  
-00012810: 2020 2020 2020 6966 206a 6f62 5f63 6f6e        if job_con
-00012820: 6669 6720 6973 204e 6f6e 653a 0a20 2020  fig is None:.   
-00012830: 2020 2020 2020 2020 206a 6f62 5f63 6f6e           job_con
-00012840: 6669 6720 3d20 6269 6771 7565 7279 2e51  fig = bigquery.Q
-00012850: 7565 7279 4a6f 6243 6f6e 6669 6728 6472  ueryJobConfig(dr
-00012860: 795f 7275 6e3d 6472 795f 7275 6e29 0a20  y_run=dry_run). 
-00012870: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00012880: 2020 2020 2020 2020 206a 6f62 5f63 6f6e           job_con
-00012890: 6669 672e 6472 795f 7275 6e20 3d20 6472  fig.dry_run = dr
-000128a0: 795f 7275 6e0a 2020 2020 2020 2020 7265  y_run.        re
-000128b0: 7475 726e 2073 656c 662e 5f73 7461 7274  turn self._start
-000128c0: 5f71 7565 7279 280a 2020 2020 2020 2020  _query(.        
-000128d0: 2020 2020 7371 6c3d 7371 6c2c 0a20 2020      sql=sql,.   
-000128e0: 2020 2020 2020 2020 206a 6f62 5f63 6f6e           job_con
-000128f0: 6669 673d 6a6f 625f 636f 6e66 6967 2c0a  fig=job_config,.
-00012900: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-00012910: 6566 205f 7065 656b 280a 2020 2020 2020  ef _peek(.      
-00012920: 2020 7365 6c66 2c20 6172 7261 795f 7661    self, array_va
-00012930: 6c75 653a 2063 6f72 652e 4172 7261 7956  lue: core.ArrayV
-00012940: 616c 7565 2c20 6e5f 726f 7773 3a20 696e  alue, n_rows: in
-00012950: 740a 2020 2020 2920 2d3e 2074 7570 6c65  t.    ) -> tuple
-00012960: 5b62 6967 7175 6572 792e 7461 626c 652e  [bigquery.table.
-00012970: 526f 7749 7465 7261 746f 722c 2062 6967  RowIterator, big
-00012980: 7175 6572 792e 5175 6572 794a 6f62 5d3a  query.QueryJob]:
-00012990: 0a20 2020 2020 2020 2022 2222 4120 2770  .        """A 'p
-000129a0: 6565 6b27 2065 6666 6963 6965 6e74 6c79  eek' efficiently
-000129b0: 2061 6363 6573 7365 7320 6120 736d 616c   accesses a smal
-000129c0: 6c20 6e75 6d62 6572 206f 6620 726f 7773  l number of rows
-000129d0: 2069 6e20 7468 6520 6461 7461 6672 616d   in the datafram
-000129e0: 652e 2222 220a 2020 2020 2020 2020 6966  e.""".        if
-000129f0: 206e 6f74 2074 7265 655f 7072 6f70 6572   not tree_proper
-00012a00: 7469 6573 2e70 6565 6b61 626c 6528 6172  ties.peekable(ar
-00012a10: 7261 795f 7661 6c75 652e 6e6f 6465 293a  ray_value.node):
-00012a20: 0a20 2020 2020 2020 2020 2020 2077 6172  .            war
-00012a30: 6e69 6e67 732e 7761 726e 2822 5065 656b  nings.warn("Peek
-00012a40: 696e 6720 7468 6973 2076 616c 7565 2063  ing this value c
-00012a50: 616e 6e6f 7420 6265 2064 6f6e 6520 6566  annot be done ef
-00012a60: 6669 6369 656e 746c 792e 2229 0a20 2020  ficiently.").   
-00012a70: 2020 2020 2073 716c 203d 2073 656c 662e       sql = self.
-00012a80: 5f63 6f6d 7069 6c65 5f75 6e6f 7264 6572  _compile_unorder
-00012a90: 6564 2861 7272 6179 5f76 616c 7565 292e  ed(array_value).
-00012aa0: 7065 656b 5f73 716c 286e 5f72 6f77 7329  peek_sql(n_rows)
-00012ab0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00012ac0: 7365 6c66 2e5f 7374 6172 745f 7175 6572  self._start_quer
-00012ad0: 7928 0a20 2020 2020 2020 2020 2020 2073  y(.            s
-00012ae0: 716c 3d73 716c 2c0a 2020 2020 2020 2020  ql=sql,.        
-00012af0: 290a 0a20 2020 2064 6566 205f 746f 5f73  )..    def _to_s
-00012b00: 716c 280a 2020 2020 2020 2020 7365 6c66  ql(.        self
-00012b10: 2c0a 2020 2020 2020 2020 6172 7261 795f  ,.        array_
-00012b20: 7661 6c75 653a 2063 6f72 652e 4172 7261  value: core.Arra
-00012b30: 7956 616c 7565 2c0a 2020 2020 2020 2020  yValue,.        
-00012b40: 6f66 6673 6574 5f63 6f6c 756d 6e3a 2074  offset_column: t
-00012b50: 7970 696e 672e 4f70 7469 6f6e 616c 5b73  yping.Optional[s
-00012b60: 7472 5d20 3d20 4e6f 6e65 2c0a 2020 2020  tr] = None,.    
-00012b70: 2020 2020 636f 6c5f 6964 5f6f 7665 7272      col_id_overr
-00012b80: 6964 6573 3a20 7479 7069 6e67 2e4d 6170  ides: typing.Map
-00012b90: 7069 6e67 5b73 7472 2c20 7374 725d 203d  ping[str, str] =
-00012ba0: 207b 7d2c 0a20 2020 2020 2020 2073 6f72   {},.        sor
-00012bb0: 7465 643a 2062 6f6f 6c20 3d20 4661 6c73  ted: bool = Fals
-00012bc0: 652c 0a20 2020 2029 202d 3e20 7374 723a  e,.    ) -> str:
-00012bd0: 0a20 2020 2020 2020 2069 6620 6f66 6673  .        if offs
-00012be0: 6574 5f63 6f6c 756d 6e3a 0a20 2020 2020  et_column:.     
-00012bf0: 2020 2020 2020 2061 7272 6179 5f76 616c         array_val
-00012c00: 7565 203d 2061 7272 6179 5f76 616c 7565  ue = array_value
-00012c10: 2e70 726f 6d6f 7465 5f6f 6666 7365 7473  .promote_offsets
-00012c20: 286f 6666 7365 745f 636f 6c75 6d6e 290a  (offset_column).
-00012c30: 2020 2020 2020 2020 6966 2073 6f72 7465          if sorte
-00012c40: 643a 0a20 2020 2020 2020 2020 2020 2072  d:.            r
-00012c50: 6574 7572 6e20 7365 6c66 2e5f 636f 6d70  eturn self._comp
-00012c60: 696c 655f 6f72 6465 7265 6428 6172 7261  ile_ordered(arra
-00012c70: 795f 7661 6c75 6529 2e74 6f5f 7371 6c28  y_value).to_sql(
-00012c80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012c90: 2063 6f6c 5f69 645f 6f76 6572 7269 6465   col_id_override
-00012ca0: 733d 636f 6c5f 6964 5f6f 7665 7272 6964  s=col_id_overrid
-00012cb0: 6573 2c20 736f 7274 6564 3d54 7275 650a  es, sorted=True.
-00012cc0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00012cd0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00012ce0: 662e 5f63 6f6d 7069 6c65 5f75 6e6f 7264  f._compile_unord
-00012cf0: 6572 6564 2861 7272 6179 5f76 616c 7565  ered(array_value
-00012d00: 292e 746f 5f73 716c 280a 2020 2020 2020  ).to_sql(.      
-00012d10: 2020 2020 2020 636f 6c5f 6964 5f6f 7665        col_id_ove
-00012d20: 7272 6964 6573 3d63 6f6c 5f69 645f 6f76  rrides=col_id_ov
-00012d30: 6572 7269 6465 730a 2020 2020 2020 2020  errides.        
-00012d40: 290a 0a20 2020 2064 6566 205f 636f 6d70  )..    def _comp
-00012d50: 696c 655f 6f72 6465 7265 6428 0a20 2020  ile_ordered(.   
-00012d60: 2020 2020 2073 656c 662c 2061 7272 6179       self, array
-00012d70: 5f76 616c 7565 3a20 636f 7265 2e41 7272  _value: core.Arr
-00012d80: 6179 5661 6c75 650a 2020 2020 2920 2d3e  ayValue.    ) ->
-00012d90: 2062 6967 6672 616d 6573 2e63 6f72 652e   bigframes.core.
-00012da0: 636f 6d70 696c 652e 4f72 6465 7265 6449  compile.OrderedI
-00012db0: 523a 0a20 2020 2020 2020 2072 6574 7572  R:.        retur
-00012dc0: 6e20 6269 6766 7261 6d65 732e 636f 7265  n bigframes.core
-00012dd0: 2e63 6f6d 7069 6c65 2e63 6f6d 7069 6c65  .compile.compile
-00012de0: 5f6f 7264 6572 6564 5f69 7228 6172 7261  _ordered_ir(arra
-00012df0: 795f 7661 6c75 652e 6e6f 6465 290a 0a20  y_value.node).. 
-00012e00: 2020 2064 6566 205f 636f 6d70 696c 655f     def _compile_
-00012e10: 756e 6f72 6465 7265 6428 0a20 2020 2020  unordered(.     
-00012e20: 2020 2073 656c 662c 2061 7272 6179 5f76     self, array_v
-00012e30: 616c 7565 3a20 636f 7265 2e41 7272 6179  alue: core.Array
-00012e40: 5661 6c75 650a 2020 2020 2920 2d3e 2062  Value.    ) -> b
-00012e50: 6967 6672 616d 6573 2e63 6f72 652e 636f  igframes.core.co
-00012e60: 6d70 696c 652e 556e 6f72 6465 7265 6449  mpile.UnorderedI
-00012e70: 523a 0a20 2020 2020 2020 2072 6574 7572  R:.        retur
-00012e80: 6e20 6269 6766 7261 6d65 732e 636f 7265  n bigframes.core
-00012e90: 2e63 6f6d 7069 6c65 2e63 6f6d 7069 6c65  .compile.compile
-00012ea0: 5f75 6e6f 7264 6572 6564 5f69 7228 6172  _unordered_ir(ar
-00012eb0: 7261 795f 7661 6c75 652e 6e6f 6465 290a  ray_value.node).
-00012ec0: 0a20 2020 2064 6566 205f 6765 745f 7461  .    def _get_ta
-00012ed0: 626c 655f 7369 7a65 2873 656c 662c 2064  ble_size(self, d
-00012ee0: 6573 7469 6e61 7469 6f6e 5f74 6162 6c65  estination_table
-00012ef0: 293a 0a20 2020 2020 2020 2074 6162 6c65  ):.        table
-00012f00: 203d 2073 656c 662e 6271 636c 6965 6e74   = self.bqclient
-00012f10: 2e67 6574 5f74 6162 6c65 2864 6573 7469  .get_table(desti
-00012f20: 6e61 7469 6f6e 5f74 6162 6c65 290a 2020  nation_table).  
-00012f30: 2020 2020 2020 7265 7475 726e 2074 6162        return tab
-00012f40: 6c65 2e6e 756d 5f62 7974 6573 0a0a 2020  le.num_bytes..  
-00012f50: 2020 6465 6620 5f72 6f77 735f 746f 5f64    def _rows_to_d
-00012f60: 6174 6166 7261 6d65 280a 2020 2020 2020  ataframe(.      
-00012f70: 2020 7365 6c66 2c20 726f 775f 6974 6572    self, row_iter
-00012f80: 6174 6f72 3a20 6269 6771 7565 7279 2e74  ator: bigquery.t
-00012f90: 6162 6c65 2e52 6f77 4974 6572 6174 6f72  able.RowIterator
-00012fa0: 2c20 6474 7970 6573 3a20 4469 6374 0a20  , dtypes: Dict. 
-00012fb0: 2020 2029 202d 3e20 7061 6e64 6173 2e44     ) -> pandas.D
-00012fc0: 6174 6146 7261 6d65 3a0a 2020 2020 2020  ataFrame:.      
-00012fd0: 2020 2320 4361 6e20 6967 6e6f 7265 2069    # Can ignore i
-00012fe0: 6e66 6572 7265 6420 6461 7461 7479 7065  nferred datatype
-00012ff0: 2075 6e74 696c 2064 7479 7065 2065 6d75   until dtype emu
-00013000: 6c61 7469 6f6e 2062 7265 616b 7320 313a  lation breaks 1:
-00013010: 3120 6d61 7070 696e 6720 6265 7477 6565  1 mapping betwee
-00013020: 6e20 4251 2074 7970 6573 2061 6e64 2062  n BQ types and b
-00013030: 6967 6672 616d 6573 2074 7970 6573 0a20  igframes types. 
-00013040: 2020 2020 2020 2064 7479 7065 735f 6672         dtypes_fr
-00013050: 6f6d 5f62 7120 3d20 6269 6766 7261 6d65  om_bq = bigframe
-00013060: 732e 6474 7970 6573 2e62 665f 7479 7065  s.dtypes.bf_type
-00013070: 5f66 726f 6d5f 7479 7065 5f6b 696e 6428  _from_type_kind(
-00013080: 726f 775f 6974 6572 6174 6f72 2e73 6368  row_iterator.sch
-00013090: 656d 6129 0a20 2020 2020 2020 2061 7272  ema).        arr
-000130a0: 6f77 5f74 6162 6c65 203d 2072 6f77 5f69  ow_table = row_i
-000130b0: 7465 7261 746f 722e 746f 5f61 7272 6f77  terator.to_arrow
-000130c0: 2829 0a20 2020 2020 2020 2072 6574 7572  ().        retur
-000130d0: 6e20 6269 6766 7261 6d65 732e 7365 7373  n bigframes.sess
-000130e0: 696f 6e2e 5f69 6f2e 7061 6e64 6173 2e61  ion._io.pandas.a
-000130f0: 7272 6f77 5f74 6f5f 7061 6e64 6173 2861  rrow_to_pandas(a
-00013100: 7272 6f77 5f74 6162 6c65 2c20 6474 7970  rrow_table, dtyp
-00013110: 6573 5f66 726f 6d5f 6271 290a 0a20 2020  es_from_bq)..   
-00013120: 2064 6566 205f 7374 6172 745f 6765 6e65   def _start_gene
-00013130: 7269 635f 6a6f 6228 7365 6c66 2c20 6a6f  ric_job(self, jo
-00013140: 623a 2066 6f72 6d61 7474 696e 675f 6865  b: formatting_he
-00013150: 6c70 6572 732e 4765 6e65 7269 634a 6f62  lpers.GenericJob
-00013160: 293a 0a20 2020 2020 2020 2069 6620 6269  ):.        if bi
-00013170: 6766 7261 6d65 732e 6f70 7469 6f6e 732e  gframes.options.
-00013180: 6469 7370 6c61 792e 7072 6f67 7265 7373  display.progress
-00013190: 5f62 6172 2069 7320 6e6f 7420 4e6f 6e65  _bar is not None
-000131a0: 3a0a 2020 2020 2020 2020 2020 2020 666f  :.            fo
-000131b0: 726d 6174 7469 6e67 5f68 656c 7065 7273  rmatting_helpers
-000131c0: 2e77 6169 745f 666f 725f 6a6f 6228 0a20  .wait_for_job(. 
-000131d0: 2020 2020 2020 2020 2020 2020 2020 206a                 j
-000131e0: 6f62 2c20 6269 6766 7261 6d65 732e 6f70  ob, bigframes.op
-000131f0: 7469 6f6e 732e 6469 7370 6c61 792e 7072  tions.display.pr
-00013200: 6f67 7265 7373 5f62 6172 0a20 2020 2020  ogress_bar.     
-00013210: 2020 2020 2020 2029 2020 2320 5761 6974         )  # Wait
-00013220: 2066 6f72 2074 6865 206a 6f62 2074 6f20   for the job to 
-00013230: 636f 6d70 6c65 7465 0a20 2020 2020 2020  complete.       
-00013240: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00013250: 2020 206a 6f62 2e72 6573 756c 7428 290a     job.result().
-00013260: 0a20 2020 2064 6566 205f 7261 6e64 6f6d  .    def _random
-00013270: 5f74 6162 6c65 2873 656c 662c 2073 6b69  _table(self, ski
-00013280: 705f 636c 6561 6e75 703a 2062 6f6f 6c20  p_cleanup: bool 
-00013290: 3d20 4661 6c73 6529 202d 3e20 6269 6771  = False) -> bigq
-000132a0: 7565 7279 2e54 6162 6c65 5265 6665 7265  uery.TableRefere
-000132b0: 6e63 653a 0a20 2020 2020 2020 2022 2222  nce:.        """
-000132c0: 4765 6e65 7261 7465 2061 2072 616e 646f  Generate a rando
-000132d0: 6d20 7461 626c 6520 4944 2077 6974 6820  m table ID with 
-000132e0: 4269 6751 7565 7279 2044 6174 6146 7261  BigQuery DataFra
-000132f0: 6d65 7320 7072 6566 6978 2e0a 0a20 2020  mes prefix...   
-00013300: 2020 2020 2054 6865 2067 656e 6572 6174       The generat
-00013310: 6564 2049 4420 7769 6c6c 2062 6520 7374  ed ID will be st
-00013320: 6f72 6564 2061 6e64 2063 6865 636b 6564  ored and checked
-00013330: 2066 6f72 2064 656c 6574 696f 6e20 7768   for deletion wh
-00013340: 656e 2074 6865 0a20 2020 2020 2020 2073  en the.        s
-00013350: 6573 7369 6f6e 2069 7320 636c 6f73 6564  ession is closed
-00013360: 2c20 756e 6c65 7373 2073 6b69 705f 636c  , unless skip_cl
-00013370: 6561 6e75 7020 6973 2054 7275 652e 0a0a  eanup is True...
-00013380: 2020 2020 2020 2020 4172 6773 3a0a 2020          Args:.  
-00013390: 2020 2020 2020 2020 2020 736b 6970 5f63            skip_c
-000133a0: 6c65 616e 7570 2028 626f 6f6c 2c20 6465  leanup (bool, de
-000133b0: 6661 756c 7420 4661 6c73 6529 3a0a 2020  fault False):.  
-000133c0: 2020 2020 2020 2020 2020 2020 2020 4966                If
-000133d0: 2054 7275 652c 2064 6f20 6e6f 7420 6164   True, do not ad
-000133e0: 6420 7468 6520 6765 6e65 7261 7465 6420  d the generated 
-000133f0: 4944 2074 6f20 7468 6520 6c69 7374 206f  ID to the list o
-00013400: 6620 7461 626c 6573 0a20 2020 2020 2020  f tables.       
-00013410: 2020 2020 2020 2020 2074 6f20 636c 6561           to clea
-00013420: 6e20 7570 2077 6865 6e20 7468 6520 7365  n up when the se
-00013430: 7373 696f 6e20 6973 2063 6c6f 7365 642e  ssion is closed.
-00013440: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-00013450: 733a 0a20 2020 2020 2020 2020 2020 2067  s:.            g
-00013460: 6f6f 676c 652e 636c 6f75 642e 6269 6771  oogle.cloud.bigq
-00013470: 7565 7279 2e54 6162 6c65 5265 6665 7265  uery.TableRefere
-00013480: 6e63 653a 0a20 2020 2020 2020 2020 2020  nce:.           
-00013490: 2020 2020 2046 756c 6c79 2071 7561 6c69       Fully quali
-000134a0: 6669 6564 2074 6162 6c65 2049 4420 6f66  fied table ID of
-000134b0: 2061 2074 6162 6c65 2074 6861 7420 646f   a table that do
-000134c0: 6573 6e27 7420 6578 6973 742e 0a20 2020  esn't exist..   
-000134d0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-000134e0: 2064 6174 6173 6574 203d 2073 656c 662e   dataset = self.
-000134f0: 5f61 6e6f 6e79 6d6f 7573 5f64 6174 6173  _anonymous_datas
-00013500: 6574 0a20 2020 2020 2020 2073 6573 7369  et.        sessi
-00013510: 6f6e 5f69 6420 3d20 7365 6c66 2e73 6573  on_id = self.ses
-00013520: 7369 6f6e 5f69 640a 2020 2020 2020 2020  sion_id.        
-00013530: 6e6f 7720 3d20 6461 7465 7469 6d65 2e64  now = datetime.d
-00013540: 6174 6574 696d 652e 6e6f 7728 6461 7465  atetime.now(date
-00013550: 7469 6d65 2e74 696d 657a 6f6e 652e 7574  time.timezone.ut
-00013560: 6329 0a20 2020 2020 2020 2072 616e 646f  c).        rando
-00013570: 6d5f 6964 203d 2075 7569 642e 7575 6964  m_id = uuid.uuid
-00013580: 3428 292e 6865 780a 2020 2020 2020 2020  4().hex.        
-00013590: 7461 626c 655f 6964 203d 205f 5445 4d50  table_id = _TEMP
-000135a0: 5f54 4142 4c45 5f49 445f 464f 524d 4154  _TABLE_ID_FORMAT
-000135b0: 2e66 6f72 6d61 7428 0a20 2020 2020 2020  .format(.       
-000135c0: 2020 2020 2064 6174 653d 6e6f 772e 7374       date=now.st
-000135d0: 7266 7469 6d65 2822 2559 256d 2564 2229  rftime("%Y%m%d")
-000135e0: 2c20 7365 7373 696f 6e5f 6964 3d73 6573  , session_id=ses
-000135f0: 7369 6f6e 5f69 642c 2072 616e 646f 6d5f  sion_id, random_
-00013600: 6964 3d72 616e 646f 6d5f 6964 0a20 2020  id=random_id.   
-00013610: 2020 2020 2029 0a20 2020 2020 2020 2069       ).        i
-00013620: 6620 6e6f 7420 736b 6970 5f63 6c65 616e  f not skip_clean
-00013630: 7570 3a0a 2020 2020 2020 2020 2020 2020  up:.            
-00013640: 7365 6c66 2e5f 7461 626c 655f 6964 732e  self._table_ids.
-00013650: 6170 7065 6e64 2874 6162 6c65 5f69 6429  append(table_id)
-00013660: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00013670: 6461 7461 7365 742e 7461 626c 6528 7461  dataset.table(ta
-00013680: 626c 655f 6964 290a 0a0a 6465 6620 636f  ble_id)...def co
-00013690: 6e6e 6563 7428 636f 6e74 6578 743a 204f  nnect(context: O
-000136a0: 7074 696f 6e61 6c5b 6269 6771 7565 7279  ptional[bigquery
-000136b0: 5f6f 7074 696f 6e73 2e42 6967 5175 6572  _options.BigQuer
-000136c0: 794f 7074 696f 6e73 5d20 3d20 4e6f 6e65  yOptions] = None
-000136d0: 2920 2d3e 2053 6573 7369 6f6e 3a0a 2020  ) -> Session:.  
-000136e0: 2020 7265 7475 726e 2053 6573 7369 6f6e    return Session
-000136f0: 2863 6f6e 7465 7874 290a 0a0a 6465 6620  (context)...def 
-00013700: 5f63 616e 5f63 6c75 7374 6572 5f62 7128  _can_cluster_bq(
-00013710: 6669 656c 643a 2062 6967 7175 6572 792e  field: bigquery.
-00013720: 5363 6865 6d61 4669 656c 6429 3a0a 2020  SchemaField):.  
-00013730: 2020 2320 6874 7470 733a 2f2f 636c 6f75    # https://clou
-00013740: 642e 676f 6f67 6c65 2e63 6f6d 2f62 6967  d.google.com/big
-00013750: 7175 6572 792f 646f 6373 2f63 6c75 7374  query/docs/clust
-00013760: 6572 6564 2d74 6162 6c65 730a 2020 2020  ered-tables.    
-00013770: 2320 4e6f 7461 626c 792c 2066 6c6f 6174  # Notably, float
-00013780: 2069 7320 6578 636c 7564 6564 0a20 2020   is excluded.   
-00013790: 2074 7970 655f 203d 2066 6965 6c64 2e66   type_ = field.f
-000137a0: 6965 6c64 5f74 7970 650a 2020 2020 7265  ield_type.    re
-000137b0: 7475 726e 2074 7970 655f 2069 6e20 280a  turn type_ in (.
-000137c0: 2020 2020 2020 2020 2249 4e54 4547 4552          "INTEGER
-000137d0: 222c 0a20 2020 2020 2020 2022 494e 5436  ",.        "INT6
-000137e0: 3422 2c0a 2020 2020 2020 2020 2253 5452  4",.        "STR
-000137f0: 494e 4722 2c0a 2020 2020 2020 2020 224e  ING",.        "N
-00013800: 554d 4552 4943 222c 0a20 2020 2020 2020  UMERIC",.       
-00013810: 2022 4445 4349 4d41 4c22 2c0a 2020 2020   "DECIMAL",.    
-00013820: 2020 2020 2242 4947 4e55 4d45 5249 4322      "BIGNUMERIC"
-00013830: 2c0a 2020 2020 2020 2020 2242 4947 4445  ,.        "BIGDE
-00013840: 4349 4d41 4c22 2c0a 2020 2020 2020 2020  CIMAL",.        
-00013850: 2244 4154 4522 2c0a 2020 2020 2020 2020  "DATE",.        
-00013860: 2244 4154 4554 494d 4522 2c0a 2020 2020  "DATETIME",.    
-00013870: 2020 2020 2254 494d 4553 5441 4d50 222c      "TIMESTAMP",
-00013880: 0a20 2020 2020 2020 2022 424f 4f4c 222c  .        "BOOL",
-00013890: 0a20 2020 2020 2020 2022 424f 4f4c 4541  .        "BOOLEA
-000138a0: 4e22 2c0a 2020 2020 290a 0a0a 6465 6620  N",.    )...def 
-000138b0: 5f74 7261 6e73 666f 726d 5f72 6561 645f  _transform_read_
-000138c0: 6762 715f 636f 6e66 6967 7572 6174 696f  gbq_configuratio
-000138d0: 6e28 636f 6e66 6967 7572 6174 696f 6e3a  n(configuration:
-000138e0: 204f 7074 696f 6e61 6c5b 6469 6374 5d29   Optional[dict])
-000138f0: 202d 3e20 6469 6374 3a0a 2020 2020 2222   -> dict:.    ""
-00013900: 220a 2020 2020 466f 7220 6261 636b 7761  ".    For backwa
-00013910: 7264 732d 636f 6d70 6174 6962 696c 6974  rds-compatibilit
-00013920: 792c 2063 6f6e 7665 7274 2061 6e79 2070  y, convert any p
-00013930: 7265 7669 6f75 736c 7920 636c 6965 6e74  reviously client
-00013940: 2d73 6964 6520 6f6e 6c79 0a20 2020 2070  -side only.    p
-00013950: 6172 616d 6574 6572 7320 7375 6368 2061  arameters such a
-00013960: 7320 7469 6d65 6f75 744d 7320 746f 2074  s timeoutMs to t
-00013970: 6865 2070 726f 7065 7274 7920 6e61 6d65  he property name
-00013980: 2065 7870 6563 7465 6420 6279 2074 6865   expected by the
-00013990: 2052 4553 5420 4150 492e 0a0a 2020 2020   REST API...    
-000139a0: 4d61 6b65 7320 6120 636f 7079 206f 6620  Makes a copy of 
-000139b0: 636f 6e66 6967 7572 6174 696f 6e20 6966  configuration if
-000139c0: 2063 6861 6e67 6573 2061 7265 206e 6565   changes are nee
-000139d0: 6465 642e 0a20 2020 2022 2222 0a0a 2020  ded..    """..  
-000139e0: 2020 6966 2063 6f6e 6669 6775 7261 7469    if configurati
-000139f0: 6f6e 2069 7320 4e6f 6e65 3a0a 2020 2020  on is None:.    
-00013a00: 2020 2020 7265 7475 726e 207b 7d0a 0a20      return {}.. 
-00013a10: 2020 2074 696d 656f 7574 5f6d 7320 3d20     timeout_ms = 
-00013a20: 636f 6e66 6967 7572 6174 696f 6e2e 6765  configuration.ge
-00013a30: 7428 2271 7565 7279 222c 207b 7d29 2e67  t("query", {}).g
-00013a40: 6574 2822 7469 6d65 6f75 744d 7322 290a  et("timeoutMs").
-00013a50: 2020 2020 6966 2074 696d 656f 7574 5f6d      if timeout_m
-00013a60: 7320 6973 206e 6f74 204e 6f6e 653a 0a20  s is not None:. 
-00013a70: 2020 2020 2020 2023 2054 7261 6e73 666f         # Transfo
-00013a80: 726d 2074 696d 656f 7574 4d73 2074 6f20  rm timeoutMs to 
-00013a90: 616e 2061 6374 7561 6c20 7365 7276 6572  an actual server
-00013aa0: 2d73 6964 6520 636f 6e66 6967 7572 6174  -side configurat
-00013ab0: 696f 6e2e 0a20 2020 2020 2020 2023 2068  ion..        # h
-00013ac0: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
-00013ad0: 6d2f 676f 6f67 6c65 6170 6973 2f70 7974  m/googleapis/pyt
-00013ae0: 686f 6e2d 6269 6771 7565 7279 2d70 616e  hon-bigquery-pan
-00013af0: 6461 732f 6973 7375 6573 2f34 3739 0a20  das/issues/479. 
-00013b00: 2020 2020 2020 2063 6f6e 6669 6775 7261         configura
-00013b10: 7469 6f6e 203d 2063 6f70 792e 6465 6570  tion = copy.deep
-00013b20: 636f 7079 2863 6f6e 6669 6775 7261 7469  copy(configurati
-00013b30: 6f6e 290a 2020 2020 2020 2020 6465 6c20  on).        del 
-00013b40: 636f 6e66 6967 7572 6174 696f 6e5b 2271  configuration["q
-00013b50: 7565 7279 225d 5b22 7469 6d65 6f75 744d  uery"]["timeoutM
-00013b60: 7322 5d0a 2020 2020 2020 2020 636f 6e66  s"].        conf
-00013b70: 6967 7572 6174 696f 6e5b 226a 6f62 5469  iguration["jobTi
-00013b80: 6d65 6f75 744d 7322 5d20 3d20 7469 6d65  meoutMs"] = time
-00013b90: 6f75 745f 6d73 0a0a 2020 2020 7265 7475  out_ms..    retu
-00013ba0: 726e 2063 6f6e 6669 6775 7261 7469 6f6e  rn configuration
-00013bb0: 0a                                       .
+000107d0: 6720 3d20 6269 6771 7565 7279 2e43 6f70  g = bigquery.Cop
+000107e0: 794a 6f62 436f 6e66 6967 2829 0a0a 2020  yJobConfig()..  
+000107f0: 2020 2020 2020 6966 2073 656c 662e 5f62        if self._b
+00010800: 715f 6b6d 735f 6b65 795f 6e61 6d65 3a0a  q_kms_key_name:.
+00010810: 2020 2020 2020 2020 2020 2020 6a6f 625f              job_
+00010820: 636f 6e66 6967 2e64 6573 7469 6e61 7469  config.destinati
+00010830: 6f6e 5f65 6e63 7279 7074 696f 6e5f 636f  on_encryption_co
+00010840: 6e66 6967 7572 6174 696f 6e20 3d20 280a  nfiguration = (.
+00010850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010860: 6269 6771 7565 7279 2e45 6e63 7279 7074  bigquery.Encrypt
+00010870: 696f 6e43 6f6e 6669 6775 7261 7469 6f6e  ionConfiguration
+00010880: 286b 6d73 5f6b 6579 5f6e 616d 653d 7365  (kms_key_name=se
+00010890: 6c66 2e5f 6271 5f6b 6d73 5f6b 6579 5f6e  lf._bq_kms_key_n
+000108a0: 616d 6529 0a20 2020 2020 2020 2020 2020  ame).           
+000108b0: 2029 0a0a 2020 2020 2020 2020 7265 7475   )..        retu
+000108c0: 726e 206a 6f62 5f63 6f6e 6669 670a 0a20  rn job_config.. 
+000108d0: 2020 2064 6566 205f 7374 6172 745f 7175     def _start_qu
+000108e0: 6572 7928 0a20 2020 2020 2020 2073 656c  ery(.        sel
+000108f0: 662c 0a20 2020 2020 2020 2073 716c 3a20  f,.        sql: 
+00010900: 7374 722c 0a20 2020 2020 2020 206a 6f62  str,.        job
+00010910: 5f63 6f6e 6669 673a 204f 7074 696f 6e61  _config: Optiona
+00010920: 6c5b 6269 6771 7565 7279 2e6a 6f62 2e51  l[bigquery.job.Q
+00010930: 7565 7279 4a6f 6243 6f6e 6669 675d 203d  ueryJobConfig] =
+00010940: 204e 6f6e 652c 0a20 2020 2020 2020 206d   None,.        m
+00010950: 6178 5f72 6573 756c 7473 3a20 4f70 7469  ax_results: Opti
+00010960: 6f6e 616c 5b69 6e74 5d20 3d20 4e6f 6e65  onal[int] = None
+00010970: 2c0a 2020 2020 2020 2020 7469 6d65 6f75  ,.        timeou
+00010980: 743a 204f 7074 696f 6e61 6c5b 666c 6f61  t: Optional[floa
+00010990: 745d 203d 204e 6f6e 652c 0a20 2020 2029  t] = None,.    )
+000109a0: 202d 3e20 5475 706c 655b 6269 6771 7565   -> Tuple[bigque
+000109b0: 7279 2e74 6162 6c65 2e52 6f77 4974 6572  ry.table.RowIter
+000109c0: 6174 6f72 2c20 6269 6771 7565 7279 2e51  ator, bigquery.Q
+000109d0: 7565 7279 4a6f 625d 3a0a 2020 2020 2020  ueryJob]:.      
+000109e0: 2020 2222 220a 2020 2020 2020 2020 5374    """.        St
+000109f0: 6172 7473 2042 6967 5175 6572 7920 7175  arts BigQuery qu
+00010a00: 6572 7920 6a6f 6220 616e 6420 7761 6974  ery job and wait
+00010a10: 7320 666f 7220 7265 7375 6c74 732e 0a20  s for results.. 
+00010a20: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00010a30: 2020 206a 6f62 5f63 6f6e 6669 6720 3d20     job_config = 
+00010a40: 7365 6c66 2e5f 7072 6570 6172 655f 7175  self._prepare_qu
+00010a50: 6572 795f 6a6f 625f 636f 6e66 6967 286a  ery_job_config(j
+00010a60: 6f62 5f63 6f6e 6669 6729 0a20 2020 2020  ob_config).     
+00010a70: 2020 2072 6574 7572 6e20 6269 6766 7261     return bigfra
+00010a80: 6d65 732e 7365 7373 696f 6e2e 5f69 6f2e  mes.session._io.
+00010a90: 6269 6771 7565 7279 2e73 7461 7274 5f71  bigquery.start_q
+00010aa0: 7565 7279 5f77 6974 685f 636c 6965 6e74  uery_with_client
+00010ab0: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
+00010ac0: 6c66 2e62 7163 6c69 656e 742c 2073 716c  lf.bqclient, sql
+00010ad0: 2c20 6a6f 625f 636f 6e66 6967 2c20 6d61  , job_config, ma
+00010ae0: 785f 7265 7375 6c74 732c 2074 696d 656f  x_results, timeo
+00010af0: 7574 0a20 2020 2020 2020 2029 0a0a 2020  ut.        )..  
+00010b00: 2020 6465 6620 5f73 7461 7274 5f71 7565    def _start_que
+00010b10: 7279 5f6d 6c5f 6464 6c28 0a20 2020 2020  ry_ml_ddl(.     
+00010b20: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+00010b30: 2073 716c 3a20 7374 722c 0a20 2020 2029   sql: str,.    )
+00010b40: 202d 3e20 5475 706c 655b 6269 6771 7565   -> Tuple[bigque
+00010b50: 7279 2e74 6162 6c65 2e52 6f77 4974 6572  ry.table.RowIter
+00010b60: 6174 6f72 2c20 6269 6771 7565 7279 2e51  ator, bigquery.Q
+00010b70: 7565 7279 4a6f 625d 3a0a 2020 2020 2020  ueryJob]:.      
+00010b80: 2020 2222 220a 2020 2020 2020 2020 5374    """.        St
+00010b90: 6172 7473 2042 6967 5175 6572 7920 4d4c  arts BigQuery ML
+00010ba0: 2044 444c 2071 7565 7279 206a 6f62 2028   DDL query job (
+00010bb0: 4352 4541 5445 204d 4f44 454c 2f41 4c54  CREATE MODEL/ALT
+00010bc0: 4552 204d 4f44 454c 2f2e 2e2e 2920 616e  ER MODEL/...) an
+00010bd0: 640a 2020 2020 2020 2020 7761 6974 7320  d.        waits 
+00010be0: 666f 7220 7265 7375 6c74 732e 0a20 2020  for results..   
+00010bf0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00010c00: 206a 6f62 5f63 6f6e 6669 6720 3d20 7365   job_config = se
+00010c10: 6c66 2e5f 7072 6570 6172 655f 7175 6572  lf._prepare_quer
+00010c20: 795f 6a6f 625f 636f 6e66 6967 2829 0a0a  y_job_config()..
+00010c30: 2020 2020 2020 2020 2320 4251 4d4c 2065          # BQML e
+00010c40: 7870 6563 7473 206b 6d73 5f6b 6579 5f6e  xpects kms_key_n
+00010c50: 616d 6520 7468 726f 7567 6820 4f50 5449  ame through OPTI
+00010c60: 4f4e 5320 616e 6420 6e6f 7420 7468 726f  ONS and not thro
+00010c70: 7567 6820 6a6f 6220 636f 6e66 6967 2c0a  ugh job config,.
+00010c80: 2020 2020 2020 2020 2320 736f 2077 6520          # so we 
+00010c90: 6d75 7374 2072 6573 6574 2061 6e79 2065  must reset any e
+00010ca0: 6e63 7279 7074 696f 6e20 7365 7420 696e  ncryption set in
+00010cb0: 2074 6865 206a 6f62 2063 6f6e 6669 670a   the job config.
+00010cc0: 2020 2020 2020 2020 2320 6874 7470 733a          # https:
+00010cd0: 2f2f 636c 6f75 642e 676f 6f67 6c65 2e63  //cloud.google.c
+00010ce0: 6f6d 2f62 6967 7175 6572 792f 646f 6373  om/bigquery/docs
+00010cf0: 2f63 7573 746f 6d65 722d 6d61 6e61 6765  /customer-manage
+00010d00: 642d 656e 6372 7970 7469 6f6e 2365 6e63  d-encryption#enc
+00010d10: 7279 7074 2d6d 6f64 656c 0a20 2020 2020  rypt-model.     
+00010d20: 2020 206a 6f62 5f63 6f6e 6669 672e 6465     job_config.de
+00010d30: 7374 696e 6174 696f 6e5f 656e 6372 7970  stination_encryp
+00010d40: 7469 6f6e 5f63 6f6e 6669 6775 7261 7469  tion_configurati
+00010d50: 6f6e 203d 204e 6f6e 650a 0a20 2020 2020  on = None..     
+00010d60: 2020 2072 6574 7572 6e20 6269 6766 7261     return bigfra
+00010d70: 6d65 732e 7365 7373 696f 6e2e 5f69 6f2e  mes.session._io.
+00010d80: 6269 6771 7565 7279 2e73 7461 7274 5f71  bigquery.start_q
+00010d90: 7565 7279 5f77 6974 685f 636c 6965 6e74  uery_with_client
+00010da0: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
+00010db0: 6c66 2e62 7163 6c69 656e 742c 2073 716c  lf.bqclient, sql
+00010dc0: 2c20 6a6f 625f 636f 6e66 6967 0a20 2020  , job_config.   
+00010dd0: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+00010de0: 5f63 6163 6865 5f77 6974 685f 636c 7573  _cache_with_clus
+00010df0: 7465 725f 636f 6c73 280a 2020 2020 2020  ter_cols(.      
+00010e00: 2020 7365 6c66 2c20 6172 7261 795f 7661    self, array_va
+00010e10: 6c75 653a 2063 6f72 652e 4172 7261 7956  lue: core.ArrayV
+00010e20: 616c 7565 2c20 636c 7573 7465 725f 636f  alue, cluster_co
+00010e30: 6c73 3a20 7479 7069 6e67 2e53 6571 7565  ls: typing.Seque
+00010e40: 6e63 655b 7374 725d 0a20 2020 2029 202d  nce[str].    ) -
+00010e50: 3e20 636f 7265 2e41 7272 6179 5661 6c75  > core.ArrayValu
+00010e60: 653a 0a20 2020 2020 2020 2022 2222 4578  e:.        """Ex
+00010e70: 6563 7574 6573 2074 6865 2071 7565 7279  ecutes the query
+00010e80: 2061 6e64 2075 7365 7320 7468 6520 7265   and uses the re
+00010e90: 7375 6c74 696e 6720 7461 626c 6520 746f  sulting table to
+00010ea0: 2072 6577 7269 7465 2066 7574 7572 6520   rewrite future 
+00010eb0: 6578 6563 7574 696f 6e73 2e22 2222 0a20  executions.""". 
+00010ec0: 2020 2020 2020 2023 2054 4f44 4f3a 2055         # TODO: U
+00010ed0: 7365 2074 6869 7320 666f 7220 616c 6c20  se this for all 
+00010ee0: 6578 6563 7574 696f 6e73 3f20 5072 6f62  executions? Prob
+00010ef0: 6c65 6d20 6973 2074 6861 7420 6361 6368  lem is that cach
+00010f00: 696e 6720 6d61 7465 7269 616c 697a 6573  ing materializes
+00010f10: 2065 7874 7261 0a20 2020 2020 2020 2023   extra.        #
+00010f20: 206f 7264 6572 696e 6720 636f 6c75 6d6e   ordering column
+00010f30: 730a 2020 2020 2020 2020 636f 6d70 696c  s.        compil
+00010f40: 6564 5f76 616c 7565 203d 2073 656c 662e  ed_value = self.
+00010f50: 5f63 6f6d 7069 6c65 5f6f 7264 6572 6564  _compile_ordered
+00010f60: 2861 7272 6179 5f76 616c 7565 290a 0a20  (array_value).. 
+00010f70: 2020 2020 2020 2069 6269 735f 6578 7072         ibis_expr
+00010f80: 203d 2063 6f6d 7069 6c65 645f 7661 6c75   = compiled_valu
+00010f90: 652e 5f74 6f5f 6962 6973 5f65 7870 7228  e._to_ibis_expr(
+00010fa0: 0a20 2020 2020 2020 2020 2020 206f 7264  .            ord
+00010fb0: 6572 696e 675f 6d6f 6465 3d22 756e 6f72  ering_mode="unor
+00010fc0: 6465 7265 6422 2c20 6578 706f 7365 5f68  dered", expose_h
+00010fd0: 6964 6465 6e5f 636f 6c73 3d54 7275 650a  idden_cols=True.
+00010fe0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00010ff0: 2020 746d 705f 7461 626c 6520 3d20 7365    tmp_table = se
+00011000: 6c66 2e5f 6962 6973 5f74 6f5f 7465 6d70  lf._ibis_to_temp
+00011010: 5f74 6162 6c65 280a 2020 2020 2020 2020  _table(.        
+00011020: 2020 2020 6962 6973 5f65 7870 722c 2063      ibis_expr, c
+00011030: 6c75 7374 6572 5f63 6f6c 733d 636c 7573  luster_cols=clus
+00011040: 7465 725f 636f 6c73 2c20 6170 695f 6e61  ter_cols, api_na
+00011050: 6d65 3d22 6361 6368 6564 220a 2020 2020  me="cached".    
+00011060: 2020 2020 290a 2020 2020 2020 2020 7461      ).        ta
+00011070: 626c 655f 6578 7072 6573 7369 6f6e 203d  ble_expression =
+00011080: 2073 656c 662e 6962 6973 5f63 6c69 656e   self.ibis_clien
+00011090: 742e 7461 626c 6528 0a20 2020 2020 2020  t.table(.       
+000110a0: 2020 2020 2074 6d70 5f74 6162 6c65 2e74       tmp_table.t
+000110b0: 6162 6c65 5f69 642c 0a20 2020 2020 2020  able_id,.       
+000110c0: 2020 2020 2073 6368 656d 613d 746d 705f       schema=tmp_
+000110d0: 7461 626c 652e 6461 7461 7365 745f 6964  table.dataset_id
+000110e0: 2c0a 2020 2020 2020 2020 2020 2020 6461  ,.            da
+000110f0: 7461 6261 7365 3d74 6d70 5f74 6162 6c65  tabase=tmp_table
+00011100: 2e70 726f 6a65 6374 2c0a 2020 2020 2020  .project,.      
+00011110: 2020 290a 2020 2020 2020 2020 6e65 775f    ).        new_
+00011120: 636f 6c75 6d6e 7320 3d20 5b74 6162 6c65  columns = [table
+00011130: 5f65 7870 7265 7373 696f 6e5b 636f 6c75  _expression[colu
+00011140: 6d6e 5d20 666f 7220 636f 6c75 6d6e 2069  mn] for column i
+00011150: 6e20 636f 6d70 696c 6564 5f76 616c 7565  n compiled_value
+00011160: 2e63 6f6c 756d 6e5f 6964 735d 0a20 2020  .column_ids].   
+00011170: 2020 2020 206e 6577 5f68 6964 6465 6e5f       new_hidden_
+00011180: 636f 6c75 6d6e 7320 3d20 5b0a 2020 2020  columns = [.    
+00011190: 2020 2020 2020 2020 7461 626c 655f 6578          table_ex
+000111a0: 7072 6573 7369 6f6e 5b63 6f6c 756d 6e5d  pression[column]
+000111b0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+000111c0: 2063 6f6c 756d 6e20 696e 2063 6f6d 7069   column in compi
+000111d0: 6c65 645f 7661 6c75 652e 5f68 6964 6465  led_value._hidde
+000111e0: 6e5f 6f72 6465 7269 6e67 5f63 6f6c 756d  n_ordering_colum
+000111f0: 6e5f 6e61 6d65 730a 2020 2020 2020 2020  n_names.        
+00011200: 5d0a 2020 2020 2020 2020 2320 544f 444f  ].        # TODO
+00011210: 3a20 496e 7374 6561 642c 206b 6565 7020  : Instead, keep 
+00011220: 7365 7373 696f 6e2d 7769 6465 206d 6170  session-wide map
+00011230: 206f 6620 6361 6368 6564 2072 6573 756c   of cached resul
+00011240: 7473 2061 6e64 2061 7574 6f6d 6174 6963  ts and automatic
+00011250: 616c 6c79 2072 6575 7365 0a20 2020 2020  ally reuse.     
+00011260: 2020 2072 6574 7572 6e20 636f 7265 2e41     return core.A
+00011270: 7272 6179 5661 6c75 652e 6672 6f6d 5f69  rrayValue.from_i
+00011280: 6269 7328 0a20 2020 2020 2020 2020 2020  bis(.           
+00011290: 2073 656c 662c 0a20 2020 2020 2020 2020   self,.         
+000112a0: 2020 2074 6162 6c65 5f65 7870 7265 7373     table_express
+000112b0: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
+000112c0: 2063 6f6c 756d 6e73 3d6e 6577 5f63 6f6c   columns=new_col
+000112d0: 756d 6e73 2c0a 2020 2020 2020 2020 2020  umns,.          
+000112e0: 2020 6869 6464 656e 5f6f 7264 6572 696e    hidden_orderin
+000112f0: 675f 636f 6c75 6d6e 733d 6e65 775f 6869  g_columns=new_hi
+00011300: 6464 656e 5f63 6f6c 756d 6e73 2c0a 2020  dden_columns,.  
+00011310: 2020 2020 2020 2020 2020 6f72 6465 7269            orderi
+00011320: 6e67 3d63 6f6d 7069 6c65 645f 7661 6c75  ng=compiled_valu
+00011330: 652e 5f6f 7264 6572 696e 672c 0a20 2020  e._ordering,.   
+00011340: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+00011350: 5f63 6163 6865 5f77 6974 685f 6f66 6673  _cache_with_offs
+00011360: 6574 7328 7365 6c66 2c20 6172 7261 795f  ets(self, array_
+00011370: 7661 6c75 653a 2063 6f72 652e 4172 7261  value: core.Arra
+00011380: 7956 616c 7565 2920 2d3e 2063 6f72 652e  yValue) -> core.
+00011390: 4172 7261 7956 616c 7565 3a0a 2020 2020  ArrayValue:.    
+000113a0: 2020 2020 2222 2245 7865 6375 7465 7320      """Executes 
+000113b0: 7468 6520 7175 6572 7920 616e 6420 7573  the query and us
+000113c0: 6573 2074 6865 2072 6573 756c 7469 6e67  es the resulting
+000113d0: 2074 6162 6c65 2074 6f20 7265 7772 6974   table to rewrit
+000113e0: 6520 6675 7475 7265 2065 7865 6375 7469  e future executi
+000113f0: 6f6e 732e 2222 220a 2020 2020 2020 2020  ons.""".        
+00011400: 2320 544f 444f 3a20 5573 6520 7468 6973  # TODO: Use this
+00011410: 2066 6f72 2061 6c6c 2065 7865 6375 7469   for all executi
+00011420: 6f6e 733f 2050 726f 626c 656d 2069 7320  ons? Problem is 
+00011430: 7468 6174 2063 6163 6869 6e67 206d 6174  that caching mat
+00011440: 6572 6961 6c69 7a65 7320 6578 7472 610a  erializes extra.
+00011450: 2020 2020 2020 2020 2320 6f72 6465 7269          # orderi
+00011460: 6e67 2063 6f6c 756d 6e73 0a20 2020 2020  ng columns.     
+00011470: 2020 2063 6f6d 7069 6c65 645f 7661 6c75     compiled_valu
+00011480: 6520 3d20 7365 6c66 2e5f 636f 6d70 696c  e = self._compil
+00011490: 655f 6f72 6465 7265 6428 6172 7261 795f  e_ordered(array_
+000114a0: 7661 6c75 6529 0a0a 2020 2020 2020 2020  value)..        
+000114b0: 6962 6973 5f65 7870 7220 3d20 636f 6d70  ibis_expr = comp
+000114c0: 696c 6564 5f76 616c 7565 2e5f 746f 5f69  iled_value._to_i
+000114d0: 6269 735f 6578 7072 280a 2020 2020 2020  bis_expr(.      
+000114e0: 2020 2020 2020 6f72 6465 7269 6e67 5f6d        ordering_m
+000114f0: 6f64 653d 226f 6666 7365 745f 636f 6c22  ode="offset_col"
+00011500: 2c20 6f72 6465 725f 636f 6c5f 6e61 6d65  , order_col_name
+00011510: 3d22 6269 6766 7261 6d65 735f 6f66 6673  ="bigframes_offs
+00011520: 6574 7322 0a20 2020 2020 2020 2029 0a20  ets".        ). 
+00011530: 2020 2020 2020 2074 6d70 5f74 6162 6c65         tmp_table
+00011540: 203d 2073 656c 662e 5f69 6269 735f 746f   = self._ibis_to
+00011550: 5f74 656d 705f 7461 626c 6528 0a20 2020  _temp_table(.   
+00011560: 2020 2020 2020 2020 2069 6269 735f 6578           ibis_ex
+00011570: 7072 2c20 636c 7573 7465 725f 636f 6c73  pr, cluster_cols
+00011580: 3d5b 2262 6967 6672 616d 6573 5f6f 6666  =["bigframes_off
+00011590: 7365 7473 225d 2c20 6170 695f 6e61 6d65  sets"], api_name
+000115a0: 3d22 6361 6368 6564 220a 2020 2020 2020  ="cached".      
+000115b0: 2020 290a 2020 2020 2020 2020 7461 626c    ).        tabl
+000115c0: 655f 6578 7072 6573 7369 6f6e 203d 2073  e_expression = s
+000115d0: 656c 662e 6962 6973 5f63 6c69 656e 742e  elf.ibis_client.
+000115e0: 7461 626c 6528 0a20 2020 2020 2020 2020  table(.         
+000115f0: 2020 2074 6d70 5f74 6162 6c65 2e74 6162     tmp_table.tab
+00011600: 6c65 5f69 642c 0a20 2020 2020 2020 2020  le_id,.         
+00011610: 2020 2073 6368 656d 613d 746d 705f 7461     schema=tmp_ta
+00011620: 626c 652e 6461 7461 7365 745f 6964 2c0a  ble.dataset_id,.
+00011630: 2020 2020 2020 2020 2020 2020 6461 7461              data
+00011640: 6261 7365 3d74 6d70 5f74 6162 6c65 2e70  base=tmp_table.p
+00011650: 726f 6a65 6374 2c0a 2020 2020 2020 2020  roject,.        
+00011660: 290a 2020 2020 2020 2020 6e65 775f 636f  ).        new_co
+00011670: 6c75 6d6e 7320 3d20 5b74 6162 6c65 5f65  lumns = [table_e
+00011680: 7870 7265 7373 696f 6e5b 636f 6c75 6d6e  xpression[column
+00011690: 5d20 666f 7220 636f 6c75 6d6e 2069 6e20  ] for column in 
+000116a0: 636f 6d70 696c 6564 5f76 616c 7565 2e63  compiled_value.c
+000116b0: 6f6c 756d 6e5f 6964 735d 0a20 2020 2020  olumn_ids].     
+000116c0: 2020 206e 6577 5f68 6964 6465 6e5f 636f     new_hidden_co
+000116d0: 6c75 6d6e 7320 3d20 5b74 6162 6c65 5f65  lumns = [table_e
+000116e0: 7870 7265 7373 696f 6e5b 2262 6967 6672  xpression["bigfr
+000116f0: 616d 6573 5f6f 6666 7365 7473 225d 5d0a  ames_offsets"]].
+00011700: 2020 2020 2020 2020 2320 544f 444f 3a20          # TODO: 
+00011710: 496e 7374 6561 642c 206b 6565 7020 7365  Instead, keep se
+00011720: 7373 696f 6e2d 7769 6465 206d 6170 206f  ssion-wide map o
+00011730: 6620 6361 6368 6564 2072 6573 756c 7473  f cached results
+00011740: 2061 6e64 2061 7574 6f6d 6174 6963 616c   and automatical
+00011750: 6c79 2072 6575 7365 0a20 2020 2020 2020  ly reuse.       
+00011760: 2072 6574 7572 6e20 636f 7265 2e41 7272   return core.Arr
+00011770: 6179 5661 6c75 652e 6672 6f6d 5f69 6269  ayValue.from_ibi
+00011780: 7328 0a20 2020 2020 2020 2020 2020 2073  s(.            s
+00011790: 656c 662c 0a20 2020 2020 2020 2020 2020  elf,.           
+000117a0: 2074 6162 6c65 5f65 7870 7265 7373 696f   table_expressio
+000117b0: 6e2c 0a20 2020 2020 2020 2020 2020 2063  n,.            c
+000117c0: 6f6c 756d 6e73 3d6e 6577 5f63 6f6c 756d  olumns=new_colum
+000117d0: 6e73 2c0a 2020 2020 2020 2020 2020 2020  ns,.            
+000117e0: 6869 6464 656e 5f6f 7264 6572 696e 675f  hidden_ordering_
+000117f0: 636f 6c75 6d6e 733d 6e65 775f 6869 6464  columns=new_hidd
+00011800: 656e 5f63 6f6c 756d 6e73 2c0a 2020 2020  en_columns,.    
+00011810: 2020 2020 2020 2020 6f72 6465 7269 6e67          ordering
+00011820: 3d6f 7264 6572 2e45 7870 7265 7373 696f  =order.Expressio
+00011830: 6e4f 7264 6572 696e 672e 6672 6f6d 5f6f  nOrdering.from_o
+00011840: 6666 7365 745f 636f 6c28 2262 6967 6672  ffset_col("bigfr
+00011850: 616d 6573 5f6f 6666 7365 7473 2229 2c0a  ames_offsets"),.
+00011860: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+00011870: 6566 205f 7369 6d70 6c69 6679 5f77 6974  ef _simplify_wit
+00011880: 685f 6361 6368 696e 6728 7365 6c66 2c20  h_caching(self, 
+00011890: 6172 7261 795f 7661 6c75 653a 2063 6f72  array_value: cor
+000118a0: 652e 4172 7261 7956 616c 7565 2920 2d3e  e.ArrayValue) ->
+000118b0: 2063 6f72 652e 4172 7261 7956 616c 7565   core.ArrayValue
+000118c0: 3a0a 2020 2020 2020 2020 2222 2241 7474  :.        """Att
+000118d0: 656d 7074 7320 746f 2068 616e 646c 6520  empts to handle 
+000118e0: 7468 6520 636f 6d70 6c65 7869 7479 2062  the complexity b
+000118f0: 7920 6361 6368 696e 6720 6475 706c 6963  y caching duplic
+00011900: 6174 6564 2073 7562 7472 6565 7320 616e  ated subtrees an
+00011910: 6420 6272 6561 6b69 6e67 2074 6865 2071  d breaking the q
+00011920: 7565 7279 2069 6e74 6f20 7069 6563 6573  uery into pieces
+00011930: 2e22 2222 0a20 2020 2020 2020 2069 6620  .""".        if 
+00011940: 6e6f 7420 6269 6766 7261 6d65 732e 6f70  not bigframes.op
+00011950: 7469 6f6e 732e 636f 6d70 7574 652e 656e  tions.compute.en
+00011960: 6162 6c65 5f6d 756c 7469 5f71 7565 7279  able_multi_query
+00011970: 5f65 7865 6375 7469 6f6e 3a0a 2020 2020  _execution:.    
+00011980: 2020 2020 2020 2020 7265 7475 726e 2061          return a
+00011990: 7272 6179 5f76 616c 7565 0a20 2020 2020  rray_value.     
+000119a0: 2020 206e 6f64 6520 3d20 6172 7261 795f     node = array_
+000119b0: 7661 6c75 652e 6e6f 6465 0a20 2020 2020  value.node.     
+000119c0: 2020 2069 6620 6e6f 6465 2e70 6c61 6e6e     if node.plann
+000119d0: 696e 675f 636f 6d70 6c65 7869 7479 203c  ing_complexity <
+000119e0: 2051 5545 5259 5f43 4f4d 504c 4558 4954   QUERY_COMPLEXIT
+000119f0: 595f 4c49 4d49 543a 0a20 2020 2020 2020  Y_LIMIT:.       
+00011a00: 2020 2020 2072 6574 7572 6e20 6172 7261       return arra
+00011a10: 795f 7661 6c75 650a 0a20 2020 2020 2020  y_value..       
+00011a20: 2066 6f72 205f 2069 6e20 7261 6e67 6528   for _ in range(
+00011a30: 4d41 585f 5355 4254 5245 455f 4641 4354  MAX_SUBTREE_FACT
+00011a40: 4f52 494e 4753 293a 0a20 2020 2020 2020  ORINGS):.       
+00011a50: 2020 2020 2075 7064 6174 6564 203d 2073       updated = s
+00011a60: 656c 662e 5f63 6163 6865 5f6d 6f73 745f  elf._cache_most_
+00011a70: 636f 6d70 6c65 785f 7375 6274 7265 6528  complex_subtree(
+00011a80: 6e6f 6465 290a 2020 2020 2020 2020 2020  node).          
+00011a90: 2020 6966 2075 7064 6174 6564 2069 7320    if updated is 
+00011aa0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00011ab0: 2020 2020 2020 7265 7475 726e 2063 6f72        return cor
+00011ac0: 652e 4172 7261 7956 616c 7565 286e 6f64  e.ArrayValue(nod
+00011ad0: 6529 0a20 2020 2020 2020 2020 2020 2065  e).            e
+00011ae0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00011af0: 2020 2020 206e 6f64 6520 3d20 7570 6461       node = upda
+00011b00: 7465 640a 0a20 2020 2020 2020 2072 6574  ted..        ret
+00011b10: 7572 6e20 636f 7265 2e41 7272 6179 5661  urn core.ArrayVa
+00011b20: 6c75 6528 6e6f 6465 290a 0a20 2020 2064  lue(node)..    d
+00011b30: 6566 205f 6361 6368 655f 6d6f 7374 5f63  ef _cache_most_c
+00011b40: 6f6d 706c 6578 5f73 7562 7472 6565 280a  omplex_subtree(.
+00011b50: 2020 2020 2020 2020 7365 6c66 2c20 6e6f          self, no
+00011b60: 6465 3a20 6e6f 6465 732e 4269 6746 7261  de: nodes.BigFra
+00011b70: 6d65 4e6f 6465 0a20 2020 2029 202d 3e20  meNode.    ) -> 
+00011b80: 4f70 7469 6f6e 616c 5b6e 6f64 6573 2e42  Optional[nodes.B
+00011b90: 6967 4672 616d 654e 6f64 655d 3a0a 2020  igFrameNode]:.  
+00011ba0: 2020 2020 2020 2320 544f 444f 3a20 4966        # TODO: If
+00011bb0: 2071 7565 7279 2066 6169 6c73 2c20 7265   query fails, re
+00011bc0: 7472 7920 7769 7468 206c 6f77 6572 2063  try with lower c
+00011bd0: 6f6d 706c 6578 6974 7920 6c69 6d69 740a  omplexity limit.
+00011be0: 2020 2020 2020 2020 7661 6c69 645f 6361          valid_ca
+00011bf0: 6e64 6964 6174 6573 203d 2074 7261 7665  ndidates = trave
+00011c00: 7273 616c 732e 636f 756e 745f 636f 6d70  rsals.count_comp
+00011c10: 6c65 785f 6e6f 6465 7328 0a20 2020 2020  lex_nodes(.     
+00011c20: 2020 2020 2020 206e 6f64 652c 0a20 2020         node,.   
+00011c30: 2020 2020 2020 2020 206d 696e 5f63 6f6d           min_com
+00011c40: 706c 6578 6974 793d 2851 5545 5259 5f43  plexity=(QUERY_C
+00011c50: 4f4d 504c 4558 4954 595f 4c49 4d49 5420  OMPLEXITY_LIMIT 
+00011c60: 2f20 3530 3029 2c0a 2020 2020 2020 2020  / 500),.        
+00011c70: 2020 2020 6d61 785f 636f 6d70 6c65 7869      max_complexi
+00011c80: 7479 3d51 5545 5259 5f43 4f4d 504c 4558  ty=QUERY_COMPLEX
+00011c90: 4954 595f 4c49 4d49 542c 0a20 2020 2020  ITY_LIMIT,.     
+00011ca0: 2020 2029 2e69 7465 6d73 2829 0a20 2020     ).items().   
+00011cb0: 2020 2020 2023 2048 6575 7269 7374 6963       # Heuristic
+00011cc0: 3a20 7375 6274 7265 655f 636f 6d70 6c65  : subtree_comple
+00011cd0: 6978 7479 202a 2028 636f 7069 6573 206f  ixty * (copies o
+00011ce0: 6620 7375 6274 7265 6529 5e32 0a20 2020  f subtree)^2.   
+00011cf0: 2020 2020 2062 6573 745f 6361 6e64 6964       best_candid
+00011d00: 6174 6520 3d20 6d61 7828 0a20 2020 2020  ate = max(.     
+00011d10: 2020 2020 2020 2076 616c 6964 5f63 616e         valid_can
+00011d20: 6469 6461 7465 732c 0a20 2020 2020 2020  didates,.       
+00011d30: 2020 2020 206b 6579 3d6c 616d 6264 6120       key=lambda 
+00011d40: 693a 2069 5b30 5d2e 706c 616e 6e69 6e67  i: i[0].planning
+00011d50: 5f63 6f6d 706c 6578 6974 7920 2b20 2869  _complexity + (i
+00011d60: 5b31 5d20 2a2a 2032 292c 0a20 2020 2020  [1] ** 2),.     
+00011d70: 2020 2020 2020 2064 6566 6175 6c74 3d4e         default=N
+00011d80: 6f6e 652c 0a20 2020 2020 2020 2029 0a0a  one,.        )..
+00011d90: 2020 2020 2020 2020 6966 2062 6573 745f          if best_
+00011da0: 6361 6e64 6964 6174 6520 6973 204e 6f6e  candidate is Non
+00011db0: 653a 0a20 2020 2020 2020 2020 2020 2023  e:.            #
+00011dc0: 204e 6f20 676f 6f64 2073 7562 7472 6565   No good subtree
+00011dd0: 7320 746f 2063 6163 6865 2c20 6a75 7374  s to cache, just
+00011de0: 2072 6574 7572 6e20 6f72 6967 696e 616c   return original
+00011df0: 2074 7265 650a 2020 2020 2020 2020 2020   tree.          
+00011e00: 2020 7265 7475 726e 204e 6f6e 650a 0a20    return None.. 
+00011e10: 2020 2020 2020 2023 2054 4f44 4f3a 2041         # TODO: A
+00011e20: 6464 2063 6c75 7374 6572 696e 6720 636f  dd clustering co
+00011e30: 6c75 6d6e 7320 6261 7365 6420 6f6e 2061  lumns based on a
+00011e40: 6363 6573 7320 7061 7474 6572 6e73 0a20  ccess patterns. 
+00011e50: 2020 2020 2020 206d 6174 6572 6961 6c69         materiali
+00011e60: 7a65 6420 3d20 7365 6c66 2e5f 6361 6368  zed = self._cach
+00011e70: 655f 7769 7468 5f63 6c75 7374 6572 5f63  e_with_cluster_c
+00011e80: 6f6c 7328 0a20 2020 2020 2020 2020 2020  ols(.           
+00011e90: 2063 6f72 652e 4172 7261 7956 616c 7565   core.ArrayValue
+00011ea0: 2862 6573 745f 6361 6e64 6964 6174 655b  (best_candidate[
+00011eb0: 305d 292c 205b 5d0a 2020 2020 2020 2020  0]), [].        
+00011ec0: 292e 6e6f 6465 0a0a 2020 2020 2020 2020  ).node..        
+00011ed0: 7265 7475 726e 2074 7261 7665 7273 616c  return traversal
+00011ee0: 732e 7265 706c 6163 655f 6e6f 6465 7328  s.replace_nodes(
+00011ef0: 0a20 2020 2020 2020 2020 2020 206e 6f64  .            nod
+00011f00: 652c 2074 6f5f 7265 706c 6163 653d 6265  e, to_replace=be
+00011f10: 7374 5f63 616e 6469 6461 7465 5b30 5d2c  st_candidate[0],
+00011f20: 2072 6570 6c61 6365 6d65 6e65 743d 6d61   replacemenet=ma
+00011f30: 7465 7269 616c 697a 6564 0a20 2020 2020  terialized.     
+00011f40: 2020 2029 0a0a 2020 2020 6465 6620 5f69     )..    def _i
+00011f50: 735f 7472 6976 6961 6c6c 795f 6578 6563  s_trivially_exec
+00011f60: 7574 6162 6c65 2873 656c 662c 2061 7272  utable(self, arr
+00011f70: 6179 5f76 616c 7565 3a20 636f 7265 2e41  ay_value: core.A
+00011f80: 7272 6179 5661 6c75 6529 3a0a 2020 2020  rrayValue):.    
+00011f90: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00011fa0: 4361 6e20 7468 6520 626c 6f63 6b20 6265  Can the block be
+00011fb0: 2065 7661 6c75 6174 6564 2076 6572 7920   evaluated very 
+00011fc0: 6368 6561 706c 793f 0a20 2020 2020 2020  cheaply?.       
+00011fd0: 2049 6620 5472 7565 2c20 7468 6520 6172   If True, the ar
+00011fe0: 7261 795f 7661 6c75 6520 7072 6f62 6162  ray_value probab
+00011ff0: 6c79 2069 7320 6e6f 7420 776f 7274 6820  ly is not worth 
+00012000: 6361 6368 696e 672e 0a20 2020 2020 2020  caching..       
+00012010: 2022 2222 0a20 2020 2020 2020 2023 204f   """.        # O
+00012020: 6e63 6520 7265 7772 6974 696e 6720 6973  nce rewriting is
+00012030: 2061 7661 696c 6162 6c65 2c20 7769 6c6c   available, will
+00012040: 2077 616e 7420 746f 2072 6577 7269 7465   want to rewrite
+00012050: 2062 6566 6f72 650a 2020 2020 2020 2020   before.        
+00012060: 2320 6576 616c 7561 7469 6e67 2065 7865  # evaluating exe
+00012070: 6375 7469 6f6e 2063 6f73 742e 0a20 2020  cution cost..   
+00012080: 2020 2020 2072 6574 7572 6e20 7472 6176       return trav
+00012090: 6572 7361 6c73 2e69 735f 7472 6976 6961  ersals.is_trivia
+000120a0: 6c6c 795f 6578 6563 7574 6162 6c65 2861  lly_executable(a
+000120b0: 7272 6179 5f76 616c 7565 2e6e 6f64 6529  rray_value.node)
+000120c0: 0a0a 2020 2020 6465 6620 5f65 7865 6375  ..    def _execu
+000120d0: 7465 280a 2020 2020 2020 2020 7365 6c66  te(.        self
+000120e0: 2c0a 2020 2020 2020 2020 6172 7261 795f  ,.        array_
+000120f0: 7661 6c75 653a 2063 6f72 652e 4172 7261  value: core.Arra
+00012100: 7956 616c 7565 2c0a 2020 2020 2020 2020  yValue,.        
+00012110: 6a6f 625f 636f 6e66 6967 3a20 4f70 7469  job_config: Opti
+00012120: 6f6e 616c 5b62 6967 7175 6572 792e 6a6f  onal[bigquery.jo
+00012130: 622e 5175 6572 794a 6f62 436f 6e66 6967  b.QueryJobConfig
+00012140: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
+00012150: 2020 2a2c 0a20 2020 2020 2020 2073 6f72    *,.        sor
+00012160: 7465 643a 2062 6f6f 6c20 3d20 5472 7565  ted: bool = True
+00012170: 2c0a 2020 2020 2020 2020 6472 795f 7275  ,.        dry_ru
+00012180: 6e3d 4661 6c73 652c 0a20 2020 2020 2020  n=False,.       
+00012190: 2063 6f6c 5f69 645f 6f76 6572 7269 6465   col_id_override
+000121a0: 733a 204d 6170 7069 6e67 5b73 7472 2c20  s: Mapping[str, 
+000121b0: 7374 725d 203d 207b 7d2c 0a20 2020 2029  str] = {},.    )
+000121c0: 202d 3e20 7475 706c 655b 6269 6771 7565   -> tuple[bigque
+000121d0: 7279 2e74 6162 6c65 2e52 6f77 4974 6572  ry.table.RowIter
+000121e0: 6174 6f72 2c20 6269 6771 7565 7279 2e51  ator, bigquery.Q
+000121f0: 7565 7279 4a6f 625d 3a0a 2020 2020 2020  ueryJob]:.      
+00012200: 2020 7371 6c20 3d20 7365 6c66 2e5f 746f    sql = self._to
+00012210: 5f73 716c 280a 2020 2020 2020 2020 2020  _sql(.          
+00012220: 2020 6172 7261 795f 7661 6c75 652c 2073    array_value, s
+00012230: 6f72 7465 643d 736f 7274 6564 2c20 636f  orted=sorted, co
+00012240: 6c5f 6964 5f6f 7665 7272 6964 6573 3d63  l_id_overrides=c
+00012250: 6f6c 5f69 645f 6f76 6572 7269 6465 730a  ol_id_overrides.
+00012260: 2020 2020 2020 2020 2920 2023 2074 7970          )  # typ
+00012270: 653a 6967 6e6f 7265 0a20 2020 2020 2020  e:ignore.       
+00012280: 2069 6620 6a6f 625f 636f 6e66 6967 2069   if job_config i
+00012290: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+000122a0: 2020 2020 6a6f 625f 636f 6e66 6967 203d      job_config =
+000122b0: 2062 6967 7175 6572 792e 5175 6572 794a   bigquery.QueryJ
+000122c0: 6f62 436f 6e66 6967 2864 7279 5f72 756e  obConfig(dry_run
+000122d0: 3d64 7279 5f72 756e 290a 2020 2020 2020  =dry_run).      
+000122e0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+000122f0: 2020 2020 6a6f 625f 636f 6e66 6967 2e64      job_config.d
+00012300: 7279 5f72 756e 203d 2064 7279 5f72 756e  ry_run = dry_run
+00012310: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00012320: 7365 6c66 2e5f 7374 6172 745f 7175 6572  self._start_quer
+00012330: 7928 0a20 2020 2020 2020 2020 2020 2073  y(.            s
+00012340: 716c 3d73 716c 2c0a 2020 2020 2020 2020  ql=sql,.        
+00012350: 2020 2020 6a6f 625f 636f 6e66 6967 3d6a      job_config=j
+00012360: 6f62 5f63 6f6e 6669 672c 0a20 2020 2020  ob_config,.     
+00012370: 2020 2029 0a0a 2020 2020 6465 6620 5f70     )..    def _p
+00012380: 6565 6b28 0a20 2020 2020 2020 2073 656c  eek(.        sel
+00012390: 662c 2061 7272 6179 5f76 616c 7565 3a20  f, array_value: 
+000123a0: 636f 7265 2e41 7272 6179 5661 6c75 652c  core.ArrayValue,
+000123b0: 206e 5f72 6f77 733a 2069 6e74 0a20 2020   n_rows: int.   
+000123c0: 2029 202d 3e20 7475 706c 655b 6269 6771   ) -> tuple[bigq
+000123d0: 7565 7279 2e74 6162 6c65 2e52 6f77 4974  uery.table.RowIt
+000123e0: 6572 6174 6f72 2c20 6269 6771 7565 7279  erator, bigquery
+000123f0: 2e51 7565 7279 4a6f 625d 3a0a 2020 2020  .QueryJob]:.    
+00012400: 2020 2020 2222 2241 2027 7065 656b 2720      """A 'peek' 
+00012410: 6566 6669 6369 656e 746c 7920 6163 6365  efficiently acce
+00012420: 7373 6573 2061 2073 6d61 6c6c 206e 756d  sses a small num
+00012430: 6265 7220 6f66 2072 6f77 7320 696e 2074  ber of rows in t
+00012440: 6865 2064 6174 6166 7261 6d65 2e22 2222  he dataframe."""
+00012450: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+00012460: 7472 6565 5f70 726f 7065 7274 6965 732e  tree_properties.
+00012470: 7065 656b 6162 6c65 2861 7272 6179 5f76  peekable(array_v
+00012480: 616c 7565 2e6e 6f64 6529 3a0a 2020 2020  alue.node):.    
+00012490: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
+000124a0: 2e77 6172 6e28 2250 6565 6b69 6e67 2074  .warn("Peeking t
+000124b0: 6869 7320 7661 6c75 6520 6361 6e6e 6f74  his value cannot
+000124c0: 2062 6520 646f 6e65 2065 6666 6963 6965   be done efficie
+000124d0: 6e74 6c79 2e22 290a 2020 2020 2020 2020  ntly.").        
+000124e0: 7371 6c20 3d20 7365 6c66 2e5f 636f 6d70  sql = self._comp
+000124f0: 696c 655f 756e 6f72 6465 7265 6428 6172  ile_unordered(ar
+00012500: 7261 795f 7661 6c75 6529 2e70 6565 6b5f  ray_value).peek_
+00012510: 7371 6c28 6e5f 726f 7773 290a 2020 2020  sql(n_rows).    
+00012520: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00012530: 5f73 7461 7274 5f71 7565 7279 280a 2020  _start_query(.  
+00012540: 2020 2020 2020 2020 2020 7371 6c3d 7371            sql=sq
+00012550: 6c2c 0a20 2020 2020 2020 2029 0a0a 2020  l,.        )..  
+00012560: 2020 6465 6620 5f74 6f5f 7371 6c28 0a20    def _to_sql(. 
+00012570: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+00012580: 2020 2020 2061 7272 6179 5f76 616c 7565       array_value
+00012590: 3a20 636f 7265 2e41 7272 6179 5661 6c75  : core.ArrayValu
+000125a0: 652c 0a20 2020 2020 2020 206f 6666 7365  e,.        offse
+000125b0: 745f 636f 6c75 6d6e 3a20 7479 7069 6e67  t_column: typing
+000125c0: 2e4f 7074 696f 6e61 6c5b 7374 725d 203d  .Optional[str] =
+000125d0: 204e 6f6e 652c 0a20 2020 2020 2020 2063   None,.        c
+000125e0: 6f6c 5f69 645f 6f76 6572 7269 6465 733a  ol_id_overrides:
+000125f0: 2074 7970 696e 672e 4d61 7070 696e 675b   typing.Mapping[
+00012600: 7374 722c 2073 7472 5d20 3d20 7b7d 2c0a  str, str] = {},.
+00012610: 2020 2020 2020 2020 736f 7274 6564 3a20          sorted: 
+00012620: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
+00012630: 2020 2920 2d3e 2073 7472 3a0a 2020 2020    ) -> str:.    
+00012640: 2020 2020 6966 206f 6666 7365 745f 636f      if offset_co
+00012650: 6c75 6d6e 3a0a 2020 2020 2020 2020 2020  lumn:.          
+00012660: 2020 6172 7261 795f 7661 6c75 6520 3d20    array_value = 
+00012670: 6172 7261 795f 7661 6c75 652e 7072 6f6d  array_value.prom
+00012680: 6f74 655f 6f66 6673 6574 7328 6f66 6673  ote_offsets(offs
+00012690: 6574 5f63 6f6c 756d 6e29 0a20 2020 2020  et_column).     
+000126a0: 2020 2069 6620 736f 7274 6564 3a0a 2020     if sorted:.  
+000126b0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+000126c0: 2073 656c 662e 5f63 6f6d 7069 6c65 5f6f   self._compile_o
+000126d0: 7264 6572 6564 2861 7272 6179 5f76 616c  rdered(array_val
+000126e0: 7565 292e 746f 5f73 716c 280a 2020 2020  ue).to_sql(.    
+000126f0: 2020 2020 2020 2020 2020 2020 636f 6c5f              col_
+00012700: 6964 5f6f 7665 7272 6964 6573 3d63 6f6c  id_overrides=col
+00012710: 5f69 645f 6f76 6572 7269 6465 732c 2073  _id_overrides, s
+00012720: 6f72 7465 643d 5472 7565 0a20 2020 2020  orted=True.     
+00012730: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00012740: 2072 6574 7572 6e20 7365 6c66 2e5f 636f   return self._co
+00012750: 6d70 696c 655f 756e 6f72 6465 7265 6428  mpile_unordered(
+00012760: 6172 7261 795f 7661 6c75 6529 2e74 6f5f  array_value).to_
+00012770: 7371 6c28 0a20 2020 2020 2020 2020 2020  sql(.           
+00012780: 2063 6f6c 5f69 645f 6f76 6572 7269 6465   col_id_override
+00012790: 733d 636f 6c5f 6964 5f6f 7665 7272 6964  s=col_id_overrid
+000127a0: 6573 0a20 2020 2020 2020 2029 0a0a 2020  es.        )..  
+000127b0: 2020 6465 6620 5f63 6f6d 7069 6c65 5f6f    def _compile_o
+000127c0: 7264 6572 6564 280a 2020 2020 2020 2020  rdered(.        
+000127d0: 7365 6c66 2c20 6172 7261 795f 7661 6c75  self, array_valu
+000127e0: 653a 2063 6f72 652e 4172 7261 7956 616c  e: core.ArrayVal
+000127f0: 7565 0a20 2020 2029 202d 3e20 6269 6766  ue.    ) -> bigf
+00012800: 7261 6d65 732e 636f 7265 2e63 6f6d 7069  rames.core.compi
+00012810: 6c65 2e4f 7264 6572 6564 4952 3a0a 2020  le.OrderedIR:.  
+00012820: 2020 2020 2020 7265 7475 726e 2062 6967        return big
+00012830: 6672 616d 6573 2e63 6f72 652e 636f 6d70  frames.core.comp
+00012840: 696c 652e 636f 6d70 696c 655f 6f72 6465  ile.compile_orde
+00012850: 7265 645f 6972 2861 7272 6179 5f76 616c  red_ir(array_val
+00012860: 7565 2e6e 6f64 6529 0a0a 2020 2020 6465  ue.node)..    de
+00012870: 6620 5f63 6f6d 7069 6c65 5f75 6e6f 7264  f _compile_unord
+00012880: 6572 6564 280a 2020 2020 2020 2020 7365  ered(.        se
+00012890: 6c66 2c20 6172 7261 795f 7661 6c75 653a  lf, array_value:
+000128a0: 2063 6f72 652e 4172 7261 7956 616c 7565   core.ArrayValue
+000128b0: 0a20 2020 2029 202d 3e20 6269 6766 7261  .    ) -> bigfra
+000128c0: 6d65 732e 636f 7265 2e63 6f6d 7069 6c65  mes.core.compile
+000128d0: 2e55 6e6f 7264 6572 6564 4952 3a0a 2020  .UnorderedIR:.  
+000128e0: 2020 2020 2020 7265 7475 726e 2062 6967        return big
+000128f0: 6672 616d 6573 2e63 6f72 652e 636f 6d70  frames.core.comp
+00012900: 696c 652e 636f 6d70 696c 655f 756e 6f72  ile.compile_unor
+00012910: 6465 7265 645f 6972 2861 7272 6179 5f76  dered_ir(array_v
+00012920: 616c 7565 2e6e 6f64 6529 0a0a 2020 2020  alue.node)..    
+00012930: 6465 6620 5f67 6574 5f74 6162 6c65 5f73  def _get_table_s
+00012940: 697a 6528 7365 6c66 2c20 6465 7374 696e  ize(self, destin
+00012950: 6174 696f 6e5f 7461 626c 6529 3a0a 2020  ation_table):.  
+00012960: 2020 2020 2020 7461 626c 6520 3d20 7365        table = se
+00012970: 6c66 2e62 7163 6c69 656e 742e 6765 745f  lf.bqclient.get_
+00012980: 7461 626c 6528 6465 7374 696e 6174 696f  table(destinatio
+00012990: 6e5f 7461 626c 6529 0a20 2020 2020 2020  n_table).       
+000129a0: 2072 6574 7572 6e20 7461 626c 652e 6e75   return table.nu
+000129b0: 6d5f 6279 7465 730a 0a20 2020 2064 6566  m_bytes..    def
+000129c0: 205f 726f 7773 5f74 6f5f 6461 7461 6672   _rows_to_datafr
+000129d0: 616d 6528 0a20 2020 2020 2020 2073 656c  ame(.        sel
+000129e0: 662c 2072 6f77 5f69 7465 7261 746f 723a  f, row_iterator:
+000129f0: 2062 6967 7175 6572 792e 7461 626c 652e   bigquery.table.
+00012a00: 526f 7749 7465 7261 746f 722c 2064 7479  RowIterator, dty
+00012a10: 7065 733a 2044 6963 740a 2020 2020 2920  pes: Dict.    ) 
+00012a20: 2d3e 2070 616e 6461 732e 4461 7461 4672  -> pandas.DataFr
+00012a30: 616d 653a 0a20 2020 2020 2020 2023 2043  ame:.        # C
+00012a40: 616e 2069 676e 6f72 6520 696e 6665 7272  an ignore inferr
+00012a50: 6564 2064 6174 6174 7970 6520 756e 7469  ed datatype unti
+00012a60: 6c20 6474 7970 6520 656d 756c 6174 696f  l dtype emulatio
+00012a70: 6e20 6272 6561 6b73 2031 3a31 206d 6170  n breaks 1:1 map
+00012a80: 7069 6e67 2062 6574 7765 656e 2042 5120  ping between BQ 
+00012a90: 7479 7065 7320 616e 6420 6269 6766 7261  types and bigfra
+00012aa0: 6d65 7320 7479 7065 730a 2020 2020 2020  mes types.      
+00012ab0: 2020 6474 7970 6573 5f66 726f 6d5f 6271    dtypes_from_bq
+00012ac0: 203d 2062 6967 6672 616d 6573 2e64 7479   = bigframes.dty
+00012ad0: 7065 732e 6266 5f74 7970 655f 6672 6f6d  pes.bf_type_from
+00012ae0: 5f74 7970 655f 6b69 6e64 2872 6f77 5f69  _type_kind(row_i
+00012af0: 7465 7261 746f 722e 7363 6865 6d61 290a  terator.schema).
+00012b00: 2020 2020 2020 2020 6172 726f 775f 7461          arrow_ta
+00012b10: 626c 6520 3d20 726f 775f 6974 6572 6174  ble = row_iterat
+00012b20: 6f72 2e74 6f5f 6172 726f 7728 290a 2020  or.to_arrow().  
+00012b30: 2020 2020 2020 7265 7475 726e 2062 6967        return big
+00012b40: 6672 616d 6573 2e73 6573 7369 6f6e 2e5f  frames.session._
+00012b50: 696f 2e70 616e 6461 732e 6172 726f 775f  io.pandas.arrow_
+00012b60: 746f 5f70 616e 6461 7328 6172 726f 775f  to_pandas(arrow_
+00012b70: 7461 626c 652c 2064 7479 7065 735f 6672  table, dtypes_fr
+00012b80: 6f6d 5f62 7129 0a0a 2020 2020 6465 6620  om_bq)..    def 
+00012b90: 5f73 7461 7274 5f67 656e 6572 6963 5f6a  _start_generic_j
+00012ba0: 6f62 2873 656c 662c 206a 6f62 3a20 666f  ob(self, job: fo
+00012bb0: 726d 6174 7469 6e67 5f68 656c 7065 7273  rmatting_helpers
+00012bc0: 2e47 656e 6572 6963 4a6f 6229 3a0a 2020  .GenericJob):.  
+00012bd0: 2020 2020 2020 6966 2062 6967 6672 616d        if bigfram
+00012be0: 6573 2e6f 7074 696f 6e73 2e64 6973 706c  es.options.displ
+00012bf0: 6179 2e70 726f 6772 6573 735f 6261 7220  ay.progress_bar 
+00012c00: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+00012c10: 2020 2020 2020 2020 2066 6f72 6d61 7474           formatt
+00012c20: 696e 675f 6865 6c70 6572 732e 7761 6974  ing_helpers.wait
+00012c30: 5f66 6f72 5f6a 6f62 280a 2020 2020 2020  _for_job(.      
+00012c40: 2020 2020 2020 2020 2020 6a6f 622c 2062            job, b
+00012c50: 6967 6672 616d 6573 2e6f 7074 696f 6e73  igframes.options
+00012c60: 2e64 6973 706c 6179 2e70 726f 6772 6573  .display.progres
+00012c70: 735f 6261 720a 2020 2020 2020 2020 2020  s_bar.          
+00012c80: 2020 2920 2023 2057 6169 7420 666f 7220    )  # Wait for 
+00012c90: 7468 6520 6a6f 6220 746f 2063 6f6d 706c  the job to compl
+00012ca0: 6574 650a 2020 2020 2020 2020 656c 7365  ete.        else
+00012cb0: 3a0a 2020 2020 2020 2020 2020 2020 6a6f  :.            jo
+00012cc0: 622e 7265 7375 6c74 2829 0a0a 2020 2020  b.result()..    
+00012cd0: 6465 6620 5f72 616e 646f 6d5f 7461 626c  def _random_tabl
+00012ce0: 6528 7365 6c66 2c20 736b 6970 5f63 6c65  e(self, skip_cle
+00012cf0: 616e 7570 3a20 626f 6f6c 203d 2046 616c  anup: bool = Fal
+00012d00: 7365 2920 2d3e 2062 6967 7175 6572 792e  se) -> bigquery.
+00012d10: 5461 626c 6552 6566 6572 656e 6365 3a0a  TableReference:.
+00012d20: 2020 2020 2020 2020 2222 2247 656e 6572          """Gener
+00012d30: 6174 6520 6120 7261 6e64 6f6d 2074 6162  ate a random tab
+00012d40: 6c65 2049 4420 7769 7468 2042 6967 5175  le ID with BigQu
+00012d50: 6572 7920 4461 7461 4672 616d 6573 2070  ery DataFrames p
+00012d60: 7265 6669 782e 0a0a 2020 2020 2020 2020  refix...        
+00012d70: 5468 6520 6765 6e65 7261 7465 6420 4944  The generated ID
+00012d80: 2077 696c 6c20 6265 2073 746f 7265 6420   will be stored 
+00012d90: 616e 6420 6368 6563 6b65 6420 666f 7220  and checked for 
+00012da0: 6465 6c65 7469 6f6e 2077 6865 6e20 7468  deletion when th
+00012db0: 650a 2020 2020 2020 2020 7365 7373 696f  e.        sessio
+00012dc0: 6e20 6973 2063 6c6f 7365 642c 2075 6e6c  n is closed, unl
+00012dd0: 6573 7320 736b 6970 5f63 6c65 616e 7570  ess skip_cleanup
+00012de0: 2069 7320 5472 7565 2e0a 0a20 2020 2020   is True...     
+00012df0: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
+00012e00: 2020 2020 2073 6b69 705f 636c 6561 6e75       skip_cleanu
+00012e10: 7020 2862 6f6f 6c2c 2064 6566 6175 6c74  p (bool, default
+00012e20: 2046 616c 7365 293a 0a20 2020 2020 2020   False):.       
+00012e30: 2020 2020 2020 2020 2049 6620 5472 7565           If True
+00012e40: 2c20 646f 206e 6f74 2061 6464 2074 6865  , do not add the
+00012e50: 2067 656e 6572 6174 6564 2049 4420 746f   generated ID to
+00012e60: 2074 6865 206c 6973 7420 6f66 2074 6162   the list of tab
+00012e70: 6c65 730a 2020 2020 2020 2020 2020 2020  les.            
+00012e80: 2020 2020 746f 2063 6c65 616e 2075 7020      to clean up 
+00012e90: 7768 656e 2074 6865 2073 6573 7369 6f6e  when the session
+00012ea0: 2069 7320 636c 6f73 6564 2e0a 0a20 2020   is closed...   
+00012eb0: 2020 2020 2052 6574 7572 6e73 3a0a 2020       Returns:.  
+00012ec0: 2020 2020 2020 2020 2020 676f 6f67 6c65            google
+00012ed0: 2e63 6c6f 7564 2e62 6967 7175 6572 792e  .cloud.bigquery.
+00012ee0: 5461 626c 6552 6566 6572 656e 6365 3a0a  TableReference:.
+00012ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012f00: 4675 6c6c 7920 7175 616c 6966 6965 6420  Fully qualified 
+00012f10: 7461 626c 6520 4944 206f 6620 6120 7461  table ID of a ta
+00012f20: 626c 6520 7468 6174 2064 6f65 736e 2774  ble that doesn't
+00012f30: 2065 7869 7374 2e0a 2020 2020 2020 2020   exist..        
+00012f40: 2222 220a 2020 2020 2020 2020 6461 7461  """.        data
+00012f50: 7365 7420 3d20 7365 6c66 2e5f 616e 6f6e  set = self._anon
+00012f60: 796d 6f75 735f 6461 7461 7365 740a 2020  ymous_dataset.  
+00012f70: 2020 2020 2020 7365 7373 696f 6e5f 6964        session_id
+00012f80: 203d 2073 656c 662e 7365 7373 696f 6e5f   = self.session_
+00012f90: 6964 0a20 2020 2020 2020 206e 6f77 203d  id.        now =
+00012fa0: 2064 6174 6574 696d 652e 6461 7465 7469   datetime.dateti
+00012fb0: 6d65 2e6e 6f77 2864 6174 6574 696d 652e  me.now(datetime.
+00012fc0: 7469 6d65 7a6f 6e65 2e75 7463 290a 2020  timezone.utc).  
+00012fd0: 2020 2020 2020 7261 6e64 6f6d 5f69 6420        random_id 
+00012fe0: 3d20 7575 6964 2e75 7569 6434 2829 2e68  = uuid.uuid4().h
+00012ff0: 6578 0a20 2020 2020 2020 2074 6162 6c65  ex.        table
+00013000: 5f69 6420 3d20 5f54 454d 505f 5441 424c  _id = _TEMP_TABL
+00013010: 455f 4944 5f46 4f52 4d41 542e 666f 726d  E_ID_FORMAT.form
+00013020: 6174 280a 2020 2020 2020 2020 2020 2020  at(.            
+00013030: 6461 7465 3d6e 6f77 2e73 7472 6674 696d  date=now.strftim
+00013040: 6528 2225 5925 6d25 6422 292c 2073 6573  e("%Y%m%d"), ses
+00013050: 7369 6f6e 5f69 643d 7365 7373 696f 6e5f  sion_id=session_
+00013060: 6964 2c20 7261 6e64 6f6d 5f69 643d 7261  id, random_id=ra
+00013070: 6e64 6f6d 5f69 640a 2020 2020 2020 2020  ndom_id.        
+00013080: 290a 2020 2020 2020 2020 6966 206e 6f74  ).        if not
+00013090: 2073 6b69 705f 636c 6561 6e75 703a 0a20   skip_cleanup:. 
+000130a0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000130b0: 5f74 6162 6c65 5f69 6473 2e61 7070 656e  _table_ids.appen
+000130c0: 6428 7461 626c 655f 6964 290a 2020 2020  d(table_id).    
+000130d0: 2020 2020 7265 7475 726e 2064 6174 6173      return datas
+000130e0: 6574 2e74 6162 6c65 2874 6162 6c65 5f69  et.table(table_i
+000130f0: 6429 0a0a 0a64 6566 2063 6f6e 6e65 6374  d)...def connect
+00013100: 2863 6f6e 7465 7874 3a20 4f70 7469 6f6e  (context: Option
+00013110: 616c 5b62 6967 7175 6572 795f 6f70 7469  al[bigquery_opti
+00013120: 6f6e 732e 4269 6751 7565 7279 4f70 7469  ons.BigQueryOpti
+00013130: 6f6e 735d 203d 204e 6f6e 6529 202d 3e20  ons] = None) -> 
+00013140: 5365 7373 696f 6e3a 0a20 2020 2072 6574  Session:.    ret
+00013150: 7572 6e20 5365 7373 696f 6e28 636f 6e74  urn Session(cont
+00013160: 6578 7429 0a0a 0a64 6566 205f 6361 6e5f  ext)...def _can_
+00013170: 636c 7573 7465 725f 6271 2866 6965 6c64  cluster_bq(field
+00013180: 3a20 6269 6771 7565 7279 2e53 6368 656d  : bigquery.Schem
+00013190: 6146 6965 6c64 293a 0a20 2020 2023 2068  aField):.    # h
+000131a0: 7474 7073 3a2f 2f63 6c6f 7564 2e67 6f6f  ttps://cloud.goo
+000131b0: 676c 652e 636f 6d2f 6269 6771 7565 7279  gle.com/bigquery
+000131c0: 2f64 6f63 732f 636c 7573 7465 7265 642d  /docs/clustered-
+000131d0: 7461 626c 6573 0a20 2020 2023 204e 6f74  tables.    # Not
+000131e0: 6162 6c79 2c20 666c 6f61 7420 6973 2065  ably, float is e
+000131f0: 7863 6c75 6465 640a 2020 2020 7479 7065  xcluded.    type
+00013200: 5f20 3d20 6669 656c 642e 6669 656c 645f  _ = field.field_
+00013210: 7479 7065 0a20 2020 2072 6574 7572 6e20  type.    return 
+00013220: 7479 7065 5f20 696e 2028 0a20 2020 2020  type_ in (.     
+00013230: 2020 2022 494e 5445 4745 5222 2c0a 2020     "INTEGER",.  
+00013240: 2020 2020 2020 2249 4e54 3634 222c 0a20        "INT64",. 
+00013250: 2020 2020 2020 2022 5354 5249 4e47 222c         "STRING",
+00013260: 0a20 2020 2020 2020 2022 4e55 4d45 5249  .        "NUMERI
+00013270: 4322 2c0a 2020 2020 2020 2020 2244 4543  C",.        "DEC
+00013280: 494d 414c 222c 0a20 2020 2020 2020 2022  IMAL",.        "
+00013290: 4249 474e 554d 4552 4943 222c 0a20 2020  BIGNUMERIC",.   
+000132a0: 2020 2020 2022 4249 4744 4543 494d 414c       "BIGDECIMAL
+000132b0: 222c 0a20 2020 2020 2020 2022 4441 5445  ",.        "DATE
+000132c0: 222c 0a20 2020 2020 2020 2022 4441 5445  ",.        "DATE
+000132d0: 5449 4d45 222c 0a20 2020 2020 2020 2022  TIME",.        "
+000132e0: 5449 4d45 5354 414d 5022 2c0a 2020 2020  TIMESTAMP",.    
+000132f0: 2020 2020 2242 4f4f 4c22 2c0a 2020 2020      "BOOL",.    
+00013300: 2020 2020 2242 4f4f 4c45 414e 222c 0a20      "BOOLEAN",. 
+00013310: 2020 2029 0a0a 0a64 6566 205f 7472 616e     )...def _tran
+00013320: 7366 6f72 6d5f 7265 6164 5f67 6271 5f63  sform_read_gbq_c
+00013330: 6f6e 6669 6775 7261 7469 6f6e 2863 6f6e  onfiguration(con
+00013340: 6669 6775 7261 7469 6f6e 3a20 4f70 7469  figuration: Opti
+00013350: 6f6e 616c 5b64 6963 745d 2920 2d3e 2064  onal[dict]) -> d
+00013360: 6963 743a 0a20 2020 2022 2222 0a20 2020  ict:.    """.   
+00013370: 2046 6f72 2062 6163 6b77 6172 6473 2d63   For backwards-c
+00013380: 6f6d 7061 7469 6269 6c69 7479 2c20 636f  ompatibility, co
+00013390: 6e76 6572 7420 616e 7920 7072 6576 696f  nvert any previo
+000133a0: 7573 6c79 2063 6c69 656e 742d 7369 6465  usly client-side
+000133b0: 206f 6e6c 790a 2020 2020 7061 7261 6d65   only.    parame
+000133c0: 7465 7273 2073 7563 6820 6173 2074 696d  ters such as tim
+000133d0: 656f 7574 4d73 2074 6f20 7468 6520 7072  eoutMs to the pr
+000133e0: 6f70 6572 7479 206e 616d 6520 6578 7065  operty name expe
+000133f0: 6374 6564 2062 7920 7468 6520 5245 5354  cted by the REST
+00013400: 2041 5049 2e0a 0a20 2020 204d 616b 6573   API...    Makes
+00013410: 2061 2063 6f70 7920 6f66 2063 6f6e 6669   a copy of confi
+00013420: 6775 7261 7469 6f6e 2069 6620 6368 616e  guration if chan
+00013430: 6765 7320 6172 6520 6e65 6564 6564 2e0a  ges are needed..
+00013440: 2020 2020 2222 220a 0a20 2020 2069 6620      """..    if 
+00013450: 636f 6e66 6967 7572 6174 696f 6e20 6973  configuration is
+00013460: 204e 6f6e 653a 0a20 2020 2020 2020 2072   None:.        r
+00013470: 6574 7572 6e20 7b7d 0a0a 2020 2020 7469  eturn {}..    ti
+00013480: 6d65 6f75 745f 6d73 203d 2063 6f6e 6669  meout_ms = confi
+00013490: 6775 7261 7469 6f6e 2e67 6574 2822 7175  guration.get("qu
+000134a0: 6572 7922 2c20 7b7d 292e 6765 7428 2274  ery", {}).get("t
+000134b0: 696d 656f 7574 4d73 2229 0a20 2020 2069  imeoutMs").    i
+000134c0: 6620 7469 6d65 6f75 745f 6d73 2069 7320  f timeout_ms is 
+000134d0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+000134e0: 2020 2320 5472 616e 7366 6f72 6d20 7469    # Transform ti
+000134f0: 6d65 6f75 744d 7320 746f 2061 6e20 6163  meoutMs to an ac
+00013500: 7475 616c 2073 6572 7665 722d 7369 6465  tual server-side
+00013510: 2063 6f6e 6669 6775 7261 7469 6f6e 2e0a   configuration..
+00013520: 2020 2020 2020 2020 2320 6874 7470 733a          # https:
+00013530: 2f2f 6769 7468 7562 2e63 6f6d 2f67 6f6f  //github.com/goo
+00013540: 676c 6561 7069 732f 7079 7468 6f6e 2d62  gleapis/python-b
+00013550: 6967 7175 6572 792d 7061 6e64 6173 2f69  igquery-pandas/i
+00013560: 7373 7565 732f 3437 390a 2020 2020 2020  ssues/479.      
+00013570: 2020 636f 6e66 6967 7572 6174 696f 6e20    configuration 
+00013580: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
+00013590: 636f 6e66 6967 7572 6174 696f 6e29 0a20  configuration). 
+000135a0: 2020 2020 2020 2064 656c 2063 6f6e 6669         del confi
+000135b0: 6775 7261 7469 6f6e 5b22 7175 6572 7922  guration["query"
+000135c0: 5d5b 2274 696d 656f 7574 4d73 225d 0a20  ]["timeoutMs"]. 
+000135d0: 2020 2020 2020 2063 6f6e 6669 6775 7261         configura
+000135e0: 7469 6f6e 5b22 6a6f 6254 696d 656f 7574  tion["jobTimeout
+000135f0: 4d73 225d 203d 2074 696d 656f 7574 5f6d  Ms"] = timeout_m
+00013600: 730a 0a20 2020 2072 6574 7572 6e20 636f  s..    return co
+00013610: 6e66 6967 7572 6174 696f 6e0a            nfiguration.
```

### Comparing `bigframes-1.5.0/bigframes/session/_io/__init__.py` & `bigframes-1.6.0/bigframes/session/_io/__init__.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/session/_io/bigquery/__init__.py` & `bigframes-1.6.0/bigframes/session/_io/bigquery/__init__.py`

 * *Files 20% similar despite different names*

```diff
@@ -15,18 +15,21 @@
 """Private module: Helpers for BigQuery I/O operations."""
 
 from __future__ import annotations
 
 import datetime
 import itertools
 import os
+import re
 import textwrap
 import types
-from typing import Dict, Iterable, Optional, Sequence, Tuple, Union
+import typing
+from typing import Dict, Iterable, Mapping, Optional, Tuple, Union
 
+import bigframes_vendored.pandas.io.gbq as third_party_pandas_gbq
 import google.api_core.exceptions
 import google.cloud.bigquery as bigquery
 
 import bigframes
 from bigframes.core import log_adapter
 import bigframes.formatting_helpers as formatting_helpers
 
@@ -36,19 +39,23 @@
 # will be limited to this many tables
 
 LOGGING_NAME_ENV_VAR = "BIGFRAMES_PERFORMANCE_LOG_NAME"
 
 
 def create_job_configs_labels(
     job_configs_labels: Optional[Dict[str, str]],
-    api_methods: Sequence[str],
+    api_methods: typing.List[str],
 ) -> Dict[str, str]:
     if job_configs_labels is None:
         job_configs_labels = {}
 
+    if api_methods:
+        job_configs_labels["bigframes-api"] = api_methods[0]
+        del api_methods[0]
+
     labels = list(
         itertools.chain(
             job_configs_labels.keys(),
             (f"recent-bigframes-api-{i}" for i in range(len(api_methods))),
         )
     )
     values = list(itertools.chain(job_configs_labels.values(), api_methods))
@@ -191,18 +198,19 @@
     job_config: bigquery.job.QueryJobConfig,
     max_results: Optional[int] = None,
     timeout: Optional[float] = None,
 ) -> Tuple[bigquery.table.RowIterator, bigquery.QueryJob]:
     """
     Starts query job and waits for results.
     """
-    api_methods = log_adapter.get_and_reset_api_methods()
-    job_config.labels = create_job_configs_labels(
-        job_configs_labels=job_config.labels, api_methods=api_methods
-    )
+    if not job_config.dry_run:
+        api_methods = log_adapter.get_and_reset_api_methods()
+        job_config.labels = create_job_configs_labels(
+            job_configs_labels=job_config.labels, api_methods=api_methods
+        )
 
     try:
         query_job = bq_client.query(sql, job_config=job_config, timeout=timeout)
     except google.api_core.exceptions.Forbidden as ex:
         if "Drive credentials" in ex.message:
             ex.message += "\nCheck https://cloud.google.com/bigquery/docs/query-drive-data#Google_Drive_permissions."
         raise
@@ -307,7 +315,99 @@
     # different anonymous dataset per location. See:
     # https://cloud.google.com/bigquery/docs/cached-results#how_cached_results_are_stored
     query_destination = query_job.destination
     return bigquery.DatasetReference(
         query_destination.project,
         query_destination.dataset_id,
     )
+
+
+def is_query(query_or_table: str) -> bool:
+    """Determine if `query_or_table` is a table ID or a SQL string"""
+    return re.search(r"\s", query_or_table.strip(), re.MULTILINE) is not None
+
+
+def is_table_with_wildcard_suffix(query_or_table: str) -> bool:
+    """Determine if `query_or_table` is a table and contains a wildcard suffix."""
+    return not is_query(query_or_table) and query_or_table.endswith("*")
+
+
+def to_query(
+    query_or_table: str,
+    index_cols: Iterable[str],
+    columns: Iterable[str],
+    filters: third_party_pandas_gbq.FiltersType,
+) -> str:
+    """Compile query_or_table with conditions(filters, wildcards) to query."""
+    filters = list(filters)
+    sub_query = (
+        f"({query_or_table})" if is_query(query_or_table) else f"`{query_or_table}`"
+    )
+
+    # TODO(b/338111344): Generate an index based on DefaultIndexKind if we
+    # don't have index columns specified.
+    if columns:
+        # We only reduce the selection if columns is set, but we always
+        # want to make sure index_cols is also included.
+        all_columns = itertools.chain(index_cols, columns)
+        select_clause = "SELECT " + ", ".join(f"`{column}`" for column in all_columns)
+    else:
+        select_clause = "SELECT *"
+
+    where_clause = ""
+    if filters:
+        valid_operators: Mapping[third_party_pandas_gbq.FilterOps, str] = {
+            "in": "IN",
+            "not in": "NOT IN",
+            "LIKE": "LIKE",
+            "==": "=",
+            ">": ">",
+            "<": "<",
+            ">=": ">=",
+            "<=": "<=",
+            "!=": "!=",
+        }
+
+        # If single layer filter, add another pseudo layer. So the single layer represents "and" logic.
+        if isinstance(filters[0], tuple) and (
+            len(filters[0]) == 0 or not isinstance(list(filters[0])[0], tuple)
+        ):
+            filters = typing.cast(third_party_pandas_gbq.FiltersType, [filters])
+
+        or_expressions = []
+        for group in filters:
+            if not isinstance(group, Iterable):
+                group = [group]
+
+            and_expressions = []
+            for filter_item in group:
+                if not isinstance(filter_item, tuple) or (len(filter_item) != 3):
+                    raise ValueError(
+                        f"Filter condition should be a tuple of length 3, {filter_item} is not valid."
+                    )
+
+                column, operator, value = filter_item
+
+                if not isinstance(column, str):
+                    raise ValueError(
+                        f"Column name should be a string, but received '{column}' of type {type(column).__name__}."
+                    )
+
+                if operator not in valid_operators:
+                    raise ValueError(f"Operator {operator} is not valid.")
+
+                operator_str = valid_operators[operator]
+
+                if operator_str in ["IN", "NOT IN"]:
+                    value_list = ", ".join([repr(v) for v in value])
+                    expression = f"`{column}` {operator_str} ({value_list})"
+                else:
+                    expression = f"`{column}` {operator_str} {repr(value)}"
+                and_expressions.append(expression)
+
+            or_expressions.append(" AND ".join(and_expressions))
+
+        if or_expressions:
+            where_clause = " WHERE " + " OR ".join(or_expressions)
+
+    full_query = f"{select_clause} FROM {sub_query} AS sub{where_clause}"
+    return full_query
```

### Comparing `bigframes-1.5.0/bigframes/session/_io/bigquery/read_gbq_table.py` & `bigframes-1.6.0/bigframes/session/_io/bigquery/read_gbq_table.py`

 * *Files 1% similar despite different names*

```diff
@@ -108,16 +108,14 @@
 
     # TODO(swast): It's possible that the table metadata is changed between now
     # and when we run the CURRENT_TIMESTAMP() query to see when we can time
     # travel to. Find a way to fetch the table metadata and BQ's current time
     # atomically.
     table = bqclient.get_table(table_ref)
 
-    # TODO(b/336521938): Refactor to make sure we set the "bigframes-api"
-    # whereever we execute a query.
     job_config = bigquery.QueryJobConfig()
     job_config.labels["bigframes-api"] = api_name
     snapshot_timestamp = list(
         bqclient.query(
             "SELECT CURRENT_TIMESTAMP() AS `current_timestamp`",
             job_config=job_config,
         ).result()
@@ -340,16 +338,14 @@
 
     # TODO(swast): It's possible that the table metadata is changed between now
     # and when we run the CURRENT_TIMESTAMP() query to see when we can time
     # travel to. Find a way to fetch the table metadata and BQ's current time
     # atomically.
     table = bqclient.get_table(table_ref)
 
-    # TODO(b/336521938): Refactor to make sure we set the "bigframes-api"
-    # whereever we execute a query.
     job_config = bigquery.QueryJobConfig()
     job_config.labels["bigframes-api"] = api_name
     snapshot_timestamp = list(
         bqclient.query(
             "SELECT CURRENT_TIMESTAMP() AS `current_timestamp`",
             job_config=job_config,
         ).result()
```

### Comparing `bigframes-1.5.0/bigframes/session/_io/pandas.py` & `bigframes-1.6.0/bigframes/session/_io/pandas.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/session/clients.py` & `bigframes-1.6.0/bigframes/session/clients.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/bigframes/version.py` & `bigframes-1.6.0/bigframes/version.py`

 * *Files 1% similar despite different names*

```diff
@@ -8,8 +8,8 @@
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-__version__ = "1.5.0"
+__version__ = "1.6.0"
```

### Comparing `bigframes-1.5.0/bigframes.egg-info/PKG-INFO` & `bigframes-1.6.0/bigframes.egg-info/PKG-INFO`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: bigframes
-Version: 1.5.0
+Version: 1.6.0
 Summary: BigQuery DataFrames -- scalable analytics and machine learning with BigQuery
 Home-page: https://github.com/googleapis/python-bigquery-dataframes
 Author: Google LLC
 Author-email: bigframes-feedback@google.com
 License: Apache 2.0
 Platform: Posix; MacOS X; Windows
 Classifier: Development Status :: 5 - Production/Stable
@@ -28,14 +28,15 @@
 Requires-Dist: google-cloud-bigquery[bqstorage,pandas]>=3.16.0
 Requires-Dist: google-cloud-functions>=1.12.0
 Requires-Dist: google-cloud-bigquery-connection>=1.12.0
 Requires-Dist: google-cloud-iam>=2.12.1
 Requires-Dist: google-cloud-resource-manager>=1.10.3
 Requires-Dist: google-cloud-storage>=2.0.0
 Requires-Dist: ibis-framework[bigquery]<9.0.0dev,>=8.0.0
+Requires-Dist: jellyfish>=0.8.9
 Requires-Dist: pandas>=1.5.0
 Requires-Dist: pyarrow>=8.0.0
 Requires-Dist: pydata-google-auth>=1.8.2
 Requires-Dist: requests>=2.27.1
 Requires-Dist: scikit-learn>=1.2.2
 Requires-Dist: sqlalchemy<3.0dev,>=1.4
 Requires-Dist: sqlglot<=20.11,>=20.8.0
```

### Comparing `bigframes-1.5.0/bigframes.egg-info/SOURCES.txt` & `bigframes-1.6.0/bigframes.egg-info/SOURCES.txt`

 * *Files 0% similar despite different names*

```diff
@@ -42,14 +42,15 @@
 bigframes/core/local_data.py
 bigframes/core/log_adapter.py
 bigframes/core/nodes.py
 bigframes/core/ordering.py
 bigframes/core/rewrite.py
 bigframes/core/scalar.py
 bigframes/core/schema.py
+bigframes/core/sql.py
 bigframes/core/tree_properties.py
 bigframes/core/utils.py
 bigframes/core/window_spec.py
 bigframes/core/compile/__init__.py
 bigframes/core/compile/aggregate_compiler.py
 bigframes/core/compile/compiled.py
 bigframes/core/compile/compiler.py
```

### Comparing `bigframes-1.5.0/bigframes.egg-info/requires.txt` & `bigframes-1.6.0/bigframes.egg-info/requires.txt`

 * *Files 17% similar despite different names*

```diff
@@ -6,14 +6,15 @@
 google-cloud-bigquery[bqstorage,pandas]>=3.16.0
 google-cloud-functions>=1.12.0
 google-cloud-bigquery-connection>=1.12.0
 google-cloud-iam>=2.12.1
 google-cloud-resource-manager>=1.10.3
 google-cloud-storage>=2.0.0
 ibis-framework[bigquery]<9.0.0dev,>=8.0.0
+jellyfish>=0.8.9
 pandas>=1.5.0
 pyarrow>=8.0.0
 pydata-google-auth>=1.8.2
 requests>=2.27.1
 scikit-learn>=1.2.2
 sqlalchemy<3.0dev,>=1.4
 sqlglot<=20.11,>=20.8.0
```

### Comparing `bigframes-1.5.0/setup.py` & `bigframes-1.6.0/setup.py`

 * *Files 2% similar despite different names*

```diff
@@ -8,14 +8,15 @@
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
+
 import io
 import itertools
 import os
 from typing import Dict
 
 import setuptools
 
@@ -41,14 +42,15 @@
     "google-cloud-bigquery[bqstorage,pandas] >=3.16.0",
     "google-cloud-functions >=1.12.0",
     "google-cloud-bigquery-connection >=1.12.0",
     "google-cloud-iam >=2.12.1",
     "google-cloud-resource-manager >=1.10.3",
     "google-cloud-storage >=2.0.0",
     "ibis-framework[bigquery] >=8.0.0,<9.0.0dev",
+    "jellyfish >=0.8.9",
     # TODO: Relax upper bound once we have fixed `system_prerelease` tests.
     "pandas >=1.5.0",
     "pyarrow >=8.0.0",
     "pydata-google-auth >=1.8.2",
     "requests >=2.27.1",
     "scikit-learn >=1.2.2",
     "sqlalchemy >=1.4,<3.0dev",
```

### Comparing `bigframes-1.5.0/tests/__init__.py` & `bigframes-1.6.0/tests/__init__.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/data/hockey_players.json` & `bigframes-1.6.0/tests/data/hockey_players.json`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/data/hockey_players.jsonl` & `bigframes-1.6.0/tests/data/hockey_players.jsonl`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/data/nested.jsonl` & `bigframes-1.6.0/tests/data/nested.jsonl`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/data/nested_schema.json` & `bigframes-1.6.0/tests/data/nested_schema.json`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/data/penguins.jsonl` & `bigframes-1.6.0/tests/data/penguins.jsonl`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/data/penguins_schema.json` & `bigframes-1.6.0/tests/data/penguins_schema.json`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/data/scalars.jsonl` & `bigframes-1.6.0/tests/data/scalars.jsonl`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/data/scalars_schema.json` & `bigframes-1.6.0/tests/data/scalars_schema.json`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/data/time_series.jsonl` & `bigframes-1.6.0/tests/data/time_series.jsonl`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/__init__.py` & `bigframes-1.6.0/tests/system/__init__.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/conftest.py` & `bigframes-1.6.0/tests/system/conftest.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/large/__init__.py` & `bigframes-1.6.0/tests/system/large/__init__.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/large/ml/test_cluster.py` & `bigframes-1.6.0/tests/system/large/ml/test_cluster.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/large/ml/test_compose.py` & `bigframes-1.6.0/tests/system/large/ml/test_compose.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/large/ml/test_core.py` & `bigframes-1.6.0/tests/system/large/ml/test_core.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/large/ml/test_decomposition.py` & `bigframes-1.6.0/tests/system/large/ml/test_decomposition.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/large/ml/test_ensemble.py` & `bigframes-1.6.0/tests/system/large/ml/test_ensemble.py`

 * *Files 2% similar despite different names*

```diff
@@ -119,15 +119,15 @@
         f"{dataset_id}.temp_configured_xgbregressor_model", replace=True
     )
     assert (
         f"{dataset_id}.temp_configured_xgbregressor_model"
         in reloaded_model._bqml_model.model_name
     )
     assert reloaded_model.booster == "DART"
-    assert reloaded_model.dart_normalized_type == "tree"
+    assert reloaded_model.dart_normalized_type == "TREE"
     assert reloaded_model.tree_method == "AUTO"
     assert reloaded_model.colsample_bytree == 0.95
     assert reloaded_model.colsample_bylevel == 0.95
     assert reloaded_model.colsample_bynode == 0.95
     assert reloaded_model.subsample == 0.95
     assert reloaded_model.reg_alpha == 0.0001
     assert reloaded_model.reg_lambda == 0.0001
@@ -232,15 +232,15 @@
         f"{dataset_id}.temp_configured_xgbclassifier_model", replace=True
     )
     assert (
         f"{dataset_id}.temp_configured_xgbclassifier_model"
         in reloaded_model._bqml_model.model_name
     )
     assert reloaded_model.booster == "DART"
-    assert reloaded_model.dart_normalized_type == "tree"
+    assert reloaded_model.dart_normalized_type == "TREE"
     assert reloaded_model.tree_method == "AUTO"
     assert reloaded_model.colsample_bytree == 0.95
     assert reloaded_model.colsample_bylevel == 0.95
     assert reloaded_model.colsample_bynode == 0.95
     assert reloaded_model.subsample == 0.95
     assert reloaded_model.reg_alpha == 0.0001
     assert reloaded_model.reg_lambda == 0.0001
```

### Comparing `bigframes-1.5.0/tests/system/large/ml/test_forecasting.py` & `bigframes-1.6.0/tests/system/large/ml/test_forecasting.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/large/ml/test_linear_model.py` & `bigframes-1.6.0/tests/system/large/ml/test_linear_model.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/large/ml/test_pipeline.py` & `bigframes-1.6.0/tests/system/large/ml/test_pipeline.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/large/test_location.py` & `bigframes-1.6.0/tests/system/large/test_location.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/large/test_remote_function.py` & `bigframes-1.6.0/tests/system/large/test_remote_function.py`

 * *Files 13% similar despite different names*

```diff
@@ -8,30 +8,32 @@
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
+from datetime import datetime
 import importlib.util
 import inspect
 import math  # must keep this at top level to test udf referring global import
 import os.path
 import shutil
 import tempfile
 import textwrap
 
-from google.api_core.exceptions import BadRequest, NotFound
+from google.api_core.exceptions import BadRequest, InvalidArgument, NotFound
 from google.cloud import bigquery, storage
 import pandas
 import pytest
 import test_utils.prefixer
 
 import bigframes
 from bigframes.functions.remote_function import get_cloud_function_name
+import bigframes.series
 from tests.system.utils import (
     assert_pandas_df_equal,
     delete_cloud_function,
     get_cloud_functions,
 )
 
 # NOTE: Keep this import at the top level to test global var behavior with
@@ -215,14 +217,49 @@
     finally:
         # clean up the gcp assets created for the remote function
         cleanup_remote_function_assets(
             bigquery_client, session.cloudfunctionsclient, stringify
         )
 
 
+# @pytest.mark.flaky(retries=2, delay=120)
+def test_remote_function_binop(session, scalars_dfs, dataset_id, bq_cf_connection):
+    try:
+
+        def func(x, y):
+            return x * abs(y % 4)
+
+        remote_func = session.remote_function(
+            [str, int],
+            str,
+            dataset_id,
+            bq_cf_connection,
+            reuse=False,
+        )(func)
+
+        scalars_df, scalars_pandas_df = scalars_dfs
+
+        scalars_df = scalars_df.dropna()
+        scalars_pandas_df = scalars_pandas_df.dropna()
+        bf_result = (
+            scalars_df["string_col"]
+            .combine(scalars_df["int64_col"], remote_func)
+            .to_pandas()
+        )
+        pd_result = scalars_pandas_df["string_col"].combine(
+            scalars_pandas_df["int64_col"], func
+        )
+        pandas.testing.assert_series_equal(bf_result, pd_result)
+    finally:
+        # clean up the gcp assets created for the remote function
+        cleanup_remote_function_assets(
+            session.bqclient, session.cloudfunctionsclient, remote_func
+        )
+
+
 @pytest.mark.flaky(retries=2, delay=120)
 def test_remote_function_decorator_with_bigframes_series(
     session, scalars_dfs, dataset_id, bq_cf_connection
 ):
     try:
 
         @session.remote_function(
@@ -1327,14 +1364,87 @@
     finally:
         # clean up the gcp assets created for the remote function
         cleanup_remote_function_assets(
             session.bqclient, session.cloudfunctionsclient, square_num
         )
 
 
+@pytest.mark.flaky(retries=2, delay=120)
+def test_remote_function_via_session_vpc(scalars_dfs):
+    # TODO(shobs): Automate the following set-up during testing in the test project.
+    #
+    # For upfront convenience, the following set up has been statically created
+    # in the project bigfrmames-dev-perf via cloud console:
+    #
+    # 1. Create a vpc connector as per
+    #    https://cloud.google.com/vpc/docs/configure-serverless-vpc-access#gcloud
+    #
+    #    $ gcloud compute networks vpc-access connectors create bigframes-vpc --project=bigframes-dev-perf --region=us-central1 --range 10.8.0.0/28
+    #    Create request issued for: [bigframes-vpc]
+    #    Waiting for operation [projects/bigframes-dev-perf/locations/us-central1/operations/f9f90df6-7cf4-4420-8c2f-b3952775dcfb] to complete...done.
+    #    Created connector [bigframes-vpc].
+    #
+    #    $ gcloud compute networks vpc-access connectors list --project=bigframes-dev-perf --region=us-central1
+    #    CONNECTOR_ID   REGION       NETWORK  IP_CIDR_RANGE  SUBNET  SUBNET_PROJECT  MACHINE_TYPE  MIN_INSTANCES  MAX_INSTANCES  MIN_THROUGHPUT  MAX_THROUGHPUT  STATE
+    #    bigframes-vpc  us-central1  default  10.8.0.0/28                            e2-micro      2              10             200             1000            READY
+
+    project = "bigframes-dev-perf"
+    gcf_vpc_connector = "bigframes-vpc"
+
+    rf_session = bigframes.Session(context=bigframes.BigQueryOptions(project=project))
+
+    try:
+
+        def square_num(x):
+            if x is None:
+                return x
+            return x * x
+
+        square_num_remote = rf_session.remote_function(
+            [int], int, reuse=False, cloud_function_vpc_connector=gcf_vpc_connector
+        )(square_num)
+
+        scalars_df, scalars_pandas_df = scalars_dfs
+
+        bf_int64_col = scalars_df["int64_col"]
+        bf_result_col = bf_int64_col.apply(square_num_remote)
+        bf_result = bf_int64_col.to_frame().assign(result=bf_result_col).to_pandas()
+
+        pd_int64_col = scalars_pandas_df["int64_col"]
+        pd_result_col = pd_int64_col.apply(square_num)
+        pd_result = pd_int64_col.to_frame().assign(result=pd_result_col)
+
+        assert_pandas_df_equal(bf_result, pd_result, check_dtype=False)
+
+        # Assert that the GCF is created with the intended vpc connector
+        gcf = rf_session.cloudfunctionsclient.get_function(
+            name=square_num_remote.bigframes_cloud_function
+        )
+        assert gcf.service_config.vpc_connector == gcf_vpc_connector
+    finally:
+        # clean up the gcp assets created for the remote function
+        cleanup_remote_function_assets(
+            rf_session.bqclient, rf_session.cloudfunctionsclient, square_num_remote
+        )
+
+
+def test_remote_function_via_session_vpc_invalid(session):
+    with pytest.raises(
+        InvalidArgument, match="400.*Serverless VPC Access connector is not found"
+    ):
+
+        @session.remote_function(
+            [int], int, reuse=False, cloud_function_vpc_connector="does-not-exist"
+        )
+        def square_num(x):
+            if x is None:
+                return x
+            return x * x
+
+
 @pytest.mark.parametrize(
     ("max_batching_rows"),
     [
         10_000,
         None,
     ],
 )
@@ -1450,7 +1560,255 @@
 
         pandas.testing.assert_series_equal(bf_result, pd_result, check_dtype=False)
     finally:
         # clean up the gcp assets created for the remote function
         cleanup_remote_function_assets(
             session.bqclient, session.cloudfunctionsclient, square_remote
         )
+
+
+@pytest.mark.flaky(retries=2, delay=120)
+def test_df_apply_axis_1(session, scalars_dfs):
+    columns = ["bool_col", "int64_col", "int64_too", "float64_col", "string_col"]
+    scalars_df, scalars_pandas_df = scalars_dfs
+    try:
+
+        def serialize_row(row):
+            custom = {
+                "name": row.name,
+                "index": [idx for idx in row.index],
+                "values": [
+                    val.item() if hasattr(val, "item") else val for val in row.values
+                ],
+            }
+
+            return str(
+                {
+                    "default": row.to_json(),
+                    "split": row.to_json(orient="split"),
+                    "records": row.to_json(orient="records"),
+                    "index": row.to_json(orient="index"),
+                    "table": row.to_json(orient="table"),
+                    "custom": custom,
+                }
+            )
+
+        serialize_row_remote = session.remote_function(
+            bigframes.series.Series, str, reuse=False
+        )(serialize_row)
+
+        bf_result = scalars_df[columns].apply(serialize_row_remote, axis=1).to_pandas()
+        pd_result = scalars_pandas_df[columns].apply(serialize_row, axis=1)
+
+        # bf_result.dtype is 'string[pyarrow]' while pd_result.dtype is 'object'
+        # , ignore this mismatch by using check_dtype=False.
+        pandas.testing.assert_series_equal(pd_result, bf_result, check_dtype=False)
+    finally:
+        # clean up the gcp assets created for the remote function
+        cleanup_remote_function_assets(
+            session.bqclient, session.cloudfunctionsclient, serialize_row_remote
+        )
+
+
+@pytest.mark.flaky(retries=2, delay=120)
+def test_df_apply_axis_1_aggregates(session, scalars_dfs):
+    columns = ["int64_col", "int64_too", "float64_col"]
+    scalars_df, scalars_pandas_df = scalars_dfs
+
+    try:
+
+        def analyze(row):
+            return str(
+                {
+                    "dtype": row.dtype,
+                    "count": row.count(),
+                    "min": row.max(),
+                    "max": row.max(),
+                    "mean": row.mean(),
+                    "std": row.std(),
+                    "var": row.var(),
+                }
+            )
+
+        analyze_remote = session.remote_function(bigframes.series.Series, str)(analyze)
+
+        bf_result = (
+            scalars_df[columns].dropna().apply(analyze_remote, axis=1).to_pandas()
+        )
+        pd_result = scalars_pandas_df[columns].dropna().apply(analyze, axis=1)
+
+        # bf_result.dtype is 'string[pyarrow]' while pd_result.dtype is 'object'
+        # , ignore this mismatch by using check_dtype=False.
+        pandas.testing.assert_series_equal(pd_result, bf_result, check_dtype=False)
+    finally:
+        # clean up the gcp assets created for the remote function
+        cleanup_remote_function_assets(
+            session.bqclient, session.cloudfunctionsclient, analyze_remote
+        )
+
+
+@pytest.mark.parametrize(
+    ("pd_df"),
+    [
+        pytest.param(
+            pandas.DataFrame(
+                {
+                    "2": [1, 2, 3],
+                    2: [1.5, 3.75, 5],
+                    "name, [with. special'- chars\")/\\": [10, 20, 30],
+                    (3, 4): ["pq", "rs", "tu"],
+                    (5.0, "six", 7): [8, 9, 10],
+                    'raise Exception("hacked!")': [11, 12, 13],
+                }
+            ),
+            id="all-kinds-of-column-names",
+        ),
+        pytest.param(
+            pandas.DataFrame(
+                {
+                    "x": [1, 2, 3],
+                    "y": [1.5, 3.75, 5],
+                    "z": ["pq", "rs", "tu"],
+                },
+                index=pandas.MultiIndex.from_tuples(
+                    [
+                        ("a", 100),
+                        ("a", 200),
+                        ("b", 300),
+                    ]
+                ),
+            ),
+            id="multiindex",
+        ),
+        pytest.param(
+            pandas.DataFrame(
+                [
+                    [10, 1.5, "pq"],
+                    [20, 3.75, "rs"],
+                    [30, 8.0, "tu"],
+                ],
+                columns=pandas.MultiIndex.from_arrays(
+                    [
+                        ["first", "last_two", "last_two"],
+                        [1, 2, 3],
+                    ]
+                ),
+            ),
+            id="column-multiindex",
+        ),
+        pytest.param(
+            pandas.DataFrame(
+                {
+                    datetime.now(): [1, 2, 3],
+                }
+            ),
+            id="column-name-not-supported",
+            marks=pytest.mark.xfail(raises=NameError),
+        ),
+    ],
+)
+@pytest.mark.flaky(retries=2, delay=120)
+def test_df_apply_axis_1_complex(session, pd_df):
+    bf_df = session.read_pandas(pd_df)
+
+    try:
+
+        def serialize_row(row):
+            custom = {
+                "name": row.name,
+                "index": [idx for idx in row.index],
+                "values": [
+                    val.item() if hasattr(val, "item") else val for val in row.values
+                ],
+            }
+            return str(
+                {
+                    "default": row.to_json(),
+                    "split": row.to_json(orient="split"),
+                    "records": row.to_json(orient="records"),
+                    "index": row.to_json(orient="index"),
+                    "custom": custom,
+                }
+            )
+
+        serialize_row_remote = session.remote_function(
+            bigframes.series.Series, str, reuse=False
+        )(serialize_row)
+
+        bf_result = bf_df.apply(serialize_row_remote, axis=1).to_pandas()
+        pd_result = pd_df.apply(serialize_row, axis=1)
+
+        # bf_result.dtype is 'string[pyarrow]' while pd_result.dtype is 'object'
+        # , ignore this mismatch by using check_dtype=False.
+        #
+        # bf_result.index[0].dtype is 'string[pyarrow]' while
+        # pd_result.index[0].dtype is 'object', ignore this mismatch by using
+        # check_index_type=False.
+        pandas.testing.assert_series_equal(
+            pd_result, bf_result, check_dtype=False, check_index_type=False
+        )
+    finally:
+        # clean up the gcp assets created for the remote function
+        cleanup_remote_function_assets(
+            session.bqclient, session.cloudfunctionsclient, serialize_row_remote
+        )
+
+
+@pytest.mark.flaky(retries=2, delay=120)
+def test_df_apply_axis_1_na_nan_inf(session):
+    """This test is for special cases of float values, to make sure any (nan,
+    inf, -inf) produced by user code is honored.
+    """
+    bf_df = session.read_gbq(
+        """\
+SELECT "1" AS text, 1 AS num
+UNION ALL
+SELECT "2.5" AS text, 2.5 AS num
+UNION ALL
+SELECT "nan" AS text, IEEE_DIVIDE(0, 0) AS num
+UNION ALL
+SELECT "inf" AS text, IEEE_DIVIDE(1, 0) AS num
+UNION ALL
+SELECT "-inf" AS text, IEEE_DIVIDE(-1, 0) AS num
+UNION ALL
+SELECT "numpy nan" AS text, IEEE_DIVIDE(0, 0) AS num
+UNION ALL
+SELECT "pandas na" AS text, NULL AS num
+                             """
+    )
+
+    pd_df = bf_df.to_pandas()
+
+    try:
+
+        def float_parser(row):
+            import numpy as mynp
+            import pandas as mypd
+
+            if row["text"] == "pandas na":
+                return mypd.NA
+            if row["text"] == "numpy nan":
+                return mynp.nan
+            return float(row["text"])
+
+        float_parser_remote = session.remote_function(
+            bigframes.series.Series, float, reuse=False
+        )(float_parser)
+
+        pd_result = pd_df.apply(float_parser, axis=1)
+        bf_result = bf_df.apply(float_parser_remote, axis=1).to_pandas()
+
+        # bf_result.dtype is 'Float64' while pd_result.dtype is 'object'
+        # , ignore this mismatch by using check_dtype=False.
+        pandas.testing.assert_series_equal(pd_result, bf_result, check_dtype=False)
+
+        # Let's also assert that the data is consistent in this round trip
+        # (BQ -> BigFrames -> BQ -> GCF -> BQ -> BigFrames) w.r.t. their
+        # expected values in BQ
+        bq_result = bf_df["num"].to_pandas()
+        bq_result.name = None
+        pandas.testing.assert_series_equal(bq_result, bf_result)
+    finally:
+        # clean up the gcp assets created for the remote function
+        cleanup_remote_function_assets(
+            session.bqclient, session.cloudfunctionsclient, float_parser_remote
+        )
```

### Comparing `bigframes-1.5.0/tests/system/large/test_session.py` & `bigframes-1.6.0/tests/system/large/test_session.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/load/test_large_tables.py` & `bigframes-1.6.0/tests/system/load/test_large_tables.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/load/test_llm.py` & `bigframes-1.6.0/tests/system/load/test_llm.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/small/__init__.py` & `bigframes-1.6.0/tests/system/small/__init__.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/small/bigquery/__init__.py` & `bigframes-1.6.0/tests/system/small/bigquery/__init__.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/small/bigquery/test_array.py` & `bigframes-1.6.0/tests/system/small/bigquery/test_array.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/small/ml/__init__.py` & `bigframes-1.6.0/tests/system/small/ml/__init__.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/small/ml/conftest.py` & `bigframes-1.6.0/tests/system/small/ml/conftest.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/small/ml/test_cluster.py` & `bigframes-1.6.0/tests/system/small/ml/test_cluster.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/small/ml/test_core.py` & `bigframes-1.6.0/tests/system/small/ml/test_core.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/small/ml/test_decomposition.py` & `bigframes-1.6.0/tests/system/small/ml/test_decomposition.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/small/ml/test_ensemble.py` & `bigframes-1.6.0/tests/system/small/ml/test_ensemble.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/small/ml/test_forecasting.py` & `bigframes-1.6.0/tests/system/small/ml/test_forecasting.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/small/ml/test_imported.py` & `bigframes-1.6.0/tests/system/small/ml/test_imported.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/small/ml/test_linear_model.py` & `bigframes-1.6.0/tests/system/small/ml/test_linear_model.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/small/ml/test_llm.py` & `bigframes-1.6.0/tests/system/small/ml/test_llm.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/small/ml/test_metrics.py` & `bigframes-1.6.0/tests/system/small/ml/test_metrics.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/small/ml/test_metrics_pairwise.py` & `bigframes-1.6.0/tests/system/small/ml/test_metrics_pairwise.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/small/ml/test_model_selection.py` & `bigframes-1.6.0/tests/system/small/ml/test_model_selection.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/small/ml/test_preprocessing.py` & `bigframes-1.6.0/tests/system/small/ml/test_preprocessing.py`

 * *Files 2% similar despite different names*

```diff
@@ -369,14 +369,35 @@
         dtype="string[pyarrow]",
         index=pd.Index([1633, 1672, 1690], name="tag_number", dtype="Int64"),
     )
 
     pd.testing.assert_frame_equal(result, expected, rtol=0.1)
 
 
+def test_k_bins_discretizer_normalized_fit_transform_default_params_quantile(
+    new_penguins_df,
+):
+    discretizer = preprocessing.KBinsDiscretizer(strategy="quantile")
+    result = discretizer.fit_transform(
+        new_penguins_df[["culmen_length_mm", "culmen_depth_mm", "flipper_length_mm"]]
+    ).to_pandas()
+
+    expected = pd.DataFrame(
+        {
+            "kbinsdiscretizer_culmen_length_mm": ["bin_2", "bin_2", "bin_1"],
+            "kbinsdiscretizer_culmen_depth_mm": ["bin_2", "bin_1", "bin_2"],
+            "kbinsdiscretizer_flipper_length_mm": ["bin_2", "bin_1", "bin_2"],
+        },
+        dtype="string[pyarrow]",
+        index=pd.Index([1633, 1672, 1690], name="tag_number", dtype="Int64"),
+    )
+
+    pd.testing.assert_frame_equal(result, expected, rtol=0.1)
+
+
 def test_k_bins_discretizer_series_normalizes(
     penguins_df_default_index, new_penguins_df
 ):
     discretizer = preprocessing.KBinsDiscretizer(strategy="uniform")
     discretizer.fit(penguins_df_default_index["culmen_length_mm"])
 
     result = discretizer.transform(
@@ -391,14 +412,36 @@
         dtype="string[pyarrow]",
         index=pd.Index([1633, 1672, 1690], name="tag_number", dtype="Int64"),
     )
 
     pd.testing.assert_frame_equal(result, expected, rtol=0.1)
 
 
+def test_k_bins_discretizer_series_normalizes_quantile(
+    penguins_df_default_index, new_penguins_df
+):
+    discretizer = preprocessing.KBinsDiscretizer(strategy="quantile")
+    discretizer.fit(penguins_df_default_index["culmen_length_mm"])
+
+    result = discretizer.transform(
+        penguins_df_default_index["culmen_length_mm"]
+    ).to_pandas()
+    result = discretizer.transform(new_penguins_df).to_pandas()
+
+    expected = pd.DataFrame(
+        {
+            "kbinsdiscretizer_culmen_length_mm": ["bin_2", "bin_2", "bin_1"],
+        },
+        dtype="string[pyarrow]",
+        index=pd.Index([1633, 1672, 1690], name="tag_number", dtype="Int64"),
+    )
+
+    pd.testing.assert_frame_equal(result, expected, rtol=0.1)
+
+
 def test_k_bins_discretizer_normalizes(penguins_df_default_index, new_penguins_df):
     # TODO(http://b/292431644): add a second test that compares output to sklearn.preprocessing.KBinsDiscretizer, when BQML's change is in prod.
     discretizer = preprocessing.KBinsDiscretizer(strategy="uniform")
     discretizer.fit(
         penguins_df_default_index[
             ["culmen_length_mm", "culmen_depth_mm", "flipper_length_mm"]
         ]
@@ -484,14 +527,29 @@
         dtype="string[pyarrow]",
         index=pd.Index([1633, 1672, 1690], name="tag_number", dtype="Int64"),
     )
 
     pd.testing.assert_frame_equal(result, expected, rtol=0.1)
 
 
+def test_k_bins_discretizer_save_load_quantile(new_penguins_df, dataset_id):
+    transformer = preprocessing.KBinsDiscretizer(n_bins=6, strategy="quantile")
+    transformer.fit(
+        new_penguins_df[["culmen_length_mm", "culmen_depth_mm", "flipper_length_mm"]]
+    )
+
+    reloaded_transformer = transformer.to_gbq(
+        f"{dataset_id}.temp_configured_model", replace=True
+    )
+    assert isinstance(reloaded_transformer, preprocessing.KBinsDiscretizer)
+    assert reloaded_transformer.n_bins == transformer.n_bins
+    assert reloaded_transformer.strategy == transformer.strategy
+    assert reloaded_transformer._bqml_model is not None
+
+
 def test_one_hot_encoder_default_params(new_penguins_df):
     encoder = preprocessing.OneHotEncoder()
     encoder.fit(new_penguins_df[["species", "sex"]])
 
     result = encoder.transform(new_penguins_df).to_pandas()
 
     expected = pd.DataFrame(
```

### Comparing `bigframes-1.5.0/tests/system/small/ml/test_register.py` & `bigframes-1.6.0/tests/system/small/ml/test_register.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/small/ml/test_remote.py` & `bigframes-1.6.0/tests/system/small/ml/test_remote.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/small/operations/__init__.py` & `bigframes-1.6.0/tests/system/small/operations/__init__.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/small/operations/test_datetimes.py` & `bigframes-1.6.0/tests/system/small/operations/test_datetimes.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/small/operations/test_plotting.py` & `bigframes-1.6.0/tests/system/small/operations/test_plotting.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/small/operations/test_strings.py` & `bigframes-1.6.0/tests/system/small/operations/test_strings.py`

 * *Files 8% similar despite different names*

```diff
@@ -527,7 +527,38 @@
     bf_result = bf_series.str.rjust(9, fillchar="%").to_pandas()
     pd_result = scalars_pandas_df[col_name].str.rjust(9, fillchar="%")
 
     assert_series_equal(
         pd_result,
         bf_result,
     )
+
+
+@pytest.mark.parametrize(
+    ("pat", "regex"),
+    [
+        pytest.param(" ", None, id="one_char"),
+        pytest.param("ll", False, id="two_chars"),
+        pytest.param(
+            " ",
+            True,
+            id="one_char_reg",
+            marks=pytest.mark.xfail(raises=NotImplementedError),
+        ),
+        pytest.param(
+            "ll",
+            None,
+            id="two_chars_reg",
+            marks=pytest.mark.xfail(raises=NotImplementedError),
+        ),
+    ],
+)
+def test_str_split_raise_errors(scalars_dfs, pat, regex):
+    scalars_df, scalars_pandas_df = scalars_dfs
+    col_name = "string_col"
+    bf_result = scalars_df[col_name].str.split(pat=pat, regex=regex).to_pandas()
+    pd_result = scalars_pandas_df[col_name].str.split(pat=pat, regex=regex)
+
+    # TODO(b/336880368): Allow for NULL values for ARRAY columns in BigQuery.
+    pd_result = pd_result.apply(lambda x: [] if pd.isnull(x) is True else x)
+
+    assert_series_equal(pd_result, bf_result, check_dtype=False)
```

### Comparing `bigframes-1.5.0/tests/system/small/regression/test_issue355_merge_after_filter.py` & `bigframes-1.6.0/tests/system/small/regression/test_issue355_merge_after_filter.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/small/test_dataframe.py` & `bigframes-1.6.0/tests/system/small/test_dataframe.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/small/test_dataframe_io.py` & `bigframes-1.6.0/tests/system/small/test_dataframe_io.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/small/test_encryption.py` & `bigframes-1.6.0/tests/system/small/test_encryption.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/small/test_groupby.py` & `bigframes-1.6.0/tests/system/small/test_groupby.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/small/test_ibis.py` & `bigframes-1.6.0/tests/system/small/test_ibis.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/small/test_index.py` & `bigframes-1.6.0/tests/system/small/test_index.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/small/test_ipython.py` & `bigframes-1.6.0/tests/system/small/test_ipython.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/small/test_multiindex.py` & `bigframes-1.6.0/tests/system/small/test_multiindex.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/small/test_numpy.py` & `bigframes-1.6.0/tests/system/small/test_numpy.py`

 * *Files 8% similar despite different names*

```diff
@@ -77,63 +77,54 @@
     ("opname",),
     [
         ("add",),
         ("subtract",),
         ("multiply",),
         ("divide",),
         ("power",),
-        ("arctan2",),
-    ],
-)
-def test_series_binary_ufuncs(floats_product_pd, floats_product_bf, opname):
-    bf_result = getattr(np, opname)(
-        floats_product_bf.float64_col_x, floats_product_bf.float64_col_y
-    ).to_pandas()
-    pd_result = getattr(np, opname)(
-        floats_product_pd.float64_col_x, floats_product_pd.float64_col_y
-    )
-    pd.testing.assert_series_equal(bf_result, pd_result)
-
-
-@pytest.mark.parametrize(
-    ("opname",),
-    [
-        ("add",),
-        ("subtract",),
-        ("multiply",),
-        ("divide",),
-        ("power",),
     ],
 )
 def test_df_binary_ufuncs(scalars_dfs, opname):
     scalars_df, scalars_pandas_df = scalars_dfs
+    op = getattr(np, opname)
 
-    bf_result = getattr(np, opname)(
-        scalars_df[["float64_col", "int64_col"]], 5.1
-    ).to_pandas()
-    pd_result = getattr(np, opname)(
-        scalars_pandas_df[["float64_col", "int64_col"]], 5.1
-    )
+    bf_result = op(scalars_df[["float64_col", "int64_col"]], 5.1).to_pandas()
+    pd_result = op(scalars_pandas_df[["float64_col", "int64_col"]], 5.1)
 
     pd.testing.assert_frame_equal(bf_result, pd_result)
 
 
+# Operations tested here don't work on full dataframe in numpy+pandas
+# Maybe because of nullable dtypes?
 @pytest.mark.parametrize(
     ("x", "y"),
     [
         ("int64_col", "int64_col"),
         ("float64_col", "int64_col"),
     ],
 )
-def test_series_atan2(scalars_dfs, x, y):
-    # Test atan2 separately as pandas errors when passing entire df as input, so pass only series
+@pytest.mark.parametrize(
+    ("opname",),
+    [
+        ("add",),
+        ("subtract",),
+        ("multiply",),
+        ("divide",),
+        ("arctan2",),
+        ("minimum",),
+        ("maximum",),
+    ],
+)
+def test_series_binary_ufuncs(scalars_dfs, x, y, opname):
     scalars_df, scalars_pandas_df = scalars_dfs
 
-    bf_result = np.arctan2(scalars_df[x], scalars_df[y]).to_pandas()
-    pd_result = np.arctan2(scalars_pandas_df[x], scalars_pandas_df[y])
+    op = getattr(np, opname)
+
+    bf_result = op(scalars_df[x], scalars_df[y]).to_pandas()
+    pd_result = op(scalars_pandas_df[x], scalars_pandas_df[y])
 
     pd.testing.assert_series_equal(bf_result, pd_result)
 
 
 def test_series_binary_ufuncs_reverse(scalars_dfs):
     scalars_df, scalars_pandas_df = scalars_dfs
```

### Comparing `bigframes-1.5.0/tests/system/small/test_pandas.py` & `bigframes-1.6.0/tests/system/small/test_pandas.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/small/test_pandas_options.py` & `bigframes-1.6.0/tests/system/small/test_pandas_options.py`

 * *Files 3% similar despite different names*

```diff
@@ -9,14 +9,15 @@
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import datetime
+import re
 from unittest import mock
 import warnings
 
 import google.api_core.exceptions
 import google.auth
 import google.auth.exceptions
 import pytest
@@ -65,16 +66,20 @@
         query_tokyo = f"{query_prefix} {query_tokyo}"
         query = f"{query_prefix} {query}"
 
     # Initially there is no location set in the bigquery options
     assert not bpd.options.bigquery.location
 
     # Starting user journey with read_gbq* should work for a table in any
-    # location, in this case tokyo
-    df = read_method(query_tokyo)
+    # location, in this case tokyo.
+    with warnings.catch_warnings():
+        # Since the query refers to a specific location, no warning should be
+        # raised.
+        warnings.simplefilter("error", bigframes.exceptions.DefaultLocationWarning)
+        df = read_method(query_tokyo)
     assert df is not None
 
     # Now bigquery options location should be set to tokyo
     assert bpd.options.bigquery.location == tokyo_location
 
     # Now read_gbq* from another location should fail
     with pytest.raises(
@@ -142,15 +147,19 @@
         query = f"{query_prefix} {query}"
 
     # Initially there is no location set in the bigquery options
     assert not bpd.options.bigquery.location
 
     # Starting user journey with anything other than read_gbq*, such as
     # read_pandas would bind the session to default location US
-    df = bpd.read_pandas(scalars_pandas_df_index)
+    with pytest.warns(
+        bigframes.exceptions.DefaultLocationWarning,
+        match=re.escape("using location US for the session"),
+    ):
+        df = bpd.read_pandas(scalars_pandas_df_index)
     assert df is not None
 
     # Doing read_gbq* from a table in another location should fail
     with pytest.raises(
         (google.api_core.exceptions.NotFound, ValueError),
         match=dataset_id_permanent_tokyo,
     ):
@@ -258,25 +267,26 @@
     # location, in this case tokyo
     df = read_method(query_tokyo)
     assert df is not None
 
 
 def test_credentials_need_reauthentication(monkeypatch):
     # Use a simple test query to verify that default session works to interact
-    # with BQ
+    # with BQ.
     test_query = "SELECT 1"
 
-    # Confirm that default session has BQ client with valid credentials
-    session = bpd.get_global_session()
-    assert session.bqclient._credentials.valid
-
     # Confirm that default session works as usual
     df = bpd.read_gbq(test_query)
     assert df is not None
 
+    # Call get_global_session() *after* read_gbq so that our location detection
+    # has a chance to work.
+    session = bpd.get_global_session()
+    assert session.bqclient._credentials.valid
+
     with monkeypatch.context() as m:
         # Simulate expired credentials to trigger the credential refresh flow
         m.setattr(session.bqclient._credentials, "expiry", datetime.datetime.utcnow())
         assert not session.bqclient._credentials.valid
 
         # Simulate an exception during the credential refresh flow
         m.setattr(
```

### Comparing `bigframes-1.5.0/tests/system/small/test_progress_bar.py` & `bigframes-1.6.0/tests/system/small/test_progress_bar.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/small/test_remote_function.py` & `bigframes-1.6.0/tests/system/small/test_remote_function.py`

 * *Files 10% similar despite different names*

```diff
@@ -8,20 +8,23 @@
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
+import re
+
 import google.api_core.exceptions
 from google.cloud import bigquery
 import pandas as pd
 import pytest
 
 import bigframes
+import bigframes.exceptions
 from bigframes.functions import remote_function as rf
 from tests.system.utils import assert_pandas_df_equal
 
 
 @pytest.fixture(scope="module")
 def bq_cf_connection() -> str:
     """Pre-created BQ connection in the test project in US location, used to
@@ -681,7 +684,150 @@
         rf.read_gbq_function(
             str(only_arg_type_specified.reference), bigquery_client=bigquery_client
         )
     with pytest.raises(ValueError):
         rf.read_gbq_function(
             str(neither_type_specified.reference), bigquery_client=bigquery_client
         )
+
+
+@pytest.mark.flaky(retries=2, delay=120)
+def test_df_apply_axis_1(session, scalars_dfs):
+    columns = ["bool_col", "int64_col", "int64_too", "float64_col", "string_col"]
+    scalars_df, scalars_pandas_df = scalars_dfs
+
+    def add_ints(row):
+        return row["int64_col"] + row["int64_too"]
+
+    with pytest.warns(
+        bigframes.exceptions.PreviewWarning,
+        match="input_types=Series scenario is in preview.",
+    ):
+        add_ints_remote = session.remote_function(bigframes.series.Series, int)(
+            add_ints
+        )
+
+    with pytest.warns(
+        bigframes.exceptions.PreviewWarning, match="axis=1 scenario is in preview."
+    ):
+        bf_result = scalars_df[columns].apply(add_ints_remote, axis=1).to_pandas()
+
+    pd_result = scalars_pandas_df[columns].apply(add_ints, axis=1)
+
+    # bf_result.dtype is 'Int64' while pd_result.dtype is 'object', ignore this
+    # mismatch by using check_dtype=False.
+    #
+    # bf_result.to_numpy() produces an array of numpy.float64's
+    # (in system_prerelease tests), while pd_result.to_numpy() produces an
+    # array of ints, ignore this mismatch by using check_exact=False.
+    pd.testing.assert_series_equal(
+        pd_result, bf_result, check_dtype=False, check_exact=False
+    )
+
+
+@pytest.mark.flaky(retries=2, delay=120)
+def test_df_apply_axis_1_ordering(session, scalars_dfs):
+    columns = ["bool_col", "int64_col", "int64_too", "float64_col", "string_col"]
+    ordering_columns = ["bool_col", "int64_col"]
+    scalars_df, scalars_pandas_df = scalars_dfs
+
+    def add_ints(row):
+        return row["int64_col"] + row["int64_too"]
+
+    add_ints_remote = session.remote_function(bigframes.series.Series, int)(add_ints)
+
+    bf_result = (
+        scalars_df[columns]
+        .sort_values(ordering_columns)
+        .apply(add_ints_remote, axis=1)
+        .to_pandas()
+    )
+    pd_result = (
+        scalars_pandas_df[columns].sort_values(ordering_columns).apply(add_ints, axis=1)
+    )
+
+    # bf_result.dtype is 'Int64' while pd_result.dtype is 'object', ignore this
+    # mismatch by using check_dtype=False.
+    #
+    # bf_result.to_numpy() produces an array of numpy.float64's
+    # (in system_prerelease tests), while pd_result.to_numpy() produces an
+    # array of ints, ignore this mismatch by using check_exact=False.
+    pd.testing.assert_series_equal(
+        pd_result, bf_result, check_dtype=False, check_exact=False
+    )
+
+
+@pytest.mark.flaky(retries=2, delay=120)
+def test_df_apply_axis_1_multiindex(session):
+    pd_df = pd.DataFrame(
+        {"x": [1, 2, 3], "y": [1.5, 3.75, 5], "z": ["pq", "rs", "tu"]},
+        index=pd.MultiIndex.from_tuples([("a", 100), ("a", 200), ("b", 300)]),
+    )
+    bf_df = session.read_pandas(pd_df)
+
+    def add_numbers(row):
+        return row["x"] + row["y"]
+
+    add_numbers_remote = session.remote_function(bigframes.series.Series, float)(
+        add_numbers
+    )
+
+    bf_result = bf_df.apply(add_numbers_remote, axis=1).to_pandas()
+    pd_result = pd_df.apply(add_numbers, axis=1)
+
+    # bf_result.dtype is 'Float64' while pd_result.dtype is 'float64', ignore this
+    # mismatch by using check_dtype=False.
+    #
+    # bf_result.index[0].dtype is 'string[pyarrow]' while
+    # pd_result.index[0].dtype is 'object', ignore this mismatch by using
+    # check_index_type=False.
+    pd.testing.assert_series_equal(
+        pd_result, bf_result, check_dtype=False, check_index_type=False
+    )
+
+
+def test_df_apply_axis_1_unsupported_callable(scalars_dfs):
+    scalars_df, scalars_pandas_df = scalars_dfs
+    columns = ["bool_col", "int64_col", "int64_too", "float64_col", "string_col"]
+
+    def add_ints(row):
+        return row["int64_col"] + row["int64_too"]
+
+    # pandas works
+    scalars_pandas_df.apply(add_ints, axis=1)
+
+    with pytest.raises(ValueError, match="For axis=1 a remote function must be used."):
+        scalars_df[columns].apply(add_ints, axis=1)
+
+
+@pytest.mark.parametrize(
+    ("column"),
+    [
+        pytest.param("bytes_col"),
+        pytest.param("date_col"),
+        pytest.param("datetime_col"),
+        pytest.param("geography_col"),
+        pytest.param("numeric_col"),
+        pytest.param("time_col"),
+        pytest.param("timestamp_col"),
+    ],
+)
+def test_df_apply_axis_1_unsupported_dtype(scalars_dfs, column):
+    scalars_df, scalars_pandas_df = scalars_dfs
+
+    # It doesn't matter if it is a remote function or not, the dtype check
+    # is done even before the function type check with axis=1
+    def echo(row):
+        return row[column]
+
+    # pandas works
+    scalars_pandas_df[[column]].apply(echo, axis=1)
+
+    dtype = scalars_df[column].dtype
+
+    with pytest.raises(
+        NotImplementedError,
+        match=re.escape(
+            f"DataFrame has a column of dtype '{dtype}' which is not supported with axis=1. Supported dtypes are ('Int64', 'Float64', 'boolean', 'string')."
+        ),
+    ):
+        scalars_df[[column]].apply(echo, axis=1)
```

### Comparing `bigframes-1.5.0/tests/system/small/test_scalar.py` & `bigframes-1.6.0/tests/system/small/test_scalar.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/small/test_series.py` & `bigframes-1.6.0/tests/system/small/test_series.py`

 * *Files 1% similar despite different names*

```diff
@@ -2561,14 +2561,44 @@
 
     pd.testing.assert_series_equal(
         bf_result,
         pd_result.astype(pd.BooleanDtype()),
     )
 
 
+def test_case_when(scalars_df_index, scalars_pandas_df_index):
+    pytest.importorskip(
+        "pandas",
+        minversion="2.2.0",
+        reason="case_when added in pandas 2.2.0",
+    )
+
+    bf_series = scalars_df_index["int64_col"]
+    pd_series = scalars_pandas_df_index["int64_col"]
+
+    # TODO(tswast): pandas case_when appears to assume True when a value is
+    # null. I suspect this should be considered a bug in pandas.
+    bf_result = bf_series.case_when(
+        [
+            ((bf_series > 100).fillna(True), 1000),
+            ((bf_series < -100).fillna(True), -1000),
+        ]
+    ).to_pandas()
+    pd_result = pd_series.case_when(
+        [
+            (pd_series > 100, 1000),
+            (pd_series < -100, -1000),
+        ]
+    )
+    pd.testing.assert_series_equal(
+        bf_result,
+        pd_result.astype(pd.Int64Dtype()),
+    )
+
+
 def test_to_frame(scalars_dfs):
     scalars_df, scalars_pandas_df = scalars_dfs
 
     bf_result = scalars_df["int64_col"].to_frame().to_pandas()
     pd_result = scalars_pandas_df["int64_col"].to_frame()
 
     assert_pandas_df_equal(bf_result, pd_result)
@@ -3475,14 +3505,49 @@
 
     pd_col = scalars_pandas_df["int64_col"]
     pd_result = pd_col.apply(ufunc)
 
     assert_series_equal(bf_result, pd_result)
 
 
+@pytest.mark.parametrize(
+    ("ufunc",),
+    [
+        pytest.param(numpy.add),
+        pytest.param(numpy.divide),
+    ],
+    ids=[
+        "add",
+        "divide",
+    ],
+)
+def test_combine_series_ufunc(scalars_dfs, ufunc):
+    scalars_df, scalars_pandas_df = scalars_dfs
+
+    bf_col = scalars_df["int64_col"].dropna()
+    bf_result = bf_col.combine(bf_col, ufunc).to_pandas()
+
+    pd_col = scalars_pandas_df["int64_col"].dropna()
+    pd_result = pd_col.combine(pd_col, ufunc)
+
+    assert_series_equal(bf_result, pd_result, check_dtype=False)
+
+
+def test_combine_scalar_ufunc(scalars_dfs):
+    scalars_df, scalars_pandas_df = scalars_dfs
+
+    bf_col = scalars_df["int64_col"].dropna()
+    bf_result = bf_col.combine(2.5, numpy.add).to_pandas()
+
+    pd_col = scalars_pandas_df["int64_col"].dropna()
+    pd_result = pd_col.combine(2.5, numpy.add)
+
+    assert_series_equal(bf_result, pd_result, check_dtype=False)
+
+
 def test_apply_simple_udf(scalars_dfs):
     scalars_df, scalars_pandas_df = scalars_dfs
 
     def foo(x):
         return x * x + 2 * x + 3
 
     bf_col = scalars_df["int64_col"]
```

### Comparing `bigframes-1.5.0/tests/system/small/test_session.py` & `bigframes-1.6.0/tests/system/small/test_session.py`

 * *Files 2% similar despite different names*

```diff
@@ -14,15 +14,15 @@
 
 import io
 import random
 import tempfile
 import textwrap
 import time
 import typing
-from typing import List
+from typing import List, Sequence
 
 import google
 import google.cloud.bigquery as bigquery
 import numpy as np
 import pandas as pd
 import pyarrow as pa
 import pytest
@@ -334,38 +334,88 @@
     )
     sensors = df.groupby(["sensor_id"]).agg("count").to_pandas(ordered=False)
     assert "OLI" in sensors.index
     assert "TIRS" in sensors.index
     assert "OLI_TIRS" in sensors.index
 
 
-def test_read_gbq_wildcard(session: bigframes.Session):
-    df = session.read_gbq("bigquery-public-data.noaa_gsod.gsod193*")
-    assert df.shape == (348485, 32)
+_GSOD_ALL_TABLES = "bigquery-public-data.noaa_gsod.gsod*"
+_GSOD_1930S = "bigquery-public-data.noaa_gsod.gsod193*"
 
 
-def test_read_gbq_wildcard_with_filter(session: bigframes.Session):
-    df = session.read_gbq(
-        "bigquery-public-data.noaa_gsod.gsod19*",
-        filters=[("_table_suffix", ">=", "30"), ("_table_suffix", "<=", "39")],  # type: ignore
-    )
-    assert df.shape == (348485, 32)
-
-
-def test_read_gbq_table_wildcard(session: bigframes.Session):
-    df = session.read_gbq_table("bigquery-public-data.noaa_gsod.gsod193*")
-    assert df.shape == (348485, 32)
-
-
-def test_read_gbq_table_wildcard_with_filter(session: bigframes.Session):
-    df = session.read_gbq_table(
-        "bigquery-public-data.noaa_gsod.gsod19*",
-        filters=[("_table_suffix", ">=", "30"), ("_table_suffix", "<=", "39")],  # type: ignore
+@pytest.mark.parametrize(
+    "api_method",
+    # Test that both methods work as there's a risk that read_gbq /
+    # read_gbq_table makes for an infinite loop. Table reads can convert to
+    # queries and read_gbq reads from tables.
+    ["read_gbq", "read_gbq_table"],
+)
+@pytest.mark.parametrize(
+    ("filters", "table_id", "index_col", "columns"),
+    [
+        pytest.param(
+            [("_table_suffix", ">=", "1930"), ("_table_suffix", "<=", "1939")],
+            _GSOD_ALL_TABLES,
+            ["stn", "wban", "year", "mo", "da"],
+            ["temp", "max", "min"],
+            id="all",
+        ),
+        pytest.param(
+            (),  # filters
+            _GSOD_1930S,
+            (),  # index_col
+            ["temp", "max", "min"],
+            id="columns",
+        ),
+        pytest.param(
+            [("_table_suffix", ">=", "1930"), ("_table_suffix", "<=", "1939")],
+            _GSOD_ALL_TABLES,
+            (),  # index_col,
+            (),  # columns
+            id="filters",
+        ),
+        pytest.param(
+            (),  # filters
+            _GSOD_1930S,
+            ["stn", "wban", "year", "mo", "da"],
+            (),  # columns
+            id="index_col",
+        ),
+    ],
+)
+def test_read_gbq_wildcard(
+    session: bigframes.Session,
+    api_method: str,
+    filters,
+    table_id: str,
+    index_col: Sequence[str],
+    columns: Sequence[str],
+):
+    table_metadata = session.bqclient.get_table(table_id)
+    method = getattr(session, api_method)
+    df = method(table_id, filters=filters, index_col=index_col, columns=columns)
+    num_rows, num_columns = df.shape
+
+    if index_col:
+        assert list(df.index.names) == list(index_col)
+    else:
+        assert df.index.name is None
+
+    expected_columns = (
+        columns
+        if columns
+        else [
+            field.name
+            for field in table_metadata.schema
+            if field.name not in index_col and field.name not in columns
+        ]
     )
-    assert df.shape == (348485, 32)
+    assert list(df.columns) == expected_columns
+    assert num_rows > 0
+    assert num_columns == len(expected_columns)
 
 
 @pytest.mark.parametrize(
     ("config"),
     [
         {
             "query": {
```

### Comparing `bigframes-1.5.0/tests/system/small/test_window.py` & `bigframes-1.6.0/tests/system/small/test_window.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/system/utils.py` & `bigframes-1.6.0/tests/system/utils.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/unit/__init__.py` & `bigframes-1.6.0/tests/unit/__init__.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/unit/_config/__init__.py` & `bigframes-1.6.0/tests/unit/_config/__init__.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/unit/_config/test_bigquery_options.py` & `bigframes-1.6.0/tests/unit/_config/test_bigquery_options.py`

 * *Files 2% similar despite different names*

```diff
@@ -104,28 +104,29 @@
         )
         options.location = valid_location
 
 
 @pytest.mark.parametrize(
     [
         "invalid_location",
+        "possibility",
     ],
     [
         # Test with common mistakes, see article.
         # https://en.wikipedia.org/wiki/Edit_distance#Formal_definition_and_properties
         # Substitution
-        ("us-wist-3",),
+        ("us-wist3", "us-west3"),
         # Insertion
-        ("us-central-1",),
+        ("us-central-1", "us-central1"),
         # Deletion
-        ("asia-suth2",),
+        ("asia-suth2", "asia-south2"),
     ],
 )
-def test_location_set_to_invalid_warning(invalid_location):
+def test_location_set_to_invalid_warning(invalid_location, possibility):
     options = bigquery_options.BigQueryOptions()
     with pytest.warns(
         bigframes.exceptions.UnknownLocationWarning,
         match=re.escape(
-            f"The location '{invalid_location}' is set to an unknown value."
+            f"The location '{invalid_location}' is set to an unknown value. Did you mean '{possibility}'?"
         ),
     ):
         options.location = invalid_location
```

### Comparing `bigframes-1.5.0/tests/unit/core/__init__.py` & `bigframes-1.6.0/tests/unit/core/__init__.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/unit/core/test_bf_utils.py` & `bigframes-1.6.0/tests/unit/core/test_bf_utils.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/unit/core/test_blocks.py` & `bigframes-1.6.0/tests/unit/core/test_blocks.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/unit/core/test_expression.py` & `bigframes-1.6.0/tests/unit/core/test_expression.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/unit/core/test_log_adapter.py` & `bigframes-1.6.0/tests/unit/core/test_log_adapter.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/unit/ml/__init__.py` & `bigframes-1.6.0/tests/unit/ml/__init__.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/unit/ml/test_api_primitives.py` & `bigframes-1.6.0/tests/unit/ml/test_api_primitives.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/unit/ml/test_compose.py` & `bigframes-1.6.0/tests/unit/ml/test_compose.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/unit/ml/test_golden_sql.py` & `bigframes-1.6.0/tests/unit/ml/test_golden_sql.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/unit/ml/test_pipeline.py` & `bigframes-1.6.0/tests/unit/ml/test_pipeline.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/unit/ml/test_sql.py` & `bigframes-1.6.0/tests/unit/ml/test_sql.py`

 * *Files 1% similar despite different names*

```diff
@@ -109,14 +109,21 @@
 def test_k_bins_discretizer_correct(
     base_sql_generator: ml_sql.BaseSqlGenerator,
 ):
     sql = base_sql_generator.ml_bucketize("col_a", [1, 2, 3, 4], "scaled_col_a")
     assert sql == "ML.BUCKETIZE(col_a, [1, 2, 3, 4], FALSE) AS scaled_col_a"
 
 
+def test_k_bins_discretizer_quantile_correct(
+    base_sql_generator: ml_sql.BaseSqlGenerator,
+):
+    sql = base_sql_generator.ml_quantile_bucketize("col_a", 5, "scaled_col_a")
+    assert sql == "ML.QUANTILE_BUCKETIZE(col_a, 5) OVER() AS scaled_col_a"
+
+
 def test_one_hot_encoder_correct(
     base_sql_generator: ml_sql.BaseSqlGenerator,
 ):
     sql = base_sql_generator.ml_one_hot_encoder(
         "col_a", "none", 1000000, 0, "encoded_col_a"
     )
     assert (
```

### Comparing `bigframes-1.5.0/tests/unit/resources.py` & `bigframes-1.6.0/tests/unit/resources.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/unit/session/__init__.py` & `bigframes-1.6.0/tests/unit/session/__init__.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/unit/session/test_clients.py` & `bigframes-1.6.0/tests/unit/session/test_clients.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/unit/session/test_io_pandas.py` & `bigframes-1.6.0/tests/unit/session/test_io_pandas.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/unit/session/test_read_gbq_table.py` & `bigframes-1.6.0/tests/unit/session/test_read_gbq_table.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/unit/session/test_session.py` & `bigframes-1.6.0/tests/unit/session/test_session.py`

 * *Files 14% similar despite different names*

```diff
@@ -394,89 +394,7 @@
         ValueError, match="Project must be set to initialize BigQuery client."
     ):
         bigframes.Session(
             bigframes.BigQueryOptions(
                 credentials=mock.Mock(spec=google.auth.credentials.Credentials)
             )
         )
-
-
-@pytest.mark.parametrize(
-    ("query_or_table", "columns", "filters", "expected_output"),
-    [
-        pytest.param(
-            """SELECT
-                rowindex,
-                string_col,
-            FROM `test_table` AS t
-            """,
-            [],
-            [("rowindex", "<", 4), ("string_col", "==", "Hello, World!")],
-            """SELECT * FROM (SELECT
-                rowindex,
-                string_col,
-            FROM `test_table` AS t
-            ) AS sub WHERE `rowindex` < 4 AND `string_col` = 'Hello, World!'""",
-            id="query_input",
-        ),
-        pytest.param(
-            "test_table",
-            [],
-            [("date_col", ">", "2022-10-20")],
-            "SELECT * FROM `test_table` AS sub WHERE `date_col` > '2022-10-20'",
-            id="table_input",
-        ),
-        pytest.param(
-            "test_table",
-            ["row_index", "string_col"],
-            [
-                (("rowindex", "not in", [0, 6]),),
-                (("string_col", "in", ["Hello, World!", ""]),),
-            ],
-            (
-                "SELECT `row_index`, `string_col` FROM `test_table` AS sub WHERE "
-                "`rowindex` NOT IN (0, 6) OR `string_col` IN ('Hello, World!', "
-                "'')"
-            ),
-            id="or_operation",
-        ),
-        pytest.param(
-            "test_table",
-            [],
-            ["date_col", ">", "2022-10-20"],
-            None,
-            marks=pytest.mark.xfail(
-                raises=ValueError,
-            ),
-            id="raise_error",
-        ),
-    ],
-)
-def test_read_gbq_with_filters(query_or_table, columns, filters, expected_output):
-    session = resources.create_bigquery_session()
-    query = session._to_query(query_or_table, columns, filters)
-    assert query == expected_output
-
-
-@pytest.mark.parametrize(
-    ("query_or_table", "columns", "filters", "expected_output"),
-    [
-        pytest.param(
-            "test_table*",
-            [],
-            [],
-            "SELECT * FROM `test_table*` AS sub",
-            id="wildcard_table_input",
-        ),
-        pytest.param(
-            "test_table*",
-            [],
-            [("_TABLE_SUFFIX", ">", "2022-10-20")],
-            "SELECT * FROM `test_table*` AS sub WHERE `_TABLE_SUFFIX` > '2022-10-20'",
-            id="wildcard_table_input_with_filter",
-        ),
-    ],
-)
-def test_read_gbq_wildcard(query_or_table, columns, filters, expected_output):
-    session = resources.create_bigquery_session()
-    query = session._to_query(query_or_table, columns, filters)
-    assert query == expected_output
```

#### encoding

```diff
@@ -1 +1 @@
-utf-8
+us-ascii
```

### Comparing `bigframes-1.5.0/tests/unit/test_clients.py` & `bigframes-1.6.0/tests/unit/test_clients.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/unit/test_compute_options.py` & `bigframes-1.6.0/tests/unit/test_compute_options.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/unit/test_core.py` & `bigframes-1.6.0/tests/unit/test_core.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/unit/test_dataframe.py` & `bigframes-1.6.0/tests/unit/test_dataframe.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/unit/test_dtypes.py` & `bigframes-1.6.0/tests/unit/test_dtypes.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/unit/test_features.py` & `bigframes-1.6.0/tests/unit/test_features.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/unit/test_formatting_helper.py` & `bigframes-1.6.0/tests/unit/test_formatting_helper.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/unit/test_formatting_helpers.py` & `bigframes-1.6.0/tests/unit/test_formatting_helpers.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/unit/test_pandas.py` & `bigframes-1.6.0/tests/unit/test_pandas.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/tests/unit/test_remote_function.py` & `bigframes-1.6.0/tests/unit/test_remote_function.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/cpython/LICENSE` & `bigframes-1.6.0/third_party/bigframes_vendored/cpython/LICENSE`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/cpython/_pprint.py` & `bigframes-1.6.0/third_party/bigframes_vendored/cpython/_pprint.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/google_cloud_bigquery/LICENSE` & `bigframes-1.6.0/third_party/bigframes_vendored/google_cloud_bigquery/LICENSE`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/google_cloud_bigquery/__init__.py` & `bigframes-1.6.0/third_party/bigframes_vendored/google_cloud_bigquery/__init__.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/google_cloud_bigquery/_pandas_helpers.py` & `bigframes-1.6.0/third_party/bigframes_vendored/google_cloud_bigquery/_pandas_helpers.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/google_cloud_bigquery/tests/__init__.py` & `bigframes-1.6.0/third_party/bigframes_vendored/google_cloud_bigquery/tests/__init__.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/google_cloud_bigquery/tests/unit/__init__.py` & `bigframes-1.6.0/third_party/bigframes_vendored/google_cloud_bigquery/tests/unit/__init__.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/google_cloud_bigquery/tests/unit/test_pandas_helpers.py` & `bigframes-1.6.0/third_party/bigframes_vendored/google_cloud_bigquery/tests/unit/test_pandas_helpers.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/ibis/LICENSE.txt` & `bigframes-1.6.0/third_party/bigframes_vendored/ibis/LICENSE.txt`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/ibis/README.md` & `bigframes-1.6.0/third_party/bigframes_vendored/ibis/README.md`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/ibis/backends/bigquery/compiler.py` & `bigframes-1.6.0/third_party/bigframes_vendored/ibis/backends/bigquery/compiler.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/ibis/backends/bigquery/datatypes.py` & `bigframes-1.6.0/third_party/bigframes_vendored/ibis/backends/bigquery/datatypes.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/ibis/backends/bigquery/registry.py` & `bigframes-1.6.0/third_party/bigframes_vendored/ibis/backends/bigquery/registry.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/ibis/expr/operations/analytic.py` & `bigframes-1.6.0/third_party/bigframes_vendored/ibis/expr/operations/analytic.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/ibis/expr/operations/reductions.py` & `bigframes-1.6.0/third_party/bigframes_vendored/ibis/expr/operations/reductions.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/AUTHORS.md` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/AUTHORS.md`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/LICENSE` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/LICENSE`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/README.md` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/README.md`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/_config/config.py` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/_config/config.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/arrays/arrow/accessors.py` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/arrays/arrow/accessors.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/arrays/datetimelike.py` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/arrays/datetimelike.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/common.py` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/common.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/computation/align.py` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/computation/align.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/computation/common.py` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/computation/common.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/computation/engines.py` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/computation/engines.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/computation/eval.py` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/computation/eval.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/computation/expr.py` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/computation/expr.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/computation/ops.py` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/computation/ops.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/computation/parsing.py` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/computation/parsing.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/computation/scope.py` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/computation/scope.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/config_init.py` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/config_init.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/dtypes/inference.py` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/dtypes/inference.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/frame.py` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/frame.py`

 * *Files 1% similar despite different names*

```diff
@@ -4196,20 +4196,24 @@
                 no suffix. At least one of the values must not be None.
 
         Returns:
             bigframes.dataframe.DataFrame: A DataFrame of the two merged objects.
         """
         raise NotImplementedError(constants.ABSTRACT_METHOD_ERROR_MESSAGE)
 
-    def apply(self, func, *, args=(), **kwargs):
+    def apply(self, func, *, axis=0, args=(), **kwargs):
         """Apply a function along an axis of the DataFrame.
 
         Objects passed to the function are Series objects whose index is
-        the DataFrame's index (``axis=0``) the final return type
-        is inferred from the return type of the applied function.
+        the DataFrame's index (``axis=0``) or the DataFrame's columns (``axis=1``).
+        The final return type is inferred from the return type of the applied
+        function.
+
+        .. note::
+            ``axis=1`` scenario is in preview.
 
         **Examples:**
 
             >>> import bigframes.pandas as bpd
             >>> bpd.options.display.progress_bar = None
 
             >>> df = bpd.DataFrame({'col1': [1, 2], 'col2': [3, 4]})
@@ -4226,17 +4230,36 @@
             >>> df.apply(square)
                col1  col2
             0     1     9
             1     4    16
             <BLANKLINE>
             [2 rows x 2 columns]
 
+        You could apply a user defined function to every row of the DataFrame by
+        creating a remote function out of it, and using it with `axis=1`.
+
+            >>> @bpd.remote_function(bpd.Series, int, reuse=False)
+            ... def foo(row):
+            ...     result = 1
+            ...     result += row["col1"]
+            ...     result += row["col2"]*row["col2"]
+            ...     return result
+
+            >>> df.apply(foo, axis=1)
+            0    11
+            1    19
+            dtype: Int64
+
         Args:
             func (function):
                 Function to apply to each column or row.
+            axis ({index (0), columns (1)}):
+                Axis along which the function is applied. Specify 0 or 'index'
+                to apply function to each column. Specify 1 or 'columns' to
+                apply function to each row.
             args (tuple):
                 Positional arguments to pass to `func` in addition to the
                 array/series.
             **kwargs:
                 Additional keyword arguments to pass as keywords arguments to
                 `func`.
```

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/generic.py` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/generic.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/groupby/__init__.py` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/groupby/__init__.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/indexes/accessor.py` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/indexes/accessor.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/indexes/base.py` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/indexes/base.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/indexes/multi.py` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/indexes/multi.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/indexing.py` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/indexing.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/reshape/concat.py` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/reshape/concat.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/reshape/encoding.py` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/reshape/encoding.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/reshape/merge.py` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/reshape/merge.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/reshape/tile.py` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/reshape/tile.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/series.py` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/series.py`

 * *Files 1% similar despite different names*

```diff
@@ -2,18 +2,20 @@
 Data structure for 1-dimensional cross-sectional and time series data
 """
 from __future__ import annotations
 
 from typing import (
     Hashable,
     IO,
+    List,
     Literal,
     Mapping,
     Optional,
     Sequence,
+    Tuple,
     TYPE_CHECKING,
     Union,
 )
 
 from bigframes_vendored.pandas.core.generic import NDFrame
 import numpy
 import numpy as np
@@ -1273,14 +1275,70 @@
         Returns:
             bigframes.series.Series: A new Series with values representing the
             return value of the ``func`` applied to each element of the original
             Series.
         """
         raise NotImplementedError(constants.ABSTRACT_METHOD_ERROR_MESSAGE)
 
+    def combine(
+        self,
+        other: Series | Hashable,
+        func,
+    ) -> Series:
+        """
+        Combine the Series with a Series or scalar according to `func`.
+
+        Combine the Series and `other` using `func` to perform elementwise
+        selection for combined Series.
+        `fill_value` is assumed when value is missing at some index
+        from one of the two objects being combined.
+
+        **Examples:**
+
+            >>> import bigframes.pandas as bpd
+            >>> import numpy as np
+            >>> bpd.options.display.progress_bar = None
+
+            Consider 2 Datasets ``s1`` and ``s2`` containing
+            highest clocked speeds of different birds.
+
+            >>> s1 = bpd.Series({'falcon': 330.0, 'eagle': 160.0})
+            >>> s1
+            falcon    330.0
+            eagle     160.0
+            dtype: Float64
+            >>> s2 = bpd.Series({'falcon': 345.0, 'eagle': 200.0, 'duck': 30.0})
+            >>> s2
+            falcon    345.0
+            eagle     200.0
+            duck       30.0
+            dtype: Float64
+
+            Now, to combine the two datasets and view the highest speeds
+            of the birds across the two datasets
+
+            >>> s1.combine(s2, np.maximum)
+            falcon    345.0
+            eagle     200.0
+            duck       <NA>
+            dtype: Float64
+
+        Args:
+            other (Series or scalar):
+                The value(s) to be combined with the `Series`.
+            func (function):
+                BigFrames DataFrames ``remote_function`` to apply.
+                Takes two scalars as inputs and returns an element.
+                Also accepts some numpy binary functions.
+
+        Returns:
+            Series: The result of combining the Series with the other object.
+        """
+        raise NotImplementedError(constants.ABSTRACT_METHOD_ERROR_MESSAGE)
+
     def groupby(
         self,
         by=None,
         axis: Axis = 0,
         level=None,
         as_index: bool = True,
         *,
@@ -1933,14 +1991,67 @@
         Returns:
             Series: Series representing whether each element is between left and
             right (inclusive).
 
         """
         raise NotImplementedError(constants.ABSTRACT_METHOD_ERROR_MESSAGE)
 
+    def case_when(
+        self,
+        caselist: List[Tuple[Series, Series]],
+    ) -> Series:
+        """Replace values where the conditions are True.
+
+        **Examples:**
+
+            >>> import bigframes.pandas as bpd
+            >>> bpd.options.display.progress_bar = None
+
+            >>> c = bpd.Series([6, 7, 8, 9], name="c")
+            >>> a = bpd.Series([0, 0, 1, 2])
+            >>> b = bpd.Series([0, 3, 4, 5])
+
+            >>> c.case_when(
+            ...     caselist=[
+            ...         (a.gt(0), a),  # condition, replacement
+            ...         (b.gt(0), b),
+            ...     ]
+            ... )
+            0    6
+            1    3
+            2    1
+            3    2
+            Name: c, dtype: Int64
+
+        **See also:**
+
+        - :func:`bigframes.series.Series.mask` : Replace values where the condition is True.
+
+        Args:
+            caselist:
+                A list of tuples of conditions and expected replacements
+                Takes the form:  ``(condition0, replacement0)``,
+                ``(condition1, replacement1)``, ... .
+                ``condition`` should be a 1-D boolean array-like object
+                or a callable. If ``condition`` is a callable,
+                it is computed on the Series
+                and should return a boolean Series or array.
+                The callable must not change the input Series
+                (though pandas doesn`t check it). ``replacement`` should be a
+                1-D array-like object, a scalar or a callable.
+                If ``replacement`` is a callable, it is computed on the Series
+                and should return a scalar or Series. The callable
+                must not change the input Series
+                (though pandas doesn`t check it).
+
+        Returns:
+            bigframes.series.Series
+        """
+        raise NotImplementedError(constants.ABSTRACT_METHOD_ERROR_MESSAGE)
+
     def cumprod(self):
         """
         Return cumulative product over a DataFrame or Series axis.
 
         Returns a DataFrame or Series of the same size containing the cumulative
         product.
```

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/strings/accessor.py` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/strings/accessor.py`

 * *Files 1% similar despite different names*

```diff
@@ -936,14 +936,62 @@
 
         Returns:
             bigframes.series.Series: A Series of booleans indicating whether the given
                 pattern matches the end of each string element.
         """
         raise NotImplementedError(constants.ABSTRACT_METHOD_ERROR_MESSAGE)
 
+    def split(
+        self,
+        pat: str = " ",
+        regex: typing.Union[bool, None] = None,
+    ):
+        """
+        Split strings around given separator/delimiter.
+
+        **Examples:**
+
+            >>> import bigframes.pandas as bpd
+            >>> import numpy as np
+            >>> bpd.options.display.progress_bar = None
+
+            >>> s = bpd.Series(
+            ...     [
+            ...         "a regular sentence",
+            ...         "https://docs.python.org/index.html",
+            ...         np.nan
+            ...     ]
+            ... )
+            >>> s.str.split()
+            0                ['a' 'regular' 'sentence']
+            1    ['https://docs.python.org/index.html']
+            2                                        []
+            dtype: list<item: string>[pyarrow]
+
+            The pat parameter can be used to split by other characters.
+
+            >>> s.str.split("//", regex=False)
+            0                     ['a regular sentence']
+            1    ['https:' 'docs.python.org/index.html']
+            2                                         []
+            dtype: list<item: string>[pyarrow]
+
+        Args:
+            pat (str, default " "):
+                String to split on. If not specified, split on whitespace.
+            regex (bool, default None):
+                Determines if the passed-in pattern is a regular expression. Regular
+                expressions aren't currently supported. Please set `regex=False` when
+                `pat` length is not 1.
+
+        Returns:
+            bigframes.series.Series: Type matches caller.
+        """
+        raise NotImplementedError(constants.ABSTRACT_METHOD_ERROR_MESSAGE)
+
     def match(self, pat: str, case: bool = True, flags: int = 0):
         """
         Determine if each string starts with a match of a regular expression.
 
         **Examples:**
 
             >>> import bigframes.pandas as bpd
```

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/tools/datetimes.py` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/tools/datetimes.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/core/window/rolling.py` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/core/window/rolling.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/io/common.py` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/io/common.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/io/gbq.py` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/io/gbq.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/io/parquet.py` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/io/parquet.py`

 * *Files 10% similar despite different names*

```diff
@@ -15,14 +15,19 @@
         r"""Load a Parquet object from the file path (local or Cloud Storage), returning a DataFrame.
 
         .. note::
             This method will not guarantee the same ordering as the file.
             Instead, set a serialized index column as the index and sort by
             that in the resulting DataFrame.
 
+        .. note::
+            For non-"bigquery" engine, data is inlined in the query SQL if it is
+            small enough (roughly 5MB or less in memory). Larger size data is
+            loaded to a BigQuery table instead.
+
         **Examples:**
 
             >>> import bigframes.pandas as bpd
             >>> bpd.options.display.progress_bar = None
 
             >>> gcs_path = "gs://cloud-samples-data/bigquery/us-states/us-states.parquet"
             >>> df = bpd.read_parquet(path=gcs_path, engine="bigquery")
```

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/io/parsers/readers.py` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/io/parsers/readers.py`

 * *Files 2% similar despite different names*

```diff
@@ -58,14 +58,19 @@
         automatically recycled after the Session is closed.
 
         .. note::
             using `engine="bigquery"` will not guarantee the same ordering as the
             file. Instead, set a serialized index column as the index and sort by
             that in the resulting DataFrame.
 
+        .. note::
+            For non-bigquery engine, data is inlined in the query SQL if it is
+            small enough (roughly 5MB or less in memory). Larger size data is
+            loaded to a BigQuery table instead.
+
         **Examples:**
 
             >>> import bigframes.pandas as bpd
             >>> bpd.options.display.progress_bar = None
 
             >>> gcs_path = "gs://cloud-samples-data/bigquery/us-states/us-states.csv"
             >>> df = bpd.read_csv(filepath_or_buffer=gcs_path)
@@ -163,14 +168,19 @@
         Convert a JSON string to DataFrame object.
 
         .. note::
             using `engine="bigquery"` will not guarantee the same ordering as the
             file. Instead, set a serialized index column as the index and sort by
             that in the resulting DataFrame.
 
+        .. note::
+            For non-bigquery engine, data is inlined in the query SQL if it is
+            small enough (roughly 5MB or less in memory). Larger size data is
+            loaded to a BigQuery table instead.
+
         **Examples:**
 
             >>> import bigframes.pandas as bpd
             >>> bpd.options.display.progress_bar = None
 
             >>> gcs_path = "gs://bigframes-dev-testing/sample1.json"
             >>> df = bpd.read_json(path_or_buf=gcs_path, lines=True, orient="records")
```

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/io/pickle.py` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/io/pickle.py`

 * *Files 4% similar despite different names*

```diff
@@ -21,14 +21,19 @@
     ):
         """Load pickled BigFrames object (or any object) from file.
 
         .. note::
             If the content of the pickle file is a Series and its name attribute is None,
             the name will be set to '0' by default.
 
+        .. note::
+            Data is inlined in the query SQL if it is small enough (roughly 5MB
+            or less in memory). Larger size data is loaded to a BigQuery table
+            instead.
+
         **Examples:**
 
             >>> import bigframes.pandas as bpd
             >>> bpd.options.display.progress_bar = None
 
             >>> gcs_path = "gs://bigframes-dev-testing/test_pickle.pkl"
             >>> df = bpd.read_pickle(filepath_or_buffer=gcs_path)
```

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/pandas/_typing.py` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/pandas/_typing.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/plotting/_core.py` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/plotting/_core.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/util/_exceptions.py` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/util/_exceptions.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/pandas/util/_validators.py` & `bigframes-1.6.0/third_party/bigframes_vendored/pandas/util/_validators.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/sklearn/COPYING` & `bigframes-1.6.0/third_party/bigframes_vendored/sklearn/COPYING`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/sklearn/base.py` & `bigframes-1.6.0/third_party/bigframes_vendored/sklearn/base.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/sklearn/cluster/_kmeans.py` & `bigframes-1.6.0/third_party/bigframes_vendored/sklearn/cluster/_kmeans.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/sklearn/compose/_column_transformer.py` & `bigframes-1.6.0/third_party/bigframes_vendored/sklearn/compose/_column_transformer.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/sklearn/decomposition/_pca.py` & `bigframes-1.6.0/third_party/bigframes_vendored/sklearn/decomposition/_pca.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/sklearn/ensemble/_forest.py` & `bigframes-1.6.0/third_party/bigframes_vendored/sklearn/ensemble/_forest.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/sklearn/linear_model/_base.py` & `bigframes-1.6.0/third_party/bigframes_vendored/sklearn/linear_model/_base.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/sklearn/linear_model/_logistic.py` & `bigframes-1.6.0/third_party/bigframes_vendored/sklearn/linear_model/_logistic.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/sklearn/metrics/_classification.py` & `bigframes-1.6.0/third_party/bigframes_vendored/sklearn/metrics/_classification.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/sklearn/metrics/_ranking.py` & `bigframes-1.6.0/third_party/bigframes_vendored/sklearn/metrics/_ranking.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/sklearn/metrics/_regression.py` & `bigframes-1.6.0/third_party/bigframes_vendored/sklearn/metrics/_regression.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/sklearn/metrics/pairwise.py` & `bigframes-1.6.0/third_party/bigframes_vendored/sklearn/metrics/pairwise.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/sklearn/pipeline.py` & `bigframes-1.6.0/third_party/bigframes_vendored/sklearn/pipeline.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/sklearn/preprocessing/_data.py` & `bigframes-1.6.0/third_party/bigframes_vendored/sklearn/preprocessing/_data.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/sklearn/preprocessing/_discretization.py` & `bigframes-1.6.0/third_party/bigframes_vendored/sklearn/preprocessing/_discretization.py`

 * *Files 5% similar despite different names*

```diff
@@ -14,15 +14,15 @@
 
     Args:
         n_bins (int, default 5):
             The number of bins to produce. Raises ValueError if ``n_bins < 2``.
         strategy ({'uniform', 'quantile'}, default='quantile'):
             Strategy used to define the widths of the bins. 'uniform': All bins
             in each feature have identical widths. 'quantile': All bins in each
-            feature have the same number of points. Only `uniform` is supported.
+            feature have the same number of points.
     """
 
     def fit(self, X, y=None):
         """Fit the estimator.
 
         Args:
             X (bigframes.dataframe.DataFrame or bigframes.series.Series):
```

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/sklearn/preprocessing/_encoder.py` & `bigframes-1.6.0/third_party/bigframes_vendored/sklearn/preprocessing/_encoder.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/sklearn/preprocessing/_label.py` & `bigframes-1.6.0/third_party/bigframes_vendored/sklearn/preprocessing/_label.py`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/xgboost/LICENSE` & `bigframes-1.6.0/third_party/bigframes_vendored/xgboost/LICENSE`

 * *Files identical despite different names*

### Comparing `bigframes-1.5.0/third_party/bigframes_vendored/xgboost/sklearn.py` & `bigframes-1.6.0/third_party/bigframes_vendored/xgboost/sklearn.py`

 * *Files identical despite different names*

