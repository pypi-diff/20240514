# Comparing `tmp/okahu_observability-0.0.3.tar.gz` & `tmp/okahu_observability-0.0.4.tar.gz`

## Comparing `okahu_observability-0.0.3.tar` & `okahu_observability-0.0.4.tar`

### file list

```diff
@@ -1,16 +1,16 @@
--rw-r--r--   0        0        0     2276 2020-02-02 00:00:00.000000 okahu_observability-0.0.3/logprobs_sample.py
--rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 okahu_observability-0.0.3/src/okahu_apptrace/__init__.py
--rw-r--r--   0        0        0     2498 2020-02-02 00:00:00.000000 okahu_observability-0.0.3/src/okahu_apptrace/exporter.py
--rw-r--r--   0        0        0     3878 2020-02-02 00:00:00.000000 okahu_observability-0.0.3/src/okahu_apptrace/instrumentor.py
--rw-r--r--   0        0        0     6344 2020-02-02 00:00:00.000000 okahu_observability-0.0.3/src/okahu_apptrace/utils.py
--rw-r--r--   0        0        0     4263 2020-02-02 00:00:00.000000 okahu_observability-0.0.3/src/okahu_apptrace/wrapper.py
--rw-r--r--   0        0        0     9128 2020-02-02 00:00:00.000000 okahu_observability-0.0.3/storage/default__vector_store.json
--rw-r--r--   0        0        0     2031 2020-02-02 00:00:00.000000 okahu_observability-0.0.3/storage/docstore.json
--rw-r--r--   0        0        0       18 2020-02-02 00:00:00.000000 okahu_observability-0.0.3/storage/graph_store.json
--rw-r--r--   0        0        0       72 2020-02-02 00:00:00.000000 okahu_observability-0.0.3/storage/image__vector_store.json
--rw-r--r--   0        0        0      331 2020-02-02 00:00:00.000000 okahu_observability-0.0.3/storage/index_store.json
--rw-r--r--   0        0        0     1590 2020-02-02 00:00:00.000000 okahu_observability-0.0.3/.gitignore
--rw-r--r--   0        0        0      906 2020-02-02 00:00:00.000000 okahu_observability-0.0.3/LICENSE
--rw-r--r--   0        0        0     2037 2020-02-02 00:00:00.000000 okahu_observability-0.0.3/README.md
--rw-r--r--   0        0        0     1646 2020-02-02 00:00:00.000000 okahu_observability-0.0.3/pyproject.toml
--rw-r--r--   0        0        0     3255 2020-02-02 00:00:00.000000 okahu_observability-0.0.3/PKG-INFO
+-rw-r--r--   0        0        0     2276 2020-02-02 00:00:00.000000 okahu_observability-0.0.4/logprobs_sample.py
+-rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 okahu_observability-0.0.4/src/okahu_apptrace/__init__.py
+-rw-r--r--   0        0        0     2498 2020-02-02 00:00:00.000000 okahu_observability-0.0.4/src/okahu_apptrace/exporter.py
+-rw-r--r--   0        0        0     3878 2020-02-02 00:00:00.000000 okahu_observability-0.0.4/src/okahu_apptrace/instrumentor.py
+-rw-r--r--   0        0        0     7206 2020-02-02 00:00:00.000000 okahu_observability-0.0.4/src/okahu_apptrace/utils.py
+-rw-r--r--   0        0        0     4263 2020-02-02 00:00:00.000000 okahu_observability-0.0.4/src/okahu_apptrace/wrapper.py
+-rw-r--r--   0        0        0     9128 2020-02-02 00:00:00.000000 okahu_observability-0.0.4/storage/default__vector_store.json
+-rw-r--r--   0        0        0     2031 2020-02-02 00:00:00.000000 okahu_observability-0.0.4/storage/docstore.json
+-rw-r--r--   0        0        0       18 2020-02-02 00:00:00.000000 okahu_observability-0.0.4/storage/graph_store.json
+-rw-r--r--   0        0        0       72 2020-02-02 00:00:00.000000 okahu_observability-0.0.4/storage/image__vector_store.json
+-rw-r--r--   0        0        0      331 2020-02-02 00:00:00.000000 okahu_observability-0.0.4/storage/index_store.json
+-rw-r--r--   0        0        0     1590 2020-02-02 00:00:00.000000 okahu_observability-0.0.4/.gitignore
+-rw-r--r--   0        0        0      906 2020-02-02 00:00:00.000000 okahu_observability-0.0.4/LICENSE
+-rw-r--r--   0        0        0     2037 2020-02-02 00:00:00.000000 okahu_observability-0.0.4/README.md
+-rw-r--r--   0        0        0     1646 2020-02-02 00:00:00.000000 okahu_observability-0.0.4/pyproject.toml
+-rw-r--r--   0        0        0     3255 2020-02-02 00:00:00.000000 okahu_observability-0.0.4/PKG-INFO
```

### Comparing `okahu_observability-0.0.3/logprobs_sample.py` & `okahu_observability-0.0.4/logprobs_sample.py`

 * *Files identical despite different names*

### Comparing `okahu_observability-0.0.3/src/okahu_apptrace/exporter.py` & `okahu_observability-0.0.4/src/okahu_apptrace/exporter.py`

 * *Files identical despite different names*

### Comparing `okahu_observability-0.0.3/src/okahu_apptrace/instrumentor.py` & `okahu_observability-0.0.4/src/okahu_apptrace/instrumentor.py`

 * *Files identical despite different names*

### Comparing `okahu_observability-0.0.3/src/okahu_apptrace/utils.py` & `okahu_observability-0.0.4/src/okahu_apptrace/utils.py`

 * *Files 5% similar despite different names*

```diff
@@ -1,13 +1,15 @@
 import logging
 import os
 from opentelemetry.trace import Tracer, Span
 
 logger = logging.getLogger(__name__)
 WORKFLOW_TYPE_KEY = "workflow_type"
+PROMPT_INPUT_KEY = "workflow_input"
+PROMPT_OUTPUT_KEY = "workflow_output"
 
 WORKFLOW_TYPE_MAP = {
     "llama_index": "workflow.llamaindex",
     "langchain": "workflow.langchain"
 }
 
 def _with_tracer_wrapper(func):
@@ -24,28 +26,33 @@
 @_with_tracer_wrapper
 def task_wrapper(tracer: Tracer, to_wrap, wrapped, instance, args, kwargs):
     """Instruments and calls every function defined in TO_WRAP."""
 
     # Some Langchain objects are wrapped elsewhere, so we ignore them here
     if instance.__class__.__name__ in ("AgentExecutor"):
         return wrapped(*args, **kwargs)
-
+    
     if hasattr(instance, "name") and instance.name:
         name = f"{to_wrap.get('span_name')}.{instance.name.lower()}"
     elif to_wrap.get("span_name"):
         name = to_wrap.get("span_name")
     else:
         name = f"langchain.task.{instance.__class__.__name__}"
     kind = to_wrap.get("kind")
+    
     with tracer.start_as_current_span(name) as span:
+        if is_root_span(span):
+            update_span_with_prompt_input(to_wrap=to_wrap, wrapped_args=args, span=span)
+
         return_value = wrapped(*args, **kwargs)
 
         if is_root_span(span):
             workflow_name = span.resource.attributes.get("service.name")
             span.set_attribute("workflow_name",workflow_name)
+            update_span_with_prompt_output(to_wrap=to_wrap, wrapped_args=return_value, span=span)
             update_workflow_type(to_wrap, span)
 
     return return_value
 
 @_with_tracer_wrapper
 async def atask_wrapper(tracer, to_wrap, wrapped, instance, args, kwargs):
     """Instruments and calls every function defined in TO_WRAP."""
@@ -78,15 +85,14 @@
         name = to_wrap.get("span_name")
     else:
         name = f"langchain.task.{instance.__class__.__name__}"
     kind = to_wrap.get("kind")
     with tracer.start_as_current_span(name) as span:
         update_llm_endpoint(curr_span= span, instance=instance)
         
-
         return_value = await wrapped(*args, **kwargs)
 
     return return_value
 
 @_with_tracer_wrapper
 def llm_wrapper(tracer: Tracer, to_wrap, wrapped, instance, args, kwargs):
     
@@ -109,23 +115,23 @@
 
     return return_value
 
 def update_llm_endpoint(curr_span: Span, instance):
     triton_llm_endpoint = os.environ.get("TRITON_LLM_ENDPOINT")
     if triton_llm_endpoint is not None and len(triton_llm_endpoint) > 0:
         curr_span.set_attribute("server_url", triton_llm_endpoint)
-
-    # handling for langchain
-    if 'model_name' in instance.__dict__:
-        model_name = instance.__dict__.get("model_name")
-        curr_span.set_attribute("openai_model_name", model_name)
-    # handling for llama_index
-    if 'model' in instance.__dict__:
-        model_name = instance.__dict__.get("model")
-        curr_span.set_attribute("openai_model_name", model_name)
+    else:
+        # handling for langchain
+        if 'model_name' in instance.__dict__:
+            model_name = instance.__dict__.get("model_name")
+            curr_span.set_attribute("openai_model_name", model_name)
+        # handling for llama_index
+        if 'model' in instance.__dict__:
+            model_name = instance.__dict__.get("model")
+            curr_span.set_attribute("openai_model_name", model_name)
 
 def is_root_span(curr_span: Span) -> bool:
     return curr_span.parent == None
 
 def get_input_from_args(chain_args):
     if len(chain_args) > 0 and type(chain_args[0]) == str:
         return chain_args[0]
@@ -155,8 +161,21 @@
 
 def update_workflow_type(to_wrap, span: Span):
     package_name = to_wrap.get('package')
 
     for (package, workflow_type) in WORKFLOW_TYPE_MAP.items():
         if(package_name is not None and package in package_name):
             span.set_attribute(WORKFLOW_TYPE_KEY, workflow_type)
+
+def update_span_with_prompt_input(to_wrap, wrapped_args ,span: Span):
+    input_arg_text = wrapped_args[0]
+    span.set_attribute(PROMPT_INPUT_KEY, input_arg_text)
+
+def update_span_with_prompt_output(to_wrap, wrapped_args ,span: Span):
+    package_name: str = to_wrap.get('package')
+    if type(wrapped_args) == str:
+        span.set_attribute(PROMPT_OUTPUT_KEY, wrapped_args)
+    if("llama_index.core.base.base_query_engine" in package_name):
+        span.set_attribute(PROMPT_OUTPUT_KEY, wrapped_args.response)
+    
+
```

### Comparing `okahu_observability-0.0.3/src/okahu_apptrace/wrapper.py` & `okahu_observability-0.0.4/src/okahu_apptrace/wrapper.py`

 * *Files identical despite different names*

### Comparing `okahu_observability-0.0.3/storage/default__vector_store.json` & `okahu_observability-0.0.4/storage/default__vector_store.json`

 * *Files 14% similar despite different names*

#### Pretty-printed

 * *Similarity: 0.5%*

 * *Differences: {"'embedding_dict'": "{replace: OrderedDict([('881801b1-c607-45a9-a6af-97d59eff8cac', "*

 * *                     '[-0.04858401417732239, -0.003067454556003213, -0.003166808746755123, '*

 * *                     '-0.02458147332072258, 0.07257718592882156, -0.03540254756808281, '*

 * *                     '-0.045832980424165726, 0.035962045192718506, -0.007968418300151825, '*

 * *                     '-0.05145477131009102, 0.0422922819852829, -0.04967426508665085, '*

 * *                     '-0.05739792063832283, -0.027565479278564 […]*

```diff
@@ -1,10 +1,10 @@
 {
     "embedding_dict": {
-        "22435b6d-65df-468c-9182-fac723f842e7": [
+        "881801b1-c607-45a9-a6af-97d59eff8cac": [
             -0.04858401417732239,
             -0.003067454556003213,
             -0.003166808746755123,
             -0.02458147332072258,
             0.07257718592882156,
             -0.03540254756808281,
             -0.045832980424165726,
@@ -384,24 +384,24 @@
             -0.04757963493466377,
             0.11915341019630432,
             -0.007906164042651653,
             0.02447541244328022
         ]
     },
     "metadata_dict": {
-        "22435b6d-65df-468c-9182-fac723f842e7": {
+        "881801b1-c607-45a9-a6af-97d59eff8cac": {
             "_node_type": "TextNode",
-            "creation_date": "2024-05-06",
-            "doc_id": "6508ce76-0aa0-4994-94c4-5f30c5c6de0c",
-            "document_id": "6508ce76-0aa0-4994-94c4-5f30c5c6de0c",
+            "creation_date": "2024-05-14",
+            "doc_id": "9b1f05bd-271c-451c-a3f7-9ff70cf1ac75",
+            "document_id": "9b1f05bd-271c-451c-a3f7-9ff70cf1ac75",
             "file_name": "sample.txt",
             "file_path": "/Users/kshitizvijayvargiya/demo-repository/packages_otel/tests/data/sample.txt",
             "file_size": 24,
             "file_type": "text/plain",
             "last_modified_date": "2024-04-16",
-            "ref_doc_id": "6508ce76-0aa0-4994-94c4-5f30c5c6de0c"
+            "ref_doc_id": "9b1f05bd-271c-451c-a3f7-9ff70cf1ac75"
         }
     },
     "text_id_to_ref_doc_id": {
-        "22435b6d-65df-468c-9182-fac723f842e7": "6508ce76-0aa0-4994-94c4-5f30c5c6de0c"
+        "881801b1-c607-45a9-a6af-97d59eff8cac": "9b1f05bd-271c-451c-a3f7-9ff70cf1ac75"
     }
 }
```

### Comparing `okahu_observability-0.0.3/storage/docstore.json` & `okahu_observability-0.0.4/storage/docstore.json`

 * *Files 18% similar despite different names*

#### Pretty-printed

 * *Similarity: 0.5%*

 * *Differences: {"'docstore/data'": "{replace: OrderedDict([('881801b1-c607-45a9-a6af-97d59eff8cac', "*

 * *                    "OrderedDict([('__data__', OrderedDict([('id_', "*

 * *                    "'881801b1-c607-45a9-a6af-97d59eff8cac'), ('embedding', None), ('metadata', "*

 * *                    "OrderedDict([('file_path', "*

 * *                    "'/Users/kshitizvijayvargiya/demo-repository/packages_otel/tests/data/sample.txt'), "*

 * *                    "('file_name', 'sample.txt'), ('file_type', 'text/plain'), ('file_size', 24), "*

 * *  […]*

```diff
@@ -1,10 +1,10 @@
 {
     "docstore/data": {
-        "22435b6d-65df-468c-9182-fac723f842e7": {
+        "881801b1-c607-45a9-a6af-97d59eff8cac": {
             "__data__": {
                 "class_name": "TextNode",
                 "embedding": null,
                 "end_char_idx": 24,
                 "excluded_embed_metadata_keys": [
                     "file_name",
                     "file_type",
@@ -17,66 +17,66 @@
                     "file_name",
                     "file_type",
                     "file_size",
                     "creation_date",
                     "last_modified_date",
                     "last_accessed_date"
                 ],
-                "id_": "22435b6d-65df-468c-9182-fac723f842e7",
+                "id_": "881801b1-c607-45a9-a6af-97d59eff8cac",
                 "metadata": {
-                    "creation_date": "2024-05-06",
+                    "creation_date": "2024-05-14",
                     "file_name": "sample.txt",
                     "file_path": "/Users/kshitizvijayvargiya/demo-repository/packages_otel/tests/data/sample.txt",
                     "file_size": 24,
                     "file_type": "text/plain",
                     "last_modified_date": "2024-04-16"
                 },
                 "metadata_seperator": "\n",
                 "metadata_template": "{key}: {value}",
                 "relationships": {
                     "1": {
                         "class_name": "RelatedNodeInfo",
-                        "hash": "82571e28d993d1c36c4706cc9120dc71dd6d4f8103c3b695442cd20040b1c211",
+                        "hash": "cbb693f3d34ee36c5f2f485bfe21fef4240daf1796eb57939d19404fb8289dc3",
                         "metadata": {
-                            "creation_date": "2024-05-06",
+                            "creation_date": "2024-05-14",
                             "file_name": "sample.txt",
                             "file_path": "/Users/kshitizvijayvargiya/demo-repository/packages_otel/tests/data/sample.txt",
                             "file_size": 24,
                             "file_type": "text/plain",
                             "last_modified_date": "2024-04-16"
                         },
-                        "node_id": "6508ce76-0aa0-4994-94c4-5f30c5c6de0c",
+                        "node_id": "9b1f05bd-271c-451c-a3f7-9ff70cf1ac75",
                         "node_type": "4"
                     }
                 },
                 "start_char_idx": 0,
                 "text": "this is some sample text",
                 "text_template": "{metadata_str}\n\n{content}"
             },
             "__type__": "1"
         }
     },
     "docstore/metadata": {
-        "22435b6d-65df-468c-9182-fac723f842e7": {
-            "doc_hash": "82571e28d993d1c36c4706cc9120dc71dd6d4f8103c3b695442cd20040b1c211",
-            "ref_doc_id": "6508ce76-0aa0-4994-94c4-5f30c5c6de0c"
+        "881801b1-c607-45a9-a6af-97d59eff8cac": {
+            "doc_hash": "cbb693f3d34ee36c5f2f485bfe21fef4240daf1796eb57939d19404fb8289dc3",
+            "ref_doc_id": "9b1f05bd-271c-451c-a3f7-9ff70cf1ac75"
         },
-        "6508ce76-0aa0-4994-94c4-5f30c5c6de0c": {
-            "doc_hash": "82571e28d993d1c36c4706cc9120dc71dd6d4f8103c3b695442cd20040b1c211"
+        "9b1f05bd-271c-451c-a3f7-9ff70cf1ac75": {
+            "doc_hash": "cbb693f3d34ee36c5f2f485bfe21fef4240daf1796eb57939d19404fb8289dc3"
         }
     },
     "docstore/ref_doc_info": {
-        "6508ce76-0aa0-4994-94c4-5f30c5c6de0c": {
+        "9b1f05bd-271c-451c-a3f7-9ff70cf1ac75": {
             "metadata": {
-                "creation_date": "2024-05-06",
+                "creation_date": "2024-05-14",
                 "file_name": "sample.txt",
                 "file_path": "/Users/kshitizvijayvargiya/demo-repository/packages_otel/tests/data/sample.txt",
                 "file_size": 24,
                 "file_type": "text/plain",
                 "last_modified_date": "2024-04-16"
             },
             "node_ids": [
-                "22435b6d-65df-468c-9182-fac723f842e7"
+                "881801b1-c607-45a9-a6af-97d59eff8cac"
             ]
         }
     }
 }
```

### Comparing `okahu_observability-0.0.3/.gitignore` & `okahu_observability-0.0.4/.gitignore`

 * *Files identical despite different names*

### Comparing `okahu_observability-0.0.3/LICENSE` & `okahu_observability-0.0.4/LICENSE`

 * *Files identical despite different names*

### Comparing `okahu_observability-0.0.3/README.md` & `okahu_observability-0.0.4/README.md`

 * *Files identical despite different names*

### Comparing `okahu_observability-0.0.3/pyproject.toml` & `okahu_observability-0.0.4/pyproject.toml`

 * *Files 1% similar despite different names*

```diff
@@ -1,14 +1,14 @@
 [build-system]
 requires = ["hatchling"]
 build-backend = "hatchling.build"
 
 [project]
 name = "okahu-observability"
-version = "0.0.3"
+version = "0.0.4"
 authors = [
   { name="Okahu Inc.", email="okahu-pypi@okahu.ai" },
 ]
 description = "package with okahu opentelemetry"
 readme = "README.md"
 requires-python = ">=3.8"
 classifiers = [
```

### Comparing `okahu_observability-0.0.3/PKG-INFO` & `okahu_observability-0.0.4/PKG-INFO`

 * *Files 7% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.3
 Name: okahu-observability
-Version: 0.0.3
+Version: 0.0.4
 Summary: package with okahu opentelemetry
 Project-URL: Homepage, https://github.com/okahu/demo-repository
 Project-URL: Issues, https://github.com/okahu/demo-repository/issues
 Author-email: "Okahu Inc." <okahu-pypi@okahu.ai>
 License-File: LICENSE
 Classifier: License :: OSI Approved :: MIT License
 Classifier: Operating System :: OS Independent
```

