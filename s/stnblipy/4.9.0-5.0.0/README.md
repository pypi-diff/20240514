# Comparing `tmp/stnblipy-4.9.0.tar.gz` & `tmp/stnblipy-5.0.0.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "dist\stnblipy-4.9.0.tar", last modified: Fri Mar 10 18:31:41 2023, max compression
+gzip compressed data, was "dist\stnblipy-5.0.0.tar", last modified: Tue May 14 17:44:08 2024, max compression
```

## Comparing `stnblipy-4.9.0.tar` & `stnblipy-5.0.0.tar`

### file list

```diff
@@ -1,29 +1,33 @@
-drwxrwxrwx   0        0        0        0 2023-03-10 18:31:41.000000 stnblipy-4.9.0/
--rw-rw-rw-   0        0        0      404 2023-03-10 18:31:41.000000 stnblipy-4.9.0/PKG-INFO
-drwxrwxrwx   0        0        0        0 2023-03-10 18:31:41.000000 stnblipy-4.9.0/blipy/
--rw-rw-rw-   0        0        0        0 2022-07-22 17:59:57.000000 stnblipy-4.9.0/blipy/__init__.py
--rw-rw-rw-   0        0        0     2730 2023-01-23 12:02:58.000000 stnblipy-4.9.0/blipy/arquivo_csv.py
--rw-rw-rw-   0        0        0    15166 2023-03-09 14:17:02.000000 stnblipy-4.9.0/blipy/conexao_bd.py
--rw-rw-rw-   0        0        0      335 2022-07-22 17:59:57.000000 stnblipy-4.9.0/blipy/enum_tipo_col_bd.py
--rw-rw-rw-   0        0        0     2135 2022-07-22 17:59:57.000000 stnblipy-4.9.0/blipy/erro.py
--rw-rw-rw-   0        0        0    17576 2023-01-25 11:44:53.000000 stnblipy-4.9.0/blipy/func_transformacao.py
--rw-rw-rw-   0        0        0    21110 2023-03-03 16:03:48.000000 stnblipy-4.9.0/blipy/job.py
--rw-rw-rw-   0        0        0     4650 2023-01-05 14:22:36.000000 stnblipy-4.9.0/blipy/planilha.py
--rw-rw-rw-   0        0        0     2759 2022-07-22 17:59:57.000000 stnblipy-4.9.0/blipy/profiling.py
--rw-rw-rw-   0        0        0     3138 2022-10-26 16:03:07.000000 stnblipy-4.9.0/blipy/tabela_dataframe.py
--rw-rw-rw-   0        0        0     4885 2023-02-03 14:55:21.000000 stnblipy-4.9.0/blipy/tabela_entrada.py
--rw-rw-rw-   0        0        0     1538 2022-10-26 15:56:30.000000 stnblipy-4.9.0/blipy/tabela_html.py
--rw-rw-rw-   0        0        0     8711 2023-03-09 14:17:02.000000 stnblipy-4.9.0/blipy/tabela_saida.py
--rw-rw-rw-   0        0        0     7311 2023-03-10 18:27:46.000000 stnblipy-4.9.0/blipy/utils.py
--rw-rw-rw-   0        0        0       42 2023-03-10 18:31:41.000000 stnblipy-4.9.0/setup.cfg
--rw-rw-rw-   0        0        0     1048 2023-03-10 18:29:46.000000 stnblipy-4.9.0/setup.py
-drwxrwxrwx   0        0        0        0 2023-03-10 18:31:41.000000 stnblipy-4.9.0/stnblipy.egg-info/
--rw-rw-rw-   0        0        0      404 2023-03-10 18:31:40.000000 stnblipy-4.9.0/stnblipy.egg-info/PKG-INFO
--rw-rw-rw-   0        0        0      528 2023-03-10 18:31:40.000000 stnblipy-4.9.0/stnblipy.egg-info/SOURCES.txt
--rw-rw-rw-   0        0        0        1 2023-03-10 18:31:40.000000 stnblipy-4.9.0/stnblipy.egg-info/dependency_links.txt
--rw-rw-rw-   0        0        0      168 2023-03-10 18:31:40.000000 stnblipy-4.9.0/stnblipy.egg-info/requires.txt
--rw-rw-rw-   0        0        0        6 2023-03-10 18:31:40.000000 stnblipy-4.9.0/stnblipy.egg-info/top_level.txt
-drwxrwxrwx   0        0        0        0 2023-03-10 18:31:41.000000 stnblipy-4.9.0/test/
--rw-rw-rw-   0        0        0    26651 2023-03-09 14:17:02.000000 stnblipy-4.9.0/test/teste_conexao_json.py
--rw-rw-rw-   0        0        0    20808 2022-08-17 17:16:30.000000 stnblipy-4.9.0/test/teste_job.py
--rw-rw-rw-   0        0        0     2287 2022-07-22 17:59:57.000000 stnblipy-4.9.0/test/testes_classe_planilha.py
+drwxrwxrwx   0        0        0        0 2024-05-14 17:44:08.000000 stnblipy-5.0.0/
+-rw-rw-rw-   0        0        0      385 2024-05-14 17:44:08.000000 stnblipy-5.0.0/PKG-INFO
+drwxrwxrwx   0        0        0        0 2024-05-14 17:44:07.000000 stnblipy-5.0.0/blipy/
+-rw-rw-rw-   0        0        0        0 2022-07-22 17:59:57.000000 stnblipy-5.0.0/blipy/__init__.py
+-rw-rw-rw-   0        0        0     2699 2024-05-14 17:37:14.000000 stnblipy-5.0.0/blipy/arquivo_csv.py
+-rw-rw-rw-   0        0        0     2457 2024-05-14 17:37:14.000000 stnblipy-5.0.0/blipy/arquivo_posicional.py
+-rw-rw-rw-   0        0        0    15272 2024-01-31 20:22:27.000000 stnblipy-5.0.0/blipy/conexao_bd.py
+-rw-rw-rw-   0        0        0      335 2022-07-22 17:59:57.000000 stnblipy-5.0.0/blipy/enum_tipo_col_bd.py
+-rw-rw-rw-   0        0        0     2135 2022-07-22 17:59:57.000000 stnblipy-5.0.0/blipy/erro.py
+-rw-rw-rw-   0        0        0    32144 2024-05-14 17:37:14.000000 stnblipy-5.0.0/blipy/func_transformacao.py
+-rw-rw-rw-   0        0        0    69255 2024-05-14 17:37:15.000000 stnblipy-5.0.0/blipy/job.py
+-rw-rw-rw-   0        0        0     5673 2024-03-20 14:04:38.000000 stnblipy-5.0.0/blipy/jsonstring.py
+-rw-rw-rw-   0        0        0     4799 2024-05-14 17:37:15.000000 stnblipy-5.0.0/blipy/planilha.py
+-rw-rw-rw-   0        0        0     2759 2022-07-22 17:59:57.000000 stnblipy-5.0.0/blipy/profiling.py
+-rw-rw-rw-   0        0        0     3982 2024-05-14 17:37:15.000000 stnblipy-5.0.0/blipy/tabela_dataframe.py
+-rw-rw-rw-   0        0        0     4885 2023-09-20 15:10:58.000000 stnblipy-5.0.0/blipy/tabela_entrada.py
+-rw-rw-rw-   0        0        0     1607 2024-05-14 17:37:15.000000 stnblipy-5.0.0/blipy/tabela_html.py
+-rw-rw-rw-   0        0        0    13498 2024-05-14 17:37:15.000000 stnblipy-5.0.0/blipy/tabela_saida.py
+-rw-rw-rw-   0        0        0     7311 2023-03-10 18:27:46.000000 stnblipy-5.0.0/blipy/utils.py
+-rw-rw-rw-   0        0        0       42 2024-05-14 17:44:08.000000 stnblipy-5.0.0/setup.cfg
+-rw-rw-rw-   0        0        0     1029 2024-05-14 17:37:53.000000 stnblipy-5.0.0/setup.py
+drwxrwxrwx   0        0        0        0 2024-05-14 17:44:07.000000 stnblipy-5.0.0/stnblipy.egg-info/
+-rw-rw-rw-   0        0        0      385 2024-05-14 17:44:07.000000 stnblipy-5.0.0/stnblipy.egg-info/PKG-INFO
+-rw-rw-rw-   0        0        0      634 2024-05-14 17:44:07.000000 stnblipy-5.0.0/stnblipy.egg-info/SOURCES.txt
+-rw-rw-rw-   0        0        0        1 2024-05-14 17:44:07.000000 stnblipy-5.0.0/stnblipy.egg-info/dependency_links.txt
+-rw-rw-rw-   0        0        0      168 2024-05-14 17:44:07.000000 stnblipy-5.0.0/stnblipy.egg-info/requires.txt
+-rw-rw-rw-   0        0        0        6 2024-05-14 17:44:07.000000 stnblipy-5.0.0/stnblipy.egg-info/top_level.txt
+drwxrwxrwx   0        0        0        0 2024-05-14 17:44:08.000000 stnblipy-5.0.0/test/
+-rw-rw-rw-   0        0        0    32979 2024-01-31 20:22:28.000000 stnblipy-5.0.0/test/teste_conexao_json.py
+-rw-rw-rw-   0        0        0     5791 2024-01-31 20:22:28.000000 stnblipy-5.0.0/test/teste_estrategias_atualizacao.py
+-rw-rw-rw-   0        0        0    22197 2024-05-14 17:37:15.000000 stnblipy-5.0.0/test/teste_geral.py
+-rw-rw-rw-   0        0        0    20808 2022-08-17 17:16:30.000000 stnblipy-5.0.0/test/teste_job.py
+-rw-rw-rw-   0        0        0     2287 2022-07-22 17:59:57.000000 stnblipy-5.0.0/test/testes_classe_planilha.py
```

### Comparing `stnblipy-4.9.0/blipy/arquivo_csv.py` & `stnblipy-5.0.0/blipy/arquivo_csv.py`

 * *Files 2% similar despite different names*

```diff
@@ -27,16 +27,15 @@
 
         Referência: https://pandas.pydata.org/docs/reference/api/pandas.read_csv.html
 
         Args:
         arquivo:    caminho (path) do arquivo. Formato esperado: 
                     C:/.../arquivo.csv
         header:     linhas de cabeçalho a serem ignoradas, 0-indexed
-        skipfooter: linhas de rodapé (final arquivo) a serem ignoradas,
-                    0-indexed.
+        skipfooter: linhas de rodapé  a serem ignoradas, 0-indexed.
         names:      lista de nomes de colunas. Se arquivo não contém header,
                     deve-se obrigatoriamente setar header=None
         index_col:  coluna a ser usada como label das linhas
         usecols:    seleção de colunas. Tipos de seleção: 'A,B,C', [0,1,2],
                     ['ID','Coluna_1','Coluna_4']
         skiprows:   linhas a serem ignoradas no início do arquivo, 0-indexed
         nrows:      número de linhas a serem carregadas
@@ -58,12 +57,12 @@
                     names=names, index_col=index_col, usecols=usecols, 
                     skiprows=skiprows, nrows=nrows, na_values=na_values, 
                     engine=engine, 
                     sep=sep, decimal=decimal, thousands=thousands, 
                     dtype=dtype,
                     encoding=encoding)
         except FileNotFoundError:
-            self.e._("Não foi possível abrir o arquivo " + io + ".")
+            self.e._("Não foi possível abrir o arquivo " + arquivo + ".")
             raise
 
         self._nome = arquivo
```

### Comparing `stnblipy-4.9.0/blipy/conexao_bd.py` & `stnblipy-5.0.0/blipy/conexao_bd.py`

 * *Files 1% similar despite different names*

```diff
@@ -75,874 +75,881 @@
 000004a0: 7320 646f 206d c3a9 746f 646f 2064 6520  s do m..todo de 
 000004b0: 636c 6173 7365 2066 726f 6d5f 6a73 6f6e  classe from_json
 000004c0: 2e0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
 000004d0: 0d0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
 000004e0: 5f63 6f6e 6578 616f 203d 204e 6f6e 650d  _conexao = None.
 000004f0: 0a20 2020 2020 2020 2073 656c 662e 5f5f  .        self.__
 00000500: 7469 706f 5f63 6f6e 6578 616f 203d 2074  tipo_conexao = t
-00000510: 6970 6f0d 0a0d 0a20 2020 2020 2020 2074  ipo....        t
-00000520: 7279 3a0d 0a20 2020 2020 2020 2020 2020  ry:..           
-00000530: 2069 6620 7469 706f 203d 3d20 226f 7261   if tipo == "ora
-00000540: 636c 6522 3a0d 0a20 2020 2020 2020 2020  cle":..         
-00000550: 2020 2020 2020 2063 7374 7220 3d20 226f         cstr = "o
-00000560: 7261 636c 653a 2f2f 2220 2b20 2020 2075  racle://" +    u
-00000570: 7365 7220 2b20 223a 2220 2b20 2020 2020  ser + ":" +     
-00000580: 2020 2020 2020 2020 2020 205c 0d0a 2020             \..  
-00000590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000005a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000005b0: 2020 2020 2020 7077 6420 2b20 2240 2220        pwd + "@" 
-000005c0: 2b20 2020 2020 2020 2020 2020 2020 2020  +               
-000005d0: 2020 5c0d 0a20 2020 2020 2020 2020 2020    \..           
+00000510: 6970 6f0d 0a20 2020 2020 2020 2073 656c  ipo..        sel
+00000520: 662e 5f5f 7573 7561 7269 6f20 3d20 7573  f.__usuario = us
+00000530: 6572 0d0a 0d0a 2020 2020 2020 2020 7472  er....        tr
+00000540: 793a 0d0a 2020 2020 2020 2020 2020 2020  y:..            
+00000550: 6966 2074 6970 6f20 3d3d 2022 6f72 6163  if tipo == "orac
+00000560: 6c65 223a 0d0a 2020 2020 2020 2020 2020  le":..          
+00000570: 2020 2020 2020 6373 7472 203d 2022 6f72        cstr = "or
+00000580: 6163 6c65 3a2f 2f22 202b 2020 2020 7573  acle://" +    us
+00000590: 6572 202b 2022 3a22 202b 2020 2020 2020  er + ":" +      
+000005a0: 2020 2020 2020 2020 2020 5c0d 0a20 2020            \..   
+000005b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000005c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000005d0: 2020 2020 2070 7764 202b 2022 4022 202b       pwd + "@" +
 000005e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000005f0: 2020 2020 2020 2020 2020 2020 2069 7020               ip 
-00000600: 2b20 223a 2220 2b20 2020 2020 2020 2020  + ":" +         
-00000610: 2020 2020 2020 2020 205c 0d0a 2020 2020           \..    
-00000620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000640: 2020 2020 706f 7274 202b 2022 2f3f 7365      port + "/?se
-00000650: 7276 6963 655f 6e61 6d65 3d22 202b 2020  rvice_name=" +  
-00000660: 5c0d 0a20 2020 2020 2020 2020 2020 2020  \..             
-00000670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000680: 2020 2020 2020 2020 2020 2073 6572 7669             servi
-00000690: 6365 5f6e 616d 650d 0a0d 0a20 2020 2020  ce_name....     
-000006a0: 2020 2020 2020 2020 2020 2065 6e67 696e             engin
-000006b0: 6520 3d20 6372 6561 7465 5f65 6e67 696e  e = create_engin
-000006c0: 6528 2063 7374 722c 200d 0a20 2020 2020  e( cstr, ..     
-000006d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000006e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000006f0: 2020 2063 6f6e 7665 7274 5f75 6e69 636f     convert_unico
-00000700: 6465 3d54 7275 652c 200d 0a20 2020 2020  de=True, ..     
-00000710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000730: 2020 2063 6f6e 6e65 6374 5f61 7267 733d     connect_args=
-00000740: 7b22 656e 636f 6469 6e67 223a 2022 5554  {"encoding": "UT
-00000750: 462d 3822 7d29 0d0a 0d0a 2020 2020 2020  F-8"})....      
-00000760: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00000770: 5f63 6f6e 6578 616f 203d 2065 6e67 696e  _conexao = engin
-00000780: 652e 636f 6e6e 6563 7428 290d 0a20 2020  e.connect()..   
-00000790: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-000007a0: 662e 5f5f 636f 6e65 7861 6f5f 7261 775f  f.__conexao_raw_
-000007b0: 6f72 6163 6c65 203d 2065 6e67 696e 652e  oracle = engine.
-000007c0: 7261 775f 636f 6e6e 6563 7469 6f6e 2829  raw_connection()
-000007d0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-000007e0: 656c 6966 2074 6970 6f20 3d3d 2022 6a64  elif tipo == "jd
-000007f0: 7622 3a0d 0a20 2020 2020 2020 2020 2020  v":..           
-00000800: 2020 2020 206a 766d 5f70 6174 6820 3d20       jvm_path = 
-00000810: 6a70 7970 652e 6765 7444 6566 6175 6c74  jpype.getDefault
-00000820: 4a56 4d50 6174 6828 290d 0a20 2020 2020  JVMPath()..     
-00000830: 2020 2020 2020 2020 2020 206a 7079 7065             jpype
-00000840: 2e61 6464 436c 6173 7350 6174 6828 636c  .addClassPath(cl
-00000850: 6173 735f 7061 7468 290d 0a20 2020 2020  ass_path)..     
-00000860: 2020 2020 2020 2020 2020 206a 7079 7065             jpype
-00000870: 2e73 7461 7274 4a56 4d28 6a76 6d5f 7061  .startJVM(jvm_pa
-00000880: 7468 2c20 7061 7261 6d73 5f6a 766d 290d  th, params_jvm).
-00000890: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-000008a0: 2020 2073 656c 662e 5f5f 636f 6e65 7861     self.__conexa
-000008b0: 6f20 3d20 636f 6e6e 6563 745f 6a64 7628  o = connect_jdv(
-000008c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000008d0: 2020 2020 2020 2020 2020 6a64 6263 5f64            jdbc_d
-000008e0: 7269 7665 722c 206a 6462 635f 7572 6c2c  river, jdbc_url,
-000008f0: 205b 7573 6572 2c20 7077 645d 2c20 6a61   [user, pwd], ja
-00000900: 725f 6669 6c65 290d 0a20 2020 2020 2020  r_file)..       
-00000910: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-00000920: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00000930: 5f5f 6375 7273 6f72 5f6a 6476 203d 204e  __cursor_jdv = N
-00000940: 6f6e 650d 0a0d 0a20 2020 2020 2020 2020  one....         
-00000950: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00000960: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00000970: 4578 6365 7074 696f 6e28 2254 6970 6f20  Exception("Tipo 
-00000980: 6465 2063 6f6e 6578 c3a3 6f20 696e 76c3  de conex..o inv.
-00000990: a16c 6964 6f2e 2229 0d0a 0d0a 2020 2020  .lido.")....    
-000009a0: 2020 2020 6578 6365 7074 2045 7863 6570      except Excep
-000009b0: 7469 6f6e 2061 7320 6572 723a 0d0a 2020  tion as err:..  
-000009c0: 2020 2020 2020 2020 2020 7365 6c66 2e65            self.e
-000009d0: 2e5f 2820 2020 2245 7272 6f20 616f 2063  ._(   "Erro ao c
-000009e0: 6f6e 6563 7461 7220 636f 6d20 6f20 6261  onectar com o ba
-000009f0: 6e63 6f20 6465 2064 6164 6f73 2e22 0d0a  nco de dados."..
-00000a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000a10: 2020 2020 2020 2020 225c 6e44 6574 616c          "\nDetal
-00000a20: 6865 7320 646f 2065 7272 6f3a 5c6e 2220  hes do erro:\n" 
-00000a30: 2b20 7374 7228 6572 7229 290d 0a20 2020  + str(err))..   
-00000a40: 2020 2020 2020 2020 2072 6169 7365 2052           raise R
-00000a50: 756e 7469 6d65 4572 726f 720d 0a0d 0a20  untimeError.... 
-00000a60: 2020 2064 6566 205f 5f64 656c 5f5f 2873     def __del__(s
-00000a70: 656c 6629 3a0d 0a20 2020 2020 2020 2069  elf):..        i
-00000a80: 6620 7365 6c66 2e5f 5f63 6f6e 6578 616f  f self.__conexao
-00000a90: 2021 3d20 4e6f 6e65 2061 6e64 205c 0d0a   != None and \..
-00000aa0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00000ab0: 5f5f 7469 706f 5f63 6f6e 6578 616f 2021  __tipo_conexao !
-00000ac0: 3d20 226a 6476 223a 0d0a 0d0a 2020 2020  = "jdv":....    
-00000ad0: 2020 2020 2020 2020 7472 793a 0d0a 2020          try:..  
-00000ae0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00000af0: 73c3 b320 6665 6368 6120 6120 636f 6e65  s.. fecha a cone
-00000b00: 78c3 a36f 2065 7870 6c69 6369 7461 6d65  x..o explicitame
-00000b10: 6e74 6520 7365 206e c3a3 6f20 666f 7220  nte se n..o for 
-00000b20: 4a44 562c 2070 6f69 7320 7365 0d0a 2020  JDV, pois se..  
-00000b30: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00000b40: 666f 7220 4a44 562c 206e 6f20 6d6f 6d65  for JDV, no mome
-00000b50: 6e74 6f20 656d 2071 7565 2065 7374 6520  nto em que este 
-00000b60: 6465 7374 7275 746f 7220 c3a9 2063 6861  destrutor .. cha
-00000b70: 6d61 646f 2061 204a 564d 0d0a 2020 2020  mado a JVM..    
-00000b80: 2020 2020 2020 2020 2020 2020 2320 6ac3              # j.
-00000b90: a120 6ec3 a36f 2065 7374 c3a1 206d 6169  . n..o est.. mai
-00000ba0: 7320 726f 6461 6e64 6f20 6520 706f 7274  s rodando e port
-00000bb0: 616e 746f 2066 6563 6861 7220 6120 636f  anto fechar a co
-00000bc0: 6e65 78c3 a36f 204a 4456 0d0a 2020 2020  nex..o JDV..    
-00000bd0: 2020 2020 2020 2020 2020 2020 2320 6171              # aq
-00000be0: 7569 2067 6572 6172 6961 2075 6d61 2065  ui geraria uma e
-00000bf0: 7863 65c3 a7c3 a36f 0d0a 2020 2020 2020  xce....o..      
-00000c00: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00000c10: 5f63 6f6e 6578 616f 2e63 6c6f 7365 2829  _conexao.close()
-00000c20: 0d0a 2020 2020 2020 2020 2020 2020 6578  ..            ex
-00000c30: 6365 7074 2045 7863 6570 7469 6f6e 2061  cept Exception a
-00000c40: 7320 6572 723a 0d0a 2020 2020 2020 2020  s err:..        
-00000c50: 2020 2020 2020 2020 7365 6c66 2e65 2e5f          self.e._
-00000c60: 2820 2020 2245 7272 6f20 616f 2066 6563  (   "Erro ao fec
-00000c70: 6861 7220 636f 6e65 78c3 a36f 2063 6f6d  har conex..o com
-00000c80: 206f 2062 616e 636f 2064 6520 6461 646f   o banco de dado
-00000c90: 732e 220d 0a20 2020 2020 2020 2020 2020  s."..           
-00000ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000cb0: 2022 5c6e 4465 7461 6c68 6573 2064 6f20   "\nDetalhes do 
-00000cc0: 6572 726f 3a5c 6e22 202b 2073 7472 2865  erro:\n" + str(e
-00000cd0: 7272 2929 0d0a 2020 2020 2020 2020 2020  rr))..          
-00000ce0: 2020 2020 2020 7261 6973 6520 5275 6e74        raise Runt
-00000cf0: 696d 6545 7272 6f72 0d0a 0d0a 2020 2020  imeError....    
-00000d00: 4063 6c61 7373 6d65 7468 6f64 0d0a 2020  @classmethod..  
-00000d10: 2020 6465 6620 6672 6f6d 5f6a 736f 6e28    def from_json(
-00000d20: 636c 732c 2063 6f6e 6578 6f65 733d 5b5d  cls, conexoes=[]
-00000d30: 293a 0d0a 2020 2020 2020 2020 2222 220d  ):..        """.
-00000d40: 0a20 2020 2020 2020 2043 6f6e 7374 72c3  .        Constr.
-00000d50: b369 206f 626a 6574 6f73 2064 6520 636f  .i objetos de co
-00000d60: 6e65 78c3 a36f 2063 6f6d 206f 2062 616e  nex..o com o ban
-00000d70: 636f 2061 2070 6172 7469 7220 6465 2075  co a partir de u
-00000d80: 6d20 4a53 4f4e 2064 650d 0a20 2020 2020  m JSON de..     
-00000d90: 2020 2063 6f6e 6669 6775 7261 c3a7 c3a3     configura....
-00000da0: 6f20 7175 6520 6573 7465 6a61 206e 6f20  o que esteja no 
-00000db0: 6469 7265 74c3 b372 696f 206f 6e64 6520  diret..rio onde 
-00000dc0: 6f20 7363 7269 7074 2065 7374 c3a1 2073  o script est.. s
-00000dd0: 656e 646f 0d0a 2020 2020 2020 2020 6578  endo..        ex
-00000de0: 6563 7574 6164 6f20 6520 6465 2075 6d61  ecutado e de uma
-00000df0: 2076 6172 69c3 a176 656c 2064 6520 616d   vari..vel de am
-00000e00: 6269 656e 7465 2071 7565 2063 6f6e 7465  biente que conte
-00000e10: 6e68 6120 6128 7329 2073 656e 6861 2873  nha a(s) senha(s
-00000e20: 290d 0a20 2020 2020 2020 2064 6f28 7329  )..        do(s)
-00000e30: 2065 7371 7565 6d61 2873 292e 0d0a 0d0a   esquema(s).....
-00000e40: 2020 2020 2020 2020 4f20 4a53 4f4e 2073          O JSON s
-00000e50: 6520 6368 616d 6172 c3a1 2027 636f 6e65  e chamar.. 'cone
-00000e60: 786f 6573 5f62 642e 6a73 6f6e 2720 6520  xoes_bd.json' e 
-00000e70: 7465 72c3 a120 6f20 7365 6775 696e 7465  ter.. o seguinte
-00000e80: 2066 6f72 6d61 746f 3a0d 0a20 2020 2020   formato:..     
-00000e90: 2020 207b 0d0a 2020 2020 2020 2020 2020     {..          
-00000ea0: 2020 2263 6f6e 6578 6f65 7322 3a20 5b0d    "conexoes": [.
-00000eb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00000ec0: 207b 0d0a 2020 2020 2020 2020 2020 2020   {..            
-00000ed0: 2020 2020 2020 2020 226f 7264 656d 223a          "ordem":
-00000ee0: 203c 6f72 6465 6d3e 2c20 0d0a 2020 2020   <ordem>, ..    
-00000ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000f00: 2274 6970 6f22 3a20 226f 7261 636c 6522  "tipo": "oracle"
-00000f10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00000f20: 2020 2020 2020 2275 7365 7222 3a20 223c        "user": "<
-00000f30: 7573 75c3 a172 696f 3e22 2c20 0d0a 2020  usu..rio>", ..  
-00000f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000f50: 2020 2270 7764 223a 2022 3c6e 6f6d 6520    "pwd": "<nome 
-00000f60: 6461 2076 6172 69c3 a176 656c 2064 6520  da vari..vel de 
-00000f70: 616d 6269 656e 7465 2063 6f6d 2061 2073  ambiente com a s
-00000f80: 656e 6861 3e22 0d0a 2020 2020 2020 2020  enha>"..        
-00000f90: 2020 2020 2020 2020 2020 2020 2269 7022              "ip"
-00000fa0: 3a20 223c 6970 3e22 2c20 0d0a 2020 2020  : "<ip>", ..    
-00000fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000fc0: 2270 6f72 7422 3a20 223c 6ec3 ba6d 6572  "port": "<n..mer
-00000fd0: 6f20 6461 2070 6f72 7461 3e22 2c20 0d0a  o da porta>", ..
-00000fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000ff0: 2020 2020 2273 6572 7669 6365 5f6e 616d      "service_nam
-00001000: 6522 3a20 223c 7365 7276 6963 655f 6e61  e": "<service_na
-00001010: 6d65 3e22 2c0d 0a20 2020 2020 2020 2020  me>",..         
-00001020: 2020 2020 2020 207d 2c0d 0a20 2020 2020         },..     
-00001030: 2020 2020 2020 2020 2020 207b 0d0a 2020             {..  
-00001040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001050: 2020 226f 7264 656d 223a 203c 6f72 6465    "ordem": <orde
-00001060: 6d3e 2c20 0d0a 2020 2020 2020 2020 2020  m>, ..          
-00001070: 2020 2020 2020 2020 2020 2274 6970 6f22            "tipo"
-00001080: 3a20 226a 6476 220d 0a20 2020 2020 2020  : "jdv"..       
-00001090: 2020 2020 2020 2020 2020 2020 2022 7573               "us
-000010a0: 6572 223a 2022 3c75 7375 c3a1 7269 6f3e  er": "<usu..rio>
-000010b0: 222c 200d 0a20 2020 2020 2020 2020 2020  ", ..           
-000010c0: 2020 2020 2020 2020 2022 7077 6422 3a20           "pwd": 
-000010d0: 223c 6e6f 6d65 2064 6120 7661 7269 c3a1  "<nome da vari..
-000010e0: 7665 6c20 6465 2061 6d62 6965 6e74 6520  vel de ambiente 
-000010f0: 636f 6d20 6120 7365 6e68 613e 220d 0a20  com a senha>".. 
-00001100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001110: 2020 2022 636c 6173 735f 7061 7468 223a     "class_path":
-00001120: 203c 636c 6173 7320 7061 7468 2070 6172   <class path par
-00001130: 6120 696e 7374 616e 6369 61c3 a7c3 a36f  a instancia....o
-00001140: 2064 6120 4a56 4d3e 2c0d 0a20 2020 2020   da JVM>,..     
-00001150: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00001160: 7061 7261 6d73 5f6a 766d 223a 203c 7061  params_jvm": <pa
-00001170: 72c3 a26d 6574 726f 7320 6164 6963 696f  r..metros adicio
-00001180: 6e61 6973 2064 6120 4a56 4d3e 2c0d 0a20  nais da JVM>,.. 
-00001190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000011a0: 2020 2022 6a64 6263 5f64 7269 7665 7222     "jdbc_driver"
-000011b0: 3a20 3c63 616d 696e 686f 2065 206e 6f6d  : <caminho e nom
-000011c0: 6520 646f 2061 7271 7569 766f 2064 6f20  e do arquivo do 
-000011d0: 6472 6976 6572 204a 4442 433e 2c0d 0a20  driver JDBC>,.. 
-000011e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000011f0: 2020 2022 6a64 6263 5f75 726c 223a 203c     "jdbc_url": <
-00001200: 7572 6c20 646f 204a 4442 433e 2c0d 0a20  url do JDBC>,.. 
-00001210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001220: 2020 2022 6a61 725f 6669 6c65 223a 203c     "jar_file": <
-00001230: 6361 6d69 6e68 6f20 6520 6e6f 6d65 2064  caminho e nome d
-00001240: 6f20 6172 7175 6976 6f20 6a61 7220 646f  o arquivo jar do
-00001250: 204a 4442 433e 0d0a 2020 2020 2020 2020   JDBC>..        
-00001260: 2020 2020 2020 2020 7d2c 0d0a 2020 2020          },..    
-00001270: 2020 2020 2020 2020 2020 2020 7b0d 0a20              {.. 
-00001280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001290: 2e2e 2e2e 2020 6f75 7472 6173 2063 6f6e  ....  outras con
-000012a0: 6578 c3b5 6573 202e 2e2e 2e2e 0d0a 2020  ex..es .......  
-000012b0: 2020 2020 2020 2020 2020 2020 2020 7d0d                }.
-000012c0: 0a20 2020 2020 2020 2020 2020 205d 0d0a  .            ]..
-000012d0: 2020 2020 2020 2020 7d0d 0a0d 0a20 2020          }....   
-000012e0: 2020 2020 204f 2063 616d 706f 206f 7264       O campo ord
-000012f0: 656d 2064 6f20 4a53 4f4e 2063 6f6d 65c3  em do JSON come.
-00001300: a761 2063 6f6d 2031 2e20 4ec3 a36f 2068  .a com 1. N..o h
-00001310: c3a1 206c 696d 6974 6520 6e6f 206e c3ba  .. limite no n..
-00001320: 6d65 726f 2064 6520 636f 6e65 78c3 b565  mero de conex..e
-00001330: 730d 0a20 2020 2020 2020 2070 6f73 73c3  s..        poss.
-00001340: ad76 6569 732e 0d0a 0d0a 2020 2020 2020  .veis.....      
-00001350: 2020 4f73 2074 6970 6f73 2064 6520 636f    Os tipos de co
-00001360: 6e65 78c3 a36f 2070 6f64 656d 2073 6572  nex..o podem ser
-00001370: 2022 6f72 6163 6c65 2220 6f75 2022 6a64   "oracle" ou "jd
-00001380: 7622 2c20 6361 6461 2071 7561 6c20 636f  v", cada qual co
-00001390: 6d20 7365 7573 0d0a 2020 2020 2020 2020  m seus..        
-000013a0: 7061 72c3 a26d 6574 726f 7320 6465 2063  par..metros de c
-000013b0: 6f6e 6578 c3a3 6f20 6573 7065 63c3 ad66  onex..o espec..f
-000013c0: 6669 636f 732e 2053 6520 6ec3 a36f 2069  ficos. Se n..o i
-000013d0: 6e66 6f72 6d61 646f 2c20 636f 6e73 6964  nformado, consid
-000013e0: 6572 612d 7365 206f 0d0a 2020 2020 2020  era-se o..      
-000013f0: 2020 7469 706f 2022 6f72 6163 6c65 222e    tipo "oracle".
-00001400: 0d0a 0d0a 2020 2020 2020 2020 4120 7365  ....        A se
-00001410: 6e68 6120 6465 2063 6164 6120 636f 6e65  nha de cada cone
-00001420: 78c3 a36f 2073 6572 c3a1 206f 6274 6964  x..o ser.. obtid
-00001430: 6120 6461 2076 6172 69c3 a176 656c 2064  a da vari..vel d
-00001440: 6520 616d 6269 656e 7465 2063 756a 6f20  e ambiente cujo 
-00001450: 6e6f 6d65 0d0a 2020 2020 2020 2020 6573  nome..        es
-00001460: 74c3 a120 696e 6469 6361 646f 206e 6f20  t.. indicado no 
-00001470: 7061 72c3 a26d 6574 726f 2022 7077 6422  par..metro "pwd"
-00001480: 2e0d 0a0d 0a20 2020 2020 2020 2041 7267  .....        Arg
-00001490: 733a 0d0a 2020 2020 2020 2020 3a70 6172  s:..        :par
-000014a0: 616d 2063 6f6e 6578 6f65 733a 2061 7272  am conexoes: arr
-000014b0: 6179 2064 6520 696e 7420 636f 6d20 6173  ay de int com as
-000014c0: 2063 6f6e 6578 c3b5 6573 2071 7565 2073   conex..es que s
-000014d0: 6572 c3a3 6f20 636f 6e73 6964 6572 6164  er..o considerad
-000014e0: 6173 0d0a 2020 2020 2020 2020 2863 616d  as..        (cam
-000014f0: 706f 2027 6f72 6465 6d27 2064 6f20 4a53  po 'ordem' do JS
-00001500: 4f4e 292e 2053 6520 6ec3 a36f 2069 6e66  ON). Se n..o inf
-00001510: 6f72 6d61 646f 2c20 746f 6461 7320 6173  ormado, todas as
-00001520: 2063 6f6e 6578 c3b5 6573 2064 6f20 4a53   conex..es do JS
-00001530: 4f4e 0d0a 2020 2020 2020 2020 7365 72c3  ON..        ser.
-00001540: a36f 2063 6f6e 7369 6465 7261 6461 732e  .o consideradas.
-00001550: 0d0a 0d0a 2020 2020 2020 2020 5265 743a  ....        Ret:
-00001560: 0d0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
-00001570: 6e3a 2072 6574 6f72 6e61 2075 6d61 2074  n: retorna uma t
-00001580: 7570 6c61 2063 6f6d 2075 6d20 6f75 206d  upla com um ou m
-00001590: 6169 7320 6f62 6a65 746f 7320 6465 2063  ais objetos de c
-000015a0: 6f6e 6578 c3a3 6f20 636f 6d20 6f0d 0a20  onex..o com o.. 
-000015b0: 2020 2020 2020 2062 616e 636f 2064 6520         banco de 
-000015c0: 6461 646f 732c 206e 6120 6f72 6465 6d20  dados, na ordem 
-000015d0: 6573 7065 6369 6669 6361 6461 206e 6f20  especificada no 
-000015e0: 6361 6d70 6f20 276f 7264 656d 2720 646f  campo 'ordem' do
-000015f0: 204a 534f 4e2e 0d0a 2020 2020 2020 2020   JSON...        
-00001600: 2222 220d 0a0d 0a20 2020 2020 2020 2070  """....        p
-00001610: 6172 616d 5f63 6f6e 6578 6f65 7320 3d20  aram_conexoes = 
-00001620: 5b5d 200d 0a20 2020 2020 2020 2074 7279  [] ..        try
-00001630: 3a0d 0a20 2020 2020 2020 2020 2020 2077  :..            w
-00001640: 6974 6820 6f70 656e 2822 636f 6e65 786f  ith open("conexo
-00001650: 6573 5f62 642e 6a73 6f6e 2229 2061 7320  es_bd.json") as 
-00001660: 663a 0d0a 2020 2020 2020 2020 2020 2020  f:..            
-00001670: 2020 2020 636f 6e65 786f 6573 5f6a 736f      conexoes_jso
-00001680: 6e20 3d20 6a73 6f6e 2e6c 6f61 6428 6629  n = json.load(f)
-00001690: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-000016a0: 2020 2020 2320 636f 6c6f 6361 2061 7320      # coloca as 
-000016b0: 636f 6e65 78c3 b565 7320 6c69 6461 7320  conex..es lidas 
-000016c0: 646f 204a 534f 4e20 6e61 206f 7264 656d  do JSON na ordem
-000016d0: 2064 6120 7475 706c 6120 6465 2072 6574   da tupla de ret
-000016e0: 6f72 6e6f 0d0a 2020 2020 2020 2020 2020  orno..          
-000016f0: 2020 2020 2020 696e 6469 6365 203d 2031        indice = 1
-00001700: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00001710: 2020 7461 6d20 3d20 6c65 6e28 636f 6e65    tam = len(cone
-00001720: 786f 6573 5f6a 736f 6e5b 2263 6f6e 6578  xoes_json["conex
-00001730: 6f65 7322 5d29 0d0a 2020 2020 2020 2020  oes"])..        
-00001740: 2020 2020 2020 2020 7465 726d 696e 6f75          terminou
-00001750: 203d 2046 616c 7365 0d0a 2020 2020 2020   = False..      
-00001760: 2020 2020 2020 2020 2020 7768 696c 6528            while(
-00001770: 5472 7565 293a 0d0a 2020 2020 2020 2020  True):..        
-00001780: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00001790: 636f 6e65 7861 6f20 696e 2063 6f6e 6578  conexao in conex
-000017a0: 6f65 735f 6a73 6f6e 5b22 636f 6e65 786f  oes_json["conexo
-000017b0: 6573 225d 3a0d 0a20 2020 2020 2020 2020  es"]:..         
-000017c0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000017d0: 6620 636f 6e65 7861 6f5b 226f 7264 656d  f conexao["ordem
-000017e0: 225d 203d 3d20 696e 6469 6365 3a0d 0a20  "] == indice:.. 
-000017f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001800: 2020 2020 2020 2020 2020 2069 6620 2063             if  c
-00001810: 6f6e 6578 6f65 7320 3d3d 205b 5d20 6f72  onexoes == [] or
-00001820: 2020 5c0d 0a20 2020 2020 2020 2020 2020    \..           
-00001830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001840: 2020 2020 2063 6f6e 6578 616f 5b22 6f72       conexao["or
-00001850: 6465 6d22 5d20 696e 2063 6f6e 6578 6f65  dem"] in conexoe
-00001860: 733a 0d0a 0d0a 2020 2020 2020 2020 2020  s:....          
-00001870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001880: 2020 2020 2020 7061 7261 6d5f 636f 6e65        param_cone
-00001890: 786f 6573 2e61 7070 656e 6428 636f 6e65  xoes.append(cone
-000018a0: 7861 6f29 0d0a 0d0a 2020 2020 2020 2020  xao)....        
-000018b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000018c0: 2020 2020 696e 6469 6365 202b 3d20 310d      indice += 1.
-000018d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000018e0: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-000018f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001900: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-00001910: 6e64 6963 6520 3e20 7461 6d3a 0d0a 2020  ndice > tam:..  
-00001920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001930: 2020 2020 2020 2020 2020 2020 2020 7465                te
-00001940: 726d 696e 6f75 203d 2054 7275 650d 0a20  rminou = True.. 
-00001950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001960: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00001970: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00001980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001990: 2020 636f 6e74 696e 7565 0d0a 0d0a 2020    continue....  
+000005f0: 205c 0d0a 2020 2020 2020 2020 2020 2020   \..            
+00000600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000610: 2020 2020 2020 2020 2020 2020 6970 202b              ip +
+00000620: 2022 3a22 202b 2020 2020 2020 2020 2020   ":" +          
+00000630: 2020 2020 2020 2020 5c0d 0a20 2020 2020          \..     
+00000640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000660: 2020 2070 6f72 7420 2b20 222f 3f73 6572     port + "/?ser
+00000670: 7669 6365 5f6e 616d 653d 2220 2b20 205c  vice_name=" +  \
+00000680: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00000690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000006a0: 2020 2020 2020 2020 2020 7365 7276 6963            servic
+000006b0: 655f 6e61 6d65 0d0a 0d0a 2020 2020 2020  e_name....      
+000006c0: 2020 2020 2020 2020 2020 656e 6769 6e65            engine
+000006d0: 203d 2063 7265 6174 655f 656e 6769 6e65   = create_engine
+000006e0: 2820 6373 7472 2c20 0d0a 2020 2020 2020  ( cstr, ..      
+000006f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000710: 2020 636f 6e76 6572 745f 756e 6963 6f64    convert_unicod
+00000720: 653d 5472 7565 2c20 0d0a 2020 2020 2020  e=True, ..      
+00000730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000750: 2020 636f 6e6e 6563 745f 6172 6773 3d7b    connect_args={
+00000760: 2265 6e63 6f64 696e 6722 3a20 2255 5446  "encoding": "UTF
+00000770: 2d38 227d 290d 0a0d 0a20 2020 2020 2020  -8"})....       
+00000780: 2020 2020 2020 2020 2073 656c 662e 5f5f           self.__
+00000790: 636f 6e65 7861 6f20 3d20 656e 6769 6e65  conexao = engine
+000007a0: 2e63 6f6e 6e65 6374 2829 0d0a 2020 2020  .connect()..    
+000007b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000007c0: 2e5f 5f63 6f6e 6578 616f 5f72 6177 5f6f  .__conexao_raw_o
+000007d0: 7261 636c 6520 3d20 656e 6769 6e65 2e72  racle = engine.r
+000007e0: 6177 5f63 6f6e 6e65 6374 696f 6e28 290d  aw_connection().
+000007f0: 0a0d 0a20 2020 2020 2020 2020 2020 2065  ...            e
+00000800: 6c69 6620 7469 706f 203d 3d20 226a 6476  lif tipo == "jdv
+00000810: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
+00000820: 2020 2020 6a76 6d5f 7061 7468 203d 206a      jvm_path = j
+00000830: 7079 7065 2e67 6574 4465 6661 756c 744a  pype.getDefaultJ
+00000840: 564d 5061 7468 2829 0d0a 2020 2020 2020  VMPath()..      
+00000850: 2020 2020 2020 2020 2020 6a70 7970 652e            jpype.
+00000860: 6164 6443 6c61 7373 5061 7468 2863 6c61  addClassPath(cla
+00000870: 7373 5f70 6174 6829 0d0a 2020 2020 2020  ss_path)..      
+00000880: 2020 2020 2020 2020 2020 6a70 7970 652e            jpype.
+00000890: 7374 6172 744a 564d 286a 766d 5f70 6174  startJVM(jvm_pat
+000008a0: 682c 2070 6172 616d 735f 6a76 6d29 0d0a  h, params_jvm)..
+000008b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000008c0: 2020 7365 6c66 2e5f 5f63 6f6e 6578 616f    self.__conexao
+000008d0: 203d 2063 6f6e 6e65 6374 5f6a 6476 280d   = connect_jdv(.
+000008e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000008f0: 2020 2020 2020 2020 206a 6462 635f 6472           jdbc_dr
+00000900: 6976 6572 2c20 6a64 6263 5f75 726c 2c20  iver, jdbc_url, 
+00000910: 5b75 7365 722c 2070 7764 5d2c 206a 6172  [user, pwd], jar
+00000920: 5f66 696c 6529 0d0a 2020 2020 2020 2020  _file)..        
+00000930: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00000940: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00000950: 5f63 7572 736f 725f 6a64 7620 3d20 4e6f  _cursor_jdv = No
+00000960: 6e65 0d0a 0d0a 2020 2020 2020 2020 2020  ne....          
+00000970: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+00000980: 2020 2020 2020 2020 2072 6169 7365 2045           raise E
+00000990: 7863 6570 7469 6f6e 2822 5469 706f 2064  xception("Tipo d
+000009a0: 6520 636f 6e65 78c3 a36f 2069 6e76 c3a1  e conex..o inv..
+000009b0: 6c69 646f 2e22 290d 0a0d 0a20 2020 2020  lido.")....     
+000009c0: 2020 2065 7863 6570 7420 4578 6365 7074     except Except
+000009d0: 696f 6e20 6173 2065 7272 3a0d 0a20 2020  ion as err:..   
+000009e0: 2020 2020 2020 2020 2073 656c 662e 652e           self.e.
+000009f0: 5f28 2020 2022 4572 726f 2061 6f20 636f  _(   "Erro ao co
+00000a00: 6e65 6374 6172 2063 6f6d 206f 2062 616e  nectar com o ban
+00000a10: 636f 2064 6520 6461 646f 732e 220d 0a20  co de dados.".. 
+00000a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000a30: 2020 2020 2020 2022 5c6e 4465 7461 6c68         "\nDetalh
+00000a40: 6573 2064 6f20 6572 726f 3a5c 6e22 202b  es do erro:\n" +
+00000a50: 2073 7472 2865 7272 2929 0d0a 2020 2020   str(err))..    
+00000a60: 2020 2020 2020 2020 7261 6973 6520 5275          raise Ru
+00000a70: 6e74 696d 6545 7272 6f72 0d0a 0d0a 2020  ntimeError....  
+00000a80: 2020 6465 6620 5f5f 6465 6c5f 5f28 7365    def __del__(se
+00000a90: 6c66 293a 0d0a 2020 2020 2020 2020 6966  lf):..        if
+00000aa0: 2073 656c 662e 5f5f 636f 6e65 7861 6f20   self.__conexao 
+00000ab0: 213d 204e 6f6e 6520 616e 6420 5c0d 0a20  != None and \.. 
+00000ac0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00000ad0: 5f74 6970 6f5f 636f 6e65 7861 6f20 213d  _tipo_conexao !=
+00000ae0: 2022 6a64 7622 3a0d 0a0d 0a20 2020 2020   "jdv":....     
+00000af0: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
+00000b00: 2020 2020 2020 2020 2020 2020 2023 2073               # s
+00000b10: c3b3 2066 6563 6861 2061 2063 6f6e 6578  .. fecha a conex
+00000b20: c3a3 6f20 6578 706c 6963 6974 616d 656e  ..o explicitamen
+00000b30: 7465 2073 6520 6ec3 a36f 2066 6f72 204a  te se n..o for J
+00000b40: 4456 2c20 706f 6973 2073 650d 0a20 2020  DV, pois se..   
+00000b50: 2020 2020 2020 2020 2020 2020 2023 2066               # f
+00000b60: 6f72 204a 4456 2c20 6e6f 206d 6f6d 656e  or JDV, no momen
+00000b70: 746f 2065 6d20 7175 6520 6573 7465 2064  to em que este d
+00000b80: 6573 7472 7574 6f72 20c3 a920 6368 616d  estrutor .. cham
+00000b90: 6164 6f20 6120 4a56 4d0d 0a20 2020 2020  ado a JVM..     
+00000ba0: 2020 2020 2020 2020 2020 2023 206a c3a1             # j..
+00000bb0: 206e c3a3 6f20 6573 74c3 a120 6d61 6973   n..o est.. mais
+00000bc0: 2072 6f64 616e 646f 2065 2070 6f72 7461   rodando e porta
+00000bd0: 6e74 6f20 6665 6368 6172 2061 2063 6f6e  nto fechar a con
+00000be0: 6578 c3a3 6f20 4a44 560d 0a20 2020 2020  ex..o JDV..     
+00000bf0: 2020 2020 2020 2020 2020 2023 2061 7175             # aqu
+00000c00: 6920 6765 7261 7269 6120 756d 6120 6578  i geraria uma ex
+00000c10: 6365 c3a7 c3a3 6f0d 0a20 2020 2020 2020  ce....o..       
+00000c20: 2020 2020 2020 2020 2073 656c 662e 5f5f           self.__
+00000c30: 636f 6e65 7861 6f2e 636c 6f73 6528 290d  conexao.close().
+00000c40: 0a20 2020 2020 2020 2020 2020 2065 7863  .            exc
+00000c50: 6570 7420 4578 6365 7074 696f 6e20 6173  ept Exception as
+00000c60: 2065 7272 3a0d 0a20 2020 2020 2020 2020   err:..         
+00000c70: 2020 2020 2020 2073 656c 662e 652e 5f28         self.e._(
+00000c80: 2020 2022 4572 726f 2061 6f20 6665 6368     "Erro ao fech
+00000c90: 6172 2063 6f6e 6578 c3a3 6f20 636f 6d20  ar conex..o com 
+00000ca0: 6f20 6261 6e63 6f20 6465 2064 6164 6f73  o banco de dados
+00000cb0: 2e22 0d0a 2020 2020 2020 2020 2020 2020  ."..            
+00000cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000cd0: 225c 6e44 6574 616c 6865 7320 646f 2065  "\nDetalhes do e
+00000ce0: 7272 6f3a 5c6e 2220 2b20 7374 7228 6572  rro:\n" + str(er
+00000cf0: 7229 290d 0a20 2020 2020 2020 2020 2020  r))..           
+00000d00: 2020 2020 2072 6169 7365 2052 756e 7469       raise Runti
+00000d10: 6d65 4572 726f 720d 0a0d 0a20 2020 2040  meError....    @
+00000d20: 636c 6173 736d 6574 686f 640d 0a20 2020  classmethod..   
+00000d30: 2064 6566 2066 726f 6d5f 6a73 6f6e 2863   def from_json(c
+00000d40: 6c73 2c20 636f 6e65 786f 6573 3d5b 5d29  ls, conexoes=[])
+00000d50: 3a0d 0a20 2020 2020 2020 2022 2222 0d0a  :..        """..
+00000d60: 2020 2020 2020 2020 436f 6e73 7472 c3b3          Constr..
+00000d70: 6920 6f62 6a65 746f 7320 6465 2063 6f6e  i objetos de con
+00000d80: 6578 c3a3 6f20 636f 6d20 6f20 6261 6e63  ex..o com o banc
+00000d90: 6f20 6120 7061 7274 6972 2064 6520 756d  o a partir de um
+00000da0: 204a 534f 4e20 6465 0d0a 2020 2020 2020   JSON de..      
+00000db0: 2020 636f 6e66 6967 7572 61c3 a7c3 a36f    configura....o
+00000dc0: 2071 7565 2065 7374 656a 6120 6e6f 2064   que esteja no d
+00000dd0: 6972 6574 c3b3 7269 6f20 6f6e 6465 206f  iret..rio onde o
+00000de0: 2073 6372 6970 7420 6573 74c3 a120 7365   script est.. se
+00000df0: 6e64 6f0d 0a20 2020 2020 2020 2065 7865  ndo..        exe
+00000e00: 6375 7461 646f 2065 2064 6520 756d 6120  cutado e de uma 
+00000e10: 7661 7269 c3a1 7665 6c20 6465 2061 6d62  vari..vel de amb
+00000e20: 6965 6e74 6520 7175 6520 636f 6e74 656e  iente que conten
+00000e30: 6861 2061 2873 2920 7365 6e68 6128 7329  ha a(s) senha(s)
+00000e40: 0d0a 2020 2020 2020 2020 646f 2873 2920  ..        do(s) 
+00000e50: 6573 7175 656d 6128 7329 2e0d 0a0d 0a20  esquema(s)..... 
+00000e60: 2020 2020 2020 204f 204a 534f 4e20 7365         O JSON se
+00000e70: 2063 6861 6d61 72c3 a120 2763 6f6e 6578   chamar.. 'conex
+00000e80: 6f65 735f 6264 2e6a 736f 6e27 2065 2074  oes_bd.json' e t
+00000e90: 6572 c3a1 206f 2073 6567 7569 6e74 6520  er.. o seguinte 
+00000ea0: 666f 726d 6174 6f3a 0d0a 2020 2020 2020  formato:..      
+00000eb0: 2020 7b0d 0a20 2020 2020 2020 2020 2020    {..           
+00000ec0: 2022 636f 6e65 786f 6573 223a 205b 0d0a   "conexoes": [..
+00000ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000ee0: 7b0d 0a20 2020 2020 2020 2020 2020 2020  {..             
+00000ef0: 2020 2020 2020 2022 6f72 6465 6d22 3a20         "ordem": 
+00000f00: 3c6f 7264 656d 3e2c 200d 0a20 2020 2020  <ordem>, ..     
+00000f10: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00000f20: 7469 706f 223a 2022 6f72 6163 6c65 220d  tipo": "oracle".
+00000f30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00000f40: 2020 2020 2022 7573 6572 223a 2022 3c75       "user": "<u
+00000f50: 7375 c3a1 7269 6f3e 222c 200d 0a20 2020  su..rio>", ..   
+00000f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000f70: 2022 7077 6422 3a20 223c 6e6f 6d65 2064   "pwd": "<nome d
+00000f80: 6120 7661 7269 c3a1 7665 6c20 6465 2061  a vari..vel de a
+00000f90: 6d62 6965 6e74 6520 636f 6d20 6120 7365  mbiente com a se
+00000fa0: 6e68 613e 220d 0a20 2020 2020 2020 2020  nha>"..         
+00000fb0: 2020 2020 2020 2020 2020 2022 6970 223a             "ip":
+00000fc0: 2022 3c69 703e 222c 200d 0a20 2020 2020   "<ip>", ..     
+00000fd0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00000fe0: 706f 7274 223a 2022 3c6e c3ba 6d65 726f  port": "<n..mero
+00000ff0: 2064 6120 706f 7274 613e 222c 200d 0a20   da porta>", .. 
+00001000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001010: 2020 2022 7365 7276 6963 655f 6e61 6d65     "service_name
+00001020: 223a 2022 3c73 6572 7669 6365 5f6e 616d  ": "<service_nam
+00001030: 653e 222c 0d0a 2020 2020 2020 2020 2020  e>",..          
+00001040: 2020 2020 2020 7d2c 0d0a 2020 2020 2020        },..      
+00001050: 2020 2020 2020 2020 2020 7b0d 0a20 2020            {..   
+00001060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001070: 2022 6f72 6465 6d22 3a20 3c6f 7264 656d   "ordem": <ordem
+00001080: 3e2c 200d 0a20 2020 2020 2020 2020 2020  >, ..           
+00001090: 2020 2020 2020 2020 2022 7469 706f 223a           "tipo":
+000010a0: 2022 6a64 7622 0d0a 2020 2020 2020 2020   "jdv"..        
+000010b0: 2020 2020 2020 2020 2020 2020 2275 7365              "use
+000010c0: 7222 3a20 223c 7573 75c3 a172 696f 3e22  r": "<usu..rio>"
+000010d0: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+000010e0: 2020 2020 2020 2020 2270 7764 223a 2022          "pwd": "
+000010f0: 3c6e 6f6d 6520 6461 2076 6172 69c3 a176  <nome da vari..v
+00001100: 656c 2064 6520 616d 6269 656e 7465 2063  el de ambiente c
+00001110: 6f6d 2061 2073 656e 6861 3e22 0d0a 2020  om a senha>"..  
+00001120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001130: 2020 2263 6c61 7373 5f70 6174 6822 3a20    "class_path": 
+00001140: 3c63 6c61 7373 2070 6174 6820 7061 7261  <class path para
+00001150: 2069 6e73 7461 6e63 6961 c3a7 c3a3 6f20   instancia....o 
+00001160: 6461 204a 564d 3e2c 0d0a 2020 2020 2020  da JVM>,..      
+00001170: 2020 2020 2020 2020 2020 2020 2020 2270                "p
+00001180: 6172 616d 735f 6a76 6d22 3a20 3c70 6172  arams_jvm": <par
+00001190: c3a2 6d65 7472 6f73 2061 6469 6369 6f6e  ..metros adicion
+000011a0: 6169 7320 6461 204a 564d 3e2c 0d0a 2020  ais da JVM>,..  
+000011b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000011c0: 2020 226a 6462 635f 6472 6976 6572 223a    "jdbc_driver":
+000011d0: 203c 6361 6d69 6e68 6f20 6520 6e6f 6d65   <caminho e nome
+000011e0: 2064 6f20 6172 7175 6976 6f20 646f 2064   do arquivo do d
+000011f0: 7269 7665 7220 4a44 4243 3e2c 0d0a 2020  river JDBC>,..  
+00001200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001210: 2020 226a 6462 635f 7572 6c22 3a20 3c75    "jdbc_url": <u
+00001220: 726c 2064 6f20 4a44 4243 3e2c 0d0a 2020  rl do JDBC>,..  
+00001230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001240: 2020 226a 6172 5f66 696c 6522 3a20 3c63    "jar_file": <c
+00001250: 616d 696e 686f 2065 206e 6f6d 6520 646f  aminho e nome do
+00001260: 2061 7271 7569 766f 206a 6172 2064 6f20   arquivo jar do 
+00001270: 4a44 4243 3e0d 0a20 2020 2020 2020 2020  JDBC>..         
+00001280: 2020 2020 2020 207d 2c0d 0a20 2020 2020         },..     
+00001290: 2020 2020 2020 2020 2020 207b 0d0a 2020             {..  
+000012a0: 2020 2020 2020 2020 2020 2020 2020 202e                 .
+000012b0: 2e2e 2e20 206f 7574 7261 7320 636f 6e65  ...  outras cone
+000012c0: 78c3 b565 7320 2e2e 2e2e 2e0d 0a20 2020  x..es .......   
+000012d0: 2020 2020 2020 2020 2020 2020 207d 0d0a               }..
+000012e0: 2020 2020 2020 2020 2020 2020 5d0d 0a20              ].. 
+000012f0: 2020 2020 2020 207d 0d0a 0d0a 2020 2020         }....    
+00001300: 2020 2020 4f20 6361 6d70 6f20 6f72 6465      O campo orde
+00001310: 6d20 646f 204a 534f 4e20 636f 6d65 c3a7  m do JSON come..
+00001320: 6120 636f 6d20 312e 204e c3a3 6f20 68c3  a com 1. N..o h.
+00001330: a120 6c69 6d69 7465 206e 6f20 6ec3 ba6d  . limite no n..m
+00001340: 6572 6f20 6465 2063 6f6e 6578 c3b5 6573  ero de conex..es
+00001350: 0d0a 2020 2020 2020 2020 706f 7373 c3ad  ..        poss..
+00001360: 7665 6973 2e0d 0a0d 0a20 2020 2020 2020  veis.....       
+00001370: 204f 7320 7469 706f 7320 6465 2063 6f6e   Os tipos de con
+00001380: 6578 c3a3 6f20 706f 6465 6d20 7365 7220  ex..o podem ser 
+00001390: 226f 7261 636c 6522 206f 7520 226a 6476  "oracle" ou "jdv
+000013a0: 222c 2063 6164 6120 7175 616c 2063 6f6d  ", cada qual com
+000013b0: 2073 6575 730d 0a20 2020 2020 2020 2070   seus..        p
+000013c0: 6172 c3a2 6d65 7472 6f73 2064 6520 636f  ar..metros de co
+000013d0: 6e65 78c3 a36f 2065 7370 6563 c3ad 6666  nex..o espec..ff
+000013e0: 6963 6f73 2e20 5365 206e c3a3 6f20 696e  icos. Se n..o in
+000013f0: 666f 726d 6164 6f2c 2063 6f6e 7369 6465  formado, conside
+00001400: 7261 2d73 6520 6f0d 0a20 2020 2020 2020  ra-se o..       
+00001410: 2074 6970 6f20 226f 7261 636c 6522 2e0d   tipo "oracle"..
+00001420: 0a0d 0a20 2020 2020 2020 2041 2073 656e  ...        A sen
+00001430: 6861 2064 6520 6361 6461 2063 6f6e 6578  ha de cada conex
+00001440: c3a3 6f20 7365 72c3 a120 6f62 7469 6461  ..o ser.. obtida
+00001450: 2064 6120 7661 7269 c3a1 7665 6c20 6465   da vari..vel de
+00001460: 2061 6d62 6965 6e74 6520 6375 6a6f 206e   ambiente cujo n
+00001470: 6f6d 650d 0a20 2020 2020 2020 2065 7374  ome..        est
+00001480: c3a1 2069 6e64 6963 6164 6f20 6e6f 2070  .. indicado no p
+00001490: 6172 c3a2 6d65 7472 6f20 2270 7764 222e  ar..metro "pwd".
+000014a0: 0d0a 0d0a 2020 2020 2020 2020 4172 6773  ....        Args
+000014b0: 3a0d 0a20 2020 2020 2020 2063 6f6e 6578  :..        conex
+000014c0: 6f65 733a 2020 2061 7272 6179 2064 6520  oes:   array de 
+000014d0: 696e 7420 636f 6d20 6173 2063 6f6e 6578  int com as conex
+000014e0: c3b5 6573 2071 7565 2073 6572 c3a3 6f20  ..es que ser..o 
+000014f0: 636f 6e73 6964 6572 6164 6173 0d0a 2020  consideradas..  
+00001500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001510: 2020 2863 616d 706f 2027 6f72 6465 6d27    (campo 'ordem'
+00001520: 2064 6f20 4a53 4f4e 293b 2073 6520 6ec3   do JSON); se n.
+00001530: a36f 2069 6e66 6f72 6d61 646f 2c20 746f  .o informado, to
+00001540: 6461 7320 6173 0d0a 2020 2020 2020 2020  das as..        
+00001550: 2020 2020 2020 2020 2020 2020 636f 6e65              cone
+00001560: 78c3 b565 7320 646f 204a 534f 4e20 7365  x..es do JSON se
+00001570: 72c3 a36f 2063 6f6e 7369 6465 7261 6461  r..o considerada
+00001580: 730d 0a0d 0a20 2020 2020 2020 2052 6574  s....        Ret
+00001590: 3a0d 0a20 2020 2020 2020 2055 6d61 2074  :..        Uma t
+000015a0: 7570 6c61 2063 6f6d 2075 6d20 6f75 206d  upla com um ou m
+000015b0: 6169 7320 6f62 6a65 746f 7320 6465 2063  ais objetos de c
+000015c0: 6f6e 6578 c3a3 6f20 636f 6d20 6f20 6261  onex..o com o ba
+000015d0: 6e63 6f20 6465 2064 6164 6f73 2c20 6e61  nco de dados, na
+000015e0: 0d0a 2020 2020 2020 2020 6f72 6465 6d20  ..        ordem 
+000015f0: 6573 7065 6369 6669 6361 6461 206e 6f20  especificada no 
+00001600: 6361 6d70 6f20 276f 7264 656d 2720 646f  campo 'ordem' do
+00001610: 204a 534f 4e2e 0d0a 2020 2020 2020 2020   JSON...        
+00001620: 2222 220d 0a0d 0a20 2020 2020 2020 2070  """....        p
+00001630: 6172 616d 5f63 6f6e 6578 6f65 7320 3d20  aram_conexoes = 
+00001640: 5b5d 200d 0a20 2020 2020 2020 2074 7279  [] ..        try
+00001650: 3a0d 0a20 2020 2020 2020 2020 2020 2077  :..            w
+00001660: 6974 6820 6f70 656e 2822 636f 6e65 786f  ith open("conexo
+00001670: 6573 5f62 642e 6a73 6f6e 2229 2061 7320  es_bd.json") as 
+00001680: 663a 0d0a 2020 2020 2020 2020 2020 2020  f:..            
+00001690: 2020 2020 636f 6e65 786f 6573 5f6a 736f      conexoes_jso
+000016a0: 6e20 3d20 6a73 6f6e 2e6c 6f61 6428 6629  n = json.load(f)
+000016b0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+000016c0: 2020 2020 2320 636f 6c6f 6361 2061 7320      # coloca as 
+000016d0: 636f 6e65 78c3 b565 7320 6c69 6461 7320  conex..es lidas 
+000016e0: 646f 204a 534f 4e20 6e61 206f 7264 656d  do JSON na ordem
+000016f0: 2064 6120 7475 706c 6120 6465 2072 6574   da tupla de ret
+00001700: 6f72 6e6f 0d0a 2020 2020 2020 2020 2020  orno..          
+00001710: 2020 2020 2020 696e 6469 6365 203d 2031        indice = 1
+00001720: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00001730: 2020 7461 6d20 3d20 6c65 6e28 636f 6e65    tam = len(cone
+00001740: 786f 6573 5f6a 736f 6e5b 2263 6f6e 6578  xoes_json["conex
+00001750: 6f65 7322 5d29 0d0a 2020 2020 2020 2020  oes"])..        
+00001760: 2020 2020 2020 2020 7465 726d 696e 6f75          terminou
+00001770: 203d 2046 616c 7365 0d0a 2020 2020 2020   = False..      
+00001780: 2020 2020 2020 2020 2020 7768 696c 6528            while(
+00001790: 5472 7565 293a 0d0a 2020 2020 2020 2020  True):..        
+000017a0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+000017b0: 636f 6e65 7861 6f20 696e 2063 6f6e 6578  conexao in conex
+000017c0: 6f65 735f 6a73 6f6e 5b22 636f 6e65 786f  oes_json["conexo
+000017d0: 6573 225d 3a0d 0a20 2020 2020 2020 2020  es"]:..         
+000017e0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000017f0: 6620 636f 6e65 7861 6f5b 226f 7264 656d  f conexao["ordem
+00001800: 225d 203d 3d20 696e 6469 6365 3a0d 0a20  "] == indice:.. 
+00001810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001820: 2020 2020 2020 2020 2020 2069 6620 2063             if  c
+00001830: 6f6e 6578 6f65 7320 3d3d 205b 5d20 6f72  onexoes == [] or
+00001840: 2020 5c0d 0a20 2020 2020 2020 2020 2020    \..           
+00001850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001860: 2020 2020 2063 6f6e 6578 616f 5b22 6f72       conexao["or
+00001870: 6465 6d22 5d20 696e 2063 6f6e 6578 6f65  dem"] in conexoe
+00001880: 733a 0d0a 0d0a 2020 2020 2020 2020 2020  s:....          
+00001890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000018a0: 2020 2020 2020 7061 7261 6d5f 636f 6e65        param_cone
+000018b0: 786f 6573 2e61 7070 656e 6428 636f 6e65  xoes.append(cone
+000018c0: 7861 6f29 0d0a 0d0a 2020 2020 2020 2020  xao)....        
+000018d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000018e0: 2020 2020 696e 6469 6365 202b 3d20 310d      indice += 1.
+000018f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00001900: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+00001910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001920: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00001930: 6e64 6963 6520 3e20 7461 6d3a 0d0a 2020  ndice > tam:..  
+00001940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001950: 2020 2020 2020 2020 2020 2020 2020 7465                te
+00001960: 726d 696e 6f75 203d 2054 7275 650d 0a20  rminou = True.. 
+00001970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001980: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00001990: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
 000019a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000019b0: 2020 6966 2074 6572 6d69 6e6f 753a 0d0a    if terminou:..
+000019b0: 2020 636f 6e74 696e 7565 0d0a 0d0a 2020    continue....  
 000019c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000019d0: 2020 2020 2020 2020 6272 6561 6b0d 0a20          break.. 
-000019e0: 2020 2020 2020 2065 7863 6570 743a 0d0a         except:..
-000019f0: 2020 2020 2020 2020 2020 2020 636c 732e              cls.
-00001a00: 652e 5f28 224e c3a3 6f20 666f 6920 706f  e._("N..o foi po
-00001a10: 7373 c3ad 7665 6c20 6c65 7220 6f20 6172  ss..vel ler o ar
-00001a20: 7175 6976 6f20 6465 2063 6f6e 6578 c3b5  quivo de conex..
-00001a30: 6573 2022 0d0a 2020 2020 2020 2020 2020  es "..          
-00001a40: 2020 2020 2020 2020 2020 2264 6520 6261            "de ba
-00001a50: 6e63 6f20 6465 2064 6164 6f73 2027 636f  nco de dados 'co
-00001a60: 6e65 786f 6573 5f62 642e 6a73 6f6e 272e  nexoes_bd.json'.
-00001a70: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
-00001a80: 2020 2020 2020 2022 5c6e 4465 7461 6c68         "\nDetalh
-00001a90: 6573 2064 6f20 6572 726f 3a5c 6e22 202b  es do erro:\n" +
-00001aa0: 2073 7472 2865 7272 2929 0d0a 2020 2020   str(err))..    
-00001ab0: 2020 2020 2020 2020 7261 6973 6520 5275          raise Ru
-00001ac0: 6e74 696d 6545 7272 6f72 0d0a 0d0a 2020  ntimeError....  
-00001ad0: 2020 2020 2020 636f 6e65 786f 6573 203d        conexoes =
-00001ae0: 205b 5d0d 0a20 2020 2020 2020 2066 6f72   []..        for
-00001af0: 2063 6f6e 6578 616f 2069 6e20 7061 7261   conexao in para
-00001b00: 6d5f 636f 6e65 786f 6573 3a0d 0a20 2020  m_conexoes:..   
-00001b10: 2020 2020 2020 2020 2066 616c 686f 7520           falhou 
-00001b20: 3d20 4661 6c73 650d 0a20 2020 2020 2020  = False..       
-00001b30: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
-00001b40: 2020 2020 2020 2020 2020 2073 656e 6861             senha
-00001b50: 203d 206f 732e 6765 7465 6e76 2863 6f6e   = os.getenv(con
-00001b60: 6578 616f 5b22 7077 6422 5d29 0d0a 2020  exao["pwd"])..  
-00001b70: 2020 2020 2020 2020 2020 6578 6365 7074            except
-00001b80: 204b 6579 4572 726f 723a 0d0a 2020 2020   KeyError:..    
-00001b90: 2020 2020 2020 2020 2020 2020 6661 6c68              falh
-00001ba0: 6f75 203d 2054 7275 650d 0a0d 0a20 2020  ou = True....   
-00001bb0: 2020 2020 2020 2020 2069 6620 2873 656e           if (sen
-00001bc0: 6861 2069 7320 4e6f 6e65 2920 6f72 2066  ha is None) or f
-00001bd0: 616c 686f 753a 0d0a 2020 2020 2020 2020  alhou:..        
-00001be0: 2020 2020 2020 2020 636c 732e 652e 5f28          cls.e._(
-00001bf0: 2022 4ec3 a36f 2066 6f69 2070 6f73 73c3   "N..o foi poss.
-00001c00: ad76 656c 206f 6274 6572 2061 2073 656e  .vel obter a sen
-00001c10: 6861 2064 6f20 6261 6e63 6f20 220d 0a20  ha do banco ".. 
-00001c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001c30: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00001c40: 6465 2064 6164 6f73 2064 6520 756d 6120  de dados de uma 
-00001c50: 7661 7269 c3a1 7665 6c20 6465 2061 6d62  vari..vel de amb
-00001c60: 6965 6e74 6520 220d 0a20 2020 2020 2020  iente "..       
+000019d0: 2020 6966 2074 6572 6d69 6e6f 753a 0d0a    if terminou:..
+000019e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000019f0: 2020 2020 2020 2020 6272 6561 6b0d 0a20          break.. 
+00001a00: 2020 2020 2020 2065 7863 6570 7420 4578         except Ex
+00001a10: 6365 7074 696f 6e20 6173 2065 7272 3a0d  ception as err:.
+00001a20: 0a20 2020 2020 2020 2020 2020 2063 6c73  .            cls
+00001a30: 2e65 2e5f 2822 4ec3 a36f 2066 6f69 2070  .e._("N..o foi p
+00001a40: 6f73 73c3 ad76 656c 206c 6572 206f 2061  oss..vel ler o a
+00001a50: 7271 7569 766f 2064 6520 636f 6e65 78c3  rquivo de conex.
+00001a60: b565 7320 220d 0a20 2020 2020 2020 2020  .es "..         
+00001a70: 2020 2020 2020 2020 2020 2022 6465 2062             "de b
+00001a80: 616e 636f 2064 6520 6461 646f 7320 2763  anco de dados 'c
+00001a90: 6f6e 6578 6f65 735f 6264 2e6a 736f 6e27  onexoes_bd.json'
+00001aa0: 2e22 0d0a 2020 2020 2020 2020 2020 2020  ."..            
+00001ab0: 2020 2020 2020 2020 225c 6e44 6574 616c          "\nDetal
+00001ac0: 6865 7320 646f 2065 7272 6f3a 5c6e 2220  hes do erro:\n" 
+00001ad0: 2b20 7374 7228 6572 7229 290d 0a20 2020  + str(err))..   
+00001ae0: 2020 2020 2020 2020 2072 6169 7365 2052           raise R
+00001af0: 756e 7469 6d65 4572 726f 720d 0a0d 0a20  untimeError.... 
+00001b00: 2020 2020 2020 2063 6f6e 6578 6f65 7320         conexoes 
+00001b10: 3d20 5b5d 0d0a 2020 2020 2020 2020 666f  = []..        fo
+00001b20: 7220 636f 6e65 7861 6f20 696e 2070 6172  r conexao in par
+00001b30: 616d 5f63 6f6e 6578 6f65 733a 0d0a 2020  am_conexoes:..  
+00001b40: 2020 2020 2020 2020 2020 6661 6c68 6f75            falhou
+00001b50: 203d 2046 616c 7365 0d0a 2020 2020 2020   = False..      
+00001b60: 2020 2020 2020 7365 6e68 6120 3d20 4e6f        senha = No
+00001b70: 6e65 0d0a 2020 2020 2020 2020 2020 2020  ne..            
+00001b80: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
+00001b90: 2020 2020 2020 7365 6e68 6120 3d20 6f73        senha = os
+00001ba0: 2e67 6574 656e 7628 636f 6e65 7861 6f5b  .getenv(conexao[
+00001bb0: 2270 7764 225d 290d 0a20 2020 2020 2020  "pwd"])..       
+00001bc0: 2020 2020 2065 7863 6570 7420 4b65 7945       except KeyE
+00001bd0: 7272 6f72 3a0d 0a20 2020 2020 2020 2020  rror:..         
+00001be0: 2020 2020 2020 2066 616c 686f 7520 3d20         falhou = 
+00001bf0: 5472 7565 0d0a 0d0a 2020 2020 2020 2020  True....        
+00001c00: 2020 2020 6966 2028 7365 6e68 6120 6973      if (senha is
+00001c10: 204e 6f6e 6529 206f 7220 6661 6c68 6f75   None) or falhou
+00001c20: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00001c30: 2020 2063 6c73 2e65 2e5f 2820 224e c3a3     cls.e._( "N..
+00001c40: 6f20 666f 6920 706f 7373 c3ad 7665 6c20  o foi poss..vel 
+00001c50: 6f62 7465 7220 6120 7365 6e68 6120 646f  obter a senha do
+00001c60: 2062 616e 636f 2022 0d0a 2020 2020 2020   banco "..      
 00001c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001c80: 2020 2020 2020 2020 2022 7061 7261 206f           "para o
-00001c90: 2075 7375 c3a1 7269 6f20 2220 2b20 636f   usu..rio " + co
-00001ca0: 6e65 7861 6f5b 2275 7365 7222 5d20 2b20  nexao["user"] + 
-00001cb0: 222e 2229 0d0a 2020 2020 2020 2020 2020  ".")..          
-00001cc0: 2020 2020 2020 7261 6973 6520 5275 6e74        raise Runt
-00001cd0: 696d 6545 7272 6f72 0d0a 0d0a 2020 2020  imeError....    
-00001ce0: 2020 2020 2020 2020 7472 793a 0d0a 2020          try:..  
-00001cf0: 2020 2020 2020 2020 2020 2020 2020 7469                ti
-00001d00: 706f 5f63 6f6e 6578 616f 203d 2063 6f6e  po_conexao = con
-00001d10: 6578 616f 5b22 7469 706f 225d 0d0a 2020  exao["tipo"]..  
-00001d20: 2020 2020 2020 2020 2020 6578 6365 7074            except
-00001d30: 204b 6579 4572 726f 723a 0d0a 2020 2020   KeyError:..    
-00001d40: 2020 2020 2020 2020 2020 2020 7469 706f              tipo
-00001d50: 5f63 6f6e 6578 616f 203d 2022 6f72 6163  _conexao = "orac
-00001d60: 6c65 220d 0a0d 0a20 2020 2020 2020 2020  le"....         
-00001d70: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
-00001d80: 2020 2020 2020 2020 2069 6620 7469 706f           if tipo
-00001d90: 5f63 6f6e 6578 616f 203d 3d20 226f 7261  _conexao == "ora
-00001da0: 636c 6522 3a0d 0a20 2020 2020 2020 2020  cle":..         
-00001db0: 2020 2020 2020 2020 2020 2063 6f6e 6578             conex
-00001dc0: 6f65 732e 6170 7065 6e64 2863 6c73 2874  oes.append(cls(t
-00001dd0: 6970 6f3d 7469 706f 5f63 6f6e 6578 616f  ipo=tipo_conexao
-00001de0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00001df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001e00: 2020 2020 2020 2020 2020 2075 7365 723d             user=
-00001e10: 636f 6e65 7861 6f5b 2275 7365 7222 5d2c  conexao["user"],
-00001e20: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00001c80: 2020 2020 2020 2020 2020 2264 6520 6461            "de da
+00001c90: 646f 7320 6465 2075 6d61 2076 6172 69c3  dos de uma vari.
+00001ca0: a176 656c 2064 6520 616d 6269 656e 7465  .vel de ambiente
+00001cb0: 2022 0d0a 2020 2020 2020 2020 2020 2020   "..            
+00001cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001cd0: 2020 2020 2270 6172 6120 6f20 7573 75c3      "para o usu.
+00001ce0: a172 696f 2022 202b 2063 6f6e 6578 616f  .rio " + conexao
+00001cf0: 5b22 7573 6572 225d 202b 2022 2e22 290d  ["user"] + ".").
+00001d00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00001d10: 2072 6169 7365 2052 756e 7469 6d65 4572   raise RuntimeEr
+00001d20: 726f 720d 0a0d 0a20 2020 2020 2020 2020  ror....         
+00001d30: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
+00001d40: 2020 2020 2020 2020 2074 6970 6f5f 636f           tipo_co
+00001d50: 6e65 7861 6f20 3d20 636f 6e65 7861 6f5b  nexao = conexao[
+00001d60: 2274 6970 6f22 5d0d 0a20 2020 2020 2020  "tipo"]..       
+00001d70: 2020 2020 2065 7863 6570 7420 4b65 7945       except KeyE
+00001d80: 7272 6f72 3a0d 0a20 2020 2020 2020 2020  rror:..         
+00001d90: 2020 2020 2020 2074 6970 6f5f 636f 6e65         tipo_cone
+00001da0: 7861 6f20 3d20 226f 7261 636c 6522 0d0a  xao = "oracle"..
+00001db0: 0d0a 2020 2020 2020 2020 2020 2020 7472  ..            tr
+00001dc0: 793a 0d0a 2020 2020 2020 2020 2020 2020  y:..            
+00001dd0: 2020 2020 6966 2074 6970 6f5f 636f 6e65      if tipo_cone
+00001de0: 7861 6f20 3d3d 2022 6f72 6163 6c65 223a  xao == "oracle":
+00001df0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00001e00: 2020 2020 2020 636f 6e65 786f 6573 2e61        conexoes.a
+00001e10: 7070 656e 6428 636c 7328 7469 706f 3d74  ppend(cls(tipo=t
+00001e20: 6970 6f5f 636f 6e65 7861 6f2c 0d0a 2020  ipo_conexao,..  
 00001e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001e40: 2020 2020 2020 2020 2020 2070 7764 3d73             pwd=s
-00001e50: 656e 6861 2c0d 0a20 2020 2020 2020 2020  enha,..         
-00001e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001e70: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00001e80: 703d 636f 6e65 7861 6f5b 2269 7022 5d2c  p=conexao["ip"],
-00001e90: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00001ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001eb0: 2020 2020 2020 2020 2020 2070 6f72 743d             port=
-00001ec0: 636f 6e65 7861 6f5b 2270 6f72 7422 5d2c  conexao["port"],
-00001ed0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00001e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001e50: 2020 2020 2020 7573 6572 3d63 6f6e 6578        user=conex
+00001e60: 616f 5b22 7573 6572 225d 2c20 0d0a 2020  ao["user"], ..  
+00001e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001e90: 2020 2020 2020 7077 643d 7365 6e68 612c        pwd=senha,
+00001ea0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00001eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001ec0: 2020 2020 2020 2020 2020 6970 3d63 6f6e            ip=con
+00001ed0: 6578 616f 5b22 6970 225d 2c20 0d0a 2020  exao["ip"], ..  
 00001ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001ef0: 2020 2020 2020 2020 2020 2073 6572 7669             servi
-00001f00: 6365 5f6e 616d 653d 636f 6e65 7861 6f5b  ce_name=conexao[
-00001f10: 2273 6572 7669 6365 5f6e 616d 6522 5d29  "service_name"])
-00001f20: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00001f30: 2020 2065 6c69 6620 7469 706f 5f63 6f6e     elif tipo_con
-00001f40: 6578 616f 203d 3d20 226a 6476 223a 0d0a  exao == "jdv":..
-00001f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001f60: 2020 2020 636f 6e65 786f 6573 2e61 7070      conexoes.app
-00001f70: 656e 6428 636c 7328 7469 706f 3d74 6970  end(cls(tipo=tip
-00001f80: 6f5f 636f 6e65 7861 6f2c 0d0a 2020 2020  o_conexao,..    
-00001f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001fb0: 2020 2020 7573 6572 3d63 6f6e 6578 616f      user=conexao
-00001fc0: 5b22 7573 6572 225d 2c20 0d0a 2020 2020  ["user"], ..    
-00001fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001f00: 2020 2020 2020 706f 7274 3d63 6f6e 6578        port=conex
+00001f10: 616f 5b22 706f 7274 225d 2c20 0d0a 2020  ao["port"], ..  
+00001f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001f40: 2020 2020 2020 7365 7276 6963 655f 6e61        service_na
+00001f50: 6d65 3d63 6f6e 6578 616f 5b22 7365 7276  me=conexao["serv
+00001f60: 6963 655f 6e61 6d65 225d 2929 0d0a 2020  ice_name"]))..  
+00001f70: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00001f80: 6966 2074 6970 6f5f 636f 6e65 7861 6f20  if tipo_conexao 
+00001f90: 3d3d 2022 6a64 7622 3a0d 0a20 2020 2020  == "jdv":..     
+00001fa0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00001fb0: 6f6e 6578 6f65 732e 6170 7065 6e64 2863  onexoes.append(c
+00001fc0: 6c73 2874 6970 6f3d 7469 706f 5f63 6f6e  ls(tipo=tipo_con
+00001fd0: 6578 616f 2c0d 0a20 2020 2020 2020 2020  exao,..         
 00001fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001ff0: 2020 2020 7077 643d 7365 6e68 612c 0d0a      pwd=senha,..
-00002000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002020: 2020 2020 2020 2020 636c 6173 735f 7061          class_pa
-00002030: 7468 3d63 6f6e 6578 616f 5b22 636c 6173  th=conexao["clas
-00002040: 735f 7061 7468 225d 2c0d 0a20 2020 2020  s_path"],..     
+00001ff0: 2020 2020 2020 2020 2020 2020 2020 2075                 u
+00002000: 7365 723d 636f 6e65 7861 6f5b 2275 7365  ser=conexao["use
+00002010: 7222 5d2c 200d 0a20 2020 2020 2020 2020  r"], ..         
+00002020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002030: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00002040: 7764 3d73 656e 6861 2c0d 0a20 2020 2020  wd=senha,..     
 00002050: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00002060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002070: 2020 2070 6172 616d 735f 6a76 6d3d 636f     params_jvm=co
-00002080: 6e65 7861 6f5b 2270 6172 616d 735f 6a76  nexao["params_jv
-00002090: 6d22 5d2c 0d0a 2020 2020 2020 2020 2020  m"],..          
+00002070: 2020 2063 6c61 7373 5f70 6174 683d 636f     class_path=co
+00002080: 6e65 7861 6f5b 2263 6c61 7373 5f70 6174  nexao["class_pat
+00002090: 6822 5d2c 0d0a 2020 2020 2020 2020 2020  h"],..          
 000020a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000020b0: 2020 2020 2020 2020 2020 2020 2020 6a64                jd
-000020c0: 6263 5f64 7269 7665 723d 636f 6e65 7861  bc_driver=conexa
-000020d0: 6f5b 226a 6462 635f 6472 6976 6572 225d  o["jdbc_driver"]
-000020e0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+000020b0: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+000020c0: 7261 6d73 5f6a 766d 3d63 6f6e 6578 616f  rams_jvm=conexao
+000020d0: 5b22 7061 7261 6d73 5f6a 766d 225d 2c0d  ["params_jvm"],.
+000020e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 000020f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002100: 2020 2020 2020 2020 2020 206a 6462 635f             jdbc_
-00002110: 7572 6c3d 636f 6e65 7861 6f5b 226a 6462  url=conexao["jdb
-00002120: 635f 7572 6c22 5d2c 0d0a 2020 2020 2020  c_url"],..      
+00002100: 2020 2020 2020 2020 206a 6462 635f 6472           jdbc_dr
+00002110: 6976 6572 3d63 6f6e 6578 616f 5b22 6a64  iver=conexao["jd
+00002120: 6263 5f64 7269 7665 7222 5d2c 0d0a 2020  bc_driver"],..  
 00002130: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00002140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002150: 2020 6a61 725f 6669 6c65 3d63 6f6e 6578    jar_file=conex
-00002160: 616f 5b22 6a61 725f 6669 6c65 225d 2929  ao["jar_file"]))
-00002170: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00002180: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-00002190: 2020 2020 2020 2020 2020 2020 2063 6c73               cls
-000021a0: 2e65 2e5f 2822 4572 726f 2061 6f20 636f  .e._("Erro ao co
-000021b0: 6e65 6374 6172 2063 6f6d 206f 2062 616e  nectar com o ban
-000021c0: 636f 2064 6520 6461 646f 733a 2022 200d  co de dados: " .
-000021d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000021e0: 2020 2020 2020 2020 2020 2020 2022 5c6e               "\n
-000021f0: 5061 72c3 a26d 6574 726f 2064 6520 636f  Par..metro de co
-00002200: 6e65 7861 6f20 2774 6970 6f27 20c3 a920  nexao 'tipo' .. 
-00002210: 696e 76c3 a16c 6964 6f2e 2229 0d0a 2020  inv..lido.")..  
+00002150: 2020 2020 2020 6a64 6263 5f75 726c 3d63        jdbc_url=c
+00002160: 6f6e 6578 616f 5b22 6a64 6263 5f75 726c  onexao["jdbc_url
+00002170: 225d 2c0d 0a20 2020 2020 2020 2020 2020  "],..           
+00002180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002190: 2020 2020 2020 2020 2020 2020 206a 6172               jar
+000021a0: 5f66 696c 653d 636f 6e65 7861 6f5b 226a  _file=conexao["j
+000021b0: 6172 5f66 696c 6522 5d29 290d 0a20 2020  ar_file"]))..   
+000021c0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+000021d0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+000021e0: 2020 2020 2020 2020 636c 732e 652e 5f28          cls.e._(
+000021f0: 2245 7272 6f20 616f 2063 6f6e 6563 7461  "Erro ao conecta
+00002200: 7220 636f 6d20 6f20 6261 6e63 6f20 6465  r com o banco de
+00002210: 2064 6164 6f73 3a20 2220 0d0a 2020 2020   dados: " ..    
 00002220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002230: 2020 7261 6973 6520 5275 6e74 696d 6545    raise RuntimeE
-00002240: 7272 6f72 0d0a 0d0a 2020 2020 2020 2020  rror....        
-00002250: 2020 2020 6578 6365 7074 204b 6579 4572      except KeyEr
-00002260: 726f 7220 6173 2065 7272 3a0d 0a20 2020  ror as err:..   
-00002270: 2020 2020 2020 2020 2020 2020 2063 6c73               cls
-00002280: 2e65 2e5f 2820 2020 2022 4572 726f 2061  .e._(    "Erro a
-00002290: 6f20 636f 6e65 6374 6172 2063 6f6d 206f  o conectar com o
-000022a0: 2062 616e 636f 2064 6520 6461 646f 733a   banco de dados:
-000022b0: 2022 200d 0a20 2020 2020 2020 2020 2020   " ..           
-000022c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000022d0: 2022 5c6e 5061 72c3 a26d 6574 726f 2064   "\nPar..metro d
-000022e0: 6520 636f 6e65 7861 6f20 2220 2b20 7374  e conexao " + st
-000022f0: 7228 6572 7229 202b 200d 0a20 2020 2020  r(err) + ..     
+00002230: 2020 2020 2020 2020 225c 6e50 6172 c3a2          "\nPar..
+00002240: 6d65 7472 6f20 6465 2063 6f6e 6578 616f  metro de conexao
+00002250: 2027 7469 706f 2720 c3a9 2069 6e76 c3a1   'tipo' .. inv..
+00002260: 6c69 646f 2e22 290d 0a20 2020 2020 2020  lido.")..       
+00002270: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+00002280: 7365 2052 756e 7469 6d65 4572 726f 720d  se RuntimeError.
+00002290: 0a0d 0a20 2020 2020 2020 2020 2020 2065  ...            e
+000022a0: 7863 6570 7420 4b65 7945 7272 6f72 2061  xcept KeyError a
+000022b0: 7320 6572 723a 0d0a 2020 2020 2020 2020  s err:..        
+000022c0: 2020 2020 2020 2020 636c 732e 652e 5f28          cls.e._(
+000022d0: 2020 2020 2245 7272 6f20 616f 2063 6f6e      "Erro ao con
+000022e0: 6563 7461 7220 636f 6d20 6f20 6261 6e63  ectar com o banc
+000022f0: 6f20 6465 2064 6164 6f73 3a20 2220 0d0a  o de dados: " ..
 00002300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002310: 2020 2020 2020 2022 206e c3a3 6f20 656e         " n..o en
-00002320: 636f 6e74 7261 646f 2e22 290d 0a20 2020  contrado.")..   
-00002330: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-00002340: 7365 2052 756e 7469 6d65 4572 726f 720d  se RuntimeError.
-00002350: 0a0d 0a20 2020 2020 2020 2020 2020 2065  ...            e
-00002360: 7863 6570 7420 4578 6365 7074 696f 6e20  xcept Exception 
-00002370: 6173 2065 7272 3a0d 0a20 2020 2020 2020  as err:..       
-00002380: 2020 2020 2020 2020 2023 2074 656d 2071           # tem q
-00002390: 7565 2074 6572 2065 7373 6520 7465 7374  ue ter esse test
-000023a0: 6520 6171 7569 2070 6f69 7320 6f20 636f  e aqui pois o co
-000023b0: 6e73 7472 7574 6f72 206a c3a1 2065 7869  nstrutor j.. exi
-000023c0: 6269 72c3 a120 610d 0a20 2020 2020 2020  bir.. a..       
-000023d0: 2020 2020 2020 2020 2023 206d 656e 7361           # mensa
-000023e0: 6765 6d20 6465 2065 7272 6f20 6361 736f  gem de erro caso
-000023f0: 2068 616a 6120 616c 6775 6d20 7072 6f62   haja algum prob
-00002400: 6c65 6d61 2063 6f6d 206f 7320 7061 72c3  lema com os par.
-00002410: a26d 6574 726f 730d 0a20 2020 2020 2020  .metros..       
-00002420: 2020 2020 2020 2020 2069 6620 7374 7228           if str(
-00002430: 6572 7229 2021 3d20 2222 3a0d 0a20 2020  err) != "":..   
-00002440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002450: 2063 6c73 2e65 2e5f 2820 2020 2022 4572   cls.e._(    "Er
-00002460: 726f 2061 6f20 636f 6e65 6374 6172 2063  ro ao conectar c
-00002470: 6f6d 206f 2062 616e 636f 2064 6520 6461  om o banco de da
-00002480: 646f 732e 2022 200d 0a20 2020 2020 2020  dos. " ..       
-00002490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000024a0: 2020 2020 2020 2020 2022 5c6e 4465 7461           "\nDeta
-000024b0: 6c68 6573 2064 6f20 6572 726f 3a5c 6e22  lhes do erro:\n"
-000024c0: 202b 2073 7472 2865 7272 2929 0d0a 2020   + str(err))..  
-000024d0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-000024e0: 6973 6520 5275 6e74 696d 6545 7272 6f72  ise RuntimeError
-000024f0: 0d0a 0d0a 2020 2020 2020 2020 7265 7475  ....        retu
-00002500: 726e 2074 7570 6c65 2863 6f6e 6578 6f65  rn tuple(conexoe
-00002510: 7329 0d0a 0d0a 2020 2020 4070 726f 7065  s)....    @prope
-00002520: 7274 790d 0a20 2020 2064 6566 2063 6f6e  rty..    def con
-00002530: 6578 616f 2873 656c 6629 3a0d 0a20 2020  exao(self):..   
-00002540: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00002550: 2e5f 5f63 6f6e 6578 616f 0d0a 0d0a 2320  .__conexao....# 
-00002560: 544f 444f 3a20 7072 6563 6973 6120 6465  TODO: precisa de
-00002570: 7373 6520 636f 6e73 756c 7461 3f20 6ec3  sse consulta? n.
-00002580: a36f 2070 6f64 6520 7365 7220 73c3 b320  .o pode ser s.. 
-00002590: 6f20 6578 6563 7574 613f 2073 6520 7369  o executa? se si
-000025a0: 6d2c 2070 7265 6369 7361 722c 2065 6e74  m, precisar, ent
-000025b0: c3a3 6f20 6661 7ac3 aa2d 6c6f 2063 6861  ..o faz..-lo cha
-000025c0: 6d61 7220 6f20 6578 6563 7574 6120 6520  mar o executa e 
-000025d0: 7465 7374 6172 2073 6520 6f20 7371 6c20  testar se o sql 
-000025e0: c3a9 206d 6573 6d6f 2064 6520 756d 6120  .. mesmo de uma 
-000025f0: 636f 6e73 756c 7461 3b20 6f20 7472 7920  consulta; o try 
-00002600: 7661 6920 6669 6361 7220 6e6f 206d 6575  vai ficar no meu
-00002610: 2065 7865 6375 7461 2829 0d0a 2020 2020   executa()..    
-00002620: 6465 6620 636f 6e73 756c 7461 2873 656c  def consulta(sel
-00002630: 662c 2073 716c 293a 0d0a 2020 2020 2020  f, sql):..      
-00002640: 2020 2222 220d 0a20 2020 2020 2020 2045    """..        E
-00002650: 7865 6375 7461 2075 6d61 2063 6f6d 616e  xecuta uma coman
-00002660: 646f 2064 6520 636f 6e73 756c 7461 206e  do de consulta n
-00002670: 6f20 6261 6e63 6f2e 0d0a 0d0a 2020 2020  o banco.....    
-00002680: 2020 2020 4172 6773 3a0d 0a20 2020 2020      Args:..     
-00002690: 2020 2020 2020 2073 716c 2020 2020 203a         sql     :
-000026a0: 2053 454c 4543 5420 6120 7365 7220 6578   SELECT a ser ex
-000026b0: 6563 7574 6164 6f20 6e6f 2062 616e 636f  ecutado no banco
-000026c0: 0d0a 2020 2020 2020 2020 5265 743a 0d0a  ..        Ret:..
-000026d0: 2020 2020 2020 2020 2020 2020 4375 7273              Curs
-000026e0: 6f72 2063 6f6d 206f 2072 6573 756c 7461  or com o resulta
-000026f0: 646f 2064 6f20 5345 4c45 4354 2e0d 0a20  do do SELECT... 
-00002700: 2020 2020 2020 2022 2222 0d0a 0d0a 2020         """....  
-00002710: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00002720: 662e 5f5f 636f 6e65 7861 6f2e 6578 6563  f.__conexao.exec
-00002730: 7574 6528 7371 6c29 0d0a 0d0a 2320 544f  ute(sql)....# TO
-00002740: 444f 3a20 6372 6961 7220 6dc3 a974 6f64  DO: criar m..tod
-00002750: 6f73 2069 6e73 6572 652c 2061 7475 616c  os insere, atual
-00002760: 697a 6120 283f 290d 0a20 2020 2064 6566  iza (?)..    def
-00002770: 2065 7865 6375 7461 2873 656c 662c 2073   executa(self, s
-00002780: 716c 2c20 636f 6d6d 6974 3d46 616c 7365  ql, commit=False
-00002790: 293a 0d0a 2020 2020 2020 2020 2222 220d  ):..        """.
-000027a0: 0a20 2020 2020 2020 2045 7865 6375 7461  .        Executa
-000027b0: 2075 6d20 636f 6d61 6e64 6f20 7371 6c20   um comando sql 
-000027c0: 6e6f 2062 616e 636f 2e20 4170 656e 6173  no banco. Apenas
-000027d0: 2063 6f6e 7375 6c74 6173 2073 c3a3 6f20   consultas s..o 
-000027e0: 7375 706f 7274 6164 6173 2065 6d20 756d  suportadas em um
-000027f0: 610d 0a20 2020 2020 2020 2063 6f6e 6578  a..        conex
-00002800: c3a3 6f20 646f 2074 6970 6f20 4a44 562e  ..o do tipo JDV.
-00002810: 0d0a 0d0a 2020 2020 2020 2020 4172 6773  ....        Args
-00002820: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
-00002830: 716c 2020 2020 203a 2073 716c 2061 2073  ql     : sql a s
-00002840: 6572 2065 7865 6375 7461 646f 206e 6f20  er executado no 
-00002850: 6261 6e63 6f0d 0a20 2020 2020 2020 2020  banco..         
-00002860: 2020 2063 6f6d 6d69 7420 203a 2066 6c61     commit  : fla
-00002870: 6720 696e 6469 6361 7469 7661 2073 6520  g indicativa se 
-00002880: 6861 7665 72c3 a120 756d 2063 6f6d 6d69  haver.. um commi
-00002890: 7420 6170 c3b3 7320 6120 6578 6563 75c3  t ap..s a execu.
-000028a0: a7c3 a36f 2064 6f0d 0a20 2020 2020 2020  ...o do..       
-000028b0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-000028c0: 716c 206f 7520 6ec3 a36f 200d 0a20 2020  ql ou n..o ..   
-000028d0: 2020 2020 2052 6574 3a0d 0a20 2020 2020       Ret:..     
-000028e0: 2020 2020 2020 2043 7572 736f 7220 636f         Cursor co
-000028f0: 6d20 6f20 7265 7375 6c74 6164 6f20 646f  m o resultado do
-00002900: 2063 6f6d 616e 646f 2073 716c 2e0d 0a20   comando sql... 
-00002910: 2020 2020 2020 2022 2222 0d0a 0d0a 2020         """....  
-00002920: 2020 2020 2020 7472 793a 0d0a 2020 2020        try:..    
-00002930: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00002940: 5f5f 7469 706f 5f63 6f6e 6578 616f 203d  __tipo_conexao =
-00002950: 3d20 226a 6476 223a 0d0a 2020 2020 2020  = "jdv":..      
-00002960: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-00002970: 662e 5f5f 6375 7273 6f72 5f6a 6476 2069  f.__cursor_jdv i
-00002980: 7320 6e6f 7420 4e6f 6e65 3a0d 0a20 2020  s not None:..   
-00002990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000029a0: 2023 2063 7572 736f 7220 6ac3 a120 7469   # cursor j.. ti
-000029b0: 6e68 6120 7369 646f 2075 7361 646f 2061  nha sido usado a
-000029c0: 6e74 6573 2028 7072 6f76 6176 656c 6d65  ntes (provavelme
-000029d0: 6e74 6520 c3a9 2075 6d20 0d0a 2020 2020  nte .. um ..    
-000029e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000029f0: 2320 7265 6361 7272 6567 616d 656e 746f  # recarregamento
-00002a00: 2064 6f73 2064 6164 6f73 290d 0a20 2020   dos dados)..   
-00002a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002a20: 2073 656c 662e 5f5f 6375 7273 6f72 5f6a   self.__cursor_j
-00002a30: 6476 2e63 6c6f 7365 2829 0d0a 0d0a 2020  dv.close()....  
-00002a40: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00002a50: 6170 656e 6173 2063 6f6e 7375 6c74 6173  apenas consultas
-00002a60: 2073 c3a3 6f20 7375 706f 7274 6164 6173   s..o suportadas
-00002a70: 2070 6172 6120 6f20 7469 706f 2064 6520   para o tipo de 
-00002a80: 636f 6e65 78c3 a36f 204a 4456 2c0d 0a20  conex..o JDV,.. 
-00002a90: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00002aa0: 2070 6f69 7320 6120 636f 6e65 78c3 a36f   pois a conex..o
-00002ab0: 2065 6d20 7369 206e c3a3 6f20 6578 6563   em si n..o exec
-00002ac0: 7574 6120 756d 2063 6f6d 616e 646f 2c20  uta um comando, 
-00002ad0: 6d61 7320 6170 656e 6173 2075 6d0d 0a20  mas apenas um.. 
-00002ae0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00002af0: 2063 7572 736f 7220 6465 6e74 726f 2064   cursor dentro d
-00002b00: 656c 610d 0a20 2020 2020 2020 2020 2020  ela..           
-00002b10: 2020 2020 2073 656c 662e 5f5f 6375 7273       self.__curs
-00002b20: 6f72 5f6a 6476 203d 2073 656c 662e 5f5f  or_jdv = self.__
-00002b30: 636f 6e65 7861 6f2e 6375 7273 6f72 2829  conexao.cursor()
-00002b40: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00002b50: 2020 2073 656c 662e 5f5f 6375 7273 6f72     self.__cursor
-00002b60: 5f6a 6476 2e65 7865 6375 7465 2873 716c  _jdv.execute(sql
-00002b70: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00002b80: 2020 2072 6567 6973 7472 6f73 203d 2073     registros = s
-00002b90: 656c 662e 5f5f 6375 7273 6f72 5f6a 6476  elf.__cursor_jdv
-00002ba0: 2e66 6574 6368 616c 6c28 290d 0a0d 0a20  .fetchall().... 
-00002bb0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00002bc0: 2074 7261 6e73 666f 726d 6120 6f20 6172   transforma o ar
-00002bd0: 7261 7920 6465 2074 7570 6c61 7320 7265  ray de tuplas re
-00002be0: 746f 726e 6164 6f20 7065 6c6f 2066 6574  tornado pelo fet
-00002bf0: 6368 616c 6c20 6e75 6d0d 0a20 2020 2020  chall num..     
-00002c00: 2020 2020 2020 2020 2020 2023 2067 656e             # gen
-00002c10: 6572 6174 6f72 2c20 7061 7261 2074 6572  erator, para ter
-00002c20: 2061 206d 6573 6d61 2069 6e74 6572 6661   a mesma interfa
-00002c30: 6365 2064 6520 756d 6120 7265 746f 726e  ce de uma retorn
-00002c40: 6f20 6465 2075 6d61 0d0a 2020 2020 2020  o de uma..      
-00002c50: 2020 2020 2020 2020 2020 2320 636f 6e73            # cons
-00002c60: 756c 7461 2071 7561 6e64 6f20 6665 6974  ulta quando feit
-00002c70: 6120 7065 6c6f 2053 514c 416c 6368 656d  a pelo SQLAlchem
-00002c80: 790d 0a20 2020 2020 2020 2020 2020 2020  y..             
-00002c90: 2020 2072 6574 203d 2028 6920 666f 7220     ret = (i for 
-00002ca0: 6920 696e 2072 6567 6973 7472 6f73 290d  i in registros).
-00002cb0: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-00002cc0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00002cd0: 2020 2020 6966 206e 6f74 2063 6f6d 6d69      if not commi
-00002ce0: 743a 0d0a 2020 2020 2020 2020 2020 2020  t:..            
-00002cf0: 2020 2020 2020 2020 7265 7420 3d20 7365          ret = se
-00002d00: 6c66 2e5f 5f63 6f6e 6578 616f 2e65 7865  lf.__conexao.exe
-00002d10: 6375 7465 2873 716c 290d 0a20 2020 2020  cute(sql)..     
-00002d20: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00002d30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00002d40: 2020 2020 2020 7472 616e 7320 3d20 7365        trans = se
-00002d50: 6c66 2e5f 5f63 6f6e 6578 616f 2e62 6567  lf.__conexao.beg
-00002d60: 696e 2829 0d0a 2020 2020 2020 2020 2020  in()..          
-00002d70: 2020 2020 2020 2020 2020 7265 7420 3d20            ret = 
-00002d80: 7365 6c66 2e5f 5f63 6f6e 6578 616f 2e65  self.__conexao.e
-00002d90: 7865 6375 7465 2873 716c 290d 0a20 2020  xecute(sql)..   
+00002310: 2020 2020 2020 2020 2020 2020 225c 6e50              "\nP
+00002320: 6172 c3a2 6d65 7472 6f20 6465 2063 6f6e  ar..metro de con
+00002330: 6578 616f 2022 202b 2073 7472 2865 7272  exao " + str(err
+00002340: 2920 2b20 0d0a 2020 2020 2020 2020 2020  ) + ..          
+00002350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002360: 2020 2220 6ec3 a36f 2065 6e63 6f6e 7472    " n..o encontr
+00002370: 6164 6f2e 2229 0d0a 2020 2020 2020 2020  ado.")..        
+00002380: 2020 2020 2020 2020 7261 6973 6520 5275          raise Ru
+00002390: 6e74 696d 6545 7272 6f72 0d0a 0d0a 2020  ntimeError....  
+000023a0: 2020 2020 2020 2020 2020 6578 6365 7074            except
+000023b0: 2045 7863 6570 7469 6f6e 2061 7320 6572   Exception as er
+000023c0: 723a 0d0a 2020 2020 2020 2020 2020 2020  r:..            
+000023d0: 2020 2020 2320 7465 6d20 7175 6520 7465      # tem que te
+000023e0: 7220 6573 7365 2074 6573 7465 2061 7175  r esse teste aqu
+000023f0: 6920 706f 6973 206f 2063 6f6e 7374 7275  i pois o constru
+00002400: 746f 7220 6ac3 a120 6578 6962 6972 c3a1  tor j.. exibir..
+00002410: 2061 0d0a 2020 2020 2020 2020 2020 2020   a..            
+00002420: 2020 2020 2320 6d65 6e73 6167 656d 2064      # mensagem d
+00002430: 6520 6572 726f 2063 6173 6f20 6861 6a61  e erro caso haja
+00002440: 2061 6c67 756d 2070 726f 626c 656d 6120   algum problema 
+00002450: 636f 6d20 6f73 2070 6172 c3a2 6d65 7472  com os par..metr
+00002460: 6f73 0d0a 2020 2020 2020 2020 2020 2020  os..            
+00002470: 2020 2020 6966 2073 7472 2865 7272 2920      if str(err) 
+00002480: 213d 2022 223a 0d0a 2020 2020 2020 2020  != "":..        
+00002490: 2020 2020 2020 2020 2020 2020 636c 732e              cls.
+000024a0: 652e 5f28 2020 2020 2245 7272 6f20 616f  e._(    "Erro ao
+000024b0: 2063 6f6e 6563 7461 7220 636f 6d20 6f20   conectar com o 
+000024c0: 6261 6e63 6f20 6465 2064 6164 6f73 2e20  banco de dados. 
+000024d0: 2220 0d0a 2020 2020 2020 2020 2020 2020  " ..            
+000024e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000024f0: 2020 2020 225c 6e44 6574 616c 6865 7320      "\nDetalhes 
+00002500: 646f 2065 7272 6f3a 5c6e 2220 2b20 7374  do erro:\n" + st
+00002510: 7228 6572 7229 290d 0a20 2020 2020 2020  r(err))..       
+00002520: 2020 2020 2020 2020 2072 6169 7365 2052           raise R
+00002530: 756e 7469 6d65 4572 726f 720d 0a0d 0a20  untimeError.... 
+00002540: 2020 2020 2020 2072 6574 7572 6e20 7475         return tu
+00002550: 706c 6528 636f 6e65 786f 6573 290d 0a0d  ple(conexoes)...
+00002560: 0a20 2020 2040 7072 6f70 6572 7479 0d0a  .    @property..
+00002570: 2020 2020 6465 6620 636f 6e65 7861 6f28      def conexao(
+00002580: 7365 6c66 293a 0d0a 2020 2020 2020 2020  self):..        
+00002590: 7265 7475 726e 2073 656c 662e 5f5f 636f  return self.__co
+000025a0: 6e65 7861 6f0d 0a0d 0a20 2020 2040 7072  nexao....    @pr
+000025b0: 6f70 6572 7479 0d0a 2020 2020 6465 6620  operty..    def 
+000025c0: 7573 7561 7269 6f28 7365 6c66 293a 0d0a  usuario(self):..
+000025d0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+000025e0: 656c 662e 5f5f 7573 7561 7269 6f0d 0a0d  elf.__usuario...
+000025f0: 0a20 2020 2023 2054 4f44 4f3a 2070 7265  .    # TODO: pre
+00002600: 6369 7361 2064 6573 7365 2063 6f6e 7375  cisa desse consu
+00002610: 6c74 613f 206e c3a3 6f20 706f 6465 2073  lta? n..o pode s
+00002620: 6572 2073 c3b3 206f 2065 7865 6375 7461  er s.. o executa
+00002630: 3f20 7365 2073 696d 2c20 7072 6563 6973  ? se sim, precis
+00002640: 6172 2c20 656e 74c3 a36f 2066 617a c3aa  ar, ent..o faz..
+00002650: 2d6c 6f20 6368 616d 6172 206f 2065 7865  -lo chamar o exe
+00002660: 6375 7461 2065 2074 6573 7461 7220 7365  cuta e testar se
+00002670: 206f 2073 716c 20c3 a920 6d65 736d 6f20   o sql .. mesmo 
+00002680: 6465 2075 6d61 2063 6f6e 7375 6c74 613b  de uma consulta;
+00002690: 206f 2074 7279 2076 6169 2066 6963 6172   o try vai ficar
+000026a0: 206e 6f20 6d65 7520 6578 6563 7574 6128   no meu executa(
+000026b0: 290d 0a20 2020 2064 6566 2063 6f6e 7375  )..    def consu
+000026c0: 6c74 6128 7365 6c66 2c20 7371 6c29 3a0d  lta(self, sql):.
+000026d0: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+000026e0: 2020 2020 2020 4578 6563 7574 6120 756d        Executa um
+000026f0: 6120 636f 6d61 6e64 6f20 6465 2063 6f6e  a comando de con
+00002700: 7375 6c74 6120 6e6f 2062 616e 636f 2e0d  sulta no banco..
+00002710: 0a0d 0a20 2020 2020 2020 2041 7267 733a  ...        Args:
+00002720: 0d0a 2020 2020 2020 2020 2020 2020 7371  ..            sq
+00002730: 6c20 2020 2020 3a20 5345 4c45 4354 2061  l     : SELECT a
+00002740: 2073 6572 2065 7865 6375 7461 646f 206e   ser executado n
+00002750: 6f20 6261 6e63 6f0d 0a20 2020 2020 2020  o banco..       
+00002760: 2052 6574 3a0d 0a20 2020 2020 2020 2020   Ret:..         
+00002770: 2020 2043 7572 736f 7220 636f 6d20 6f20     Cursor com o 
+00002780: 7265 7375 6c74 6164 6f20 646f 2053 454c  resultado do SEL
+00002790: 4543 542e 0d0a 2020 2020 2020 2020 2222  ECT...        ""
+000027a0: 220d 0a0d 0a20 2020 2020 2020 2072 6574  "....        ret
+000027b0: 7572 6e20 7365 6c66 2e5f 5f63 6f6e 6578  urn self.__conex
+000027c0: 616f 2e65 7865 6375 7465 2873 716c 290d  ao.execute(sql).
+000027d0: 0a0d 0a20 2020 2064 6566 2065 7865 6375  ...    def execu
+000027e0: 7461 2873 656c 662c 2073 716c 2c20 636f  ta(self, sql, co
+000027f0: 6d6d 6974 3d46 616c 7365 293a 0d0a 2020  mmit=False):..  
+00002800: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+00002810: 2020 2045 7865 6375 7461 2075 6d20 636f     Executa um co
+00002820: 6d61 6e64 6f20 7371 6c20 6e6f 2062 616e  mando sql no ban
+00002830: 636f 2e20 4170 656e 6173 2063 6f6e 7375  co. Apenas consu
+00002840: 6c74 6173 2073 c3a3 6f20 7375 706f 7274  ltas s..o suport
+00002850: 6164 6173 2065 6d20 756d 610d 0a20 2020  adas em uma..   
+00002860: 2020 2020 2063 6f6e 6578 c3a3 6f20 646f       conex..o do
+00002870: 2074 6970 6f20 4a44 562e 0d0a 0d0a 2020   tipo JDV.....  
+00002880: 2020 2020 2020 4172 6773 3a0d 0a20 2020        Args:..   
+00002890: 2020 2020 2020 2020 2073 716c 2020 2020           sql    
+000028a0: 203a 2073 716c 2061 2073 6572 2065 7865   : sql a ser exe
+000028b0: 6375 7461 646f 206e 6f20 6261 6e63 6f0d  cutado no banco.
+000028c0: 0a20 2020 2020 2020 2020 2020 2063 6f6d  .            com
+000028d0: 6d69 7420 203a 2066 6c61 6720 696e 6469  mit  : flag indi
+000028e0: 6361 7469 7661 2073 6520 6861 7665 72c3  cativa se haver.
+000028f0: a120 756d 2063 6f6d 6d69 7420 6170 c3b3  . um commit ap..
+00002900: 7320 6120 6578 6563 75c3 a7c3 a36f 2064  s a execu....o d
+00002910: 6f0d 0a20 2020 2020 2020 2020 2020 2020  o..             
+00002920: 2020 2020 2020 2020 2073 716c 206f 7520           sql ou 
+00002930: 6ec3 a36f 200d 0a20 2020 2020 2020 2052  n..o ..        R
+00002940: 6574 3a0d 0a20 2020 2020 2020 2020 2020  et:..           
+00002950: 2043 7572 736f 7220 636f 6d20 6f20 7265   Cursor com o re
+00002960: 7375 6c74 6164 6f20 646f 2063 6f6d 616e  sultado do coman
+00002970: 646f 2073 716c 2e0d 0a20 2020 2020 2020  do sql...       
+00002980: 2022 2222 0d0a 0d0a 2020 2020 2020 2020   """....        
+00002990: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
+000029a0: 2020 6966 2073 656c 662e 5f5f 7469 706f    if self.__tipo
+000029b0: 5f63 6f6e 6578 616f 203d 3d20 226a 6476  _conexao == "jdv
+000029c0: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
+000029d0: 2020 2020 6966 2073 656c 662e 5f5f 6375      if self.__cu
+000029e0: 7273 6f72 5f6a 6476 2069 7320 6e6f 7420  rsor_jdv is not 
+000029f0: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
+00002a00: 2020 2020 2020 2020 2020 2023 2063 7572             # cur
+00002a10: 736f 7220 6ac3 a120 7469 6e68 6120 7369  sor j.. tinha si
+00002a20: 646f 2075 7361 646f 2061 6e74 6573 2028  do usado antes (
+00002a30: 7072 6f76 6176 656c 6d65 6e74 6520 c3a9  provavelmente ..
+00002a40: 2075 6d20 0d0a 2020 2020 2020 2020 2020   um ..          
+00002a50: 2020 2020 2020 2020 2020 2320 7265 6361            # reca
+00002a60: 7272 6567 616d 656e 746f 2064 6f73 2064  rregamento dos d
+00002a70: 6164 6f73 290d 0a20 2020 2020 2020 2020  ados)..         
+00002a80: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00002a90: 5f5f 6375 7273 6f72 5f6a 6476 2e63 6c6f  __cursor_jdv.clo
+00002aa0: 7365 2829 0d0a 0d0a 2020 2020 2020 2020  se()....        
+00002ab0: 2020 2020 2020 2020 2320 6170 656e 6173          # apenas
+00002ac0: 2063 6f6e 7375 6c74 6173 2073 c3a3 6f20   consultas s..o 
+00002ad0: 7375 706f 7274 6164 6173 2070 6172 6120  suportadas para 
+00002ae0: 6f20 7469 706f 2064 6520 636f 6e65 78c3  o tipo de conex.
+00002af0: a36f 204a 4456 2c0d 0a20 2020 2020 2020  .o JDV,..       
+00002b00: 2020 2020 2020 2020 2023 2070 6f69 7320           # pois 
+00002b10: 6120 636f 6e65 78c3 a36f 2065 6d20 7369  a conex..o em si
+00002b20: 206e c3a3 6f20 6578 6563 7574 6120 756d   n..o executa um
+00002b30: 2063 6f6d 616e 646f 2c20 6d61 7320 6170   comando, mas ap
+00002b40: 656e 6173 2075 6d0d 0a20 2020 2020 2020  enas um..       
+00002b50: 2020 2020 2020 2020 2023 2063 7572 736f           # curso
+00002b60: 7220 6465 6e74 726f 2064 656c 610d 0a20  r dentro dela.. 
+00002b70: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00002b80: 656c 662e 5f5f 6375 7273 6f72 5f6a 6476  elf.__cursor_jdv
+00002b90: 203d 2073 656c 662e 5f5f 636f 6e65 7861   = self.__conexa
+00002ba0: 6f2e 6375 7273 6f72 2829 200d 0a20 2020  o.cursor() ..   
+00002bb0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00002bc0: 662e 5f5f 6375 7273 6f72 5f6a 6476 2e65  f.__cursor_jdv.e
+00002bd0: 7865 6375 7465 2873 716c 290d 0a20 2020  xecute(sql)..   
+00002be0: 2020 2020 2020 2020 2020 2020 2072 6567               reg
+00002bf0: 6973 7472 6f73 203d 2073 656c 662e 5f5f  istros = self.__
+00002c00: 6375 7273 6f72 5f6a 6476 2e66 6574 6368  cursor_jdv.fetch
+00002c10: 616c 6c28 290d 0a0d 0a20 2020 2020 2020  all()....       
+00002c20: 2020 2020 2020 2020 2023 2074 7261 6e73           # trans
+00002c30: 666f 726d 6120 6f20 6172 7261 7920 6465  forma o array de
+00002c40: 2074 7570 6c61 7320 7265 746f 726e 6164   tuplas retornad
+00002c50: 6f20 7065 6c6f 2066 6574 6368 616c 6c20  o pelo fetchall 
+00002c60: 6e75 6d0d 0a20 2020 2020 2020 2020 2020  num..           
+00002c70: 2020 2020 2023 2067 656e 6572 6174 6f72       # generator
+00002c80: 2c20 7061 7261 2074 6572 2061 206d 6573  , para ter a mes
+00002c90: 6d61 2069 6e74 6572 6661 6365 2064 6520  ma interface de 
+00002ca0: 756d 6120 7265 746f 726e 6f20 6465 2075  uma retorno de u
+00002cb0: 6d61 0d0a 2020 2020 2020 2020 2020 2020  ma..            
+00002cc0: 2020 2020 2320 636f 6e73 756c 7461 2071      # consulta q
+00002cd0: 7561 6e64 6f20 6665 6974 6120 7065 6c6f  uando feita pelo
+00002ce0: 2053 514c 416c 6368 656d 790d 0a20 2020   SQLAlchemy..   
+00002cf0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+00002d00: 203d 2028 6920 666f 7220 6920 696e 2072   = (i for i in r
+00002d10: 6567 6973 7472 6f73 290d 0a20 2020 2020  egistros)..     
+00002d20: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+00002d30: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00002d40: 206e 6f74 2063 6f6d 6d69 743a 0d0a 2020   not commit:..  
+00002d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002d60: 2020 7265 7420 3d20 7365 6c66 2e5f 5f63    ret = self.__c
+00002d70: 6f6e 6578 616f 2e65 7865 6375 7465 2873  onexao.execute(s
+00002d80: 716c 290d 0a20 2020 2020 2020 2020 2020  ql)..           
+00002d90: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
 00002da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002db0: 2074 7261 6e73 2e63 6f6d 6d69 7428 290d   trans.commit().
-00002dc0: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
-00002dd0: 4578 6365 7074 696f 6e20 6173 2065 7272  Exception as err
-00002de0: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
-00002df0: 656c 662e 652e 5f28 2020 2022 4572 726f  elf.e._(   "Erro
-00002e00: 2061 6f20 6578 6563 7574 6172 206f 2073   ao executar o s
-00002e10: 6567 7569 6e74 6520 636f 6d61 6e64 6f20  eguinte comando 
-00002e20: 6e6f 2062 616e 636f 2064 6520 220d 0a20  no banco de ".. 
-00002e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002e40: 2020 2020 2020 2022 6461 646f 733a 5c6e         "dados:\n
-00002e50: 2220 2b20 7371 6c20 2b20 0d0a 2020 2020  " + sql + ..    
-00002e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002e70: 2020 2020 225c 6e44 6574 616c 6865 7320      "\nDetalhes 
-00002e80: 646f 2065 7272 6f3a 5c6e 2220 2b20 7374  do erro:\n" + st
-00002e90: 7228 6572 7229 290d 0a20 2020 2020 2020  r(err))..       
-00002ea0: 2020 2020 2072 6169 7365 2052 756e 7469       raise Runti
-00002eb0: 6d65 4572 726f 720d 0a0d 0a20 2020 2020  meError....     
-00002ec0: 2020 2072 6574 7572 6e20 7265 740d 0a0d     return ret...
-00002ed0: 0a20 2020 2064 6566 2069 6e73 6572 655f  .    def insere_
-00002ee0: 7661 7269 6f73 5f72 6567 6973 7472 6f73  varios_registros
-00002ef0: 2873 656c 662c 2069 6e73 6572 745f 7374  (self, insert_st
-00002f00: 6d74 2c20 7265 6769 7374 726f 7329 3a0d  mt, registros):.
-00002f10: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-00002f20: 2020 2020 2020 496e 7365 7265 2076 c3a1        Insere v..
-00002f30: 7269 6f73 2072 6567 6973 7472 6f73 2064  rios registros d
-00002f40: 6520 756d 6120 73c3 b320 7665 7a20 6e75  e uma s.. vez nu
-00002f50: 6d20 6261 6e63 6f20 6465 2064 6164 6f73  m banco de dados
-00002f60: 204f 7261 636c 652e 0d0a 2020 2020 2020   Oracle...      
-00002f70: 2020 5175 616c 7175 6572 2065 7272 6f20    Qualquer erro 
-00002f80: 6469 7370 6172 6120 756d 6120 6578 6365  dispara uma exce
-00002f90: c3a7 c3a3 6f2e 0d0a 0d0a 2020 2020 2020  ....o.....      
-00002fa0: 2020 4172 6773 3a0d 0a20 2020 2020 2020    Args:..       
-00002fb0: 2069 6e73 6572 745f 7374 6d74 3a20 636f   insert_stmt: co
-00002fc0: 6d61 6e64 6f20 7371 6c20 6465 2069 6e73  mando sql de ins
-00002fd0: 6572 742c 206e 6f20 666f 726d 6174 6f20  ert, no formato 
-00002fe0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00002ff0: 2020 2020 2020 2022 696e 7365 7274 2069         "insert i
-00003000: 6e74 6f20 7461 6265 6c61 2028 636f 6c75  nto tabela (colu
-00003010: 6e61 312c 2063 6f6c 756e 6132 2c20 2e2e  na1, coluna2, ..
-00003020: 2e29 2076 616c 7565 7320 283a 312c 203a  .) values (:1, :
-00003030: 3229 220d 0a20 2020 2020 2020 2072 6567  2)"..        reg
-00003040: 6973 7472 6f73 3a20 2020 6172 7261 7920  istros:   array 
-00003050: 6465 2074 7570 6c61 7320 636f 6d20 6f73  de tuplas com os
-00003060: 2076 616c 6f72 6573 2064 6520 6361 6461   valores de cada
-00003070: 2072 6567 6973 7472 6f20 6120 7365 720d   registro a ser.
-00003080: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00003090: 2020 2020 2020 696e 7365 7269 646f 0d0a        inserido..
-000030a0: 2020 2020 2020 2020 2222 220d 0a0d 0a20          """.... 
-000030b0: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
-000030c0: 2020 2020 2020 2020 2063 7572 736f 7220           cursor 
-000030d0: 3d20 7365 6c66 2e5f 5f63 6f6e 6578 616f  = self.__conexao
-000030e0: 5f72 6177 5f6f 7261 636c 652e 6375 7273  _raw_oracle.curs
-000030f0: 6f72 2829 0d0a 2020 2020 2020 2020 2020  or()..          
-00003100: 2020 6375 7273 6f72 2e65 7865 6375 7465    cursor.execute
-00003110: 6d61 6e79 2869 6e73 6572 745f 7374 6d74  many(insert_stmt
-00003120: 2c20 7265 6769 7374 726f 7329 0d0a 2020  , registros)..  
-00003130: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00003140: 5f63 6f6e 6578 616f 5f72 6177 5f6f 7261  _conexao_raw_ora
-00003150: 636c 652e 636f 6d6d 6974 2829 0d0a 2020  cle.commit()..  
-00003160: 2020 2020 2020 6578 6365 7074 2045 7863        except Exc
-00003170: 6570 7469 6f6e 2061 7320 6572 723a 0d0a  eption as err:..
-00003180: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00003190: 2e65 2e5f 2820 2020 2245 7272 6f20 616f  .e._(   "Erro ao
-000031a0: 2065 7865 6375 7461 7220 6f20 7365 6775   executar o segu
-000031b0: 696e 7465 2063 6f6d 616e 646f 206e 6f20  inte comando no 
-000031c0: 6261 6e63 6f20 6465 2022 0d0a 2020 2020  banco de "..    
-000031d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000031e0: 2020 2020 2264 6164 6f73 3a5c 6e22 202b      "dados:\n" +
-000031f0: 2069 6e73 6572 745f 7374 6d74 202b 200d   insert_stmt + .
-00003200: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00003210: 2020 2020 2020 2020 2022 5c6e 4465 7461           "\nDeta
-00003220: 6c68 6573 2064 6f20 6572 726f 3a5c 6e22  lhes do erro:\n"
-00003230: 202b 2073 7472 2865 7272 2920 2b20 0d0a   + str(err) + ..
-00003240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003250: 2020 2020 2020 2020 225c 6e5c 6e52 6567          "\n\nReg
-00003260: 6973 7472 6f73 2071 7565 2074 656e 7461  istros que tenta
-00003270: 7261 6d20 7365 7220 696e 7365 7269 646f  ram ser inserido
-00003280: 733a 5c6e 2220 2b20 0d0a 2020 2020 2020  s:\n" + ..      
-00003290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000032a0: 2020 7374 7228 7265 6769 7374 726f 7329    str(registros)
-000032b0: 290d 0a20 2020 2020 2020 2020 2020 2072  )..            r
-000032c0: 6169 7365 2052 756e 7469 6d65 4572 726f  aise RuntimeErro
-000032d0: 720d 0a0d 0a20 2020 2064 6566 2067 6574  r....    def get
-000032e0: 5f61 676f 7261 2873 656c 6629 3a0d 0a20  _agora(self):.. 
-000032f0: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
-00003300: 2020 2020 5265 746f 726e 6120 6f20 6469      Retorna o di
-00003310: 6120 6520 686f 7261 2061 7475 6169 7320  a e hora atuais 
-00003320: 646f 2062 616e 636f 2e0d 0a20 2020 2020  do banco...     
-00003330: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-00003340: 7265 7475 726e 2073 656c 662e 636f 6e73  return self.cons
-00003350: 756c 7461 2822 7365 6c65 6374 2073 7973  ulta("select sys
-00003360: 6461 7465 2066 726f 6d20 6475 616c 2229  date from dual")
-00003370: 2e66 6972 7374 2829 5b30 5d0d 0a0d 0a20  .first()[0].... 
-00003380: 2020 2064 6566 2074 6162 656c 615f 6578     def tabela_ex
-00003390: 6973 7465 2873 656c 662c 2074 6162 656c  iste(self, tabel
-000033a0: 6129 3a0d 0a20 2020 2020 2020 2022 2222  a):..        """
-000033b0: 0d0a 2020 2020 2020 2020 5665 7269 6669  ..        Verifi
-000033c0: 6361 2073 6520 756d 6120 7461 6265 6c61  ca se uma tabela
-000033d0: 2065 7869 7374 6520 6e6f 2062 616e 636f   existe no banco
-000033e0: 2e0d 0a0d 0a20 2020 2020 2020 2041 7267  .....        Arg
-000033f0: 3a0d 0a20 2020 2020 2020 2020 2020 2074  :..            t
-00003400: 6162 656c 6120 203a 206e 6f6d 6520 6461  abela  : nome da
-00003410: 2074 6162 656c 6120 6e6f 2062 616e 636f   tabela no banco
-00003420: 0d0a 2020 2020 2020 2020 5265 743a 0d0a  ..        Ret:..
-00003430: 2020 2020 2020 2020 2020 2020 5472 7565              True
-00003440: 2073 6520 7461 6265 6c61 2065 7869 7374   se tabela exist
-00003450: 652c 2046 616c 7365 2073 6520 6ec3 a36f  e, False se n..o
-00003460: 2065 7869 7374 652e 0d0a 2020 2020 2020   existe...      
-00003470: 2020 2222 220d 0a20 2020 2020 2020 2072    """..        r
-00003480: 6574 7572 6e20 7365 6c66 2e5f 5f63 6f6e  eturn self.__con
-00003490: 6578 616f 2e64 6961 6c65 6374 2e68 6173  exao.dialect.has
-000034a0: 5f74 6162 6c65 2873 656c 662e 5f5f 636f  _table(self.__co
-000034b0: 6e65 7861 6f2c 2074 6162 656c 6129 0d0a  nexao, tabela)..
-000034c0: 0d0a 2020 2020 6465 6620 6170 6167 615f  ..    def apaga_
-000034d0: 7265 6769 7374 726f 7328 7365 6c66 2c20  registros(self, 
-000034e0: 7461 6265 6c61 2c20 636f 6e64 6963 616f  tabela, condicao
-000034f0: 3d4e 6f6e 652c 2063 6f6d 6d69 743d 4661  =None, commit=Fa
-00003500: 6c73 6529 3a0d 0a20 2020 2020 2020 2022  lse):..        "
-00003510: 2222 0d0a 2020 2020 2020 2020 4170 6167  ""..        Apag
-00003520: 6120 7265 6769 7374 726f 7320 6465 2075  a registros de u
-00003530: 6d61 2074 6162 656c 6120 6e6f 2062 616e  ma tabela no ban
-00003540: 636f 2c20 6465 2061 636f 7264 6f20 636f  co, de acordo co
-00003550: 6d20 6120 636f 6e64 69c3 a7c3 a36f 0d0a  m a condi....o..
-00003560: 2020 2020 2020 2020 696e 666f 726d 6164          informad
-00003570: 612e 0d0a 0d0a 2020 2020 2020 2020 4172  a.....        Ar
-00003580: 6773 3a0d 0a20 2020 2020 2020 2020 2020  gs:..           
-00003590: 2074 6162 656c 6120 2020 2020 203a 206e   tabela      : n
-000035a0: 6f6d 6520 6461 2074 6162 656c 610d 0a20  ome da tabela.. 
-000035b0: 2020 2020 2020 2020 2020 2063 6f6e 6469             condi
-000035c0: 6361 6f20 2020 203a 2063 6f6e 6469 c3a7  cao    : condi..
-000035d0: c3a3 6f20 5748 4552 4520 6461 2064 656c  ..o WHERE da del
-000035e0: 65c3 a7c3 a36f 3b20 7365 206e c3a3 6f20  e....o; se n..o 
-000035f0: 696e 666f 726d 6164 6f2c 2061 7061 6761  informado, apaga
-00003600: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00003610: 2020 2020 2020 2020 2020 2020 746f 6461              toda
-00003620: 7320 6173 206c 696e 6861 7320 6461 2074  s as linhas da t
-00003630: 6162 656c 610d 0a20 2020 2020 2020 2020  abela..         
-00003640: 2020 2063 6f6d 6d69 7420 2020 2020 203a     commit      :
-00003650: 2066 6c61 6720 696e 6469 6361 7469 7661   flag indicativa
-00003660: 2073 6520 6861 7665 72c3 a120 756d 2063   se haver.. um c
-00003670: 6f6d 6d69 7420 6170 c3b3 7320 6120 6578  ommit ap..s a ex
-00003680: 6563 75c3 a7c3 a36f 200d 0a20 2020 2020  ecu....o ..     
-00003690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000036a0: 2020 2020 2064 6120 6465 6c65 c3a7 c3a3       da dele....
-000036b0: 6f20 6f75 206e c3a3 6f20 0d0a 2020 2020  o ou n..o ..    
-000036c0: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
-000036d0: 2069 6620 636f 6e64 6963 616f 2069 7320   if condicao is 
-000036e0: 6e6f 7420 4e6f 6e65 3a0d 0a20 2020 2020  not None:..     
-000036f0: 2020 2020 2020 2063 6f6e 6469 6361 6f20         condicao 
-00003700: 3d20 2220 7768 6572 6520 2220 2b20 636f  = " where " + co
-00003710: 6e64 6963 616f 0d0a 2020 2020 2020 2020  ndicao..        
-00003720: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-00003730: 2020 2063 6f6e 6469 6361 6f20 3d20 2222     condicao = ""
-00003740: 0d0a 0d0a 2020 2020 2020 2020 7371 6c20  ....        sql 
-00003750: 3d20 2264 656c 6574 6520 6672 6f6d 2022  = "delete from "
-00003760: 202b 2074 6162 656c 6120 2b20 636f 6e64   + tabela + cond
-00003770: 6963 616f 0d0a 2020 2020 2020 2020 7472  icao..        tr
-00003780: 793a 0d0a 2020 2020 2020 2020 2020 2020  y:..            
-00003790: 7365 6c66 2e65 7865 6375 7461 2873 716c  self.executa(sql
-000037a0: 202c 2063 6f6d 6d69 7429 0d0a 2020 2020   , commit)..    
-000037b0: 2020 2020 6578 6365 7074 2045 7863 6570      except Excep
-000037c0: 7469 6f6e 2061 7320 6572 723a 0d0a 2020  tion as err:..  
-000037d0: 2020 2020 2020 2020 2020 7365 6c66 2e65            self.e
-000037e0: 2e5f 2820 2020 2245 7272 6f20 616f 2061  ._(   "Erro ao a
-000037f0: 7061 6761 7220 7265 6769 7374 726f 7320  pagar registros 
-00003800: 646f 2062 616e 636f 2064 6520 6461 646f  do banco de dado
-00003810: 732e 2220 0d0a 2020 2020 2020 2020 2020  s." ..          
-00003820: 2020 2020 2020 2020 2020 2020 2020 224f                "O
-00003830: 2073 6567 7569 6e74 6520 636f 6d61 6e64   seguinte comand
-00003840: 6f20 6661 6c68 6f75 3a5c 6e22 202b 2073  o falhou:\n" + s
-00003850: 716c 202b 200d 0a20 2020 2020 2020 2020  ql + ..         
-00003860: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00003870: 5c6e 4465 7461 6c68 6573 2064 6f20 6572  \nDetalhes do er
-00003880: 726f 3a5c 6e22 202b 2073 7472 2865 7272  ro:\n" + str(err
-00003890: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
-000038a0: 7261 6973 6520 5275 6e74 696d 6545 7272  raise RuntimeErr
-000038b0: 6f72 0d0a 0d0a 2020 2020 6465 6620 7472  or....    def tr
-000038c0: 756e 6361 5f74 6162 656c 6128 7365 6c66  unca_tabela(self
-000038d0: 2c20 7461 6265 6c61 2c20 636f 6d6d 6974  , tabela, commit
-000038e0: 3d46 616c 7365 293a 0d0a 2020 2020 2020  =False):..      
-000038f0: 2020 2222 220d 0a20 2020 2020 2020 2054    """..        T
-00003900: 7275 6e63 6120 756d 6120 7461 6265 6c61  runca uma tabela
-00003910: 206e 6f20 6261 6e63 6f2e 0d0a 0d0a 2020   no banco.....  
-00003920: 2020 2020 2020 4172 6773 3a0d 0a20 2020        Args:..   
-00003930: 2020 2020 2074 6162 656c 6120 203a 206e       tabela  : n
-00003940: 6f6d 6520 6461 2074 6162 656c 610d 0a20  ome da tabela.. 
-00003950: 2020 2020 2020 2063 6f6d 6d69 7420 203a         commit  :
-00003960: 2066 6c61 6720 696e 6469 6361 7469 7661   flag indicativa
-00003970: 2073 6520 6861 7665 72c3 a120 756d 2063   se haver.. um c
-00003980: 6f6d 6d69 7420 6170 c3b3 7320 6120 6578  ommit ap..s a ex
-00003990: 6563 75c3 a7c3 a36f 200d 0a20 2020 2020  ecu....o ..     
-000039a0: 2020 2020 2020 2020 2020 2020 2064 6120               da 
-000039b0: 6f70 6572 61c3 a7c3 a36f 206f 7520 6ec3  opera....o ou n.
-000039c0: a36f 200d 0a20 2020 2020 2020 2022 2222  .o ..        """
-000039d0: 0d0a 2020 2020 2020 2020 7371 6c20 3d20  ..        sql = 
-000039e0: 2274 7275 6e63 6174 6520 7461 626c 6520  "truncate table 
-000039f0: 2220 2b20 7461 6265 6c61 0d0a 2020 2020  " + tabela..    
-00003a00: 2020 2020 7472 793a 0d0a 2020 2020 2020      try:..      
-00003a10: 2020 2020 2020 7365 6c66 2e65 7865 6375        self.execu
-00003a20: 7461 2873 716c 202c 2063 6f6d 6d69 7429  ta(sql , commit)
-00003a30: 0d0a 2020 2020 2020 2020 6578 6365 7074  ..        except
-00003a40: 2045 7863 6570 7469 6f6e 2061 7320 6572   Exception as er
-00003a50: 723a 0d0a 2020 2020 2020 2020 2020 2020  r:..            
-00003a60: 7365 6c66 2e65 2e5f 2820 2020 2245 7272  self.e._(   "Err
-00003a70: 6f20 616f 2074 7275 6e63 6172 2075 6d61  o ao truncar uma
-00003a80: 2074 6162 656c 6120 646f 2062 616e 636f   tabela do banco
-00003a90: 2064 6520 6461 646f 732e 2220 0d0a 2020   de dados." ..  
-00003aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003ab0: 2020 2020 2020 224f 2073 6567 7569 6e74        "O seguint
-00003ac0: 6520 636f 6d61 6e64 6f20 6661 6c68 6f75  e comando falhou
-00003ad0: 3a5c 6e22 202b 2073 716c 202b 200d 0a20  :\n" + sql + .. 
-00003ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003af0: 2020 2020 2020 2022 5c6e 4465 7461 6c68         "\nDetalh
-00003b00: 6573 2064 6f20 6572 726f 3a5c 6e22 202b  es do erro:\n" +
-00003b10: 2073 7472 2865 7272 2929 0d0a 2020 2020   str(err))..    
-00003b20: 2020 2020 2020 2020 7261 6973 6520 5275          raise Ru
-00003b30: 6e74 696d 6545 7272 6f72 0d0a 0d0a       ntimeError....
+00002db0: 7472 616e 7320 3d20 7365 6c66 2e5f 5f63  trans = self.__c
+00002dc0: 6f6e 6578 616f 2e62 6567 696e 2829 0d0a  onexao.begin()..
+00002dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002de0: 2020 2020 7265 7420 3d20 7365 6c66 2e5f      ret = self._
+00002df0: 5f63 6f6e 6578 616f 2e65 7865 6375 7465  _conexao.execute
+00002e00: 2873 716c 290d 0a20 2020 2020 2020 2020  (sql)..         
+00002e10: 2020 2020 2020 2020 2020 2074 7261 6e73             trans
+00002e20: 2e63 6f6d 6d69 7428 290d 0a20 2020 2020  .commit()..     
+00002e30: 2020 2065 7863 6570 7420 4578 6365 7074     except Except
+00002e40: 696f 6e20 6173 2065 7272 3a0d 0a20 2020  ion as err:..   
+00002e50: 2020 2020 2020 2020 2073 656c 662e 652e           self.e.
+00002e60: 5f28 2020 2022 4572 726f 2061 6f20 6578  _(   "Erro ao ex
+00002e70: 6563 7574 6172 206f 2073 6567 7569 6e74  ecutar o seguint
+00002e80: 6520 636f 6d61 6e64 6f20 6e6f 2062 616e  e comando no ban
+00002e90: 636f 2064 6520 220d 0a20 2020 2020 2020  co de "..       
+00002ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002eb0: 2022 6461 646f 733a 5c6e 2220 2b20 7371   "dados:\n" + sq
+00002ec0: 6c20 2b20 0d0a 2020 2020 2020 2020 2020  l + ..          
+00002ed0: 2020 2020 2020 2020 2020 2020 2020 225c                "\
+00002ee0: 6e44 6574 616c 6865 7320 646f 2065 7272  nDetalhes do err
+00002ef0: 6f3a 5c6e 2220 2b20 7374 7228 6572 7229  o:\n" + str(err)
+00002f00: 290d 0a20 2020 2020 2020 2020 2020 2072  )..            r
+00002f10: 6169 7365 2052 756e 7469 6d65 4572 726f  aise RuntimeErro
+00002f20: 720d 0a0d 0a20 2020 2020 2020 2072 6574  r....        ret
+00002f30: 7572 6e20 7265 740d 0a0d 0a20 2020 2064  urn ret....    d
+00002f40: 6566 2069 6e73 6572 655f 7661 7269 6f73  ef insere_varios
+00002f50: 5f72 6567 6973 7472 6f73 2873 656c 662c  _registros(self,
+00002f60: 2069 6e73 6572 745f 7374 6d74 2c20 7265   insert_stmt, re
+00002f70: 6769 7374 726f 7329 3a0d 0a20 2020 2020  gistros):..     
+00002f80: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
+00002f90: 496e 7365 7265 2076 c3a1 7269 6f73 2072  Insere v..rios r
+00002fa0: 6567 6973 7472 6f73 2064 6520 756d 6120  egistros de uma 
+00002fb0: 73c3 b320 7665 7a20 6e75 6d20 6261 6e63  s.. vez num banc
+00002fc0: 6f20 6465 2064 6164 6f73 204f 7261 636c  o de dados Oracl
+00002fd0: 652e 0d0a 2020 2020 2020 2020 5175 616c  e...        Qual
+00002fe0: 7175 6572 2065 7272 6f20 6469 7370 6172  quer erro dispar
+00002ff0: 6120 756d 6120 6578 6365 c3a7 c3a3 6f2e  a uma exce....o.
+00003000: 0d0a 0d0a 2020 2020 2020 2020 4172 6773  ....        Args
+00003010: 3a0d 0a20 2020 2020 2020 2069 6e73 6572  :..        inser
+00003020: 745f 7374 6d74 3a20 636f 6d61 6e64 6f20  t_stmt: comando 
+00003030: 7371 6c20 6465 2069 6e73 6572 742c 206e  sql de insert, n
+00003040: 6f20 666f 726d 6174 6f20 0d0a 2020 2020  o formato ..    
+00003050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003060: 2022 696e 7365 7274 2069 6e74 6f20 7461   "insert into ta
+00003070: 6265 6c61 2028 636f 6c75 6e61 312c 2063  bela (coluna1, c
+00003080: 6f6c 756e 6132 2c20 2e2e 2e29 2076 616c  oluna2, ...) val
+00003090: 7565 7320 283a 312c 203a 3229 220d 0a20  ues (:1, :2)".. 
+000030a0: 2020 2020 2020 2072 6567 6973 7472 6f73         registros
+000030b0: 3a20 2020 6172 7261 7920 6465 2074 7570  :   array de tup
+000030c0: 6c61 7320 636f 6d20 6f73 2076 616c 6f72  las com os valor
+000030d0: 6573 2064 6520 6361 6461 2072 6567 6973  es de cada regis
+000030e0: 7472 6f20 6120 7365 720d 0a20 2020 2020  tro a ser..     
+000030f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003100: 696e 7365 7269 646f 0d0a 2020 2020 2020  inserido..      
+00003110: 2020 2222 220d 0a0d 0a20 2020 2020 2020    """....       
+00003120: 2074 7279 3a0d 0a20 2020 2020 2020 2020   try:..         
+00003130: 2020 2063 7572 736f 7220 3d20 7365 6c66     cursor = self
+00003140: 2e5f 5f63 6f6e 6578 616f 5f72 6177 5f6f  .__conexao_raw_o
+00003150: 7261 636c 652e 6375 7273 6f72 2829 0d0a  racle.cursor()..
+00003160: 2020 2020 2020 2020 2020 2020 6375 7273              curs
+00003170: 6f72 2e65 7865 6375 7465 6d61 6e79 2869  or.executemany(i
+00003180: 6e73 6572 745f 7374 6d74 2c20 7265 6769  nsert_stmt, regi
+00003190: 7374 726f 7329 0d0a 2020 2020 2020 2020  stros)..        
+000031a0: 2020 2020 7365 6c66 2e5f 5f63 6f6e 6578      self.__conex
+000031b0: 616f 5f72 6177 5f6f 7261 636c 652e 636f  ao_raw_oracle.co
+000031c0: 6d6d 6974 2829 0d0a 2020 2020 2020 2020  mmit()..        
+000031d0: 6578 6365 7074 2045 7863 6570 7469 6f6e  except Exception
+000031e0: 2061 7320 6572 723a 0d0a 2020 2020 2020   as err:..      
+000031f0: 2020 2020 2020 7365 6c66 2e65 2e5f 2820        self.e._( 
+00003200: 2020 2245 7272 6f20 616f 2065 7865 6375    "Erro ao execu
+00003210: 7461 7220 6f20 7365 6775 696e 7465 2063  tar o seguinte c
+00003220: 6f6d 616e 646f 206e 6f20 6261 6e63 6f20  omando no banco 
+00003230: 6465 2022 0d0a 2020 2020 2020 2020 2020  de "..          
+00003240: 2020 2020 2020 2020 2020 2020 2020 2264                "d
+00003250: 6164 6f73 3a5c 6e22 202b 2069 6e73 6572  ados:\n" + inser
+00003260: 745f 7374 6d74 202b 200d 0a20 2020 2020  t_stmt + ..     
+00003270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003280: 2020 2022 5c6e 4465 7461 6c68 6573 2064     "\nDetalhes d
+00003290: 6f20 6572 726f 3a5c 6e22 202b 2073 7472  o erro:\n" + str
+000032a0: 2865 7272 2920 2b20 0d0a 2020 2020 2020  (err) + ..      
+000032b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000032c0: 2020 225c 6e5c 6e52 6567 6973 7472 6f73    "\n\nRegistros
+000032d0: 2071 7565 2074 656e 7461 7261 6d20 7365   que tentaram se
+000032e0: 7220 696e 7365 7269 646f 733a 5c6e 2220  r inseridos:\n" 
+000032f0: 2b20 0d0a 2020 2020 2020 2020 2020 2020  + ..            
+00003300: 2020 2020 2020 2020 2020 2020 7374 7228              str(
+00003310: 7265 6769 7374 726f 7329 290d 0a20 2020  registros))..   
+00003320: 2020 2020 2020 2020 2072 6169 7365 2052           raise R
+00003330: 756e 7469 6d65 4572 726f 720d 0a0d 0a20  untimeError.... 
+00003340: 2020 2064 6566 2067 6574 5f61 676f 7261     def get_agora
+00003350: 2873 656c 6629 3a0d 0a20 2020 2020 2020  (self):..       
+00003360: 2022 2222 0d0a 2020 2020 2020 2020 5265   """..        Re
+00003370: 746f 726e 6120 6f20 6469 6120 6520 686f  torna o dia e ho
+00003380: 7261 2061 7475 6169 7320 646f 2062 616e  ra atuais do ban
+00003390: 636f 2e0d 0a20 2020 2020 2020 2022 2222  co...        """
+000033a0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+000033b0: 2073 656c 662e 636f 6e73 756c 7461 2822   self.consulta("
+000033c0: 7365 6c65 6374 2073 7973 6461 7465 2066  select sysdate f
+000033d0: 726f 6d20 6475 616c 2229 2e66 6972 7374  rom dual").first
+000033e0: 2829 5b30 5d0d 0a0d 0a20 2020 2064 6566  ()[0]....    def
+000033f0: 2074 6162 656c 615f 6578 6973 7465 2873   tabela_existe(s
+00003400: 656c 662c 2074 6162 656c 6129 3a0d 0a20  elf, tabela):.. 
+00003410: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+00003420: 2020 2020 5665 7269 6669 6361 2073 6520      Verifica se 
+00003430: 756d 6120 7461 6265 6c61 2065 7869 7374  uma tabela exist
+00003440: 6520 6e6f 2062 616e 636f 2e0d 0a0d 0a20  e no banco..... 
+00003450: 2020 2020 2020 2041 7267 3a0d 0a20 2020         Arg:..   
+00003460: 2020 2020 2020 2020 2074 6162 656c 6120           tabela 
+00003470: 203a 206e 6f6d 6520 6461 2074 6162 656c   : nome da tabel
+00003480: 6120 6e6f 2062 616e 636f 0d0a 2020 2020  a no banco..    
+00003490: 2020 2020 5265 743a 0d0a 2020 2020 2020      Ret:..      
+000034a0: 2020 2020 2020 5472 7565 2073 6520 7461        True se ta
+000034b0: 6265 6c61 2065 7869 7374 652c 2046 616c  bela existe, Fal
+000034c0: 7365 2073 6520 6ec3 a36f 2065 7869 7374  se se n..o exist
+000034d0: 652e 0d0a 2020 2020 2020 2020 2222 220d  e...        """.
+000034e0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000034f0: 7365 6c66 2e5f 5f63 6f6e 6578 616f 2e64  self.__conexao.d
+00003500: 6961 6c65 6374 2e68 6173 5f74 6162 6c65  ialect.has_table
+00003510: 2873 656c 662e 5f5f 636f 6e65 7861 6f2c  (self.__conexao,
+00003520: 2074 6162 656c 6129 0d0a 0d0a 2020 2020   tabela)....    
+00003530: 6465 6620 6170 6167 615f 7265 6769 7374  def apaga_regist
+00003540: 726f 7328 7365 6c66 2c20 7461 6265 6c61  ros(self, tabela
+00003550: 2c20 636f 6e64 6963 616f 3d4e 6f6e 652c  , condicao=None,
+00003560: 2063 6f6d 6d69 743d 4661 6c73 6529 3a0d   commit=False):.
+00003570: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+00003580: 2020 2020 2020 4170 6167 6120 7265 6769        Apaga regi
+00003590: 7374 726f 7320 6465 2075 6d61 2074 6162  stros de uma tab
+000035a0: 656c 6120 6e6f 2062 616e 636f 2c20 6465  ela no banco, de
+000035b0: 2061 636f 7264 6f20 636f 6d20 6120 636f   acordo com a co
+000035c0: 6e64 69c3 a7c3 a36f 0d0a 2020 2020 2020  ndi....o..      
+000035d0: 2020 696e 666f 726d 6164 612e 0d0a 0d0a    informada.....
+000035e0: 2020 2020 2020 2020 4172 6773 3a0d 0a20          Args:.. 
+000035f0: 2020 2020 2020 2020 2020 2074 6162 656c             tabel
+00003600: 6120 2020 2020 203a 206e 6f6d 6520 6461  a      : nome da
+00003610: 2074 6162 656c 610d 0a20 2020 2020 2020   tabela..       
+00003620: 2020 2020 2063 6f6e 6469 6361 6f20 2020       condicao   
+00003630: 203a 2063 6f6e 6469 c3a7 c3a3 6f20 5748   : condi....o WH
+00003640: 4552 4520 6461 2064 656c 65c3 a7c3 a36f  ERE da dele....o
+00003650: 3b20 7365 206e c3a3 6f20 696e 666f 726d  ; se n..o inform
+00003660: 6164 6f2c 2061 7061 6761 0d0a 2020 2020  ado, apaga..    
+00003670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003680: 2020 2020 2020 746f 6461 7320 6173 206c        todas as l
+00003690: 696e 6861 7320 6461 2074 6162 656c 610d  inhas da tabela.
+000036a0: 0a20 2020 2020 2020 2020 2020 2063 6f6d  .            com
+000036b0: 6d69 7420 2020 2020 203a 2066 6c61 6720  mit      : flag 
+000036c0: 696e 6469 6361 7469 7661 2073 6520 6861  indicativa se ha
+000036d0: 7665 72c3 a120 756d 2063 6f6d 6d69 7420  ver.. um commit 
+000036e0: 6170 c3b3 7320 6120 6578 6563 75c3 a7c3  ap..s a execu...
+000036f0: a36f 200d 0a20 2020 2020 2020 2020 2020  .o ..           
+00003700: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00003710: 6120 6465 6c65 c3a7 c3a3 6f20 6f75 206e  a dele....o ou n
+00003720: c3a3 6f20 0d0a 2020 2020 2020 2020 2222  ..o ..        ""
+00003730: 220d 0a20 2020 2020 2020 2069 6620 636f  "..        if co
+00003740: 6e64 6963 616f 2069 7320 6e6f 7420 4e6f  ndicao is not No
+00003750: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
+00003760: 2063 6f6e 6469 6361 6f20 3d20 2220 7768   condicao = " wh
+00003770: 6572 6520 2220 2b20 636f 6e64 6963 616f  ere " + condicao
+00003780: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
+00003790: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
+000037a0: 6469 6361 6f20 3d20 2222 0d0a 0d0a 2020  dicao = ""....  
+000037b0: 2020 2020 2020 7371 6c20 3d20 2264 656c        sql = "del
+000037c0: 6574 6520 6672 6f6d 2022 202b 2074 6162  ete from " + tab
+000037d0: 656c 6120 2b20 636f 6e64 6963 616f 0d0a  ela + condicao..
+000037e0: 2020 2020 2020 2020 7472 793a 0d0a 2020          try:..  
+000037f0: 2020 2020 2020 2020 2020 7365 6c66 2e65            self.e
+00003800: 7865 6375 7461 2873 716c 202c 2063 6f6d  xecuta(sql , com
+00003810: 6d69 7429 0d0a 2020 2020 2020 2020 6578  mit)..        ex
+00003820: 6365 7074 2045 7863 6570 7469 6f6e 2061  cept Exception a
+00003830: 7320 6572 723a 0d0a 2020 2020 2020 2020  s err:..        
+00003840: 2020 2020 7365 6c66 2e65 2e5f 2820 2020      self.e._(   
+00003850: 2245 7272 6f20 616f 2061 7061 6761 7220  "Erro ao apagar 
+00003860: 7265 6769 7374 726f 7320 646f 2062 616e  registros do ban
+00003870: 636f 2064 6520 6461 646f 732e 2220 0d0a  co de dados." ..
+00003880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003890: 2020 2020 2020 2020 224f 2073 6567 7569          "O segui
+000038a0: 6e74 6520 636f 6d61 6e64 6f20 6661 6c68  nte comando falh
+000038b0: 6f75 3a5c 6e22 202b 2073 716c 202b 200d  ou:\n" + sql + .
+000038c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000038d0: 2020 2020 2020 2020 2022 5c6e 4465 7461           "\nDeta
+000038e0: 6c68 6573 2064 6f20 6572 726f 3a5c 6e22  lhes do erro:\n"
+000038f0: 202b 2073 7472 2865 7272 2929 0d0a 2020   + str(err))..  
+00003900: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00003910: 5275 6e74 696d 6545 7272 6f72 0d0a 0d0a  RuntimeError....
+00003920: 2020 2020 6465 6620 7472 756e 6361 5f74      def trunca_t
+00003930: 6162 656c 6128 7365 6c66 2c20 7461 6265  abela(self, tabe
+00003940: 6c61 2c20 636f 6d6d 6974 3d46 616c 7365  la, commit=False
+00003950: 293a 0d0a 2020 2020 2020 2020 2222 220d  ):..        """.
+00003960: 0a20 2020 2020 2020 2054 7275 6e63 6120  .        Trunca 
+00003970: 756d 6120 7461 6265 6c61 206e 6f20 6261  uma tabela no ba
+00003980: 6e63 6f2e 0d0a 0d0a 2020 2020 2020 2020  nco.....        
+00003990: 4172 6773 3a0d 0a20 2020 2020 2020 2074  Args:..        t
+000039a0: 6162 656c 6120 203a 206e 6f6d 6520 6461  abela  : nome da
+000039b0: 2074 6162 656c 610d 0a20 2020 2020 2020   tabela..       
+000039c0: 2063 6f6d 6d69 7420 203a 2066 6c61 6720   commit  : flag 
+000039d0: 696e 6469 6361 7469 7661 2073 6520 6861  indicativa se ha
+000039e0: 7665 72c3 a120 756d 2063 6f6d 6d69 7420  ver.. um commit 
+000039f0: 6170 c3b3 7320 6120 6578 6563 75c3 a7c3  ap..s a execu...
+00003a00: a36f 200d 0a20 2020 2020 2020 2020 2020  .o ..           
+00003a10: 2020 2020 2020 2064 6120 6f70 6572 61c3         da opera.
+00003a20: a7c3 a36f 206f 7520 6ec3 a36f 200d 0a20  ...o ou n..o .. 
+00003a30: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+00003a40: 2020 2020 7371 6c20 3d20 2274 7275 6e63      sql = "trunc
+00003a50: 6174 6520 7461 626c 6520 2220 2b20 7461  ate table " + ta
+00003a60: 6265 6c61 0d0a 2020 2020 2020 2020 7472  bela..        tr
+00003a70: 793a 0d0a 2020 2020 2020 2020 2020 2020  y:..            
+00003a80: 7365 6c66 2e65 7865 6375 7461 2873 716c  self.executa(sql
+00003a90: 202c 2063 6f6d 6d69 7429 0d0a 2020 2020   , commit)..    
+00003aa0: 2020 2020 6578 6365 7074 2045 7863 6570      except Excep
+00003ab0: 7469 6f6e 2061 7320 6572 723a 0d0a 2020  tion as err:..  
+00003ac0: 2020 2020 2020 2020 2020 7365 6c66 2e65            self.e
+00003ad0: 2e5f 2820 2020 2245 7272 6f20 616f 2074  ._(   "Erro ao t
+00003ae0: 7275 6e63 6172 2075 6d61 2074 6162 656c  runcar uma tabel
+00003af0: 6120 646f 2062 616e 636f 2064 6520 6461  a do banco de da
+00003b00: 646f 732e 2220 0d0a 2020 2020 2020 2020  dos." ..        
+00003b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003b20: 224f 2073 6567 7569 6e74 6520 636f 6d61  "O seguinte coma
+00003b30: 6e64 6f20 6661 6c68 6f75 3a5c 6e22 202b  ndo falhou:\n" +
+00003b40: 2073 716c 202b 200d 0a20 2020 2020 2020   sql + ..       
+00003b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003b60: 2022 5c6e 4465 7461 6c68 6573 2064 6f20   "\nDetalhes do 
+00003b70: 6572 726f 3a5c 6e22 202b 2073 7472 2865  erro:\n" + str(e
+00003b80: 7272 2929 0d0a 2020 2020 2020 2020 2020  rr))..          
+00003b90: 2020 7261 6973 6520 5275 6e74 696d 6545    raise RuntimeE
+00003ba0: 7272 6f72 0d0a 0d0a                      rror....
```

### Comparing `stnblipy-4.9.0/blipy/erro.py` & `stnblipy-5.0.0/blipy/erro.py`

 * *Files identical despite different names*

### Comparing `stnblipy-4.9.0/blipy/planilha.py` & `stnblipy-5.0.0/blipy/planilha.py`

 * *Files 8% similar despite different names*

```diff
@@ -13,26 +13,26 @@
     Planilha a ser carregada no banco de dados.
     """
 
     # tratamento de erro
     e = erro.console
 
     def carrega_dados(self, 
-            io, sheet_name=0, header=0, skipfooter=0, 
+            arquivo, sheet_name=0, header=0, skipfooter=0, 
             names=None, index_col=None, usecols=None,
             skiprows=None, nrows=None, na_values=None, engine='openpyxl',
-            decimal=".", thousands=None):
+            thousands=None, dtype=None):
         """
         Lê uma aba de uma planilha de Excel e carrega em um Data Frame do
         Pandas.
 
         Referência: https://pandas.pydata.org/docs/reference/api/pandas.read_excel.html
 
         Args:
-        io:         caminho (path) do arquivo, com nome do arquivo incluso ou
+        arquivo:    caminho (path) do arquivo, com nome do arquivo incluso ou
                     uma URL
         sheet_name: aba ou guia do Excel, pode ser o nome ou número 0-indexed
         header:     linhas de cabeçalho a serem ignoradas, 0-indexed
         skipfooter: linhas de rodapé (final arquivo) a serem ignoradas,
                     0-indexed.
         names:      lista de nomes de colunas. Se arquivo não contém header,
                     deve-se obrigatoriamente setar header=None
@@ -41,60 +41,61 @@
                     ['ID','Coluna_1','Coluna_4']
         skiprows:   linhas a serem ignoradas no início do arquivo, 0-indexed
         nrows:      número de linhas a serem carregadas
         na_values:  lista de strings a serem consideradas como dados não
                     disponívels (NaN)
         engine:     o padrão é openpyxl. Existem outras para outros formatos,
                     por ex .odf
-        decimal:    separador de decimais
         thousands:  separador de milhar
+        dtype:      dict com os tipos das colunas da planilha, conforme 
+                    parâmetro dtype do Pandas
         """
 
         # Verificações de possíveis erros
-        if io is None:
-            self.e._("O argumento 'io' é o mínimo para funcionamento da função. \n"
+        if arquivo is None:
+            self.e._("O argumento 'arquivo' é o mínimo para funcionamento da função. \n"
                      "Este é o caminho (path) para a planilha com o nome do arquivo incluso ao final e com a extensão .xlsx ou .xls. \n"
                      "Formato esperado: C:/.../planilha.xlsx")
             raise RuntimeError
 
-        if io.endswith('.xlsx') and engine != 'openpyxl':
+        if arquivo.endswith('.xlsx') and engine != 'openpyxl':
             self.e._("Parâmetro 'engine' não adequado para o tipo de arquivo.\n"
-                     "O argumento 'io' caminho (path) para a planilha deve terminar com: .xlsx ou .xls.\n"
+                     "O argumento 'arquivo' caminho (path) para a planilha deve terminar com: .xlsx ou .xls.\n"
                      "Para cada formato de arquivo existe uma engine adequada.\n"
                      "Engine 'openpyxl' para .xlsx e 'xlrd' para .xls.\n"
-                     "Exemplos de parâmetro 'io' esperados:\n"
+                     "Exemplos de parâmetro 'arquivo' esperados:\n"
                      "\tC:/.../planilha.xlsx\n"
                      "\tC:/.../planilha.xls\n")
             raise RuntimeError
 
-        if io.endswith('.xls') and engine != 'xlrd':
+        if arquivo.endswith('.xls') and engine != 'xlrd':
             self.e._("Parâmetro 'engine' não adequado para o tipo de arquivo.\n"
-                     "O argumento 'io' caminho (path) para a planilha deve terminar com: .xlsx ou .xls.\n"
+                     "O argumento 'arquivo' caminho (path) para a planilha deve terminar com: .xlsx ou .xls.\n"
                      "Para cada formato de arquivo existe uma engine adequada.\n"
                      "Engine 'openpyxl' para .xlsx e 'xlrd' para .xls.\n"
-                     "Exemplos de parâmetro 'io' esperados:\n"
+                     "Exemplos de parâmetro 'arquivo' esperados:\n"
                      "\tC:/.../planilha.xlsx\n"
                      "\tC:/.../planilha.xls\n")
             raise RuntimeError
 
-        if not io.endswith(('.xlsx','.xls')):
-            self.e._("O argumento 'io' caminho (path) para a planilha deve terminar com: .xlsx ou .xls.\n"
+        if not arquivo.endswith(('.xlsx','.xls')):
+            self.e._("O argumento 'arquivo' caminho (path) para a planilha deve terminar com: .xlsx ou .xls.\n"
                      "Para cada formato de arquivo existe uma engine adequada.\n"
                      "Engine 'openpyxl' para .xlsx e 'xlrd' para .xls.\n"
-                     "Exemplos de parâmetro 'io' esperados:\n"
+                     "Exemplos de parâmetro 'arquivo' esperados:\n"
                      "\tC:/.../planilha.xlsx\n"
                      "\tC:/.../planilha.xls\n")
             raise RuntimeError
 
         # Carregamento da tabela para a memória
         try:
-            self._dataframe = pd.read_excel(io=io,sheet_name=sheet_name, 
+            self._dataframe = pd.read_excel(io=arquivo,sheet_name=sheet_name, 
                     header=header, skipfooter=skipfooter,
                     names=names, index_col=index_col, usecols=usecols, 
                     skiprows=skiprows, nrows=nrows, na_values=na_values, 
-                    engine=engine, decimal=decimal, thousands=thousands)
+                    engine=engine, thousands=thousands, dtype=dtype)
         except FileNotFoundError:
-            self.e._("Não foi possível abrir a planilha " + io)
+            self.e._("Não foi possível abrir a planilha " + arquivo)
             raise
 
-        self._nome = io
+        self._nome = arquivo
```

### Comparing `stnblipy-4.9.0/blipy/profiling.py` & `stnblipy-5.0.0/blipy/profiling.py`

 * *Files identical despite different names*

### Comparing `stnblipy-4.9.0/blipy/tabela_dataframe.py` & `stnblipy-5.0.0/blipy/tabela_dataframe.py`

 * *Files 14% similar despite different names*

```diff
@@ -67,32 +67,48 @@
 
     def formata_colunas(self, cols):
         """
         Altera a estrutura (colunas) do dataframe. Colunas podem ser suprimidas,
         duplicadas ou trocadas de ordem.
 
         Arg:
-        cols:   lista com o índice (zero-based) das colunas finais da planilha.
+        cols:   lista com o índice (zero-based) das colunas finais do dataframe.
                 Por exemplo, para duplicar a primeira coluna como última coluna
-                numa planilha original de 3 colunas, esse parâmetro deve ser
-                [0, 1, 2, 0]
+                num dataframe original de 3 colunas, esse parâmetro deve ser
+                [0, 1, 2, 0]. 
+
+                Pode haver uma lista dentro da lista, por exemplo
+                [0, [1, 2], 0]. Neste caso, o data frame final terá 4 colunas:
+                [0, 1, 2, 0]. Esta forma de lista dentro de lista não faz
+                diferença aqui, mas é útil em outra parte do código do Blipy
+                (na classe Job) quando mais de uma coluna de entrada é usada
+                para calcular uma única coluna de saída.
         """
 
         df_original = self._dataframe.copy()
         df_original_cols = list(df_original.columns)
         self._dataframe = pd.DataFrame()
 
         i = 0
         for col in cols:
-            self._dataframe.insert(
-                    i, 
-                    df_original_cols[col], 
-                    df_original[df_original_cols[col]],
-                    allow_duplicates=True)
-            i += 1
+            if isinstance(col, list):
+                for col1 in col:
+                    self._dataframe.insert(
+                            i, 
+                            df_original_cols[col1], 
+                            df_original[df_original_cols[col1]],
+                            allow_duplicates=True)
+                    i += 1
+            else:
+                self._dataframe.insert(
+                        i, 
+                        df_original_cols[col], 
+                        df_original[df_original_cols[col]],
+                        allow_duplicates=True)
+                i += 1
 
     # self._nome deve ser preenchido pelas classes filhas
     @property
     def nome(self):
         return self._nome
     @nome.setter
     def nome(self, nome):
```

### Comparing `stnblipy-4.9.0/blipy/tabela_entrada.py` & `stnblipy-5.0.0/blipy/tabela_entrada.py`

 * *Files identical despite different names*

### Comparing `stnblipy-4.9.0/blipy/tabela_html.py` & `stnblipy-5.0.0/blipy/tabela_html.py`

 * *Files 5% similar despite different names*

```diff
@@ -20,34 +20,35 @@
         # tipos_col: array com os tipos das colunas da tabela
         #            lida
         # Ret:
         # Um iterável com os registros da tabela lida.
     def carrega_dados(self, 
             url,
             tabela=0,
-            drop=0,
+            header=None,
             decimal=",", 
             thousands="."):
         """
         Carrega uma tabela em HTML a partir de uma URL.
 
         Args:
-        url:       a URL de onde a tabela será lida
-        tabela:    qual tabela será lida da URL, no caso de haver mais de uma
-                   na mesma página. Zero-based
-        drop:      quantos cabeçalhos serão dropados na tabela lida
-        decimal:   o indicador de separador decimal usado na tabela lida
-        thousands: o indicador de separador de milhar usado na tabela lida
+        url:        a URL de onde a tabela será lida
+        tabela:     qual tabela será lida da URL, no caso de haver mais de uma
+                    na mesma página. Zero-based
+        header:     quantidade de cabeçalhos na tabela lida, ou None se não
+                    houver cabeçalho
+        decimal:    o indicador de separador decimal usado na tabela lida
+        thousands:  o indicador de separador de milhar usado na tabela lida
         """
 
         self._dataframe = pd.read_html( 
                 io=url, 
                 decimal=decimal,
                 thousands=thousands)
 
         self._dataframe = self._dataframe[tabela]
-        if drop > 0:
-            for i in range(drop):
+        if header is not None:
+            for _ in range(header):
                 self._dataframe.columns = self._dataframe.columns.droplevel()
  
         self._nome = url
```

### Comparing `stnblipy-4.9.0/blipy/utils.py` & `stnblipy-5.0.0/blipy/utils.py`

 * *Files identical despite different names*

### Comparing `stnblipy-4.9.0/setup.py` & `stnblipy-5.0.0/setup.py`

 * *Files 14% similar despite different names*

```diff
@@ -1,66 +1,65 @@
 00000000: 0d0a 6672 6f6d 2073 6574 7570 746f 6f6c  ..from setuptool
 00000010: 7320 696d 706f 7274 2073 6574 7570 2c20  s import setup, 
 00000020: 6669 6e64 5f70 6163 6b61 6765 730d 0a0d  find_packages...
-00000030: 0a56 4552 5349 4f4e 203d 2027 342e 392e  .VERSION = '4.9.
+00000030: 0a56 4552 5349 4f4e 203d 2027 352e 302e  .VERSION = '5.0.
 00000040: 3027 200d 0a44 4553 4352 4950 5449 4f4e  0' ..DESCRIPTION
 00000050: 203d 2027 4672 616d 6577 6f72 6b20 7061   = 'Framework pa
 00000060: 7261 2072 6f74 696e 6173 2064 6520 4554  ra rotinas de ET
 00000070: 4c27 0d0a 4c4f 4e47 5f44 4553 4352 4950  L'..LONG_DESCRIP
 00000080: 5449 4f4e 203d 2027 4672 616d 6577 6f72  TION = 'Framewor
 00000090: 6b20 7061 7261 2073 696d 706c 6966 6963  k para simplific
 000000a0: 6172 206f 2064 6573 656e 766f 6c76 696d  ar o desenvolvim
 000000b0: 656e 746f 2064 6520 726f 7469 6e61 7320  ento de rotinas 
-000000c0: 7079 7468 6f6e 2c20 6573 7065 6369 616c  python, especial
-000000d0: 6d65 6e74 6520 726f 7469 6e61 7320 6465  mente rotinas de
-000000e0: 2045 544c 270d 0a0d 0a23 2053 6574 7469   ETL'....# Setti
-000000f0: 6e67 2075 700d 0a73 6574 7570 280d 0a20  ng up..setup(.. 
-00000100: 2020 2020 2020 206e 616d 653d 2273 746e         name="stn
-00000110: 626c 6970 7922 2c20 0d0a 2020 2020 2020  blipy", ..      
-00000120: 2020 7665 7273 696f 6e3d 5645 5253 494f    version=VERSIO
-00000130: 4e2c 0d0a 2020 2020 2020 2020 6175 7468  N,..        auth
-00000140: 6f72 3d22 5365 6372 6574 6172 6961 2064  or="Secretaria d
-00000150: 6f20 5465 736f 7572 6f20 4e61 6369 6f6e  o Tesouro Nacion
-00000160: 616c 222c 0d0a 2020 2020 2020 2020 2320  al",..        # 
-00000170: 6175 7468 6f72 5f65 6d61 696c 3d22 222c  author_email="",
-00000180: 0d0a 2020 2020 2020 2020 6c69 6365 6e73  ..        licens
-00000190: 653d 2247 504c 2076 3222 2c0d 0a20 2020  e="GPL v2",..   
-000001a0: 2020 2020 2064 6573 6372 6970 7469 6f6e       description
-000001b0: 3d44 4553 4352 4950 5449 4f4e 2c0d 0a20  =DESCRIPTION,.. 
-000001c0: 2020 2020 2020 206c 6f6e 675f 6465 7363         long_desc
-000001d0: 7269 7074 696f 6e3d 4c4f 4e47 5f44 4553  ription=LONG_DES
-000001e0: 4352 4950 5449 4f4e 2c0d 0a20 2020 2020  CRIPTION,..     
-000001f0: 2020 2070 6163 6b61 6765 733d 6669 6e64     packages=find
-00000200: 5f70 6163 6b61 6765 7328 292c 0d0a 2020  _packages(),..  
-00000210: 2020 2020 2020 696e 7374 616c 6c5f 7265        install_re
-00000220: 7175 6972 6573 3d5b 0d0a 2020 2020 2020  quires=[..      
-00000230: 2020 2020 2020 2273 716c 616c 6368 656d        "sqlalchem
-00000240: 793d 3d31 2e34 2e31 3522 2c20 0d0a 2020  y==1.4.15", ..  
-00000250: 2020 2020 2020 2020 2020 2263 782d 4f72            "cx-Or
-00000260: 6163 6c65 3d3d 372e 312e 3322 2c20 0d0a  acle==7.1.3", ..
-00000270: 2020 2020 2020 2020 2020 2020 226d 756c              "mul
-00000280: 7469 706c 6564 6973 7061 7463 683d 3d30  tipledispatch==0
-00000290: 2e36 2e30 222c 200d 0a20 2020 2020 2020  .6.0", ..       
-000002a0: 2020 2020 2022 7061 6e64 6173 3d3d 312e       "pandas==1.
-000002b0: 312e 3522 2c20 0d0a 2020 2020 2020 2020  1.5", ..        
-000002c0: 2020 2020 226f 7065 6e70 7978 6c3d 3d33      "openpyxl==3
-000002d0: 2e30 2e31 3022 2c20 0d0a 2020 2020 2020  .0.10", ..      
-000002e0: 2020 2020 2020 226c 786d 6c3d 3d34 2e39        "lxml==4.9
-000002f0: 2e31 222c 0d0a 2020 2020 2020 2020 2020  .1",..          
-00000300: 2020 2268 746d 6c35 6c69 623d 3d31 2e31    "html5lib==1.1
-00000310: 222c 0d0a 2020 2020 2020 2020 2020 2020  ",..            
-00000320: 2262 7334 3d3d 302e 302e 3122 2c0d 0a20  "bs4==0.0.1",.. 
-00000330: 2020 2020 2020 2020 2020 2022 786c 7264             "xlrd
-00000340: 3d3d 312e 312e 3022 2c0d 0a20 2020 2020  ==1.1.0",..     
-00000350: 2020 2020 2020 2022 7767 6574 3d3d 332e         "wget==3.
-00000360: 3222 2c0d 0a20 2020 2020 2020 2020 2020  2",..           
-00000370: 2022 4a61 7944 6542 6541 7069 3d3d 312e   "JayDeBeApi==1.
-00000380: 322e 3322 5d2c 0d0a 2020 2020 2020 2020  2.3"],..        
-00000390: 6b65 7977 6f72 6473 3d5b 2770 7974 686f  keywords=['pytho
-000003a0: 6e27 2c20 2745 544c 272c 2027 6672 616d  n', 'ETL', 'fram
-000003b0: 6577 6f72 6b27 5d2c 0d0a 2020 2020 2020  ework'],..      
-000003c0: 2020 636c 6173 7369 6669 6572 733d 205b    classifiers= [
-000003d0: 0d0a 2020 2020 2020 2020 2020 2020 2250  ..            "P
-000003e0: 726f 6772 616d 6d69 6e67 204c 616e 6775  rogramming Langu
-000003f0: 6167 6520 3a3a 2050 7974 686f 6e20 3a3a  age :: Python ::
-00000400: 2033 2e37 222c 0d0a 2020 2020 2020 2020   3.7",..        
-00000410: 5d0d 0a29 0d0a 0d0a                      ]..)....
+000000c0: 6465 2045 544c 2065 6d20 7079 7468 6f6e  de ETL em python
+000000d0: 2e27 0d0a 0d0a 2320 5365 7474 696e 6720  .'....# Setting 
+000000e0: 7570 0d0a 7365 7475 7028 0d0a 2020 2020  up..setup(..    
+000000f0: 2020 2020 6e61 6d65 3d22 7374 6e62 6c69      name="stnbli
+00000100: 7079 222c 200d 0a20 2020 2020 2020 2076  py", ..        v
+00000110: 6572 7369 6f6e 3d56 4552 5349 4f4e 2c0d  ersion=VERSION,.
+00000120: 0a20 2020 2020 2020 2061 7574 686f 723d  .        author=
+00000130: 2253 6563 7265 7461 7269 6120 646f 2054  "Secretaria do T
+00000140: 6573 6f75 726f 204e 6163 696f 6e61 6c22  esouro Nacional"
+00000150: 2c0d 0a20 2020 2020 2020 2023 2061 7574  ,..        # aut
+00000160: 686f 725f 656d 6169 6c3d 2222 2c0d 0a20  hor_email="",.. 
+00000170: 2020 2020 2020 206c 6963 656e 7365 3d22         license="
+00000180: 4750 4c20 7632 222c 0d0a 2020 2020 2020  GPL v2",..      
+00000190: 2020 6465 7363 7269 7074 696f 6e3d 4445    description=DE
+000001a0: 5343 5249 5054 494f 4e2c 0d0a 2020 2020  SCRIPTION,..    
+000001b0: 2020 2020 6c6f 6e67 5f64 6573 6372 6970      long_descrip
+000001c0: 7469 6f6e 3d4c 4f4e 475f 4445 5343 5249  tion=LONG_DESCRI
+000001d0: 5054 494f 4e2c 0d0a 2020 2020 2020 2020  PTION,..        
+000001e0: 7061 636b 6167 6573 3d66 696e 645f 7061  packages=find_pa
+000001f0: 636b 6167 6573 2829 2c0d 0a20 2020 2020  ckages(),..     
+00000200: 2020 2069 6e73 7461 6c6c 5f72 6571 7569     install_requi
+00000210: 7265 733d 5b0d 0a20 2020 2020 2020 2020  res=[..         
+00000220: 2020 2022 7371 6c61 6c63 6865 6d79 3d3d     "sqlalchemy==
+00000230: 312e 342e 3135 222c 200d 0a20 2020 2020  1.4.15", ..     
+00000240: 2020 2020 2020 2022 6378 2d4f 7261 636c         "cx-Oracl
+00000250: 653d 3d37 2e31 2e33 222c 200d 0a20 2020  e==7.1.3", ..   
+00000260: 2020 2020 2020 2020 2022 6d75 6c74 6970           "multip
+00000270: 6c65 6469 7370 6174 6368 3d3d 302e 362e  ledispatch==0.6.
+00000280: 3022 2c20 0d0a 2020 2020 2020 2020 2020  0", ..          
+00000290: 2020 2270 616e 6461 733d 3d31 2e31 2e35    "pandas==1.1.5
+000002a0: 222c 200d 0a20 2020 2020 2020 2020 2020  ", ..           
+000002b0: 2022 6f70 656e 7079 786c 3d3d 332e 302e   "openpyxl==3.0.
+000002c0: 3130 222c 200d 0a20 2020 2020 2020 2020  10", ..         
+000002d0: 2020 2022 6c78 6d6c 3d3d 342e 392e 3122     "lxml==4.9.1"
+000002e0: 2c0d 0a20 2020 2020 2020 2020 2020 2022  ,..            "
+000002f0: 6874 6d6c 356c 6962 3d3d 312e 3122 2c0d  html5lib==1.1",.
+00000300: 0a20 2020 2020 2020 2020 2020 2022 6273  .            "bs
+00000310: 343d 3d30 2e30 2e31 222c 0d0a 2020 2020  4==0.0.1",..    
+00000320: 2020 2020 2020 2020 2278 6c72 643d 3d31          "xlrd==1
+00000330: 2e31 2e30 222c 0d0a 2020 2020 2020 2020  .1.0",..        
+00000340: 2020 2020 2277 6765 743d 3d33 2e32 222c      "wget==3.2",
+00000350: 0d0a 2020 2020 2020 2020 2020 2020 224a  ..            "J
+00000360: 6179 4465 4265 4170 693d 3d31 2e32 2e33  ayDeBeApi==1.2.3
+00000370: 225d 2c0d 0a20 2020 2020 2020 206b 6579  "],..        key
+00000380: 776f 7264 733d 5b27 7079 7468 6f6e 272c  words=['python',
+00000390: 2027 4554 4c27 2c20 2766 7261 6d65 776f   'ETL', 'framewo
+000003a0: 726b 275d 2c0d 0a20 2020 2020 2020 2063  rk'],..        c
+000003b0: 6c61 7373 6966 6965 7273 3d20 5b0d 0a20  lassifiers= [.. 
+000003c0: 2020 2020 2020 2020 2020 2022 5072 6f67             "Prog
+000003d0: 7261 6d6d 696e 6720 4c61 6e67 7561 6765  ramming Language
+000003e0: 203a 3a20 5079 7468 6f6e 203a 3a20 332e   :: Python :: 3.
+000003f0: 3722 2c0d 0a20 2020 2020 2020 205d 0d0a  7",..        ]..
+00000400: 290d 0a0d 0a                             )....
```

### Comparing `stnblipy-4.9.0/stnblipy.egg-info/SOURCES.txt` & `stnblipy-5.0.0/stnblipy.egg-info/SOURCES.txt`

 * *Files 16% similar despite different names*

```diff
@@ -1,23 +1,27 @@
 setup.py
 blipy/__init__.py
 blipy/arquivo_csv.py
+blipy/arquivo_posicional.py
 blipy/conexao_bd.py
 blipy/enum_tipo_col_bd.py
 blipy/erro.py
 blipy/func_transformacao.py
 blipy/job.py
+blipy/jsonstring.py
 blipy/planilha.py
 blipy/profiling.py
 blipy/tabela_dataframe.py
 blipy/tabela_entrada.py
 blipy/tabela_html.py
 blipy/tabela_saida.py
 blipy/utils.py
 stnblipy.egg-info/PKG-INFO
 stnblipy.egg-info/SOURCES.txt
 stnblipy.egg-info/dependency_links.txt
 stnblipy.egg-info/requires.txt
 stnblipy.egg-info/top_level.txt
 test/teste_conexao_json.py
+test/teste_estrategias_atualizacao.py
+test/teste_geral.py
 test/teste_job.py
 test/testes_classe_planilha.py
```

### Comparing `stnblipy-4.9.0/test/teste_conexao_json.py` & `stnblipy-5.0.0/test/teste_conexao_json.py`

 * *Files 11% similar despite different names*

```diff
@@ -1,14 +1,14 @@
 import sys
 sys.path.append('..')
 
-# from blipy.conexao_bd import ConexaoBD
-# from blipy.job import Job, TpEstrategia
-# from blipy.enum_tipo_col_bd import TpColBD as tp
-# import blipy.func_transformacao as ft
+from blipy.conexao_bd import ConexaoBD
+from blipy.job import Job, TpEstrategia
+from blipy.enum_tipo_col_bd import TpColBD as tp
+import blipy.func_transformacao as ft
 
 # # import blipy.utils as utils
 
 # # trim = ft.Trim()
 
 
 # # domínios dos campos
@@ -487,89 +487,272 @@
     #     raise err
     #     pass
 
 
 
 
 
-from blipy.conexao_bd import ConexaoBD
-from blipy.job import Job, TpEstrategia
-from blipy.enum_tipo_col_bd import TpColBD as tp
+# from blipy.conexao_bd import ConexaoBD
+# from blipy.job import Job, TpEstrategia
+# from blipy.enum_tipo_col_bd import TpColBD as tp
+# 
+# # select_orgaos = """select	a11.ID_ORGAO  ID_ORGAO, --Órgão (SIORG)
+# select_orgaos = """select	CAST (a11.ID_ORGAO AS INTEGER) ID_ORGAO, --Órgão (SIORG)
+#     trim(max(a11.CO_ORGAO))   CO_ORGAO,
+#     max(a11.NO_ORGAO)   NO_ORGAO--,
+#     --trim(a13.CO_SIORG_N05)  CO_SIORG_N05,
+#     --CAST (a13.ID_ANO AS INTEGER)  ID_ANO,
+#     --max(a16.DS_SIORG_N05)  DS_SIORG_N05,
+#     --max(a16.SG_SIORG_N05)  SG_SIORG_N05,
+#     --trim(a13.CO_SIORG_N06)  CO_SIORG_N06,
+#     --max(a17.DS_SIORG_N06)  DS_SIORG_N06,
+#     --max(a17.SG_SIORG_N06)  SG_SIORG_N06,
+#     --trim(a13.CO_SIORG_N07)  CO_SIORG_N07,
+#     --max(a18.DS_SIORG_N07)  DS_SIORG_N07,
+#     --max(a18.SG_SIORG_N07)  SG_SIORG_N07,
+#     --CAST (a13.ID_PODER_SIORG AS INTEGER)  ID_PODER_SIORG,
+#     --max(a15.DS_PODER_SIORG)  DS_PODER_SIORG,
+#     --CAST (a13.ID_NATUREZA_JURIDICA_SIORG AS INTEGER)  ID_NATUREZA_JURIDICA_SIORG,
+#     --max(a14.DS_NATUREZA_JURIDICA_SIORG)  DS_NATUREZA_JURIDICA_SIORG
+# from	WD_ORGAO	a11
+#     join	WD_ORGAO_EXERCICIO	a12
+#       on 	(a11.ID_ORGAO = a12.ID_ORGAO)
+#     join	WD_SIORG_EXERCICIO	a13
+#       on 	(a12.CO_SIORG = a13.CO_SIORG and 
+#     a12.ID_ANO = a13.ID_ANO)
+#     join	WD_NATUREZA_JURIDICA_SIORG	a14
+#       on 	(a13.ID_NATUREZA_JURIDICA_SIORG = a14.ID_NATUREZA_JURIDICA_SIORG)
+#     join	WD_PODER_SIORG	a15
+#       on 	(a13.ID_PODER_SIORG = a15.ID_PODER_SIORG)
+#     join	WD_SIORG_N05_EXERCICIO	a16
+#       on 	(a13.CO_SIORG_N05 = a16.CO_SIORG_N05 and 
+#     a13.ID_ANO = a16.ID_ANO)
+#     join	WD_SIORG_N06	a17
+#       on 	(a13.CO_SIORG_N06 = a17.CO_SIORG_N06)
+#     join	WD_SIORG_N07	a18
+#       on 	(a13.CO_SIORG_N07 = a18.CO_SIORG_N07)
+# where	a13.CO_SIORG_N04 = '000026' -- manter?
+# group by	a11.ID_ORGAO,
+#     a13.CO_SIORG_N05,
+#     a13.ID_ANO,
+#     a13.CO_SIORG_N06,
+#     a13.CO_SIORG_N07,
+#     a13.ID_PODER_SIORG,
+#     a13.ID_NATUREZA_JURIDICA_SIORG"""
+# 
+# if __name__ == '__main__':
+#     try:
+#         job = Job("Teste de conexão com JDV")
+# 
+#         conn_stg, conn_jdv  = ConexaoBD.from_json()
+# 
+#         cols_saida = [["ID_ORGAO", tp.NUMBER],
+#                       ["CO_ORGAO", tp.STRING],
+#                       ["NO_ORGAO", tp.STRING]#,
+#                       #["CO_SIORG_N05", tp.STRING],
+#                       #["ID_ANO", tp.NUMBER],
+#                       #["DS_SIORG_N05", tp.STRING],
+#                       #["SG_SIORG_N05", tp.STRING],
+#                       #["CO_SIORG_N06", tp.STRING],
+#                       #["DS_SIORG_N06", tp.STRING],
+#                       #["SG_SIORG_N06", tp.STRING],
+#                       #["CO_SIORG_N07", tp.STRING],
+#                       #["DS_SIORG_N07", tp.STRING],
+#                       #["SG_SIORG_N07", tp.STRING],
+#                       #["ID_PODER_SIORG", tp.NUMBER],
+#                       #["DS_PODER_SIORG", tp.STRING],
+#                       #["ID_NATUREZA_JURIDICA_SIORG", tp.NUMBER],
+#                       #["DS_NATUREZA_JURIDICA_SIORG", tp.STRING]
+#                       ]
+#         job.importa_tabela_por_sql(
+#                 conn_jdv,
+#                 conn_stg,
+#                 select_orgaos,
+#                 "CUSTOS_ORGAOS",
+#                 cols_saida)
+#         
+#     except Exception as err:
+#         print(err)
+#         raise
+
+
+# if __name__ == '__main__':
+#     job = Job("Teste")
+# 
+#     try:
+#         conn_teste, = ConexaoBD.from_json()
+# 
+#         cols_saida = [ ["ID_ABRANG", tp.NUMBER],
+#                        ["QT_PONTOS1", tp.NUMBER],
+#                        ["QT_PONTOS2", tp.NUMBER]]
+#         job.importa_planilha(   
+#                 conn_teste, 
+#                 "ZZ_TESTE",
+#                 cols_saida,
+#                 "teste.xlsx", 
+#                 usecols=[1,2,3],
+#                 skiprows=0,
+#                 # thousands=".",
+#                 estrategia=TpEstrategia.INSERT)
+# 
+#     except Exception as err:
+#         print(err)
+#         raise
+
+
+# class MeuSomatorio():
+#     def transforma(self, entradas):
+#         if entradas[3] == "S":
+#             return ft.Somatorio().transforma(entradas[:3])
+
+#         return None
+
+# if __name__ == '__main__':
+#     job = Job("Teste")
+
+#     try:
+#         conn_teste, = ConexaoBD.from_json()
+
+#         cols_entrada = ["ID_CHAVE",
+#                         "QT_VALOR1",
+#                         "QT_VALOR2",
+#                         "QT_VALOR3",
+#                         ["QT_VALOR1", "QT_VALOR2", "QT_VALOR3", "SN_CONDICAO"],
+#                         "SN_CONDICAO"]
+#         cols_saida = [ ["ID_CHAVE", tp.NUMBER],
+#                        ["QT_VALOR1", tp.NUMBER],
+#                        ["QT_VALOR2", tp.NUMBER],
+#                        ["QT_VALOR3", tp.NUMBER],
+#                        ["QT_VALOR4", tp.NUMBER, MeuSomatorio()],
+#                        ["SN_CONDICAO", tp.STRING]]
+#         job.importa_tabela_por_nome(
+#                 conn_teste,
+#                 conn_teste,
+#                 "ZZ_SOMATORIO_IN",
+#                 "ZZ_SOMATORIO_OUT",
+#                 cols_entrada,
+#                 cols_saida)
+
+#     except:
+#         raise
+
+
+
+# if __name__ == "__main__":
+#     try:
+#         conn_prd, = ConexaoBD.from_json()
+
+#         job = Job("Teste de carga de fato")
+
+#         # fato FATO_EXEC_RECEITA
+#         # cols_entrada = [["ME_EXECUCAO_RECEITA", "AN_EXECUCAO_RECEITA"],
+#         #                 ["CO_FONTE_RECURSO_DETALHE", "CO_FONTE_RECURSO"]]
+#         # cols_saida = [  ["DATA1", tp.DATE, 
+#         #                     ft.MontaDataMesAno(dia=1)],
+#         #                 ["VAL1", tp.STRING, 
+#         #                     ft.ConcatenaStrings(trim="resultado", sep=" - ")]]
+#         # job.importa_tabela_por_nome(   
+#         #         conn_stg, 
+#         #         conn_prd, 
+#         #         "EXECUCAO_RECEITA", 
+#         #         "ZZ_TESTE1",
+#         #         cols_entrada, 
+#         #         cols_saida)
+
+#         dados_entrada = [
+#             (1, "Tesouro-Exerc. Corrente"), 
+#             (2, "Exercício Corrente"), 
+#             (3, "Exercícios Anteriores"), 
+#             (6, "Exercícios Anteriores"), 
+#             (7, "Operações de Crédito"), 
+#             (9, "Recursos Condicionados")]
+#         cols_saida = [  ["ID_ABRANG", tp.NUMBER],
+#                         ["NO_ABRANG", tp.STRING]]
+#         job.importa_valores(conn_prd, "ZZ_TESTE", cols_saida, dados_entrada)
+
+#     except:
+#         raise
+
+# if __name__ == "__main__":
+#     try:
+#         job = Job("Teste inversão sinal")
+#         conn_stg, conn_prd = ConexaoBD.from_json()
+
+#         cols_entrada = ["VALOR_INT",
+#                         "VALOR_STR",
+#                         "VALOR_STR"]
+#         cols_saida = [ ["VALOR_INT", tp.NUMBER, ft.InverteSinal()],
+#                        ["VALOR_FLOAT", tp.NUMBER, ft.InverteSinal()],
+#                        ["VALOR_INT2", tp.NUMBER, ft.InverteSinal()]]
+#         job.importa_tabela_por_nome(
+#                 conn_stg,
+#                 conn_prd,
+#                 "ZZ_SOMATORIO_IN",
+#                 "ZZ_SOMATORIO_OUT",
+#                 cols_entrada,
+#                 cols_saida)
+
+#         job.grava_log_atualizacao(conn_prd)
+
+#     except:
+#         raise 
+
+
+
 
-# select_orgaos = """select	a11.ID_ORGAO  ID_ORGAO, --Órgão (SIORG)
-select_orgaos = """select	CAST (a11.ID_ORGAO AS INTEGER) ID_ORGAO, --Órgão (SIORG)
-	trim(max(a11.CO_ORGAO))   CO_ORGAO,
-	max(a11.NO_ORGAO)   NO_ORGAO--,
-	--trim(a13.CO_SIORG_N05)  CO_SIORG_N05,
-	--CAST (a13.ID_ANO AS INTEGER)  ID_ANO,
-	--max(a16.DS_SIORG_N05)  DS_SIORG_N05,
-	--max(a16.SG_SIORG_N05)  SG_SIORG_N05,
-	--trim(a13.CO_SIORG_N06)  CO_SIORG_N06,
-	--max(a17.DS_SIORG_N06)  DS_SIORG_N06,
-	--max(a17.SG_SIORG_N06)  SG_SIORG_N06,
-	--trim(a13.CO_SIORG_N07)  CO_SIORG_N07,
-	--max(a18.DS_SIORG_N07)  DS_SIORG_N07,
-	--max(a18.SG_SIORG_N07)  SG_SIORG_N07,
-	--CAST (a13.ID_PODER_SIORG AS INTEGER)  ID_PODER_SIORG,
-	--max(a15.DS_PODER_SIORG)  DS_PODER_SIORG,
-	--CAST (a13.ID_NATUREZA_JURIDICA_SIORG AS INTEGER)  ID_NATUREZA_JURIDICA_SIORG,
-	--max(a14.DS_NATUREZA_JURIDICA_SIORG)  DS_NATUREZA_JURIDICA_SIORG
-from	WD_ORGAO	a11
-	join	WD_ORGAO_EXERCICIO	a12
-	  on 	(a11.ID_ORGAO = a12.ID_ORGAO)
-	join	WD_SIORG_EXERCICIO	a13
-	  on 	(a12.CO_SIORG = a13.CO_SIORG and 
-	a12.ID_ANO = a13.ID_ANO)
-	join	WD_NATUREZA_JURIDICA_SIORG	a14
-	  on 	(a13.ID_NATUREZA_JURIDICA_SIORG = a14.ID_NATUREZA_JURIDICA_SIORG)
-	join	WD_PODER_SIORG	a15
-	  on 	(a13.ID_PODER_SIORG = a15.ID_PODER_SIORG)
-	join	WD_SIORG_N05_EXERCICIO	a16
-	  on 	(a13.CO_SIORG_N05 = a16.CO_SIORG_N05 and 
-	a13.ID_ANO = a16.ID_ANO)
-	join	WD_SIORG_N06	a17
-	  on 	(a13.CO_SIORG_N06 = a17.CO_SIORG_N06)
-	join	WD_SIORG_N07	a18
-	  on 	(a13.CO_SIORG_N07 = a18.CO_SIORG_N07)
-where	a13.CO_SIORG_N04 = '000026' -- manter?
-group by	a11.ID_ORGAO,
-	a13.CO_SIORG_N05,
-	a13.ID_ANO,
-	a13.CO_SIORG_N06,
-	a13.CO_SIORG_N07,
-	a13.ID_PODER_SIORG,
-	a13.ID_NATUREZA_JURIDICA_SIORG"""
+import numpy as np
+from datetime import datetime
+class FormataDataEmpreendimento():
+    def transforma(self, entradas):
+        if entradas[0] is not np.nan:
+            return datetime.strptime(entradas[0][:10], "%d/%m/%Y")
+        else:
+            return entradas[0]
+formata_data_empreendimento = FormataDataEmpreendimento()
+
+def filtra_descricao_comecando_com_A(registro):
+    # return True
+    # DS_PRODUTO começa com "A"
+    if registro[3][:1] == "A":
+        return True
+
+    return False
+
+def imprime_data_antes_depois(registro_original, registro_gravado):
+    # return
+    print(str(registro_original[1]) + " virou " + str(registro_gravado[1]))
 
-if __name__ == '__main__':
+if __name__ == "__main__":
     try:
-        job = Job("Teste de conexão com JDV")
+        conn_stg, = ConexaoBD.from_json()
+        job = Job("Teste pré e pós func")
 
-        conn_stg, conn_jdv  = ConexaoBD.from_json()
+        cols_saida = [
+            ["CO_EMPREENDIMENTO", tp.NUMBER], 
+            ["DT_INICIO", tp.DATE, formata_data_empreendimento], 
+            ["DT_FIM", tp.DATE, formata_data_empreendimento], 
+            # ["DS_FINALIDADE", tp.STRING], 
+            # ["DS_ATIVIDADE", tp.STRING], 
+            # ["DS_MODALIDADE", tp.STRING], 
+            ["DS_PRODUTO", tp.STRING], 
+            # ["DS_VARIEDADE", tp.STRING], 
+            # ["DS_CESTA", tp.STRING], 
+            # ["DS_ZONEAMENTO", tp.STRING], 
+            # ["DS_UNIDADE_MEDIDA", tp.STRING], 
+            # ["DS_UNIDADE_MEDIDA_PREVISAO", tp.STRING], 
+            ["DS_CONSORCIO", tp.STRING], 
+            ["CO_CEDULA_MAE", tp.NUMBER],
+            ["CO_TIPO_CULTURA", tp.NUMBER]]
+
+        job.set_func_pre_processamento(filtra_descricao_comecando_com_A)
+        job.set_func_pos_processamento(imprime_data_antes_depois)
+        job.importa_arquivo_csv(
+            conn_stg, 
+            "ZZ_EMPREENDIMENTO", 
+            cols_saida,
+            "Empreendimento.csv",
+            sep=",",
+            encoding="latin1",
+            usecols=[0, 1, 2, 6, 12, 13, 14])
+    except:
+        raise 
 
-        cols_saida = [["ID_ORGAO", tp.NUMBER],
-                      ["CO_ORGAO", tp.STRING],
-                      ["NO_ORGAO", tp.STRING]#,
-                      #["CO_SIORG_N05", tp.STRING],
-                      #["ID_ANO", tp.NUMBER],
-                      #["DS_SIORG_N05", tp.STRING],
-                      #["SG_SIORG_N05", tp.STRING],
-                      #["CO_SIORG_N06", tp.STRING],
-                      #["DS_SIORG_N06", tp.STRING],
-                      #["SG_SIORG_N06", tp.STRING],
-                      #["CO_SIORG_N07", tp.STRING],
-                      #["DS_SIORG_N07", tp.STRING],
-                      #["SG_SIORG_N07", tp.STRING],
-                      #["ID_PODER_SIORG", tp.NUMBER],
-                      #["DS_PODER_SIORG", tp.STRING],
-                      #["ID_NATUREZA_JURIDICA_SIORG", tp.NUMBER],
-                      #["DS_NATUREZA_JURIDICA_SIORG", tp.STRING]
-					  ]
-        job.importa_tabela_por_sql(
-                conn_jdv,
-                conn_stg,
-                select_orgaos,
-                "CUSTOS_ORGAOS",
-                cols_saida)
-        
-    except Exception as err:
-        print(err)
-        raise
```

### Comparing `stnblipy-4.9.0/test/teste_job.py` & `stnblipy-5.0.0/test/teste_job.py`

 * *Files identical despite different names*

### Comparing `stnblipy-4.9.0/test/testes_classe_planilha.py` & `stnblipy-5.0.0/test/testes_classe_planilha.py`

 * *Files identical despite different names*

