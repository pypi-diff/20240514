# Comparing `tmp/ez-9.9.8.tar.gz` & `tmp/ez-9.9.9.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "ez-9.9.8.tar", last modified: Mon May 30 20:26:12 2022, max compression
+gzip compressed data, was "ez-9.9.9.tar", last modified: Mon May 30 20:38:15 2022, max compression
```

## Comparing `ez-9.9.8.tar` & `ez-9.9.9.tar`

### file list

```diff
@@ -1,19 +1,19 @@
-drwxr-xr-x   0 jerry      (501) staff       (20)        0 2022-05-30 20:26:12.475685 ez-9.9.8/
--rwxr-xr-x   0 jerry      (501) staff       (20)     1689 2022-02-19 01:34:50.000000 ez-9.9.8/MANIFEST.in
--rw-r--r--   0 jerry      (501) staff       (20)      650 2022-05-30 20:26:12.475390 ez-9.9.8/PKG-INFO
--rw-r--r--   0 jerry      (501) staff       (20)    10600 2020-07-21 03:22:09.000000 ez-9.9.8/README.rst
-drwxr-xr-x   0 jerry      (501) staff       (20)        0 2022-05-30 20:26:12.471927 ez-9.9.8/ez/
--rw-r--r--   0 jerry      (501) staff       (20)      286 2022-02-20 23:25:43.000000 ez-9.9.8/ez/__init__.py
--rw-r--r--   0 jerry      (501) staff       (20)   238657 2022-05-30 20:26:00.000000 ez-9.9.8/ez/ez.py
--rwxr-xr-x   0 jerry      (501) staff       (20)    46160 2022-03-17 15:53:44.000000 ez-9.9.8/ez/firefox.py
--rw-r--r--   0 jerry      (501) staff       (20)    17169 2022-02-19 01:27:34.000000 ez-9.9.8/ez/firefox.xpi
--rw-r--r--   0 jerry      (501) staff       (20)      469 2020-07-21 03:22:09.000000 ez-9.9.8/ez/prepublish.py
--rw-r--r--   0 jerry      (501) staff       (20)       21 2022-05-30 20:26:11.000000 ez-9.9.8/ez/version.py
-drwxr-xr-x   0 jerry      (501) staff       (20)        0 2022-05-30 20:26:12.474900 ez-9.9.8/ez.egg-info/
--rw-r--r--   0 jerry      (501) staff       (20)      650 2022-05-30 20:26:12.000000 ez-9.9.8/ez.egg-info/PKG-INFO
--rw-r--r--   0 jerry      (501) staff       (20)      244 2022-05-30 20:26:12.000000 ez-9.9.8/ez.egg-info/SOURCES.txt
--rw-r--r--   0 jerry      (501) staff       (20)        1 2022-05-30 20:26:12.000000 ez-9.9.8/ez.egg-info/dependency_links.txt
--rw-r--r--   0 jerry      (501) staff       (20)      430 2022-05-30 20:26:12.000000 ez-9.9.8/ez.egg-info/requires.txt
--rw-r--r--   0 jerry      (501) staff       (20)        3 2022-05-30 20:26:12.000000 ez-9.9.8/ez.egg-info/top_level.txt
--rw-r--r--   0 jerry      (501) staff       (20)       38 2022-05-30 20:26:12.475777 ez-9.9.8/setup.cfg
--rw-r--r--   0 jerry      (501) staff       (20)     7354 2022-05-30 19:49:42.000000 ez-9.9.8/setup.py
+drwxr-xr-x   0 jerry      (501) staff       (20)        0 2022-05-30 20:38:15.917392 ez-9.9.9/
+-rwxr-xr-x   0 jerry      (501) staff       (20)     1689 2022-02-19 01:34:50.000000 ez-9.9.9/MANIFEST.in
+-rw-r--r--   0 jerry      (501) staff       (20)      650 2022-05-30 20:38:15.916813 ez-9.9.9/PKG-INFO
+-rw-r--r--   0 jerry      (501) staff       (20)    10600 2020-07-21 03:22:09.000000 ez-9.9.9/README.rst
+drwxr-xr-x   0 jerry      (501) staff       (20)        0 2022-05-30 20:38:15.912314 ez-9.9.9/ez/
+-rw-r--r--   0 jerry      (501) staff       (20)      286 2022-02-20 23:25:43.000000 ez-9.9.9/ez/__init__.py
+-rw-r--r--   0 jerry      (501) staff       (20)   238652 2022-05-30 20:38:06.000000 ez-9.9.9/ez/ez.py
+-rwxr-xr-x   0 jerry      (501) staff       (20)    46160 2022-03-17 15:53:44.000000 ez-9.9.9/ez/firefox.py
+-rw-r--r--   0 jerry      (501) staff       (20)    17169 2022-02-19 01:27:34.000000 ez-9.9.9/ez/firefox.xpi
+-rw-r--r--   0 jerry      (501) staff       (20)      469 2020-07-21 03:22:09.000000 ez-9.9.9/ez/prepublish.py
+-rw-r--r--   0 jerry      (501) staff       (20)       21 2022-05-30 20:38:14.000000 ez-9.9.9/ez/version.py
+drwxr-xr-x   0 jerry      (501) staff       (20)        0 2022-05-30 20:38:15.915831 ez-9.9.9/ez.egg-info/
+-rw-r--r--   0 jerry      (501) staff       (20)      650 2022-05-30 20:38:15.000000 ez-9.9.9/ez.egg-info/PKG-INFO
+-rw-r--r--   0 jerry      (501) staff       (20)      244 2022-05-30 20:38:15.000000 ez-9.9.9/ez.egg-info/SOURCES.txt
+-rw-r--r--   0 jerry      (501) staff       (20)        1 2022-05-30 20:38:15.000000 ez-9.9.9/ez.egg-info/dependency_links.txt
+-rw-r--r--   0 jerry      (501) staff       (20)      435 2022-05-30 20:38:15.000000 ez-9.9.9/ez.egg-info/requires.txt
+-rw-r--r--   0 jerry      (501) staff       (20)        3 2022-05-30 20:38:15.000000 ez-9.9.9/ez.egg-info/top_level.txt
+-rw-r--r--   0 jerry      (501) staff       (20)       38 2022-05-30 20:38:15.917543 ez-9.9.9/setup.cfg
+-rw-r--r--   0 jerry      (501) staff       (20)     7399 2022-05-30 20:37:41.000000 ez-9.9.9/setup.py
```

### Comparing `ez-9.9.8/MANIFEST.in` & `ez-9.9.9/MANIFEST.in`

 * *Files identical despite different names*

### Comparing `ez-9.9.8/PKG-INFO` & `ez-9.9.9/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: ez
-Version: 9.9.8
+Version: 9.9.9
 Summary: easy stuff
 Home-page: https://pypi.python.org/pypi/ez
 Author: Jerry Zhu
 Author-email: jerryzhujian9@gmail.com
 License: GPLv3+
 Keywords: shell,cross-platform,easy,wrapper
 Platform: UNKNOWN
```

### Comparing `ez-9.9.8/README.rst` & `ez-9.9.9/README.rst`

 * *Files identical despite different names*

### Comparing `ez-9.9.8/ez/ez.py` & `ez-9.9.9/ez/ez.py`

 * *Files 0% similar despite different names*

```diff
@@ -11733,3185 +11733,3184 @@
 0002dd40: 6469 722e 7478 7427 206f 7220 5b27 612e  dir.txt' or ['a.
 0002dd50: 7478 7427 2c27 622e 7079 272c 2763 2e70  txt','b.py','c.p
 0002dd60: 6466 275d 0a20 2020 2065 6d61 696c 2c20  df'].    email, 
 0002dd70: 7061 7373 776f 7264 3a20 6967 6e6f 7265  password: ignore
 0002dd80: 6420 6966 2070 7973 6563 7265 7473 2065  d if pysecrets e
 0002dd90: 7869 7374 730a 2020 2020 2222 220a 2020  xists.    """.  
 0002dda0: 2020 6672 6f6d 2079 6167 6d61 696c 2069    from yagmail i
-0002ddb0: 6d70 6f72 7420 534d 5450 2c20 7261 770a  mport SMTP, raw.
-0002ddc0: 2020 2020 696d 706f 7274 2068 746d 6c0a      import html.
-0002ddd0: 2020 2020 2320 6874 7470 733a 2f2f 7961      # https://ya
-0002dde0: 676d 6169 6c2e 7265 6164 7468 6564 6f63  gmail.readthedoc
-0002ddf0: 732e 696f 2f65 6e2f 6c61 7465 7374 2f75  s.io/en/latest/u
-0002de00: 7361 6765 2e68 746d 6c0a 2020 2020 7472  sage.html.    tr
-0002de10: 793a 0a20 2020 2020 2020 2023 2069 6d70  y:.        # imp
-0002de20: 6f72 7420 6f73 2c20 7379 730a 2020 2020  ort os, sys.    
-0002de30: 2020 2020 2320 4845 5245 203d 206f 732e      # HERE = os.
-0002de40: 7061 7468 2e64 6972 6e61 6d65 286f 732e  path.dirname(os.
-0002de50: 7061 7468 2e61 6273 7061 7468 285f 5f66  path.abspath(__f
-0002de60: 696c 655f 5f29 290a 2020 2020 2020 2020  ile__)).        
-0002de70: 2320 7379 732e 7061 7468 2e69 6e73 6572  # sys.path.inser
-0002de80: 7428 302c 2048 4552 4529 0a20 2020 2020  t(0, HERE).     
-0002de90: 2020 200a 2020 2020 2020 2020 2320 454d     .        # EM
-0002dea0: 4149 4c20 3d20 2273 6f6d 656f 6e65 4067  AIL = "someone@g
-0002deb0: 6d61 696c 2e63 6f6d 222c 2050 4153 5357  mail.com", PASSW
-0002dec0: 4f52 4420 3d20 2261 6263 6465 6667 6869  ORD = "abcdefghi
-0002ded0: 6a6b 6c22 0a20 2020 2020 2020 2067 636c  jkl".        gcl
-0002dee0: 6965 6e74 203d 2053 4d54 5028 454d 4149  ient = SMTP(EMAI
-0002def0: 4c2c 5041 5353 574f 5244 290a 2020 2020  L,PASSWORD).    
-0002df00: 6578 6365 7074 3a0a 2020 2020 2020 2020  except:.        
-0002df10: 6763 6c69 656e 7420 3d20 534d 5450 2865  gclient = SMTP(e
-0002df20: 6d61 696c 2c70 6173 7377 6f72 6429 0a20  mail,password). 
-0002df30: 2020 2063 6f6e 7465 6e74 733d 4e6f 6e65     contents=None
-0002df40: 0a20 2020 2069 6620 7465 7874 2069 7320  .    if text is 
-0002df50: 6e6f 7420 4e6f 6e65 3a20 626f 6479 3d4e  not None: body=N
-0002df60: 6f6e 650a 2020 2020 6966 2074 6578 7420  one.    if text 
-0002df70: 6973 206e 6f74 204e 6f6e 653a 2063 6f6e  is not None: con
-0002df80: 7465 6e74 733d 6874 6d6c 2e65 7363 6170  tents=html.escap
-0002df90: 6528 7465 7874 290a 2020 2020 6966 2062  e(text).    if b
-0002dfa0: 6f64 7920 6973 206e 6f74 204e 6f6e 653a  ody is not None:
-0002dfb0: 2063 6f6e 7465 6e74 733d 626f 6479 0a20   contents=body. 
-0002dfc0: 2020 2067 636c 6965 6e74 2e73 656e 6428     gclient.send(
-0002dfd0: 7375 626a 6563 743d 7375 626a 6563 742c  subject=subject,
-0002dfe0: 746f 3d74 6f2c 6363 3d63 632c 6263 633d  to=to,cc=cc,bcc=
-0002dff0: 6263 632c 636f 6e74 656e 7473 3d63 6f6e  bcc,contents=con
-0002e000: 7465 6e74 732c 6174 7461 6368 6d65 6e74  tents,attachment
-0002e010: 733d 6174 7461 6368 6d65 6e74 7329 0a20  s=attachments). 
-0002e020: 2020 2067 636c 6965 6e74 2e63 6c6f 7365     gclient.close
-0002e030: 2829 0a20 2020 2072 6574 7572 6e20 4e6f  ().    return No
-0002e040: 6e65 0a6d 6169 6c20 3d20 4d61 696c 0a67  ne.mail = Mail.g
-0002e050: 6d61 696c 203d 204d 6169 6c0a 0a64 6566  mail = Mail..def
-0002e060: 206f 3336 3561 7574 6828 6964 3d4e 6f6e   o365auth(id=Non
-0002e070: 652c 2073 6563 7265 743d 4e6f 6e65 293a  e, secret=None):
-0002e080: 0a20 2020 2074 7279 3a0a 2020 2020 2020  .    try:.      
-0002e090: 2020 6372 6564 656e 7469 616c 7320 3d20    credentials = 
-0002e0a0: 284f 3336 3549 442c 204f 3336 3553 4543  (O365ID, O365SEC
-0002e0b0: 5245 5429 0a20 2020 2065 7863 6570 743a  RET).    except:
-0002e0c0: 0a20 2020 2020 2020 2063 7265 6465 6e74  .        credent
-0002e0d0: 6961 6c73 203d 2028 6964 2c20 7365 6372  ials = (id, secr
-0002e0e0: 6574 290a 2020 2020 2320 6874 7470 733a  et).    # https:
-0002e0f0: 2f2f 7374 6163 6b6f 7665 7266 6c6f 772e  //stackoverflow.
-0002e100: 636f 6d2f 7175 6573 7469 6f6e 732f 3834  com/questions/84
-0002e110: 3639 3132 3220 0a20 2020 2023 2072 6561  69122 .    # rea
-0002e120: 646c 696e 6520 6c69 6674 7320 4d61 7869  dline lifts Maxi
-0002e130: 6d75 6d20 6368 6172 6163 7465 7273 2074  mum characters t
-0002e140: 6861 7420 6361 6e20 6265 2073 7475 6666  hat can be stuff
-0002e150: 6564 2069 6e74 6f20 7261 775f 696e 7075  ed into raw_inpu
-0002e160: 7428 2920 696e 2050 7974 686f 6e0a 2020  t() in Python.  
-0002e170: 2020 696d 706f 7274 2072 6561 646c 696e    import readlin
-0002e180: 6520 0a20 2020 2066 726f 6d20 4f33 3635  e .    from O365
-0002e190: 2069 6d70 6f72 7420 4163 636f 756e 742c   import Account,
-0002e1a0: 2046 696c 6553 7973 7465 6d54 6f6b 656e   FileSystemToken
-0002e1b0: 4261 636b 656e 640a 2020 2020 2320 7361  Backend.    # sa
-0002e1c0: 7665 2074 6f6b 656e 2074 6f20 696e 7374  ve token to inst
-0002e1d0: 616c 6c61 7469 6f6e 2064 6972 6563 746f  allation directo
-0002e1e0: 7279 0a20 2020 2074 6f6b 656e 5f62 6163  ry.    token_bac
-0002e1f0: 6b65 6e64 203d 2046 696c 6553 7973 7465  kend = FileSyste
-0002e200: 6d54 6f6b 656e 4261 636b 656e 6428 746f  mTokenBackend(to
-0002e210: 6b65 6e5f 7061 7468 3d6f 732e 7061 7468  ken_path=os.path
-0002e220: 2e64 6972 6e61 6d65 286f 732e 7061 7468  .dirname(os.path
-0002e230: 2e61 6273 7061 7468 285f 5f66 696c 655f  .abspath(__file_
-0002e240: 5f29 292c 2074 6f6b 656e 5f66 696c 656e  _)), token_filen
-0002e250: 616d 653d 276f 3336 355f 746f 6b65 6e2e  ame='o365_token.
-0002e260: 7478 7427 290a 2020 2020 6163 636f 756e  txt').    accoun
-0002e270: 7420 3d20 4163 636f 756e 7428 6372 6564  t = Account(cred
-0002e280: 656e 7469 616c 732c 2074 6f6b 656e 5f62  entials, token_b
-0002e290: 6163 6b65 6e64 3d74 6f6b 656e 5f62 6163  ackend=token_bac
-0002e2a0: 6b65 6e64 290a 2020 2020 7363 6f70 6573  kend).    scopes
-0002e2b0: 3d5b 2762 6173 6963 272c 2027 6d65 7373  =['basic', 'mess
-0002e2c0: 6167 655f 616c 6c27 2c27 6f6e 6564 7269  age_all','onedri
-0002e2d0: 7665 5f61 6c6c 272c 2773 6861 7265 706f  ve_all','sharepo
-0002e2e0: 696e 745f 646c 272c 2774 6173 6b73 5f61  int_dl','tasks_a
-0002e2f0: 6c6c 272c 2763 616c 656e 6461 725f 616c  ll','calendar_al
-0002e300: 6c27 2c27 6361 6c65 6e64 6172 5f73 6861  l','calendar_sha
-0002e310: 7265 645f 616c 6c27 5d0a 2020 2020 6966  red_all'].    if
-0002e320: 206e 6f74 2061 6363 6f75 6e74 2e69 735f   not account.is_
-0002e330: 6175 7468 656e 7469 6361 7465 643a 2020  authenticated:  
-0002e340: 2320 7769 6c6c 2063 6865 636b 2069 6620  # will check if 
-0002e350: 7468 6572 6520 6973 2061 2074 6f6b 656e  there is a token
-0002e360: 2061 6e64 2068 6173 206e 6f74 2065 7870   and has not exp
-0002e370: 6972 6564 0a20 2020 2020 2020 2023 2061  ired.        # a
-0002e380: 736b 2066 6f72 2061 206c 6f67 696e 0a20  sk for a login. 
-0002e390: 2020 2020 2020 2023 2063 6f6e 736f 6c65         # console
-0002e3a0: 2062 6173 6564 2061 7574 6865 6e74 6963   based authentic
-0002e3b0: 6174 696f 6e20 5365 6520 4175 7468 656e  ation See Authen
-0002e3c0: 7469 6361 7469 6f6e 2066 6f72 206f 7468  tication for oth
-0002e3d0: 6572 2066 6c6f 7773 0a20 2020 2020 2020  er flows.       
-0002e3e0: 2061 6363 6f75 6e74 2e61 7574 6865 6e74   account.authent
-0002e3f0: 6963 6174 6528 7363 6f70 6573 3d73 636f  icate(scopes=sco
-0002e400: 7065 7329 0a20 2020 2072 6574 7572 6e20  pes).    return 
-0002e410: 6163 636f 756e 740a 0a64 6566 206f 7574  account..def out
-0002e420: 6c6f 6f6b 2874 6f2c 2073 7562 6a65 6374  look(to, subject
-0002e430: 2c20 626f 6479 3d4e 6f6e 652c 2061 7474  , body=None, att
-0002e440: 6163 686d 656e 7473 3d4e 6f6e 652c 2062  achments=None, b
-0002e450: 6363 3d4e 6f6e 652c 2063 633d 4e6f 6e65  cc=None, cc=None
-0002e460: 2c20 7265 706c 795f 746f 3d4e 6f6e 652c  , reply_to=None,
-0002e470: 2069 643d 4e6f 6e65 2c20 7365 6372 6574   id=None, secret
-0002e480: 3d4e 6f6e 6529 3a0a 2020 2020 2222 226f  =None):.    """o
-0002e490: 7574 6c6f 6f6b 2874 6f2c 2073 7562 6a65  utlook(to, subje
-0002e4a0: 6374 2c20 626f 6479 2c20 6174 7461 6368  ct, body, attach
-0002e4b0: 6d65 6e74 733d 4e6f 6e65 2c20 6263 633d  ments=None, bcc=
-0002e4c0: 4e6f 6e65 2c20 6363 3d4e 6f6e 652c 2072  None, cc=None, r
-0002e4d0: 6570 6c79 5f74 6f3d 4e6f 6e65 2c20 6964  eply_to=None, id
-0002e4e0: 3d4e 6f6e 652c 2073 6563 7265 743d 4e6f  =None, secret=No
-0002e4f0: 6e65 290a 2020 2020 746f 2f62 6363 2f63  ne).    to/bcc/c
-0002e500: 633a 205b 2761 4061 2e63 6f6d 272c 2762  c: ['a@a.com','b
-0002e510: 4062 2e63 6f6d 275d 206f 7220 2761 4061  @b.com'] or 'a@a
-0002e520: 2e63 6f6d 2c20 6240 622e 636f 6d27 0a20  .com, b@b.com'. 
-0002e530: 2020 2072 6570 6c79 5f74 6f3a 2027 6140     reply_to: 'a@
-0002e540: 612e 636f 6d27 0a20 2020 2062 6f64 793a  a.com'.    body:
-0002e550: 2068 746d 6c20 636f 6465 206f 7220 7465   html code or te
-0002e560: 7874 2e20 4265 7374 2070 7261 6374 6963  xt. Best practic
-0002e570: 653a 2057 7269 7465 2f46 6f72 6d61 7420  e: Write/Format 
-0002e580: 696e 204f 7574 6c6f 6f6b 2f57 6f72 642c  in Outlook/Word,
-0002e590: 2074 6865 6e20 5061 7374 6520 6173 2074   then Paste as t
-0002e5a0: 6578 742c 2057 7261 7020 7465 7874 2077  ext, Wrap text w
-0002e5b0: 6974 6820 3c70 7265 3e3c 2f70 7265 3e0a  ith <pre></pre>.
-0002e5c0: 2020 2020 6174 7461 6368 6d65 6e74 733a      attachments:
-0002e5d0: 2027 6669 6c65 5f69 6e5f 776f 726b 696e   'file_in_workin
-0002e5e0: 675f 6469 722e 7478 7427 206f 7220 5b27  g_dir.txt' or ['
-0002e5f0: 612e 7478 7427 2c27 622e 7079 272c 2763  a.txt','b.py','c
-0002e600: 2e70 6466 275d 0a20 2020 2069 642c 2073  .pdf'].    id, s
-0002e610: 6563 7265 743a 2069 676e 6f72 6564 2069  ecret: ignored i
-0002e620: 6620 7079 7365 6372 6574 7320 6578 6973  f pysecrets exis
-0002e630: 7473 0a20 2020 2022 2222 0a20 2020 2061  ts.    """.    a
-0002e640: 6363 6f75 6e74 203d 206f 3336 3561 7574  ccount = o365aut
-0002e650: 6828 6964 2c73 6563 7265 7429 0a20 2020  h(id,secret).   
-0002e660: 206d 203d 2061 6363 6f75 6e74 2e6e 6577   m = account.new
-0002e670: 5f6d 6573 7361 6765 2829 0a20 2020 206d  _message().    m
-0002e680: 2e74 6f2e 6164 6428 746f 290a 2020 2020  .to.add(to).    
-0002e690: 6d2e 7375 626a 6563 7420 3d20 7375 626a  m.subject = subj
-0002e6a0: 6563 740a 2020 2020 6d2e 626f 6479 203d  ect.    m.body =
-0002e6b0: 2062 6f64 790a 2020 2020 6966 2063 6320   body.    if cc 
-0002e6c0: 6973 206e 6f74 204e 6f6e 653a 206d 2e63  is not None: m.c
-0002e6d0: 632e 6164 6428 6363 290a 2020 2020 6966  c.add(cc).    if
-0002e6e0: 2062 6363 2069 7320 6e6f 7420 4e6f 6e65   bcc is not None
-0002e6f0: 3a20 6d2e 6263 632e 6164 6428 6263 6329  : m.bcc.add(bcc)
-0002e700: 0a20 2020 2069 6620 7265 706c 795f 746f  .    if reply_to
-0002e710: 2069 7320 6e6f 7420 4e6f 6e65 3a20 6d2e   is not None: m.
-0002e720: 7265 706c 795f 746f 2e61 6464 2872 6570  reply_to.add(rep
-0002e730: 6c79 5f74 6f29 0a20 2020 2069 6620 6174  ly_to).    if at
-0002e740: 7461 6368 6d65 6e74 7320 6973 206e 6f74  tachments is not
-0002e750: 204e 6f6e 653a 206d 2e61 7474 6163 686d   None: m.attachm
-0002e760: 656e 7473 2e61 6464 2861 7474 6163 686d  ents.add(attachm
-0002e770: 656e 7473 290a 2020 2020 6d2e 7365 6e64  ents).    m.send
-0002e780: 2829 0a0a 6465 6620 6f6e 6564 7269 7665  ()..def onedrive
-0002e790: 5f73 6861 7265 2870 6174 682c 7368 6172  _share(path,shar
-0002e7a0: 655f 7479 7065 3d27 7669 6577 272c 7368  e_type='view',sh
-0002e7b0: 6172 655f 7363 6f70 653d 2761 6e6f 6e79  are_scope='anony
-0002e7c0: 6d6f 7573 272c 7368 6172 655f 7061 7373  mous',share_pass
-0002e7d0: 776f 7264 3d4e 6f6e 652c 7368 6172 655f  word=None,share_
-0002e7e0: 6578 7069 7261 7469 6f6e 5f64 6174 653d  expiration_date=
-0002e7f0: 4e6f 6e65 2c69 643d 4e6f 6e65 2c73 6563  None,id=None,sec
-0002e800: 7265 743d 4e6f 6e65 293a 0a20 2020 2022  ret=None):.    "
-0002e810: 2222 0a20 2020 2070 6174 683a 2027 2f45  "".    path: '/E
-0002e820: 4955 2f54 6561 6368 696e 672f 3438 3130  IU/Teaching/4810
-0002e830: 4472 7567 270a 2020 2020 7368 6172 655f  Drug'.    share_
-0002e840: 7479 7065 3a20 2776 6965 7727 2c27 6564  type: 'view','ed
-0002e850: 6974 272c 2765 6d62 6564 270a 2020 2020  it','embed'.    
-0002e860: 7368 6172 655f 7363 6f70 653a 2027 616e  share_scope: 'an
-0002e870: 6f6e 796d 6f75 7327 2c27 6f72 6761 6e69  onymous','organi
-0002e880: 7a61 7469 6f6e 270a 2020 2020 7368 6172  zation'.    shar
-0002e890: 655f 7061 7373 776f 7264 3a20 7374 7220  e_password: str 
-0002e8a0: 6f72 204e 6f6e 650a 2020 2020 7368 6172  or None.    shar
-0002e8b0: 655f 6578 7069 7261 7469 6f6e 5f64 6174  e_expiration_dat
-0002e8c0: 653a 2027 3230 3232 2d30 322d 3134 272c  e: '2022-02-14',
-0002e8d0: 200a 2020 2020 2020 2020 6966 206e 6f74   .        if not
-0002e8e0: 2073 7065 6369 6669 6564 2c20 6175 746f   specified, auto
-0002e8f0: 206d 6178 2064 6574 6572 6d69 6e65 6420   max determined 
-0002e900: 6279 2061 646d 696e 7374 7261 746f 720a  by adminstrator.
-0002e910: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
-0002e920: 7065 6369 6669 6564 2c20 6361 6c6c 2074  pecified, call t
-0002e930: 6865 2066 756e 6374 696f 6e20 6120 7365  he function a se
-0002e940: 636f 6e64 2074 696d 6520 7769 6c6c 2061  cond time will a
-0002e950: 7574 6f20 7265 6e65 7720 6578 7069 7261  uto renew expira
-0002e960: 7469 6f6e 2064 6174 6520 2861 7320 6c6f  tion date (as lo
-0002e970: 6e67 2061 7320 7368 6172 6520 646f 6573  ng as share does
-0002e980: 206e 6f74 2063 6861 6e67 6529 0a20 2020   not change).   
-0002e990: 2022 2222 0a20 2020 2061 6363 6f75 6e74   """.    account
-0002e9a0: 203d 206f 3336 3561 7574 6828 6964 2c73   = o365auth(id,s
-0002e9b0: 6563 7265 7429 0a20 2020 2073 746f 7261  ecret).    stora
-0002e9c0: 6765 203d 2061 6363 6f75 6e74 2e73 746f  ge = account.sto
-0002e9d0: 7261 6765 2829 2020 2320 6865 7265 2077  rage()  # here w
-0002e9e0: 6520 6765 7420 7468 6520 7374 6f72 6167  e get the storag
-0002e9f0: 6520 696e 7374 616e 6365 2074 6861 7420  e instance that 
-0002ea00: 6861 6e64 6c65 7320 616c 6c20 7468 6520  handles all the 
-0002ea10: 7374 6f72 6167 6520 6f70 7469 6f6e 732e  storage options.
-0002ea20: 0a20 2020 2023 2067 6574 2074 6865 2064  .    # get the d
-0002ea30: 6566 6175 6c74 2064 7269 7665 0a20 2020  efault drive.   
-0002ea40: 2064 7269 7665 203d 2073 746f 7261 6765   drive = storage
-0002ea50: 2e67 6574 5f64 6566 6175 6c74 5f64 7269  .get_default_dri
-0002ea60: 7665 2829 0a20 2020 2069 7465 6d20 3d20  ve().    item = 
-0002ea70: 6472 6976 652e 6765 745f 6974 656d 5f62  drive.get_item_b
-0002ea80: 795f 7061 7468 2870 6174 6829 0a20 2020  y_path(path).   
-0002ea90: 2070 6572 6d69 7373 696f 6e20 3d20 6974   permission = it
-0002eaa0: 656d 2e73 6861 7265 5f77 6974 685f 6c69  em.share_with_li
-0002eab0: 6e6b 2873 6861 7265 5f74 7970 653d 7368  nk(share_type=sh
-0002eac0: 6172 655f 7479 7065 2c73 6861 7265 5f73  are_type,share_s
-0002ead0: 636f 7065 3d73 6861 7265 5f73 636f 7065  cope=share_scope
-0002eae0: 2c73 6861 7265 5f70 6173 7377 6f72 643d  ,share_password=
-0002eaf0: 7368 6172 655f 7061 7373 776f 7264 2c73  share_password,s
-0002eb00: 6861 7265 5f65 7870 6972 6174 696f 6e5f  hare_expiration_
-0002eb10: 6461 7465 3d73 6861 7265 5f65 7870 6972  date=share_expir
-0002eb20: 6174 696f 6e5f 6461 7465 290a 2020 2020  ation_date).    
-0002eb30: 7265 7475 726e 2070 6572 6d69 7373 696f  return permissio
-0002eb40: 6e2e 7368 6172 655f 6c69 6e6b 0a0a 6465  n.share_link..de
-0002eb50: 6620 6765 7470 6173 7377 6f72 6462 7728  f getpasswordbw(
-0002eb60: 6974 656d 2c77 6861 743d 2775 7372 7077  item,what='usrpw
-0002eb70: 6427 2c73 796e 633d 4661 6c73 652c 7665  d',sync=False,ve
-0002eb80: 7262 6f73 653d 3029 3a0a 2020 2020 2222  rbose=0):.    ""
-0002eb90: 220a 2020 2020 6974 656d 3a20 7365 6172  ".    item: sear
-0002eba0: 6368 2073 7472 696e 6720 286e 6f74 2063  ch string (not c
-0002ebb0: 6173 6520 7365 6e73 6974 6976 652c 2062  ase sensitive, b
-0002ebc0: 6574 7465 7220 6265 2075 6e69 7175 6529  etter be unique)
-0002ebd0: 2c20 6f72 2069 7465 6d20 6964 0a20 2020  , or item id.   
-0002ebe0: 2068 7474 7073 3a2f 2f62 6974 7761 7264   https://bitward
-0002ebf0: 656e 2e63 6f6d 2f68 656c 702f 6172 7469  en.com/help/arti
-0002ec00: 636c 652f 636c 692f 2367 6574 0a20 2020  cle/cli/#get.   
-0002ec10: 2067 6574 206f 6e65 2061 7420 6120 7469   get one at a ti
-0002ec20: 6d65 3a20 6974 656d 7c75 7365 726e 616d  me: item|usernam
-0002ec30: 657c 7061 7373 776f 7264 7c75 7269 7c74  e|password|uri|t
-0002ec40: 6f74 707c 6578 706f 7365 647c 6174 7461  otp|exposed|atta
-0002ec50: 6368 6d65 6e74 7c66 6f6c 6465 727c 636f  chment|folder|co
-0002ec60: 6c6c 6563 7469 6f6e 7c6f 7267 616e 697a  llection|organiz
-0002ec70: 6174 696f 6e7c 6f72 672d 636f 6c6c 6563  ation|org-collec
-0002ec80: 7469 6f6e 7c74 656d 706c 6174 657c 6669  tion|template|fi
-0002ec90: 6e67 6572 7072 696e 740a 2020 2020 7370  ngerprint.    sp
-0002eca0: 6563 6961 6c20 6375 7374 6f6d 697a 6564  ecial customized
-0002ecb0: 2077 6861 743d 2775 7372 7077 6427 0a20   what='usrpwd'. 
-0002ecc0: 2020 2022 2222 0a20 2020 2023 2074 6f64     """.    # tod
-0002ecd0: 6f3a 2069 6d70 6c65 6d65 6e74 2062 7720  o: implement bw 
-0002ece0: 6f6e 206c 696e 7578 0a20 2020 206f 6c64  on linux.    old
-0002ecf0: 7768 6174 3d77 6861 740a 2020 2020 6966  what=what.    if
-0002ed00: 2077 6861 743d 3d27 7573 7270 7764 273a   what=='usrpwd':
-0002ed10: 2077 6861 743d 2769 7465 6d27 0a0a 2020   what='item'..  
-0002ed20: 2020 2320 6c6f 6361 6c20 7661 7220 636f    # local var co
-0002ed30: 756c 6420 6265 2074 6865 2073 616d 6520  uld be the same 
-0002ed40: 6e61 6d65 2061 7320 676c 6f62 616c 2076  name as global v
-0002ed50: 6172 0a20 2020 2023 2062 7574 2069 6620  ar.    # but if 
-0002ed60: 6368 616e 6765 2076 6172 2c20 6265 7474  change var, bett
-0002ed70: 6572 2075 7365 206c 6f63 616c 2076 6172  er use local var
-0002ed80: 0a20 2020 2023 2069 6620 6368 616e 6765  .    # if change
-0002ed90: 2067 6c6f 6261 6c20 7661 722c 2064 6566   global var, def
-0002eda0: 696e 653a 2067 6c6f 6261 6c20 7661 720a  ine: global var.
-0002edb0: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
-0002edc0: 205f 454d 4149 4c20 3d20 454d 4149 4c0a   _EMAIL = EMAIL.
-0002edd0: 2020 2020 2020 2020 5f50 4153 5357 4f52          _PASSWOR
-0002ede0: 4420 3d20 5041 5353 574f 5244 202b 2027  D = PASSWORD + '
-0002edf0: 2b27 0a20 2020 2065 7863 6570 743a 0a20  +'.    except:. 
-0002ee00: 2020 2020 2020 205f 454d 4149 4c20 3d20         _EMAIL = 
-0002ee10: 2727 3b20 5f50 4153 5357 4f52 443d 2727  ''; _PASSWORD=''
-0002ee20: 0a0a 2020 2020 6d61 6368 696e 6520 3d20  ..    machine = 
-0002ee30: 6765 746f 7328 290a 2020 2020 6966 206d  getos().    if m
-0002ee40: 6163 6869 6e65 3d3d 2744 6172 7769 6e27  achine=='Darwin'
-0002ee50: 3a0a 2020 2020 2020 2020 6277 203d 2027  :.        bw = '
-0002ee60: 2f75 7372 2f6c 6f63 616c 2f62 696e 2f62  /usr/local/bin/b
-0002ee70: 7727 0a20 2020 2020 2020 2073 796e 6320  w'.        sync 
-0002ee80: 3d20 2727 2069 6620 7379 6e63 2065 6c73  = '' if sync els
-0002ee90: 6520 2723 2027 2023 2063 6f6d 6d65 6e74  e '# ' # comment
-0002eea0: 206f 7574 0a20 2020 2020 2020 206f 7574   out.        out
-0002eeb0: 203d 2065 7865 6375 7465 3028 6627 7b62   = execute0(f'{b
-0002eec0: 777d 2073 7461 7475 7327 2c76 6572 626f  w} status',verbo
-0002eed0: 7365 3d76 6572 626f 7365 290a 2020 2020  se=verbose).    
-0002eee0: 2020 2020 7374 6174 7573 203d 2072 652e      status = re.
-0002eef0: 7365 6172 6368 2827 2273 7461 7475 7322  search('"status"
-0002ef00: 3a22 285c 772b 2922 272c 6f75 745b 305d  :"(\w+)"',out[0]
-0002ef10: 292e 6772 6f75 7028 3129 0a20 2020 2020  ).group(1).     
-0002ef20: 2020 2069 6620 7374 6174 7573 203d 3d20     if status == 
-0002ef30: 2775 6e61 7574 6865 6e74 6963 6174 6564  'unauthenticated
-0002ef40: 273a 0a20 2020 2020 2020 2020 2020 2063  ':.            c
-0002ef50: 6d64 203d 2066 2222 220a 2020 2020 2020  md = f""".      
-0002ef60: 2020 2020 2020 6578 706f 7274 2042 575f        export BW_
-0002ef70: 5553 4552 3d7b 5f45 4d41 494c 7d0a 2020  USER={_EMAIL}.  
-0002ef80: 2020 2020 2020 2020 2020 6578 706f 7274            export
-0002ef90: 2042 575f 5041 5353 574f 5244 3d7b 5f50   BW_PASSWORD={_P
-0002efa0: 4153 5357 4f52 447d 0a20 2020 2020 2020  ASSWORD}.       
-0002efb0: 2020 2020 207b 6277 7d20 6c6f 6769 6e20       {bw} login 
-0002efc0: 2442 575f 5553 4552 2024 4257 5f50 4153  $BW_USER $BW_PAS
-0002efd0: 5357 4f52 440a 2020 2020 2020 2020 2020  SWORD.          
-0002efe0: 2020 2222 220a 2020 2020 2020 2020 2020    """.          
-0002eff0: 2020 6578 6563 7574 6528 636d 642c 7665    execute(cmd,ve
-0002f000: 7262 6f73 653d 7665 7262 6f73 6529 0a20  rbose=verbose). 
-0002f010: 2020 2020 2020 2020 2020 2073 7461 7475             statu
-0002f020: 7320 3d20 276c 6f63 6b65 6427 2023 206c  s = 'locked' # l
-0002f030: 6f67 696e 2066 6972 7374 0a20 2020 2020  ogin first.     
-0002f040: 2020 2069 6620 7374 6174 7573 203d 3d20     if status == 
-0002f050: 276c 6f63 6b65 6427 206f 7220 7374 6174  'locked' or stat
-0002f060: 7573 203d 3d20 2775 6e6c 6f63 6b65 6427  us == 'unlocked'
-0002f070: 3a20 2023 2061 6c77 6179 7320 756e 6c6f  :  # always unlo
-0002f080: 636b 2074 6f20 6765 7420 7365 7373 696f  ck to get sessio
-0002f090: 6e20 6964 0a20 2020 2020 2020 2020 2020  n id.           
-0002f0a0: 2063 6d64 203d 2066 2222 220a 2020 2020   cmd = f""".    
-0002f0b0: 2020 2020 2020 2020 6578 706f 7274 2042          export B
-0002f0c0: 575f 5041 5353 574f 5244 3d7b 5f50 4153  W_PASSWORD={_PAS
-0002f0d0: 5357 4f52 447d 0a20 2020 2020 2020 2020  SWORD}.         
-0002f0e0: 2020 2065 7870 6f72 7420 4257 5f53 4553     export BW_SES
-0002f0f0: 5349 4f4e 3d24 287b 6277 7d20 756e 6c6f  SION=$({bw} unlo
-0002f100: 636b 202d 2d70 6173 7377 6f72 6465 6e76  ck --passwordenv
-0002f110: 2042 575f 5041 5353 574f 5244 202d 2d72   BW_PASSWORD --r
-0002f120: 6177 290a 2020 2020 2020 2020 2020 2020  aw).            
-0002f130: 7b73 796e 637d 7b62 777d 2073 796e 6320  {sync}{bw} sync 
-0002f140: 2d2d 7175 6965 740a 2020 2020 2020 2020  --quiet.        
-0002f150: 2020 2020 7b62 777d 2067 6574 207b 7768      {bw} get {wh
-0002f160: 6174 7d20 7b69 7465 6d7d 0a20 2020 2020  at} {item}.     
-0002f170: 2020 2020 2020 207b 6277 7d20 6c6f 636b         {bw} lock
-0002f180: 202d 2d71 7569 6574 0a20 2020 2020 2020   --quiet.       
-0002f190: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0002f1a0: 2020 2020 206f 7574 203d 2065 7865 6375       out = execu
-0002f1b0: 7465 3028 636d 642c 7665 7262 6f73 653d  te0(cmd,verbose=
-0002f1c0: 7665 7262 6f73 6529 0a20 2020 2020 2020  verbose).       
-0002f1d0: 2020 2020 2069 6620 7768 6174 3d3d 2769       if what=='i
-0002f1e0: 7465 6d27 3a0a 2020 2020 2020 2020 2020  tem':.          
-0002f1f0: 2020 2020 2020 696d 706f 7274 206a 736f        import jso
-0002f200: 6e0a 2020 2020 2020 2020 2020 2020 2020  n.              
-0002f210: 2020 6f75 7420 3d20 6a73 6f6e 2e6c 6f61    out = json.loa
-0002f220: 6473 286f 7574 5b2d 315d 290a 2020 2020  ds(out[-1]).    
-0002f230: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0002f240: 2020 2020 2020 2020 2020 2020 2020 6f75                ou
-0002f250: 7420 3d20 6f75 745b 2d31 5d0a 2020 2020  t = out[-1].    
-0002f260: 656c 6966 206d 6163 6869 6e65 3d3d 2757  elif machine=='W
-0002f270: 696e 646f 7773 273a 0a20 2020 2020 2020  indows':.       
-0002f280: 2062 7720 3d20 2725 5749 4e41 5050 5325   bw = '%WINAPPS%
-0002f290: 2f62 772e 6578 6527 0a20 2020 2020 2020  /bw.exe'.       
-0002f2a0: 2073 796e 6320 3d20 2727 2069 6620 7379   sync = '' if sy
-0002f2b0: 6e63 2065 6c73 6520 2772 656d 2027 2023  nc else 'rem ' #
-0002f2c0: 2063 6f6d 6d65 6e74 206f 7574 0a20 2020   comment out.   
-0002f2d0: 2020 2020 206f 7574 203d 2065 7865 6375       out = execu
-0002f2e0: 7465 3028 6627 7b62 777d 2073 7461 7475  te0(f'{bw} statu
-0002f2f0: 7327 2c76 6572 626f 7365 3d76 6572 626f  s',verbose=verbo
-0002f300: 7365 290a 2020 2020 2020 2020 7374 6174  se).        stat
-0002f310: 7573 203d 2072 652e 7365 6172 6368 2827  us = re.search('
-0002f320: 2273 7461 7475 7322 3a22 285c 772b 2922  "status":"(\w+)"
-0002f330: 272c 6f75 745b 305d 292e 6772 6f75 7028  ',out[0]).group(
-0002f340: 3129 0a20 2020 2020 2020 2069 6620 7374  1).        if st
-0002f350: 6174 7573 203d 3d20 2775 6e61 7574 6865  atus == 'unauthe
-0002f360: 6e74 6963 6174 6564 273a 0a20 2020 2020  nticated':.     
-0002f370: 2020 2020 2020 2063 6d64 203d 2066 2222         cmd = f""
-0002f380: 220a 2020 2020 2020 2020 2020 2020 7365  ".            se
-0002f390: 7420 4257 5f55 5345 523d 7b5f 454d 4149  t BW_USER={_EMAI
-0002f3a0: 4c7d 0a20 2020 2020 2020 2020 2020 2073  L}.            s
-0002f3b0: 6574 2042 575f 5041 5353 574f 5244 3d7b  et BW_PASSWORD={
-0002f3c0: 5f50 4153 5357 4f52 447d 0a20 2020 2020  _PASSWORD}.     
-0002f3d0: 2020 2020 2020 207b 6277 7d20 6c6f 6769         {bw} logi
-0002f3e0: 6e20 2542 575f 5553 4552 2520 2542 575f  n %BW_USER% %BW_
-0002f3f0: 5041 5353 574f 5244 250a 2020 2020 2020  PASSWORD%.      
-0002f400: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0002f410: 2020 2020 2020 6578 6563 7574 6528 636d        execute(cm
-0002f420: 642c 7665 7262 6f73 653d 7665 7262 6f73  d,verbose=verbos
-0002f430: 6529 0a20 2020 2020 2020 2020 2020 2073  e).            s
-0002f440: 7461 7475 7320 3d20 276c 6f63 6b65 6427  tatus = 'locked'
-0002f450: 2023 206c 6f67 696e 2066 6972 7374 0a20   # login first. 
-0002f460: 2020 2020 2020 2069 6620 7374 6174 7573         if status
-0002f470: 203d 3d20 276c 6f63 6b65 6427 206f 7220   == 'locked' or 
-0002f480: 7374 6174 7573 203d 3d20 2775 6e6c 6f63  status == 'unloc
-0002f490: 6b65 6427 3a20 2023 2061 6c77 6179 7320  ked':  # always 
-0002f4a0: 756e 6c6f 636b 2074 6f20 6765 7420 7365  unlock to get se
-0002f4b0: 7373 696f 6e20 6964 0a20 2020 2020 2020  ssion id.       
-0002f4c0: 2020 2020 2063 6d64 203d 2066 2222 220a       cmd = f""".
-0002f4d0: 2020 2020 2020 2020 2020 2020 7365 7420              set 
-0002f4e0: 4257 5f50 4153 5357 4f52 443d 7b5f 5041  BW_PASSWORD={_PA
-0002f4f0: 5353 574f 5244 7d0a 2020 2020 2020 2020  SSWORD}.        
-0002f500: 2020 2020 464f 5220 2f46 2022 746f 6b65      FOR /F "toke
-0002f510: 6e73 3d2a 2220 2525 6720 494e 2028 277b  ns=*" %%g IN ('{
-0002f520: 6277 7d20 756e 6c6f 636b 202d 2d70 6173  bw} unlock --pas
-0002f530: 7377 6f72 6465 6e76 2042 575f 5041 5353  swordenv BW_PASS
-0002f540: 574f 5244 202d 2d72 6177 2729 2064 6f20  WORD --raw') do 
-0002f550: 2873 6574 2042 575f 5345 5353 494f 4e3d  (set BW_SESSION=
-0002f560: 2525 6729 0a20 2020 2020 2020 2020 2020  %%g).           
-0002f570: 207b 7379 6e63 7d7b 6277 7d20 7379 6e63   {sync}{bw} sync
-0002f580: 202d 2d71 7569 6574 0a20 2020 2020 2020   --quiet.       
-0002f590: 2020 2020 207b 6277 7d20 6765 7420 7b77       {bw} get {w
-0002f5a0: 6861 747d 207b 6974 656d 7d0a 2020 2020  hat} {item}.    
-0002f5b0: 2020 2020 2020 2020 7b62 777d 206c 6f63          {bw} loc
-0002f5c0: 6b20 2d2d 7175 6965 740a 2020 2020 2020  k --quiet.      
-0002f5d0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0002f5e0: 2020 2020 2020 6f75 7420 3d20 6578 6563        out = exec
-0002f5f0: 7574 6530 2863 6d64 2c76 6572 626f 7365  ute0(cmd,verbose
-0002f600: 3d76 6572 626f 7365 290a 2020 2020 2020  =verbose).      
-0002f610: 2020 2020 2020 6966 2077 6861 743d 3d27        if what=='
-0002f620: 6974 656d 273a 0a20 2020 2020 2020 2020  item':.         
-0002f630: 2020 2020 2020 2069 6d70 6f72 7420 6a73         import js
-0002f640: 6f6e 0a20 2020 2020 2020 2020 2020 2020  on.             
-0002f650: 2020 206f 7574 203d 206a 736f 6e2e 6c6f     out = json.lo
-0002f660: 6164 7328 6f75 745b 2d31 5d29 0a20 2020  ads(out[-1]).   
-0002f670: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-0002f680: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-0002f690: 7574 203d 206f 7574 5b2d 315d 0a20 2020  ut = out[-1].   
-0002f6a0: 200a 2020 2020 6966 206f 6c64 7768 6174   .    if oldwhat
-0002f6b0: 3d3d 2775 7372 7077 6427 3a0a 2020 2020  =='usrpwd':.    
-0002f6c0: 2020 2020 2875 7372 2c70 7764 293d 286f      (usr,pwd)=(o
-0002f6d0: 7574 5b27 6c6f 6769 6e27 5d5b 2775 7365  ut['login']['use
-0002f6e0: 726e 616d 6527 5d2c 6f75 745b 276c 6f67  rname'],out['log
-0002f6f0: 696e 275d 5b27 7061 7373 776f 7264 275d  in']['password']
-0002f700: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-0002f710: 2028 7573 722c 7077 6429 0a20 2020 2065   (usr,pwd).    e
-0002f720: 6c73 653a 0a20 2020 2020 2020 2072 6574  lse:.        ret
-0002f730: 7572 6e20 6f75 740a 0a64 6566 2073 656e  urn out..def sen
-0002f740: 6428 2a6b 6579 732c 6465 6c61 793d 5b30  d(*keys,delay=[0
-0002f750: 2e30 3235 2c30 2e32 355d 2c74 696d 6573  .025,0.25],times
-0002f760: 3d31 293a 0a20 2020 2022 2222 0a20 2020  =1):.    """.   
-0002f770: 204b 4559 532e 434f 4d4d 414e 442c 4b45   KEYS.COMMAND,KE
-0002f780: 5953 2e53 4849 4654 2c4b 4559 532e 4152  YS.SHIFT,KEYS.AR
-0002f790: 524f 575f 4c45 4654 0a20 2020 204b 4559  ROW_LEFT.    KEY
-0002f7a0: 532e 434f 4d4d 414e 442c 2761 270a 2020  S.COMMAND,'a'.  
-0002f7b0: 2020 2761 6263 272c 204b 4559 532e 4152    'abc', KEYS.AR
-0002f7c0: 524f 575f 444f 574e 0a20 2020 2027 6162  ROW_DOWN.    'ab
-0002f7d0: 635c 6e64 6566 5c74 6727 0a0a 2020 2020  c\ndef\tg'..    
-0002f7e0: 6465 6c61 7920 696e 2073 6563 6f6e 6473  delay in seconds
-0002f7f0: 2061 6674 6572 2065 6163 6820 6b65 7920   after each key 
-0002f800: 7072 6573 732c 2030 2c20 5b30 2e30 3235  press, 0, [0.025
-0002f810: 2c30 2e32 355d 203c 2d72 616e 646f 6d20  ,0.25] <-random 
-0002f820: 6265 7477 6565 6e0a 2020 2020 7469 6d65  between.    time
-0002f830: 730a 2020 2020 6465 6c61 7920 616e 6420  s.    delay and 
-0002f840: 7469 6d65 7320 6861 7665 2074 6f20 6265  times have to be
-0002f850: 206e 616d 6564 2070 6172 616d 6174 6572   named paramater
-0002f860: 2c20 6361 6e6e 6f74 2062 6520 6f6d 6974  , cannot be omit
-0002f870: 7465 6420 6173 2070 6f73 6974 696f 6e20  ted as position 
-0002f880: 7061 7261 6d65 7465 7220 6265 6361 7573  parameter becaus
-0002f890: 6520 6f66 202a 6b65 7973 0a20 2020 2022  e of *keys.    "
-0002f8a0: 2222 0a20 2020 2066 726f 6d20 7079 6e70  "".    from pynp
-0002f8b0: 7574 2e6b 6579 626f 6172 6420 696d 706f  ut.keyboard impo
-0002f8c0: 7274 204b 6579 2c20 436f 6e74 726f 6c6c  rt Key, Controll
-0002f8d0: 6572 0a20 2020 206b 6579 626f 6172 6420  er.    keyboard 
-0002f8e0: 3d20 436f 6e74 726f 6c6c 6572 2829 0a0a  = Controller()..
-0002f8f0: 2020 2020 2320 6874 7470 733a 2f2f 7777      # https://ww
-0002f900: 772e 7365 6c65 6e69 756d 2e64 6576 2f73  w.selenium.dev/s
-0002f910: 656c 656e 6975 6d2f 646f 6373 2f61 7069  elenium/docs/api
-0002f920: 2f70 792f 5f6d 6f64 756c 6573 2f73 656c  /py/_modules/sel
-0002f930: 656e 6975 6d2f 7765 6264 7269 7665 722f  enium/webdriver/
-0002f940: 636f 6d6d 6f6e 2f6b 6579 732e 6874 6d6c  common/keys.html
-0002f950: 234b 6579 730a 0a20 2020 2023 2063 6d64  #Keys..    # cmd
-0002f960: 2c73 6869 6674 2c63 7472 6c2c 7461 622c  ,shift,ctrl,tab,
-0002f970: 7370 6163 652c 6261 636b 7370 6163 652c  space,backspace,
-0002f980: 6465 6c65 7465 2c65 7363 2c65 6e74 6572  delete,esc,enter
-0002f990: 2c0a 2020 2020 2320 7570 2f64 6f77 6e2f  ,.    # up/down/
-0002f9a0: 6c65 6674 2f72 6967 6874 2c68 6f6d 652c  left/right,home,
-0002f9b0: 656e 642c 7061 6765 5f75 702c 7061 6765  end,page_up,page
-0002f9c0: 5f64 6f77 6e2c 0a20 2020 2023 2069 6e73  _down,.    # ins
-0002f9d0: 6572 742c 6d65 6e75 2c70 6175 7365 2c70  ert,menu,pause,p
-0002f9e0: 7269 6e74 5f73 6372 6565 6e2c 7363 726f  rint_screen,scro
-0002f9f0: 6c6c 5f6c 6f63 6b2c 0a20 2020 2023 2066  ll_lock,.    # f
-0002fa00: 312c 6632 2c2e 2e2e 2c66 3230 0a20 2020  1,f2,...,f20.   
-0002fa10: 2023 206d 6564 6961 5f6e 6578 742c 6d65   # media_next,me
-0002fa20: 6469 615f 706c 6179 5f70 6175 7365 2c6d  dia_play_pause,m
-0002fa30: 6564 6961 5f70 7265 7669 6f75 732c 6d65  edia_previous,me
-0002fa40: 6469 615f 766f 6c75 6d65 5f64 6f77 6e2c  dia_volume_down,
-0002fa50: 6d65 6469 615f 766f 6c75 6d65 5f6d 7574  media_volume_mut
-0002fa60: 652c 6d65 6469 615f 766f 6c75 6d65 5f75  e,media_volume_u
-0002fa70: 700a 2020 2020 2320 6874 7470 733a 2f2f  p.    # https://
-0002fa80: 7079 6e70 7574 2e72 6561 6474 6865 646f  pynput.readthedo
-0002fa90: 6373 2e69 6f2f 656e 2f6c 6174 6573 742f  cs.io/en/latest/
-0002faa0: 6b65 7962 6f61 7264 2e68 746d 6c23 7079  keyboard.html#py
-0002fab0: 6e70 7574 2e6b 6579 626f 6172 642e 4b65  nput.keyboard.Ke
-0002fac0: 790a 0a20 2020 2023 2072 656d 6170 2063  y..    # remap c
-0002fad0: 6572 7461 696e 206b 6579 7320 6265 7477  ertain keys betw
-0002fae0: 6565 6e20 7365 6c65 6e69 756d 2061 6e64  een selenium and
-0002faf0: 2070 796e 7075 740a 2020 2020 7265 6d61   pynput.    rema
-0002fb00: 7073 3d7b 0a20 2020 2020 2020 2075 275c  ps={.        u'\
-0002fb10: 7565 3030 3327 3a4b 6579 2e62 6163 6b73  ue003':Key.backs
-0002fb20: 7061 6365 2c20 2020 2320 4241 434b 5350  pace,   # BACKSP
-0002fb30: 4143 450a 2020 2020 2020 2020 7527 5c75  ACE.        u'\u
-0002fb40: 6530 3034 273a 4b65 792e 7461 622c 2020  e004':Key.tab,  
-0002fb50: 2023 2054 4142 0a20 2020 2020 2020 2075   # TAB.        u
-0002fb60: 275c 7565 3030 3627 3a4b 6579 2e65 6e74  '\ue006':Key.ent
-0002fb70: 6572 2c20 2020 2320 5245 5455 524e 0a20  er,   # RETURN. 
-0002fb80: 2020 2020 2020 2075 275c 7565 3030 3727         u'\ue007'
-0002fb90: 3a4b 6579 2e65 6e74 6572 2c20 2020 2320  :Key.enter,   # 
-0002fba0: 454e 5445 520a 2020 2020 2020 2020 7527  ENTER.        u'
-0002fbb0: 5c75 6530 3038 273a 4b65 792e 7368 6966  \ue008':Key.shif
-0002fbc0: 742c 2020 2023 2053 4849 4654 2c20 4c45  t,   # SHIFT, LE
-0002fbd0: 4654 5f53 4849 4654 0a20 2020 2020 2020  FT_SHIFT.       
-0002fbe0: 2075 275c 7565 3030 3927 3a4b 6579 2e63   u'\ue009':Key.c
-0002fbf0: 7472 6c2c 2020 2023 2043 4f4e 5452 4f4c  trl,   # CONTROL
-0002fc00: 2c20 4c45 4654 5f43 4f4e 5452 4f4c 0a20  , LEFT_CONTROL. 
-0002fc10: 2020 2020 2020 2075 275c 7565 3030 6127         u'\ue00a'
-0002fc20: 3a4b 6579 2e61 6c74 2c20 2020 2320 414c  :Key.alt,   # AL
-0002fc30: 542c 204c 4546 545f 414c 540a 2020 2020  T, LEFT_ALT.    
-0002fc40: 2020 2020 7527 5c75 6530 3063 273a 4b65      u'\ue00c':Ke
-0002fc50: 792e 6573 632c 2020 2023 2045 5343 4150  y.esc,   # ESCAP
-0002fc60: 450a 2020 2020 2020 2020 7527 5c75 6530  E.        u'\ue0
-0002fc70: 3064 273a 4b65 792e 7370 6163 652c 2020  0d':Key.space,  
-0002fc80: 2023 2053 5041 4345 0a20 2020 2020 2020   # SPACE.       
-0002fc90: 2075 275c 7565 3030 6527 3a4b 6579 2e70   u'\ue00e':Key.p
-0002fca0: 6167 655f 7570 2c20 2020 2320 5041 4745  age_up,   # PAGE
-0002fcb0: 5f55 500a 2020 2020 2020 2020 7527 5c75  _UP.        u'\u
-0002fcc0: 6530 3066 273a 4b65 792e 7061 6765 5f64  e00f':Key.page_d
-0002fcd0: 6f77 6e2c 2020 2023 2050 4147 455f 444f  own,   # PAGE_DO
-0002fce0: 574e 0a20 2020 2020 2020 2075 275c 7565  WN.        u'\ue
-0002fcf0: 3031 3027 3a4b 6579 2e65 6e64 2c20 2020  010':Key.end,   
-0002fd00: 2320 454e 440a 2020 2020 2020 2020 7527  # END.        u'
-0002fd10: 5c75 6530 3131 273a 4b65 792e 686f 6d65  \ue011':Key.home
-0002fd20: 2c20 2020 2320 484f 4d45 0a20 2020 2020  ,   # HOME.     
-0002fd30: 2020 2075 275c 7565 3031 3227 3a4b 6579     u'\ue012':Key
-0002fd40: 2e6c 6566 742c 2020 2023 204c 4546 542c  .left,   # LEFT,
-0002fd50: 2041 5252 4f57 5f4c 4546 540a 2020 2020   ARROW_LEFT.    
-0002fd60: 2020 2020 7527 5c75 6530 3133 273a 4b65      u'\ue013':Ke
-0002fd70: 792e 7570 2c20 2020 2320 5550 2c20 4152  y.up,   # UP, AR
-0002fd80: 524f 575f 5550 0a20 2020 2020 2020 2075  ROW_UP.        u
-0002fd90: 275c 7565 3031 3427 3a4b 6579 2e72 6967  '\ue014':Key.rig
-0002fda0: 6874 2c20 2020 2320 5249 4748 542c 2041  ht,   # RIGHT, A
-0002fdb0: 5252 4f57 5f52 4947 4854 0a20 2020 2020  RROW_RIGHT.     
-0002fdc0: 2020 2075 275c 7565 3031 3527 3a4b 6579     u'\ue015':Key
-0002fdd0: 2e64 6f77 6e2c 2020 2023 2044 4f57 4e2c  .down,   # DOWN,
-0002fde0: 2041 5252 4f57 5f44 4f57 4e0a 2020 2020   ARROW_DOWN.    
-0002fdf0: 2020 2020 7527 5c75 6530 3137 273a 4b65      u'\ue017':Ke
-0002fe00: 792e 6465 6c65 7465 2c20 2020 2320 4445  y.delete,   # DE
-0002fe10: 4c45 5445 0a0a 2020 2020 2020 2020 7527  LETE..        u'
-0002fe20: 5c75 6530 3331 273a 4b65 792e 6631 2c20  \ue031':Key.f1, 
-0002fe30: 2020 2320 4631 0a20 2020 2020 2020 2075    # F1.        u
-0002fe40: 275c 7565 3033 3227 3a4b 6579 2e66 322c  '\ue032':Key.f2,
-0002fe50: 2020 2023 2046 320a 2020 2020 2020 2020     # F2.        
-0002fe60: 7527 5c75 6530 3333 273a 4b65 792e 6633  u'\ue033':Key.f3
-0002fe70: 2c20 2020 2320 4633 0a20 2020 2020 2020  ,   # F3.       
-0002fe80: 2075 275c 7565 3033 3427 3a4b 6579 2e66   u'\ue034':Key.f
-0002fe90: 342c 2020 2023 2046 340a 2020 2020 2020  4,   # F4.      
-0002fea0: 2020 7527 5c75 6530 3335 273a 4b65 792e    u'\ue035':Key.
-0002feb0: 6635 2c20 2020 2320 4635 0a20 2020 2020  f5,   # F5.     
-0002fec0: 2020 2075 275c 7565 3033 3627 3a4b 6579     u'\ue036':Key
-0002fed0: 2e66 362c 2020 2023 2046 360a 2020 2020  .f6,   # F6.    
-0002fee0: 2020 2020 7527 5c75 6530 3337 273a 4b65      u'\ue037':Ke
-0002fef0: 792e 6637 2c20 2020 2320 4637 0a20 2020  y.f7,   # F7.   
-0002ff00: 2020 2020 2075 275c 7565 3033 3827 3a4b       u'\ue038':K
-0002ff10: 6579 2e66 382c 2020 2023 2046 380a 2020  ey.f8,   # F8.  
-0002ff20: 2020 2020 2020 7527 5c75 6530 3339 273a        u'\ue039':
-0002ff30: 4b65 792e 6639 2c20 2020 2320 4639 0a20  Key.f9,   # F9. 
-0002ff40: 2020 2020 2020 2075 275c 7565 3033 6127         u'\ue03a'
-0002ff50: 3a4b 6579 2e66 3130 2c20 2020 2320 4631  :Key.f10,   # F1
-0002ff60: 300a 2020 2020 2020 2020 7527 5c75 6530  0.        u'\ue0
-0002ff70: 3362 273a 4b65 792e 6631 312c 2020 2023  3b':Key.f11,   #
-0002ff80: 2046 3131 0a20 2020 2020 2020 2075 275c   F11.        u'\
-0002ff90: 7565 3033 6327 3a4b 6579 2e66 3132 2c20  ue03c':Key.f12, 
-0002ffa0: 2020 2320 4631 320a 0a20 2020 2020 2020    # F12..       
-0002ffb0: 2075 275c 7565 3033 6427 3a4b 6579 2e63   u'\ue03d':Key.c
-0002ffc0: 6d64 2c20 2020 2320 4d45 5441 0a20 2020  md,   # META.   
-0002ffd0: 2020 2020 2075 275c 7565 3033 6427 3a4b       u'\ue03d':K
-0002ffe0: 6579 2e63 6d64 2c20 2020 2320 434f 4d4d  ey.cmd,   # COMM
-0002fff0: 414e 440a 2020 2020 7d0a 0a20 2020 2069  AND.    }..    i
-00030000: 6620 7479 7065 2864 656c 6179 2920 6e6f  f type(delay) no
-00030010: 7420 696e 205b 7475 706c 652c 6c69 7374  t in [tuple,list
-00030020: 5d3a 2064 656c 6179 3d5b 6465 6c61 792c  ]: delay=[delay,
-00030030: 6465 6c61 795d 0a0a 2020 2020 666f 7220  delay]..    for 
-00030040: 7420 696e 2072 616e 6765 2830 2c74 696d  t in range(0,tim
-00030050: 6573 293a 0a20 2020 2020 2020 2069 6620  es):.        if 
-00030060: 286c 656e 286b 6579 7329 3d3d 3129 2061  (len(keys)==1) a
-00030070: 6e64 2028 6b65 7973 5b30 5d20 6e6f 7420  nd (keys[0] not 
-00030080: 696e 2072 656d 6170 7329 3a0a 2020 2020  in remaps):.    
-00030090: 2020 2020 2020 2020 6b65 7962 6f61 7264          keyboard
-000300a0: 2e74 7970 6528 2a6b 6579 7329 0a20 2020  .type(*keys).   
-000300b0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-000300c0: 2020 2020 2020 2066 6f72 206b 2069 6e20         for k in 
-000300d0: 6b65 7973 3a0a 2020 2020 2020 2020 2020  keys:.          
-000300e0: 2020 2020 2020 6966 206b 2069 6e20 7265        if k in re
-000300f0: 6d61 7073 3a0a 2020 2020 2020 2020 2020  maps:.          
-00030100: 2020 2020 2020 2020 2020 6b65 7962 6f61            keyboa
-00030110: 7264 2e70 7265 7373 2872 656d 6170 735b  rd.press(remaps[
-00030120: 6b5d 290a 2020 2020 2020 2020 2020 2020  k]).            
-00030130: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00030140: 2020 2020 2020 2020 2020 2020 2020 6b65                ke
-00030150: 7962 6f61 7264 2e70 7265 7373 286b 290a  yboard.press(k).
-00030160: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00030170: 6b20 696e 206c 6973 7428 7265 7665 7273  k in list(revers
-00030180: 6564 286b 6579 7329 293a 0a20 2020 2020  ed(keys)):.     
-00030190: 2020 2020 2020 2020 2020 2069 6620 6b20             if k 
-000301a0: 696e 2072 656d 6170 733a 0a20 2020 2020  in remaps:.     
-000301b0: 2020 2020 2020 2020 2020 2020 2020 206b                 k
-000301c0: 6579 626f 6172 642e 7265 6c65 6173 6528  eyboard.release(
-000301d0: 7265 6d61 7073 5b6b 5d29 0a20 2020 2020  remaps[k]).     
-000301e0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-000301f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00030200: 2020 2020 206b 6579 626f 6172 642e 7265       keyboard.re
-00030210: 6c65 6173 6528 6b29 0a20 2020 2020 2020  lease(k).       
-00030220: 2020 2020 2020 2020 2073 6c65 6570 2872           sleep(r
-00030230: 616e 646f 6d2e 756e 6966 6f72 6d28 6465  andom.uniform(de
-00030240: 6c61 795b 305d 2c64 656c 6179 5b31 5d29  lay[0],delay[1])
-00030250: 290a 0a64 6566 2066 696e 6428 696d 6167  )..def find(imag
-00030260: 652c 2061 7265 613d 4e6f 6e65 2c20 703d  e, area=None, p=
-00030270: 302e 382c 2073 686f 773d 4661 6c73 6529  0.8, show=False)
-00030280: 3a0a 2020 2020 2727 270a 2020 2020 5365  :.    '''.    Se
-00030290: 6172 6368 7320 666f 7220 616e 2069 6d61  archs for an ima
-000302a0: 6765 206f 6e20 7468 6520 7363 7265 656e  ge on the screen
-000302b0: 0a20 2020 200a 2020 2020 696d 6167 653a  .    .    image:
-000302c0: 2070 6174 6820 746f 2074 6865 2069 6d61   path to the ima
-000302d0: 6765 2066 696c 6520 2873 6565 206f 7065  ge file (see ope
-000302e0: 6e63 7620 696d 7265 6164 2066 6f72 2073  ncv imread for s
-000302f0: 7570 706f 7274 6564 2074 7970 6573 290a  upported types).
-00030300: 2020 2020 6172 6561 3a20 5b78 2c79 2c77      area: [x,y,w
-00030310: 2c68 5d0a 2020 2020 703a 2070 7265 6369  ,h].    p: preci
-00030320: 7369 6f6e 2074 6865 2068 6967 6865 722c  sion the higher,
-00030330: 2074 6865 206c 6573 7365 7220 746f 6c65   the lesser tole
-00030340: 7261 6e74 2061 6e64 2066 6577 6572 2066  rant and fewer f
-00030350: 616c 7365 2070 6f73 6974 6976 6573 2061  alse positives a
-00030360: 7265 2066 6f75 6e64 2064 6566 6175 6c74  re found default
-00030370: 2069 7320 302e 380a 2020 2020 7368 6f77   is 0.8.    show
-00030380: 3a20 7368 6f77 2061 6c6c 206d 6174 6368  : show all match
-00030390: 6573 2028 6869 6768 6c69 6768 7465 6429  es (highlighted)
-000303a0: 0a0a 2020 2020 7265 7475 726e 7320 3a0a  ..    returns :.
-000303b0: 2020 2020 5b5b 782c 792c 772c 685d 5d20      [[x,y,w,h]] 
-000303c0: 6f72 205b 5d20 6966 206e 6f74 2066 6f75  or [] if not fou
-000303d0: 6e64 0a20 2020 2027 2727 0a20 2020 2023  nd.    '''.    #
-000303e0: 206d 6f64 6966 6965 6420 6672 6f6d 2068   modified from h
-000303f0: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
-00030400: 6d2f 6472 6f76 302f 7079 7468 6f6e 2d69  m/drov0/python-i
-00030410: 6d61 6765 7365 6172 6368 2f62 6c6f 622f  magesearch/blob/
-00030420: 6d61 7374 6572 2f70 7974 686f 6e5f 696d  master/python_im
-00030430: 6167 6573 6561 7263 682f 696d 6167 6573  agesearch/images
-00030440: 6561 7263 682e 7079 0a20 2020 2069 6d70  earch.py.    imp
-00030450: 6f72 7420 6376 320a 2020 2020 696d 706f  ort cv2.    impo
-00030460: 7274 206e 756d 7079 2061 7320 6e70 0a20  rt numpy as np. 
-00030470: 2020 2069 6d70 6f72 7420 6d73 730a 2020     import mss.  
-00030480: 2020 6672 6f6d 2050 494c 2069 6d70 6f72    from PIL impor
-00030490: 7420 496d 6167 650a 0a20 2020 2023 2068  t Image..    # h
-000304a0: 7474 7073 3a2f 2f70 7974 686f 6e2d 6d73  ttps://python-ms
-000304b0: 732e 7265 6164 7468 6564 6f63 732e 696f  s.readthedocs.io
-000304c0: 2f65 7861 6d70 6c65 732e 6874 6d6c 0a20  /examples.html. 
-000304d0: 2020 2073 6374 203d 206d 7373 2e6d 7373     sct = mss.mss
-000304e0: 2829 0a20 2020 2069 6620 6172 6561 2069  ().    if area i
-000304f0: 7320 4e6f 6e65 3a20 0a20 2020 2020 2020  s None: .       
-00030500: 2061 7265 613d 7363 742e 6d6f 6e69 746f   area=sct.monito
-00030510: 7273 5b30 5d0a 2020 2020 656c 7365 3a0a  rs[0].    else:.
-00030520: 2020 2020 2020 2020 6172 6561 3d7b 276c          area={'l
-00030530: 6566 7427 3a20 6172 6561 5b30 5d2c 2027  eft': area[0], '
-00030540: 746f 7027 3a20 6172 6561 5b31 5d2c 2027  top': area[1], '
-00030550: 7769 6474 6827 3a20 6172 6561 5b32 5d2c  width': area[2],
-00030560: 2027 6865 6967 6874 273a 2061 7265 615b   'height': area[
-00030570: 335d 7d0a 2020 2020 696d 203d 2073 6374  3]}.    im = sct
-00030580: 2e67 7261 6228 6172 6561 290a 2020 2020  .grab(area).    
-00030590: 2320 7261 7720 6973 2062 6772 610a 2020  # raw is bgra.  
-000305a0: 2020 2320 496d 6167 652e 6672 6f6d 6279    # Image.fromby
-000305b0: 7465 7328 2252 4742 222c 2069 6d2e 7369  tes("RGB", im.si
-000305c0: 7a65 2c20 696d 2e62 6772 612c 2022 7261  ze, im.bgra, "ra
-000305d0: 7722 2c20 2242 4752 5822 292e 7368 6f77  w", "BGRX").show
-000305e0: 2829 0a20 2020 2069 6d67 203d 206e 702e  ().    img = np.
-000305f0: 6172 7261 7928 696d 290a 2020 2020 696d  array(im).    im
-00030600: 6720 3d20 6376 322e 6376 7443 6f6c 6f72  g = cv2.cvtColor
-00030610: 2869 6d67 2c20 6376 322e 434f 4c4f 525f  (img, cv2.COLOR_
-00030620: 4247 5241 3242 4752 290a 2020 2020 2320  BGRA2BGR).    # 
-00030630: 6376 322e 696d 7368 6f77 2822 4f70 656e  cv2.imshow("Open
-00030640: 4356 222c 2069 6d67 290a 2020 2020 2320  CV", img).    # 
-00030650: 496d 6167 652e 6672 6f6d 6172 7261 7928  Image.fromarray(
-00030660: 6376 322e 6376 7443 6f6c 6f72 2869 6d67  cv2.cvtColor(img
-00030670: 2c20 6376 322e 434f 4c4f 525f 4247 5232  , cv2.COLOR_BGR2
-00030680: 5247 4229 292e 7368 6f77 2829 0a20 2020  RGB)).show().   
-00030690: 2074 656d 706c 6174 6520 3d20 6376 322e   template = cv2.
-000306a0: 696d 7265 6164 2869 6d61 6765 2c20 6376  imread(image, cv
-000306b0: 322e 494d 5245 4144 5f43 4f4c 4f52 2920  2.IMREAD_COLOR) 
-000306c0: 0a20 2020 2023 2063 7632 2e69 6d73 686f  .    # cv2.imsho
-000306d0: 7728 224f 7065 6e43 5622 2c20 7465 6d70  w("OpenCV", temp
-000306e0: 6c61 7465 290a 2020 2020 2320 496d 6167  late).    # Imag
-000306f0: 652e 6672 6f6d 6172 7261 7928 6376 322e  e.fromarray(cv2.
-00030700: 6376 7443 6f6c 6f72 2874 656d 706c 6174  cvtColor(templat
-00030710: 652c 2063 7632 2e43 4f4c 4f52 5f42 4752  e, cv2.COLOR_BGR
-00030720: 3252 4742 2929 2e73 686f 7728 290a 2020  2RGB)).show().  
-00030730: 2020 6966 2074 656d 706c 6174 6520 6973    if template is
-00030740: 204e 6f6e 653a 0a20 2020 2020 2020 2072   None:.        r
-00030750: 6169 7365 2046 696c 654e 6f74 466f 756e  aise FileNotFoun
-00030760: 6445 7272 6f72 2827 496d 6167 6520 6669  dError('Image fi
-00030770: 6c65 206e 6f74 2066 6f75 6e64 3a20 7b7d  le not found: {}
-00030780: 272e 666f 726d 6174 2869 6d61 6765 2929  '.format(image))
-00030790: 0a20 2020 2072 6573 203d 2063 7632 2e6d  .    res = cv2.m
-000307a0: 6174 6368 5465 6d70 6c61 7465 2869 6d67  atchTemplate(img
-000307b0: 2c20 7465 6d70 6c61 7465 2c20 6376 322e  , template, cv2.
-000307c0: 544d 5f43 434f 4546 465f 4e4f 524d 4544  TM_CCOEFF_NORMED
-000307d0: 290a 2020 2020 0a20 2020 206d 6174 6368  ).    .    match
-000307e0: 6573 203d 205b 5d0a 2020 2020 2320 6874  es = [].    # ht
-000307f0: 7470 733a 2f2f 646f 6373 2e6f 7065 6e63  tps://docs.openc
-00030800: 762e 6f72 672f 332e 342f 6434 2f64 6336  v.org/3.4/d4/dc6
-00030810: 2f74 7574 6f72 6961 6c5f 7079 5f74 656d  /tutorial_py_tem
-00030820: 706c 6174 655f 6d61 7463 6869 6e67 2e68  plate_matching.h
-00030830: 746d 6c0a 2020 2020 682c 2077 2c20 6368  tml.    h, w, ch
-00030840: 616e 6e65 6c73 203d 2074 656d 706c 6174  annels = templat
-00030850: 652e 7368 6170 650a 2020 2020 6c6f 6320  e.shape.    loc 
-00030860: 3d20 6e70 2e77 6865 7265 2820 7265 7320  = np.where( res 
-00030870: 3e3d 2070 2029 0a20 2020 2066 6f72 2070  >= p ).    for p
-00030880: 7420 696e 207a 6970 282a 6c6f 635b 3a3a  t in zip(*loc[::
-00030890: 2d31 5d29 3a0a 2020 2020 2020 2020 6376  -1]):.        cv
-000308a0: 322e 7265 6374 616e 676c 6528 696d 672c  2.rectangle(img,
-000308b0: 2070 742c 2028 7074 5b30 5d20 2b20 772c   pt, (pt[0] + w,
-000308c0: 2070 745b 315d 202b 2068 292c 2028 302c   pt[1] + h), (0,
-000308d0: 302c 3235 3529 2c20 3229 0a20 2020 2020  0,255), 2).     
-000308e0: 2020 206d 6174 6368 6573 2e61 7070 656e     matches.appen
-000308f0: 6428 5b20 7074 5b30 5d2c 7074 5b31 5d2c  d([ pt[0],pt[1],
-00030900: 772c 682c 7265 735b 7074 5b31 5d2c 7074  w,h,res[pt[1],pt
-00030910: 5b30 5d5d 205d 290a 2020 2020 6966 2073  [0]] ]).    if s
-00030920: 686f 773a 0a20 2020 2020 2020 2023 2063  how:.        # c
-00030930: 7632 2e69 6d73 686f 7728 224f 7065 6e43  v2.imshow("OpenC
-00030940: 5622 2c20 696d 6729 0a20 2020 2020 2020  V", img).       
-00030950: 2023 2063 7632 2e69 6d77 7269 7465 2827   # cv2.imwrite('
-00030960: 7265 732e 706e 6727 2c69 6d67 290a 2020  res.png',img).  
-00030970: 2020 2020 2020 2320 6874 7470 733a 2f2f        # https://
-00030980: 7374 6163 6b6f 7665 7266 6c6f 772e 636f  stackoverflow.co
-00030990: 6d2f 612f 3433 3233 3430 3031 2f32 3239  m/a/43234001/229
-000309a0: 3239 3933 0a20 2020 2020 2020 2049 6d61  2993.        Ima
-000309b0: 6765 2e66 726f 6d61 7272 6179 2863 7632  ge.fromarray(cv2
-000309c0: 2e63 7674 436f 6c6f 7228 696d 672c 2063  .cvtColor(img, c
-000309d0: 7632 2e43 4f4c 4f52 5f42 4752 3252 4742  v2.COLOR_BGR2RGB
-000309e0: 2929 2e73 686f 7728 290a 2020 2020 2320  )).show().    # 
-000309f0: 6d69 6e5f 7661 6c2c 206d 6178 5f76 616c  min_val, max_val
-00030a00: 2c20 6d69 6e5f 6c6f 632c 206d 6178 5f6c  , min_loc, max_l
-00030a10: 6f63 203d 2063 7632 2e6d 696e 4d61 784c  oc = cv2.minMaxL
-00030a20: 6f63 2872 6573 290a 2020 2020 2320 6966  oc(res).    # if
-00030a30: 206d 6178 5f76 616c 203c 2070 3a0a 2020   max_val < p:.  
-00030a40: 2020 2320 2020 2020 7265 7475 726e 204e    #     return N
-00030a50: 6f6e 650a 2020 2020 2320 7265 7475 726e  one.    # return
-00030a60: 206d 6178 5f6c 6f63 0a20 2020 2072 6574   max_loc.    ret
-00030a70: 7572 6e20 6d61 7463 6865 730a 0a64 6566  urn matches..def
-00030a80: 205f 6d6f 7573 6528 696e 6974 5f70 6f73   _mouse(init_pos
-00030a90: 2c20 6669 6e5f 706f 732c 2064 6576 6961  , fin_pos, devia
-00030aa0: 7469 6f6e 3d32 352c 2064 656c 6179 3d32  tion=25, delay=2
-00030ab0: 293a 0a20 2020 2066 726f 6d20 7261 6e64  ):.    from rand
-00030ac0: 6f6d 2069 6d70 6f72 7420 7261 6e64 696e  om import randin
-00030ad0: 742c 2063 686f 6963 650a 2020 2020 6672  t, choice.    fr
-00030ae0: 6f6d 206d 6174 6820 696d 706f 7274 2063  om math import c
-00030af0: 6569 6c2c 2073 7172 740a 2020 2020 2374  eil, sqrt.    #t
-00030b00: 696d 6520 7061 7261 6d65 7465 720a 2020  ime parameter.  
-00030b10: 2020 7370 6565 643d 6465 6c61 790a 2020    speed=delay.  
-00030b20: 2020 7473 203d 205b 742f 2873 7065 6564    ts = [t/(speed
-00030b30: 202a 2031 3030 2e30 2920 666f 7220 7420   * 100.0) for t 
-00030b40: 696e 2072 616e 6765 2873 7065 6564 202a  in range(speed *
-00030b50: 2031 3031 295d 0a20 2020 2023 6265 7a69   101)].    #bezi
-00030b60: 6572 2063 656e 7472 6520 636f 6e74 726f  er centre contro
-00030b70: 6c20 706f 696e 7473 2062 6574 7765 656e  l points between
-00030b80: 2028 696e 7428 6465 7669 6174 696f 6e20   (int(deviation 
-00030b90: 2f20 3229 2920 616e 6420 2864 6576 6961  / 2)) and (devia
-00030ba0: 696f 6e29 206f 6620 7472 6176 656c 2064  ion) of travel d
-00030bb0: 6973 7461 6e63 652c 2070 6c75 7320 6f72  istance, plus or
-00030bc0: 206d 696e 7573 2061 7420 7261 6e64 6f6d   minus at random
-00030bd0: 0a20 2020 2063 6f6e 7472 6f6c 5f31 203d  .    control_1 =
-00030be0: 2028 696e 6974 5f70 6f73 5b30 5d20 2b20   (init_pos[0] + 
-00030bf0: 6368 6f69 6365 2828 2d31 2c20 3129 2920  choice((-1, 1)) 
-00030c00: 2a20 6162 7328 6365 696c 2866 696e 5f70  * abs(ceil(fin_p
-00030c10: 6f73 5b30 5d29 202d 2063 6569 6c28 696e  os[0]) - ceil(in
-00030c20: 6974 5f70 6f73 5b30 5d29 2920 2a20 302e  it_pos[0])) * 0.
-00030c30: 3031 202a 2072 616e 6469 6e74 2869 6e74  01 * randint(int
-00030c40: 2864 6576 6961 7469 6f6e 202f 2032 292c  (deviation / 2),
-00030c50: 2064 6576 6961 7469 6f6e 292c 0a20 2020   deviation),.   
-00030c60: 2020 2020 2020 2020 2020 2020 2069 6e69               ini
-00030c70: 745f 706f 735b 315d 202b 2063 686f 6963  t_pos[1] + choic
-00030c80: 6528 282d 312c 2031 2929 202a 2061 6273  e((-1, 1)) * abs
-00030c90: 2863 6569 6c28 6669 6e5f 706f 735b 315d  (ceil(fin_pos[1]
-00030ca0: 2920 2d20 6365 696c 2869 6e69 745f 706f  ) - ceil(init_po
-00030cb0: 735b 315d 2929 202a 2030 2e30 3120 2a20  s[1])) * 0.01 * 
-00030cc0: 7261 6e64 696e 7428 696e 7428 6465 7669  randint(int(devi
-00030cd0: 6174 696f 6e20 2f20 3229 2c20 6465 7669  ation / 2), devi
-00030ce0: 6174 696f 6e29 0a20 2020 2020 2020 2020  ation).         
-00030cf0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00030d00: 2063 6f6e 7472 6f6c 5f32 203d 2028 696e   control_2 = (in
-00030d10: 6974 5f70 6f73 5b30 5d20 2b20 6368 6f69  it_pos[0] + choi
-00030d20: 6365 2828 2d31 2c20 3129 2920 2a20 6162  ce((-1, 1)) * ab
-00030d30: 7328 6365 696c 2866 696e 5f70 6f73 5b30  s(ceil(fin_pos[0
-00030d40: 5d29 202d 2063 6569 6c28 696e 6974 5f70  ]) - ceil(init_p
-00030d50: 6f73 5b30 5d29 2920 2a20 302e 3031 202a  os[0])) * 0.01 *
-00030d60: 2072 616e 6469 6e74 2869 6e74 2864 6576   randint(int(dev
-00030d70: 6961 7469 6f6e 202f 2032 292c 2064 6576  iation / 2), dev
-00030d80: 6961 7469 6f6e 292c 0a20 2020 2020 2020  iation),.       
-00030d90: 2020 2020 2020 2020 2069 6e69 745f 706f           init_po
-00030da0: 735b 315d 202b 2063 686f 6963 6528 282d  s[1] + choice((-
-00030db0: 312c 2031 2929 202a 2061 6273 2863 6569  1, 1)) * abs(cei
-00030dc0: 6c28 6669 6e5f 706f 735b 315d 2920 2d20  l(fin_pos[1]) - 
-00030dd0: 6365 696c 2869 6e69 745f 706f 735b 315d  ceil(init_pos[1]
-00030de0: 2929 202a 2030 2e30 3120 2a20 7261 6e64  )) * 0.01 * rand
-00030df0: 696e 7428 696e 7428 6465 7669 6174 696f  int(int(deviatio
-00030e00: 6e20 2f20 3229 2c20 6465 7669 6174 696f  n / 2), deviatio
-00030e10: 6e29 0a20 2020 2020 2020 2020 2020 2020  n).             
-00030e20: 2020 2020 2020 2029 0a20 2020 2078 7973         ).    xys
-00030e30: 203d 205b 696e 6974 5f70 6f73 2c20 636f   = [init_pos, co
-00030e40: 6e74 726f 6c5f 312c 2063 6f6e 7472 6f6c  ntrol_1, control
-00030e50: 5f32 2c20 6669 6e5f 706f 735d 0a20 2020  _2, fin_pos].   
-00030e60: 2064 6566 206d 616b 655f 6265 7a69 6572   def make_bezier
-00030e70: 2878 7973 293a 0a20 2020 2020 2020 2023  (xys):.        #
-00030e80: 2078 7973 2073 686f 756c 6420 6265 2061   xys should be a
-00030e90: 2073 6571 7565 6e63 6520 6f66 2032 2d74   sequence of 2-t
-00030ea0: 7570 6c65 7320 2842 657a 6965 7220 636f  uples (Bezier co
-00030eb0: 6e74 726f 6c20 706f 696e 7473 290a 2020  ntrol points).  
-00030ec0: 2020 2020 2020 6465 6620 7061 7363 616c        def pascal
-00030ed0: 5f72 6f77 286e 293a 0a20 2020 2020 2020  _row(n):.       
-00030ee0: 2020 2020 2023 2054 6869 7320 7265 7475       # This retu
-00030ef0: 726e 7320 7468 6520 6e74 6820 726f 7720  rns the nth row 
-00030f00: 6f66 2050 6173 6361 6c27 7320 5472 6961  of Pascal's Tria
-00030f10: 6e67 6c65 0a20 2020 2020 2020 2020 2020  ngle.           
-00030f20: 2072 6573 756c 7420 3d20 5b31 5d0a 2020   result = [1].  
-00030f30: 2020 2020 2020 2020 2020 782c 206e 756d            x, num
-00030f40: 6572 6174 6f72 203d 2031 2c20 6e0a 2020  erator = 1, n.  
-00030f50: 2020 2020 2020 2020 2020 666f 7220 6465            for de
-00030f60: 6e6f 6d69 6e61 746f 7220 696e 2072 616e  nominator in ran
-00030f70: 6765 2831 2c20 6e2f 2f32 2b31 293a 0a20  ge(1, n//2+1):. 
-00030f80: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00030f90: 2070 7269 6e74 286e 756d 6572 6174 6f72   print(numerator
-00030fa0: 2c64 656e 6f6d 696e 6174 6f72 2c78 290a  ,denominator,x).
-00030fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030fc0: 7820 2a3d 206e 756d 6572 6174 6f72 0a20  x *= numerator. 
-00030fd0: 2020 2020 2020 2020 2020 2020 2020 2078                 x
-00030fe0: 202f 3d20 6465 6e6f 6d69 6e61 746f 720a   /= denominator.
-00030ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031000: 7265 7375 6c74 2e61 7070 656e 6428 7829  result.append(x)
-00031010: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00031020: 206e 756d 6572 6174 6f72 202d 3d20 310a   numerator -= 1.
-00031030: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-00031040: 2631 203d 3d20 303a 0a20 2020 2020 2020  &1 == 0:.       
-00031050: 2020 2020 2020 2020 2023 206e 2069 7320           # n is 
-00031060: 6576 656e 0a20 2020 2020 2020 2020 2020  even.           
-00031070: 2020 2020 2072 6573 756c 742e 6578 7465       result.exte
-00031080: 6e64 2872 6576 6572 7365 6428 7265 7375  nd(reversed(resu
-00031090: 6c74 5b3a 2d31 5d29 290a 2020 2020 2020  lt[:-1])).      
-000310a0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-000310b0: 2020 2020 2020 2020 2020 2020 7265 7375              resu
-000310c0: 6c74 2e65 7874 656e 6428 7265 7665 7273  lt.extend(revers
-000310d0: 6564 2872 6573 756c 7429 2920 0a20 2020  ed(result)) .   
-000310e0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-000310f0: 7265 7375 6c74 0a20 2020 2020 2020 206e  result.        n
-00031100: 203d 206c 656e 2878 7973 290a 2020 2020   = len(xys).    
-00031110: 2020 2020 636f 6d62 696e 6174 696f 6e73      combinations
-00031120: 203d 2070 6173 6361 6c5f 726f 7728 6e20   = pascal_row(n 
-00031130: 2d20 3129 0a20 2020 2020 2020 2064 6566  - 1).        def
-00031140: 2062 657a 6965 7228 7473 293a 0a20 2020   bezier(ts):.   
-00031150: 2020 2020 2020 2020 2023 2054 6869 7320           # This 
-00031160: 7573 6573 2074 6865 2067 656e 6572 616c  uses the general
-00031170: 697a 6564 2066 6f72 6d75 6c61 2066 6f72  ized formula for
-00031180: 2062 657a 6965 7220 6375 7276 6573 0a20   bezier curves. 
-00031190: 2020 2020 2020 2020 2020 2023 2068 7474             # htt
-000311a0: 703a 2f2f 656e 2e77 696b 6970 6564 6961  p://en.wikipedia
-000311b0: 2e6f 7267 2f77 696b 692f 4225 4333 2541  .org/wiki/B%C3%A
-000311c0: 397a 6965 725f 6375 7276 6523 4765 6e65  9zier_curve#Gene
-000311d0: 7261 6c69 7a61 7469 6f6e 0a20 2020 2020  ralization.     
-000311e0: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
-000311f0: 5b5d 0a20 2020 2020 2020 2020 2020 2066  [].            f
-00031200: 6f72 2074 2069 6e20 7473 3a0a 2020 2020  or t in ts:.    
-00031210: 2020 2020 2020 2020 2020 2020 7470 6f77              tpow
-00031220: 6572 7320 3d20 2874 2a2a 6920 666f 7220  ers = (t**i for 
-00031230: 6920 696e 2072 616e 6765 286e 2929 0a20  i in range(n)). 
-00031240: 2020 2020 2020 2020 2020 2020 2020 2075                 u
-00031250: 706f 7765 7273 203d 2072 6576 6572 7365  powers = reverse
-00031260: 6428 5b28 312d 7429 2a2a 6920 666f 7220  d([(1-t)**i for 
-00031270: 6920 696e 2072 616e 6765 286e 295d 290a  i in range(n)]).
-00031280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031290: 636f 6566 7320 3d20 5b63 2a61 2a62 2066  coefs = [c*a*b f
-000312a0: 6f72 2063 2c20 612c 2062 2069 6e20 7a69  or c, a, b in zi
-000312b0: 7028 636f 6d62 696e 6174 696f 6e73 2c20  p(combinations, 
-000312c0: 7470 6f77 6572 732c 2075 706f 7765 7273  tpowers, upowers
-000312d0: 295d 0a20 2020 2020 2020 2020 2020 2020  )].             
-000312e0: 2020 2072 6573 756c 742e 6170 7065 6e64     result.append
-000312f0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00031300: 2020 2020 2020 6c69 7374 2873 756d 285b        list(sum([
-00031310: 636f 6566 2a70 2066 6f72 2063 6f65 662c  coef*p for coef,
-00031320: 2070 2069 6e20 7a69 7028 636f 6566 732c   p in zip(coefs,
-00031330: 2070 7329 5d29 2066 6f72 2070 7320 696e   ps)]) for ps in
-00031340: 207a 6970 282a 7879 7329 2929 0a20 2020   zip(*xys))).   
-00031350: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00031360: 7265 7375 6c74 0a20 2020 2020 2020 2072  result.        r
-00031370: 6574 7572 6e20 6265 7a69 6572 0a20 2020  eturn bezier.   
-00031380: 2062 657a 6965 7220 3d20 6d61 6b65 5f62   bezier = make_b
-00031390: 657a 6965 7228 7879 7329 0a20 2020 206d  ezier(xys).    m
-000313a0: 6f75 7365 5f70 6f69 6e74 7320 3d20 6265  ouse_points = be
-000313b0: 7a69 6572 2874 7329 0a20 2020 2023 726f  zier(ts).    #ro
-000313c0: 756e 6420 666c 6f61 7473 2074 6f20 696e  und floats to in
-000313d0: 7473 0a20 2020 206d 6f75 7365 5f70 6f69  ts.    mouse_poi
-000313e0: 6e74 7320 3d20 5b5b 726f 756e 6428 7629  nts = [[round(v)
-000313f0: 2066 6f72 2076 2069 6e20 785d 2069 6620   for v in x] if 
-00031400: 7479 7065 2878 2920 6973 206e 6f74 2073  type(x) is not s
-00031410: 7472 2065 6c73 6520 7820 666f 7220 7820  tr else x for x 
-00031420: 696e 206d 6f75 7365 5f70 6f69 6e74 735d  in mouse_points]
-00031430: 0a20 2020 2072 6574 7572 6e20 6d6f 7573  .    return mous
-00031440: 655f 706f 696e 7473 0a0a 6465 6620 5f6d  e_points..def _m
-00031450: 6f76 6528 622c 2061 3d4e 6f6e 652c 2064  ove(b, a=None, d
-00031460: 6576 6961 7469 6f6e 3d32 352c 2064 656c  eviation=25, del
-00031470: 6179 3d32 2c20 7261 7465 3d31 3030 302c  ay=2, rate=1000,
-00031480: 2064 7261 773d 4661 6c73 6529 3a0a 2020   draw=False):.  
-00031490: 2020 2727 270a 2020 2020 4745 4e45 5241    '''.    GENERA
-000314a0: 5445 2042 455a 4945 5220 4355 5256 4520  TE BEZIER CURVE 
-000314b0: 504f 494e 5453 0a20 2020 2054 616b 6573  POINTS.    Takes
-000314c0: 2061 2028 696e 6974 5f70 6f73 2c20 6465   a (init_pos, de
-000314d0: 6661 756c 7420 6375 7272 656e 7420 706f  fault current po
-000314e0: 7369 7469 6f6e 2920 2d2d 3e20 6220 2866  sition) --> b (f
-000314f0: 696e 5f70 6f73 2920 6173 2061 2032 2d74  in_pos) as a 2-t
-00031500: 7570 6c65 2072 6570 7265 7365 6e74 696e  uple representin
-00031510: 6720 7879 2063 6f6f 7264 696e 6174 6573  g xy coordinates
-00031520: 0a20 2020 2064 6576 6961 7469 6f6e 2028  .    deviation (
-00031530: 696e 7429 0a20 2020 2020 2020 2064 6576  int).        dev
-00031540: 6961 7469 6f6e 2063 6f6e 7472 6f6c 7320  iation controls 
-00031550: 686f 7720 7374 7261 6967 6874 2074 6865  how straight the
-00031560: 206c 696e 6573 2064 7261 776e 206d 7920   lines drawn my 
-00031570: 7468 6520 6375 7273 6f72 0a20 2020 2020  the cursor.     
-00031580: 2020 2061 7265 2e20 5a65 726f 2064 6576     are. Zero dev
-00031590: 6961 7469 6f6e 2067 6976 6573 2073 7472  iation gives str
-000315a0: 6169 6768 7420 6c69 6e65 730a 2020 2020  aight lines.    
-000315b0: 2020 2020 4163 6375 7261 6379 2069 7320      Accuracy is 
-000315c0: 6120 7065 7263 656e 7461 6765 206f 6620  a percentage of 
-000315d0: 7468 6520 6469 7370 6c61 6365 6d65 6e74  the displacement
-000315e0: 206f 6620 7468 6520 6d6f 7573 6520 6672   of the mouse fr
-000315f0: 6f6d 2070 6f69 6e74 2041 2074 6f0a 2020  om point A to.  
-00031600: 2020 2020 2020 422c 2077 6869 6368 2069        B, which i
-00031610: 7320 6769 7665 6e20 6173 206d 6178 696d  s given as maxim
-00031620: 756d 2063 6f6e 7472 6f6c 2070 6f69 6e74  um control point
-00031630: 2064 6576 6961 7469 6f6e 2e0a 2020 2020   deviation..    
-00031640: 2020 2020 4e61 7475 7261 6c6c 792c 2064      Naturally, d
-00031650: 6576 6961 7469 6f6e 206f 6620 3130 2028  eviation of 10 (
-00031660: 3130 2529 2067 6976 6573 206d 6178 696d  10%) gives maxim
-00031670: 756d 2063 6f6e 7472 6f6c 2070 6f69 6e74  um control point
-00031680: 2064 6576 6961 7469 6f6e 0a20 2020 2020   deviation.     
-00031690: 2020 206f 6620 3130 2520 6f66 206d 6167     of 10% of mag
-000316a0: 6e69 7475 6465 206f 6620 6469 7370 6c61  nitude of displa
-000316b0: 6365 6d65 6e74 206f 6620 6d6f 7573 6520  cement of mouse 
-000316c0: 6672 6f6d 2070 6f69 6e74 2041 2074 6f20  from point A to 
-000316d0: 422c 200a 2020 2020 2020 2020 616e 6420  B, .        and 
-000316e0: 6120 6d69 6e69 6d75 6d20 6f66 2035 2520  a minimum of 5% 
-000316f0: 2869 6e74 2864 6576 6961 7469 6f6e 202f  (int(deviation /
-00031700: 2032 2929 2020 2020 0a20 2020 2064 656c   2))    .    del
-00031710: 6179 3a20 616e 2069 6e74 206d 756c 7469  ay: an int multi
-00031720: 706c 6965 7220 666f 7220 7370 6565 642e  plier for speed.
-00031730: 2054 6865 206c 6f77 6572 2c20 7468 6520   The lower, the 
-00031740: 6661 7374 6572 2e20 3120 6973 2066 6173  faster. 1 is fas
-00031750: 7465 7374 2e0a 2020 2020 7261 7465 3a20  test..    rate: 
-00031760: 616e 6f74 6865 7220 7061 7261 6d20 7265  another param re
-00031770: 6c61 7465 6420 746f 2073 7065 6564 2c20  lated to speed, 
-00031780: 746f 7461 6c20 7472 6176 656c 2074 696d  total travel tim
-00031790: 6520 696e 2073 6563 6f6e 6473 203d 2064  e in seconds = d
-000317a0: 6973 7461 6e63 652f 7261 7465 2e20 5468  istance/rate. Th
-000317b0: 6520 6869 6768 6572 2c20 7468 6520 6661  e higher, the fa
-000317c0: 7374 6572 2e0a 2020 2020 6472 6177 3a20  ster..    draw: 
-000317d0: 626f 6f6c 6561 6e20 6465 6369 6469 6e67  boolean deciding
-000317e0: 2077 6865 7468 6572 206f 7220 6e6f 7420   whether or not 
-000317f0: 746f 2073 686f 7720 7468 6520 6375 7276  to show the curv
-00031800: 6520 7468 6520 6d6f 7573 6520 6d61 6b65  e the mouse make
-00031810: 730a 2020 2020 2727 270a 2020 2020 2320  s.    '''.    # 
-00031820: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
-00031830: 6f6d 2f76 696e 6365 6e74 6261 7669 747a  om/vincentbavitz
-00031840: 2f62 657a 6d6f 7573 650a 2020 2020 2320  /bezmouse.    # 
-00031850: 7365 6520 616c 736f 2068 7474 7073 3a2f  see also https:/
-00031860: 2f70 7961 7574 6f67 7569 2e72 6561 6474  /pyautogui.readt
-00031870: 6865 646f 6373 2e69 6f2f 656e 2f6c 6174  hedocs.io/en/lat
-00031880: 6573 742f 6d6f 7573 652e 6874 6d6c 2374  est/mouse.html#t
-00031890: 7765 656e 2d65 6173 696e 672d 6675 6e63  ween-easing-func
-000318a0: 7469 6f6e 730a 2020 2020 6672 6f6d 2074  tions.    from t
-000318b0: 696d 6520 696d 706f 7274 2073 6c65 6570  ime import sleep
-000318c0: 0a20 2020 2066 726f 6d20 5049 4c20 696d  .    from PIL im
-000318d0: 706f 7274 2049 6d61 6765 0a20 2020 2066  port Image.    f
-000318e0: 726f 6d20 7261 6e64 6f6d 2069 6d70 6f72  rom random impor
-000318f0: 7420 7261 6e64 696e 742c 2063 686f 6963  t randint, choic
-00031900: 650a 2020 2020 6672 6f6d 206d 6174 6820  e.    from math 
-00031910: 696d 706f 7274 2063 6569 6c2c 2073 7172  import ceil, sqr
-00031920: 740a 2020 2020 6672 6f6d 2070 796e 7075  t.    from pynpu
-00031930: 742e 6d6f 7573 6520 696d 706f 7274 2042  t.mouse import B
-00031940: 7574 746f 6e2c 2043 6f6e 7472 6f6c 6c65  utton, Controlle
-00031950: 720a 2020 2020 6d6f 7573 6520 3d20 436f  r.    mouse = Co
-00031960: 6e74 726f 6c6c 6572 2829 0a20 2020 2069  ntroller().    i
-00031970: 6620 6120 6973 204e 6f6e 653a 2061 203d  f a is None: a =
-00031980: 206d 6f75 7365 2e70 6f73 6974 696f 6e0a   mouse.position.
-00031990: 2020 2020 696e 6974 5f70 6f73 3d61 3b20      init_pos=a; 
-000319a0: 6669 6e5f 706f 733d 620a 2020 2020 6d6f  fin_pos=b.    mo
-000319b0: 7573 655f 706f 696e 7473 3d5f 6d6f 7573  use_points=_mous
-000319c0: 6528 696e 6974 5f70 6f73 2c20 6669 6e5f  e(init_pos, fin_
-000319d0: 706f 732c 2064 6576 6961 7469 6f6e 2c20  pos, deviation, 
-000319e0: 6465 6c61 7929 0a20 2020 2027 2727 0a20  delay).    '''. 
-000319f0: 2020 204d 6f76 6573 206d 6f75 7365 2069     Moves mouse i
-00031a00: 6e20 6163 636f 7264 616e 6365 2077 6974  n accordance wit
-00031a10: 6820 6120 6c69 7374 206f 6620 706f 696e  h a list of poin
-00031a20: 7473 2028 636f 6e74 696e 756f 7573 2063  ts (continuous c
-00031a30: 7572 7665 290a 2020 2020 6d6f 7573 655f  urve).    mouse_
-00031a40: 706f 696e 7473 0a20 2020 2020 2020 206c  points.        l
-00031a50: 6973 7420 6f66 2032 2d74 7570 6c65 7320  ist of 2-tuples 
-00031a60: 6f72 206c 6973 7473 206f 6620 696e 7473  or lists of ints
-00031a70: 206f 7220 666c 6f61 7473 2072 6570 7265   or floats repre
-00031a80: 7365 6e74 696e 6720 7879 2063 6f6f 7264  senting xy coord
-00031a90: 730a 2020 2020 6472 6177 0a20 2020 2020  s.    draw.     
-00031aa0: 2020 2061 2062 6f6f 6c65 616e 2064 6563     a boolean dec
-00031ab0: 6964 696e 6720 7768 6574 6865 7220 6f72  iding whether or
-00031ac0: 206e 6f74 2074 6f20 7368 6f77 2074 6865   not to show the
-00031ad0: 2063 7572 7665 2074 6865 206d 6f75 7365   curve the mouse
-00031ae0: 206d 616b 6573 0a20 2020 2027 2727 0a20   makes.    '''. 
-00031af0: 2020 2069 6620 6472 6177 203d 3d20 5472     if draw == Tr
-00031b00: 7565 3a0a 2020 2020 2020 2020 5245 4c5f  ue:.        REL_
-00031b10: 4f52 4947 494e 3d5b 302c 305d 0a20 2020  ORIGIN=[0,0].   
-00031b20: 2020 2020 2064 7261 7770 6f69 6e74 7320       drawpoints 
-00031b30: 3d20 5b28 765b 305d 202d 2052 454c 5f4f  = [(v[0] - REL_O
-00031b40: 5249 4749 4e5b 305d 2c20 765b 315d 202d  RIGIN[0], v[1] -
-00031b50: 2052 454c 5f4f 5249 4749 4e5b 315d 2920   REL_ORIGIN[1]) 
-00031b60: 666f 7220 7620 696e 206d 6f75 7365 5f70  for v in mouse_p
-00031b70: 6f69 6e74 7320 6966 2074 7970 6528 7629  oints if type(v)
-00031b80: 2069 7320 6e6f 7420 7374 725d 0a20 2020   is not str].   
-00031b90: 2020 2020 2066 726f 6d20 5049 4c20 696d       from PIL im
-00031ba0: 706f 7274 2049 6d61 6765 4772 6162 0a20  port ImageGrab. 
-00031bb0: 2020 2020 2020 2069 6d67 203d 2049 6d61         img = Ima
-00031bc0: 6765 4772 6162 2e67 7261 6228 290a 2020  geGrab.grab().  
-00031bd0: 2020 2020 2020 7769 6474 685f 7078 2c20        width_px, 
-00031be0: 6865 6967 6874 5f70 7820 3d20 696d 672e  height_px = img.
-00031bf0: 7369 7a65 2020 2320 7072 696d 6172 7920  size  # primary 
-00031c00: 7363 7265 656e 2073 697a 650a 2020 2020  screen size.    
-00031c10: 2020 2020 6465 6620 6472 6177 5f70 6f69      def draw_poi
-00031c20: 6e74 7328 706f 696e 7473 2c20 7769 6474  nts(points, widt
-00031c30: 683d 7769 6474 685f 7078 2c20 6865 6967  h=width_px, heig
-00031c40: 6874 3d68 6569 6768 745f 7078 293a 0a20  ht=height_px):. 
-00031c50: 2020 2020 2020 2020 2020 2027 2727 0a20             '''. 
-00031c60: 2020 2020 2020 2020 2020 2044 7261 7773             Draws
-00031c70: 2079 656c 6c6f 7720 6372 6f73 7365 7320   yellow crosses 
-00031c80: 746f 2061 2069 6d61 6765 2066 6f72 2061  to a image for a
-00031c90: 6c6c 2063 6f6f 7264 696e 6174 6573 2069  ll coordinates i
-00031ca0: 6e20 2270 6f69 6e74 7322 0a20 2020 2020  n "points".     
-00031cb0: 2020 2020 2020 2073 686f 7720 7468 6520         show the 
-00031cc0: 696d 6167 650a 2020 2020 2020 2020 2020  image.          
-00031cd0: 2020 2727 270a 2020 2020 2020 2020 2020    '''.          
-00031ce0: 2020 696d 6720 3d20 496d 6167 652e 6e65    img = Image.ne
-00031cf0: 7728 2252 4742 222c 2028 7769 6474 682c  w("RGB", (width,
-00031d00: 2068 6569 6768 7429 290a 2020 2020 2020   height)).      
-00031d10: 2020 2020 2020 7069 7820 3d20 696d 672e        pix = img.
-00031d20: 6c6f 6164 2829 0a20 2020 2020 2020 2020  load().         
-00031d30: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
-00031d40: 2020 2020 2020 2020 666f 7220 636f 6f72          for coor
-00031d50: 6473 2069 6e20 706f 696e 7473 3a0a 2020  ds in points:.  
-00031d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031d70: 2020 7069 785b 636f 6f72 6473 5b30 5d2c    pix[coords[0],
-00031d80: 2063 6f6f 7264 735b 315d 5d20 3d20 2832   coords[1]] = (2
-00031d90: 3535 2c20 3235 352c 2030 290a 2020 2020  55, 255, 0).    
-00031da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031db0: 7069 785b 636f 6f72 6473 5b30 5d20 2b20  pix[coords[0] + 
-00031dc0: 312c 2063 6f6f 7264 735b 315d 202b 2031  1, coords[1] + 1
-00031dd0: 5d20 3d20 2832 3535 2c20 3235 352c 2030  ] = (255, 255, 0
-00031de0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00031df0: 2020 2020 2020 7069 785b 636f 6f72 6473        pix[coords
-00031e00: 5b30 5d20 2b20 312c 2063 6f6f 7264 735b  [0] + 1, coords[
-00031e10: 315d 202d 2031 5d20 3d20 2832 3535 2c20  1] - 1] = (255, 
-00031e20: 3235 352c 2030 290a 2020 2020 2020 2020  255, 0).        
-00031e30: 2020 2020 2020 2020 2020 2020 7069 785b              pix[
-00031e40: 636f 6f72 6473 5b30 5d20 2d20 312c 2063  coords[0] - 1, c
-00031e50: 6f6f 7264 735b 315d 202b 2031 5d20 3d20  oords[1] + 1] = 
-00031e60: 2832 3535 2c20 3235 352c 2030 290a 2020  (255, 255, 0).  
-00031e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031e80: 2020 7069 785b 636f 6f72 6473 5b30 5d20    pix[coords[0] 
-00031e90: 2d20 312c 2063 6f6f 7264 735b 315d 202d  - 1, coords[1] -
-00031ea0: 2031 5d20 3d20 2832 3535 2c20 3235 352c   1] = (255, 255,
-00031eb0: 2030 290a 2020 2020 2020 2020 2020 2020   0).            
-00031ec0: 2020 2020 696d 672e 7368 6f77 2829 0a20      img.show(). 
-00031ed0: 2020 2020 2020 2020 2020 2065 7863 6570             excep
-00031ee0: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
-00031ef0: 2020 2070 6173 730a 2020 2020 2020 2020     pass.        
-00031f00: 6472 6177 5f70 6f69 6e74 7328 6472 6177  draw_points(draw
-00031f10: 706f 696e 7473 2920 2020 200a 2020 2020  points)    .    
-00031f20: 6469 7374 616e 6365 3d73 7172 7428 2862  distance=sqrt((b
-00031f30: 5b30 5d2d 615b 305d 292a 2a32 2b28 625b  [0]-a[0])**2+(b[
-00031f40: 315d 2d61 5b31 5d29 2a2a 3229 0a20 2020  1]-a[1])**2).   
-00031f50: 2064 7572 6174 696f 6e3d 6469 7374 616e   duration=distan
-00031f60: 6365 2f72 6174 650a 2020 2020 666f 7220  ce/rate.    for 
-00031f70: 636f 6f72 6420 696e 206d 6f75 7365 5f70  coord in mouse_p
-00031f80: 6f69 6e74 733a 0a20 2020 2020 2020 2073  oints:.        s
-00031f90: 6c65 6570 2864 7572 6174 696f 6e2f 6c65  leep(duration/le
-00031fa0: 6e28 6d6f 7573 655f 706f 696e 7473 2929  n(mouse_points))
-00031fb0: 0a20 2020 2020 2020 206d 6f75 7365 2e70  .        mouse.p
-00031fc0: 6f73 6974 696f 6e3d 636f 6f72 640a 0a64  osition=coord..d
-00031fd0: 6566 206d 6f76 6563 6c69 636b 286c 6f63  ef moveclick(loc
-00031fe0: 6174 696f 6e2c 2072 6164 6975 733d 352c  ation, radius=5,
-00031ff0: 206e 3d32 2c20 7761 6974 3d30 2e32 352c   n=2, wait=0.25,
-00032000: 2064 6576 6961 7469 6f6e 3d32 352c 2064   deviation=25, d
-00032010: 656c 6179 3d32 2c20 7261 7465 3d31 3030  elay=2, rate=100
-00032020: 302c 2064 7261 773d 4661 6c73 652c 202a  0, draw=False, *
-00032030: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
-00032040: 0a20 2020 2027 2727 0a20 2020 206c 6f63  .    '''.    loc
-00032050: 6174 696f 6e3a 2028 782c 7929 206f 7220  ation: (x,y) or 
-00032060: 5b78 2c79 5d2c 205b 782c 792c 772c 682c  [x,y], [x,y,w,h,
-00032070: 705d 206f 7220 5b78 2c79 2c77 2c68 5d0a  p] or [x,y,w,h].
-00032080: 2020 2020 7261 6469 7573 3a20 776f 726b      radius: work
-00032090: 7320 6f6e 6c79 2069 6620 6c6f 6361 7469  s only if locati
-000320a0: 6f6e 2069 7320 616e 2061 7265 612e 2069  on is an area. i
-000320b0: 6620 616e 2061 7265 6120 6973 2031 3030  f an area is 100
-000320c0: 2a31 3030 2077 6974 6820 616e 2072 6164  *100 with an rad
-000320d0: 6975 7320 6f66 2035 2069 7420 6d61 7920  ius of 5 it may 
-000320e0: 6265 2061 7420 3436 2c35 3020 7468 6520  be at 46,50 the 
-000320f0: 6669 7273 7420 7469 6d65 2061 6e64 2074  first time and t
-00032100: 6865 6e20 3535 2c35 3320 6574 630a 2020  hen 55,53 etc.  
-00032110: 2020 7761 6974 3a20 7365 636f 6e64 7320    wait: seconds 
-00032120: 6265 666f 7265 2063 6c69 636b 2061 6674  before click aft
-00032130: 6572 206d 6f76 6520 746f 2074 6865 206c  er move to the l
-00032140: 6f63 6174 696f 6e0a 2020 2020 6465 7669  ocation.    devi
-00032150: 6174 696f 6e20 2869 6e74 290a 2020 2020  ation (int).    
-00032160: 2020 2020 6465 7669 6174 696f 6e20 636f      deviation co
-00032170: 6e74 726f 6c73 2068 6f77 2073 7472 6169  ntrols how strai
-00032180: 6768 7420 7468 6520 6c69 6e65 7320 6472  ght the lines dr
-00032190: 6177 6e20 6d79 2074 6865 2063 7572 736f  awn my the curso
-000321a0: 720a 2020 2020 2020 2020 6172 652e 205a  r.        are. Z
-000321b0: 6572 6f20 6465 7669 6174 696f 6e20 6769  ero deviation gi
-000321c0: 7665 7320 7374 7261 6967 6874 206c 696e  ves straight lin
-000321d0: 6573 0a20 2020 2020 2020 2041 6363 7572  es.        Accur
-000321e0: 6163 7920 6973 2061 2070 6572 6365 6e74  acy is a percent
-000321f0: 6167 6520 6f66 2074 6865 2064 6973 706c  age of the displ
-00032200: 6163 656d 656e 7420 6f66 2074 6865 206d  acement of the m
-00032210: 6f75 7365 2066 726f 6d20 706f 696e 7420  ouse from point 
-00032220: 4120 746f 0a20 2020 2020 2020 2042 2c20  A to.        B, 
-00032230: 7768 6963 6820 6973 2067 6976 656e 2061  which is given a
-00032240: 7320 6d61 7869 6d75 6d20 636f 6e74 726f  s maximum contro
-00032250: 6c20 706f 696e 7420 6465 7669 6174 696f  l point deviatio
-00032260: 6e2e 0a20 2020 2020 2020 204e 6174 7572  n..        Natur
-00032270: 616c 6c79 2c20 6465 7669 6174 696f 6e20  ally, deviation 
-00032280: 6f66 2031 3020 2831 3025 2920 6769 7665  of 10 (10%) give
-00032290: 7320 6d61 7869 6d75 6d20 636f 6e74 726f  s maximum contro
-000322a0: 6c20 706f 696e 7420 6465 7669 6174 696f  l point deviatio
-000322b0: 6e0a 2020 2020 2020 2020 6f66 2031 3025  n.        of 10%
-000322c0: 206f 6620 6d61 676e 6974 7564 6520 6f66   of magnitude of
-000322d0: 2064 6973 706c 6163 656d 656e 7420 6f66   displacement of
-000322e0: 206d 6f75 7365 2066 726f 6d20 706f 696e   mouse from poin
-000322f0: 7420 4120 746f 2042 2c20 0a20 2020 2020  t A to B, .     
-00032300: 2020 2061 6e64 2061 206d 696e 696d 756d     and a minimum
-00032310: 206f 6620 3525 2028 696e 7428 6465 7669   of 5% (int(devi
-00032320: 6174 696f 6e20 2f20 3229 2920 2020 200a  ation / 2))    .
-00032330: 2020 2020 6465 6c61 793a 2061 6e20 696e      delay: an in
-00032340: 7420 6d75 6c74 6970 6c69 6572 2066 6f72  t multiplier for
-00032350: 2073 7065 6564 2e20 5468 6520 6c6f 7765   speed. The lowe
-00032360: 722c 2074 6865 2066 6173 7465 722e 2031  r, the faster. 1
-00032370: 2069 7320 6661 7374 6573 742e 0a20 2020   is fastest..   
-00032380: 2072 6174 653a 2061 6e6f 7468 6572 2070   rate: another p
-00032390: 6172 616d 2072 656c 6174 6564 2074 6f20  aram related to 
-000323a0: 7370 6565 642c 2074 6f74 616c 2074 7261  speed, total tra
-000323b0: 7665 6c20 7469 6d65 2069 6e20 7365 636f  vel time in seco
-000323c0: 6e64 7320 3d20 6469 7374 616e 6365 2f72  nds = distance/r
-000323d0: 6174 652e 2054 6865 2068 6967 6865 722c  ate. The higher,
-000323e0: 2074 6865 2066 6173 7465 722e 0a20 2020   the faster..   
-000323f0: 2064 7261 773a 2062 6f6f 6c65 616e 2064   draw: boolean d
-00032400: 6563 6964 696e 6720 7768 6574 6865 7220  eciding whether 
-00032410: 6f72 206e 6f74 2074 6f20 7368 6f77 2074  or not to show t
-00032420: 6865 2063 7572 7665 2074 6865 206d 6f75  he curve the mou
-00032430: 7365 206d 616b 6573 0a20 2020 2027 2727  se makes.    '''
-00032440: 0a20 2020 2066 726f 6d20 7261 6e64 6f6d  .    from random
-00032450: 2069 6d70 6f72 7420 7261 6e64 696e 740a   import randint.
-00032460: 2020 2020 6966 206c 656e 286c 6f63 6174      if len(locat
-00032470: 696f 6e29 3d3d 323a 0a20 2020 2020 2020  ion)==2:.       
-00032480: 2078 782c 7979 3d6c 6f63 6174 696f 6e5b   xx,yy=location[
-00032490: 305d 2c6c 6f63 6174 696f 6e5b 315d 0a20  0],location[1]. 
-000324a0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-000324b0: 2078 2c79 2c77 2c68 3d6c 6f63 6174 696f   x,y,w,h=locatio
-000324c0: 6e5b 305d 2c6c 6f63 6174 696f 6e5b 315d  n[0],location[1]
-000324d0: 2c6c 6f63 6174 696f 6e5b 325d 2c6c 6f63  ,location[2],loc
-000324e0: 6174 696f 6e5b 335d 0a20 2020 2020 2020  ation[3].       
-000324f0: 2078 7820 3d20 7820 2b20 7261 6e64 696e   xx = x + randin
-00032500: 7428 696e 7428 772f 322d 7261 6469 7573  t(int(w/2-radius
-00032510: 292c 2069 6e74 2877 2f32 2b72 6164 6975  ), int(w/2+radiu
-00032520: 7329 290a 2020 2020 2020 2020 7979 203d  s)).        yy =
-00032530: 2079 202b 2072 616e 6469 6e74 2869 6e74   y + randint(int
-00032540: 2868 2f32 2d72 6164 6975 7329 2c20 696e  (h/2-radius), in
-00032550: 7428 682f 322b 7261 6469 7573 2929 0a20  t(h/2+radius)). 
-00032560: 2020 205f 6d6f 7665 2828 7878 2c20 7979     _move((xx, yy
-00032570: 292c 2061 3d4e 6f6e 652c 2064 6576 6961  ), a=None, devia
-00032580: 7469 6f6e 3d64 6576 6961 7469 6f6e 2c20  tion=deviation, 
-00032590: 6465 6c61 793d 6465 6c61 792c 2072 6174  delay=delay, rat
-000325a0: 653d 7261 7465 2c20 6472 6177 3d64 7261  e=rate, draw=dra
-000325b0: 772c 202a 6172 6773 2c20 2a2a 6b77 6172  w, *args, **kwar
-000325c0: 6773 290a 2020 2020 696d 706f 7274 2074  gs).    import t
-000325d0: 696d 650a 2020 2020 7469 6d65 2e73 6c65  ime.    time.sle
-000325e0: 6570 2877 6169 7429 0a20 2020 2066 726f  ep(wait).    fro
-000325f0: 6d20 7079 6e70 7574 2e6d 6f75 7365 2069  m pynput.mouse i
-00032600: 6d70 6f72 7420 4275 7474 6f6e 2c20 436f  mport Button, Co
-00032610: 6e74 726f 6c6c 6572 0a20 2020 206d 6f75  ntroller.    mou
-00032620: 7365 203d 2043 6f6e 7472 6f6c 6c65 7228  se = Controller(
-00032630: 290a 2020 2020 6d6f 7573 652e 636c 6963  ).    mouse.clic
-00032640: 6b28 4275 7474 6f6e 2e6c 6566 742c 206e  k(Button.left, n
-00032650: 290a 0a64 6566 2063 6c69 636b 286e 3d32  )..def click(n=2
-00032660: 293a 0a20 2020 2066 726f 6d20 7079 6e70  ):.    from pynp
-00032670: 7574 2e6d 6f75 7365 2069 6d70 6f72 7420  ut.mouse import 
-00032680: 4275 7474 6f6e 2c20 436f 6e74 726f 6c6c  Button, Controll
-00032690: 6572 0a20 2020 206d 6f75 7365 203d 2043  er.    mouse = C
-000326a0: 6f6e 7472 6f6c 6c65 7228 290a 2020 2020  ontroller().    
-000326b0: 6d6f 7573 652e 636c 6963 6b28 4275 7474  mouse.click(Butt
-000326c0: 6f6e 2e6c 6566 742c 206e 290a 0a64 6566  on.left, n)..def
-000326d0: 2072 636c 6963 6b28 6e3d 3129 3a0a 2020   rclick(n=1):.  
-000326e0: 2020 6672 6f6d 2070 796e 7075 742e 6d6f    from pynput.mo
-000326f0: 7573 6520 696d 706f 7274 2042 7574 746f  use import Butto
-00032700: 6e2c 2043 6f6e 7472 6f6c 6c65 720a 2020  n, Controller.  
-00032710: 2020 6d6f 7573 6520 3d20 436f 6e74 726f    mouse = Contro
-00032720: 6c6c 6572 2829 0a20 2020 206d 6f75 7365  ller().    mouse
-00032730: 2e63 6c69 636b 2842 7574 746f 6e2e 7269  .click(Button.ri
-00032740: 6768 742c 206e 290a 0a64 6566 2073 6372  ght, n)..def scr
-00032750: 6f6c 6c28 6478 2c64 7929 3a0a 2020 2020  oll(dx,dy):.    
-00032760: 6672 6f6d 2070 796e 7075 742e 6d6f 7573  from pynput.mous
-00032770: 6520 696d 706f 7274 2042 7574 746f 6e2c  e import Button,
-00032780: 2043 6f6e 7472 6f6c 6c65 720a 2020 2020   Controller.    
-00032790: 6d6f 7573 6520 3d20 436f 6e74 726f 6c6c  mouse = Controll
-000327a0: 6572 2829 0a20 2020 206d 6f75 7365 2e73  er().    mouse.s
-000327b0: 6372 6f6c 6c28 6478 2c20 6479 290a 0a64  croll(dx, dy)..d
-000327c0: 6566 2070 6f73 6974 696f 6e28 293a 0a20  ef position():. 
-000327d0: 2020 2066 726f 6d20 7079 6e70 7574 2e6d     from pynput.m
-000327e0: 6f75 7365 2069 6d70 6f72 7420 4275 7474  ouse import Butt
-000327f0: 6f6e 2c20 436f 6e74 726f 6c6c 6572 0a20  on, Controller. 
-00032800: 2020 206d 6f75 7365 203d 2043 6f6e 7472     mouse = Contr
-00032810: 6f6c 6c65 7228 290a 2020 2020 7265 7475  oller().    retu
-00032820: 726e 206d 6f75 7365 2e70 6f73 6974 696f  rn mouse.positio
-00032830: 6e0a 0a64 6566 2073 697a 6528 293a 0a20  n..def size():. 
-00032840: 2020 2023 2068 7474 7073 3a2f 2f73 7461     # https://sta
-00032850: 636b 6f76 6572 666c 6f77 2e63 6f6d 2f71  ckoverflow.com/q
-00032860: 7565 7374 696f 6e73 2f33 3132 3933 3232  uestions/3129322
-00032870: 2f0a 2020 2020 6d6d 5f70 6572 5f69 6e63  /.    mm_per_inc
-00032880: 6820 3d20 3235 2e34 0a20 2020 2070 785f  h = 25.4.    px_
-00032890: 7065 725f 696e 6368 203d 2020 3732 2e30  per_inch =  72.0
-000328a0: 2023 6d6f 7374 2063 6f6d 6d6f 6e0a 2020   #most common.  
-000328b0: 2020 696d 706f 7274 206d 7373 0a20 2020    import mss.   
-000328c0: 2073 6374 3d6d 7373 2e6d 7373 2829 0a20   sct=mss.mss(). 
-000328d0: 2020 2072 6574 7572 6e20 7363 742e 6d6f     return sct.mo
-000328e0: 6e69 746f 7273 0a0a 2323 2323 2a2a 2a2a  nitors..####****
+0002ddb0: 6d70 6f72 7420 534d 5450 0a20 2020 2069  mport SMTP.    i
+0002ddc0: 6d70 6f72 7420 6874 6d6c 0a20 2020 2023  mport html.    #
+0002ddd0: 2068 7474 7073 3a2f 2f79 6167 6d61 696c   https://yagmail
+0002dde0: 2e72 6561 6474 6865 646f 6373 2e69 6f2f  .readthedocs.io/
+0002ddf0: 656e 2f6c 6174 6573 742f 7573 6167 652e  en/latest/usage.
+0002de00: 6874 6d6c 0a20 2020 2074 7279 3a0a 2020  html.    try:.  
+0002de10: 2020 2020 2020 2320 696d 706f 7274 206f        # import o
+0002de20: 732c 2073 7973 0a20 2020 2020 2020 2023  s, sys.        #
+0002de30: 2048 4552 4520 3d20 6f73 2e70 6174 682e   HERE = os.path.
+0002de40: 6469 726e 616d 6528 6f73 2e70 6174 682e  dirname(os.path.
+0002de50: 6162 7370 6174 6828 5f5f 6669 6c65 5f5f  abspath(__file__
+0002de60: 2929 0a20 2020 2020 2020 2023 2073 7973  )).        # sys
+0002de70: 2e70 6174 682e 696e 7365 7274 2830 2c20  .path.insert(0, 
+0002de80: 4845 5245 290a 2020 2020 2020 2020 0a20  HERE).        . 
+0002de90: 2020 2020 2020 2023 2045 4d41 494c 203d         # EMAIL =
+0002dea0: 2022 736f 6d65 6f6e 6540 676d 6169 6c2e   "someone@gmail.
+0002deb0: 636f 6d22 2c20 5041 5353 574f 5244 203d  com", PASSWORD =
+0002dec0: 2022 6162 6364 6566 6768 696a 6b6c 220a   "abcdefghijkl".
+0002ded0: 2020 2020 2020 2020 6763 6c69 656e 7420          gclient 
+0002dee0: 3d20 534d 5450 2845 4d41 494c 2c50 4153  = SMTP(EMAIL,PAS
+0002def0: 5357 4f52 4429 0a20 2020 2065 7863 6570  SWORD).    excep
+0002df00: 743a 0a20 2020 2020 2020 2067 636c 6965  t:.        gclie
+0002df10: 6e74 203d 2053 4d54 5028 656d 6169 6c2c  nt = SMTP(email,
+0002df20: 7061 7373 776f 7264 290a 2020 2020 636f  password).    co
+0002df30: 6e74 656e 7473 3d4e 6f6e 650a 2020 2020  ntents=None.    
+0002df40: 6966 2074 6578 7420 6973 206e 6f74 204e  if text is not N
+0002df50: 6f6e 653a 2062 6f64 793d 4e6f 6e65 0a20  one: body=None. 
+0002df60: 2020 2069 6620 7465 7874 2069 7320 6e6f     if text is no
+0002df70: 7420 4e6f 6e65 3a20 636f 6e74 656e 7473  t None: contents
+0002df80: 3d68 746d 6c2e 6573 6361 7065 2874 6578  =html.escape(tex
+0002df90: 7429 0a20 2020 2069 6620 626f 6479 2069  t).    if body i
+0002dfa0: 7320 6e6f 7420 4e6f 6e65 3a20 636f 6e74  s not None: cont
+0002dfb0: 656e 7473 3d62 6f64 790a 2020 2020 6763  ents=body.    gc
+0002dfc0: 6c69 656e 742e 7365 6e64 2873 7562 6a65  lient.send(subje
+0002dfd0: 6374 3d73 7562 6a65 6374 2c74 6f3d 746f  ct=subject,to=to
+0002dfe0: 2c63 633d 6363 2c62 6363 3d62 6363 2c63  ,cc=cc,bcc=bcc,c
+0002dff0: 6f6e 7465 6e74 733d 636f 6e74 656e 7473  ontents=contents
+0002e000: 2c61 7474 6163 686d 656e 7473 3d61 7474  ,attachments=att
+0002e010: 6163 686d 656e 7473 290a 2020 2020 6763  achments).    gc
+0002e020: 6c69 656e 742e 636c 6f73 6528 290a 2020  lient.close().  
+0002e030: 2020 7265 7475 726e 204e 6f6e 650a 6d61    return None.ma
+0002e040: 696c 203d 204d 6169 6c0a 676d 6169 6c20  il = Mail.gmail 
+0002e050: 3d20 4d61 696c 0a0a 6465 6620 6f33 3635  = Mail..def o365
+0002e060: 6175 7468 2869 643d 4e6f 6e65 2c20 7365  auth(id=None, se
+0002e070: 6372 6574 3d4e 6f6e 6529 3a0a 2020 2020  cret=None):.    
+0002e080: 7472 793a 0a20 2020 2020 2020 2063 7265  try:.        cre
+0002e090: 6465 6e74 6961 6c73 203d 2028 4f33 3635  dentials = (O365
+0002e0a0: 4944 2c20 4f33 3635 5345 4352 4554 290a  ID, O365SECRET).
+0002e0b0: 2020 2020 6578 6365 7074 3a0a 2020 2020      except:.    
+0002e0c0: 2020 2020 6372 6564 656e 7469 616c 7320      credentials 
+0002e0d0: 3d20 2869 642c 2073 6563 7265 7429 0a20  = (id, secret). 
+0002e0e0: 2020 2023 2068 7474 7073 3a2f 2f73 7461     # https://sta
+0002e0f0: 636b 6f76 6572 666c 6f77 2e63 6f6d 2f71  ckoverflow.com/q
+0002e100: 7565 7374 696f 6e73 2f38 3436 3931 3232  uestions/8469122
+0002e110: 200a 2020 2020 2320 7265 6164 6c69 6e65   .    # readline
+0002e120: 206c 6966 7473 204d 6178 696d 756d 2063   lifts Maximum c
+0002e130: 6861 7261 6374 6572 7320 7468 6174 2063  haracters that c
+0002e140: 616e 2062 6520 7374 7566 6665 6420 696e  an be stuffed in
+0002e150: 746f 2072 6177 5f69 6e70 7574 2829 2069  to raw_input() i
+0002e160: 6e20 5079 7468 6f6e 0a20 2020 2069 6d70  n Python.    imp
+0002e170: 6f72 7420 7265 6164 6c69 6e65 200a 2020  ort readline .  
+0002e180: 2020 6672 6f6d 204f 3336 3520 696d 706f    from O365 impo
+0002e190: 7274 2041 6363 6f75 6e74 2c20 4669 6c65  rt Account, File
+0002e1a0: 5379 7374 656d 546f 6b65 6e42 6163 6b65  SystemTokenBacke
+0002e1b0: 6e64 0a20 2020 2023 2073 6176 6520 746f  nd.    # save to
+0002e1c0: 6b65 6e20 746f 2069 6e73 7461 6c6c 6174  ken to installat
+0002e1d0: 696f 6e20 6469 7265 6374 6f72 790a 2020  ion directory.  
+0002e1e0: 2020 746f 6b65 6e5f 6261 636b 656e 6420    token_backend 
+0002e1f0: 3d20 4669 6c65 5379 7374 656d 546f 6b65  = FileSystemToke
+0002e200: 6e42 6163 6b65 6e64 2874 6f6b 656e 5f70  nBackend(token_p
+0002e210: 6174 683d 6f73 2e70 6174 682e 6469 726e  ath=os.path.dirn
+0002e220: 616d 6528 6f73 2e70 6174 682e 6162 7370  ame(os.path.absp
+0002e230: 6174 6828 5f5f 6669 6c65 5f5f 2929 2c20  ath(__file__)), 
+0002e240: 746f 6b65 6e5f 6669 6c65 6e61 6d65 3d27  token_filename='
+0002e250: 6f33 3635 5f74 6f6b 656e 2e74 7874 2729  o365_token.txt')
+0002e260: 0a20 2020 2061 6363 6f75 6e74 203d 2041  .    account = A
+0002e270: 6363 6f75 6e74 2863 7265 6465 6e74 6961  ccount(credentia
+0002e280: 6c73 2c20 746f 6b65 6e5f 6261 636b 656e  ls, token_backen
+0002e290: 643d 746f 6b65 6e5f 6261 636b 656e 6429  d=token_backend)
+0002e2a0: 0a20 2020 2073 636f 7065 733d 5b27 6261  .    scopes=['ba
+0002e2b0: 7369 6327 2c20 276d 6573 7361 6765 5f61  sic', 'message_a
+0002e2c0: 6c6c 272c 276f 6e65 6472 6976 655f 616c  ll','onedrive_al
+0002e2d0: 6c27 2c27 7368 6172 6570 6f69 6e74 5f64  l','sharepoint_d
+0002e2e0: 6c27 2c27 7461 736b 735f 616c 6c27 2c27  l','tasks_all','
+0002e2f0: 6361 6c65 6e64 6172 5f61 6c6c 272c 2763  calendar_all','c
+0002e300: 616c 656e 6461 725f 7368 6172 6564 5f61  alendar_shared_a
+0002e310: 6c6c 275d 0a20 2020 2069 6620 6e6f 7420  ll'].    if not 
+0002e320: 6163 636f 756e 742e 6973 5f61 7574 6865  account.is_authe
+0002e330: 6e74 6963 6174 6564 3a20 2023 2077 696c  nticated:  # wil
+0002e340: 6c20 6368 6563 6b20 6966 2074 6865 7265  l check if there
+0002e350: 2069 7320 6120 746f 6b65 6e20 616e 6420   is a token and 
+0002e360: 6861 7320 6e6f 7420 6578 7069 7265 640a  has not expired.
+0002e370: 2020 2020 2020 2020 2320 6173 6b20 666f          # ask fo
+0002e380: 7220 6120 6c6f 6769 6e0a 2020 2020 2020  r a login.      
+0002e390: 2020 2320 636f 6e73 6f6c 6520 6261 7365    # console base
+0002e3a0: 6420 6175 7468 656e 7469 6361 7469 6f6e  d authentication
+0002e3b0: 2053 6565 2041 7574 6865 6e74 6963 6174   See Authenticat
+0002e3c0: 696f 6e20 666f 7220 6f74 6865 7220 666c  ion for other fl
+0002e3d0: 6f77 730a 2020 2020 2020 2020 6163 636f  ows.        acco
+0002e3e0: 756e 742e 6175 7468 656e 7469 6361 7465  unt.authenticate
+0002e3f0: 2873 636f 7065 733d 7363 6f70 6573 290a  (scopes=scopes).
+0002e400: 2020 2020 7265 7475 726e 2061 6363 6f75      return accou
+0002e410: 6e74 0a0a 6465 6620 6f75 746c 6f6f 6b28  nt..def outlook(
+0002e420: 746f 2c20 7375 626a 6563 742c 2062 6f64  to, subject, bod
+0002e430: 793d 4e6f 6e65 2c20 6174 7461 6368 6d65  y=None, attachme
+0002e440: 6e74 733d 4e6f 6e65 2c20 6263 633d 4e6f  nts=None, bcc=No
+0002e450: 6e65 2c20 6363 3d4e 6f6e 652c 2072 6570  ne, cc=None, rep
+0002e460: 6c79 5f74 6f3d 4e6f 6e65 2c20 6964 3d4e  ly_to=None, id=N
+0002e470: 6f6e 652c 2073 6563 7265 743d 4e6f 6e65  one, secret=None
+0002e480: 293a 0a20 2020 2022 2222 6f75 746c 6f6f  ):.    """outloo
+0002e490: 6b28 746f 2c20 7375 626a 6563 742c 2062  k(to, subject, b
+0002e4a0: 6f64 792c 2061 7474 6163 686d 656e 7473  ody, attachments
+0002e4b0: 3d4e 6f6e 652c 2062 6363 3d4e 6f6e 652c  =None, bcc=None,
+0002e4c0: 2063 633d 4e6f 6e65 2c20 7265 706c 795f   cc=None, reply_
+0002e4d0: 746f 3d4e 6f6e 652c 2069 643d 4e6f 6e65  to=None, id=None
+0002e4e0: 2c20 7365 6372 6574 3d4e 6f6e 6529 0a20  , secret=None). 
+0002e4f0: 2020 2074 6f2f 6263 632f 6363 3a20 5b27     to/bcc/cc: ['
+0002e500: 6140 612e 636f 6d27 2c27 6240 622e 636f  a@a.com','b@b.co
+0002e510: 6d27 5d20 6f72 2027 6140 612e 636f 6d2c  m'] or 'a@a.com,
+0002e520: 2062 4062 2e63 6f6d 270a 2020 2020 7265   b@b.com'.    re
+0002e530: 706c 795f 746f 3a20 2761 4061 2e63 6f6d  ply_to: 'a@a.com
+0002e540: 270a 2020 2020 626f 6479 3a20 6874 6d6c  '.    body: html
+0002e550: 2063 6f64 6520 6f72 2074 6578 742e 2042   code or text. B
+0002e560: 6573 7420 7072 6163 7469 6365 3a20 5772  est practice: Wr
+0002e570: 6974 652f 466f 726d 6174 2069 6e20 4f75  ite/Format in Ou
+0002e580: 746c 6f6f 6b2f 576f 7264 2c20 7468 656e  tlook/Word, then
+0002e590: 2050 6173 7465 2061 7320 7465 7874 2c20   Paste as text, 
+0002e5a0: 5772 6170 2074 6578 7420 7769 7468 203c  Wrap text with <
+0002e5b0: 7072 653e 3c2f 7072 653e 0a20 2020 2061  pre></pre>.    a
+0002e5c0: 7474 6163 686d 656e 7473 3a20 2766 696c  ttachments: 'fil
+0002e5d0: 655f 696e 5f77 6f72 6b69 6e67 5f64 6972  e_in_working_dir
+0002e5e0: 2e74 7874 2720 6f72 205b 2761 2e74 7874  .txt' or ['a.txt
+0002e5f0: 272c 2762 2e70 7927 2c27 632e 7064 6627  ','b.py','c.pdf'
+0002e600: 5d0a 2020 2020 6964 2c20 7365 6372 6574  ].    id, secret
+0002e610: 3a20 6967 6e6f 7265 6420 6966 2070 7973  : ignored if pys
+0002e620: 6563 7265 7473 2065 7869 7374 730a 2020  ecrets exists.  
+0002e630: 2020 2222 220a 2020 2020 6163 636f 756e    """.    accoun
+0002e640: 7420 3d20 6f33 3635 6175 7468 2869 642c  t = o365auth(id,
+0002e650: 7365 6372 6574 290a 2020 2020 6d20 3d20  secret).    m = 
+0002e660: 6163 636f 756e 742e 6e65 775f 6d65 7373  account.new_mess
+0002e670: 6167 6528 290a 2020 2020 6d2e 746f 2e61  age().    m.to.a
+0002e680: 6464 2874 6f29 0a20 2020 206d 2e73 7562  dd(to).    m.sub
+0002e690: 6a65 6374 203d 2073 7562 6a65 6374 0a20  ject = subject. 
+0002e6a0: 2020 206d 2e62 6f64 7920 3d20 626f 6479     m.body = body
+0002e6b0: 0a20 2020 2069 6620 6363 2069 7320 6e6f  .    if cc is no
+0002e6c0: 7420 4e6f 6e65 3a20 6d2e 6363 2e61 6464  t None: m.cc.add
+0002e6d0: 2863 6329 0a20 2020 2069 6620 6263 6320  (cc).    if bcc 
+0002e6e0: 6973 206e 6f74 204e 6f6e 653a 206d 2e62  is not None: m.b
+0002e6f0: 6363 2e61 6464 2862 6363 290a 2020 2020  cc.add(bcc).    
+0002e700: 6966 2072 6570 6c79 5f74 6f20 6973 206e  if reply_to is n
+0002e710: 6f74 204e 6f6e 653a 206d 2e72 6570 6c79  ot None: m.reply
+0002e720: 5f74 6f2e 6164 6428 7265 706c 795f 746f  _to.add(reply_to
+0002e730: 290a 2020 2020 6966 2061 7474 6163 686d  ).    if attachm
+0002e740: 656e 7473 2069 7320 6e6f 7420 4e6f 6e65  ents is not None
+0002e750: 3a20 6d2e 6174 7461 6368 6d65 6e74 732e  : m.attachments.
+0002e760: 6164 6428 6174 7461 6368 6d65 6e74 7329  add(attachments)
+0002e770: 0a20 2020 206d 2e73 656e 6428 290a 0a64  .    m.send()..d
+0002e780: 6566 206f 6e65 6472 6976 655f 7368 6172  ef onedrive_shar
+0002e790: 6528 7061 7468 2c73 6861 7265 5f74 7970  e(path,share_typ
+0002e7a0: 653d 2776 6965 7727 2c73 6861 7265 5f73  e='view',share_s
+0002e7b0: 636f 7065 3d27 616e 6f6e 796d 6f75 7327  cope='anonymous'
+0002e7c0: 2c73 6861 7265 5f70 6173 7377 6f72 643d  ,share_password=
+0002e7d0: 4e6f 6e65 2c73 6861 7265 5f65 7870 6972  None,share_expir
+0002e7e0: 6174 696f 6e5f 6461 7465 3d4e 6f6e 652c  ation_date=None,
+0002e7f0: 6964 3d4e 6f6e 652c 7365 6372 6574 3d4e  id=None,secret=N
+0002e800: 6f6e 6529 3a0a 2020 2020 2222 220a 2020  one):.    """.  
+0002e810: 2020 7061 7468 3a20 272f 4549 552f 5465    path: '/EIU/Te
+0002e820: 6163 6869 6e67 2f34 3831 3044 7275 6727  aching/4810Drug'
+0002e830: 0a20 2020 2073 6861 7265 5f74 7970 653a  .    share_type:
+0002e840: 2027 7669 6577 272c 2765 6469 7427 2c27   'view','edit','
+0002e850: 656d 6265 6427 0a20 2020 2073 6861 7265  embed'.    share
+0002e860: 5f73 636f 7065 3a20 2761 6e6f 6e79 6d6f  _scope: 'anonymo
+0002e870: 7573 272c 276f 7267 616e 697a 6174 696f  us','organizatio
+0002e880: 6e27 0a20 2020 2073 6861 7265 5f70 6173  n'.    share_pas
+0002e890: 7377 6f72 643a 2073 7472 206f 7220 4e6f  sword: str or No
+0002e8a0: 6e65 0a20 2020 2073 6861 7265 5f65 7870  ne.    share_exp
+0002e8b0: 6972 6174 696f 6e5f 6461 7465 3a20 2732  iration_date: '2
+0002e8c0: 3032 322d 3032 2d31 3427 2c20 0a20 2020  022-02-14', .   
+0002e8d0: 2020 2020 2069 6620 6e6f 7420 7370 6563       if not spec
+0002e8e0: 6966 6965 642c 2061 7574 6f20 6d61 7820  ified, auto max 
+0002e8f0: 6465 7465 726d 696e 6564 2062 7920 6164  determined by ad
+0002e900: 6d69 6e73 7472 6174 6f72 0a20 2020 2020  minstrator.     
+0002e910: 2020 2069 6620 6e6f 7420 7370 6563 6966     if not specif
+0002e920: 6965 642c 2063 616c 6c20 7468 6520 6675  ied, call the fu
+0002e930: 6e63 7469 6f6e 2061 2073 6563 6f6e 6420  nction a second 
+0002e940: 7469 6d65 2077 696c 6c20 6175 746f 2072  time will auto r
+0002e950: 656e 6577 2065 7870 6972 6174 696f 6e20  enew expiration 
+0002e960: 6461 7465 2028 6173 206c 6f6e 6720 6173  date (as long as
+0002e970: 2073 6861 7265 2064 6f65 7320 6e6f 7420   share does not 
+0002e980: 6368 616e 6765 290a 2020 2020 2222 220a  change).    """.
+0002e990: 2020 2020 6163 636f 756e 7420 3d20 6f33      account = o3
+0002e9a0: 3635 6175 7468 2869 642c 7365 6372 6574  65auth(id,secret
+0002e9b0: 290a 2020 2020 7374 6f72 6167 6520 3d20  ).    storage = 
+0002e9c0: 6163 636f 756e 742e 7374 6f72 6167 6528  account.storage(
+0002e9d0: 2920 2023 2068 6572 6520 7765 2067 6574  )  # here we get
+0002e9e0: 2074 6865 2073 746f 7261 6765 2069 6e73   the storage ins
+0002e9f0: 7461 6e63 6520 7468 6174 2068 616e 646c  tance that handl
+0002ea00: 6573 2061 6c6c 2074 6865 2073 746f 7261  es all the stora
+0002ea10: 6765 206f 7074 696f 6e73 2e0a 2020 2020  ge options..    
+0002ea20: 2320 6765 7420 7468 6520 6465 6661 756c  # get the defaul
+0002ea30: 7420 6472 6976 650a 2020 2020 6472 6976  t drive.    driv
+0002ea40: 6520 3d20 7374 6f72 6167 652e 6765 745f  e = storage.get_
+0002ea50: 6465 6661 756c 745f 6472 6976 6528 290a  default_drive().
+0002ea60: 2020 2020 6974 656d 203d 2064 7269 7665      item = drive
+0002ea70: 2e67 6574 5f69 7465 6d5f 6279 5f70 6174  .get_item_by_pat
+0002ea80: 6828 7061 7468 290a 2020 2020 7065 726d  h(path).    perm
+0002ea90: 6973 7369 6f6e 203d 2069 7465 6d2e 7368  ission = item.sh
+0002eaa0: 6172 655f 7769 7468 5f6c 696e 6b28 7368  are_with_link(sh
+0002eab0: 6172 655f 7479 7065 3d73 6861 7265 5f74  are_type=share_t
+0002eac0: 7970 652c 7368 6172 655f 7363 6f70 653d  ype,share_scope=
+0002ead0: 7368 6172 655f 7363 6f70 652c 7368 6172  share_scope,shar
+0002eae0: 655f 7061 7373 776f 7264 3d73 6861 7265  e_password=share
+0002eaf0: 5f70 6173 7377 6f72 642c 7368 6172 655f  _password,share_
+0002eb00: 6578 7069 7261 7469 6f6e 5f64 6174 653d  expiration_date=
+0002eb10: 7368 6172 655f 6578 7069 7261 7469 6f6e  share_expiration
+0002eb20: 5f64 6174 6529 0a20 2020 2072 6574 7572  _date).    retur
+0002eb30: 6e20 7065 726d 6973 7369 6f6e 2e73 6861  n permission.sha
+0002eb40: 7265 5f6c 696e 6b0a 0a64 6566 2067 6574  re_link..def get
+0002eb50: 7061 7373 776f 7264 6277 2869 7465 6d2c  passwordbw(item,
+0002eb60: 7768 6174 3d27 7573 7270 7764 272c 7379  what='usrpwd',sy
+0002eb70: 6e63 3d46 616c 7365 2c76 6572 626f 7365  nc=False,verbose
+0002eb80: 3d30 293a 0a20 2020 2022 2222 0a20 2020  =0):.    """.   
+0002eb90: 2069 7465 6d3a 2073 6561 7263 6820 7374   item: search st
+0002eba0: 7269 6e67 2028 6e6f 7420 6361 7365 2073  ring (not case s
+0002ebb0: 656e 7369 7469 7665 2c20 6265 7474 6572  ensitive, better
+0002ebc0: 2062 6520 756e 6971 7565 292c 206f 7220   be unique), or 
+0002ebd0: 6974 656d 2069 640a 2020 2020 6874 7470  item id.    http
+0002ebe0: 733a 2f2f 6269 7477 6172 6465 6e2e 636f  s://bitwarden.co
+0002ebf0: 6d2f 6865 6c70 2f61 7274 6963 6c65 2f63  m/help/article/c
+0002ec00: 6c69 2f23 6765 740a 2020 2020 6765 7420  li/#get.    get 
+0002ec10: 6f6e 6520 6174 2061 2074 696d 653a 2069  one at a time: i
+0002ec20: 7465 6d7c 7573 6572 6e61 6d65 7c70 6173  tem|username|pas
+0002ec30: 7377 6f72 647c 7572 697c 746f 7470 7c65  sword|uri|totp|e
+0002ec40: 7870 6f73 6564 7c61 7474 6163 686d 656e  xposed|attachmen
+0002ec50: 747c 666f 6c64 6572 7c63 6f6c 6c65 6374  t|folder|collect
+0002ec60: 696f 6e7c 6f72 6761 6e69 7a61 7469 6f6e  ion|organization
+0002ec70: 7c6f 7267 2d63 6f6c 6c65 6374 696f 6e7c  |org-collection|
+0002ec80: 7465 6d70 6c61 7465 7c66 696e 6765 7270  template|fingerp
+0002ec90: 7269 6e74 0a20 2020 2073 7065 6369 616c  rint.    special
+0002eca0: 2063 7573 746f 6d69 7a65 6420 7768 6174   customized what
+0002ecb0: 3d27 7573 7270 7764 270a 2020 2020 2222  ='usrpwd'.    ""
+0002ecc0: 220a 2020 2020 2320 746f 646f 3a20 696d  ".    # todo: im
+0002ecd0: 706c 656d 656e 7420 6277 206f 6e20 6c69  plement bw on li
+0002ece0: 6e75 780a 2020 2020 6f6c 6477 6861 743d  nux.    oldwhat=
+0002ecf0: 7768 6174 0a20 2020 2069 6620 7768 6174  what.    if what
+0002ed00: 3d3d 2775 7372 7077 6427 3a20 7768 6174  =='usrpwd': what
+0002ed10: 3d27 6974 656d 270a 0a20 2020 2023 206c  ='item'..    # l
+0002ed20: 6f63 616c 2076 6172 2063 6f75 6c64 2062  ocal var could b
+0002ed30: 6520 7468 6520 7361 6d65 206e 616d 6520  e the same name 
+0002ed40: 6173 2067 6c6f 6261 6c20 7661 720a 2020  as global var.  
+0002ed50: 2020 2320 6275 7420 6966 2063 6861 6e67    # but if chang
+0002ed60: 6520 7661 722c 2062 6574 7465 7220 7573  e var, better us
+0002ed70: 6520 6c6f 6361 6c20 7661 720a 2020 2020  e local var.    
+0002ed80: 2320 6966 2063 6861 6e67 6520 676c 6f62  # if change glob
+0002ed90: 616c 2076 6172 2c20 6465 6669 6e65 3a20  al var, define: 
+0002eda0: 676c 6f62 616c 2076 6172 0a20 2020 2074  global var.    t
+0002edb0: 7279 3a0a 2020 2020 2020 2020 5f45 4d41  ry:.        _EMA
+0002edc0: 494c 203d 2045 4d41 494c 0a20 2020 2020  IL = EMAIL.     
+0002edd0: 2020 205f 5041 5353 574f 5244 203d 2050     _PASSWORD = P
+0002ede0: 4153 5357 4f52 4420 2b20 272b 270a 2020  ASSWORD + '+'.  
+0002edf0: 2020 6578 6365 7074 3a0a 2020 2020 2020    except:.      
+0002ee00: 2020 5f45 4d41 494c 203d 2027 273b 205f    _EMAIL = ''; _
+0002ee10: 5041 5353 574f 5244 3d27 270a 0a20 2020  PASSWORD=''..   
+0002ee20: 206d 6163 6869 6e65 203d 2067 6574 6f73   machine = getos
+0002ee30: 2829 0a20 2020 2069 6620 6d61 6368 696e  ().    if machin
+0002ee40: 653d 3d27 4461 7277 696e 273a 0a20 2020  e=='Darwin':.   
+0002ee50: 2020 2020 2062 7720 3d20 272f 7573 722f       bw = '/usr/
+0002ee60: 6c6f 6361 6c2f 6269 6e2f 6277 270a 2020  local/bin/bw'.  
+0002ee70: 2020 2020 2020 7379 6e63 203d 2027 2720        sync = '' 
+0002ee80: 6966 2073 796e 6320 656c 7365 2027 2320  if sync else '# 
+0002ee90: 2720 2320 636f 6d6d 656e 7420 6f75 740a  ' # comment out.
+0002eea0: 2020 2020 2020 2020 6f75 7420 3d20 6578          out = ex
+0002eeb0: 6563 7574 6530 2866 277b 6277 7d20 7374  ecute0(f'{bw} st
+0002eec0: 6174 7573 272c 7665 7262 6f73 653d 7665  atus',verbose=ve
+0002eed0: 7262 6f73 6529 0a20 2020 2020 2020 2073  rbose).        s
+0002eee0: 7461 7475 7320 3d20 7265 2e73 6561 7263  tatus = re.searc
+0002eef0: 6828 2722 7374 6174 7573 223a 2228 5c77  h('"status":"(\w
+0002ef00: 2b29 2227 2c6f 7574 5b30 5d29 2e67 726f  +)"',out[0]).gro
+0002ef10: 7570 2831 290a 2020 2020 2020 2020 6966  up(1).        if
+0002ef20: 2073 7461 7475 7320 3d3d 2027 756e 6175   status == 'unau
+0002ef30: 7468 656e 7469 6361 7465 6427 3a0a 2020  thenticated':.  
+0002ef40: 2020 2020 2020 2020 2020 636d 6420 3d20            cmd = 
+0002ef50: 6622 2222 0a20 2020 2020 2020 2020 2020  f""".           
+0002ef60: 2065 7870 6f72 7420 4257 5f55 5345 523d   export BW_USER=
+0002ef70: 7b5f 454d 4149 4c7d 0a20 2020 2020 2020  {_EMAIL}.       
+0002ef80: 2020 2020 2065 7870 6f72 7420 4257 5f50       export BW_P
+0002ef90: 4153 5357 4f52 443d 7b5f 5041 5353 574f  ASSWORD={_PASSWO
+0002efa0: 5244 7d0a 2020 2020 2020 2020 2020 2020  RD}.            
+0002efb0: 7b62 777d 206c 6f67 696e 2024 4257 5f55  {bw} login $BW_U
+0002efc0: 5345 5220 2442 575f 5041 5353 574f 5244  SER $BW_PASSWORD
+0002efd0: 0a20 2020 2020 2020 2020 2020 2022 2222  .            """
+0002efe0: 0a20 2020 2020 2020 2020 2020 2065 7865  .            exe
+0002eff0: 6375 7465 2863 6d64 2c76 6572 626f 7365  cute(cmd,verbose
+0002f000: 3d76 6572 626f 7365 290a 2020 2020 2020  =verbose).      
+0002f010: 2020 2020 2020 7374 6174 7573 203d 2027        status = '
+0002f020: 6c6f 636b 6564 2720 2320 6c6f 6769 6e20  locked' # login 
+0002f030: 6669 7273 740a 2020 2020 2020 2020 6966  first.        if
+0002f040: 2073 7461 7475 7320 3d3d 2027 6c6f 636b   status == 'lock
+0002f050: 6564 2720 6f72 2073 7461 7475 7320 3d3d  ed' or status ==
+0002f060: 2027 756e 6c6f 636b 6564 273a 2020 2320   'unlocked':  # 
+0002f070: 616c 7761 7973 2075 6e6c 6f63 6b20 746f  always unlock to
+0002f080: 2067 6574 2073 6573 7369 6f6e 2069 640a   get session id.
+0002f090: 2020 2020 2020 2020 2020 2020 636d 6420              cmd 
+0002f0a0: 3d20 6622 2222 0a20 2020 2020 2020 2020  = f""".         
+0002f0b0: 2020 2065 7870 6f72 7420 4257 5f50 4153     export BW_PAS
+0002f0c0: 5357 4f52 443d 7b5f 5041 5353 574f 5244  SWORD={_PASSWORD
+0002f0d0: 7d0a 2020 2020 2020 2020 2020 2020 6578  }.            ex
+0002f0e0: 706f 7274 2042 575f 5345 5353 494f 4e3d  port BW_SESSION=
+0002f0f0: 2428 7b62 777d 2075 6e6c 6f63 6b20 2d2d  $({bw} unlock --
+0002f100: 7061 7373 776f 7264 656e 7620 4257 5f50  passwordenv BW_P
+0002f110: 4153 5357 4f52 4420 2d2d 7261 7729 0a20  ASSWORD --raw). 
+0002f120: 2020 2020 2020 2020 2020 207b 7379 6e63             {sync
+0002f130: 7d7b 6277 7d20 7379 6e63 202d 2d71 7569  }{bw} sync --qui
+0002f140: 6574 0a20 2020 2020 2020 2020 2020 207b  et.            {
+0002f150: 6277 7d20 6765 7420 7b77 6861 747d 207b  bw} get {what} {
+0002f160: 6974 656d 7d0a 2020 2020 2020 2020 2020  item}.          
+0002f170: 2020 7b62 777d 206c 6f63 6b20 2d2d 7175    {bw} lock --qu
+0002f180: 6965 740a 2020 2020 2020 2020 2020 2020  iet.            
+0002f190: 2222 220a 2020 2020 2020 2020 2020 2020  """.            
+0002f1a0: 6f75 7420 3d20 6578 6563 7574 6530 2863  out = execute0(c
+0002f1b0: 6d64 2c76 6572 626f 7365 3d76 6572 626f  md,verbose=verbo
+0002f1c0: 7365 290a 2020 2020 2020 2020 2020 2020  se).            
+0002f1d0: 6966 2077 6861 743d 3d27 6974 656d 273a  if what=='item':
+0002f1e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002f1f0: 2069 6d70 6f72 7420 6a73 6f6e 0a20 2020   import json.   
+0002f200: 2020 2020 2020 2020 2020 2020 206f 7574               out
+0002f210: 203d 206a 736f 6e2e 6c6f 6164 7328 6f75   = json.loads(ou
+0002f220: 745b 2d31 5d29 0a20 2020 2020 2020 2020  t[-1]).         
+0002f230: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0002f240: 2020 2020 2020 2020 206f 7574 203d 206f           out = o
+0002f250: 7574 5b2d 315d 0a20 2020 2065 6c69 6620  ut[-1].    elif 
+0002f260: 6d61 6368 696e 653d 3d27 5769 6e64 6f77  machine=='Window
+0002f270: 7327 3a0a 2020 2020 2020 2020 6277 203d  s':.        bw =
+0002f280: 2027 2557 494e 4150 5053 252f 6277 2e65   '%WINAPPS%/bw.e
+0002f290: 7865 270a 2020 2020 2020 2020 7379 6e63  xe'.        sync
+0002f2a0: 203d 2027 2720 6966 2073 796e 6320 656c   = '' if sync el
+0002f2b0: 7365 2027 7265 6d20 2720 2320 636f 6d6d  se 'rem ' # comm
+0002f2c0: 656e 7420 6f75 740a 2020 2020 2020 2020  ent out.        
+0002f2d0: 6f75 7420 3d20 6578 6563 7574 6530 2866  out = execute0(f
+0002f2e0: 277b 6277 7d20 7374 6174 7573 272c 7665  '{bw} status',ve
+0002f2f0: 7262 6f73 653d 7665 7262 6f73 6529 0a20  rbose=verbose). 
+0002f300: 2020 2020 2020 2073 7461 7475 7320 3d20         status = 
+0002f310: 7265 2e73 6561 7263 6828 2722 7374 6174  re.search('"stat
+0002f320: 7573 223a 2228 5c77 2b29 2227 2c6f 7574  us":"(\w+)"',out
+0002f330: 5b30 5d29 2e67 726f 7570 2831 290a 2020  [0]).group(1).  
+0002f340: 2020 2020 2020 6966 2073 7461 7475 7320        if status 
+0002f350: 3d3d 2027 756e 6175 7468 656e 7469 6361  == 'unauthentica
+0002f360: 7465 6427 3a0a 2020 2020 2020 2020 2020  ted':.          
+0002f370: 2020 636d 6420 3d20 6622 2222 0a20 2020    cmd = f""".   
+0002f380: 2020 2020 2020 2020 2073 6574 2042 575f           set BW_
+0002f390: 5553 4552 3d7b 5f45 4d41 494c 7d0a 2020  USER={_EMAIL}.  
+0002f3a0: 2020 2020 2020 2020 2020 7365 7420 4257            set BW
+0002f3b0: 5f50 4153 5357 4f52 443d 7b5f 5041 5353  _PASSWORD={_PASS
+0002f3c0: 574f 5244 7d0a 2020 2020 2020 2020 2020  WORD}.          
+0002f3d0: 2020 7b62 777d 206c 6f67 696e 2025 4257    {bw} login %BW
+0002f3e0: 5f55 5345 5225 2025 4257 5f50 4153 5357  _USER% %BW_PASSW
+0002f3f0: 4f52 4425 0a20 2020 2020 2020 2020 2020  ORD%.           
+0002f400: 2022 2222 0a20 2020 2020 2020 2020 2020   """.           
+0002f410: 2065 7865 6375 7465 2863 6d64 2c76 6572   execute(cmd,ver
+0002f420: 626f 7365 3d76 6572 626f 7365 290a 2020  bose=verbose).  
+0002f430: 2020 2020 2020 2020 2020 7374 6174 7573            status
+0002f440: 203d 2027 6c6f 636b 6564 2720 2320 6c6f   = 'locked' # lo
+0002f450: 6769 6e20 6669 7273 740a 2020 2020 2020  gin first.      
+0002f460: 2020 6966 2073 7461 7475 7320 3d3d 2027    if status == '
+0002f470: 6c6f 636b 6564 2720 6f72 2073 7461 7475  locked' or statu
+0002f480: 7320 3d3d 2027 756e 6c6f 636b 6564 273a  s == 'unlocked':
+0002f490: 2020 2320 616c 7761 7973 2075 6e6c 6f63    # always unloc
+0002f4a0: 6b20 746f 2067 6574 2073 6573 7369 6f6e  k to get session
+0002f4b0: 2069 640a 2020 2020 2020 2020 2020 2020   id.            
+0002f4c0: 636d 6420 3d20 6622 2222 0a20 2020 2020  cmd = f""".     
+0002f4d0: 2020 2020 2020 2073 6574 2042 575f 5041         set BW_PA
+0002f4e0: 5353 574f 5244 3d7b 5f50 4153 5357 4f52  SSWORD={_PASSWOR
+0002f4f0: 447d 0a20 2020 2020 2020 2020 2020 2046  D}.            F
+0002f500: 4f52 202f 4620 2274 6f6b 656e 733d 2a22  OR /F "tokens=*"
+0002f510: 2025 2567 2049 4e20 2827 7b62 777d 2075   %%g IN ('{bw} u
+0002f520: 6e6c 6f63 6b20 2d2d 7061 7373 776f 7264  nlock --password
+0002f530: 656e 7620 4257 5f50 4153 5357 4f52 4420  env BW_PASSWORD 
+0002f540: 2d2d 7261 7727 2920 646f 2028 7365 7420  --raw') do (set 
+0002f550: 4257 5f53 4553 5349 4f4e 3d25 2567 290a  BW_SESSION=%%g).
+0002f560: 2020 2020 2020 2020 2020 2020 7b73 796e              {syn
+0002f570: 637d 7b62 777d 2073 796e 6320 2d2d 7175  c}{bw} sync --qu
+0002f580: 6965 740a 2020 2020 2020 2020 2020 2020  iet.            
+0002f590: 7b62 777d 2067 6574 207b 7768 6174 7d20  {bw} get {what} 
+0002f5a0: 7b69 7465 6d7d 0a20 2020 2020 2020 2020  {item}.         
+0002f5b0: 2020 207b 6277 7d20 6c6f 636b 202d 2d71     {bw} lock --q
+0002f5c0: 7569 6574 0a20 2020 2020 2020 2020 2020  uiet.           
+0002f5d0: 2022 2222 0a20 2020 2020 2020 2020 2020   """.           
+0002f5e0: 206f 7574 203d 2065 7865 6375 7465 3028   out = execute0(
+0002f5f0: 636d 642c 7665 7262 6f73 653d 7665 7262  cmd,verbose=verb
+0002f600: 6f73 6529 0a20 2020 2020 2020 2020 2020  ose).           
+0002f610: 2069 6620 7768 6174 3d3d 2769 7465 6d27   if what=='item'
+0002f620: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0002f630: 2020 696d 706f 7274 206a 736f 6e0a 2020    import json.  
+0002f640: 2020 2020 2020 2020 2020 2020 2020 6f75                ou
+0002f650: 7420 3d20 6a73 6f6e 2e6c 6f61 6473 286f  t = json.loads(o
+0002f660: 7574 5b2d 315d 290a 2020 2020 2020 2020  ut[-1]).        
+0002f670: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0002f680: 2020 2020 2020 2020 2020 6f75 7420 3d20            out = 
+0002f690: 6f75 745b 2d31 5d0a 2020 2020 0a20 2020  out[-1].    .   
+0002f6a0: 2069 6620 6f6c 6477 6861 743d 3d27 7573   if oldwhat=='us
+0002f6b0: 7270 7764 273a 0a20 2020 2020 2020 2028  rpwd':.        (
+0002f6c0: 7573 722c 7077 6429 3d28 6f75 745b 276c  usr,pwd)=(out['l
+0002f6d0: 6f67 696e 275d 5b27 7573 6572 6e61 6d65  ogin']['username
+0002f6e0: 275d 2c6f 7574 5b27 6c6f 6769 6e27 5d5b  '],out['login'][
+0002f6f0: 2770 6173 7377 6f72 6427 5d29 0a20 2020  'password']).   
+0002f700: 2020 2020 2072 6574 7572 6e20 2875 7372       return (usr
+0002f710: 2c70 7764 290a 2020 2020 656c 7365 3a0a  ,pwd).    else:.
+0002f720: 2020 2020 2020 2020 7265 7475 726e 206f          return o
+0002f730: 7574 0a0a 6465 6620 7365 6e64 282a 6b65  ut..def send(*ke
+0002f740: 7973 2c64 656c 6179 3d5b 302e 3032 352c  ys,delay=[0.025,
+0002f750: 302e 3235 5d2c 7469 6d65 733d 3129 3a0a  0.25],times=1):.
+0002f760: 2020 2020 2222 220a 2020 2020 4b45 5953      """.    KEYS
+0002f770: 2e43 4f4d 4d41 4e44 2c4b 4559 532e 5348  .COMMAND,KEYS.SH
+0002f780: 4946 542c 4b45 5953 2e41 5252 4f57 5f4c  IFT,KEYS.ARROW_L
+0002f790: 4546 540a 2020 2020 4b45 5953 2e43 4f4d  EFT.    KEYS.COM
+0002f7a0: 4d41 4e44 2c27 6127 0a20 2020 2027 6162  MAND,'a'.    'ab
+0002f7b0: 6327 2c20 4b45 5953 2e41 5252 4f57 5f44  c', KEYS.ARROW_D
+0002f7c0: 4f57 4e0a 2020 2020 2761 6263 5c6e 6465  OWN.    'abc\nde
+0002f7d0: 665c 7467 270a 0a20 2020 2064 656c 6179  f\tg'..    delay
+0002f7e0: 2069 6e20 7365 636f 6e64 7320 6166 7465   in seconds afte
+0002f7f0: 7220 6561 6368 206b 6579 2070 7265 7373  r each key press
+0002f800: 2c20 302c 205b 302e 3032 352c 302e 3235  , 0, [0.025,0.25
+0002f810: 5d20 3c2d 7261 6e64 6f6d 2062 6574 7765  ] <-random betwe
+0002f820: 656e 0a20 2020 2074 696d 6573 0a20 2020  en.    times.   
+0002f830: 2064 656c 6179 2061 6e64 2074 696d 6573   delay and times
+0002f840: 2068 6176 6520 746f 2062 6520 6e61 6d65   have to be name
+0002f850: 6420 7061 7261 6d61 7465 722c 2063 616e  d paramater, can
+0002f860: 6e6f 7420 6265 206f 6d69 7474 6564 2061  not be omitted a
+0002f870: 7320 706f 7369 7469 6f6e 2070 6172 616d  s position param
+0002f880: 6574 6572 2062 6563 6175 7365 206f 6620  eter because of 
+0002f890: 2a6b 6579 730a 2020 2020 2222 220a 2020  *keys.    """.  
+0002f8a0: 2020 6672 6f6d 2070 796e 7075 742e 6b65    from pynput.ke
+0002f8b0: 7962 6f61 7264 2069 6d70 6f72 7420 4b65  yboard import Ke
+0002f8c0: 792c 2043 6f6e 7472 6f6c 6c65 720a 2020  y, Controller.  
+0002f8d0: 2020 6b65 7962 6f61 7264 203d 2043 6f6e    keyboard = Con
+0002f8e0: 7472 6f6c 6c65 7228 290a 0a20 2020 2023  troller()..    #
+0002f8f0: 2068 7474 7073 3a2f 2f77 7777 2e73 656c   https://www.sel
+0002f900: 656e 6975 6d2e 6465 762f 7365 6c65 6e69  enium.dev/seleni
+0002f910: 756d 2f64 6f63 732f 6170 692f 7079 2f5f  um/docs/api/py/_
+0002f920: 6d6f 6475 6c65 732f 7365 6c65 6e69 756d  modules/selenium
+0002f930: 2f77 6562 6472 6976 6572 2f63 6f6d 6d6f  /webdriver/commo
+0002f940: 6e2f 6b65 7973 2e68 746d 6c23 4b65 7973  n/keys.html#Keys
+0002f950: 0a0a 2020 2020 2320 636d 642c 7368 6966  ..    # cmd,shif
+0002f960: 742c 6374 726c 2c74 6162 2c73 7061 6365  t,ctrl,tab,space
+0002f970: 2c62 6163 6b73 7061 6365 2c64 656c 6574  ,backspace,delet
+0002f980: 652c 6573 632c 656e 7465 722c 0a20 2020  e,esc,enter,.   
+0002f990: 2023 2075 702f 646f 776e 2f6c 6566 742f   # up/down/left/
+0002f9a0: 7269 6768 742c 686f 6d65 2c65 6e64 2c70  right,home,end,p
+0002f9b0: 6167 655f 7570 2c70 6167 655f 646f 776e  age_up,page_down
+0002f9c0: 2c0a 2020 2020 2320 696e 7365 7274 2c6d  ,.    # insert,m
+0002f9d0: 656e 752c 7061 7573 652c 7072 696e 745f  enu,pause,print_
+0002f9e0: 7363 7265 656e 2c73 6372 6f6c 6c5f 6c6f  screen,scroll_lo
+0002f9f0: 636b 2c0a 2020 2020 2320 6631 2c66 322c  ck,.    # f1,f2,
+0002fa00: 2e2e 2e2c 6632 300a 2020 2020 2320 6d65  ...,f20.    # me
+0002fa10: 6469 615f 6e65 7874 2c6d 6564 6961 5f70  dia_next,media_p
+0002fa20: 6c61 795f 7061 7573 652c 6d65 6469 615f  lay_pause,media_
+0002fa30: 7072 6576 696f 7573 2c6d 6564 6961 5f76  previous,media_v
+0002fa40: 6f6c 756d 655f 646f 776e 2c6d 6564 6961  olume_down,media
+0002fa50: 5f76 6f6c 756d 655f 6d75 7465 2c6d 6564  _volume_mute,med
+0002fa60: 6961 5f76 6f6c 756d 655f 7570 0a20 2020  ia_volume_up.   
+0002fa70: 2023 2068 7474 7073 3a2f 2f70 796e 7075   # https://pynpu
+0002fa80: 742e 7265 6164 7468 6564 6f63 732e 696f  t.readthedocs.io
+0002fa90: 2f65 6e2f 6c61 7465 7374 2f6b 6579 626f  /en/latest/keybo
+0002faa0: 6172 642e 6874 6d6c 2370 796e 7075 742e  ard.html#pynput.
+0002fab0: 6b65 7962 6f61 7264 2e4b 6579 0a0a 2020  keyboard.Key..  
+0002fac0: 2020 2320 7265 6d61 7020 6365 7274 6169    # remap certai
+0002fad0: 6e20 6b65 7973 2062 6574 7765 656e 2073  n keys between s
+0002fae0: 656c 656e 6975 6d20 616e 6420 7079 6e70  elenium and pynp
+0002faf0: 7574 0a20 2020 2072 656d 6170 733d 7b0a  ut.    remaps={.
+0002fb00: 2020 2020 2020 2020 7527 5c75 6530 3033          u'\ue003
+0002fb10: 273a 4b65 792e 6261 636b 7370 6163 652c  ':Key.backspace,
+0002fb20: 2020 2023 2042 4143 4b53 5041 4345 0a20     # BACKSPACE. 
+0002fb30: 2020 2020 2020 2075 275c 7565 3030 3427         u'\ue004'
+0002fb40: 3a4b 6579 2e74 6162 2c20 2020 2320 5441  :Key.tab,   # TA
+0002fb50: 420a 2020 2020 2020 2020 7527 5c75 6530  B.        u'\ue0
+0002fb60: 3036 273a 4b65 792e 656e 7465 722c 2020  06':Key.enter,  
+0002fb70: 2023 2052 4554 5552 4e0a 2020 2020 2020   # RETURN.      
+0002fb80: 2020 7527 5c75 6530 3037 273a 4b65 792e    u'\ue007':Key.
+0002fb90: 656e 7465 722c 2020 2023 2045 4e54 4552  enter,   # ENTER
+0002fba0: 0a20 2020 2020 2020 2075 275c 7565 3030  .        u'\ue00
+0002fbb0: 3827 3a4b 6579 2e73 6869 6674 2c20 2020  8':Key.shift,   
+0002fbc0: 2320 5348 4946 542c 204c 4546 545f 5348  # SHIFT, LEFT_SH
+0002fbd0: 4946 540a 2020 2020 2020 2020 7527 5c75  IFT.        u'\u
+0002fbe0: 6530 3039 273a 4b65 792e 6374 726c 2c20  e009':Key.ctrl, 
+0002fbf0: 2020 2320 434f 4e54 524f 4c2c 204c 4546    # CONTROL, LEF
+0002fc00: 545f 434f 4e54 524f 4c0a 2020 2020 2020  T_CONTROL.      
+0002fc10: 2020 7527 5c75 6530 3061 273a 4b65 792e    u'\ue00a':Key.
+0002fc20: 616c 742c 2020 2023 2041 4c54 2c20 4c45  alt,   # ALT, LE
+0002fc30: 4654 5f41 4c54 0a20 2020 2020 2020 2075  FT_ALT.        u
+0002fc40: 275c 7565 3030 6327 3a4b 6579 2e65 7363  '\ue00c':Key.esc
+0002fc50: 2c20 2020 2320 4553 4341 5045 0a20 2020  ,   # ESCAPE.   
+0002fc60: 2020 2020 2075 275c 7565 3030 6427 3a4b       u'\ue00d':K
+0002fc70: 6579 2e73 7061 6365 2c20 2020 2320 5350  ey.space,   # SP
+0002fc80: 4143 450a 2020 2020 2020 2020 7527 5c75  ACE.        u'\u
+0002fc90: 6530 3065 273a 4b65 792e 7061 6765 5f75  e00e':Key.page_u
+0002fca0: 702c 2020 2023 2050 4147 455f 5550 0a20  p,   # PAGE_UP. 
+0002fcb0: 2020 2020 2020 2075 275c 7565 3030 6627         u'\ue00f'
+0002fcc0: 3a4b 6579 2e70 6167 655f 646f 776e 2c20  :Key.page_down, 
+0002fcd0: 2020 2320 5041 4745 5f44 4f57 4e0a 2020    # PAGE_DOWN.  
+0002fce0: 2020 2020 2020 7527 5c75 6530 3130 273a        u'\ue010':
+0002fcf0: 4b65 792e 656e 642c 2020 2023 2045 4e44  Key.end,   # END
+0002fd00: 0a20 2020 2020 2020 2075 275c 7565 3031  .        u'\ue01
+0002fd10: 3127 3a4b 6579 2e68 6f6d 652c 2020 2023  1':Key.home,   #
+0002fd20: 2048 4f4d 450a 2020 2020 2020 2020 7527   HOME.        u'
+0002fd30: 5c75 6530 3132 273a 4b65 792e 6c65 6674  \ue012':Key.left
+0002fd40: 2c20 2020 2320 4c45 4654 2c20 4152 524f  ,   # LEFT, ARRO
+0002fd50: 575f 4c45 4654 0a20 2020 2020 2020 2075  W_LEFT.        u
+0002fd60: 275c 7565 3031 3327 3a4b 6579 2e75 702c  '\ue013':Key.up,
+0002fd70: 2020 2023 2055 502c 2041 5252 4f57 5f55     # UP, ARROW_U
+0002fd80: 500a 2020 2020 2020 2020 7527 5c75 6530  P.        u'\ue0
+0002fd90: 3134 273a 4b65 792e 7269 6768 742c 2020  14':Key.right,  
+0002fda0: 2023 2052 4947 4854 2c20 4152 524f 575f   # RIGHT, ARROW_
+0002fdb0: 5249 4748 540a 2020 2020 2020 2020 7527  RIGHT.        u'
+0002fdc0: 5c75 6530 3135 273a 4b65 792e 646f 776e  \ue015':Key.down
+0002fdd0: 2c20 2020 2320 444f 574e 2c20 4152 524f  ,   # DOWN, ARRO
+0002fde0: 575f 444f 574e 0a20 2020 2020 2020 2075  W_DOWN.        u
+0002fdf0: 275c 7565 3031 3727 3a4b 6579 2e64 656c  '\ue017':Key.del
+0002fe00: 6574 652c 2020 2023 2044 454c 4554 450a  ete,   # DELETE.
+0002fe10: 0a20 2020 2020 2020 2075 275c 7565 3033  .        u'\ue03
+0002fe20: 3127 3a4b 6579 2e66 312c 2020 2023 2046  1':Key.f1,   # F
+0002fe30: 310a 2020 2020 2020 2020 7527 5c75 6530  1.        u'\ue0
+0002fe40: 3332 273a 4b65 792e 6632 2c20 2020 2320  32':Key.f2,   # 
+0002fe50: 4632 0a20 2020 2020 2020 2075 275c 7565  F2.        u'\ue
+0002fe60: 3033 3327 3a4b 6579 2e66 332c 2020 2023  033':Key.f3,   #
+0002fe70: 2046 330a 2020 2020 2020 2020 7527 5c75   F3.        u'\u
+0002fe80: 6530 3334 273a 4b65 792e 6634 2c20 2020  e034':Key.f4,   
+0002fe90: 2320 4634 0a20 2020 2020 2020 2075 275c  # F4.        u'\
+0002fea0: 7565 3033 3527 3a4b 6579 2e66 352c 2020  ue035':Key.f5,  
+0002feb0: 2023 2046 350a 2020 2020 2020 2020 7527   # F5.        u'
+0002fec0: 5c75 6530 3336 273a 4b65 792e 6636 2c20  \ue036':Key.f6, 
+0002fed0: 2020 2320 4636 0a20 2020 2020 2020 2075    # F6.        u
+0002fee0: 275c 7565 3033 3727 3a4b 6579 2e66 372c  '\ue037':Key.f7,
+0002fef0: 2020 2023 2046 370a 2020 2020 2020 2020     # F7.        
+0002ff00: 7527 5c75 6530 3338 273a 4b65 792e 6638  u'\ue038':Key.f8
+0002ff10: 2c20 2020 2320 4638 0a20 2020 2020 2020  ,   # F8.       
+0002ff20: 2075 275c 7565 3033 3927 3a4b 6579 2e66   u'\ue039':Key.f
+0002ff30: 392c 2020 2023 2046 390a 2020 2020 2020  9,   # F9.      
+0002ff40: 2020 7527 5c75 6530 3361 273a 4b65 792e    u'\ue03a':Key.
+0002ff50: 6631 302c 2020 2023 2046 3130 0a20 2020  f10,   # F10.   
+0002ff60: 2020 2020 2075 275c 7565 3033 6227 3a4b       u'\ue03b':K
+0002ff70: 6579 2e66 3131 2c20 2020 2320 4631 310a  ey.f11,   # F11.
+0002ff80: 2020 2020 2020 2020 7527 5c75 6530 3363          u'\ue03c
+0002ff90: 273a 4b65 792e 6631 322c 2020 2023 2046  ':Key.f12,   # F
+0002ffa0: 3132 0a0a 2020 2020 2020 2020 7527 5c75  12..        u'\u
+0002ffb0: 6530 3364 273a 4b65 792e 636d 642c 2020  e03d':Key.cmd,  
+0002ffc0: 2023 204d 4554 410a 2020 2020 2020 2020   # META.        
+0002ffd0: 7527 5c75 6530 3364 273a 4b65 792e 636d  u'\ue03d':Key.cm
+0002ffe0: 642c 2020 2023 2043 4f4d 4d41 4e44 0a20  d,   # COMMAND. 
+0002fff0: 2020 207d 0a0a 2020 2020 6966 2074 7970     }..    if typ
+00030000: 6528 6465 6c61 7929 206e 6f74 2069 6e20  e(delay) not in 
+00030010: 5b74 7570 6c65 2c6c 6973 745d 3a20 6465  [tuple,list]: de
+00030020: 6c61 793d 5b64 656c 6179 2c64 656c 6179  lay=[delay,delay
+00030030: 5d0a 0a20 2020 2066 6f72 2074 2069 6e20  ]..    for t in 
+00030040: 7261 6e67 6528 302c 7469 6d65 7329 3a0a  range(0,times):.
+00030050: 2020 2020 2020 2020 6966 2028 6c65 6e28          if (len(
+00030060: 6b65 7973 293d 3d31 2920 616e 6420 286b  keys)==1) and (k
+00030070: 6579 735b 305d 206e 6f74 2069 6e20 7265  eys[0] not in re
+00030080: 6d61 7073 293a 0a20 2020 2020 2020 2020  maps):.         
+00030090: 2020 206b 6579 626f 6172 642e 7479 7065     keyboard.type
+000300a0: 282a 6b65 7973 290a 2020 2020 2020 2020  (*keys).        
+000300b0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+000300c0: 2020 666f 7220 6b20 696e 206b 6579 733a    for k in keys:
+000300d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000300e0: 2069 6620 6b20 696e 2072 656d 6170 733a   if k in remaps:
+000300f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00030100: 2020 2020 206b 6579 626f 6172 642e 7072       keyboard.pr
+00030110: 6573 7328 7265 6d61 7073 5b6b 5d29 0a20  ess(remaps[k]). 
+00030120: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00030130: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00030140: 2020 2020 2020 2020 206b 6579 626f 6172           keyboar
+00030150: 642e 7072 6573 7328 6b29 0a20 2020 2020  d.press(k).     
+00030160: 2020 2020 2020 2066 6f72 206b 2069 6e20         for k in 
+00030170: 6c69 7374 2872 6576 6572 7365 6428 6b65  list(reversed(ke
+00030180: 7973 2929 3a0a 2020 2020 2020 2020 2020  ys)):.          
+00030190: 2020 2020 2020 6966 206b 2069 6e20 7265        if k in re
+000301a0: 6d61 7073 3a0a 2020 2020 2020 2020 2020  maps:.          
+000301b0: 2020 2020 2020 2020 2020 6b65 7962 6f61            keyboa
+000301c0: 7264 2e72 656c 6561 7365 2872 656d 6170  rd.release(remap
+000301d0: 735b 6b5d 290a 2020 2020 2020 2020 2020  s[k]).          
+000301e0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+000301f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030200: 6b65 7962 6f61 7264 2e72 656c 6561 7365  keyboard.release
+00030210: 286b 290a 2020 2020 2020 2020 2020 2020  (k).            
+00030220: 2020 2020 736c 6565 7028 7261 6e64 6f6d      sleep(random
+00030230: 2e75 6e69 666f 726d 2864 656c 6179 5b30  .uniform(delay[0
+00030240: 5d2c 6465 6c61 795b 315d 2929 0a0a 6465  ],delay[1]))..de
+00030250: 6620 6669 6e64 2869 6d61 6765 2c20 6172  f find(image, ar
+00030260: 6561 3d4e 6f6e 652c 2070 3d30 2e38 2c20  ea=None, p=0.8, 
+00030270: 7368 6f77 3d46 616c 7365 293a 0a20 2020  show=False):.   
+00030280: 2027 2727 0a20 2020 2053 6561 7263 6873   '''.    Searchs
+00030290: 2066 6f72 2061 6e20 696d 6167 6520 6f6e   for an image on
+000302a0: 2074 6865 2073 6372 6565 6e0a 2020 2020   the screen.    
+000302b0: 0a20 2020 2069 6d61 6765 3a20 7061 7468  .    image: path
+000302c0: 2074 6f20 7468 6520 696d 6167 6520 6669   to the image fi
+000302d0: 6c65 2028 7365 6520 6f70 656e 6376 2069  le (see opencv i
+000302e0: 6d72 6561 6420 666f 7220 7375 7070 6f72  mread for suppor
+000302f0: 7465 6420 7479 7065 7329 0a20 2020 2061  ted types).    a
+00030300: 7265 613a 205b 782c 792c 772c 685d 0a20  rea: [x,y,w,h]. 
+00030310: 2020 2070 3a20 7072 6563 6973 696f 6e20     p: precision 
+00030320: 7468 6520 6869 6768 6572 2c20 7468 6520  the higher, the 
+00030330: 6c65 7373 6572 2074 6f6c 6572 616e 7420  lesser tolerant 
+00030340: 616e 6420 6665 7765 7220 6661 6c73 6520  and fewer false 
+00030350: 706f 7369 7469 7665 7320 6172 6520 666f  positives are fo
+00030360: 756e 6420 6465 6661 756c 7420 6973 2030  und default is 0
+00030370: 2e38 0a20 2020 2073 686f 773a 2073 686f  .8.    show: sho
+00030380: 7720 616c 6c20 6d61 7463 6865 7320 2868  w all matches (h
+00030390: 6967 686c 6967 6874 6564 290a 0a20 2020  ighlighted)..   
+000303a0: 2072 6574 7572 6e73 203a 0a20 2020 205b   returns :.    [
+000303b0: 5b78 2c79 2c77 2c68 5d5d 206f 7220 5b5d  [x,y,w,h]] or []
+000303c0: 2069 6620 6e6f 7420 666f 756e 640a 2020   if not found.  
+000303d0: 2020 2727 270a 2020 2020 2320 6d6f 6469    '''.    # modi
+000303e0: 6669 6564 2066 726f 6d20 6874 7470 733a  fied from https:
+000303f0: 2f2f 6769 7468 7562 2e63 6f6d 2f64 726f  //github.com/dro
+00030400: 7630 2f70 7974 686f 6e2d 696d 6167 6573  v0/python-images
+00030410: 6561 7263 682f 626c 6f62 2f6d 6173 7465  earch/blob/maste
+00030420: 722f 7079 7468 6f6e 5f69 6d61 6765 7365  r/python_imagese
+00030430: 6172 6368 2f69 6d61 6765 7365 6172 6368  arch/imagesearch
+00030440: 2e70 790a 2020 2020 696d 706f 7274 2063  .py.    import c
+00030450: 7632 0a20 2020 2069 6d70 6f72 7420 6e75  v2.    import nu
+00030460: 6d70 7920 6173 206e 700a 2020 2020 696d  mpy as np.    im
+00030470: 706f 7274 206d 7373 0a20 2020 2066 726f  port mss.    fro
+00030480: 6d20 5049 4c20 696d 706f 7274 2049 6d61  m PIL import Ima
+00030490: 6765 0a0a 2020 2020 2320 6874 7470 733a  ge..    # https:
+000304a0: 2f2f 7079 7468 6f6e 2d6d 7373 2e72 6561  //python-mss.rea
+000304b0: 6474 6865 646f 6373 2e69 6f2f 6578 616d  dthedocs.io/exam
+000304c0: 706c 6573 2e68 746d 6c0a 2020 2020 7363  ples.html.    sc
+000304d0: 7420 3d20 6d73 732e 6d73 7328 290a 2020  t = mss.mss().  
+000304e0: 2020 6966 2061 7265 6120 6973 204e 6f6e    if area is Non
+000304f0: 653a 200a 2020 2020 2020 2020 6172 6561  e: .        area
+00030500: 3d73 6374 2e6d 6f6e 6974 6f72 735b 305d  =sct.monitors[0]
+00030510: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
+00030520: 2020 2061 7265 613d 7b27 6c65 6674 273a     area={'left':
+00030530: 2061 7265 615b 305d 2c20 2774 6f70 273a   area[0], 'top':
+00030540: 2061 7265 615b 315d 2c20 2777 6964 7468   area[1], 'width
+00030550: 273a 2061 7265 615b 325d 2c20 2768 6569  ': area[2], 'hei
+00030560: 6768 7427 3a20 6172 6561 5b33 5d7d 0a20  ght': area[3]}. 
+00030570: 2020 2069 6d20 3d20 7363 742e 6772 6162     im = sct.grab
+00030580: 2861 7265 6129 0a20 2020 2023 2072 6177  (area).    # raw
+00030590: 2069 7320 6267 7261 0a20 2020 2023 2049   is bgra.    # I
+000305a0: 6d61 6765 2e66 726f 6d62 7974 6573 2822  mage.frombytes("
+000305b0: 5247 4222 2c20 696d 2e73 697a 652c 2069  RGB", im.size, i
+000305c0: 6d2e 6267 7261 2c20 2272 6177 222c 2022  m.bgra, "raw", "
+000305d0: 4247 5258 2229 2e73 686f 7728 290a 2020  BGRX").show().  
+000305e0: 2020 696d 6720 3d20 6e70 2e61 7272 6179    img = np.array
+000305f0: 2869 6d29 0a20 2020 2069 6d67 203d 2063  (im).    img = c
+00030600: 7632 2e63 7674 436f 6c6f 7228 696d 672c  v2.cvtColor(img,
+00030610: 2063 7632 2e43 4f4c 4f52 5f42 4752 4132   cv2.COLOR_BGRA2
+00030620: 4247 5229 0a20 2020 2023 2063 7632 2e69  BGR).    # cv2.i
+00030630: 6d73 686f 7728 224f 7065 6e43 5622 2c20  mshow("OpenCV", 
+00030640: 696d 6729 0a20 2020 2023 2049 6d61 6765  img).    # Image
+00030650: 2e66 726f 6d61 7272 6179 2863 7632 2e63  .fromarray(cv2.c
+00030660: 7674 436f 6c6f 7228 696d 672c 2063 7632  vtColor(img, cv2
+00030670: 2e43 4f4c 4f52 5f42 4752 3252 4742 2929  .COLOR_BGR2RGB))
+00030680: 2e73 686f 7728 290a 2020 2020 7465 6d70  .show().    temp
+00030690: 6c61 7465 203d 2063 7632 2e69 6d72 6561  late = cv2.imrea
+000306a0: 6428 696d 6167 652c 2063 7632 2e49 4d52  d(image, cv2.IMR
+000306b0: 4541 445f 434f 4c4f 5229 200a 2020 2020  EAD_COLOR) .    
+000306c0: 2320 6376 322e 696d 7368 6f77 2822 4f70  # cv2.imshow("Op
+000306d0: 656e 4356 222c 2074 656d 706c 6174 6529  enCV", template)
+000306e0: 0a20 2020 2023 2049 6d61 6765 2e66 726f  .    # Image.fro
+000306f0: 6d61 7272 6179 2863 7632 2e63 7674 436f  marray(cv2.cvtCo
+00030700: 6c6f 7228 7465 6d70 6c61 7465 2c20 6376  lor(template, cv
+00030710: 322e 434f 4c4f 525f 4247 5232 5247 4229  2.COLOR_BGR2RGB)
+00030720: 292e 7368 6f77 2829 0a20 2020 2069 6620  ).show().    if 
+00030730: 7465 6d70 6c61 7465 2069 7320 4e6f 6e65  template is None
+00030740: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
+00030750: 4669 6c65 4e6f 7446 6f75 6e64 4572 726f  FileNotFoundErro
+00030760: 7228 2749 6d61 6765 2066 696c 6520 6e6f  r('Image file no
+00030770: 7420 666f 756e 643a 207b 7d27 2e66 6f72  t found: {}'.for
+00030780: 6d61 7428 696d 6167 6529 290a 2020 2020  mat(image)).    
+00030790: 7265 7320 3d20 6376 322e 6d61 7463 6854  res = cv2.matchT
+000307a0: 656d 706c 6174 6528 696d 672c 2074 656d  emplate(img, tem
+000307b0: 706c 6174 652c 2063 7632 2e54 4d5f 4343  plate, cv2.TM_CC
+000307c0: 4f45 4646 5f4e 4f52 4d45 4429 0a20 2020  OEFF_NORMED).   
+000307d0: 200a 2020 2020 6d61 7463 6865 7320 3d20   .    matches = 
+000307e0: 5b5d 0a20 2020 2023 2068 7474 7073 3a2f  [].    # https:/
+000307f0: 2f64 6f63 732e 6f70 656e 6376 2e6f 7267  /docs.opencv.org
+00030800: 2f33 2e34 2f64 342f 6463 362f 7475 746f  /3.4/d4/dc6/tuto
+00030810: 7269 616c 5f70 795f 7465 6d70 6c61 7465  rial_py_template
+00030820: 5f6d 6174 6368 696e 672e 6874 6d6c 0a20  _matching.html. 
+00030830: 2020 2068 2c20 772c 2063 6861 6e6e 656c     h, w, channel
+00030840: 7320 3d20 7465 6d70 6c61 7465 2e73 6861  s = template.sha
+00030850: 7065 0a20 2020 206c 6f63 203d 206e 702e  pe.    loc = np.
+00030860: 7768 6572 6528 2072 6573 203e 3d20 7020  where( res >= p 
+00030870: 290a 2020 2020 666f 7220 7074 2069 6e20  ).    for pt in 
+00030880: 7a69 7028 2a6c 6f63 5b3a 3a2d 315d 293a  zip(*loc[::-1]):
+00030890: 0a20 2020 2020 2020 2063 7632 2e72 6563  .        cv2.rec
+000308a0: 7461 6e67 6c65 2869 6d67 2c20 7074 2c20  tangle(img, pt, 
+000308b0: 2870 745b 305d 202b 2077 2c20 7074 5b31  (pt[0] + w, pt[1
+000308c0: 5d20 2b20 6829 2c20 2830 2c30 2c32 3535  ] + h), (0,0,255
+000308d0: 292c 2032 290a 2020 2020 2020 2020 6d61  ), 2).        ma
+000308e0: 7463 6865 732e 6170 7065 6e64 285b 2070  tches.append([ p
+000308f0: 745b 305d 2c70 745b 315d 2c77 2c68 2c72  t[0],pt[1],w,h,r
+00030900: 6573 5b70 745b 315d 2c70 745b 305d 5d20  es[pt[1],pt[0]] 
+00030910: 5d29 0a20 2020 2069 6620 7368 6f77 3a0a  ]).    if show:.
+00030920: 2020 2020 2020 2020 2320 6376 322e 696d          # cv2.im
+00030930: 7368 6f77 2822 4f70 656e 4356 222c 2069  show("OpenCV", i
+00030940: 6d67 290a 2020 2020 2020 2020 2320 6376  mg).        # cv
+00030950: 322e 696d 7772 6974 6528 2772 6573 2e70  2.imwrite('res.p
+00030960: 6e67 272c 696d 6729 0a20 2020 2020 2020  ng',img).       
+00030970: 2023 2068 7474 7073 3a2f 2f73 7461 636b   # https://stack
+00030980: 6f76 6572 666c 6f77 2e63 6f6d 2f61 2f34  overflow.com/a/4
+00030990: 3332 3334 3030 312f 3232 3932 3939 330a  3234001/2292993.
+000309a0: 2020 2020 2020 2020 496d 6167 652e 6672          Image.fr
+000309b0: 6f6d 6172 7261 7928 6376 322e 6376 7443  omarray(cv2.cvtC
+000309c0: 6f6c 6f72 2869 6d67 2c20 6376 322e 434f  olor(img, cv2.CO
+000309d0: 4c4f 525f 4247 5232 5247 4229 292e 7368  LOR_BGR2RGB)).sh
+000309e0: 6f77 2829 0a20 2020 2023 206d 696e 5f76  ow().    # min_v
+000309f0: 616c 2c20 6d61 785f 7661 6c2c 206d 696e  al, max_val, min
+00030a00: 5f6c 6f63 2c20 6d61 785f 6c6f 6320 3d20  _loc, max_loc = 
+00030a10: 6376 322e 6d69 6e4d 6178 4c6f 6328 7265  cv2.minMaxLoc(re
+00030a20: 7329 0a20 2020 2023 2069 6620 6d61 785f  s).    # if max_
+00030a30: 7661 6c20 3c20 703a 0a20 2020 2023 2020  val < p:.    #  
+00030a40: 2020 2072 6574 7572 6e20 4e6f 6e65 0a20     return None. 
+00030a50: 2020 2023 2072 6574 7572 6e20 6d61 785f     # return max_
+00030a60: 6c6f 630a 2020 2020 7265 7475 726e 206d  loc.    return m
+00030a70: 6174 6368 6573 0a0a 6465 6620 5f6d 6f75  atches..def _mou
+00030a80: 7365 2869 6e69 745f 706f 732c 2066 696e  se(init_pos, fin
+00030a90: 5f70 6f73 2c20 6465 7669 6174 696f 6e3d  _pos, deviation=
+00030aa0: 3235 2c20 6465 6c61 793d 3229 3a0a 2020  25, delay=2):.  
+00030ab0: 2020 6672 6f6d 2072 616e 646f 6d20 696d    from random im
+00030ac0: 706f 7274 2072 616e 6469 6e74 2c20 6368  port randint, ch
+00030ad0: 6f69 6365 0a20 2020 2066 726f 6d20 6d61  oice.    from ma
+00030ae0: 7468 2069 6d70 6f72 7420 6365 696c 2c20  th import ceil, 
+00030af0: 7371 7274 0a20 2020 2023 7469 6d65 2070  sqrt.    #time p
+00030b00: 6172 616d 6574 6572 0a20 2020 2073 7065  arameter.    spe
+00030b10: 6564 3d64 656c 6179 0a20 2020 2074 7320  ed=delay.    ts 
+00030b20: 3d20 5b74 2f28 7370 6565 6420 2a20 3130  = [t/(speed * 10
+00030b30: 302e 3029 2066 6f72 2074 2069 6e20 7261  0.0) for t in ra
+00030b40: 6e67 6528 7370 6565 6420 2a20 3130 3129  nge(speed * 101)
+00030b50: 5d0a 2020 2020 2362 657a 6965 7220 6365  ].    #bezier ce
+00030b60: 6e74 7265 2063 6f6e 7472 6f6c 2070 6f69  ntre control poi
+00030b70: 6e74 7320 6265 7477 6565 6e20 2869 6e74  nts between (int
+00030b80: 2864 6576 6961 7469 6f6e 202f 2032 2929  (deviation / 2))
+00030b90: 2061 6e64 2028 6465 7669 6169 6f6e 2920   and (deviaion) 
+00030ba0: 6f66 2074 7261 7665 6c20 6469 7374 616e  of travel distan
+00030bb0: 6365 2c20 706c 7573 206f 7220 6d69 6e75  ce, plus or minu
+00030bc0: 7320 6174 2072 616e 646f 6d0a 2020 2020  s at random.    
+00030bd0: 636f 6e74 726f 6c5f 3120 3d20 2869 6e69  control_1 = (ini
+00030be0: 745f 706f 735b 305d 202b 2063 686f 6963  t_pos[0] + choic
+00030bf0: 6528 282d 312c 2031 2929 202a 2061 6273  e((-1, 1)) * abs
+00030c00: 2863 6569 6c28 6669 6e5f 706f 735b 305d  (ceil(fin_pos[0]
+00030c10: 2920 2d20 6365 696c 2869 6e69 745f 706f  ) - ceil(init_po
+00030c20: 735b 305d 2929 202a 2030 2e30 3120 2a20  s[0])) * 0.01 * 
+00030c30: 7261 6e64 696e 7428 696e 7428 6465 7669  randint(int(devi
+00030c40: 6174 696f 6e20 2f20 3229 2c20 6465 7669  ation / 2), devi
+00030c50: 6174 696f 6e29 2c0a 2020 2020 2020 2020  ation),.        
+00030c60: 2020 2020 2020 2020 696e 6974 5f70 6f73          init_pos
+00030c70: 5b31 5d20 2b20 6368 6f69 6365 2828 2d31  [1] + choice((-1
+00030c80: 2c20 3129 2920 2a20 6162 7328 6365 696c  , 1)) * abs(ceil
+00030c90: 2866 696e 5f70 6f73 5b31 5d29 202d 2063  (fin_pos[1]) - c
+00030ca0: 6569 6c28 696e 6974 5f70 6f73 5b31 5d29  eil(init_pos[1])
+00030cb0: 2920 2a20 302e 3031 202a 2072 616e 6469  ) * 0.01 * randi
+00030cc0: 6e74 2869 6e74 2864 6576 6961 7469 6f6e  nt(int(deviation
+00030cd0: 202f 2032 292c 2064 6576 6961 7469 6f6e   / 2), deviation
+00030ce0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00030cf0: 2020 2020 2020 290a 2020 2020 636f 6e74        ).    cont
+00030d00: 726f 6c5f 3220 3d20 2869 6e69 745f 706f  rol_2 = (init_po
+00030d10: 735b 305d 202b 2063 686f 6963 6528 282d  s[0] + choice((-
+00030d20: 312c 2031 2929 202a 2061 6273 2863 6569  1, 1)) * abs(cei
+00030d30: 6c28 6669 6e5f 706f 735b 305d 2920 2d20  l(fin_pos[0]) - 
+00030d40: 6365 696c 2869 6e69 745f 706f 735b 305d  ceil(init_pos[0]
+00030d50: 2929 202a 2030 2e30 3120 2a20 7261 6e64  )) * 0.01 * rand
+00030d60: 696e 7428 696e 7428 6465 7669 6174 696f  int(int(deviatio
+00030d70: 6e20 2f20 3229 2c20 6465 7669 6174 696f  n / 2), deviatio
+00030d80: 6e29 2c0a 2020 2020 2020 2020 2020 2020  n),.            
+00030d90: 2020 2020 696e 6974 5f70 6f73 5b31 5d20      init_pos[1] 
+00030da0: 2b20 6368 6f69 6365 2828 2d31 2c20 3129  + choice((-1, 1)
+00030db0: 2920 2a20 6162 7328 6365 696c 2866 696e  ) * abs(ceil(fin
+00030dc0: 5f70 6f73 5b31 5d29 202d 2063 6569 6c28  _pos[1]) - ceil(
+00030dd0: 696e 6974 5f70 6f73 5b31 5d29 2920 2a20  init_pos[1])) * 
+00030de0: 302e 3031 202a 2072 616e 6469 6e74 2869  0.01 * randint(i
+00030df0: 6e74 2864 6576 6961 7469 6f6e 202f 2032  nt(deviation / 2
+00030e00: 292c 2064 6576 6961 7469 6f6e 290a 2020  ), deviation).  
+00030e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030e20: 2020 290a 2020 2020 7879 7320 3d20 5b69    ).    xys = [i
+00030e30: 6e69 745f 706f 732c 2063 6f6e 7472 6f6c  nit_pos, control
+00030e40: 5f31 2c20 636f 6e74 726f 6c5f 322c 2066  _1, control_2, f
+00030e50: 696e 5f70 6f73 5d0a 2020 2020 6465 6620  in_pos].    def 
+00030e60: 6d61 6b65 5f62 657a 6965 7228 7879 7329  make_bezier(xys)
+00030e70: 3a0a 2020 2020 2020 2020 2320 7879 7320  :.        # xys 
+00030e80: 7368 6f75 6c64 2062 6520 6120 7365 7175  should be a sequ
+00030e90: 656e 6365 206f 6620 322d 7475 706c 6573  ence of 2-tuples
+00030ea0: 2028 4265 7a69 6572 2063 6f6e 7472 6f6c   (Bezier control
+00030eb0: 2070 6f69 6e74 7329 0a20 2020 2020 2020   points).       
+00030ec0: 2064 6566 2070 6173 6361 6c5f 726f 7728   def pascal_row(
+00030ed0: 6e29 3a0a 2020 2020 2020 2020 2020 2020  n):.            
+00030ee0: 2320 5468 6973 2072 6574 7572 6e73 2074  # This returns t
+00030ef0: 6865 206e 7468 2072 6f77 206f 6620 5061  he nth row of Pa
+00030f00: 7363 616c 2773 2054 7269 616e 676c 650a  scal's Triangle.
+00030f10: 2020 2020 2020 2020 2020 2020 7265 7375              resu
+00030f20: 6c74 203d 205b 315d 0a20 2020 2020 2020  lt = [1].       
+00030f30: 2020 2020 2078 2c20 6e75 6d65 7261 746f       x, numerato
+00030f40: 7220 3d20 312c 206e 0a20 2020 2020 2020  r = 1, n.       
+00030f50: 2020 2020 2066 6f72 2064 656e 6f6d 696e       for denomin
+00030f60: 6174 6f72 2069 6e20 7261 6e67 6528 312c  ator in range(1,
+00030f70: 206e 2f2f 322b 3129 3a0a 2020 2020 2020   n//2+1):.      
+00030f80: 2020 2020 2020 2020 2020 2320 7072 696e            # prin
+00030f90: 7428 6e75 6d65 7261 746f 722c 6465 6e6f  t(numerator,deno
+00030fa0: 6d69 6e61 746f 722c 7829 0a20 2020 2020  minator,x).     
+00030fb0: 2020 2020 2020 2020 2020 2078 202a 3d20             x *= 
+00030fc0: 6e75 6d65 7261 746f 720a 2020 2020 2020  numerator.      
+00030fd0: 2020 2020 2020 2020 2020 7820 2f3d 2064            x /= d
+00030fe0: 656e 6f6d 696e 6174 6f72 0a20 2020 2020  enominator.     
+00030ff0: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+00031000: 742e 6170 7065 6e64 2878 290a 2020 2020  t.append(x).    
+00031010: 2020 2020 2020 2020 2020 2020 6e75 6d65              nume
+00031020: 7261 746f 7220 2d3d 2031 0a20 2020 2020  rator -= 1.     
+00031030: 2020 2020 2020 2069 6620 6e26 3120 3d3d         if n&1 ==
+00031040: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+00031050: 2020 2020 2320 6e20 6973 2065 7665 6e0a      # n is even.
+00031060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031070: 7265 7375 6c74 2e65 7874 656e 6428 7265  result.extend(re
+00031080: 7665 7273 6564 2872 6573 756c 745b 3a2d  versed(result[:-
+00031090: 315d 2929 0a20 2020 2020 2020 2020 2020  1])).           
+000310a0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+000310b0: 2020 2020 2020 2072 6573 756c 742e 6578         result.ex
+000310c0: 7465 6e64 2872 6576 6572 7365 6428 7265  tend(reversed(re
+000310d0: 7375 6c74 2929 200a 2020 2020 2020 2020  sult)) .        
+000310e0: 2020 2020 7265 7475 726e 2072 6573 756c      return resul
+000310f0: 740a 2020 2020 2020 2020 6e20 3d20 6c65  t.        n = le
+00031100: 6e28 7879 7329 0a20 2020 2020 2020 2063  n(xys).        c
+00031110: 6f6d 6269 6e61 7469 6f6e 7320 3d20 7061  ombinations = pa
+00031120: 7363 616c 5f72 6f77 286e 202d 2031 290a  scal_row(n - 1).
+00031130: 2020 2020 2020 2020 6465 6620 6265 7a69          def bezi
+00031140: 6572 2874 7329 3a0a 2020 2020 2020 2020  er(ts):.        
+00031150: 2020 2020 2320 5468 6973 2075 7365 7320      # This uses 
+00031160: 7468 6520 6765 6e65 7261 6c69 7a65 6420  the generalized 
+00031170: 666f 726d 756c 6120 666f 7220 6265 7a69  formula for bezi
+00031180: 6572 2063 7572 7665 730a 2020 2020 2020  er curves.      
+00031190: 2020 2020 2020 2320 6874 7470 3a2f 2f65        # http://e
+000311a0: 6e2e 7769 6b69 7065 6469 612e 6f72 672f  n.wikipedia.org/
+000311b0: 7769 6b69 2f42 2543 3325 4139 7a69 6572  wiki/B%C3%A9zier
+000311c0: 5f63 7572 7665 2347 656e 6572 616c 697a  _curve#Generaliz
+000311d0: 6174 696f 6e0a 2020 2020 2020 2020 2020  ation.          
+000311e0: 2020 7265 7375 6c74 203d 205b 5d0a 2020    result = [].  
+000311f0: 2020 2020 2020 2020 2020 666f 7220 7420            for t 
+00031200: 696e 2074 733a 0a20 2020 2020 2020 2020  in ts:.         
+00031210: 2020 2020 2020 2074 706f 7765 7273 203d         tpowers =
+00031220: 2028 742a 2a69 2066 6f72 2069 2069 6e20   (t**i for i in 
+00031230: 7261 6e67 6528 6e29 290a 2020 2020 2020  range(n)).      
+00031240: 2020 2020 2020 2020 2020 7570 6f77 6572            upower
+00031250: 7320 3d20 7265 7665 7273 6564 285b 2831  s = reversed([(1
+00031260: 2d74 292a 2a69 2066 6f72 2069 2069 6e20  -t)**i for i in 
+00031270: 7261 6e67 6528 6e29 5d29 0a20 2020 2020  range(n)]).     
+00031280: 2020 2020 2020 2020 2020 2063 6f65 6673             coefs
+00031290: 203d 205b 632a 612a 6220 666f 7220 632c   = [c*a*b for c,
+000312a0: 2061 2c20 6220 696e 207a 6970 2863 6f6d   a, b in zip(com
+000312b0: 6269 6e61 7469 6f6e 732c 2074 706f 7765  binations, tpowe
+000312c0: 7273 2c20 7570 6f77 6572 7329 5d0a 2020  rs, upowers)].  
+000312d0: 2020 2020 2020 2020 2020 2020 2020 7265                re
+000312e0: 7375 6c74 2e61 7070 656e 6428 0a20 2020  sult.append(.   
+000312f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031300: 206c 6973 7428 7375 6d28 5b63 6f65 662a   list(sum([coef*
+00031310: 7020 666f 7220 636f 6566 2c20 7020 696e  p for coef, p in
+00031320: 207a 6970 2863 6f65 6673 2c20 7073 295d   zip(coefs, ps)]
+00031330: 2920 666f 7220 7073 2069 6e20 7a69 7028  ) for ps in zip(
+00031340: 2a78 7973 2929 290a 2020 2020 2020 2020  *xys))).        
+00031350: 2020 2020 7265 7475 726e 2072 6573 756c      return resul
+00031360: 740a 2020 2020 2020 2020 7265 7475 726e  t.        return
+00031370: 2062 657a 6965 720a 2020 2020 6265 7a69   bezier.    bezi
+00031380: 6572 203d 206d 616b 655f 6265 7a69 6572  er = make_bezier
+00031390: 2878 7973 290a 2020 2020 6d6f 7573 655f  (xys).    mouse_
+000313a0: 706f 696e 7473 203d 2062 657a 6965 7228  points = bezier(
+000313b0: 7473 290a 2020 2020 2372 6f75 6e64 2066  ts).    #round f
+000313c0: 6c6f 6174 7320 746f 2069 6e74 730a 2020  loats to ints.  
+000313d0: 2020 6d6f 7573 655f 706f 696e 7473 203d    mouse_points =
+000313e0: 205b 5b72 6f75 6e64 2876 2920 666f 7220   [[round(v) for 
+000313f0: 7620 696e 2078 5d20 6966 2074 7970 6528  v in x] if type(
+00031400: 7829 2069 7320 6e6f 7420 7374 7220 656c  x) is not str el
+00031410: 7365 2078 2066 6f72 2078 2069 6e20 6d6f  se x for x in mo
+00031420: 7573 655f 706f 696e 7473 5d0a 2020 2020  use_points].    
+00031430: 7265 7475 726e 206d 6f75 7365 5f70 6f69  return mouse_poi
+00031440: 6e74 730a 0a64 6566 205f 6d6f 7665 2862  nts..def _move(b
+00031450: 2c20 613d 4e6f 6e65 2c20 6465 7669 6174  , a=None, deviat
+00031460: 696f 6e3d 3235 2c20 6465 6c61 793d 322c  ion=25, delay=2,
+00031470: 2072 6174 653d 3130 3030 2c20 6472 6177   rate=1000, draw
+00031480: 3d46 616c 7365 293a 0a20 2020 2027 2727  =False):.    '''
+00031490: 0a20 2020 2047 454e 4552 4154 4520 4245  .    GENERATE BE
+000314a0: 5a49 4552 2043 5552 5645 2050 4f49 4e54  ZIER CURVE POINT
+000314b0: 530a 2020 2020 5461 6b65 7320 6120 2869  S.    Takes a (i
+000314c0: 6e69 745f 706f 732c 2064 6566 6175 6c74  nit_pos, default
+000314d0: 2063 7572 7265 6e74 2070 6f73 6974 696f   current positio
+000314e0: 6e29 202d 2d3e 2062 2028 6669 6e5f 706f  n) --> b (fin_po
+000314f0: 7329 2061 7320 6120 322d 7475 706c 6520  s) as a 2-tuple 
+00031500: 7265 7072 6573 656e 7469 6e67 2078 7920  representing xy 
+00031510: 636f 6f72 6469 6e61 7465 730a 2020 2020  coordinates.    
+00031520: 6465 7669 6174 696f 6e20 2869 6e74 290a  deviation (int).
+00031530: 2020 2020 2020 2020 6465 7669 6174 696f          deviatio
+00031540: 6e20 636f 6e74 726f 6c73 2068 6f77 2073  n controls how s
+00031550: 7472 6169 6768 7420 7468 6520 6c69 6e65  traight the line
+00031560: 7320 6472 6177 6e20 6d79 2074 6865 2063  s drawn my the c
+00031570: 7572 736f 720a 2020 2020 2020 2020 6172  ursor.        ar
+00031580: 652e 205a 6572 6f20 6465 7669 6174 696f  e. Zero deviatio
+00031590: 6e20 6769 7665 7320 7374 7261 6967 6874  n gives straight
+000315a0: 206c 696e 6573 0a20 2020 2020 2020 2041   lines.        A
+000315b0: 6363 7572 6163 7920 6973 2061 2070 6572  ccuracy is a per
+000315c0: 6365 6e74 6167 6520 6f66 2074 6865 2064  centage of the d
+000315d0: 6973 706c 6163 656d 656e 7420 6f66 2074  isplacement of t
+000315e0: 6865 206d 6f75 7365 2066 726f 6d20 706f  he mouse from po
+000315f0: 696e 7420 4120 746f 0a20 2020 2020 2020  int A to.       
+00031600: 2042 2c20 7768 6963 6820 6973 2067 6976   B, which is giv
+00031610: 656e 2061 7320 6d61 7869 6d75 6d20 636f  en as maximum co
+00031620: 6e74 726f 6c20 706f 696e 7420 6465 7669  ntrol point devi
+00031630: 6174 696f 6e2e 0a20 2020 2020 2020 204e  ation..        N
+00031640: 6174 7572 616c 6c79 2c20 6465 7669 6174  aturally, deviat
+00031650: 696f 6e20 6f66 2031 3020 2831 3025 2920  ion of 10 (10%) 
+00031660: 6769 7665 7320 6d61 7869 6d75 6d20 636f  gives maximum co
+00031670: 6e74 726f 6c20 706f 696e 7420 6465 7669  ntrol point devi
+00031680: 6174 696f 6e0a 2020 2020 2020 2020 6f66  ation.        of
+00031690: 2031 3025 206f 6620 6d61 676e 6974 7564   10% of magnitud
+000316a0: 6520 6f66 2064 6973 706c 6163 656d 656e  e of displacemen
+000316b0: 7420 6f66 206d 6f75 7365 2066 726f 6d20  t of mouse from 
+000316c0: 706f 696e 7420 4120 746f 2042 2c20 0a20  point A to B, . 
+000316d0: 2020 2020 2020 2061 6e64 2061 206d 696e         and a min
+000316e0: 696d 756d 206f 6620 3525 2028 696e 7428  imum of 5% (int(
+000316f0: 6465 7669 6174 696f 6e20 2f20 3229 2920  deviation / 2)) 
+00031700: 2020 200a 2020 2020 6465 6c61 793a 2061     .    delay: a
+00031710: 6e20 696e 7420 6d75 6c74 6970 6c69 6572  n int multiplier
+00031720: 2066 6f72 2073 7065 6564 2e20 5468 6520   for speed. The 
+00031730: 6c6f 7765 722c 2074 6865 2066 6173 7465  lower, the faste
+00031740: 722e 2031 2069 7320 6661 7374 6573 742e  r. 1 is fastest.
+00031750: 0a20 2020 2072 6174 653a 2061 6e6f 7468  .    rate: anoth
+00031760: 6572 2070 6172 616d 2072 656c 6174 6564  er param related
+00031770: 2074 6f20 7370 6565 642c 2074 6f74 616c   to speed, total
+00031780: 2074 7261 7665 6c20 7469 6d65 2069 6e20   travel time in 
+00031790: 7365 636f 6e64 7320 3d20 6469 7374 616e  seconds = distan
+000317a0: 6365 2f72 6174 652e 2054 6865 2068 6967  ce/rate. The hig
+000317b0: 6865 722c 2074 6865 2066 6173 7465 722e  her, the faster.
+000317c0: 0a20 2020 2064 7261 773a 2062 6f6f 6c65  .    draw: boole
+000317d0: 616e 2064 6563 6964 696e 6720 7768 6574  an deciding whet
+000317e0: 6865 7220 6f72 206e 6f74 2074 6f20 7368  her or not to sh
+000317f0: 6f77 2074 6865 2063 7572 7665 2074 6865  ow the curve the
+00031800: 206d 6f75 7365 206d 616b 6573 0a20 2020   mouse makes.   
+00031810: 2027 2727 0a20 2020 2023 2068 7474 7073   '''.    # https
+00031820: 3a2f 2f67 6974 6875 622e 636f 6d2f 7669  ://github.com/vi
+00031830: 6e63 656e 7462 6176 6974 7a2f 6265 7a6d  ncentbavitz/bezm
+00031840: 6f75 7365 0a20 2020 2023 2073 6565 2061  ouse.    # see a
+00031850: 6c73 6f20 6874 7470 733a 2f2f 7079 6175  lso https://pyau
+00031860: 746f 6775 692e 7265 6164 7468 6564 6f63  togui.readthedoc
+00031870: 732e 696f 2f65 6e2f 6c61 7465 7374 2f6d  s.io/en/latest/m
+00031880: 6f75 7365 2e68 746d 6c23 7477 6565 6e2d  ouse.html#tween-
+00031890: 6561 7369 6e67 2d66 756e 6374 696f 6e73  easing-functions
+000318a0: 0a20 2020 2066 726f 6d20 7469 6d65 2069  .    from time i
+000318b0: 6d70 6f72 7420 736c 6565 700a 2020 2020  mport sleep.    
+000318c0: 6672 6f6d 2050 494c 2069 6d70 6f72 7420  from PIL import 
+000318d0: 496d 6167 650a 2020 2020 6672 6f6d 2072  Image.    from r
+000318e0: 616e 646f 6d20 696d 706f 7274 2072 616e  andom import ran
+000318f0: 6469 6e74 2c20 6368 6f69 6365 0a20 2020  dint, choice.   
+00031900: 2066 726f 6d20 6d61 7468 2069 6d70 6f72   from math impor
+00031910: 7420 6365 696c 2c20 7371 7274 0a20 2020  t ceil, sqrt.   
+00031920: 2066 726f 6d20 7079 6e70 7574 2e6d 6f75   from pynput.mou
+00031930: 7365 2069 6d70 6f72 7420 4275 7474 6f6e  se import Button
+00031940: 2c20 436f 6e74 726f 6c6c 6572 0a20 2020  , Controller.   
+00031950: 206d 6f75 7365 203d 2043 6f6e 7472 6f6c   mouse = Control
+00031960: 6c65 7228 290a 2020 2020 6966 2061 2069  ler().    if a i
+00031970: 7320 4e6f 6e65 3a20 6120 3d20 6d6f 7573  s None: a = mous
+00031980: 652e 706f 7369 7469 6f6e 0a20 2020 2069  e.position.    i
+00031990: 6e69 745f 706f 733d 613b 2066 696e 5f70  nit_pos=a; fin_p
+000319a0: 6f73 3d62 0a20 2020 206d 6f75 7365 5f70  os=b.    mouse_p
+000319b0: 6f69 6e74 733d 5f6d 6f75 7365 2869 6e69  oints=_mouse(ini
+000319c0: 745f 706f 732c 2066 696e 5f70 6f73 2c20  t_pos, fin_pos, 
+000319d0: 6465 7669 6174 696f 6e2c 2064 656c 6179  deviation, delay
+000319e0: 290a 2020 2020 2727 270a 2020 2020 4d6f  ).    '''.    Mo
+000319f0: 7665 7320 6d6f 7573 6520 696e 2061 6363  ves mouse in acc
+00031a00: 6f72 6461 6e63 6520 7769 7468 2061 206c  ordance with a l
+00031a10: 6973 7420 6f66 2070 6f69 6e74 7320 2863  ist of points (c
+00031a20: 6f6e 7469 6e75 6f75 7320 6375 7276 6529  ontinuous curve)
+00031a30: 0a20 2020 206d 6f75 7365 5f70 6f69 6e74  .    mouse_point
+00031a40: 730a 2020 2020 2020 2020 6c69 7374 206f  s.        list o
+00031a50: 6620 322d 7475 706c 6573 206f 7220 6c69  f 2-tuples or li
+00031a60: 7374 7320 6f66 2069 6e74 7320 6f72 2066  sts of ints or f
+00031a70: 6c6f 6174 7320 7265 7072 6573 656e 7469  loats representi
+00031a80: 6e67 2078 7920 636f 6f72 6473 0a20 2020  ng xy coords.   
+00031a90: 2064 7261 770a 2020 2020 2020 2020 6120   draw.        a 
+00031aa0: 626f 6f6c 6561 6e20 6465 6369 6469 6e67  boolean deciding
+00031ab0: 2077 6865 7468 6572 206f 7220 6e6f 7420   whether or not 
+00031ac0: 746f 2073 686f 7720 7468 6520 6375 7276  to show the curv
+00031ad0: 6520 7468 6520 6d6f 7573 6520 6d61 6b65  e the mouse make
+00031ae0: 730a 2020 2020 2727 270a 2020 2020 6966  s.    '''.    if
+00031af0: 2064 7261 7720 3d3d 2054 7275 653a 0a20   draw == True:. 
+00031b00: 2020 2020 2020 2052 454c 5f4f 5249 4749         REL_ORIGI
+00031b10: 4e3d 5b30 2c30 5d0a 2020 2020 2020 2020  N=[0,0].        
+00031b20: 6472 6177 706f 696e 7473 203d 205b 2876  drawpoints = [(v
+00031b30: 5b30 5d20 2d20 5245 4c5f 4f52 4947 494e  [0] - REL_ORIGIN
+00031b40: 5b30 5d2c 2076 5b31 5d20 2d20 5245 4c5f  [0], v[1] - REL_
+00031b50: 4f52 4947 494e 5b31 5d29 2066 6f72 2076  ORIGIN[1]) for v
+00031b60: 2069 6e20 6d6f 7573 655f 706f 696e 7473   in mouse_points
+00031b70: 2069 6620 7479 7065 2876 2920 6973 206e   if type(v) is n
+00031b80: 6f74 2073 7472 5d0a 2020 2020 2020 2020  ot str].        
+00031b90: 6672 6f6d 2050 494c 2069 6d70 6f72 7420  from PIL import 
+00031ba0: 496d 6167 6547 7261 620a 2020 2020 2020  ImageGrab.      
+00031bb0: 2020 696d 6720 3d20 496d 6167 6547 7261    img = ImageGra
+00031bc0: 622e 6772 6162 2829 0a20 2020 2020 2020  b.grab().       
+00031bd0: 2077 6964 7468 5f70 782c 2068 6569 6768   width_px, heigh
+00031be0: 745f 7078 203d 2069 6d67 2e73 697a 6520  t_px = img.size 
+00031bf0: 2023 2070 7269 6d61 7279 2073 6372 6565   # primary scree
+00031c00: 6e20 7369 7a65 0a20 2020 2020 2020 2064  n size.        d
+00031c10: 6566 2064 7261 775f 706f 696e 7473 2870  ef draw_points(p
+00031c20: 6f69 6e74 732c 2077 6964 7468 3d77 6964  oints, width=wid
+00031c30: 7468 5f70 782c 2068 6569 6768 743d 6865  th_px, height=he
+00031c40: 6967 6874 5f70 7829 3a0a 2020 2020 2020  ight_px):.      
+00031c50: 2020 2020 2020 2727 270a 2020 2020 2020        '''.      
+00031c60: 2020 2020 2020 4472 6177 7320 7965 6c6c        Draws yell
+00031c70: 6f77 2063 726f 7373 6573 2074 6f20 6120  ow crosses to a 
+00031c80: 696d 6167 6520 666f 7220 616c 6c20 636f  image for all co
+00031c90: 6f72 6469 6e61 7465 7320 696e 2022 706f  ordinates in "po
+00031ca0: 696e 7473 220a 2020 2020 2020 2020 2020  ints".          
+00031cb0: 2020 7368 6f77 2074 6865 2069 6d61 6765    show the image
+00031cc0: 0a20 2020 2020 2020 2020 2020 2027 2727  .            '''
+00031cd0: 0a20 2020 2020 2020 2020 2020 2069 6d67  .            img
+00031ce0: 203d 2049 6d61 6765 2e6e 6577 2822 5247   = Image.new("RG
+00031cf0: 4222 2c20 2877 6964 7468 2c20 6865 6967  B", (width, heig
+00031d00: 6874 2929 0a20 2020 2020 2020 2020 2020  ht)).           
+00031d10: 2070 6978 203d 2069 6d67 2e6c 6f61 6428   pix = img.load(
+00031d20: 290a 2020 2020 2020 2020 2020 2020 7472  ).            tr
+00031d30: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
+00031d40: 2020 2066 6f72 2063 6f6f 7264 7320 696e     for coords in
+00031d50: 2070 6f69 6e74 733a 0a20 2020 2020 2020   points:.       
+00031d60: 2020 2020 2020 2020 2020 2020 2070 6978               pix
+00031d70: 5b63 6f6f 7264 735b 305d 2c20 636f 6f72  [coords[0], coor
+00031d80: 6473 5b31 5d5d 203d 2028 3235 352c 2032  ds[1]] = (255, 2
+00031d90: 3535 2c20 3029 0a20 2020 2020 2020 2020  55, 0).         
+00031da0: 2020 2020 2020 2020 2020 2070 6978 5b63             pix[c
+00031db0: 6f6f 7264 735b 305d 202b 2031 2c20 636f  oords[0] + 1, co
+00031dc0: 6f72 6473 5b31 5d20 2b20 315d 203d 2028  ords[1] + 1] = (
+00031dd0: 3235 352c 2032 3535 2c20 3029 0a20 2020  255, 255, 0).   
+00031de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031df0: 2070 6978 5b63 6f6f 7264 735b 305d 202b   pix[coords[0] +
+00031e00: 2031 2c20 636f 6f72 6473 5b31 5d20 2d20   1, coords[1] - 
+00031e10: 315d 203d 2028 3235 352c 2032 3535 2c20  1] = (255, 255, 
+00031e20: 3029 0a20 2020 2020 2020 2020 2020 2020  0).             
+00031e30: 2020 2020 2020 2070 6978 5b63 6f6f 7264         pix[coord
+00031e40: 735b 305d 202d 2031 2c20 636f 6f72 6473  s[0] - 1, coords
+00031e50: 5b31 5d20 2b20 315d 203d 2028 3235 352c  [1] + 1] = (255,
+00031e60: 2032 3535 2c20 3029 0a20 2020 2020 2020   255, 0).       
+00031e70: 2020 2020 2020 2020 2020 2020 2070 6978               pix
+00031e80: 5b63 6f6f 7264 735b 305d 202d 2031 2c20  [coords[0] - 1, 
+00031e90: 636f 6f72 6473 5b31 5d20 2d20 315d 203d  coords[1] - 1] =
+00031ea0: 2028 3235 352c 2032 3535 2c20 3029 0a20   (255, 255, 0). 
+00031eb0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00031ec0: 6d67 2e73 686f 7728 290a 2020 2020 2020  mg.show().      
+00031ed0: 2020 2020 2020 6578 6365 7074 3a0a 2020        except:.  
+00031ee0: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+00031ef0: 7373 0a20 2020 2020 2020 2064 7261 775f  ss.        draw_
+00031f00: 706f 696e 7473 2864 7261 7770 6f69 6e74  points(drawpoint
+00031f10: 7329 2020 2020 0a20 2020 2064 6973 7461  s)    .    dista
+00031f20: 6e63 653d 7371 7274 2828 625b 305d 2d61  nce=sqrt((b[0]-a
+00031f30: 5b30 5d29 2a2a 322b 2862 5b31 5d2d 615b  [0])**2+(b[1]-a[
+00031f40: 315d 292a 2a32 290a 2020 2020 6475 7261  1])**2).    dura
+00031f50: 7469 6f6e 3d64 6973 7461 6e63 652f 7261  tion=distance/ra
+00031f60: 7465 0a20 2020 2066 6f72 2063 6f6f 7264  te.    for coord
+00031f70: 2069 6e20 6d6f 7573 655f 706f 696e 7473   in mouse_points
+00031f80: 3a0a 2020 2020 2020 2020 736c 6565 7028  :.        sleep(
+00031f90: 6475 7261 7469 6f6e 2f6c 656e 286d 6f75  duration/len(mou
+00031fa0: 7365 5f70 6f69 6e74 7329 290a 2020 2020  se_points)).    
+00031fb0: 2020 2020 6d6f 7573 652e 706f 7369 7469      mouse.positi
+00031fc0: 6f6e 3d63 6f6f 7264 0a0a 6465 6620 6d6f  on=coord..def mo
+00031fd0: 7665 636c 6963 6b28 6c6f 6361 7469 6f6e  veclick(location
+00031fe0: 2c20 7261 6469 7573 3d35 2c20 6e3d 322c  , radius=5, n=2,
+00031ff0: 2077 6169 743d 302e 3235 2c20 6465 7669   wait=0.25, devi
+00032000: 6174 696f 6e3d 3235 2c20 6465 6c61 793d  ation=25, delay=
+00032010: 322c 2072 6174 653d 3130 3030 2c20 6472  2, rate=1000, dr
+00032020: 6177 3d46 616c 7365 2c20 2a61 7267 732c  aw=False, *args,
+00032030: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
+00032040: 2727 270a 2020 2020 6c6f 6361 7469 6f6e  '''.    location
+00032050: 3a20 2878 2c79 2920 6f72 205b 782c 795d  : (x,y) or [x,y]
+00032060: 2c20 5b78 2c79 2c77 2c68 2c70 5d20 6f72  , [x,y,w,h,p] or
+00032070: 205b 782c 792c 772c 685d 0a20 2020 2072   [x,y,w,h].    r
+00032080: 6164 6975 733a 2077 6f72 6b73 206f 6e6c  adius: works onl
+00032090: 7920 6966 206c 6f63 6174 696f 6e20 6973  y if location is
+000320a0: 2061 6e20 6172 6561 2e20 6966 2061 6e20   an area. if an 
+000320b0: 6172 6561 2069 7320 3130 302a 3130 3020  area is 100*100 
+000320c0: 7769 7468 2061 6e20 7261 6469 7573 206f  with an radius o
+000320d0: 6620 3520 6974 206d 6179 2062 6520 6174  f 5 it may be at
+000320e0: 2034 362c 3530 2074 6865 2066 6972 7374   46,50 the first
+000320f0: 2074 696d 6520 616e 6420 7468 656e 2035   time and then 5
+00032100: 352c 3533 2065 7463 0a20 2020 2077 6169  5,53 etc.    wai
+00032110: 743a 2073 6563 6f6e 6473 2062 6566 6f72  t: seconds befor
+00032120: 6520 636c 6963 6b20 6166 7465 7220 6d6f  e click after mo
+00032130: 7665 2074 6f20 7468 6520 6c6f 6361 7469  ve to the locati
+00032140: 6f6e 0a20 2020 2064 6576 6961 7469 6f6e  on.    deviation
+00032150: 2028 696e 7429 0a20 2020 2020 2020 2064   (int).        d
+00032160: 6576 6961 7469 6f6e 2063 6f6e 7472 6f6c  eviation control
+00032170: 7320 686f 7720 7374 7261 6967 6874 2074  s how straight t
+00032180: 6865 206c 696e 6573 2064 7261 776e 206d  he lines drawn m
+00032190: 7920 7468 6520 6375 7273 6f72 0a20 2020  y the cursor.   
+000321a0: 2020 2020 2061 7265 2e20 5a65 726f 2064       are. Zero d
+000321b0: 6576 6961 7469 6f6e 2067 6976 6573 2073  eviation gives s
+000321c0: 7472 6169 6768 7420 6c69 6e65 730a 2020  traight lines.  
+000321d0: 2020 2020 2020 4163 6375 7261 6379 2069        Accuracy i
+000321e0: 7320 6120 7065 7263 656e 7461 6765 206f  s a percentage o
+000321f0: 6620 7468 6520 6469 7370 6c61 6365 6d65  f the displaceme
+00032200: 6e74 206f 6620 7468 6520 6d6f 7573 6520  nt of the mouse 
+00032210: 6672 6f6d 2070 6f69 6e74 2041 2074 6f0a  from point A to.
+00032220: 2020 2020 2020 2020 422c 2077 6869 6368          B, which
+00032230: 2069 7320 6769 7665 6e20 6173 206d 6178   is given as max
+00032240: 696d 756d 2063 6f6e 7472 6f6c 2070 6f69  imum control poi
+00032250: 6e74 2064 6576 6961 7469 6f6e 2e0a 2020  nt deviation..  
+00032260: 2020 2020 2020 4e61 7475 7261 6c6c 792c        Naturally,
+00032270: 2064 6576 6961 7469 6f6e 206f 6620 3130   deviation of 10
+00032280: 2028 3130 2529 2067 6976 6573 206d 6178   (10%) gives max
+00032290: 696d 756d 2063 6f6e 7472 6f6c 2070 6f69  imum control poi
+000322a0: 6e74 2064 6576 6961 7469 6f6e 0a20 2020  nt deviation.   
+000322b0: 2020 2020 206f 6620 3130 2520 6f66 206d       of 10% of m
+000322c0: 6167 6e69 7475 6465 206f 6620 6469 7370  agnitude of disp
+000322d0: 6c61 6365 6d65 6e74 206f 6620 6d6f 7573  lacement of mous
+000322e0: 6520 6672 6f6d 2070 6f69 6e74 2041 2074  e from point A t
+000322f0: 6f20 422c 200a 2020 2020 2020 2020 616e  o B, .        an
+00032300: 6420 6120 6d69 6e69 6d75 6d20 6f66 2035  d a minimum of 5
+00032310: 2520 2869 6e74 2864 6576 6961 7469 6f6e  % (int(deviation
+00032320: 202f 2032 2929 2020 2020 0a20 2020 2064   / 2))    .    d
+00032330: 656c 6179 3a20 616e 2069 6e74 206d 756c  elay: an int mul
+00032340: 7469 706c 6965 7220 666f 7220 7370 6565  tiplier for spee
+00032350: 642e 2054 6865 206c 6f77 6572 2c20 7468  d. The lower, th
+00032360: 6520 6661 7374 6572 2e20 3120 6973 2066  e faster. 1 is f
+00032370: 6173 7465 7374 2e0a 2020 2020 7261 7465  astest..    rate
+00032380: 3a20 616e 6f74 6865 7220 7061 7261 6d20  : another param 
+00032390: 7265 6c61 7465 6420 746f 2073 7065 6564  related to speed
+000323a0: 2c20 746f 7461 6c20 7472 6176 656c 2074  , total travel t
+000323b0: 696d 6520 696e 2073 6563 6f6e 6473 203d  ime in seconds =
+000323c0: 2064 6973 7461 6e63 652f 7261 7465 2e20   distance/rate. 
+000323d0: 5468 6520 6869 6768 6572 2c20 7468 6520  The higher, the 
+000323e0: 6661 7374 6572 2e0a 2020 2020 6472 6177  faster..    draw
+000323f0: 3a20 626f 6f6c 6561 6e20 6465 6369 6469  : boolean decidi
+00032400: 6e67 2077 6865 7468 6572 206f 7220 6e6f  ng whether or no
+00032410: 7420 746f 2073 686f 7720 7468 6520 6375  t to show the cu
+00032420: 7276 6520 7468 6520 6d6f 7573 6520 6d61  rve the mouse ma
+00032430: 6b65 730a 2020 2020 2727 270a 2020 2020  kes.    '''.    
+00032440: 6672 6f6d 2072 616e 646f 6d20 696d 706f  from random impo
+00032450: 7274 2072 616e 6469 6e74 0a20 2020 2069  rt randint.    i
+00032460: 6620 6c65 6e28 6c6f 6361 7469 6f6e 293d  f len(location)=
+00032470: 3d32 3a0a 2020 2020 2020 2020 7878 2c79  =2:.        xx,y
+00032480: 793d 6c6f 6361 7469 6f6e 5b30 5d2c 6c6f  y=location[0],lo
+00032490: 6361 7469 6f6e 5b31 5d0a 2020 2020 656c  cation[1].    el
+000324a0: 7365 3a0a 2020 2020 2020 2020 782c 792c  se:.        x,y,
+000324b0: 772c 683d 6c6f 6361 7469 6f6e 5b30 5d2c  w,h=location[0],
+000324c0: 6c6f 6361 7469 6f6e 5b31 5d2c 6c6f 6361  location[1],loca
+000324d0: 7469 6f6e 5b32 5d2c 6c6f 6361 7469 6f6e  tion[2],location
+000324e0: 5b33 5d0a 2020 2020 2020 2020 7878 203d  [3].        xx =
+000324f0: 2078 202b 2072 616e 6469 6e74 2869 6e74   x + randint(int
+00032500: 2877 2f32 2d72 6164 6975 7329 2c20 696e  (w/2-radius), in
+00032510: 7428 772f 322b 7261 6469 7573 2929 0a20  t(w/2+radius)). 
+00032520: 2020 2020 2020 2079 7920 3d20 7920 2b20         yy = y + 
+00032530: 7261 6e64 696e 7428 696e 7428 682f 322d  randint(int(h/2-
+00032540: 7261 6469 7573 292c 2069 6e74 2868 2f32  radius), int(h/2
+00032550: 2b72 6164 6975 7329 290a 2020 2020 5f6d  +radius)).    _m
+00032560: 6f76 6528 2878 782c 2079 7929 2c20 613d  ove((xx, yy), a=
+00032570: 4e6f 6e65 2c20 6465 7669 6174 696f 6e3d  None, deviation=
+00032580: 6465 7669 6174 696f 6e2c 2064 656c 6179  deviation, delay
+00032590: 3d64 656c 6179 2c20 7261 7465 3d72 6174  =delay, rate=rat
+000325a0: 652c 2064 7261 773d 6472 6177 2c20 2a61  e, draw=draw, *a
+000325b0: 7267 732c 202a 2a6b 7761 7267 7329 0a20  rgs, **kwargs). 
+000325c0: 2020 2069 6d70 6f72 7420 7469 6d65 0a20     import time. 
+000325d0: 2020 2074 696d 652e 736c 6565 7028 7761     time.sleep(wa
+000325e0: 6974 290a 2020 2020 6672 6f6d 2070 796e  it).    from pyn
+000325f0: 7075 742e 6d6f 7573 6520 696d 706f 7274  put.mouse import
+00032600: 2042 7574 746f 6e2c 2043 6f6e 7472 6f6c   Button, Control
+00032610: 6c65 720a 2020 2020 6d6f 7573 6520 3d20  ler.    mouse = 
+00032620: 436f 6e74 726f 6c6c 6572 2829 0a20 2020  Controller().   
+00032630: 206d 6f75 7365 2e63 6c69 636b 2842 7574   mouse.click(But
+00032640: 746f 6e2e 6c65 6674 2c20 6e29 0a0a 6465  ton.left, n)..de
+00032650: 6620 636c 6963 6b28 6e3d 3229 3a0a 2020  f click(n=2):.  
+00032660: 2020 6672 6f6d 2070 796e 7075 742e 6d6f    from pynput.mo
+00032670: 7573 6520 696d 706f 7274 2042 7574 746f  use import Butto
+00032680: 6e2c 2043 6f6e 7472 6f6c 6c65 720a 2020  n, Controller.  
+00032690: 2020 6d6f 7573 6520 3d20 436f 6e74 726f    mouse = Contro
+000326a0: 6c6c 6572 2829 0a20 2020 206d 6f75 7365  ller().    mouse
+000326b0: 2e63 6c69 636b 2842 7574 746f 6e2e 6c65  .click(Button.le
+000326c0: 6674 2c20 6e29 0a0a 6465 6620 7263 6c69  ft, n)..def rcli
+000326d0: 636b 286e 3d31 293a 0a20 2020 2066 726f  ck(n=1):.    fro
+000326e0: 6d20 7079 6e70 7574 2e6d 6f75 7365 2069  m pynput.mouse i
+000326f0: 6d70 6f72 7420 4275 7474 6f6e 2c20 436f  mport Button, Co
+00032700: 6e74 726f 6c6c 6572 0a20 2020 206d 6f75  ntroller.    mou
+00032710: 7365 203d 2043 6f6e 7472 6f6c 6c65 7228  se = Controller(
+00032720: 290a 2020 2020 6d6f 7573 652e 636c 6963  ).    mouse.clic
+00032730: 6b28 4275 7474 6f6e 2e72 6967 6874 2c20  k(Button.right, 
+00032740: 6e29 0a0a 6465 6620 7363 726f 6c6c 2864  n)..def scroll(d
+00032750: 782c 6479 293a 0a20 2020 2066 726f 6d20  x,dy):.    from 
+00032760: 7079 6e70 7574 2e6d 6f75 7365 2069 6d70  pynput.mouse imp
+00032770: 6f72 7420 4275 7474 6f6e 2c20 436f 6e74  ort Button, Cont
+00032780: 726f 6c6c 6572 0a20 2020 206d 6f75 7365  roller.    mouse
+00032790: 203d 2043 6f6e 7472 6f6c 6c65 7228 290a   = Controller().
+000327a0: 2020 2020 6d6f 7573 652e 7363 726f 6c6c      mouse.scroll
+000327b0: 2864 782c 2064 7929 0a0a 6465 6620 706f  (dx, dy)..def po
+000327c0: 7369 7469 6f6e 2829 3a0a 2020 2020 6672  sition():.    fr
+000327d0: 6f6d 2070 796e 7075 742e 6d6f 7573 6520  om pynput.mouse 
+000327e0: 696d 706f 7274 2042 7574 746f 6e2c 2043  import Button, C
+000327f0: 6f6e 7472 6f6c 6c65 720a 2020 2020 6d6f  ontroller.    mo
+00032800: 7573 6520 3d20 436f 6e74 726f 6c6c 6572  use = Controller
+00032810: 2829 0a20 2020 2072 6574 7572 6e20 6d6f  ().    return mo
+00032820: 7573 652e 706f 7369 7469 6f6e 0a0a 6465  use.position..de
+00032830: 6620 7369 7a65 2829 3a0a 2020 2020 2320  f size():.    # 
+00032840: 6874 7470 733a 2f2f 7374 6163 6b6f 7665  https://stackove
+00032850: 7266 6c6f 772e 636f 6d2f 7175 6573 7469  rflow.com/questi
+00032860: 6f6e 732f 3331 3239 3332 322f 0a20 2020  ons/3129322/.   
+00032870: 206d 6d5f 7065 725f 696e 6368 203d 2032   mm_per_inch = 2
+00032880: 352e 340a 2020 2020 7078 5f70 6572 5f69  5.4.    px_per_i
+00032890: 6e63 6820 3d20 2037 322e 3020 236d 6f73  nch =  72.0 #mos
+000328a0: 7420 636f 6d6d 6f6e 0a20 2020 2069 6d70  t common.    imp
+000328b0: 6f72 7420 6d73 730a 2020 2020 7363 743d  ort mss.    sct=
+000328c0: 6d73 732e 6d73 7328 290a 2020 2020 7265  mss.mss().    re
+000328d0: 7475 726e 2073 6374 2e6d 6f6e 6974 6f72  turn sct.monitor
+000328e0: 730a 0a23 2323 232a 2a2a 2a2a 2a2a 2a2a  s..####*********
 000328f0: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
 00032900: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
 00032910: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
 00032920: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
 00032930: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
-00032940: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 0a20 2020  ************.   
+00032940: 2a2a 2a2a 2a2a 2a0a 2020 2020 2020 2020  *******.        
 00032950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032970: 2020 2323 2323 2a47 5368 6565 742a 2323    ####*GSheet*##
-00032980: 2323 0a23 2323 232a 2a2a 2a2a 2a2a 2a2a  ##.####*********
+00032960: 2020 2020 2020 2020 2020 2020 2023 2323               ###
+00032970: 232a 4753 6865 6574 2a23 2323 230a 2323  #*GSheet*####.##
+00032980: 2323 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ##**************
 00032990: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
 000329a0: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
 000329b0: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
 000329c0: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
 000329d0: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
-000329e0: 2a2a 2a2a 2a2a 2a0a 2320 7468 6520 6669  *******.# the fi
-000329f0: 7273 7420 706c 6163 6520 746f 2063 6865  rst place to che
-00032a00: 636b 2061 7574 686f 7269 7a61 7469 6f6e  ck authorization
-00032a10: 2069 7320 676f 2074 6f20 7468 6520 666f   is go to the fo
-00032a20: 6c6c 6f77 696e 6720 6773 7072 6561 6420  llowing gspread 
-00032a30: 6c69 6e6b 3a0a 2320 6874 7470 733a 2f2f  link:.# https://
-00032a40: 6773 7072 6561 642e 7265 6164 7468 6564  gspread.readthed
-00032a50: 6f63 732e 696f 2f65 6e2f 6c61 7465 7374  ocs.io/en/latest
-00032a60: 2f6f 6175 7468 322e 6874 6d6c 2365 6e61  /oauth2.html#ena
-00032a70: 626c 652d 6170 692d 6163 6365 7373 0a23  ble-api-access.#
-00032a80: 206d 7573 7420 6772 616e 7420 7065 726d   must grant perm
-00032a90: 6973 7369 6f6e 2074 6f20 7365 7276 6963  ission to servic
-00032aa0: 6520 6163 636f 756e 7420 2870 7973 6865  e account (pyshe
-00032ab0: 6574 4070 7974 686f 6e2d 3234 3337 3230  et@python-243720
-00032ac0: 2e69 616d 2e67 7365 7276 6963 6561 6363  .iam.gserviceacc
-00032ad0: 6f75 6e74 2e63 6f6d 2920 0a23 2061 7320  ount.com) .# as 
-00032ae0: 6564 6974 6f72 206f 6620 6561 6368 2069  editor of each i
-00032af0: 6e64 6976 6964 7561 6c20 676f 6f67 6c65  ndividual google
-00032b00: 2073 6865 6574 206d 616e 6e75 616c 6c79   sheet mannually
-00032b10: 0a63 6c61 7373 2047 5368 6565 7428 293a  .class GSheet():
-00032b20: 0a20 2020 2022 2222 0a20 2020 202e 7773  .    """.    .ws
-00032b30: 2028 776f 726b 7368 6565 7429 2c20 2e77   (worksheet), .w
-00032b40: 6220 2877 6f72 6b62 6f6f 6b29 2072 6574  b (workbook) ret
-00032b50: 7572 6e20 7468 6520 6f72 6769 6e61 6c20  urn the orginal 
-00032b60: 676f 6f67 6c65 2073 6865 6574 2f73 6865  google sheet/she
-00032b70: 6574 7320 6f62 6a65 6374 730a 2020 2020  ets objects.    
-00032b80: 2222 220a 2020 2020 6465 6620 5f5f 696e  """.    def __in
-00032b90: 6974 5f5f 2873 656c 662c 7572 6c2c 7368  it__(self,url,sh
-00032ba0: 6565 745f 6e61 6d65 3d4e 6f6e 6529 3a0a  eet_name=None):.
-00032bb0: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
-00032bc0: 2020 2020 2020 2020 2069 6d70 6f72 7420           import 
-00032bd0: 6773 7072 6561 640a 2020 2020 2020 2020  gspread.        
-00032be0: 2020 2020 2320 6e6f 7420 7375 7265 2077      # not sure w
-00032bf0: 6865 7265 2049 2067 6f74 2074 6865 7365  here I got these
-00032c00: 206a 736f 6e20 6669 6c65 2028 6d61 7962   json file (mayb
-00032c10: 6520 646f 776e 6c6f 6164 6564 2066 726f  e downloaded fro
-00032c20: 6d20 676f 6f67 6c65 3f29 0a20 2020 2020  m google?).     
-00032c30: 2020 2020 2020 2063 6c69 656e 7420 3d20         client = 
-00032c40: 6773 7072 6561 642e 7365 7276 6963 655f  gspread.service_
-00032c50: 6163 636f 756e 745f 6672 6f6d 5f64 6963  account_from_dic
-00032c60: 7428 4753 4845 4554 5f4b 4559 290a 2020  t(GSHEET_KEY).  
-00032c70: 2020 2020 2020 6578 6365 7074 3a0a 2020        except:.  
-00032c80: 2020 2020 2020 2020 2020 7061 7373 0a0a            pass..
-00032c90: 2020 2020 2020 2020 7368 6565 7473 203d          sheets =
-00032ca0: 2063 6c69 656e 742e 6f70 656e 5f62 795f   client.open_by_
-00032cb0: 7572 6c28 7572 6c29 0a20 2020 2020 2020  url(url).       
-00032cc0: 2069 6620 7368 6565 745f 6e61 6d65 2069   if sheet_name i
-00032cd0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-00032ce0: 2020 2020 7368 6565 7420 3d20 7368 6565      sheet = shee
-00032cf0: 7473 2e73 6865 6574 310a 2020 2020 2020  ts.sheet1.      
-00032d00: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00032d10: 2020 2020 7368 6565 7420 3d20 7368 6565      sheet = shee
-00032d20: 7473 2e77 6f72 6b73 6865 6574 2873 6865  ts.worksheet(she
-00032d30: 6574 5f6e 616d 6529 0a20 2020 2020 2020  et_name).       
-00032d40: 2073 656c 662e 7762 203d 2073 6865 6574   self.wb = sheet
-00032d50: 730a 2020 2020 2020 2020 7365 6c66 2e77  s.        self.w
-00032d60: 7320 3d20 7368 6565 740a 0a20 2020 2040  s = sheet..    @
-00032d70: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-00032d80: 2074 6974 6c65 2873 656c 6629 3a0a 2020   title(self):.  
-00032d90: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00032da0: 662e 7773 2e74 6974 6c65 0a20 2020 200a  f.ws.title.    .
-00032db0: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-00032dc0: 2020 6465 6620 7572 6c28 7365 6c66 293a    def url(self):
-00032dd0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00032de0: 7365 6c66 2e77 732e 7572 6c0a 0a20 2020  self.ws.url..   
-00032df0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-00032e00: 6566 204e 636f 6c28 7365 6c66 293a 0a20  ef Ncol(self):. 
-00032e10: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00032e20: 2020 2070 6879 7369 6361 6c20 6e20 636f     physical n co
-00032e30: 6c2c 206d 6179 2062 6520 626c 616e 6b0a  l, may be blank.
-00032e40: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00032e50: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00032e60: 7773 2e63 6f6c 5f63 6f75 6e74 0a0a 2020  ws.col_count..  
-00032e70: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-00032e80: 6465 6620 4e72 6f77 2873 656c 6629 3a0a  def Nrow(self):.
-00032e90: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00032ea0: 656c 662e 7773 2e72 6f77 5f63 6f75 6e74  elf.ws.row_count
-00032eb0: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-00032ec0: 2020 2020 6465 6620 636f 6c75 6d6e 7328      def columns(
-00032ed0: 7365 6c66 293a 0a20 2020 2020 2020 2074  self):.        t
-00032ee0: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
-00032ef0: 7265 7475 726e 2073 656c 662e 7773 2e72  return self.ws.r
-00032f00: 6f77 5f76 616c 7565 7328 3129 0a20 2020  ow_values(1).   
-00032f10: 2020 2020 2065 7863 6570 743a 0a20 2020       except:.   
-00032f20: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00032f30: 5b5d 0a0a 2020 2020 4070 726f 7065 7274  []..    @propert
-00032f40: 790a 2020 2020 6465 6620 7661 6c75 6573  y.    def values
-00032f50: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00032f60: 2222 2261 7320 6c69 7374 206f 6620 6c69  """as list of li
-00032f70: 7374 2222 220a 2020 2020 2020 2020 7265  st""".        re
-00032f80: 7475 726e 2073 656c 662e 7773 2e67 6574  turn self.ws.get
-00032f90: 5f61 6c6c 5f76 616c 7565 7328 290a 2020  _all_values().  
-00032fa0: 2020 0a20 2020 2040 7072 6f70 6572 7479    .    @property
-00032fb0: 0a20 2020 2064 6566 2072 6563 6f72 6473  .    def records
-00032fc0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00032fd0: 2222 2261 7320 6469 6374 2222 220a 2020  """as dict""".  
-00032fe0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00032ff0: 662e 7773 2e67 6574 5f61 6c6c 5f72 6563  f.ws.get_all_rec
-00033000: 6f72 6473 2829 2020 2020 0a0a 2020 2020  ords()    ..    
-00033010: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-00033020: 6620 6e72 6f77 2873 656c 6629 3a0a 2020  f nrow(self):.  
-00033030: 2020 2020 2020 7661 6c75 6573 203d 2073        values = s
-00033040: 656c 662e 7661 6c75 6573 0a20 2020 2020  elf.values.     
-00033050: 2020 2072 6574 7572 6e20 6c65 6e28 7661     return len(va
-00033060: 6c75 6573 290a 0a20 2020 2040 7072 6f70  lues)..    @prop
-00033070: 6572 7479 0a20 2020 2064 6566 206e 636f  erty.    def nco
-00033080: 6c28 7365 6c66 293a 0a20 2020 2020 2020  l(self):.       
-00033090: 2076 616c 7565 7320 3d20 7365 6c66 2e76   values = self.v
-000330a0: 616c 7565 730a 2020 2020 2020 2020 746d  alues.        tm
-000330b0: 7020 3d20 5b6c 656e 2872 2920 666f 7220  p = [len(r) for 
-000330c0: 7220 696e 2076 616c 7565 735d 0a20 2020  r in values].   
-000330d0: 2020 2020 2069 6620 6c65 6e28 746d 7029       if len(tmp)
-000330e0: 3d3d 303a 0a20 2020 2020 2020 2020 2020  ==0:.           
-000330f0: 2072 6574 7572 6e20 300a 2020 2020 2020   return 0.      
-00033100: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00033110: 2020 2020 696d 706f 7274 206e 756d 7079      import numpy
-00033120: 2061 7320 6e70 0a20 2020 2020 2020 2020   as np.         
-00033130: 2020 2072 6574 7572 6e20 6e70 2e6d 6178     return np.max
-00033140: 2874 6d70 290a 2020 2020 0a20 2020 2064  (tmp).    .    d
-00033150: 6566 2063 6c65 6172 2873 656c 662c 7261  ef clear(self,ra
-00033160: 6e67 6529 3a0a 2020 2020 2020 2020 2320  nge):.        # 
-00033170: 6874 7470 733a 2f2f 6773 7072 6561 642e  https://gspread.
-00033180: 7265 6164 7468 6564 6f63 732e 696f 2f65  readthedocs.io/e
-00033190: 6e2f 6c61 7465 7374 2f61 7069 2e68 746d  n/latest/api.htm
-000331a0: 6c23 6773 7072 6561 642e 6d6f 6465 6c73  l#gspread.models
-000331b0: 2e53 7072 6561 6473 6865 6574 2e76 616c  .Spreadsheet.val
-000331c0: 7565 735f 636c 6561 720a 2020 2020 2020  ues_clear.      
-000331d0: 2020 2320 7368 6565 7473 206d 6574 686f    # sheets metho
-000331e0: 640a 2020 2020 2020 2020 7261 6e67 6520  d.        range 
-000331f0: 3d20 6622 277b 7365 6c66 2e74 6974 6c65  = f"'{self.title
-00033200: 7d27 217b 7261 6e67 657d 220a 2020 2020  }'!{range}".    
-00033210: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00033220: 7762 2e76 616c 7565 735f 636c 6561 7228  wb.values_clear(
-00033230: 7261 6e67 6529 0a0a 2020 2020 6465 6620  range)..    def 
-00033240: 6765 7476 616c 2873 656c 662c 2a61 7267  getval(self,*arg
-00033250: 732c 2a2a 6b77 6172 6773 293a 0a20 2020  s,**kwargs):.   
-00033260: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00033270: 2072 616e 6765 2063 6f75 6c64 2062 6520   range could be 
-00033280: 413a 412c 2032 3a32 0a20 2020 2020 2020  A:A, 2:2.       
-00033290: 2072 6574 7572 6e73 2061 206c 6973 7420   returns a list 
-000332a0: 6f66 206c 6973 740a 2020 2020 2020 2020  of list.        
-000332b0: 2222 220a 2020 2020 2020 2020 2320 6874  """.        # ht
-000332c0: 7470 733a 2f2f 6773 7072 6561 642e 7265  tps://gspread.re
-000332d0: 6164 7468 6564 6f63 732e 696f 2f65 6e2f  adthedocs.io/en/
-000332e0: 6c61 7465 7374 2f61 7069 2e68 746d 6c23  latest/api.html#
-000332f0: 6773 7072 6561 642e 6d6f 6465 6c73 2e57  gspread.models.W
-00033300: 6f72 6b73 6865 6574 2e67 6574 0a20 2020  orksheet.get.   
-00033310: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00033320: 2e77 732e 6765 7428 2a61 7267 732c 202a  .ws.get(*args, *
-00033330: 2a6b 7761 7267 7329 0a20 2020 200a 2020  *kwargs).    .  
-00033340: 2020 6465 6620 6765 7463 2873 656c 662c    def getc(self,
-00033350: 636f 6c2c 2a61 7267 732c 2a2a 6b77 6172  col,*args,**kwar
-00033360: 6773 293a 0a20 2020 2020 2020 2022 2222  gs):.        """
-00033370: 0a20 2020 2020 2020 2063 6f6c 2069 6e74  .        col int
-00033380: 2c20 3120 6261 7365 640a 2020 2020 2020  , 1 based.      
-00033390: 2020 7265 7475 726e 7320 6120 6c69 7374    returns a list
-000333a0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-000333b0: 2020 2020 2023 2068 7474 7073 3a2f 2f67       # https://g
-000333c0: 7370 7265 6164 2e72 6561 6474 6865 646f  spread.readthedo
-000333d0: 6373 2e69 6f2f 656e 2f6c 6174 6573 742f  cs.io/en/latest/
-000333e0: 6170 692e 6874 6d6c 2367 7370 7265 6164  api.html#gspread
-000333f0: 2e6d 6f64 656c 732e 576f 726b 7368 6565  .models.Workshee
-00033400: 742e 6765 740a 2020 2020 2020 2020 7265  t.get.        re
-00033410: 7475 726e 2073 656c 662e 7773 2e63 6f6c  turn self.ws.col
-00033420: 5f76 616c 7565 7328 636f 6c2c 202a 6172  _values(col, *ar
-00033430: 6773 2c20 2a2a 6b77 6172 6773 290a 0a20  gs, **kwargs).. 
-00033440: 2020 2064 6566 2067 6574 7228 7365 6c66     def getr(self
-00033450: 2c72 6f77 2c2a 6172 6773 2c2a 2a6b 7761  ,row,*args,**kwa
-00033460: 7267 7329 3a0a 2020 2020 2020 2020 2222  rgs):.        ""
-00033470: 220a 2020 2020 2020 2020 726f 7720 696e  ".        row in
-00033480: 742c 2031 2062 6173 6564 0a20 2020 2020  t, 1 based.     
-00033490: 2020 2072 6574 7572 6e73 2061 206c 6973     returns a lis
-000334a0: 740a 2020 2020 2020 2020 2222 220a 2020  t.        """.  
-000334b0: 2020 2020 2020 2320 6874 7470 733a 2f2f        # https://
-000334c0: 6773 7072 6561 642e 7265 6164 7468 6564  gspread.readthed
-000334d0: 6f63 732e 696f 2f65 6e2f 6c61 7465 7374  ocs.io/en/latest
-000334e0: 2f61 7069 2e68 746d 6c23 6773 7072 6561  /api.html#gsprea
-000334f0: 642e 6d6f 6465 6c73 2e57 6f72 6b73 6865  d.models.Workshe
-00033500: 6574 2e67 6574 0a20 2020 2020 2020 2072  et.get.        r
-00033510: 6574 7572 6e20 7365 6c66 2e77 732e 726f  eturn self.ws.ro
-00033520: 775f 7661 6c75 6573 2872 6f77 2c20 2a61  w_values(row, *a
-00033530: 7267 732c 202a 2a6b 7761 7267 7329 0a0a  rgs, **kwargs)..
-00033540: 2020 2020 6465 6620 696e 7365 7274 2873      def insert(s
-00033550: 656c 662c 7661 6c75 6573 2c72 6f77 3d31  elf,values,row=1
-00033560: 2c76 616c 7565 5f69 6e70 7574 5f6f 7074  ,value_input_opt
-00033570: 696f 6e3d 2255 5345 525f 454e 5445 5245  ion="USER_ENTERE
-00033580: 4422 293a 0a20 2020 2020 2020 2022 2222  D"):.        """
-00033590: 0a20 2020 2020 2020 2076 616c 7565 7320  .        values 
-000335a0: 286c 6973 7429 20e2 8093 204c 6973 7420  (list) ... List 
-000335b0: 6f66 206c 6973 742e 2065 672c 205b 5b31  of list. eg, [[1
-000335c0: 312c 3132 5d2c 5b32 312c 3232 5d5d 0a20  1,12],[21,22]]. 
-000335d0: 2020 2020 2020 2069 6e64 6578 2028 696e         index (in
-000335e0: 7429 20e2 8093 2053 7461 7274 2072 6f77  t) ... Start row
-000335f0: 2074 6f20 7570 6461 7465 2028 6f6e 652d   to update (one-
-00033600: 6261 7365 6429 2e20 4465 6661 756c 7473  based). Defaults
-00033610: 2074 6f20 3120 286f 6e65 292e 0a20 2020   to 1 (one)..   
-00033620: 2020 2020 2076 616c 7565 5f69 6e70 7574       value_input
-00033630: 5f6f 7074 696f 6e3a 2022 5241 5722 2c20  _option: "RAW", 
-00033640: 2255 5345 525f 454e 5445 5245 4422 0a20  "USER_ENTERED". 
-00033650: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00033660: 2020 2023 2068 7474 7073 3a2f 2f67 7370     # https://gsp
-00033670: 7265 6164 2e72 6561 6474 6865 646f 6373  read.readthedocs
-00033680: 2e69 6f2f 656e 2f6c 6174 6573 742f 6170  .io/en/latest/ap
-00033690: 692e 6874 6d6c 2367 7370 7265 6164 2e6d  i.html#gspread.m
-000336a0: 6f64 656c 732e 576f 726b 7368 6565 742e  odels.Worksheet.
-000336b0: 696e 7365 7274 5f72 6f77 730a 2020 2020  insert_rows.    
-000336c0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-000336d0: 7773 2e69 6e73 6572 745f 726f 7773 2876  ws.insert_rows(v
-000336e0: 616c 7565 733d 7661 6c75 6573 2c20 726f  alues=values, ro
-000336f0: 773d 726f 772c 2076 616c 7565 5f69 6e70  w=row, value_inp
-00033700: 7574 5f6f 7074 696f 6e3d 7661 6c75 655f  ut_option=value_
-00033710: 696e 7075 745f 6f70 7469 6f6e 290a 0a20  input_option).. 
-00033720: 2020 2064 6566 2075 7064 6174 6528 7365     def update(se
-00033730: 6c66 2c72 616e 6765 2c76 616c 7565 732c  lf,range,values,
-00033740: 7661 6c75 655f 696e 7075 745f 6f70 7469  value_input_opti
-00033750: 6f6e 3d22 5553 4552 5f45 4e54 4552 4544  on="USER_ENTERED
-00033760: 2229 3a0a 2020 2020 2020 2020 2320 4e6f  "):.        # No
-00033770: 7465 2074 6861 7420 7570 6461 7465 2072  te that update r
-00033780: 616e 6765 2063 616e 2062 6520 6269 6767  ange can be bigg
-00033790: 6572 2074 6861 6e20 7661 6c75 6573 2061  er than values a
-000337a0: 7272 6179 3a20 7570 6461 7465 2827 4132  rray: update('A2
-000337b0: 3a42 3427 2c20 5b5b 3432 5d2c 205b 3433  :B4', [[42], [43
-000337c0: 5d5d 2920 2d3e 2055 7064 6174 6573 2041  ]]) -> Updates A
-000337d0: 3220 616e 6420 4133 2077 6974 6820 7661  2 and A3 with va
-000337e0: 6c75 6573 2034 3220 616e 6420 3433 0a20  lues 42 and 43. 
-000337f0: 2020 2020 2020 2023 2068 7474 7073 3a2f         # https:/
-00033800: 2f67 7370 7265 6164 2e72 6561 6474 6865  /gspread.readthe
-00033810: 646f 6373 2e69 6f2f 656e 2f6c 6174 6573  docs.io/en/lates
-00033820: 742f 6170 692e 6874 6d6c 2367 7370 7265  t/api.html#gspre
-00033830: 6164 2e6d 6f64 656c 732e 576f 726b 7368  ad.models.Worksh
-00033840: 6565 742e 7570 6461 7465 0a20 2020 2020  eet.update.     
-00033850: 2020 2072 6574 7572 6e20 7365 6c66 2e77     return self.w
-00033860: 732e 7570 6461 7465 2872 616e 6765 2c76  s.update(range,v
-00033870: 616c 7565 732c 7661 6c75 655f 696e 7075  alues,value_inpu
-00033880: 745f 6f70 7469 6f6e 3d76 616c 7565 5f69  t_option=value_i
-00033890: 6e70 7574 5f6f 7074 696f 6e29 0a0a 2020  nput_option)..  
-000338a0: 2020 6465 6620 6170 7065 6e64 2873 656c    def append(sel
-000338b0: 662c 7661 6c75 6573 2c76 616c 7565 5f69  f,values,value_i
-000338c0: 6e70 7574 5f6f 7074 696f 6e3d 2255 5345  nput_option="USE
-000338d0: 525f 454e 5445 5245 4422 293a 0a20 2020  R_ENTERED"):.   
-000338e0: 2020 2020 2022 2222 6170 7065 6e64 2074       """append t
-000338f0: 6f20 7468 6520 656e 6420 6f66 2064 6174  o the end of dat
-00033900: 6122 2222 0a20 2020 2020 2020 2023 2068  a""".        # h
-00033910: 7474 7073 3a2f 2f67 7370 7265 6164 2e72  ttps://gspread.r
-00033920: 6561 6474 6865 646f 6373 2e69 6f2f 656e  eadthedocs.io/en
-00033930: 2f6c 6174 6573 742f 6170 692e 6874 6d6c  /latest/api.html
-00033940: 2367 7370 7265 6164 2e6d 6f64 656c 732e  #gspread.models.
-00033950: 576f 726b 7368 6565 742e 6170 7065 6e64  Worksheet.append
-00033960: 5f72 6f77 730a 2020 2020 2020 2020 7265  _rows.        re
-00033970: 7475 726e 2073 656c 662e 7773 2e75 7064  turn self.ws.upd
-00033980: 6174 6528 6627 417b 7365 6c66 2e6e 726f  ate(f'A{self.nro
-00033990: 772b 317d 272c 7661 6c75 6573 2c76 616c  w+1}',values,val
-000339a0: 7565 5f69 6e70 7574 5f6f 7074 696f 6e3d  ue_input_option=
-000339b0: 7661 6c75 655f 696e 7075 745f 6f70 7469  value_input_opti
-000339c0: 6f6e 290a 0a20 2020 2064 6566 2073 7769  on)..    def swi
-000339d0: 7463 6828 7365 6c66 2c73 6865 6574 5f6e  tch(self,sheet_n
-000339e0: 616d 6529 3a0a 2020 2020 2020 2020 2222  ame):.        ""
-000339f0: 2273 7769 7463 6820 746f 2061 2070 6172  "switch to a par
-00033a00: 7469 6375 6c61 7220 776f 726b 7368 6565  ticular workshee
-00033a10: 7420 6966 2074 6865 7265 2061 7265 206d  t if there are m
-00033a20: 756c 7469 706c 6520 6f6e 6573 2222 220a  ultiple ones""".
-00033a30: 2020 2020 2020 2020 7365 6c66 2e77 7320          self.ws 
-00033a40: 3d20 7365 6c66 2e77 622e 776f 726b 7368  = self.wb.worksh
-00033a50: 6565 7428 7368 6565 745f 6e61 6d65 290a  eet(sheet_name).
-00033a60: 2020 2020 2020 2020 7265 7475 726e 204e          return N
-00033a70: 6f6e 650a 0a20 2020 2064 6566 2065 7870  one..    def exp
-00033a80: 6f72 7428 7365 6c66 2c78 6c73 785f 6669  ort(self,xlsx_fi
-00033a90: 6c65 7061 7468 293a 0a20 2020 2020 2020  lepath):.       
-00033aa0: 2022 2222 6578 706f 7274 2061 6c6c 2077   """export all w
-00033ab0: 6f72 6b73 6865 6574 7320 746f 2061 2078  orksheets to a x
-00033ac0: 6c73 7820 2866 6f72 6d75 6c61 2c20 636f  lsx (formula, co
-00033ad0: 6c6f 722c 2065 7463 2077 696c 6c20 6265  lor, etc will be
-00033ae0: 2064 6973 6361 7264 6564 3b20 6573 7365   discarded; esse
-00033af0: 6e74 6961 6c6c 7920 7265 6164 2069 6e74  ntially read int
-00033b00: 6f20 6c69 7374 206f 6620 6c69 7374 2061  o list of list a
-00033b10: 6e64 2074 6865 6e20 7772 6974 6520 786c  nd then write xl
-00033b20: 7378 2922 2222 0a20 2020 2020 2020 2069  sx)""".        i
-00033b30: 6d70 6f72 7420 786c 7378 7772 6974 6572  mport xlsxwriter
-00033b40: 0a20 2020 2020 2020 2078 626f 6f6b 203d  .        xbook =
-00033b50: 2078 6c73 7877 7269 7465 722e 576f 726b   xlsxwriter.Work
-00033b60: 626f 6f6b 2878 6c73 785f 6669 6c65 7061  book(xlsx_filepa
-00033b70: 7468 290a 2020 2020 2020 2020 666f 7220  th).        for 
-00033b80: 7773 2069 6e20 7365 6c66 2e77 622e 776f  ws in self.wb.wo
-00033b90: 726b 7368 6565 7473 2829 3a0a 2020 2020  rksheets():.    
-00033ba0: 2020 2020 2020 2020 6461 7461 203d 2077          data = w
-00033bb0: 732e 6765 745f 616c 6c5f 7661 6c75 6573  s.get_all_values
-00033bc0: 2829 0a20 2020 2020 2020 2020 2020 2078  ().            x
-00033bd0: 7368 6565 7420 3d20 7862 6f6f 6b2e 6164  sheet = xbook.ad
-00033be0: 645f 776f 726b 7368 6565 7428 7773 2e74  d_worksheet(ws.t
-00033bf0: 6974 6c65 290a 2020 2020 2020 2020 2020  itle).          
-00033c00: 2020 666f 7220 722c 2072 6f77 2069 6e20    for r, row in 
-00033c10: 656e 756d 6572 6174 6528 6461 7461 2c30  enumerate(data,0
-00033c20: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00033c30: 2020 2023 2068 7474 7073 3a2f 2f78 6c73     # https://xls
-00033c40: 7877 7269 7465 722e 7265 6164 7468 6564  xwriter.readthed
-00033c50: 6f63 732e 696f 2f77 6f72 6b73 6865 6574  ocs.io/worksheet
-00033c60: 2e68 746d 6c23 776f 726b 7368 6565 742d  .html#worksheet-
-00033c70: 7772 6974 652d 726f 770a 2020 2020 2020  write-row.      
-00033c80: 2020 2020 2020 2020 2020 7873 6865 6574            xsheet
-00033c90: 2e77 7269 7465 5f72 6f77 2872 2c20 302c  .write_row(r, 0,
-00033ca0: 2072 6f77 290a 2020 2020 2020 2020 7862   row).        xb
-00033cb0: 6f6f 6b2e 636c 6f73 6528 290a 2020 2020  ook.close().    
-00033cc0: 2020 2020 7265 7475 726e 204e 6f6e 650a      return None.
-00033cd0: 0a23 2073 6865 6574 203d 2063 6c69 656e  .# sheet = clien
-00033ce0: 742e 6f70 656e 2822 4d61 7374 6572 2d4c  t.open("Master-L
-00033cf0: 6574 7465 7220 666f 7220 4a65 7272 7927  etter for Jerry'
-00033d00: 7320 5465 6163 6869 6e67 2041 7070 6c69  s Teaching Appli
-00033d10: 6361 7469 6f6e 2229 2e73 6865 6574 310a  cation").sheet1.
-00033d20: 2320 7368 6565 7473 203d 2063 6c69 656e  # sheets = clien
-00033d30: 742e 6f70 656e 5f62 795f 7572 6c28 2768  t.open_by_url('h
-00033d40: 7474 7073 3a2f 2f64 6f63 732e 676f 6f67  ttps://docs.goog
-00033d50: 6c65 2e63 6f6d 2f73 7072 6561 6473 6865  le.com/spreadshe
-00033d60: 6574 732f 642f 3156 6578 7258 4650 4564  ets/d/1VexrXFPEd
-00033d70: 6835 6f41 4650 3943 7568 7073 5243 5671  h5oAFP9CuhpsRCVq
-00033d80: 6948 4a68 6241 645f 702d 464c 336b 6975  iHJhbAd_p-FL3kiu
-00033d90: 3051 2f65 6469 7427 290a 2320 7368 6565  0Q/edit').# shee
-00033da0: 7473 203d 2063 6c69 656e 742e 6f70 656e  ts = client.open
-00033db0: 5f62 795f 7572 6c28 6773 6865 6574 7572  _by_url(gsheetur
-00033dc0: 6c29 0a23 2073 6865 6574 203d 2073 6865  l).# sheet = she
-00033dd0: 6574 732e 776f 726b 7368 6565 7428 2254  ets.worksheet("T
-00033de0: 7261 6e73 6163 7469 6f6e 7322 290a 0a23  ransactions")..#
-00033df0: 2041 5049 3a0a 2320 6874 7470 733a 2f2f   API:.# https://
-00033e00: 6773 7072 6561 642e 7265 6164 7468 6564  gspread.readthed
-00033e10: 6f63 732e 696f 2f65 6e2f 6c61 7465 7374  ocs.io/en/latest
-00033e20: 2f61 7069 2e68 746d 6c23 6d6f 6465 6c73  /api.html#models
-00033e30: 0a23 2061 2072 6f77 2064 6f65 7320 6e6f  .# a row does no
-00033e40: 7420 6861 7665 2074 6f20 696e 636c 7564  t have to includ
-00033e50: 6520 616c 6c20 636f 6c75 6d6e 732e 204a  e all columns. J
-00033e60: 7573 7420 6c69 6b65 2077 6865 6e20 796f  ust like when yo
-00033e70: 7520 7479 7065 2069 6e20 4753 6865 6574  u type in GSheet
-00033e80: 2e20 0a23 2054 6865 2072 6573 7420 6f66  . .# The rest of
-00033e90: 2063 6f6c 756d 6e73 2074 6861 7420 6172   columns that ar
-00033ea0: 6520 6e6f 7420 696e 636c 7564 6564 2077  e not included w
-00033eb0: 696c 6c20 6e6f 7420 6265 2063 6861 6e67  ill not be chang
-00033ec0: 6564 2062 7920 6170 7065 6e64 2f69 6e73  ed by append/ins
-00033ed0: 6572 742e 0a23 2055 5345 525f 454e 5445  ert..# USER_ENTE
-00033ee0: 5245 440a 2320 6874 7470 733a 2f2f 7374  RED.# https://st
-00033ef0: 6163 6b6f 7665 7266 6c6f 772e 636f 6d2f  ackoverflow.com/
-00033f00: 7175 6573 7469 6f6e 732f 3237 3132 3539  questions/271259
-00033f10: 3637 2f67 6f6f 676c 652d 7370 7265 6164  67/google-spread
-00033f20: 7368 6565 7473 2d67 7370 7265 6164 2d61  sheets-gspread-a
-00033f30: 7070 656e 642d 726f 772d 6973 7375 650a  ppend-row-issue.
-00033f40: 2320 6874 7470 733a 2f2f 6773 7072 6561  # https://gsprea
-00033f50: 642e 7265 6164 7468 6564 6f63 732e 696f  d.readthedocs.io
-00033f60: 2f65 6e2f 6c61 7465 7374 2f61 7069 2e68  /en/latest/api.h
-00033f70: 746d 6c3f 6869 6768 6c69 6768 743d 6170  tml?highlight=ap
-00033f80: 7065 6e64 2367 7370 7265 6164 2e6d 6f64  pend#gspread.mod
-00033f90: 656c 732e 576f 726b 7368 6565 742e 696e  els.Worksheet.in
-00033fa0: 7365 7274 5f72 6f77 0a23 2068 7474 7073  sert_row.# https
-00033fb0: 3a2f 2f67 6974 6875 622e 636f 6d2f 6275  ://github.com/bu
-00033fc0: 726e 6173 682f 6773 7072 6561 642f 6973  rnash/gspread/is
-00033fd0: 7375 6573 2f35 3234 0a23 2073 6865 6574  sues/524.# sheet
-00033fe0: 2e61 7070 656e 645f 726f 7728 6c69 6e65  .append_row(line
-00033ff0: 2c27 5553 4552 5f45 4e54 4552 4544 2729  ,'USER_ENTERED')
-00034000: 0a23 2073 6865 6574 2e75 7064 6174 655f  .# sheet.update_
-00034010: 6163 656c 6c28 2747 3227 2c20 2727 293b  acell('G2', '');
-00034020: 2073 6865 6574 2e75 7064 6174 655f 6163   sheet.update_ac
-00034030: 656c 6c28 2748 3227 2c20 2727 293b 2073  ell('H2', ''); s
-00034040: 6865 6574 2e75 7064 6174 655f 6163 656c  heet.update_acel
-00034050: 6c28 2749 3227 2c20 2727 290a 2320 7368  l('I2', '').# sh
-00034060: 6565 742e 696e 7365 7274 5f72 6f77 286c  eet.insert_row(l
-00034070: 696e 652c 696e 6465 783d 322c 7661 6c75  ine,index=2,valu
-00034080: 655f 696e 7075 745f 6f70 7469 6f6e 3d27  e_input_option='
-00034090: 5553 4552 5f45 4e54 4552 4544 2729 0a0a  USER_ENTERED')..
-000340a0: 2323 2323 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ####************
+000329e0: 2a2a 0a23 2074 6865 2066 6972 7374 2070  **.# the first p
+000329f0: 6c61 6365 2074 6f20 6368 6563 6b20 6175  lace to check au
+00032a00: 7468 6f72 697a 6174 696f 6e20 6973 2067  thorization is g
+00032a10: 6f20 746f 2074 6865 2066 6f6c 6c6f 7769  o to the followi
+00032a20: 6e67 2067 7370 7265 6164 206c 696e 6b3a  ng gspread link:
+00032a30: 0a23 2068 7474 7073 3a2f 2f67 7370 7265  .# https://gspre
+00032a40: 6164 2e72 6561 6474 6865 646f 6373 2e69  ad.readthedocs.i
+00032a50: 6f2f 656e 2f6c 6174 6573 742f 6f61 7574  o/en/latest/oaut
+00032a60: 6832 2e68 746d 6c23 656e 6162 6c65 2d61  h2.html#enable-a
+00032a70: 7069 2d61 6363 6573 730a 2320 6d75 7374  pi-access.# must
+00032a80: 2067 7261 6e74 2070 6572 6d69 7373 696f   grant permissio
+00032a90: 6e20 746f 2073 6572 7669 6365 2061 6363  n to service acc
+00032aa0: 6f75 6e74 2028 7079 7368 6565 7440 7079  ount (pysheet@py
+00032ab0: 7468 6f6e 2d32 3433 3732 302e 6961 6d2e  thon-243720.iam.
+00032ac0: 6773 6572 7669 6365 6163 636f 756e 742e  gserviceaccount.
+00032ad0: 636f 6d29 200a 2320 6173 2065 6469 746f  com) .# as edito
+00032ae0: 7220 6f66 2065 6163 6820 696e 6469 7669  r of each indivi
+00032af0: 6475 616c 2067 6f6f 676c 6520 7368 6565  dual google shee
+00032b00: 7420 6d61 6e6e 7561 6c6c 790a 636c 6173  t mannually.clas
+00032b10: 7320 4753 6865 6574 2829 3a0a 2020 2020  s GSheet():.    
+00032b20: 2222 220a 2020 2020 2e77 7320 2877 6f72  """.    .ws (wor
+00032b30: 6b73 6865 6574 292c 202e 7762 2028 776f  ksheet), .wb (wo
+00032b40: 726b 626f 6f6b 2920 7265 7475 726e 2074  rkbook) return t
+00032b50: 6865 206f 7267 696e 616c 2067 6f6f 676c  he orginal googl
+00032b60: 6520 7368 6565 742f 7368 6565 7473 206f  e sheet/sheets o
+00032b70: 626a 6563 7473 0a20 2020 2022 2222 0a20  bjects.    """. 
+00032b80: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
+00032b90: 7365 6c66 2c75 726c 2c73 6865 6574 5f6e  self,url,sheet_n
+00032ba0: 616d 653d 4e6f 6e65 293a 0a20 2020 2020  ame=None):.     
+00032bb0: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
+00032bc0: 2020 2020 696d 706f 7274 2067 7370 7265      import gspre
+00032bd0: 6164 0a20 2020 2020 2020 2020 2020 2023  ad.            #
+00032be0: 206e 6f74 2073 7572 6520 7768 6572 6520   not sure where 
+00032bf0: 4920 676f 7420 7468 6573 6520 6a73 6f6e  I got these json
+00032c00: 2066 696c 6520 286d 6179 6265 2064 6f77   file (maybe dow
+00032c10: 6e6c 6f61 6465 6420 6672 6f6d 2067 6f6f  nloaded from goo
+00032c20: 676c 653f 290a 2020 2020 2020 2020 2020  gle?).          
+00032c30: 2020 636c 6965 6e74 203d 2067 7370 7265    client = gspre
+00032c40: 6164 2e73 6572 7669 6365 5f61 6363 6f75  ad.service_accou
+00032c50: 6e74 5f66 726f 6d5f 6469 6374 2847 5348  nt_from_dict(GSH
+00032c60: 4545 545f 4b45 5929 0a20 2020 2020 2020  EET_KEY).       
+00032c70: 2065 7863 6570 743a 0a20 2020 2020 2020   except:.       
+00032c80: 2020 2020 2070 6173 730a 0a20 2020 2020       pass..     
+00032c90: 2020 2073 6865 6574 7320 3d20 636c 6965     sheets = clie
+00032ca0: 6e74 2e6f 7065 6e5f 6279 5f75 726c 2875  nt.open_by_url(u
+00032cb0: 726c 290a 2020 2020 2020 2020 6966 2073  rl).        if s
+00032cc0: 6865 6574 5f6e 616d 6520 6973 204e 6f6e  heet_name is Non
+00032cd0: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
+00032ce0: 6865 6574 203d 2073 6865 6574 732e 7368  heet = sheets.sh
+00032cf0: 6565 7431 0a20 2020 2020 2020 2065 6c73  eet1.        els
+00032d00: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
+00032d10: 6865 6574 203d 2073 6865 6574 732e 776f  heet = sheets.wo
+00032d20: 726b 7368 6565 7428 7368 6565 745f 6e61  rksheet(sheet_na
+00032d30: 6d65 290a 2020 2020 2020 2020 7365 6c66  me).        self
+00032d40: 2e77 6220 3d20 7368 6565 7473 0a20 2020  .wb = sheets.   
+00032d50: 2020 2020 2073 656c 662e 7773 203d 2073       self.ws = s
+00032d60: 6865 6574 0a0a 2020 2020 4070 726f 7065  heet..    @prope
+00032d70: 7274 790a 2020 2020 6465 6620 7469 746c  rty.    def titl
+00032d80: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
+00032d90: 2072 6574 7572 6e20 7365 6c66 2e77 732e   return self.ws.
+00032da0: 7469 746c 650a 2020 2020 0a20 2020 2040  title.    .    @
+00032db0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+00032dc0: 2075 726c 2873 656c 6629 3a0a 2020 2020   url(self):.    
+00032dd0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00032de0: 7773 2e75 726c 0a0a 2020 2020 4070 726f  ws.url..    @pro
+00032df0: 7065 7274 790a 2020 2020 6465 6620 4e63  perty.    def Nc
+00032e00: 6f6c 2873 656c 6629 3a0a 2020 2020 2020  ol(self):.      
+00032e10: 2020 2222 220a 2020 2020 2020 2020 7068    """.        ph
+00032e20: 7973 6963 616c 206e 2063 6f6c 2c20 6d61  ysical n col, ma
+00032e30: 7920 6265 2062 6c61 6e6b 0a20 2020 2020  y be blank.     
+00032e40: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
+00032e50: 6574 7572 6e20 7365 6c66 2e77 732e 636f  eturn self.ws.co
+00032e60: 6c5f 636f 756e 740a 0a20 2020 2040 7072  l_count..    @pr
+00032e70: 6f70 6572 7479 0a20 2020 2064 6566 204e  operty.    def N
+00032e80: 726f 7728 7365 6c66 293a 0a20 2020 2020  row(self):.     
+00032e90: 2020 2072 6574 7572 6e20 7365 6c66 2e77     return self.w
+00032ea0: 732e 726f 775f 636f 756e 740a 0a20 2020  s.row_count..   
+00032eb0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+00032ec0: 6566 2063 6f6c 756d 6e73 2873 656c 6629  ef columns(self)
+00032ed0: 3a0a 2020 2020 2020 2020 7472 793a 0a20  :.        try:. 
+00032ee0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00032ef0: 6e20 7365 6c66 2e77 732e 726f 775f 7661  n self.ws.row_va
+00032f00: 6c75 6573 2831 290a 2020 2020 2020 2020  lues(1).        
+00032f10: 6578 6365 7074 3a0a 2020 2020 2020 2020  except:.        
+00032f20: 2020 2020 7265 7475 726e 205b 5d0a 0a20      return [].. 
+00032f30: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00032f40: 2064 6566 2076 616c 7565 7328 7365 6c66   def values(self
+00032f50: 293a 0a20 2020 2020 2020 2022 2222 6173  ):.        """as
+00032f60: 206c 6973 7420 6f66 206c 6973 7422 2222   list of list"""
+00032f70: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00032f80: 7365 6c66 2e77 732e 6765 745f 616c 6c5f  self.ws.get_all_
+00032f90: 7661 6c75 6573 2829 0a20 2020 200a 2020  values().    .  
+00032fa0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+00032fb0: 6465 6620 7265 636f 7264 7328 7365 6c66  def records(self
+00032fc0: 293a 0a20 2020 2020 2020 2022 2222 6173  ):.        """as
+00032fd0: 2064 6963 7422 2222 0a20 2020 2020 2020   dict""".       
+00032fe0: 2072 6574 7572 6e20 7365 6c66 2e77 732e   return self.ws.
+00032ff0: 6765 745f 616c 6c5f 7265 636f 7264 7328  get_all_records(
+00033000: 2920 2020 200a 0a20 2020 2040 7072 6f70  )    ..    @prop
+00033010: 6572 7479 0a20 2020 2064 6566 206e 726f  erty.    def nro
+00033020: 7728 7365 6c66 293a 0a20 2020 2020 2020  w(self):.       
+00033030: 2076 616c 7565 7320 3d20 7365 6c66 2e76   values = self.v
+00033040: 616c 7565 730a 2020 2020 2020 2020 7265  alues.        re
+00033050: 7475 726e 206c 656e 2876 616c 7565 7329  turn len(values)
+00033060: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+00033070: 2020 2020 6465 6620 6e63 6f6c 2873 656c      def ncol(sel
+00033080: 6629 3a0a 2020 2020 2020 2020 7661 6c75  f):.        valu
+00033090: 6573 203d 2073 656c 662e 7661 6c75 6573  es = self.values
+000330a0: 0a20 2020 2020 2020 2074 6d70 203d 205b  .        tmp = [
+000330b0: 6c65 6e28 7229 2066 6f72 2072 2069 6e20  len(r) for r in 
+000330c0: 7661 6c75 6573 5d0a 2020 2020 2020 2020  values].        
+000330d0: 6966 206c 656e 2874 6d70 293d 3d30 3a0a  if len(tmp)==0:.
+000330e0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+000330f0: 726e 2030 0a20 2020 2020 2020 2065 6c73  rn 0.        els
+00033100: 653a 0a20 2020 2020 2020 2020 2020 2069  e:.            i
+00033110: 6d70 6f72 7420 6e75 6d70 7920 6173 206e  mport numpy as n
+00033120: 700a 2020 2020 2020 2020 2020 2020 7265  p.            re
+00033130: 7475 726e 206e 702e 6d61 7828 746d 7029  turn np.max(tmp)
+00033140: 0a20 2020 200a 2020 2020 6465 6620 636c  .    .    def cl
+00033150: 6561 7228 7365 6c66 2c72 616e 6765 293a  ear(self,range):
+00033160: 0a20 2020 2020 2020 2023 2068 7474 7073  .        # https
+00033170: 3a2f 2f67 7370 7265 6164 2e72 6561 6474  ://gspread.readt
+00033180: 6865 646f 6373 2e69 6f2f 656e 2f6c 6174  hedocs.io/en/lat
+00033190: 6573 742f 6170 692e 6874 6d6c 2367 7370  est/api.html#gsp
+000331a0: 7265 6164 2e6d 6f64 656c 732e 5370 7265  read.models.Spre
+000331b0: 6164 7368 6565 742e 7661 6c75 6573 5f63  adsheet.values_c
+000331c0: 6c65 6172 0a20 2020 2020 2020 2023 2073  lear.        # s
+000331d0: 6865 6574 7320 6d65 7468 6f64 0a20 2020  heets method.   
+000331e0: 2020 2020 2072 616e 6765 203d 2066 2227       range = f"'
+000331f0: 7b73 656c 662e 7469 746c 657d 2721 7b72  {self.title}'!{r
+00033200: 616e 6765 7d22 0a20 2020 2020 2020 2072  ange}".        r
+00033210: 6574 7572 6e20 7365 6c66 2e77 622e 7661  eturn self.wb.va
+00033220: 6c75 6573 5f63 6c65 6172 2872 616e 6765  lues_clear(range
+00033230: 290a 0a20 2020 2064 6566 2067 6574 7661  )..    def getva
+00033240: 6c28 7365 6c66 2c2a 6172 6773 2c2a 2a6b  l(self,*args,**k
+00033250: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
+00033260: 2222 220a 2020 2020 2020 2020 7261 6e67  """.        rang
+00033270: 6520 636f 756c 6420 6265 2041 3a41 2c20  e could be A:A, 
+00033280: 323a 320a 2020 2020 2020 2020 7265 7475  2:2.        retu
+00033290: 726e 7320 6120 6c69 7374 206f 6620 6c69  rns a list of li
+000332a0: 7374 0a20 2020 2020 2020 2022 2222 0a20  st.        """. 
+000332b0: 2020 2020 2020 2023 2068 7474 7073 3a2f         # https:/
+000332c0: 2f67 7370 7265 6164 2e72 6561 6474 6865  /gspread.readthe
+000332d0: 646f 6373 2e69 6f2f 656e 2f6c 6174 6573  docs.io/en/lates
+000332e0: 742f 6170 692e 6874 6d6c 2367 7370 7265  t/api.html#gspre
+000332f0: 6164 2e6d 6f64 656c 732e 576f 726b 7368  ad.models.Worksh
+00033300: 6565 742e 6765 740a 2020 2020 2020 2020  eet.get.        
+00033310: 7265 7475 726e 2073 656c 662e 7773 2e67  return self.ws.g
+00033320: 6574 282a 6172 6773 2c20 2a2a 6b77 6172  et(*args, **kwar
+00033330: 6773 290a 2020 2020 0a20 2020 2064 6566  gs).    .    def
+00033340: 2067 6574 6328 7365 6c66 2c63 6f6c 2c2a   getc(self,col,*
+00033350: 6172 6773 2c2a 2a6b 7761 7267 7329 3a0a  args,**kwargs):.
+00033360: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00033370: 2020 2020 636f 6c20 696e 742c 2031 2062      col int, 1 b
+00033380: 6173 6564 0a20 2020 2020 2020 2072 6574  ased.        ret
+00033390: 7572 6e73 2061 206c 6973 740a 2020 2020  urns a list.    
+000333a0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+000333b0: 2320 6874 7470 733a 2f2f 6773 7072 6561  # https://gsprea
+000333c0: 642e 7265 6164 7468 6564 6f63 732e 696f  d.readthedocs.io
+000333d0: 2f65 6e2f 6c61 7465 7374 2f61 7069 2e68  /en/latest/api.h
+000333e0: 746d 6c23 6773 7072 6561 642e 6d6f 6465  tml#gspread.mode
+000333f0: 6c73 2e57 6f72 6b73 6865 6574 2e67 6574  ls.Worksheet.get
+00033400: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00033410: 7365 6c66 2e77 732e 636f 6c5f 7661 6c75  self.ws.col_valu
+00033420: 6573 2863 6f6c 2c20 2a61 7267 732c 202a  es(col, *args, *
+00033430: 2a6b 7761 7267 7329 0a0a 2020 2020 6465  *kwargs)..    de
+00033440: 6620 6765 7472 2873 656c 662c 726f 772c  f getr(self,row,
+00033450: 2a61 7267 732c 2a2a 6b77 6172 6773 293a  *args,**kwargs):
+00033460: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00033470: 2020 2020 2072 6f77 2069 6e74 2c20 3120       row int, 1 
+00033480: 6261 7365 640a 2020 2020 2020 2020 7265  based.        re
+00033490: 7475 726e 7320 6120 6c69 7374 0a20 2020  turns a list.   
+000334a0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+000334b0: 2023 2068 7474 7073 3a2f 2f67 7370 7265   # https://gspre
+000334c0: 6164 2e72 6561 6474 6865 646f 6373 2e69  ad.readthedocs.i
+000334d0: 6f2f 656e 2f6c 6174 6573 742f 6170 692e  o/en/latest/api.
+000334e0: 6874 6d6c 2367 7370 7265 6164 2e6d 6f64  html#gspread.mod
+000334f0: 656c 732e 576f 726b 7368 6565 742e 6765  els.Worksheet.ge
+00033500: 740a 2020 2020 2020 2020 7265 7475 726e  t.        return
+00033510: 2073 656c 662e 7773 2e72 6f77 5f76 616c   self.ws.row_val
+00033520: 7565 7328 726f 772c 202a 6172 6773 2c20  ues(row, *args, 
+00033530: 2a2a 6b77 6172 6773 290a 0a20 2020 2064  **kwargs)..    d
+00033540: 6566 2069 6e73 6572 7428 7365 6c66 2c76  ef insert(self,v
+00033550: 616c 7565 732c 726f 773d 312c 7661 6c75  alues,row=1,valu
+00033560: 655f 696e 7075 745f 6f70 7469 6f6e 3d22  e_input_option="
+00033570: 5553 4552 5f45 4e54 4552 4544 2229 3a0a  USER_ENTERED"):.
+00033580: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00033590: 2020 2020 7661 6c75 6573 2028 6c69 7374      values (list
+000335a0: 2920 e280 9320 4c69 7374 206f 6620 6c69  ) ... List of li
+000335b0: 7374 2e20 6567 2c20 5b5b 3131 2c31 325d  st. eg, [[11,12]
+000335c0: 2c5b 3231 2c32 325d 5d0a 2020 2020 2020  ,[21,22]].      
+000335d0: 2020 696e 6465 7820 2869 6e74 2920 e280    index (int) ..
+000335e0: 9320 5374 6172 7420 726f 7720 746f 2075  . Start row to u
+000335f0: 7064 6174 6520 286f 6e65 2d62 6173 6564  pdate (one-based
+00033600: 292e 2044 6566 6175 6c74 7320 746f 2031  ). Defaults to 1
+00033610: 2028 6f6e 6529 2e0a 2020 2020 2020 2020   (one)..        
+00033620: 7661 6c75 655f 696e 7075 745f 6f70 7469  value_input_opti
+00033630: 6f6e 3a20 2252 4157 222c 2022 5553 4552  on: "RAW", "USER
+00033640: 5f45 4e54 4552 4544 220a 2020 2020 2020  _ENTERED".      
+00033650: 2020 2222 220a 2020 2020 2020 2020 2320    """.        # 
+00033660: 6874 7470 733a 2f2f 6773 7072 6561 642e  https://gspread.
+00033670: 7265 6164 7468 6564 6f63 732e 696f 2f65  readthedocs.io/e
+00033680: 6e2f 6c61 7465 7374 2f61 7069 2e68 746d  n/latest/api.htm
+00033690: 6c23 6773 7072 6561 642e 6d6f 6465 6c73  l#gspread.models
+000336a0: 2e57 6f72 6b73 6865 6574 2e69 6e73 6572  .Worksheet.inser
+000336b0: 745f 726f 7773 0a20 2020 2020 2020 2072  t_rows.        r
+000336c0: 6574 7572 6e20 7365 6c66 2e77 732e 696e  eturn self.ws.in
+000336d0: 7365 7274 5f72 6f77 7328 7661 6c75 6573  sert_rows(values
+000336e0: 3d76 616c 7565 732c 2072 6f77 3d72 6f77  =values, row=row
+000336f0: 2c20 7661 6c75 655f 696e 7075 745f 6f70  , value_input_op
+00033700: 7469 6f6e 3d76 616c 7565 5f69 6e70 7574  tion=value_input
+00033710: 5f6f 7074 696f 6e29 0a0a 2020 2020 6465  _option)..    de
+00033720: 6620 7570 6461 7465 2873 656c 662c 7261  f update(self,ra
+00033730: 6e67 652c 7661 6c75 6573 2c76 616c 7565  nge,values,value
+00033740: 5f69 6e70 7574 5f6f 7074 696f 6e3d 2255  _input_option="U
+00033750: 5345 525f 454e 5445 5245 4422 293a 0a20  SER_ENTERED"):. 
+00033760: 2020 2020 2020 2023 204e 6f74 6520 7468         # Note th
+00033770: 6174 2075 7064 6174 6520 7261 6e67 6520  at update range 
+00033780: 6361 6e20 6265 2062 6967 6765 7220 7468  can be bigger th
+00033790: 616e 2076 616c 7565 7320 6172 7261 793a  an values array:
+000337a0: 2075 7064 6174 6528 2741 323a 4234 272c   update('A2:B4',
+000337b0: 205b 5b34 325d 2c20 5b34 335d 5d29 202d   [[42], [43]]) -
+000337c0: 3e20 5570 6461 7465 7320 4132 2061 6e64  > Updates A2 and
+000337d0: 2041 3320 7769 7468 2076 616c 7565 7320   A3 with values 
+000337e0: 3432 2061 6e64 2034 330a 2020 2020 2020  42 and 43.      
+000337f0: 2020 2320 6874 7470 733a 2f2f 6773 7072    # https://gspr
+00033800: 6561 642e 7265 6164 7468 6564 6f63 732e  ead.readthedocs.
+00033810: 696f 2f65 6e2f 6c61 7465 7374 2f61 7069  io/en/latest/api
+00033820: 2e68 746d 6c23 6773 7072 6561 642e 6d6f  .html#gspread.mo
+00033830: 6465 6c73 2e57 6f72 6b73 6865 6574 2e75  dels.Worksheet.u
+00033840: 7064 6174 650a 2020 2020 2020 2020 7265  pdate.        re
+00033850: 7475 726e 2073 656c 662e 7773 2e75 7064  turn self.ws.upd
+00033860: 6174 6528 7261 6e67 652c 7661 6c75 6573  ate(range,values
+00033870: 2c76 616c 7565 5f69 6e70 7574 5f6f 7074  ,value_input_opt
+00033880: 696f 6e3d 7661 6c75 655f 696e 7075 745f  ion=value_input_
+00033890: 6f70 7469 6f6e 290a 0a20 2020 2064 6566  option)..    def
+000338a0: 2061 7070 656e 6428 7365 6c66 2c76 616c   append(self,val
+000338b0: 7565 732c 7661 6c75 655f 696e 7075 745f  ues,value_input_
+000338c0: 6f70 7469 6f6e 3d22 5553 4552 5f45 4e54  option="USER_ENT
+000338d0: 4552 4544 2229 3a0a 2020 2020 2020 2020  ERED"):.        
+000338e0: 2222 2261 7070 656e 6420 746f 2074 6865  """append to the
+000338f0: 2065 6e64 206f 6620 6461 7461 2222 220a   end of data""".
+00033900: 2020 2020 2020 2020 2320 6874 7470 733a          # https:
+00033910: 2f2f 6773 7072 6561 642e 7265 6164 7468  //gspread.readth
+00033920: 6564 6f63 732e 696f 2f65 6e2f 6c61 7465  edocs.io/en/late
+00033930: 7374 2f61 7069 2e68 746d 6c23 6773 7072  st/api.html#gspr
+00033940: 6561 642e 6d6f 6465 6c73 2e57 6f72 6b73  ead.models.Works
+00033950: 6865 6574 2e61 7070 656e 645f 726f 7773  heet.append_rows
+00033960: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00033970: 7365 6c66 2e77 732e 7570 6461 7465 2866  self.ws.update(f
+00033980: 2741 7b73 656c 662e 6e72 6f77 2b31 7d27  'A{self.nrow+1}'
+00033990: 2c76 616c 7565 732c 7661 6c75 655f 696e  ,values,value_in
+000339a0: 7075 745f 6f70 7469 6f6e 3d76 616c 7565  put_option=value
+000339b0: 5f69 6e70 7574 5f6f 7074 696f 6e29 0a0a  _input_option)..
+000339c0: 2020 2020 6465 6620 7377 6974 6368 2873      def switch(s
+000339d0: 656c 662c 7368 6565 745f 6e61 6d65 293a  elf,sheet_name):
+000339e0: 0a20 2020 2020 2020 2022 2222 7377 6974  .        """swit
+000339f0: 6368 2074 6f20 6120 7061 7274 6963 756c  ch to a particul
+00033a00: 6172 2077 6f72 6b73 6865 6574 2069 6620  ar worksheet if 
+00033a10: 7468 6572 6520 6172 6520 6d75 6c74 6970  there are multip
+00033a20: 6c65 206f 6e65 7322 2222 0a20 2020 2020  le ones""".     
+00033a30: 2020 2073 656c 662e 7773 203d 2073 656c     self.ws = sel
+00033a40: 662e 7762 2e77 6f72 6b73 6865 6574 2873  f.wb.worksheet(s
+00033a50: 6865 6574 5f6e 616d 6529 0a20 2020 2020  heet_name).     
+00033a60: 2020 2072 6574 7572 6e20 4e6f 6e65 0a0a     return None..
+00033a70: 2020 2020 6465 6620 6578 706f 7274 2873      def export(s
+00033a80: 656c 662c 786c 7378 5f66 696c 6570 6174  elf,xlsx_filepat
+00033a90: 6829 3a0a 2020 2020 2020 2020 2222 2265  h):.        """e
+00033aa0: 7870 6f72 7420 616c 6c20 776f 726b 7368  xport all worksh
+00033ab0: 6565 7473 2074 6f20 6120 786c 7378 2028  eets to a xlsx (
+00033ac0: 666f 726d 756c 612c 2063 6f6c 6f72 2c20  formula, color, 
+00033ad0: 6574 6320 7769 6c6c 2062 6520 6469 7363  etc will be disc
+00033ae0: 6172 6465 643b 2065 7373 656e 7469 616c  arded; essential
+00033af0: 6c79 2072 6561 6420 696e 746f 206c 6973  ly read into lis
+00033b00: 7420 6f66 206c 6973 7420 616e 6420 7468  t of list and th
+00033b10: 656e 2077 7269 7465 2078 6c73 7829 2222  en write xlsx)""
+00033b20: 220a 2020 2020 2020 2020 696d 706f 7274  ".        import
+00033b30: 2078 6c73 7877 7269 7465 720a 2020 2020   xlsxwriter.    
+00033b40: 2020 2020 7862 6f6f 6b20 3d20 786c 7378      xbook = xlsx
+00033b50: 7772 6974 6572 2e57 6f72 6b62 6f6f 6b28  writer.Workbook(
+00033b60: 786c 7378 5f66 696c 6570 6174 6829 0a20  xlsx_filepath). 
+00033b70: 2020 2020 2020 2066 6f72 2077 7320 696e         for ws in
+00033b80: 2073 656c 662e 7762 2e77 6f72 6b73 6865   self.wb.workshe
+00033b90: 6574 7328 293a 0a20 2020 2020 2020 2020  ets():.         
+00033ba0: 2020 2064 6174 6120 3d20 7773 2e67 6574     data = ws.get
+00033bb0: 5f61 6c6c 5f76 616c 7565 7328 290a 2020  _all_values().  
+00033bc0: 2020 2020 2020 2020 2020 7873 6865 6574            xsheet
+00033bd0: 203d 2078 626f 6f6b 2e61 6464 5f77 6f72   = xbook.add_wor
+00033be0: 6b73 6865 6574 2877 732e 7469 746c 6529  ksheet(ws.title)
+00033bf0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+00033c00: 2072 2c20 726f 7720 696e 2065 6e75 6d65   r, row in enume
+00033c10: 7261 7465 2864 6174 612c 3029 3a0a 2020  rate(data,0):.  
+00033c20: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+00033c30: 6874 7470 733a 2f2f 786c 7378 7772 6974  https://xlsxwrit
+00033c40: 6572 2e72 6561 6474 6865 646f 6373 2e69  er.readthedocs.i
+00033c50: 6f2f 776f 726b 7368 6565 742e 6874 6d6c  o/worksheet.html
+00033c60: 2377 6f72 6b73 6865 6574 2d77 7269 7465  #worksheet-write
+00033c70: 2d72 6f77 0a20 2020 2020 2020 2020 2020  -row.           
+00033c80: 2020 2020 2078 7368 6565 742e 7772 6974       xsheet.writ
+00033c90: 655f 726f 7728 722c 2030 2c20 726f 7729  e_row(r, 0, row)
+00033ca0: 0a20 2020 2020 2020 2078 626f 6f6b 2e63  .        xbook.c
+00033cb0: 6c6f 7365 2829 0a20 2020 2020 2020 2072  lose().        r
+00033cc0: 6574 7572 6e20 4e6f 6e65 0a0a 2320 7368  eturn None..# sh
+00033cd0: 6565 7420 3d20 636c 6965 6e74 2e6f 7065  eet = client.ope
+00033ce0: 6e28 224d 6173 7465 722d 4c65 7474 6572  n("Master-Letter
+00033cf0: 2066 6f72 204a 6572 7279 2773 2054 6561   for Jerry's Tea
+00033d00: 6368 696e 6720 4170 706c 6963 6174 696f  ching Applicatio
+00033d10: 6e22 292e 7368 6565 7431 0a23 2073 6865  n").sheet1.# she
+00033d20: 6574 7320 3d20 636c 6965 6e74 2e6f 7065  ets = client.ope
+00033d30: 6e5f 6279 5f75 726c 2827 6874 7470 733a  n_by_url('https:
+00033d40: 2f2f 646f 6373 2e67 6f6f 676c 652e 636f  //docs.google.co
+00033d50: 6d2f 7370 7265 6164 7368 6565 7473 2f64  m/spreadsheets/d
+00033d60: 2f31 5665 7872 5846 5045 6468 356f 4146  /1VexrXFPEdh5oAF
+00033d70: 5039 4375 6870 7352 4356 7169 484a 6862  P9CuhpsRCVqiHJhb
+00033d80: 4164 5f70 2d46 4c33 6b69 7530 512f 6564  Ad_p-FL3kiu0Q/ed
+00033d90: 6974 2729 0a23 2073 6865 6574 7320 3d20  it').# sheets = 
+00033da0: 636c 6965 6e74 2e6f 7065 6e5f 6279 5f75  client.open_by_u
+00033db0: 726c 2867 7368 6565 7475 726c 290a 2320  rl(gsheeturl).# 
+00033dc0: 7368 6565 7420 3d20 7368 6565 7473 2e77  sheet = sheets.w
+00033dd0: 6f72 6b73 6865 6574 2822 5472 616e 7361  orksheet("Transa
+00033de0: 6374 696f 6e73 2229 0a0a 2320 4150 493a  ctions")..# API:
+00033df0: 0a23 2068 7474 7073 3a2f 2f67 7370 7265  .# https://gspre
+00033e00: 6164 2e72 6561 6474 6865 646f 6373 2e69  ad.readthedocs.i
+00033e10: 6f2f 656e 2f6c 6174 6573 742f 6170 692e  o/en/latest/api.
+00033e20: 6874 6d6c 236d 6f64 656c 730a 2320 6120  html#models.# a 
+00033e30: 726f 7720 646f 6573 206e 6f74 2068 6176  row does not hav
+00033e40: 6520 746f 2069 6e63 6c75 6465 2061 6c6c  e to include all
+00033e50: 2063 6f6c 756d 6e73 2e20 4a75 7374 206c   columns. Just l
+00033e60: 696b 6520 7768 656e 2079 6f75 2074 7970  ike when you typ
+00033e70: 6520 696e 2047 5368 6565 742e 200a 2320  e in GSheet. .# 
+00033e80: 5468 6520 7265 7374 206f 6620 636f 6c75  The rest of colu
+00033e90: 6d6e 7320 7468 6174 2061 7265 206e 6f74  mns that are not
+00033ea0: 2069 6e63 6c75 6465 6420 7769 6c6c 206e   included will n
+00033eb0: 6f74 2062 6520 6368 616e 6765 6420 6279  ot be changed by
+00033ec0: 2061 7070 656e 642f 696e 7365 7274 2e0a   append/insert..
+00033ed0: 2320 5553 4552 5f45 4e54 4552 4544 0a23  # USER_ENTERED.#
+00033ee0: 2068 7474 7073 3a2f 2f73 7461 636b 6f76   https://stackov
+00033ef0: 6572 666c 6f77 2e63 6f6d 2f71 7565 7374  erflow.com/quest
+00033f00: 696f 6e73 2f32 3731 3235 3936 372f 676f  ions/27125967/go
+00033f10: 6f67 6c65 2d73 7072 6561 6473 6865 6574  ogle-spreadsheet
+00033f20: 732d 6773 7072 6561 642d 6170 7065 6e64  s-gspread-append
+00033f30: 2d72 6f77 2d69 7373 7565 0a23 2068 7474  -row-issue.# htt
+00033f40: 7073 3a2f 2f67 7370 7265 6164 2e72 6561  ps://gspread.rea
+00033f50: 6474 6865 646f 6373 2e69 6f2f 656e 2f6c  dthedocs.io/en/l
+00033f60: 6174 6573 742f 6170 692e 6874 6d6c 3f68  atest/api.html?h
+00033f70: 6967 686c 6967 6874 3d61 7070 656e 6423  ighlight=append#
+00033f80: 6773 7072 6561 642e 6d6f 6465 6c73 2e57  gspread.models.W
+00033f90: 6f72 6b73 6865 6574 2e69 6e73 6572 745f  orksheet.insert_
+00033fa0: 726f 770a 2320 6874 7470 733a 2f2f 6769  row.# https://gi
+00033fb0: 7468 7562 2e63 6f6d 2f62 7572 6e61 7368  thub.com/burnash
+00033fc0: 2f67 7370 7265 6164 2f69 7373 7565 732f  /gspread/issues/
+00033fd0: 3532 340a 2320 7368 6565 742e 6170 7065  524.# sheet.appe
+00033fe0: 6e64 5f72 6f77 286c 696e 652c 2755 5345  nd_row(line,'USE
+00033ff0: 525f 454e 5445 5245 4427 290a 2320 7368  R_ENTERED').# sh
+00034000: 6565 742e 7570 6461 7465 5f61 6365 6c6c  eet.update_acell
+00034010: 2827 4732 272c 2027 2729 3b20 7368 6565  ('G2', ''); shee
+00034020: 742e 7570 6461 7465 5f61 6365 6c6c 2827  t.update_acell('
+00034030: 4832 272c 2027 2729 3b20 7368 6565 742e  H2', ''); sheet.
+00034040: 7570 6461 7465 5f61 6365 6c6c 2827 4932  update_acell('I2
+00034050: 272c 2027 2729 0a23 2073 6865 6574 2e69  ', '').# sheet.i
+00034060: 6e73 6572 745f 726f 7728 6c69 6e65 2c69  nsert_row(line,i
+00034070: 6e64 6578 3d32 2c76 616c 7565 5f69 6e70  ndex=2,value_inp
+00034080: 7574 5f6f 7074 696f 6e3d 2755 5345 525f  ut_option='USER_
+00034090: 454e 5445 5245 4427 290a 0a23 2323 232a  ENTERED')..####*
+000340a0: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
 000340b0: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
 000340c0: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
 000340d0: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
 000340e0: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
-000340f0: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
-00034100: 2a2a 2a2a 0a20 2020 2020 2020 2020 2020  ****.           
+000340f0: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a0a  ***************.
+00034100: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00034110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034120: 2020 2020 2020 2020 2020 2323 2323 2a44            ####*D
-00034130: 726f 7062 6f78 2a23 2323 230a 2323 2323  ropbox*####.####
+00034120: 2020 2020 2023 2323 232a 4472 6f70 626f       ####*Dropbo
+00034130: 782a 2323 2323 0a23 2323 232a 2a2a 2a2a  x*####.####*****
 00034140: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
 00034150: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
 00034160: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
 00034170: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
 00034180: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
-00034190: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
-000341a0: 0a69 6d70 6f72 7420 6472 6f70 626f 780a  .import dropbox.
-000341b0: 2320 6874 7470 733a 2f2f 6472 6f70 626f  # https://dropbo
-000341c0: 782d 7364 6b2d 7079 7468 6f6e 2e72 6561  x-sdk-python.rea
-000341d0: 6474 6865 646f 6373 2e69 6f2f 656e 2f6c  dthedocs.io/en/l
-000341e0: 6174 6573 742f 6170 692f 6472 6f70 626f  atest/api/dropbo
-000341f0: 782e 6874 6d6c 230a 0a64 6566 2075 706c  x.html#..def upl
-00034200: 6f61 6428 6c6f 6361 6c66 696c 652c 636c  oad(localfile,cl
-00034210: 6f75 6466 696c 653d 4e6f 6e65 293a 0a20  oudfile=None):. 
-00034220: 2020 2023 2073 686f 7274 6375 7420 6966     # shortcut if
-00034230: 206f 6e6c 7920 6f6e 6520 636c 6f75 6470   only one cloudp
-00034240: 6174 6820 7061 7373 6564 2069 6e2c 2061  ath passed in, a
-00034250: 7373 756d 696e 6720 6375 7272 656e 7420  ssuming current 
-00034260: 6c6f 6361 6c20 776f 726b 696e 6720 6469  local working di
-00034270: 7265 6374 6f72 790a 2020 2020 2320 652e  rectory.    # e.
-00034280: 672e 2c20 272f 496e 7665 7374 6d65 6e74  g., '/Investment
-00034290: 2f66 7a2f 667a 2f66 7a2f 6461 7461 5f74  /fz/fz/fz/data_t
-000342a0: 642e 6a73 6f6e 270a 2020 2020 6966 2063  d.json'.    if c
-000342b0: 6c6f 7564 6669 6c65 2069 7320 4e6f 6e65  loudfile is None
-000342c0: 3a0a 2020 2020 2020 2020 7061 7468 2c66  :.        path,f
-000342d0: 696c 653d 206f 732e 7061 7468 2e73 706c  ile= os.path.spl
-000342e0: 6974 286c 6f63 616c 6669 6c65 290a 2020  it(localfile).  
-000342f0: 2020 2020 2020 636c 6f75 6466 696c 653d        cloudfile=
-00034300: 6c6f 6361 6c66 696c 650a 2020 2020 2020  localfile.      
-00034310: 2020 6c6f 6361 6c66 696c 653d 6669 6c65    localfile=file
-00034320: 0a20 2020 2064 6278 203d 2064 726f 7062  .    dbx = dropb
-00034330: 6f78 2e44 726f 7062 6f78 2844 524f 5042  ox.Dropbox(DROPB
-00034340: 4f58 5f41 4343 4553 535f 544f 4b45 4e29  OX_ACCESS_TOKEN)
-00034350: 0a20 2020 2077 6974 6820 6f70 656e 286c  .    with open(l
-00034360: 6f63 616c 6669 6c65 2c20 2272 6222 2920  ocalfile, "rb") 
-00034370: 6173 2066 3a0a 2020 2020 2020 2020 6462  as f:.        db
-00034380: 782e 6669 6c65 735f 7570 6c6f 6164 2866  x.files_upload(f
-00034390: 2e72 6561 6428 292c 636c 6f75 6466 696c  .read(),cloudfil
-000343a0: 652c 6472 6f70 626f 782e 6669 6c65 732e  e,dropbox.files.
-000343b0: 5772 6974 654d 6f64 652e 6f76 6572 7772  WriteMode.overwr
-000343c0: 6974 652c 6d75 7465 3d54 7275 6529 0a20  ite,mute=True). 
-000343d0: 2020 2020 2020 2023 2070 7269 6e74 2863         # print(c
-000343e0: 6c6f 7564 6669 6c65 2b27 2075 706c 6f61  loudfile+' uploa
-000343f0: 6420 646f 6e65 2e27 290a 0a64 6566 2064  d done.')..def d
-00034400: 6f77 6e6c 6f61 6428 636c 6f75 6466 696c  ownload(cloudfil
-00034410: 652c 6c6f 6361 6c66 696c 653d 4e6f 6e65  e,localfile=None
-00034420: 293a 0a20 2020 2023 2073 686f 7274 6375  ):.    # shortcu
-00034430: 7420 6966 206f 6e6c 7920 6f6e 6520 636c  t if only one cl
-00034440: 6f75 6470 6174 6820 7061 7373 6564 2069  oudpath passed i
-00034450: 6e2c 2061 7373 756d 696e 6720 6375 7272  n, assuming curr
-00034460: 656e 7420 6c6f 6361 6c20 776f 726b 696e  ent local workin
-00034470: 6720 6469 7265 6374 6f72 790a 2020 2020  g directory.    
-00034480: 2320 652e 672e 2c20 272f 496e 7665 7374  # e.g., '/Invest
-00034490: 6d65 6e74 2f66 7a2f 667a 2f66 7a2f 6461  ment/fz/fz/fz/da
-000344a0: 7461 5f74 642e 6a73 6f6e 270a 2020 2020  ta_td.json'.    
-000344b0: 6966 206c 6f63 616c 6669 6c65 2069 7320  if localfile is 
-000344c0: 4e6f 6e65 3a0a 2020 2020 2020 2020 7061  None:.        pa
-000344d0: 7468 2c66 696c 653d 206f 732e 7061 7468  th,file= os.path
-000344e0: 2e73 706c 6974 2863 6c6f 7564 6669 6c65  .split(cloudfile
-000344f0: 290a 2020 2020 2020 2020 6c6f 6361 6c66  ).        localf
-00034500: 696c 653d 6669 6c65 0a20 2020 2064 6278  ile=file.    dbx
-00034510: 203d 2064 726f 7062 6f78 2e44 726f 7062   = dropbox.Dropb
-00034520: 6f78 2844 524f 5042 4f58 5f41 4343 4553  ox(DROPBOX_ACCES
-00034530: 535f 544f 4b45 4e29 0a20 2020 2064 6278  S_TOKEN).    dbx
-00034540: 2e66 696c 6573 5f64 6f77 6e6c 6f61 645f  .files_download_
-00034550: 746f 5f66 696c 6528 6c6f 6361 6c66 696c  to_file(localfil
-00034560: 652c 636c 6f75 6466 696c 6529 0a20 2020  e,cloudfile).   
-00034570: 2072 6574 7572 6e20 6c6f 6361 6c66 696c   return localfil
-00034580: 650a 0a64 6566 205f 6669 6c65 735f 6c69  e..def _files_li
-00034590: 7374 5f66 6f6c 6465 725f 616c 6c28 6462  st_folder_all(db
-000345a0: 782c 666f 6c64 6572 2c72 6563 7572 7369  x,folder,recursi
-000345b0: 7665 3d46 616c 7365 2c6c 696d 6974 3d32  ve=False,limit=2
-000345c0: 3030 3029 3a0a 2020 2020 6375 7220 3d20  000):.    cur = 
-000345d0: 6462 782e 6669 6c65 735f 6c69 7374 5f66  dbx.files_list_f
-000345e0: 6f6c 6465 7228 666f 6c64 6572 2c72 6563  older(folder,rec
-000345f0: 7572 7369 7665 3d72 6563 7572 7369 7665  ursive=recursive
-00034600: 2c6c 696d 6974 3d6c 696d 6974 290a 2020  ,limit=limit).  
-00034610: 2020 6974 656d 7320 3d20 6375 722e 656e    items = cur.en
-00034620: 7472 6965 730a 2020 2020 7768 696c 6520  tries.    while 
-00034630: 6375 722e 6861 735f 6d6f 7265 3d3d 5472  cur.has_more==Tr
-00034640: 7565 3a0a 2020 2020 2020 2020 6375 7220  ue:.        cur 
-00034650: 3d20 6462 782e 6669 6c65 735f 6c69 7374  = dbx.files_list
-00034660: 5f66 6f6c 6465 725f 636f 6e74 696e 7565  _folder_continue
-00034670: 2863 7572 2e63 7572 736f 7229 0a20 2020  (cur.cursor).   
-00034680: 2020 2020 2069 7465 6d73 2e65 7874 656e       items.exten
-00034690: 6428 6375 722e 656e 7472 6965 7329 0a20  d(cur.entries). 
-000346a0: 2020 2072 6574 7572 6e20 6974 656d 730a     return items.
-000346b0: 0a64 6566 206c 7366 696c 6528 666f 6c64  .def lsfile(fold
-000346c0: 6572 2c72 6563 7572 7369 7665 3d46 616c  er,recursive=Fal
-000346d0: 7365 293a 0a20 2020 2064 6278 203d 2064  se):.    dbx = d
-000346e0: 726f 7062 6f78 2e44 726f 7062 6f78 2844  ropbox.Dropbox(D
-000346f0: 524f 5042 4f58 5f41 4343 4553 535f 544f  ROPBOX_ACCESS_TO
-00034700: 4b45 4e29 0a20 2020 2069 7465 6d73 203d  KEN).    items =
-00034710: 205f 6669 6c65 735f 6c69 7374 5f66 6f6c   _files_list_fol
-00034720: 6465 725f 616c 6c28 6462 782c 666f 6c64  der_all(dbx,fold
-00034730: 6572 2c72 6563 7572 7369 7665 3d72 6563  er,recursive=rec
-00034740: 7572 7369 7665 2c6c 696d 6974 3d32 3030  ursive,limit=200
-00034750: 3029 0a20 2020 2066 696c 6573 203d 205b  0).    files = [
-00034760: 5d0a 2020 2020 666f 7220 6974 656d 2069  ].    for item i
-00034770: 6e20 6974 656d 733a 0a20 2020 2020 2020  n items:.       
-00034780: 2069 6620 7479 7065 2869 7465 6d29 3d3d   if type(item)==
-00034790: 6472 6f70 626f 782e 6669 6c65 732e 466f  dropbox.files.Fo
-000347a0: 6c64 6572 4d65 7461 6461 7461 3a20 636f  lderMetadata: co
-000347b0: 6e74 696e 7565 0a20 2020 2020 2020 2023  ntinue.        #
-000347c0: 2065 2e67 2e2c 2027 2f49 6e76 6573 746d   e.g., '/Investm
-000347d0: 656e 742f 667a 2f66 7a2f 667a 2f64 6174  ent/fz/fz/fz/dat
-000347e0: 615f 7464 2e6a 736f 6e27 2c20 2764 6174  a_td.json', 'dat
-000347f0: 615f 7464 2e6a 736f 6e27 0a20 2020 2020  a_td.json'.     
-00034800: 2020 2066 696c 6573 2e61 7070 656e 6428     files.append(
-00034810: 5b69 7465 6d2e 7061 7468 5f64 6973 706c  [item.path_displ
-00034820: 6179 2c69 7465 6d2e 6e61 6d65 5d29 0a20  ay,item.name]). 
-00034830: 2020 2072 6574 7572 6e20 6669 6c65 730a     return files.
-00034840: 0a64 6566 206c 7366 6f6c 6465 7228 666f  .def lsfolder(fo
-00034850: 6c64 6572 2c72 6563 7572 7369 7665 3d46  lder,recursive=F
-00034860: 616c 7365 293a 0a20 2020 2064 6278 203d  alse):.    dbx =
-00034870: 2064 726f 7062 6f78 2e44 726f 7062 6f78   dropbox.Dropbox
-00034880: 2844 524f 5042 4f58 5f41 4343 4553 535f  (DROPBOX_ACCESS_
-00034890: 544f 4b45 4e29 0a20 2020 2069 7465 6d73  TOKEN).    items
-000348a0: 203d 205f 6669 6c65 735f 6c69 7374 5f66   = _files_list_f
-000348b0: 6f6c 6465 725f 616c 6c28 6462 782c 666f  older_all(dbx,fo
-000348c0: 6c64 6572 2c72 6563 7572 7369 7665 3d72  lder,recursive=r
-000348d0: 6563 7572 7369 7665 2c6c 696d 6974 3d32  ecursive,limit=2
-000348e0: 3030 3029 0a20 2020 2066 696c 6573 203d  000).    files =
-000348f0: 205b 5d0a 2020 2020 666f 7220 6974 656d   [].    for item
-00034900: 2069 6e20 6974 656d 733a 0a20 2020 2020   in items:.     
-00034910: 2020 2069 6620 7479 7065 2869 7465 6d29     if type(item)
-00034920: 3d3d 6472 6f70 626f 782e 6669 6c65 732e  ==dropbox.files.
-00034930: 4669 6c65 4d65 7461 6461 7461 3a20 636f  FileMetadata: co
-00034940: 6e74 696e 7565 0a20 2020 2020 2020 2023  ntinue.        #
-00034950: 2065 2e67 2e2c 2027 2f49 6e76 6573 746d   e.g., '/Investm
-00034960: 656e 742f 667a 2f66 7a2f 667a 2f66 6972  ent/fz/fz/fz/fir
-00034970: 6566 6f78 272c 2027 6669 7265 666f 7827  efox', 'firefox'
-00034980: 0a20 2020 2020 2020 2066 696c 6573 2e61  .        files.a
-00034990: 7070 656e 6428 5b69 7465 6d2e 7061 7468  ppend([item.path
-000349a0: 5f64 6973 706c 6179 2c69 7465 6d2e 6e61  _display,item.na
-000349b0: 6d65 5d29 0a20 2020 2072 6574 7572 6e20  me]).    return 
-000349c0: 6669 6c65 730a 0a64 6566 2064 656c 6669  files..def delfi
-000349d0: 6c65 666f 6c64 6572 2866 696c 6529 3a0a  lefolder(file):.
-000349e0: 2020 2020 2320 4465 6c65 7465 2074 6865      # Delete the
-000349f0: 2066 696c 6520 6f72 2066 6f6c 6465 7220   file or folder 
-00034a00: 6174 2061 2067 6976 656e 2070 6174 682e  at a given path.
-00034a10: 2049 6620 7468 6520 7061 7468 2069 7320   If the path is 
-00034a20: 6120 666f 6c64 6572 2c20 616c 6c20 6974  a folder, all it
-00034a30: 7320 636f 6e74 656e 7473 2077 696c 6c20  s contents will 
-00034a40: 6265 2064 656c 6574 6564 2074 6f6f 2e20  be deleted too. 
-00034a50: 4120 7375 6363 6573 7366 756c 2072 6573  A successful res
-00034a60: 706f 6e73 6520 696e 6469 6361 7465 7320  ponse indicates 
-00034a70: 7468 6174 2074 6865 2066 696c 6520 6f72  that the file or
-00034a80: 2066 6f6c 6465 7220 7761 7320 6465 6c65   folder was dele
-00034a90: 7465 640a 2020 2020 6462 7820 3d20 6472  ted.    dbx = dr
-00034aa0: 6f70 626f 782e 4472 6f70 626f 7828 4452  opbox.Dropbox(DR
-00034ab0: 4f50 424f 585f 4143 4345 5353 5f54 4f4b  OPBOX_ACCESS_TOK
-00034ac0: 454e 290a 2020 2020 7265 7475 726e 2064  EN).    return d
-00034ad0: 6278 2e66 696c 6573 5f64 656c 6574 6528  bx.files_delete(
-00034ae0: 6669 6c65 290a 0a23 2323 232a 2a2a 2a2a  file)..####*****
+00034190: 2a2a 2a2a 2a2a 2a2a 2a2a 2a0a 696d 706f  ***********.impo
+000341a0: 7274 2064 726f 7062 6f78 0a23 2068 7474  rt dropbox.# htt
+000341b0: 7073 3a2f 2f64 726f 7062 6f78 2d73 646b  ps://dropbox-sdk
+000341c0: 2d70 7974 686f 6e2e 7265 6164 7468 6564  -python.readthed
+000341d0: 6f63 732e 696f 2f65 6e2f 6c61 7465 7374  ocs.io/en/latest
+000341e0: 2f61 7069 2f64 726f 7062 6f78 2e68 746d  /api/dropbox.htm
+000341f0: 6c23 0a0a 6465 6620 7570 6c6f 6164 286c  l#..def upload(l
+00034200: 6f63 616c 6669 6c65 2c63 6c6f 7564 6669  ocalfile,cloudfi
+00034210: 6c65 3d4e 6f6e 6529 3a0a 2020 2020 2320  le=None):.    # 
+00034220: 7368 6f72 7463 7574 2069 6620 6f6e 6c79  shortcut if only
+00034230: 206f 6e65 2063 6c6f 7564 7061 7468 2070   one cloudpath p
+00034240: 6173 7365 6420 696e 2c20 6173 7375 6d69  assed in, assumi
+00034250: 6e67 2063 7572 7265 6e74 206c 6f63 616c  ng current local
+00034260: 2077 6f72 6b69 6e67 2064 6972 6563 746f   working directo
+00034270: 7279 0a20 2020 2023 2065 2e67 2e2c 2027  ry.    # e.g., '
+00034280: 2f49 6e76 6573 746d 656e 742f 667a 2f66  /Investment/fz/f
+00034290: 7a2f 667a 2f64 6174 615f 7464 2e6a 736f  z/fz/data_td.jso
+000342a0: 6e27 0a20 2020 2069 6620 636c 6f75 6466  n'.    if cloudf
+000342b0: 696c 6520 6973 204e 6f6e 653a 0a20 2020  ile is None:.   
+000342c0: 2020 2020 2070 6174 682c 6669 6c65 3d20       path,file= 
+000342d0: 6f73 2e70 6174 682e 7370 6c69 7428 6c6f  os.path.split(lo
+000342e0: 6361 6c66 696c 6529 0a20 2020 2020 2020  calfile).       
+000342f0: 2063 6c6f 7564 6669 6c65 3d6c 6f63 616c   cloudfile=local
+00034300: 6669 6c65 0a20 2020 2020 2020 206c 6f63  file.        loc
+00034310: 616c 6669 6c65 3d66 696c 650a 2020 2020  alfile=file.    
+00034320: 6462 7820 3d20 6472 6f70 626f 782e 4472  dbx = dropbox.Dr
+00034330: 6f70 626f 7828 4452 4f50 424f 585f 4143  opbox(DROPBOX_AC
+00034340: 4345 5353 5f54 4f4b 454e 290a 2020 2020  CESS_TOKEN).    
+00034350: 7769 7468 206f 7065 6e28 6c6f 6361 6c66  with open(localf
+00034360: 696c 652c 2022 7262 2229 2061 7320 663a  ile, "rb") as f:
+00034370: 0a20 2020 2020 2020 2064 6278 2e66 696c  .        dbx.fil
+00034380: 6573 5f75 706c 6f61 6428 662e 7265 6164  es_upload(f.read
+00034390: 2829 2c63 6c6f 7564 6669 6c65 2c64 726f  (),cloudfile,dro
+000343a0: 7062 6f78 2e66 696c 6573 2e57 7269 7465  pbox.files.Write
+000343b0: 4d6f 6465 2e6f 7665 7277 7269 7465 2c6d  Mode.overwrite,m
+000343c0: 7574 653d 5472 7565 290a 2020 2020 2020  ute=True).      
+000343d0: 2020 2320 7072 696e 7428 636c 6f75 6466    # print(cloudf
+000343e0: 696c 652b 2720 7570 6c6f 6164 2064 6f6e  ile+' upload don
+000343f0: 652e 2729 0a0a 6465 6620 646f 776e 6c6f  e.')..def downlo
+00034400: 6164 2863 6c6f 7564 6669 6c65 2c6c 6f63  ad(cloudfile,loc
+00034410: 616c 6669 6c65 3d4e 6f6e 6529 3a0a 2020  alfile=None):.  
+00034420: 2020 2320 7368 6f72 7463 7574 2069 6620    # shortcut if 
+00034430: 6f6e 6c79 206f 6e65 2063 6c6f 7564 7061  only one cloudpa
+00034440: 7468 2070 6173 7365 6420 696e 2c20 6173  th passed in, as
+00034450: 7375 6d69 6e67 2063 7572 7265 6e74 206c  suming current l
+00034460: 6f63 616c 2077 6f72 6b69 6e67 2064 6972  ocal working dir
+00034470: 6563 746f 7279 0a20 2020 2023 2065 2e67  ectory.    # e.g
+00034480: 2e2c 2027 2f49 6e76 6573 746d 656e 742f  ., '/Investment/
+00034490: 667a 2f66 7a2f 667a 2f64 6174 615f 7464  fz/fz/fz/data_td
+000344a0: 2e6a 736f 6e27 0a20 2020 2069 6620 6c6f  .json'.    if lo
+000344b0: 6361 6c66 696c 6520 6973 204e 6f6e 653a  calfile is None:
+000344c0: 0a20 2020 2020 2020 2070 6174 682c 6669  .        path,fi
+000344d0: 6c65 3d20 6f73 2e70 6174 682e 7370 6c69  le= os.path.spli
+000344e0: 7428 636c 6f75 6466 696c 6529 0a20 2020  t(cloudfile).   
+000344f0: 2020 2020 206c 6f63 616c 6669 6c65 3d66       localfile=f
+00034500: 696c 650a 2020 2020 6462 7820 3d20 6472  ile.    dbx = dr
+00034510: 6f70 626f 782e 4472 6f70 626f 7828 4452  opbox.Dropbox(DR
+00034520: 4f50 424f 585f 4143 4345 5353 5f54 4f4b  OPBOX_ACCESS_TOK
+00034530: 454e 290a 2020 2020 6462 782e 6669 6c65  EN).    dbx.file
+00034540: 735f 646f 776e 6c6f 6164 5f74 6f5f 6669  s_download_to_fi
+00034550: 6c65 286c 6f63 616c 6669 6c65 2c63 6c6f  le(localfile,clo
+00034560: 7564 6669 6c65 290a 2020 2020 7265 7475  udfile).    retu
+00034570: 726e 206c 6f63 616c 6669 6c65 0a0a 6465  rn localfile..de
+00034580: 6620 5f66 696c 6573 5f6c 6973 745f 666f  f _files_list_fo
+00034590: 6c64 6572 5f61 6c6c 2864 6278 2c66 6f6c  lder_all(dbx,fol
+000345a0: 6465 722c 7265 6375 7273 6976 653d 4661  der,recursive=Fa
+000345b0: 6c73 652c 6c69 6d69 743d 3230 3030 293a  lse,limit=2000):
+000345c0: 0a20 2020 2063 7572 203d 2064 6278 2e66  .    cur = dbx.f
+000345d0: 696c 6573 5f6c 6973 745f 666f 6c64 6572  iles_list_folder
+000345e0: 2866 6f6c 6465 722c 7265 6375 7273 6976  (folder,recursiv
+000345f0: 653d 7265 6375 7273 6976 652c 6c69 6d69  e=recursive,limi
+00034600: 743d 6c69 6d69 7429 0a20 2020 2069 7465  t=limit).    ite
+00034610: 6d73 203d 2063 7572 2e65 6e74 7269 6573  ms = cur.entries
+00034620: 0a20 2020 2077 6869 6c65 2063 7572 2e68  .    while cur.h
+00034630: 6173 5f6d 6f72 653d 3d54 7275 653a 0a20  as_more==True:. 
+00034640: 2020 2020 2020 2063 7572 203d 2064 6278         cur = dbx
+00034650: 2e66 696c 6573 5f6c 6973 745f 666f 6c64  .files_list_fold
+00034660: 6572 5f63 6f6e 7469 6e75 6528 6375 722e  er_continue(cur.
+00034670: 6375 7273 6f72 290a 2020 2020 2020 2020  cursor).        
+00034680: 6974 656d 732e 6578 7465 6e64 2863 7572  items.extend(cur
+00034690: 2e65 6e74 7269 6573 290a 2020 2020 7265  .entries).    re
+000346a0: 7475 726e 2069 7465 6d73 0a0a 6465 6620  turn items..def 
+000346b0: 6c73 6669 6c65 2866 6f6c 6465 722c 7265  lsfile(folder,re
+000346c0: 6375 7273 6976 653d 4661 6c73 6529 3a0a  cursive=False):.
+000346d0: 2020 2020 6462 7820 3d20 6472 6f70 626f      dbx = dropbo
+000346e0: 782e 4472 6f70 626f 7828 4452 4f50 424f  x.Dropbox(DROPBO
+000346f0: 585f 4143 4345 5353 5f54 4f4b 454e 290a  X_ACCESS_TOKEN).
+00034700: 2020 2020 6974 656d 7320 3d20 5f66 696c      items = _fil
+00034710: 6573 5f6c 6973 745f 666f 6c64 6572 5f61  es_list_folder_a
+00034720: 6c6c 2864 6278 2c66 6f6c 6465 722c 7265  ll(dbx,folder,re
+00034730: 6375 7273 6976 653d 7265 6375 7273 6976  cursive=recursiv
+00034740: 652c 6c69 6d69 743d 3230 3030 290a 2020  e,limit=2000).  
+00034750: 2020 6669 6c65 7320 3d20 5b5d 0a20 2020    files = [].   
+00034760: 2066 6f72 2069 7465 6d20 696e 2069 7465   for item in ite
+00034770: 6d73 3a0a 2020 2020 2020 2020 6966 2074  ms:.        if t
+00034780: 7970 6528 6974 656d 293d 3d64 726f 7062  ype(item)==dropb
+00034790: 6f78 2e66 696c 6573 2e46 6f6c 6465 724d  ox.files.FolderM
+000347a0: 6574 6164 6174 613a 2063 6f6e 7469 6e75  etadata: continu
+000347b0: 650a 2020 2020 2020 2020 2320 652e 672e  e.        # e.g.
+000347c0: 2c20 272f 496e 7665 7374 6d65 6e74 2f66  , '/Investment/f
+000347d0: 7a2f 667a 2f66 7a2f 6461 7461 5f74 642e  z/fz/fz/data_td.
+000347e0: 6a73 6f6e 272c 2027 6461 7461 5f74 642e  json', 'data_td.
+000347f0: 6a73 6f6e 270a 2020 2020 2020 2020 6669  json'.        fi
+00034800: 6c65 732e 6170 7065 6e64 285b 6974 656d  les.append([item
+00034810: 2e70 6174 685f 6469 7370 6c61 792c 6974  .path_display,it
+00034820: 656d 2e6e 616d 655d 290a 2020 2020 7265  em.name]).    re
+00034830: 7475 726e 2066 696c 6573 0a0a 6465 6620  turn files..def 
+00034840: 6c73 666f 6c64 6572 2866 6f6c 6465 722c  lsfolder(folder,
+00034850: 7265 6375 7273 6976 653d 4661 6c73 6529  recursive=False)
+00034860: 3a0a 2020 2020 6462 7820 3d20 6472 6f70  :.    dbx = drop
+00034870: 626f 782e 4472 6f70 626f 7828 4452 4f50  box.Dropbox(DROP
+00034880: 424f 585f 4143 4345 5353 5f54 4f4b 454e  BOX_ACCESS_TOKEN
+00034890: 290a 2020 2020 6974 656d 7320 3d20 5f66  ).    items = _f
+000348a0: 696c 6573 5f6c 6973 745f 666f 6c64 6572  iles_list_folder
+000348b0: 5f61 6c6c 2864 6278 2c66 6f6c 6465 722c  _all(dbx,folder,
+000348c0: 7265 6375 7273 6976 653d 7265 6375 7273  recursive=recurs
+000348d0: 6976 652c 6c69 6d69 743d 3230 3030 290a  ive,limit=2000).
+000348e0: 2020 2020 6669 6c65 7320 3d20 5b5d 0a20      files = []. 
+000348f0: 2020 2066 6f72 2069 7465 6d20 696e 2069     for item in i
+00034900: 7465 6d73 3a0a 2020 2020 2020 2020 6966  tems:.        if
+00034910: 2074 7970 6528 6974 656d 293d 3d64 726f   type(item)==dro
+00034920: 7062 6f78 2e66 696c 6573 2e46 696c 654d  pbox.files.FileM
+00034930: 6574 6164 6174 613a 2063 6f6e 7469 6e75  etadata: continu
+00034940: 650a 2020 2020 2020 2020 2320 652e 672e  e.        # e.g.
+00034950: 2c20 272f 496e 7665 7374 6d65 6e74 2f66  , '/Investment/f
+00034960: 7a2f 667a 2f66 7a2f 6669 7265 666f 7827  z/fz/fz/firefox'
+00034970: 2c20 2766 6972 6566 6f78 270a 2020 2020  , 'firefox'.    
+00034980: 2020 2020 6669 6c65 732e 6170 7065 6e64      files.append
+00034990: 285b 6974 656d 2e70 6174 685f 6469 7370  ([item.path_disp
+000349a0: 6c61 792c 6974 656d 2e6e 616d 655d 290a  lay,item.name]).
+000349b0: 2020 2020 7265 7475 726e 2066 696c 6573      return files
+000349c0: 0a0a 6465 6620 6465 6c66 696c 6566 6f6c  ..def delfilefol
+000349d0: 6465 7228 6669 6c65 293a 0a20 2020 2023  der(file):.    #
+000349e0: 2044 656c 6574 6520 7468 6520 6669 6c65   Delete the file
+000349f0: 206f 7220 666f 6c64 6572 2061 7420 6120   or folder at a 
+00034a00: 6769 7665 6e20 7061 7468 2e20 4966 2074  given path. If t
+00034a10: 6865 2070 6174 6820 6973 2061 2066 6f6c  he path is a fol
+00034a20: 6465 722c 2061 6c6c 2069 7473 2063 6f6e  der, all its con
+00034a30: 7465 6e74 7320 7769 6c6c 2062 6520 6465  tents will be de
+00034a40: 6c65 7465 6420 746f 6f2e 2041 2073 7563  leted too. A suc
+00034a50: 6365 7373 6675 6c20 7265 7370 6f6e 7365  cessful response
+00034a60: 2069 6e64 6963 6174 6573 2074 6861 7420   indicates that 
+00034a70: 7468 6520 6669 6c65 206f 7220 666f 6c64  the file or fold
+00034a80: 6572 2077 6173 2064 656c 6574 6564 0a20  er was deleted. 
+00034a90: 2020 2064 6278 203d 2064 726f 7062 6f78     dbx = dropbox
+00034aa0: 2e44 726f 7062 6f78 2844 524f 5042 4f58  .Dropbox(DROPBOX
+00034ab0: 5f41 4343 4553 535f 544f 4b45 4e29 0a20  _ACCESS_TOKEN). 
+00034ac0: 2020 2072 6574 7572 6e20 6462 782e 6669     return dbx.fi
+00034ad0: 6c65 735f 6465 6c65 7465 2866 696c 6529  les_delete(file)
+00034ae0: 0a0a 2323 2323 2a2a 2a2a 2a2a 2a2a 2a2a  ..####**********
 00034af0: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
 00034b00: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
 00034b10: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
 00034b20: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
 00034b30: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
-00034b40: 2a2a 2a2a 2a2a 2a2a 2a2a 2a0a 2020 2020  ***********.    
+00034b40: 2a2a 2a2a 2a2a 0a20 2020 2020 2020 2020  ******.         
 00034b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034b70: 2023 2323 232a 4744 7269 7665 2a23 2323   ####*GDrive*###
-00034b80: 230a 2323 2323 2a2a 2a2a 2a2a 2a2a 2a2a  #.####**********
+00034b60: 2020 2020 2020 2020 2020 2020 2323 2323              ####
+00034b70: 2a47 4472 6976 652a 2323 2323 0a23 2323  *GDrive*####.###
+00034b80: 232a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  #***************
 00034b90: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
 00034ba0: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
 00034bb0: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
 00034bc0: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
 00034bd0: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
-00034be0: 2a2a 2a2a 2a2a 0a23 2052 6566 6572 656e  ******.# Referen
-00034bf0: 6365 3a20 0a23 2068 7474 7073 3a2f 2f64  ce: .# https://d
-00034c00: 6f63 732e 6974 6572 6174 6976 652e 6169  ocs.iterative.ai
-00034c10: 2f50 7944 7269 7665 322f 7175 6963 6b73  /PyDrive2/quicks
-00034c20: 7461 7274 2f23 6175 7468 656e 7469 6361  tart/#authentica
-00034c30: 7469 6f6e 0a23 2068 7474 7073 3a2f 2f71  tion.# https://q
-00034c40: 6969 7461 2d63 6f6d 2e74 7261 6e73 6c61  iita-com.transla
-00034c50: 7465 2e67 6f6f 672f 6674 6e65 7874 2f69  te.goog/ftnext/i
-00034c60: 7465 6d73 2f36 3063 6564 3862 6334 3332  tems/60ced8bc432
-00034c70: 6265 6336 3130 3166 303f 5f78 5f74 725f  bec6101f0?_x_tr_
-00034c80: 736c 3d61 7574 6f26 5f78 5f74 725f 746c  sl=auto&_x_tr_tl
-00034c90: 3d65 6e26 5f78 5f74 725f 686c 3d65 6e26  =en&_x_tr_hl=en&
-00034ca0: 5f78 5f74 725f 7074 6f3d 7761 7070 0a23  _x_tr_pto=wapp.#
-00034cb0: 2068 7474 7073 3a2f 2f73 7461 636b 6f76   https://stackov
-00034cc0: 6572 666c 6f77 2e63 6f6d 2f61 2f32 3435  erflow.com/a/245
-00034cd0: 3432 3630 342f 3232 3932 3939 3320 286f  42604/2292993 (o
-00034ce0: 7574 6461 7465 6429 0a0a 2320 5374 6570  utdated)..# Step
-00034cf0: 733a 0a23 2031 2920 4372 6561 7465 2061  s:.# 1) Create a
-00034d00: 6e64 2073 6176 6520 6173 2067 6472 6976  nd save as gdriv
-00034d10: 655f 7365 6372 6574 732e 6a73 6f6e 2028  e_secrets.json (
-00034d20: 4920 7361 7665 6420 7468 6520 636f 6e74  I saved the cont
-00034d30: 656e 7473 2074 6f20 7079 7365 6372 6574  ents to pysecret
-00034d40: 732e 7079 2061 6e64 2064 756d 7020 6974  s.py and dump it
-00034d50: 2074 6f20 7068 7973 6963 616c 206a 736f   to physical jso
-00034d60: 6e20 6669 6c65 290a 2320 3229 2043 7265  n file).# 2) Cre
-00034d70: 6174 6520 7365 7474 696e 6773 2e79 616d  ate settings.yam
-00034d80: 6c0a 2320 3329 2041 7574 686f 7269 7a65  l.# 3) Authorize
-00034d90: 2076 6961 2077 6562 2077 6974 6820 6764   via web with gd
-00034da0: 7269 7665 5f73 6563 7265 7473 2e6a 736f  rive_secrets.jso
-00034db0: 6e20 666f 7220 7468 6520 6669 7273 7420  n for the first 
-00034dc0: 7469 6d65 0a23 2034 2920 4765 7420 7361  time.# 4) Get sa
-00034dd0: 7665 6420 6764 7269 7665 5f63 7265 6465  ved gdrive_crede
-00034de0: 6e74 6961 6c73 2e6a 736f 6e20 7768 6963  ntials.json whic
-00034df0: 6820 6361 6e20 6265 2075 7365 6420 696e  h can be used in
-00034e00: 2074 6865 2066 7574 7572 6520 7769 7468   the future with
-00034e10: 6f75 7420 6e65 6564 2074 6f20 6175 7468  out need to auth
-00034e20: 726f 697a 6520 7669 6120 7765 620a 6465  roize via web.de
-00034e30: 6620 6761 7574 6828 293a 0a20 2020 2023  f gauth():.    #
-00034e40: 2077 6f72 6b20 696e 206c 6962 7261 7279   work in library
-00034e50: 2070 6174 680a 2020 2020 6f6c 6470 7764   path.    oldpwd
-00034e60: 203d 206f 732e 6765 7463 7764 2829 0a20   = os.getcwd(). 
-00034e70: 2020 206f 732e 6368 6469 7228 6f73 2e70     os.chdir(os.p
-00034e80: 6174 682e 6469 726e 616d 6528 6f73 2e70  ath.dirname(os.p
-00034e90: 6174 682e 6162 7370 6174 6828 5f5f 6669  ath.abspath(__fi
-00034ea0: 6c65 5f5f 2929 290a 0a20 2020 2066 726f  le__)))..    fro
-00034eb0: 6d20 7079 6472 6976 6532 2e61 7574 6820  m pydrive2.auth 
-00034ec0: 696d 706f 7274 2047 6f6f 676c 6541 7574  import GoogleAut
-00034ed0: 680a 2020 2020 6672 6f6d 2070 7964 7269  h.    from pydri
-00034ee0: 7665 322e 6472 6976 6520 696d 706f 7274  ve2.drive import
-00034ef0: 2047 6f6f 676c 6544 7269 7665 0a0a 2020   GoogleDrive..  
-00034f00: 2020 2320 6a65 7272 793a 2064 756d 7020    # jerry: dump 
-00034f10: 6764 7269 7665 5f73 6563 7265 7473 2e6a  gdrive_secrets.j
-00034f20: 736f 6e0a 2020 2020 7361 7665 6a28 4744  son.    savej(GD
-00034f30: 5249 5645 5f4b 4559 2c27 6764 7269 7665  RIVE_KEY,'gdrive
-00034f40: 5f73 6563 7265 7473 2e6a 736f 6e27 290a  _secrets.json').
-00034f50: 2020 2020 7365 7474 696e 6773 3d22 2222      settings="""
-00034f60: 0a20 2020 2020 2020 2020 2020 2063 6c69  .            cli
-00034f70: 656e 745f 636f 6e66 6967 5f66 696c 653a  ent_config_file:
-00034f80: 2067 6472 6976 655f 7365 6372 6574 732e   gdrive_secrets.
-00034f90: 6a73 6f6e 0a20 2020 2020 2020 2020 2020  json.           
-00034fa0: 2073 6176 655f 6372 6564 656e 7469 616c   save_credential
-00034fb0: 733a 2054 7275 650a 2020 2020 2020 2020  s: True.        
-00034fc0: 2020 2020 7361 7665 5f63 7265 6465 6e74      save_credent
-00034fd0: 6961 6c73 5f62 6163 6b65 6e64 3a20 6669  ials_backend: fi
-00034fe0: 6c65 0a20 2020 2020 2020 2020 2020 2073  le.            s
-00034ff0: 6176 655f 6372 6564 656e 7469 616c 735f  ave_credentials_
-00035000: 6669 6c65 3a20 6764 7269 7665 5f63 7265  file: gdrive_cre
-00035010: 6465 6e74 6961 6c73 2e6a 736f 6e0a 2020  dentials.json.  
-00035020: 2020 2020 2020 2020 2020 6765 745f 7265            get_re
-00035030: 6672 6573 685f 746f 6b65 6e3a 2054 7275  fresh_token: Tru
-00035040: 650a 2020 2020 2020 2020 2020 2020 2222  e.            ""
-00035050: 220a 2020 2020 7769 7468 206f 7065 6e28  ".    with open(
-00035060: 2773 6574 7469 6e67 732e 7961 6d6c 272c  'settings.yaml',
-00035070: 2027 7727 2920 6173 2066 3a0a 2020 2020   'w') as f:.    
-00035080: 2020 2020 662e 7772 6974 6528 7365 7474      f.write(sett
-00035090: 696e 6773 290a 0a20 2020 2067 6f6f 676c  ings)..    googl
-000350a0: 6561 7574 6820 3d20 476f 6f67 6c65 4175  eauth = GoogleAu
-000350b0: 7468 2829 0a20 2020 2067 6f6f 676c 6561  th().    googlea
-000350c0: 7574 682e 4c6f 6361 6c57 6562 7365 7276  uth.LocalWebserv
-000350d0: 6572 4175 7468 2829 0a20 2020 2067 6472  erAuth().    gdr
-000350e0: 6976 6520 3d20 476f 6f67 6c65 4472 6976  ive = GoogleDriv
-000350f0: 6528 676f 6f67 6c65 6175 7468 290a 0a20  e(googleauth).. 
-00035100: 2020 206f 732e 6368 6469 7228 6f6c 6470     os.chdir(oldp
-00035110: 7764 290a 2020 2020 7265 7475 726e 2067  wd).    return g
-00035120: 6472 6976 650a 0a64 6566 2067 646f 776e  drive..def gdown
-00035130: 6c6f 6164 2869 642c 6669 6c65 6e61 6d65  load(id,filename
-00035140: 293a 0a20 2020 2022 2222 0a20 2020 2065  ):.    """.    e
-00035150: 7870 6f72 742f 646f 776e 6c6f 6164 2061  xport/download a
-00035160: 2066 696c 650a 2020 2020 6964 3a20 6765   file.    id: ge
-00035170: 7420 6672 6f6d 206c 696e 6b0a 2020 2020  t from link.    
-00035180: 7468 6520 646f 776e 6c6f 6164 6564 2066  the downloaded f
-00035190: 696c 6520 6d61 7920 6e6f 7420 6861 7665  ile may not have
-000351a0: 2074 6865 2065 7861 6374 2073 616d 6520   the exact same 
-000351b0: 636f 6e74 656e 7420 666f 726d 6174 7469  content formatti
-000351c0: 6e67 0a20 2020 2022 2222 0a20 2020 2067  ng.    """.    g
-000351d0: 6472 6976 6520 3d20 6761 7574 6828 290a  drive = gauth().
-000351e0: 2020 2020 2320 6874 7470 733a 2f2f 6465      # https://de
-000351f0: 7665 6c6f 7065 7273 2e67 6f6f 676c 652e  velopers.google.
-00035200: 636f 6d2f 6472 6976 652f 6170 692f 6775  com/drive/api/gu
-00035210: 6964 6573 2f72 6566 2d65 7870 6f72 742d  ides/ref-export-
-00035220: 666f 726d 6174 730a 2020 2020 6766 696c  formats.    gfil
-00035230: 6520 3d20 6764 7269 7665 2e43 7265 6174  e = gdrive.Creat
-00035240: 6546 696c 6528 7b27 6964 273a 2069 647d  eFile({'id': id}
-00035250: 290a 2020 2020 464f 524d 4154 5320 3d20  ).    FORMATS = 
-00035260: 7b20 0a20 2020 2020 2020 2020 2020 2020  { .             
-00035270: 2020 2027 2e74 7874 273a 2027 7465 7874     '.txt': 'text
-00035280: 2f70 6c61 696e 272c 0a20 2020 2020 2020  /plain',.       
-00035290: 2020 2020 2020 2020 2027 2e72 7466 273a           '.rtf':
-000352a0: 2027 6170 706c 6963 6174 696f 6e2f 7274   'application/rt
-000352b0: 6627 2c0a 2020 2020 2020 2020 2020 2020  f',.            
-000352c0: 2020 2020 272e 7064 6627 3a20 2761 7070      '.pdf': 'app
-000352d0: 6c69 6361 7469 6f6e 2f70 6466 272c 0a20  lication/pdf',. 
-000352e0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-000352f0: 2e64 6f63 7827 3a20 2761 7070 6c69 6361  .docx': 'applica
-00035300: 7469 6f6e 2f76 6e64 2e6f 7065 6e78 6d6c  tion/vnd.openxml
-00035310: 666f 726d 6174 732d 6f66 6669 6365 646f  formats-officedo
-00035320: 6375 6d65 6e74 2e77 6f72 6470 726f 6365  cument.wordproce
-00035330: 7373 696e 676d 6c2e 646f 6375 6d65 6e74  ssingml.document
-00035340: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
-00035350: 2020 2027 2e78 6c73 7827 3a20 2761 7070     '.xlsx': 'app
-00035360: 6c69 6361 7469 6f6e 2f76 6e64 2e6f 7065  lication/vnd.ope
-00035370: 6e78 6d6c 666f 726d 6174 732d 6f66 6669  nxmlformats-offi
-00035380: 6365 646f 6375 6d65 6e74 2e73 7072 6561  cedocument.sprea
-00035390: 6473 6865 6574 6d6c 2e73 6865 6574 272c  dsheetml.sheet',
-000353a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000353b0: 2027 2e70 6e67 273a 2027 696d 6167 652f   '.png': 'image/
-000353c0: 706e 6727 2c0a 2020 2020 2020 2020 2020  png',.          
-000353d0: 2020 2020 2020 272e 7376 6727 3a20 2769        '.svg': 'i
-000353e0: 6d61 6765 2f73 7667 2b78 6d6c 272c 0a20  mage/svg+xml',. 
-000353f0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00035400: 2e70 7074 7827 3a20 2761 7070 6c69 6361  .pptx': 'applica
-00035410: 7469 6f6e 2f76 6e64 2e6f 7065 6e78 6d6c  tion/vnd.openxml
-00035420: 666f 726d 6174 732d 6f66 6669 6365 646f  formats-officedo
-00035430: 6375 6d65 6e74 2e70 7265 7365 6e74 6174  cument.presentat
-00035440: 696f 6e6d 6c2e 7072 6573 656e 7461 7469  ionml.presentati
-00035450: 6f6e 272c 0a20 2020 2020 2020 2020 2020  on',.           
-00035460: 2020 2020 7d0a 2020 2020 6766 696c 652e      }.    gfile.
-00035470: 4765 7443 6f6e 7465 6e74 4669 6c65 2866  GetContentFile(f
-00035480: 696c 656e 616d 652c 2046 4f52 4d41 5453  ilename, FORMATS
-00035490: 5b73 706c 6974 7061 7468 2866 696c 656e  [splitpath(filen
-000354a0: 616d 6529 5b2d 315d 5d29 0a20 2020 2072  ame)[-1]]).    r
-000354b0: 6574 7572 6e20 6669 6c65 6e61 6d65 0a0a  eturn filename..
-000354c0: 6465 6620 6763 6f70 7928 6964 2c66 696c  def gcopy(id,fil
-000354d0: 6574 6974 6c65 2c66 6f6c 6465 7269 643d  etitle,folderid=
-000354e0: 4e6f 6e65 293a 0a20 2020 2022 2222 0a20  None):.    """. 
-000354f0: 2020 206d 616b 6520 6120 636f 7079 206f     make a copy o
-00035500: 6620 6669 6c65 2069 6e20 6764 7269 7665  f file in gdrive
-00035510: 0a20 2020 2069 643a 2067 6574 2066 726f  .    id: get fro
-00035520: 6d20 6c69 6e6b 0a20 2020 2066 696c 6574  m link.    filet
-00035530: 6974 6c65 3a20 6e65 7720 6669 6c65 2074  itle: new file t
-00035540: 6974 6c65 2f6e 616d 650a 2020 2020 666f  itle/name.    fo
-00035550: 6c64 6572 6964 3a20 636f 7079 2074 6f20  lderid: copy to 
-00035560: 6120 666f 6c64 6572 206f 7468 6572 2074  a folder other t
-00035570: 6861 6e20 726f 6f74 205b 6f70 7469 6f6e  han root [option
-00035580: 616c 5d2c 2067 6574 2066 726f 6d20 6c69  al], get from li
-00035590: 6e6b 0a20 2020 2022 2222 0a20 2020 2023  nk.    """.    #
-000355a0: 2068 7474 7073 3a2f 2f64 6576 656c 6f70   https://develop
-000355b0: 6572 732e 676f 6f67 6c65 2e63 6f6d 2f64  ers.google.com/d
-000355c0: 7269 7665 2f61 7069 2f76 322f 7265 6665  rive/api/v2/refe
-000355d0: 7265 6e63 652f 6669 6c65 732f 636f 7079  rence/files/copy
-000355e0: 0a20 2020 2023 2068 7474 7073 3a2f 2f73  .    # https://s
-000355f0: 7461 636b 6f76 6572 666c 6f77 2e63 6f6d  tackoverflow.com
-00035600: 2f71 7565 7374 696f 6e73 2f34 3338 3635  /questions/43865
-00035610: 3031 362f 7079 7468 6f6e 2d63 6f70 792d  016/python-copy-
-00035620: 612d 6669 6c65 2d69 6e2d 676f 6f67 6c65  a-file-in-google
-00035630: 2d64 7269 7665 2d69 6e74 6f2d 612d 7370  -drive-into-a-sp
-00035640: 6563 6966 6963 2d66 6f6c 6465 720a 2020  ecific-folder.  
-00035650: 2020 2320 6874 7470 733a 2f2f 6769 7468    # https://gith
-00035660: 7562 2e63 6f6d 2f69 7465 7261 7469 7665  ub.com/iterative
-00035670: 2f50 7944 7269 7665 322f 6973 7375 6573  /PyDrive2/issues
-00035680: 2f35 330a 2020 2020 6764 7269 7665 203d  /53.    gdrive =
-00035690: 2067 6175 7468 2829 0a20 2020 2023 2068   gauth().    # h
-000356a0: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
-000356b0: 6d2f 676f 6f67 6c65 6172 6368 6976 652f  m/googlearchive/
-000356c0: 5079 4472 6976 652f 626c 6f62 2f39 3836  PyDrive/blob/986
-000356d0: 6164 3866 6234 6636 3864 6465 3666 6661  ad8fb4f68dde6ffa
-000356e0: 6137 6336 3163 3935 3164 3935 3733 3331  a7c61c951d957331
-000356f0: 3464 6561 302f 7079 6472 6976 652f 6175  4dea0/pydrive/au
-00035700: 7468 2e70 7923 4c36 310a 2020 2020 6764  th.py#L61.    gd
-00035710: 7269 7665 2e61 7574 682e 4175 7468 6f72  rive.auth.Author
-00035720: 697a 6528 2920 2320 6e65 6564 6564 2c20  ize() # needed, 
-00035730: 6f74 6865 7277 6973 6520 6764 7269 7665  otherwise gdrive
-00035740: 2e61 7574 682e 7365 7276 6963 6520 6973  .auth.service is
-00035750: 204e 6f6e 650a 2020 2020 6966 2066 6f6c   None.    if fol
-00035760: 6465 7269 6420 6973 204e 6f6e 653a 0a20  derid is None:. 
-00035770: 2020 2020 2020 2067 6472 6976 652e 6175         gdrive.au
-00035780: 7468 2e73 6572 7669 6365 2e66 696c 6573  th.service.files
-00035790: 2829 2e63 6f70 7928 6669 6c65 4964 3d69  ().copy(fileId=i
-000357a0: 642c 0a20 2020 2020 2020 2020 2020 2020  d,.             
+00034be0: 2a0a 2320 5265 6665 7265 6e63 653a 200a  *.# Reference: .
+00034bf0: 2320 6874 7470 733a 2f2f 646f 6373 2e69  # https://docs.i
+00034c00: 7465 7261 7469 7665 2e61 692f 5079 4472  terative.ai/PyDr
+00034c10: 6976 6532 2f71 7569 636b 7374 6172 742f  ive2/quickstart/
+00034c20: 2361 7574 6865 6e74 6963 6174 696f 6e0a  #authentication.
+00034c30: 2320 6874 7470 733a 2f2f 7169 6974 612d  # https://qiita-
+00034c40: 636f 6d2e 7472 616e 736c 6174 652e 676f  com.translate.go
+00034c50: 6f67 2f66 746e 6578 742f 6974 656d 732f  og/ftnext/items/
+00034c60: 3630 6365 6438 6263 3433 3262 6563 3631  60ced8bc432bec61
+00034c70: 3031 6630 3f5f 785f 7472 5f73 6c3d 6175  01f0?_x_tr_sl=au
+00034c80: 746f 265f 785f 7472 5f74 6c3d 656e 265f  to&_x_tr_tl=en&_
+00034c90: 785f 7472 5f68 6c3d 656e 265f 785f 7472  x_tr_hl=en&_x_tr
+00034ca0: 5f70 746f 3d77 6170 700a 2320 6874 7470  _pto=wapp.# http
+00034cb0: 733a 2f2f 7374 6163 6b6f 7665 7266 6c6f  s://stackoverflo
+00034cc0: 772e 636f 6d2f 612f 3234 3534 3236 3034  w.com/a/24542604
+00034cd0: 2f32 3239 3239 3933 2028 6f75 7464 6174  /2292993 (outdat
+00034ce0: 6564 290a 0a23 2053 7465 7073 3a0a 2320  ed)..# Steps:.# 
+00034cf0: 3129 2043 7265 6174 6520 616e 6420 7361  1) Create and sa
+00034d00: 7665 2061 7320 6764 7269 7665 5f73 6563  ve as gdrive_sec
+00034d10: 7265 7473 2e6a 736f 6e20 2849 2073 6176  rets.json (I sav
+00034d20: 6564 2074 6865 2063 6f6e 7465 6e74 7320  ed the contents 
+00034d30: 746f 2070 7973 6563 7265 7473 2e70 7920  to pysecrets.py 
+00034d40: 616e 6420 6475 6d70 2069 7420 746f 2070  and dump it to p
+00034d50: 6879 7369 6361 6c20 6a73 6f6e 2066 696c  hysical json fil
+00034d60: 6529 0a23 2032 2920 4372 6561 7465 2073  e).# 2) Create s
+00034d70: 6574 7469 6e67 732e 7961 6d6c 0a23 2033  ettings.yaml.# 3
+00034d80: 2920 4175 7468 6f72 697a 6520 7669 6120  ) Authorize via 
+00034d90: 7765 6220 7769 7468 2067 6472 6976 655f  web with gdrive_
+00034da0: 7365 6372 6574 732e 6a73 6f6e 2066 6f72  secrets.json for
+00034db0: 2074 6865 2066 6972 7374 2074 696d 650a   the first time.
+00034dc0: 2320 3429 2047 6574 2073 6176 6564 2067  # 4) Get saved g
+00034dd0: 6472 6976 655f 6372 6564 656e 7469 616c  drive_credential
+00034de0: 732e 6a73 6f6e 2077 6869 6368 2063 616e  s.json which can
+00034df0: 2062 6520 7573 6564 2069 6e20 7468 6520   be used in the 
+00034e00: 6675 7475 7265 2077 6974 686f 7574 206e  future without n
+00034e10: 6565 6420 746f 2061 7574 6872 6f69 7a65  eed to authroize
+00034e20: 2076 6961 2077 6562 0a64 6566 2067 6175   via web.def gau
+00034e30: 7468 2829 3a0a 2020 2020 2320 776f 726b  th():.    # work
+00034e40: 2069 6e20 6c69 6272 6172 7920 7061 7468   in library path
+00034e50: 0a20 2020 206f 6c64 7077 6420 3d20 6f73  .    oldpwd = os
+00034e60: 2e67 6574 6377 6428 290a 2020 2020 6f73  .getcwd().    os
+00034e70: 2e63 6864 6972 286f 732e 7061 7468 2e64  .chdir(os.path.d
+00034e80: 6972 6e61 6d65 286f 732e 7061 7468 2e61  irname(os.path.a
+00034e90: 6273 7061 7468 285f 5f66 696c 655f 5f29  bspath(__file__)
+00034ea0: 2929 0a0a 2020 2020 6672 6f6d 2070 7964  ))..    from pyd
+00034eb0: 7269 7665 322e 6175 7468 2069 6d70 6f72  rive2.auth impor
+00034ec0: 7420 476f 6f67 6c65 4175 7468 0a20 2020  t GoogleAuth.   
+00034ed0: 2066 726f 6d20 7079 6472 6976 6532 2e64   from pydrive2.d
+00034ee0: 7269 7665 2069 6d70 6f72 7420 476f 6f67  rive import Goog
+00034ef0: 6c65 4472 6976 650a 0a20 2020 2023 206a  leDrive..    # j
+00034f00: 6572 7279 3a20 6475 6d70 2067 6472 6976  erry: dump gdriv
+00034f10: 655f 7365 6372 6574 732e 6a73 6f6e 0a20  e_secrets.json. 
+00034f20: 2020 2073 6176 656a 2847 4452 4956 455f     savej(GDRIVE_
+00034f30: 4b45 592c 2767 6472 6976 655f 7365 6372  KEY,'gdrive_secr
+00034f40: 6574 732e 6a73 6f6e 2729 0a20 2020 2073  ets.json').    s
+00034f50: 6574 7469 6e67 733d 2222 220a 2020 2020  ettings=""".    
+00034f60: 2020 2020 2020 2020 636c 6965 6e74 5f63          client_c
+00034f70: 6f6e 6669 675f 6669 6c65 3a20 6764 7269  onfig_file: gdri
+00034f80: 7665 5f73 6563 7265 7473 2e6a 736f 6e0a  ve_secrets.json.
+00034f90: 2020 2020 2020 2020 2020 2020 7361 7665              save
+00034fa0: 5f63 7265 6465 6e74 6961 6c73 3a20 5472  _credentials: Tr
+00034fb0: 7565 0a20 2020 2020 2020 2020 2020 2073  ue.            s
+00034fc0: 6176 655f 6372 6564 656e 7469 616c 735f  ave_credentials_
+00034fd0: 6261 636b 656e 643a 2066 696c 650a 2020  backend: file.  
+00034fe0: 2020 2020 2020 2020 2020 7361 7665 5f63            save_c
+00034ff0: 7265 6465 6e74 6961 6c73 5f66 696c 653a  redentials_file:
+00035000: 2067 6472 6976 655f 6372 6564 656e 7469   gdrive_credenti
+00035010: 616c 732e 6a73 6f6e 0a20 2020 2020 2020  als.json.       
+00035020: 2020 2020 2067 6574 5f72 6566 7265 7368       get_refresh
+00035030: 5f74 6f6b 656e 3a20 5472 7565 0a20 2020  _token: True.   
+00035040: 2020 2020 2020 2020 2022 2222 0a20 2020           """.   
+00035050: 2077 6974 6820 6f70 656e 2827 7365 7474   with open('sett
+00035060: 696e 6773 2e79 616d 6c27 2c20 2777 2729  ings.yaml', 'w')
+00035070: 2061 7320 663a 0a20 2020 2020 2020 2066   as f:.        f
+00035080: 2e77 7269 7465 2873 6574 7469 6e67 7329  .write(settings)
+00035090: 0a0a 2020 2020 676f 6f67 6c65 6175 7468  ..    googleauth
+000350a0: 203d 2047 6f6f 676c 6541 7574 6828 290a   = GoogleAuth().
+000350b0: 2020 2020 676f 6f67 6c65 6175 7468 2e4c      googleauth.L
+000350c0: 6f63 616c 5765 6273 6572 7665 7241 7574  ocalWebserverAut
+000350d0: 6828 290a 2020 2020 6764 7269 7665 203d  h().    gdrive =
+000350e0: 2047 6f6f 676c 6544 7269 7665 2867 6f6f   GoogleDrive(goo
+000350f0: 676c 6561 7574 6829 0a0a 2020 2020 6f73  gleauth)..    os
+00035100: 2e63 6864 6972 286f 6c64 7077 6429 0a20  .chdir(oldpwd). 
+00035110: 2020 2072 6574 7572 6e20 6764 7269 7665     return gdrive
+00035120: 0a0a 6465 6620 6764 6f77 6e6c 6f61 6428  ..def gdownload(
+00035130: 6964 2c66 696c 656e 616d 6529 3a0a 2020  id,filename):.  
+00035140: 2020 2222 220a 2020 2020 6578 706f 7274    """.    export
+00035150: 2f64 6f77 6e6c 6f61 6420 6120 6669 6c65  /download a file
+00035160: 0a20 2020 2069 643a 2067 6574 2066 726f  .    id: get fro
+00035170: 6d20 6c69 6e6b 0a20 2020 2074 6865 2064  m link.    the d
+00035180: 6f77 6e6c 6f61 6465 6420 6669 6c65 206d  ownloaded file m
+00035190: 6179 206e 6f74 2068 6176 6520 7468 6520  ay not have the 
+000351a0: 6578 6163 7420 7361 6d65 2063 6f6e 7465  exact same conte
+000351b0: 6e74 2066 6f72 6d61 7474 696e 670a 2020  nt formatting.  
+000351c0: 2020 2222 220a 2020 2020 6764 7269 7665    """.    gdrive
+000351d0: 203d 2067 6175 7468 2829 0a20 2020 2023   = gauth().    #
+000351e0: 2068 7474 7073 3a2f 2f64 6576 656c 6f70   https://develop
+000351f0: 6572 732e 676f 6f67 6c65 2e63 6f6d 2f64  ers.google.com/d
+00035200: 7269 7665 2f61 7069 2f67 7569 6465 732f  rive/api/guides/
+00035210: 7265 662d 6578 706f 7274 2d66 6f72 6d61  ref-export-forma
+00035220: 7473 0a20 2020 2067 6669 6c65 203d 2067  ts.    gfile = g
+00035230: 6472 6976 652e 4372 6561 7465 4669 6c65  drive.CreateFile
+00035240: 287b 2769 6427 3a20 6964 7d29 0a20 2020  ({'id': id}).   
+00035250: 2046 4f52 4d41 5453 203d 207b 200a 2020   FORMATS = { .  
+00035260: 2020 2020 2020 2020 2020 2020 2020 272e                '.
+00035270: 7478 7427 3a20 2774 6578 742f 706c 6169  txt': 'text/plai
+00035280: 6e27 2c0a 2020 2020 2020 2020 2020 2020  n',.            
+00035290: 2020 2020 272e 7274 6627 3a20 2761 7070      '.rtf': 'app
+000352a0: 6c69 6361 7469 6f6e 2f72 7466 272c 0a20  lication/rtf',. 
+000352b0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+000352c0: 2e70 6466 273a 2027 6170 706c 6963 6174  .pdf': 'applicat
+000352d0: 696f 6e2f 7064 6627 2c0a 2020 2020 2020  ion/pdf',.      
+000352e0: 2020 2020 2020 2020 2020 272e 646f 6378            '.docx
+000352f0: 273a 2027 6170 706c 6963 6174 696f 6e2f  ': 'application/
+00035300: 766e 642e 6f70 656e 786d 6c66 6f72 6d61  vnd.openxmlforma
+00035310: 7473 2d6f 6666 6963 6564 6f63 756d 656e  ts-officedocumen
+00035320: 742e 776f 7264 7072 6f63 6573 7369 6e67  t.wordprocessing
+00035330: 6d6c 2e64 6f63 756d 656e 7427 2c0a 2020  ml.document',.  
+00035340: 2020 2020 2020 2020 2020 2020 2020 272e                '.
+00035350: 786c 7378 273a 2027 6170 706c 6963 6174  xlsx': 'applicat
+00035360: 696f 6e2f 766e 642e 6f70 656e 786d 6c66  ion/vnd.openxmlf
+00035370: 6f72 6d61 7473 2d6f 6666 6963 6564 6f63  ormats-officedoc
+00035380: 756d 656e 742e 7370 7265 6164 7368 6565  ument.spreadshee
+00035390: 746d 6c2e 7368 6565 7427 2c0a 2020 2020  tml.sheet',.    
+000353a0: 2020 2020 2020 2020 2020 2020 272e 706e              '.pn
+000353b0: 6727 3a20 2769 6d61 6765 2f70 6e67 272c  g': 'image/png',
+000353c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000353d0: 2027 2e73 7667 273a 2027 696d 6167 652f   '.svg': 'image/
+000353e0: 7376 672b 786d 6c27 2c0a 2020 2020 2020  svg+xml',.      
+000353f0: 2020 2020 2020 2020 2020 272e 7070 7478            '.pptx
+00035400: 273a 2027 6170 706c 6963 6174 696f 6e2f  ': 'application/
+00035410: 766e 642e 6f70 656e 786d 6c66 6f72 6d61  vnd.openxmlforma
+00035420: 7473 2d6f 6666 6963 6564 6f63 756d 656e  ts-officedocumen
+00035430: 742e 7072 6573 656e 7461 7469 6f6e 6d6c  t.presentationml
+00035440: 2e70 7265 7365 6e74 6174 696f 6e27 2c0a  .presentation',.
+00035450: 2020 2020 2020 2020 2020 2020 2020 207d                 }
+00035460: 0a20 2020 2067 6669 6c65 2e47 6574 436f  .    gfile.GetCo
+00035470: 6e74 656e 7446 696c 6528 6669 6c65 6e61  ntentFile(filena
+00035480: 6d65 2c20 464f 524d 4154 535b 7370 6c69  me, FORMATS[spli
+00035490: 7470 6174 6828 6669 6c65 6e61 6d65 295b  tpath(filename)[
+000354a0: 2d31 5d5d 290a 2020 2020 7265 7475 726e  -1]]).    return
+000354b0: 2066 696c 656e 616d 650a 0a64 6566 2067   filename..def g
+000354c0: 636f 7079 2869 642c 6669 6c65 7469 746c  copy(id,filetitl
+000354d0: 652c 666f 6c64 6572 6964 3d4e 6f6e 6529  e,folderid=None)
+000354e0: 3a0a 2020 2020 2222 220a 2020 2020 6d61  :.    """.    ma
+000354f0: 6b65 2061 2063 6f70 7920 6f66 2066 696c  ke a copy of fil
+00035500: 6520 696e 2067 6472 6976 650a 2020 2020  e in gdrive.    
+00035510: 6964 3a20 6765 7420 6672 6f6d 206c 696e  id: get from lin
+00035520: 6b0a 2020 2020 6669 6c65 7469 746c 653a  k.    filetitle:
+00035530: 206e 6577 2066 696c 6520 7469 746c 652f   new file title/
+00035540: 6e61 6d65 0a20 2020 2066 6f6c 6465 7269  name.    folderi
+00035550: 643a 2063 6f70 7920 746f 2061 2066 6f6c  d: copy to a fol
+00035560: 6465 7220 6f74 6865 7220 7468 616e 2072  der other than r
+00035570: 6f6f 7420 5b6f 7074 696f 6e61 6c5d 2c20  oot [optional], 
+00035580: 6765 7420 6672 6f6d 206c 696e 6b0a 2020  get from link.  
+00035590: 2020 2222 220a 2020 2020 2320 6874 7470    """.    # http
+000355a0: 733a 2f2f 6465 7665 6c6f 7065 7273 2e67  s://developers.g
+000355b0: 6f6f 676c 652e 636f 6d2f 6472 6976 652f  oogle.com/drive/
+000355c0: 6170 692f 7632 2f72 6566 6572 656e 6365  api/v2/reference
+000355d0: 2f66 696c 6573 2f63 6f70 790a 2020 2020  /files/copy.    
+000355e0: 2320 6874 7470 733a 2f2f 7374 6163 6b6f  # https://stacko
+000355f0: 7665 7266 6c6f 772e 636f 6d2f 7175 6573  verflow.com/ques
+00035600: 7469 6f6e 732f 3433 3836 3530 3136 2f70  tions/43865016/p
+00035610: 7974 686f 6e2d 636f 7079 2d61 2d66 696c  ython-copy-a-fil
+00035620: 652d 696e 2d67 6f6f 676c 652d 6472 6976  e-in-google-driv
+00035630: 652d 696e 746f 2d61 2d73 7065 6369 6669  e-into-a-specifi
+00035640: 632d 666f 6c64 6572 0a20 2020 2023 2068  c-folder.    # h
+00035650: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
+00035660: 6d2f 6974 6572 6174 6976 652f 5079 4472  m/iterative/PyDr
+00035670: 6976 6532 2f69 7373 7565 732f 3533 0a20  ive2/issues/53. 
+00035680: 2020 2067 6472 6976 6520 3d20 6761 7574     gdrive = gaut
+00035690: 6828 290a 2020 2020 2320 6874 7470 733a  h().    # https:
+000356a0: 2f2f 6769 7468 7562 2e63 6f6d 2f67 6f6f  //github.com/goo
+000356b0: 676c 6561 7263 6869 7665 2f50 7944 7269  glearchive/PyDri
+000356c0: 7665 2f62 6c6f 622f 3938 3661 6438 6662  ve/blob/986ad8fb
+000356d0: 3466 3638 6464 6536 6666 6161 3763 3631  4f68dde6ffaa7c61
+000356e0: 6339 3531 6439 3537 3333 3134 6465 6130  c951d9573314dea0
+000356f0: 2f70 7964 7269 7665 2f61 7574 682e 7079  /pydrive/auth.py
+00035700: 234c 3631 0a20 2020 2067 6472 6976 652e  #L61.    gdrive.
+00035710: 6175 7468 2e41 7574 686f 7269 7a65 2829  auth.Authorize()
+00035720: 2023 206e 6565 6465 642c 206f 7468 6572   # needed, other
+00035730: 7769 7365 2067 6472 6976 652e 6175 7468  wise gdrive.auth
+00035740: 2e73 6572 7669 6365 2069 7320 4e6f 6e65  .service is None
+00035750: 0a20 2020 2069 6620 666f 6c64 6572 6964  .    if folderid
+00035760: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+00035770: 2020 6764 7269 7665 2e61 7574 682e 7365    gdrive.auth.se
+00035780: 7276 6963 652e 6669 6c65 7328 292e 636f  rvice.files().co
+00035790: 7079 2866 696c 6549 643d 6964 2c0a 2020  py(fileId=id,.  
+000357a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000357b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000357c0: 2020 2020 2020 2020 2020 2020 626f 6479              body
-000357d0: 3d7b 2774 6974 6c65 273a 2066 696c 6574  ={'title': filet
-000357e0: 6974 6c65 7d29 2e65 7865 6375 7465 2829  itle}).execute()
-000357f0: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
-00035800: 2020 2067 6472 6976 652e 6175 7468 2e73     gdrive.auth.s
-00035810: 6572 7669 6365 2e66 696c 6573 2829 2e63  ervice.files().c
-00035820: 6f70 7928 6669 6c65 4964 3d69 642c 0a20  opy(fileId=id,. 
+000357c0: 2020 2020 2020 2062 6f64 793d 7b27 7469         body={'ti
+000357d0: 746c 6527 3a20 6669 6c65 7469 746c 657d  tle': filetitle}
+000357e0: 292e 6578 6563 7574 6528 290a 2020 2020  ).execute().    
+000357f0: 656c 7365 3a0a 2020 2020 2020 2020 6764  else:.        gd
+00035800: 7269 7665 2e61 7574 682e 7365 7276 6963  rive.auth.servic
+00035810: 652e 6669 6c65 7328 292e 636f 7079 2866  e.files().copy(f
+00035820: 696c 6549 643d 6964 2c0a 2020 2020 2020  ileId=id,.      
 00035830: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00035840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035850: 2020 2020 2020 2020 626f 6479 3d7b 2270          body={"p
-00035860: 6172 656e 7473 223a 205b 7b22 6964 223a  arents": [{"id":
-00035870: 2066 6f6c 6465 7269 647d 5d2c 2774 6974   folderid}],'tit
-00035880: 6c65 273a 2066 696c 6574 6974 6c65 7d29  le': filetitle})
-00035890: 2e65 7865 6375 7465 2829 0a20 2020 2072  .execute().    r
-000358a0: 6574 7572 6e20 6669 6c65 7469 746c 650a  eturn filetitle.
-000358b0: 0a64 6566 2067 6c73 2866 6f6c 6465 7269  .def gls(folderi
-000358c0: 643d 4e6f 6e65 293a 0a20 2020 2022 2222  d=None):.    """
-000358d0: 0a20 2020 206c 7320 6669 6c65 7320 616e  .    ls files an
-000358e0: 6420 666f 6c64 6572 7320 696e 2061 2066  d folders in a f
-000358f0: 6f6c 6465 7220 286e 6f74 2069 6e63 6c75  older (not inclu
-00035900: 6469 6e67 2074 7261 7368 6564 290a 2020  ding trashed).  
-00035910: 2020 666f 6c64 6572 6964 3a20 6f70 7469    folderid: opti
-00035920: 6f6e 616c 2c20 6966 204e 6f6e 6520 2864  onal, if None (d
-00035930: 6566 6175 6c74 292c 2073 6561 7263 6820  efault), search 
-00035940: 726f 6f74 2066 6f6c 6465 720a 2020 2020  root folder.    
-00035950: 7265 7475 726e 7320 6120 6c69 7374 206f  returns a list o
-00035960: 6620 7475 706c 6573 2028 7469 746c 652c  f tuples (title,
-00035970: 6964 290a 2020 2020 2222 220a 2020 2020  id).    """.    
-00035980: 6764 7269 7665 203d 2067 6175 7468 2829  gdrive = gauth()
-00035990: 0a20 2020 2072 6573 203d 205b 5d0a 0a20  .    res = [].. 
-000359a0: 2020 2023 2068 7474 7073 3a2f 2f73 7461     # https://sta
-000359b0: 636b 6f76 6572 666c 6f77 2e63 6f6d 2f71  ckoverflow.com/q
-000359c0: 7565 7374 696f 6e73 2f34 3032 3234 3535  uestions/4022455
-000359d0: 392f 6c69 7374 2d6f 662d 6669 6c65 2d69  9/list-of-file-i
-000359e0: 6e2d 612d 666f 6c64 6572 2d64 7269 7665  n-a-folder-drive
-000359f0: 2d61 7069 2d70 7964 7269 7665 0a20 2020  -api-pydrive.   
-00035a00: 2023 2042 7569 6c64 2073 7472 696e 6720   # Build string 
-00035a10: 6479 6e61 6d69 6361 6c6c 7920 286e 6565  dynamically (nee
-00035a20: 6420 746f 2075 7365 2065 7363 6170 6520  d to use escape 
-00035a30: 6368 6172 6163 7465 7273 2074 6f20 7375  characters to su
-00035a40: 7070 6f72 7420 7369 6e67 6c65 2071 756f  pport single quo
-00035a50: 7465 2073 796e 7461 7829 0a20 2020 2069  te syntax).    i
-00035a60: 6620 666f 6c64 6572 6964 2069 7320 4e6f  f folderid is No
-00035a70: 6e65 3a0a 2020 2020 2020 2020 7374 7220  ne:.        str 
-00035a80: 3d20 2227 726f 6f74 2720 696e 2070 6172  = "'root' in par
-00035a90: 656e 7473 2061 6e64 2074 7261 7368 6564  ents and trashed
-00035aa0: 3d66 616c 7365 220a 2020 2020 656c 7365  =false".    else
-00035ab0: 3a0a 2020 2020 2020 2020 7374 7220 3d20  :.        str = 
-00035ac0: 225c 2722 202b 2066 6f6c 6465 7269 6420  "\'" + folderid 
-00035ad0: 2b20 225c 2722 202b 2022 2069 6e20 7061  + "\'" + " in pa
-00035ae0: 7265 6e74 7320 616e 6420 7472 6173 6865  rents and trashe
-00035af0: 643d 6661 6c73 6522 2020 2020 0a0a 2020  d=false"    ..  
-00035b00: 2020 2320 5374 6172 7469 6e67 2069 7465    # Starting ite
-00035b10: 7261 7469 6e67 206f 7665 7220 6669 6c65  rating over file
-00035b20: 730a 2020 2020 6669 6c65 6c69 7374 203d  s.    filelist =
-00035b30: 2067 6472 6976 652e 4c69 7374 4669 6c65   gdrive.ListFile
-00035b40: 287b 2771 273a 2073 7472 7d29 2e47 6574  ({'q': str}).Get
-00035b50: 4c69 7374 2829 0a20 2020 2066 6f72 2066  List().    for f
-00035b60: 696c 6520 696e 2066 696c 656c 6973 743a  ile in filelist:
-00035b70: 0a20 2020 2020 2020 2023 2070 7269 6e74  .        # print
-00035b80: 2827 7469 746c 653a 2025 732c 2069 643a  ('title: %s, id:
-00035b90: 2025 7327 2025 2028 6669 6c65 5b27 7469   %s' % (file['ti
-00035ba0: 746c 6527 5d2c 2066 696c 655b 2769 6427  tle'], file['id'
-00035bb0: 5d29 290a 2020 2020 2020 2020 7265 732e  ])).        res.
-00035bc0: 6170 7065 6e64 2828 6669 6c65 5b27 7469  append((file['ti
-00035bd0: 746c 6527 5d2c 2066 696c 655b 2769 6427  tle'], file['id'
-00035be0: 5d29 290a 2020 2020 0a20 2020 2072 6574  ])).    .    ret
-00035bf0: 7572 6e20 7265 730a 0a23 2323 232a 2a2a  urn res..####***
+00035850: 2020 2062 6f64 793d 7b22 7061 7265 6e74     body={"parent
+00035860: 7322 3a20 5b7b 2269 6422 3a20 666f 6c64  s": [{"id": fold
+00035870: 6572 6964 7d5d 2c27 7469 746c 6527 3a20  erid}],'title': 
+00035880: 6669 6c65 7469 746c 657d 292e 6578 6563  filetitle}).exec
+00035890: 7574 6528 290a 2020 2020 7265 7475 726e  ute().    return
+000358a0: 2066 696c 6574 6974 6c65 0a0a 6465 6620   filetitle..def 
+000358b0: 676c 7328 666f 6c64 6572 6964 3d4e 6f6e  gls(folderid=Non
+000358c0: 6529 3a0a 2020 2020 2222 220a 2020 2020  e):.    """.    
+000358d0: 6c73 2066 696c 6573 2061 6e64 2066 6f6c  ls files and fol
+000358e0: 6465 7273 2069 6e20 6120 666f 6c64 6572  ders in a folder
+000358f0: 2028 6e6f 7420 696e 636c 7564 696e 6720   (not including 
+00035900: 7472 6173 6865 6429 0a20 2020 2066 6f6c  trashed).    fol
+00035910: 6465 7269 643a 206f 7074 696f 6e61 6c2c  derid: optional,
+00035920: 2069 6620 4e6f 6e65 2028 6465 6661 756c   if None (defaul
+00035930: 7429 2c20 7365 6172 6368 2072 6f6f 7420  t), search root 
+00035940: 666f 6c64 6572 0a20 2020 2072 6574 7572  folder.    retur
+00035950: 6e73 2061 206c 6973 7420 6f66 2074 7570  ns a list of tup
+00035960: 6c65 7320 2874 6974 6c65 2c69 6429 0a20  les (title,id). 
+00035970: 2020 2022 2222 0a20 2020 2067 6472 6976     """.    gdriv
+00035980: 6520 3d20 6761 7574 6828 290a 2020 2020  e = gauth().    
+00035990: 7265 7320 3d20 5b5d 0a0a 2020 2020 2320  res = []..    # 
+000359a0: 6874 7470 733a 2f2f 7374 6163 6b6f 7665  https://stackove
+000359b0: 7266 6c6f 772e 636f 6d2f 7175 6573 7469  rflow.com/questi
+000359c0: 6f6e 732f 3430 3232 3435 3539 2f6c 6973  ons/40224559/lis
+000359d0: 742d 6f66 2d66 696c 652d 696e 2d61 2d66  t-of-file-in-a-f
+000359e0: 6f6c 6465 722d 6472 6976 652d 6170 692d  older-drive-api-
+000359f0: 7079 6472 6976 650a 2020 2020 2320 4275  pydrive.    # Bu
+00035a00: 696c 6420 7374 7269 6e67 2064 796e 616d  ild string dynam
+00035a10: 6963 616c 6c79 2028 6e65 6564 2074 6f20  ically (need to 
+00035a20: 7573 6520 6573 6361 7065 2063 6861 7261  use escape chara
+00035a30: 6374 6572 7320 746f 2073 7570 706f 7274  cters to support
+00035a40: 2073 696e 676c 6520 7175 6f74 6520 7379   single quote sy
+00035a50: 6e74 6178 290a 2020 2020 6966 2066 6f6c  ntax).    if fol
+00035a60: 6465 7269 6420 6973 204e 6f6e 653a 0a20  derid is None:. 
+00035a70: 2020 2020 2020 2073 7472 203d 2022 2772         str = "'r
+00035a80: 6f6f 7427 2069 6e20 7061 7265 6e74 7320  oot' in parents 
+00035a90: 616e 6420 7472 6173 6865 643d 6661 6c73  and trashed=fals
+00035aa0: 6522 0a20 2020 2065 6c73 653a 0a20 2020  e".    else:.   
+00035ab0: 2020 2020 2073 7472 203d 2022 5c27 2220       str = "\'" 
+00035ac0: 2b20 666f 6c64 6572 6964 202b 2022 5c27  + folderid + "\'
+00035ad0: 2220 2b20 2220 696e 2070 6172 656e 7473  " + " in parents
+00035ae0: 2061 6e64 2074 7261 7368 6564 3d66 616c   and trashed=fal
+00035af0: 7365 2220 2020 200a 0a20 2020 2023 2053  se"    ..    # S
+00035b00: 7461 7274 696e 6720 6974 6572 6174 696e  tarting iteratin
+00035b10: 6720 6f76 6572 2066 696c 6573 0a20 2020  g over files.   
+00035b20: 2066 696c 656c 6973 7420 3d20 6764 7269   filelist = gdri
+00035b30: 7665 2e4c 6973 7446 696c 6528 7b27 7127  ve.ListFile({'q'
+00035b40: 3a20 7374 727d 292e 4765 744c 6973 7428  : str}).GetList(
+00035b50: 290a 2020 2020 666f 7220 6669 6c65 2069  ).    for file i
+00035b60: 6e20 6669 6c65 6c69 7374 3a0a 2020 2020  n filelist:.    
+00035b70: 2020 2020 2320 7072 696e 7428 2774 6974      # print('tit
+00035b80: 6c65 3a20 2573 2c20 6964 3a20 2573 2720  le: %s, id: %s' 
+00035b90: 2520 2866 696c 655b 2774 6974 6c65 275d  % (file['title']
+00035ba0: 2c20 6669 6c65 5b27 6964 275d 2929 0a20  , file['id'])). 
+00035bb0: 2020 2020 2020 2072 6573 2e61 7070 656e         res.appen
+00035bc0: 6428 2866 696c 655b 2774 6974 6c65 275d  d((file['title']
+00035bd0: 2c20 6669 6c65 5b27 6964 275d 2929 0a20  , file['id'])). 
+00035be0: 2020 200a 2020 2020 7265 7475 726e 2072     .    return r
+00035bf0: 6573 0a0a 2323 2323 2a2a 2a2a 2a2a 2a2a  es..####********
 00035c00: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
 00035c10: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
 00035c20: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
 00035c30: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
 00035c40: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
-00035c50: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a0a 2020  *************.  
+00035c50: 2a2a 2a2a 2a2a 2a2a 0a20 2020 2020 2020  ********.       
 00035c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035c80: 2020 2023 2323 232a 4f72 6465 7265 6453     ####*OrderedS
-00035c90: 6574 2a23 2323 230a 2323 2323 2a2a 2a2a  et*####.####****
+00035c70: 2020 2020 2020 2020 2020 2020 2020 2323                ##
+00035c80: 2323 2a4f 7264 6572 6564 5365 742a 2323  ##*OrderedSet*##
+00035c90: 2323 0a23 2323 232a 2a2a 2a2a 2a2a 2a2a  ##.####*********
 00035ca0: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
 00035cb0: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
 00035cc0: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
 00035cd0: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
 00035ce0: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a  ****************
-00035cf0: 2a2a 2a2a 2a2a 2a2a 2a2a 2a2a 0a22 2222  ************."""
-00035d00: 0a68 7474 7073 3a2f 2f70 7970 692e 6f72  .https://pypi.or
-00035d10: 672f 7072 6f6a 6563 742f 6f72 6465 7265  g/project/ordere
-00035d20: 642d 7365 742f 0a41 6e20 4f72 6465 7265  d-set/.An Ordere
-00035d30: 6453 6574 2069 7320 6120 6375 7374 6f6d  dSet is a custom
-00035d40: 204d 7574 6162 6c65 5365 7420 7468 6174   MutableSet that
-00035d50: 2072 656d 656d 6265 7273 2069 7473 206f   remembers its o
-00035d60: 7264 6572 2c20 736f 2074 6861 7420 6576  rder, so that ev
-00035d70: 6572 790a 656e 7472 7920 6861 7320 616e  ery.entry has an
-00035d80: 2069 6e64 6578 2074 6861 7420 6361 6e20   index that can 
-00035d90: 6265 206c 6f6f 6b65 6420 7570 2e0a 0a42  be looked up...B
-00035da0: 6173 6564 206f 6e20 6120 7265 6369 7065  ased on a recipe
-00035db0: 206f 7269 6769 6e61 6c6c 7920 706f 7374   originally post
-00035dc0: 6564 2074 6f20 4163 7469 7665 5374 6174  ed to ActiveStat
-00035dd0: 6520 5265 6369 7065 7320 6279 2052 6179  e Recipes by Ray
-00035de0: 6d6f 6e64 2048 6574 7469 6765 722c 0a61  mond Hettiger,.a
-00035df0: 6e64 2072 656c 6561 7365 6420 756e 6465  nd released unde
-00035e00: 7220 7468 6520 4d49 5420 6c69 6365 6e73  r the MIT licens
-00035e10: 652e 0a22 2222 0a69 6d70 6f72 7420 6974  e..""".import it
-00035e20: 6572 746f 6f6c 7320 6173 2069 740a 6672  ertools as it.fr
-00035e30: 6f6d 2063 6f6c 6c65 6374 696f 6e73 2069  om collections i
-00035e40: 6d70 6f72 7420 6465 7175 650a 0a74 7279  mport deque..try
-00035e50: 3a0a 2020 2020 2320 5079 7468 6f6e 2033  :.    # Python 3
-00035e60: 0a20 2020 2066 726f 6d20 636f 6c6c 6563  .    from collec
-00035e70: 7469 6f6e 732e 6162 6320 696d 706f 7274  tions.abc import
-00035e80: 204d 7574 6162 6c65 5365 742c 2053 6571   MutableSet, Seq
-00035e90: 7565 6e63 650a 6578 6365 7074 2049 6d70  uence.except Imp
-00035ea0: 6f72 7445 7272 6f72 3a0a 2020 2020 2320  ortError:.    # 
-00035eb0: 5079 7468 6f6e 2032 2e37 0a20 2020 2066  Python 2.7.    f
-00035ec0: 726f 6d20 636f 6c6c 6563 7469 6f6e 7320  rom collections 
-00035ed0: 696d 706f 7274 204d 7574 6162 6c65 5365  import MutableSe
-00035ee0: 742c 2053 6571 7565 6e63 650a 0a53 4c49  t, Sequence..SLI
-00035ef0: 4345 5f41 4c4c 203d 2073 6c69 6365 284e  CE_ALL = slice(N
-00035f00: 6f6e 6529 0a5f 5f76 6572 7369 6f6e 5f5f  one).__version__
-00035f10: 203d 2022 332e 3122 0a0a 0a64 6566 2069   = "3.1"...def i
-00035f20: 735f 6974 6572 6162 6c65 286f 626a 293a  s_iterable(obj):
-00035f30: 0a20 2020 2022 2222 0a20 2020 2041 7265  .    """.    Are
-00035f40: 2077 6520 6265 696e 6720 6173 6b65 6420   we being asked 
-00035f50: 746f 206c 6f6f 6b20 7570 2061 206c 6973  to look up a lis
-00035f60: 7420 6f66 2074 6869 6e67 732c 2069 6e73  t of things, ins
-00035f70: 7465 6164 206f 6620 6120 7369 6e67 6c65  tead of a single
-00035f80: 2074 6869 6e67 3f0a 2020 2020 5765 2063   thing?.    We c
-00035f90: 6865 636b 2066 6f72 2074 6865 2060 5f5f  heck for the `__
-00035fa0: 6974 6572 5f5f 6020 6174 7472 6962 7574  iter__` attribut
-00035fb0: 6520 736f 2074 6861 7420 7468 6973 2063  e so that this c
-00035fc0: 616e 2063 6f76 6572 2074 7970 6573 2074  an cover types t
-00035fd0: 6861 740a 2020 2020 646f 6e27 7420 6861  hat.    don't ha
-00035fe0: 7665 2074 6f20 6265 206b 6e6f 776e 2062  ve to be known b
-00035ff0: 7920 7468 6973 206d 6f64 756c 652c 2073  y this module, s
-00036000: 7563 6820 6173 204e 756d 5079 2061 7272  uch as NumPy arr
-00036010: 6179 732e 0a0a 2020 2020 5374 7269 6e67  ays...    String
-00036020: 732c 2068 6f77 6576 6572 2c20 7368 6f75  s, however, shou
-00036030: 6c64 2062 6520 636f 6e73 6964 6572 6564  ld be considered
-00036040: 2061 7320 6174 6f6d 6963 2076 616c 7565   as atomic value
-00036050: 7320 746f 206c 6f6f 6b20 7570 2c20 6e6f  s to look up, no
-00036060: 740a 2020 2020 6974 6572 6162 6c65 732e  t.    iterables.
-00036070: 2054 6865 2073 616d 6520 676f 6573 2066   The same goes f
-00036080: 6f72 2074 7570 6c65 732c 2073 696e 6365  or tuples, since
-00036090: 2074 6865 7920 6172 6520 696d 6d75 7461   they are immuta
-000360a0: 626c 6520 616e 6420 7468 6572 6566 6f72  ble and therefor
-000360b0: 650a 2020 2020 7661 6c69 6420 656e 7472  e.    valid entr
-000360c0: 6965 732e 0a0a 2020 2020 5765 2064 6f6e  ies...    We don
-000360d0: 2774 206e 6565 6420 746f 2063 6865 636b  't need to check
-000360e0: 2066 6f72 2074 6865 2050 7974 686f 6e20   for the Python 
-000360f0: 3220 6075 6e69 636f 6465 6020 7479 7065  2 `unicode` type
-00036100: 2c20 6265 6361 7573 6520 6974 2064 6f65  , because it doe
-00036110: 736e 2774 0a20 2020 2068 6176 6520 616e  sn't.    have an
-00036120: 2060 5f5f 6974 6572 5f5f 6020 6174 7472   `__iter__` attr
-00036130: 6962 7574 6520 616e 7977 6179 2e0a 2020  ibute anyway..  
-00036140: 2020 2222 220a 2020 2020 7265 7475 726e    """.    return
-00036150: 2028 0a20 2020 2020 2020 2068 6173 6174   (.        hasat
-00036160: 7472 286f 626a 2c20 225f 5f69 7465 725f  tr(obj, "__iter_
-00036170: 5f22 290a 2020 2020 2020 2020 616e 6420  _").        and 
-00036180: 6e6f 7420 6973 696e 7374 616e 6365 286f  not isinstance(o
-00036190: 626a 2c20 7374 7229 0a20 2020 2020 2020  bj, str).       
-000361a0: 2061 6e64 206e 6f74 2069 7369 6e73 7461   and not isinsta
-000361b0: 6e63 6528 6f62 6a2c 2074 7570 6c65 290a  nce(obj, tuple).
-000361c0: 2020 2020 290a 0a0a 636c 6173 7320 4f72      )...class Or
-000361d0: 6465 7265 6453 6574 284d 7574 6162 6c65  deredSet(Mutable
-000361e0: 5365 742c 2053 6571 7565 6e63 6529 3a0a  Set, Sequence):.
-000361f0: 2020 2020 2222 220a 2020 2020 416e 204f      """.    An O
-00036200: 7264 6572 6564 5365 7420 6973 2061 2063  rderedSet is a c
-00036210: 7573 746f 6d20 4d75 7461 626c 6553 6574  ustom MutableSet
-00036220: 2074 6861 7420 7265 6d65 6d62 6572 7320   that remembers 
-00036230: 6974 7320 6f72 6465 722c 2073 6f20 7468  its order, so th
-00036240: 6174 0a20 2020 2065 7665 7279 2065 6e74  at.    every ent
-00036250: 7279 2068 6173 2061 6e20 696e 6465 7820  ry has an index 
-00036260: 7468 6174 2063 616e 2062 6520 6c6f 6f6b  that can be look
-00036270: 6564 2075 702e 0a0a 2020 2020 4578 616d  ed up...    Exam
-00036280: 706c 653a 0a20 2020 2020 2020 203e 3e3e  ple:.        >>>
-00036290: 204f 7264 6572 6564 5365 7428 5b31 2c20   OrderedSet([1, 
-000362a0: 312c 2032 2c20 332c 2032 5d29 0a20 2020  1, 2, 3, 2]).   
-000362b0: 2020 2020 204f 7264 6572 6564 5365 7428       OrderedSet(
-000362c0: 5b31 2c20 322c 2033 5d29 0a20 2020 2022  [1, 2, 3]).    "
-000362d0: 2222 0a0a 2020 2020 6465 6620 5f5f 696e  ""..    def __in
-000362e0: 6974 5f5f 2873 656c 662c 2069 7465 7261  it__(self, itera
-000362f0: 626c 653d 4e6f 6e65 293a 0a20 2020 2020  ble=None):.     
-00036300: 2020 2073 656c 662e 6974 656d 7320 3d20     self.items = 
-00036310: 5b5d 0a20 2020 2020 2020 2073 656c 662e  [].        self.
-00036320: 6d61 7020 3d20 7b7d 0a20 2020 2020 2020  map = {}.       
-00036330: 2069 6620 6974 6572 6162 6c65 2069 7320   if iterable is 
-00036340: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-00036350: 2020 2020 2020 7365 6c66 207c 3d20 6974        self |= it
-00036360: 6572 6162 6c65 0a0a 2020 2020 6465 6620  erable..    def 
-00036370: 5f5f 6c65 6e5f 5f28 7365 6c66 293a 0a20  __len__(self):. 
-00036380: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00036390: 2020 2052 6574 7572 6e73 2074 6865 206e     Returns the n
-000363a0: 756d 6265 7220 6f66 2075 6e69 7175 6520  umber of unique 
-000363b0: 656c 656d 656e 7473 2069 6e20 7468 6520  elements in the 
-000363c0: 6f72 6465 7265 6420 7365 740a 0a20 2020  ordered set..   
-000363d0: 2020 2020 2045 7861 6d70 6c65 3a0a 2020       Example:.  
-000363e0: 2020 2020 2020 2020 2020 3e3e 3e20 6c65            >>> le
-000363f0: 6e28 4f72 6465 7265 6453 6574 285b 5d29  n(OrderedSet([])
-00036400: 290a 2020 2020 2020 2020 2020 2020 300a  ).            0.
-00036410: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-00036420: 6c65 6e28 4f72 6465 7265 6453 6574 285b  len(OrderedSet([
-00036430: 312c 2032 5d29 290a 2020 2020 2020 2020  1, 2])).        
-00036440: 2020 2020 320a 2020 2020 2020 2020 2222      2.        ""
-00036450: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
-00036460: 206c 656e 2873 656c 662e 6974 656d 7329   len(self.items)
-00036470: 0a0a 2020 2020 6465 6620 5f5f 6765 7469  ..    def __geti
-00036480: 7465 6d5f 5f28 7365 6c66 2c20 696e 6465  tem__(self, inde
-00036490: 7829 3a0a 2020 2020 2020 2020 2222 220a  x):.        """.
-000364a0: 2020 2020 2020 2020 4765 7420 7468 6520          Get the 
-000364b0: 6974 656d 2061 7420 6120 6769 7665 6e20  item at a given 
-000364c0: 696e 6465 782e 0a0a 2020 2020 2020 2020  index...        
-000364d0: 4966 2060 696e 6465 7860 2069 7320 6120  If `index` is a 
-000364e0: 736c 6963 652c 2079 6f75 2077 696c 6c20  slice, you will 
-000364f0: 6765 7420 6261 636b 2074 6861 7420 736c  get back that sl
-00036500: 6963 6520 6f66 2069 7465 6d73 2c20 6173  ice of items, as
-00036510: 2061 0a20 2020 2020 2020 206e 6577 204f   a.        new O
-00036520: 7264 6572 6564 5365 742e 0a0a 2020 2020  rderedSet...    
-00036530: 2020 2020 4966 2060 696e 6465 7860 2069      If `index` i
-00036540: 7320 6120 6c69 7374 206f 7220 6120 7369  s a list or a si
-00036550: 6d69 6c61 7220 6974 6572 6162 6c65 2c20  milar iterable, 
-00036560: 796f 7527 6c6c 2067 6574 2061 206c 6973  you'll get a lis
-00036570: 7420 6f66 0a20 2020 2020 2020 2069 7465  t of.        ite
-00036580: 6d73 2063 6f72 7265 7370 6f6e 6469 6e67  ms corresponding
-00036590: 2074 6f20 7468 6f73 6520 696e 6469 6365   to those indice
-000365a0: 732e 2054 6869 7320 6973 2073 696d 696c  s. This is simil
-000365b0: 6172 2074 6f20 4e75 6d50 7927 730a 2020  ar to NumPy's.  
-000365c0: 2020 2020 2020 2266 616e 6379 2069 6e64        "fancy ind
-000365d0: 6578 696e 6722 2e20 5468 6520 7265 7375  exing". The resu
-000365e0: 6c74 2069 7320 6e6f 7420 616e 204f 7264  lt is not an Ord
-000365f0: 6572 6564 5365 7420 6265 6361 7573 6520  eredSet because 
-00036600: 796f 7520 6d61 7920 6173 6b0a 2020 2020  you may ask.    
-00036610: 2020 2020 666f 7220 6475 706c 6963 6174      for duplicat
-00036620: 6520 696e 6469 6365 732c 2061 6e64 2074  e indices, and t
-00036630: 6865 206e 756d 6265 7220 6f66 2065 6c65  he number of ele
-00036640: 6d65 6e74 7320 7265 7475 726e 6564 2073  ments returned s
-00036650: 686f 756c 6420 6265 0a20 2020 2020 2020  hould be.       
-00036660: 2074 6865 206e 756d 6265 7220 6f66 2065   the number of e
-00036670: 6c65 6d65 6e74 7320 6173 6b65 6420 666f  lements asked fo
-00036680: 722e 0a0a 2020 2020 2020 2020 4578 616d  r...        Exam
-00036690: 706c 653a 0a20 2020 2020 2020 2020 2020  ple:.           
-000366a0: 203e 3e3e 206f 7365 7420 3d20 4f72 6465   >>> oset = Orde
-000366b0: 7265 6453 6574 285b 312c 2032 2c20 335d  redSet([1, 2, 3]
-000366c0: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
-000366d0: 3e20 6f73 6574 5b31 5d0a 2020 2020 2020  > oset[1].      
-000366e0: 2020 2020 2020 320a 2020 2020 2020 2020        2.        
-000366f0: 2222 220a 2020 2020 2020 2020 6966 2069  """.        if i
-00036700: 7369 6e73 7461 6e63 6528 696e 6465 782c  sinstance(index,
-00036710: 2073 6c69 6365 2920 616e 6420 696e 6465   slice) and inde
-00036720: 7820 3d3d 2053 4c49 4345 5f41 4c4c 3a0a  x == SLICE_ALL:.
-00036730: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00036740: 726e 2073 656c 662e 636f 7079 2829 0a20  rn self.copy(). 
-00036750: 2020 2020 2020 2065 6c69 6620 6973 5f69         elif is_i
-00036760: 7465 7261 626c 6528 696e 6465 7829 3a0a  terable(index):.
-00036770: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00036780: 726e 205b 7365 6c66 2e69 7465 6d73 5b69  rn [self.items[i
-00036790: 5d20 666f 7220 6920 696e 2069 6e64 6578  ] for i in index
-000367a0: 5d0a 2020 2020 2020 2020 656c 6966 2068  ].        elif h
-000367b0: 6173 6174 7472 2869 6e64 6578 2c20 225f  asattr(index, "_
-000367c0: 5f69 6e64 6578 5f5f 2229 206f 7220 6973  _index__") or is
-000367d0: 696e 7374 616e 6365 2869 6e64 6578 2c20  instance(index, 
-000367e0: 736c 6963 6529 3a0a 2020 2020 2020 2020  slice):.        
-000367f0: 2020 2020 7265 7375 6c74 203d 2073 656c      result = sel
-00036800: 662e 6974 656d 735b 696e 6465 785d 0a20  f.items[index]. 
-00036810: 2020 2020 2020 2020 2020 2069 6620 6973             if is
-00036820: 696e 7374 616e 6365 2872 6573 756c 742c  instance(result,
-00036830: 206c 6973 7429 3a0a 2020 2020 2020 2020   list):.        
-00036840: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00036850: 656c 662e 5f5f 636c 6173 735f 5f28 7265  elf.__class__(re
-00036860: 7375 6c74 290a 2020 2020 2020 2020 2020  sult).          
-00036870: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00036880: 2020 2020 2020 2020 7265 7475 726e 2072          return r
-00036890: 6573 756c 740a 2020 2020 2020 2020 656c  esult.        el
-000368a0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-000368b0: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
-000368c0: 2244 6f6e 2774 206b 6e6f 7720 686f 7720  "Don't know how 
-000368d0: 746f 2069 6e64 6578 2061 6e20 4f72 6465  to index an Orde
-000368e0: 7265 6453 6574 2062 7920 2572 2220 2520  redSet by %r" % 
-000368f0: 696e 6465 7829 0a0a 2020 2020 6465 6620  index)..    def 
-00036900: 636f 7079 2873 656c 6629 3a0a 2020 2020  copy(self):.    
-00036910: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00036920: 5265 7475 726e 2061 2073 6861 6c6c 6f77  Return a shallow
-00036930: 2063 6f70 7920 6f66 2074 6869 7320 6f62   copy of this ob
-00036940: 6a65 6374 2e0a 0a20 2020 2020 2020 2045  ject...        E
-00036950: 7861 6d70 6c65 3a0a 2020 2020 2020 2020  xample:.        
-00036960: 2020 2020 3e3e 3e20 7468 6973 203d 204f      >>> this = O
-00036970: 7264 6572 6564 5365 7428 5b31 2c20 322c  rderedSet([1, 2,
-00036980: 2033 5d29 0a20 2020 2020 2020 2020 2020   3]).           
-00036990: 203e 3e3e 206f 7468 6572 203d 2074 6869   >>> other = thi
-000369a0: 732e 636f 7079 2829 0a20 2020 2020 2020  s.copy().       
-000369b0: 2020 2020 203e 3e3e 2074 6869 7320 3d3d       >>> this ==
-000369c0: 206f 7468 6572 0a20 2020 2020 2020 2020   other.         
-000369d0: 2020 2054 7275 650a 2020 2020 2020 2020     True.        
-000369e0: 2020 2020 3e3e 3e20 7468 6973 2069 7320      >>> this is 
-000369f0: 6f74 6865 720a 2020 2020 2020 2020 2020  other.          
-00036a00: 2020 4661 6c73 650a 2020 2020 2020 2020    False.        
-00036a10: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-00036a20: 726e 2073 656c 662e 5f5f 636c 6173 735f  rn self.__class_
-00036a30: 5f28 7365 6c66 290a 0a20 2020 2064 6566  _(self)..    def
-00036a40: 205f 5f67 6574 7374 6174 655f 5f28 7365   __getstate__(se
-00036a50: 6c66 293a 0a20 2020 2020 2020 2069 6620  lf):.        if 
-00036a60: 6c65 6e28 7365 6c66 2920 3d3d 2030 3a0a  len(self) == 0:.
-00036a70: 2020 2020 2020 2020 2020 2020 2320 5468              # Th
-00036a80: 6520 7374 6174 6520 6361 6e27 7420 6265  e state can't be
-00036a90: 2061 6e20 656d 7074 7920 6c69 7374 2e0a   an empty list..
-00036aa0: 2020 2020 2020 2020 2020 2020 2320 5765              # We
-00036ab0: 206e 6565 6420 746f 2072 6574 7572 6e20   need to return 
-00036ac0: 6120 7472 7574 6879 2076 616c 7565 2c20  a truthy value, 
-00036ad0: 6f72 2065 6c73 6520 5f5f 7365 7473 7461  or else __setsta
-00036ae0: 7465 5f5f 2077 6f6e 2774 2062 6520 7275  te__ won't be ru
-00036af0: 6e2e 0a20 2020 2020 2020 2020 2020 2023  n..            #
-00036b00: 0a20 2020 2020 2020 2020 2020 2023 2054  .            # T
-00036b10: 6869 7320 636f 756c 6420 6861 7665 2062  his could have b
-00036b20: 6565 6e20 646f 6e65 206d 6f72 6520 6772  een done more gr
-00036b30: 6163 6566 756c 6c79 2062 7920 616c 7761  acefully by alwa
-00036b40: 7973 2070 7574 7469 6e67 2074 6865 2073  ys putting the s
-00036b50: 7461 7465 0a20 2020 2020 2020 2020 2020  tate.           
-00036b60: 2023 2069 6e20 6120 7475 706c 652c 2062   # in a tuple, b
-00036b70: 7574 2074 6869 7320 7761 7920 6973 2062  ut this way is b
-00036b80: 6163 6b77 6172 6473 2d20 616e 6420 666f  ackwards- and fo
-00036b90: 7277 6172 6473 2d20 636f 6d70 6174 6962  rwards- compatib
-00036ba0: 6c65 2077 6974 680a 2020 2020 2020 2020  le with.        
-00036bb0: 2020 2020 2320 7072 6576 696f 7573 2076      # previous v
-00036bc0: 6572 7369 6f6e 7320 6f66 204f 7264 6572  ersions of Order
-00036bd0: 6564 5365 742e 0a20 2020 2020 2020 2020  edSet..         
-00036be0: 2020 2072 6574 7572 6e20 284e 6f6e 652c     return (None,
-00036bf0: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-00036c00: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00036c10: 726e 206c 6973 7428 7365 6c66 290a 0a20  rn list(self).. 
-00036c20: 2020 2064 6566 205f 5f73 6574 7374 6174     def __setstat
-00036c30: 655f 5f28 7365 6c66 2c20 7374 6174 6529  e__(self, state)
-00036c40: 3a0a 2020 2020 2020 2020 6966 2073 7461  :.        if sta
-00036c50: 7465 203d 3d20 284e 6f6e 652c 293a 0a20  te == (None,):. 
-00036c60: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00036c70: 5f5f 696e 6974 5f5f 285b 5d29 0a20 2020  __init__([]).   
-00036c80: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00036c90: 2020 2020 2020 2073 656c 662e 5f5f 696e         self.__in
-00036ca0: 6974 5f5f 2873 7461 7465 290a 0a20 2020  it__(state)..   
-00036cb0: 2064 6566 205f 5f63 6f6e 7461 696e 735f   def __contains_
-00036cc0: 5f28 7365 6c66 2c20 6b65 7929 3a0a 2020  _(self, key):.  
-00036cd0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00036ce0: 2020 5465 7374 2069 6620 7468 6520 6974    Test if the it
-00036cf0: 656d 2069 7320 696e 2074 6869 7320 6f72  em is in this or
-00036d00: 6465 7265 6420 7365 740a 0a20 2020 2020  dered set..     
-00036d10: 2020 2045 7861 6d70 6c65 3a0a 2020 2020     Example:.    
-00036d20: 2020 2020 2020 2020 3e3e 3e20 3120 696e          >>> 1 in
-00036d30: 204f 7264 6572 6564 5365 7428 5b31 2c20   OrderedSet([1, 
-00036d40: 332c 2032 5d29 0a20 2020 2020 2020 2020  3, 2]).         
-00036d50: 2020 2054 7275 650a 2020 2020 2020 2020     True.        
-00036d60: 2020 2020 3e3e 3e20 3520 696e 204f 7264      >>> 5 in Ord
-00036d70: 6572 6564 5365 7428 5b31 2c20 332c 2032  eredSet([1, 3, 2
-00036d80: 5d29 0a20 2020 2020 2020 2020 2020 2046  ]).            F
-00036d90: 616c 7365 0a20 2020 2020 2020 2022 2222  alse.        """
-00036da0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00036db0: 6b65 7920 696e 2073 656c 662e 6d61 700a  key in self.map.
-00036dc0: 0a20 2020 2064 6566 2061 6464 2873 656c  .    def add(sel
-00036dd0: 662c 206b 6579 293a 0a20 2020 2020 2020  f, key):.       
-00036de0: 2022 2222 0a20 2020 2020 2020 2041 6464   """.        Add
-00036df0: 2060 6b65 7960 2061 7320 616e 2069 7465   `key` as an ite
-00036e00: 6d20 746f 2074 6869 7320 4f72 6465 7265  m to this Ordere
-00036e10: 6453 6574 2c20 7468 656e 2072 6574 7572  dSet, then retur
-00036e20: 6e20 6974 7320 696e 6465 782e 0a0a 2020  n its index...  
-00036e30: 2020 2020 2020 4966 2060 6b65 7960 2069        If `key` i
-00036e40: 7320 616c 7265 6164 7920 696e 2074 6865  s already in the
-00036e50: 204f 7264 6572 6564 5365 742c 2072 6574   OrderedSet, ret
-00036e60: 7572 6e20 7468 6520 696e 6465 7820 6974  urn the index it
-00036e70: 2061 6c72 6561 6479 0a20 2020 2020 2020   already.       
-00036e80: 2068 6164 2e0a 0a20 2020 2020 2020 2045   had...        E
-00036e90: 7861 6d70 6c65 3a0a 2020 2020 2020 2020  xample:.        
-00036ea0: 2020 2020 3e3e 3e20 6f73 6574 203d 204f      >>> oset = O
-00036eb0: 7264 6572 6564 5365 7428 290a 2020 2020  rderedSet().    
-00036ec0: 2020 2020 2020 2020 3e3e 3e20 6f73 6574          >>> oset
-00036ed0: 2e61 7070 656e 6428 3329 0a20 2020 2020  .append(3).     
-00036ee0: 2020 2020 2020 2030 0a20 2020 2020 2020         0.       
-00036ef0: 2020 2020 203e 3e3e 2070 7269 6e74 286f       >>> print(o
-00036f00: 7365 7429 0a20 2020 2020 2020 2020 2020  set).           
-00036f10: 204f 7264 6572 6564 5365 7428 5b33 5d29   OrderedSet([3])
-00036f20: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00036f30: 2020 2020 2069 6620 6b65 7920 6e6f 7420       if key not 
-00036f40: 696e 2073 656c 662e 6d61 703a 0a20 2020  in self.map:.   
-00036f50: 2020 2020 2020 2020 2073 656c 662e 6d61           self.ma
-00036f60: 705b 6b65 795d 203d 206c 656e 2873 656c  p[key] = len(sel
-00036f70: 662e 6974 656d 7329 0a20 2020 2020 2020  f.items).       
-00036f80: 2020 2020 2073 656c 662e 6974 656d 732e       self.items.
-00036f90: 6170 7065 6e64 286b 6579 290a 2020 2020  append(key).    
-00036fa0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00036fb0: 6d61 705b 6b65 795d 0a0a 2020 2020 6170  map[key]..    ap
-00036fc0: 7065 6e64 203d 2061 6464 0a0a 2020 2020  pend = add..    
-00036fd0: 6465 6620 7570 6461 7465 2873 656c 662c  def update(self,
-00036fe0: 2073 6571 7565 6e63 6529 3a0a 2020 2020   sequence):.    
-00036ff0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00037000: 5570 6461 7465 2074 6865 2073 6574 2077  Update the set w
-00037010: 6974 6820 7468 6520 6769 7665 6e20 6974  ith the given it
-00037020: 6572 6162 6c65 2073 6571 7565 6e63 652c  erable sequence,
-00037030: 2074 6865 6e20 7265 7475 726e 2074 6865   then return the
-00037040: 2069 6e64 6578 0a20 2020 2020 2020 206f   index.        o
-00037050: 6620 7468 6520 6c61 7374 2065 6c65 6d65  f the last eleme
-00037060: 6e74 2069 6e73 6572 7465 642e 0a0a 2020  nt inserted...  
-00037070: 2020 2020 2020 4578 616d 706c 653a 0a20        Example:. 
-00037080: 2020 2020 2020 2020 2020 203e 3e3e 206f             >>> o
-00037090: 7365 7420 3d20 4f72 6465 7265 6453 6574  set = OrderedSet
-000370a0: 285b 312c 2032 2c20 335d 290a 2020 2020  ([1, 2, 3]).    
-000370b0: 2020 2020 2020 2020 3e3e 3e20 6f73 6574          >>> oset
-000370c0: 2e75 7064 6174 6528 5b33 2c20 312c 2035  .update([3, 1, 5
-000370d0: 2c20 312c 2034 5d29 0a20 2020 2020 2020  , 1, 4]).       
-000370e0: 2020 2020 2034 0a20 2020 2020 2020 2020       4.         
-000370f0: 2020 203e 3e3e 2070 7269 6e74 286f 7365     >>> print(ose
-00037100: 7429 0a20 2020 2020 2020 2020 2020 204f  t).            O
-00037110: 7264 6572 6564 5365 7428 5b31 2c20 322c  rderedSet([1, 2,
-00037120: 2033 2c20 352c 2034 5d29 0a20 2020 2020   3, 5, 4]).     
-00037130: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
-00037140: 7465 6d5f 696e 6465 7820 3d20 4e6f 6e65  tem_index = None
-00037150: 0a20 2020 2020 2020 2074 7279 3a0a 2020  .        try:.  
-00037160: 2020 2020 2020 2020 2020 666f 7220 6974            for it
-00037170: 656d 2069 6e20 7365 7175 656e 6365 3a0a  em in sequence:.
-00037180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037190: 6974 656d 5f69 6e64 6578 203d 2073 656c  item_index = sel
-000371a0: 662e 6164 6428 6974 656d 290a 2020 2020  f.add(item).    
-000371b0: 2020 2020 6578 6365 7074 2054 7970 6545      except TypeE
-000371c0: 7272 6f72 3a0a 2020 2020 2020 2020 2020  rror:.          
-000371d0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-000371e0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-000371f0: 2020 2020 2241 7267 756d 656e 7420 6e65      "Argument ne
-00037200: 6564 7320 746f 2062 6520 616e 2069 7465  eds to be an ite
-00037210: 7261 626c 652c 2067 6f74 2025 7322 2025  rable, got %s" %
-00037220: 2074 7970 6528 7365 7175 656e 6365 290a   type(sequence).
-00037230: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00037240: 2020 2020 2020 7265 7475 726e 2069 7465        return ite
-00037250: 6d5f 696e 6465 780a 0a20 2020 2064 6566  m_index..    def
-00037260: 2069 6e64 6578 2873 656c 662c 206b 6579   index(self, key
-00037270: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-00037280: 2020 2020 2020 2047 6574 2074 6865 2069         Get the i
-00037290: 6e64 6578 206f 6620 6120 6769 7665 6e20  ndex of a given 
-000372a0: 656e 7472 792c 2072 6169 7369 6e67 2061  entry, raising a
-000372b0: 6e20 496e 6465 7845 7272 6f72 2069 6620  n IndexError if 
-000372c0: 6974 2773 206e 6f74 0a20 2020 2020 2020  it's not.       
-000372d0: 2070 7265 7365 6e74 2e0a 0a20 2020 2020   present...     
-000372e0: 2020 2060 6b65 7960 2063 616e 2062 6520     `key` can be 
-000372f0: 616e 2069 7465 7261 626c 6520 6f66 2065  an iterable of e
-00037300: 6e74 7269 6573 2074 6861 7420 6973 206e  ntries that is n
-00037310: 6f74 2061 2073 7472 696e 672c 2069 6e20  ot a string, in 
-00037320: 7768 6963 6820 6361 7365 0a20 2020 2020  which case.     
-00037330: 2020 2074 6869 7320 7265 7475 726e 7320     this returns 
-00037340: 6120 6c69 7374 206f 6620 696e 6469 6365  a list of indice
-00037350: 732e 0a0a 2020 2020 2020 2020 4578 616d  s...        Exam
-00037360: 706c 653a 0a20 2020 2020 2020 2020 2020  ple:.           
-00037370: 203e 3e3e 206f 7365 7420 3d20 4f72 6465   >>> oset = Orde
-00037380: 7265 6453 6574 285b 312c 2032 2c20 335d  redSet([1, 2, 3]
-00037390: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
-000373a0: 3e20 6f73 6574 2e69 6e64 6578 2832 290a  > oset.index(2).
-000373b0: 2020 2020 2020 2020 2020 2020 310a 2020              1.  
-000373c0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000373d0: 2020 6966 2069 735f 6974 6572 6162 6c65    if is_iterable
-000373e0: 286b 6579 293a 0a20 2020 2020 2020 2020  (key):.         
-000373f0: 2020 2072 6574 7572 6e20 5b73 656c 662e     return [self.
-00037400: 696e 6465 7828 7375 626b 6579 2920 666f  index(subkey) fo
-00037410: 7220 7375 626b 6579 2069 6e20 6b65 795d  r subkey in key]
-00037420: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00037430: 7365 6c66 2e6d 6170 5b6b 6579 5d0a 0a20  self.map[key].. 
-00037440: 2020 2023 2050 726f 7669 6465 2073 6f6d     # Provide som
-00037450: 6520 636f 6d70 6174 6962 696c 6974 7920  e compatibility 
-00037460: 7769 7468 2070 642e 496e 6465 780a 2020  with pd.Index.  
-00037470: 2020 6765 745f 6c6f 6320 3d20 696e 6465    get_loc = inde
-00037480: 780a 2020 2020 6765 745f 696e 6465 7865  x.    get_indexe
-00037490: 7220 3d20 696e 6465 780a 0a20 2020 2064  r = index..    d
-000374a0: 6566 2070 6f70 2873 656c 6629 3a0a 2020  ef pop(self):.  
-000374b0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000374c0: 2020 5265 6d6f 7665 2061 6e64 2072 6574    Remove and ret
-000374d0: 7572 6e20 7468 6520 6c61 7374 2065 6c65  urn the last ele
-000374e0: 6d65 6e74 2066 726f 6d20 7468 6520 7365  ment from the se
-000374f0: 742e 0a0a 2020 2020 2020 2020 5261 6973  t...        Rais
-00037500: 6573 204b 6579 4572 726f 7220 6966 2074  es KeyError if t
-00037510: 6865 2073 6574 2069 7320 656d 7074 792e  he set is empty.
-00037520: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
-00037530: 653a 0a20 2020 2020 2020 2020 2020 203e  e:.            >
-00037540: 3e3e 206f 7365 7420 3d20 4f72 6465 7265  >> oset = Ordere
-00037550: 6453 6574 285b 312c 2032 2c20 335d 290a  dSet([1, 2, 3]).
-00037560: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-00037570: 6f73 6574 2e70 6f70 2829 0a20 2020 2020  oset.pop().     
-00037580: 2020 2020 2020 2033 0a20 2020 2020 2020         3.       
-00037590: 2022 2222 0a20 2020 2020 2020 2069 6620   """.        if 
-000375a0: 6e6f 7420 7365 6c66 2e69 7465 6d73 3a0a  not self.items:.
-000375b0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-000375c0: 6520 4b65 7945 7272 6f72 2822 5365 7420  e KeyError("Set 
-000375d0: 6973 2065 6d70 7479 2229 0a0a 2020 2020  is empty")..    
-000375e0: 2020 2020 656c 656d 203d 2073 656c 662e      elem = self.
-000375f0: 6974 656d 735b 2d31 5d0a 2020 2020 2020  items[-1].      
-00037600: 2020 6465 6c20 7365 6c66 2e69 7465 6d73    del self.items
-00037610: 5b2d 315d 0a20 2020 2020 2020 2064 656c  [-1].        del
-00037620: 2073 656c 662e 6d61 705b 656c 656d 5d0a   self.map[elem].
-00037630: 2020 2020 2020 2020 7265 7475 726e 2065          return e
-00037640: 6c65 6d0a 0a20 2020 2064 6566 2064 6973  lem..    def dis
-00037650: 6361 7264 2873 656c 662c 206b 6579 293a  card(self, key):
-00037660: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00037670: 2020 2020 2052 656d 6f76 6520 616e 2065       Remove an e
-00037680: 6c65 6d65 6e74 2e20 2044 6f20 6e6f 7420  lement.  Do not 
-00037690: 7261 6973 6520 616e 2065 7863 6570 7469  raise an excepti
-000376a0: 6f6e 2069 6620 6162 7365 6e74 2e0a 0a20  on if absent... 
-000376b0: 2020 2020 2020 2054 6865 204d 7574 6162         The Mutab
-000376c0: 6c65 5365 7420 6d69 7869 6e20 7573 6573  leSet mixin uses
-000376d0: 2074 6869 7320 746f 2069 6d70 6c65 6d65   this to impleme
-000376e0: 6e74 2074 6865 202e 7265 6d6f 7665 2829  nt the .remove()
-000376f0: 206d 6574 686f 642c 2077 6869 6368 0a20   method, which. 
-00037700: 2020 2020 2020 202a 646f 6573 2a20 7261         *does* ra
-00037710: 6973 6520 616e 2065 7272 6f72 2077 6865  ise an error whe
-00037720: 6e20 6173 6b65 6420 746f 2072 656d 6f76  n asked to remov
-00037730: 6520 6120 6e6f 6e2d 6578 6973 7465 6e74  e a non-existent
-00037740: 2069 7465 6d2e 0a0a 2020 2020 2020 2020   item...        
-00037750: 4578 616d 706c 653a 0a20 2020 2020 2020  Example:.       
-00037760: 2020 2020 203e 3e3e 206f 7365 7420 3d20       >>> oset = 
-00037770: 4f72 6465 7265 6453 6574 285b 312c 2032  OrderedSet([1, 2
-00037780: 2c20 335d 290a 2020 2020 2020 2020 2020  , 3]).          
-00037790: 2020 3e3e 3e20 6f73 6574 2e64 6973 6361    >>> oset.disca
-000377a0: 7264 2832 290a 2020 2020 2020 2020 2020  rd(2).          
-000377b0: 2020 3e3e 3e20 7072 696e 7428 6f73 6574    >>> print(oset
-000377c0: 290a 2020 2020 2020 2020 2020 2020 4f72  ).            Or
-000377d0: 6465 7265 6453 6574 285b 312c 2033 5d29  deredSet([1, 3])
-000377e0: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-000377f0: 206f 7365 742e 6469 7363 6172 6428 3229   oset.discard(2)
-00037800: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-00037810: 2070 7269 6e74 286f 7365 7429 0a20 2020   print(oset).   
-00037820: 2020 2020 2020 2020 204f 7264 6572 6564           Ordered
-00037830: 5365 7428 5b31 2c20 335d 290a 2020 2020  Set([1, 3]).    
-00037840: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00037850: 6966 206b 6579 2069 6e20 7365 6c66 3a0a  if key in self:.
-00037860: 2020 2020 2020 2020 2020 2020 6920 3d20              i = 
-00037870: 7365 6c66 2e6d 6170 5b6b 6579 5d0a 2020  self.map[key].  
-00037880: 2020 2020 2020 2020 2020 6465 6c20 7365            del se
-00037890: 6c66 2e69 7465 6d73 5b69 5d0a 2020 2020  lf.items[i].    
-000378a0: 2020 2020 2020 2020 6465 6c20 7365 6c66          del self
-000378b0: 2e6d 6170 5b6b 6579 5d0a 2020 2020 2020  .map[key].      
-000378c0: 2020 2020 2020 666f 7220 6b2c 2076 2069        for k, v i
-000378d0: 6e20 7365 6c66 2e6d 6170 2e69 7465 6d73  n self.map.items
-000378e0: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
-000378f0: 2020 2020 6966 2076 203e 3d20 693a 0a20      if v >= i:. 
-00037900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037910: 2020 2073 656c 662e 6d61 705b 6b5d 203d     self.map[k] =
-00037920: 2076 202d 2031 0a0a 2020 2020 6465 6620   v - 1..    def 
-00037930: 636c 6561 7228 7365 6c66 293a 0a20 2020  clear(self):.   
-00037940: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00037950: 2052 656d 6f76 6520 616c 6c20 6974 656d   Remove all item
-00037960: 7320 6672 6f6d 2074 6869 7320 4f72 6465  s from this Orde
-00037970: 7265 6453 6574 2e0a 2020 2020 2020 2020  redSet..        
-00037980: 2222 220a 2020 2020 2020 2020 6465 6c20  """.        del 
-00037990: 7365 6c66 2e69 7465 6d73 5b3a 5d0a 2020  self.items[:].  
-000379a0: 2020 2020 2020 7365 6c66 2e6d 6170 2e63        self.map.c
-000379b0: 6c65 6172 2829 0a0a 2020 2020 6465 6620  lear()..    def 
-000379c0: 5f5f 6974 6572 5f5f 2873 656c 6629 3a0a  __iter__(self):.
-000379d0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-000379e0: 2020 2020 4578 616d 706c 653a 0a20 2020      Example:.   
-000379f0: 2020 2020 2020 2020 203e 3e3e 206c 6973           >>> lis
-00037a00: 7428 6974 6572 284f 7264 6572 6564 5365  t(iter(OrderedSe
-00037a10: 7428 5b31 2c20 322c 2033 5d29 2929 0a20  t([1, 2, 3]))). 
-00037a20: 2020 2020 2020 2020 2020 205b 312c 2032             [1, 2
-00037a30: 2c20 335d 0a20 2020 2020 2020 2022 2222  , 3].        """
-00037a40: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00037a50: 6974 6572 2873 656c 662e 6974 656d 7329  iter(self.items)
-00037a60: 0a0a 2020 2020 6465 6620 5f5f 7265 7665  ..    def __reve
-00037a70: 7273 6564 5f5f 2873 656c 6629 3a0a 2020  rsed__(self):.  
-00037a80: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00037a90: 2020 4578 616d 706c 653a 0a20 2020 2020    Example:.     
-00037aa0: 2020 2020 2020 203e 3e3e 206c 6973 7428         >>> list(
-00037ab0: 7265 7665 7273 6564 284f 7264 6572 6564  reversed(Ordered
-00037ac0: 5365 7428 5b31 2c20 322c 2033 5d29 2929  Set([1, 2, 3])))
-00037ad0: 0a20 2020 2020 2020 2020 2020 205b 332c  .            [3,
-00037ae0: 2032 2c20 315d 0a20 2020 2020 2020 2022   2, 1].        "
-00037af0: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-00037b00: 6e20 7265 7665 7273 6564 2873 656c 662e  n reversed(self.
-00037b10: 6974 656d 7329 0a0a 2020 2020 6465 6620  items)..    def 
-00037b20: 5f5f 7265 7072 5f5f 2873 656c 6629 3a0a  __repr__(self):.
-00037b30: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
-00037b40: 656c 663a 0a20 2020 2020 2020 2020 2020  elf:.           
-00037b50: 2072 6574 7572 6e20 2225 7328 2922 2025   return "%s()" %
-00037b60: 2028 7365 6c66 2e5f 5f63 6c61 7373 5f5f   (self.__class__
-00037b70: 2e5f 5f6e 616d 655f 5f2c 290a 2020 2020  .__name__,).    
-00037b80: 2020 2020 7265 7475 726e 2022 2573 2825      return "%s(%
-00037b90: 7229 2220 2520 2873 656c 662e 5f5f 636c  r)" % (self.__cl
-00037ba0: 6173 735f 5f2e 5f5f 6e61 6d65 5f5f 2c20  ass__.__name__, 
-00037bb0: 6c69 7374 2873 656c 6629 290a 0a20 2020  list(self))..   
-00037bc0: 2064 6566 205f 5f65 715f 5f28 7365 6c66   def __eq__(self
-00037bd0: 2c20 6f74 6865 7229 3a0a 2020 2020 2020  , other):.      
-00037be0: 2020 2222 220a 2020 2020 2020 2020 5265    """.        Re
-00037bf0: 7475 726e 7320 7472 7565 2069 6620 7468  turns true if th
-00037c00: 6520 636f 6e74 6169 6e65 7273 2068 6176  e containers hav
-00037c10: 6520 7468 6520 7361 6d65 2069 7465 6d73  e the same items
-00037c20: 2e20 4966 2060 6f74 6865 7260 2069 7320  . If `other` is 
-00037c30: 610a 2020 2020 2020 2020 5365 7175 656e  a.        Sequen
-00037c40: 6365 2c20 7468 656e 206f 7264 6572 2069  ce, then order i
-00037c50: 7320 6368 6563 6b65 642c 206f 7468 6572  s checked, other
-00037c60: 7769 7365 2069 7420 6973 2069 676e 6f72  wise it is ignor
-00037c70: 6564 2e0a 0a20 2020 2020 2020 2045 7861  ed...        Exa
-00037c80: 6d70 6c65 3a0a 2020 2020 2020 2020 2020  mple:.          
-00037c90: 2020 3e3e 3e20 6f73 6574 203d 204f 7264    >>> oset = Ord
-00037ca0: 6572 6564 5365 7428 5b31 2c20 332c 2032  eredSet([1, 3, 2
-00037cb0: 5d29 0a20 2020 2020 2020 2020 2020 203e  ]).            >
-00037cc0: 3e3e 206f 7365 7420 3d3d 205b 312c 2033  >> oset == [1, 3
-00037cd0: 2c20 325d 0a20 2020 2020 2020 2020 2020  , 2].           
-00037ce0: 2054 7275 650a 2020 2020 2020 2020 2020   True.          
-00037cf0: 2020 3e3e 3e20 6f73 6574 203d 3d20 5b31    >>> oset == [1
-00037d00: 2c20 322c 2033 5d0a 2020 2020 2020 2020  , 2, 3].        
-00037d10: 2020 2020 4661 6c73 650a 2020 2020 2020      False.      
-00037d20: 2020 2020 2020 3e3e 3e20 6f73 6574 203d        >>> oset =
-00037d30: 3d20 5b32 2c20 335d 0a20 2020 2020 2020  = [2, 3].       
-00037d40: 2020 2020 2046 616c 7365 0a20 2020 2020       False.     
-00037d50: 2020 2020 2020 203e 3e3e 206f 7365 7420         >>> oset 
-00037d60: 3d3d 204f 7264 6572 6564 5365 7428 5b33  == OrderedSet([3
-00037d70: 2c20 322c 2031 5d29 0a20 2020 2020 2020  , 2, 1]).       
-00037d80: 2020 2020 2046 616c 7365 0a20 2020 2020       False.     
-00037d90: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
-00037da0: 2049 6e20 5079 7468 6f6e 2032 2064 6571   In Python 2 deq
-00037db0: 7565 2069 7320 6e6f 7420 6120 5365 7175  ue is not a Sequ
-00037dc0: 656e 6365 2c20 736f 2074 7265 6174 2069  ence, so treat i
-00037dd0: 7420 6173 206f 6e65 2066 6f72 0a20 2020  t as one for.   
-00037de0: 2020 2020 2023 2063 6f6e 7369 7374 656e       # consisten
-00037df0: 7420 6265 6861 7669 6f72 2077 6974 6820  t behavior with 
-00037e00: 5079 7468 6f6e 2033 2e0a 2020 2020 2020  Python 3..      
-00037e10: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00037e20: 6f74 6865 722c 2028 5365 7175 656e 6365  other, (Sequence
-00037e30: 2c20 6465 7175 6529 293a 0a20 2020 2020  , deque)):.     
-00037e40: 2020 2020 2020 2023 2043 6865 636b 2074         # Check t
-00037e50: 6861 7420 7468 6973 204f 7264 6572 6564  hat this Ordered
-00037e60: 5365 7420 636f 6e74 6169 6e73 2074 6865  Set contains the
-00037e70: 2073 616d 6520 656c 656d 656e 7473 2c20   same elements, 
-00037e80: 696e 2074 6865 0a20 2020 2020 2020 2020  in the.         
-00037e90: 2020 2023 2073 616d 6520 6f72 6465 722c     # same order,
-00037ea0: 2061 7320 7468 6520 6f74 6865 7220 6f62   as the other ob
-00037eb0: 6a65 6374 2e0a 2020 2020 2020 2020 2020  ject..          
-00037ec0: 2020 7265 7475 726e 206c 6973 7428 7365    return list(se
-00037ed0: 6c66 2920 3d3d 206c 6973 7428 6f74 6865  lf) == list(othe
-00037ee0: 7229 0a20 2020 2020 2020 2074 7279 3a0a  r).        try:.
-00037ef0: 2020 2020 2020 2020 2020 2020 6f74 6865              othe
-00037f00: 725f 6173 5f73 6574 203d 2073 6574 286f  r_as_set = set(o
-00037f10: 7468 6572 290a 2020 2020 2020 2020 6578  ther).        ex
-00037f20: 6365 7074 2054 7970 6545 7272 6f72 3a0a  cept TypeError:.
-00037f30: 2020 2020 2020 2020 2020 2020 2320 4966              # If
-00037f40: 2060 6f74 6865 7260 2063 616e 2774 2062   `other` can't b
-00037f50: 6520 636f 6e76 6572 7465 6420 696e 746f  e converted into
-00037f60: 2061 2073 6574 2c20 6974 2773 206e 6f74   a set, it's not
-00037f70: 2065 7175 616c 2e0a 2020 2020 2020 2020   equal..        
-00037f80: 2020 2020 7265 7475 726e 2046 616c 7365      return False
-00037f90: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00037fa0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00037fb0: 6e20 7365 7428 7365 6c66 2920 3d3d 206f  n set(self) == o
-00037fc0: 7468 6572 5f61 735f 7365 740a 0a20 2020  ther_as_set..   
-00037fd0: 2064 6566 2075 6e69 6f6e 2873 656c 662c   def union(self,
-00037fe0: 202a 7365 7473 293a 0a20 2020 2020 2020   *sets):.       
-00037ff0: 2022 2222 0a20 2020 2020 2020 2043 6f6d   """.        Com
-00038000: 6269 6e65 7320 616c 6c20 756e 6971 7565  bines all unique
-00038010: 2069 7465 6d73 2e0a 2020 2020 2020 2020   items..        
-00038020: 4561 6368 2069 7465 6d73 206f 7264 6572  Each items order
-00038030: 2069 7320 6465 6669 6e65 6420 6279 2069   is defined by i
-00038040: 7473 2066 6972 7374 2061 7070 6561 7261  ts first appeara
-00038050: 6e63 652e 0a0a 2020 2020 2020 2020 4578  nce...        Ex
-00038060: 616d 706c 653a 0a20 2020 2020 2020 2020  ample:.         
-00038070: 2020 203e 3e3e 206f 7365 7420 3d20 4f72     >>> oset = Or
-00038080: 6465 7265 6453 6574 2e75 6e69 6f6e 284f  deredSet.union(O
-00038090: 7264 6572 6564 5365 7428 5b33 2c20 312c  rderedSet([3, 1,
-000380a0: 2034 2c20 312c 2035 5d29 2c20 5b31 2c20   4, 1, 5]), [1, 
-000380b0: 335d 2c20 5b32 2c20 305d 290a 2020 2020  3], [2, 0]).    
-000380c0: 2020 2020 2020 2020 3e3e 3e20 7072 696e          >>> prin
-000380d0: 7428 6f73 6574 290a 2020 2020 2020 2020  t(oset).        
-000380e0: 2020 2020 4f72 6465 7265 6453 6574 285b      OrderedSet([
-000380f0: 332c 2031 2c20 342c 2035 2c20 322c 2030  3, 1, 4, 5, 2, 0
-00038100: 5d29 0a20 2020 2020 2020 2020 2020 203e  ]).            >
-00038110: 3e3e 206f 7365 742e 756e 696f 6e28 5b38  >> oset.union([8
-00038120: 2c20 395d 290a 2020 2020 2020 2020 2020  , 9]).          
-00038130: 2020 4f72 6465 7265 6453 6574 285b 332c    OrderedSet([3,
-00038140: 2031 2c20 342c 2035 2c20 322c 2030 2c20   1, 4, 5, 2, 0, 
-00038150: 382c 2039 5d29 0a20 2020 2020 2020 2020  8, 9]).         
-00038160: 2020 203e 3e3e 206f 7365 7420 7c20 7b31     >>> oset | {1
-00038170: 307d 0a20 2020 2020 2020 2020 2020 204f  0}.            O
-00038180: 7264 6572 6564 5365 7428 5b33 2c20 312c  rderedSet([3, 1,
-00038190: 2034 2c20 352c 2032 2c20 302c 2031 305d   4, 5, 2, 0, 10]
-000381a0: 290a 2020 2020 2020 2020 2222 220a 2020  ).        """.  
-000381b0: 2020 2020 2020 636c 7320 3d20 7365 6c66        cls = self
-000381c0: 2e5f 5f63 6c61 7373 5f5f 2069 6620 6973  .__class__ if is
-000381d0: 696e 7374 616e 6365 2873 656c 662c 204f  instance(self, O
-000381e0: 7264 6572 6564 5365 7429 2065 6c73 6520  rderedSet) else 
-000381f0: 4f72 6465 7265 6453 6574 0a20 2020 2020  OrderedSet.     
-00038200: 2020 2063 6f6e 7461 696e 6572 7320 3d20     containers = 
-00038210: 6d61 7028 6c69 7374 2c20 6974 2e63 6861  map(list, it.cha
-00038220: 696e 285b 7365 6c66 5d2c 2073 6574 7329  in([self], sets)
-00038230: 290a 2020 2020 2020 2020 6974 656d 7320  ).        items 
-00038240: 3d20 6974 2e63 6861 696e 2e66 726f 6d5f  = it.chain.from_
-00038250: 6974 6572 6162 6c65 2863 6f6e 7461 696e  iterable(contain
-00038260: 6572 7329 0a20 2020 2020 2020 2072 6574  ers).        ret
-00038270: 7572 6e20 636c 7328 6974 656d 7329 0a0a  urn cls(items)..
-00038280: 2020 2020 6465 6620 5f5f 616e 645f 5f28      def __and__(
-00038290: 7365 6c66 2c20 6f74 6865 7229 3a0a 2020  self, other):.  
-000382a0: 2020 2020 2020 2320 7468 6520 7061 7265        # the pare
-000382b0: 6e74 2069 6d70 6c65 6d65 6e74 6174 696f  nt implementatio
-000382c0: 6e20 6f66 2074 6869 7320 6973 2062 6163  n of this is bac
-000382d0: 6b77 6172 6473 0a20 2020 2020 2020 2072  kwards.        r
-000382e0: 6574 7572 6e20 7365 6c66 2e69 6e74 6572  eturn self.inter
-000382f0: 7365 6374 696f 6e28 6f74 6865 7229 0a0a  section(other)..
-00038300: 2020 2020 6465 6620 696e 7465 7273 6563      def intersec
-00038310: 7469 6f6e 2873 656c 662c 202a 7365 7473  tion(self, *sets
-00038320: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-00038330: 2020 2020 2020 2052 6574 7572 6e73 2065         Returns e
-00038340: 6c65 6d65 6e74 7320 696e 2063 6f6d 6d6f  lements in commo
-00038350: 6e20 6265 7477 6565 6e20 616c 6c20 7365  n between all se
-00038360: 7473 2e20 4f72 6465 7220 6973 2064 6566  ts. Order is def
-00038370: 696e 6564 206f 6e6c 790a 2020 2020 2020  ined only.      
-00038380: 2020 6279 2074 6865 2066 6972 7374 2073    by the first s
-00038390: 6574 2e0a 0a20 2020 2020 2020 2045 7861  et...        Exa
-000383a0: 6d70 6c65 3a0a 2020 2020 2020 2020 2020  mple:.          
-000383b0: 2020 3e3e 3e20 6f73 6574 203d 204f 7264    >>> oset = Ord
-000383c0: 6572 6564 5365 742e 696e 7465 7273 6563  eredSet.intersec
-000383d0: 7469 6f6e 284f 7264 6572 6564 5365 7428  tion(OrderedSet(
-000383e0: 5b30 2c20 312c 2032 2c20 335d 292c 205b  [0, 1, 2, 3]), [
-000383f0: 312c 2032 2c20 335d 290a 2020 2020 2020  1, 2, 3]).      
-00038400: 2020 2020 2020 3e3e 3e20 7072 696e 7428        >>> print(
-00038410: 6f73 6574 290a 2020 2020 2020 2020 2020  oset).          
-00038420: 2020 4f72 6465 7265 6453 6574 285b 312c    OrderedSet([1,
-00038430: 2032 2c20 335d 290a 2020 2020 2020 2020   2, 3]).        
-00038440: 2020 2020 3e3e 3e20 6f73 6574 2e69 6e74      >>> oset.int
-00038450: 6572 7365 6374 696f 6e28 5b32 2c20 342c  ersection([2, 4,
-00038460: 2035 5d2c 205b 312c 2032 2c20 332c 2034   5], [1, 2, 3, 4
-00038470: 5d29 0a20 2020 2020 2020 2020 2020 204f  ]).            O
-00038480: 7264 6572 6564 5365 7428 5b32 5d29 0a20  rderedSet([2]). 
-00038490: 2020 2020 2020 2020 2020 203e 3e3e 206f             >>> o
-000384a0: 7365 742e 696e 7465 7273 6563 7469 6f6e  set.intersection
-000384b0: 2829 0a20 2020 2020 2020 2020 2020 204f  ().            O
-000384c0: 7264 6572 6564 5365 7428 5b31 2c20 322c  rderedSet([1, 2,
-000384d0: 2033 5d29 0a20 2020 2020 2020 2022 2222   3]).        """
-000384e0: 0a20 2020 2020 2020 2063 6c73 203d 2073  .        cls = s
-000384f0: 656c 662e 5f5f 636c 6173 735f 5f20 6966  elf.__class__ if
-00038500: 2069 7369 6e73 7461 6e63 6528 7365 6c66   isinstance(self
-00038510: 2c20 4f72 6465 7265 6453 6574 2920 656c  , OrderedSet) el
-00038520: 7365 204f 7264 6572 6564 5365 740a 2020  se OrderedSet.  
-00038530: 2020 2020 2020 6966 2073 6574 733a 0a20        if sets:. 
-00038540: 2020 2020 2020 2020 2020 2063 6f6d 6d6f             commo
-00038550: 6e20 3d20 7365 742e 696e 7465 7273 6563  n = set.intersec
-00038560: 7469 6f6e 282a 6d61 7028 7365 742c 2073  tion(*map(set, s
-00038570: 6574 7329 290a 2020 2020 2020 2020 2020  ets)).          
-00038580: 2020 6974 656d 7320 3d20 2869 7465 6d20    items = (item 
-00038590: 666f 7220 6974 656d 2069 6e20 7365 6c66  for item in self
-000385a0: 2069 6620 6974 656d 2069 6e20 636f 6d6d   if item in comm
-000385b0: 6f6e 290a 2020 2020 2020 2020 656c 7365  on).        else
-000385c0: 3a0a 2020 2020 2020 2020 2020 2020 6974  :.            it
-000385d0: 656d 7320 3d20 7365 6c66 0a20 2020 2020  ems = self.     
-000385e0: 2020 2072 6574 7572 6e20 636c 7328 6974     return cls(it
-000385f0: 656d 7329 0a0a 2020 2020 6465 6620 6469  ems)..    def di
-00038600: 6666 6572 656e 6365 2873 656c 662c 202a  fference(self, *
-00038610: 7365 7473 293a 0a20 2020 2020 2020 2022  sets):.        "
-00038620: 2222 0a20 2020 2020 2020 2052 6574 7572  "".        Retur
-00038630: 6e73 2061 6c6c 2065 6c65 6d65 6e74 7320  ns all elements 
-00038640: 7468 6174 2061 7265 2069 6e20 7468 6973  that are in this
-00038650: 2073 6574 2062 7574 206e 6f74 2074 6865   set but not the
-00038660: 206f 7468 6572 732e 0a0a 2020 2020 2020   others...      
-00038670: 2020 4578 616d 706c 653a 0a20 2020 2020    Example:.     
-00038680: 2020 2020 2020 203e 3e3e 204f 7264 6572         >>> Order
-00038690: 6564 5365 7428 5b31 2c20 322c 2033 5d29  edSet([1, 2, 3])
-000386a0: 2e64 6966 6665 7265 6e63 6528 4f72 6465  .difference(Orde
-000386b0: 7265 6453 6574 285b 325d 2929 0a20 2020  redSet([2])).   
-000386c0: 2020 2020 2020 2020 204f 7264 6572 6564           Ordered
-000386d0: 5365 7428 5b31 2c20 335d 290a 2020 2020  Set([1, 3]).    
-000386e0: 2020 2020 2020 2020 3e3e 3e20 4f72 6465          >>> Orde
-000386f0: 7265 6453 6574 285b 312c 2032 2c20 335d  redSet([1, 2, 3]
-00038700: 292e 6469 6666 6572 656e 6365 284f 7264  ).difference(Ord
-00038710: 6572 6564 5365 7428 5b32 5d29 2c20 4f72  eredSet([2]), Or
-00038720: 6465 7265 6453 6574 285b 335d 2929 0a20  deredSet([3])). 
-00038730: 2020 2020 2020 2020 2020 204f 7264 6572             Order
-00038740: 6564 5365 7428 5b31 5d29 0a20 2020 2020  edSet([1]).     
-00038750: 2020 2020 2020 203e 3e3e 204f 7264 6572         >>> Order
-00038760: 6564 5365 7428 5b31 2c20 322c 2033 5d29  edSet([1, 2, 3])
-00038770: 202d 204f 7264 6572 6564 5365 7428 5b32   - OrderedSet([2
-00038780: 5d29 0a20 2020 2020 2020 2020 2020 204f  ]).            O
-00038790: 7264 6572 6564 5365 7428 5b31 2c20 335d  rderedSet([1, 3]
-000387a0: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
-000387b0: 3e20 4f72 6465 7265 6453 6574 285b 312c  > OrderedSet([1,
-000387c0: 2032 2c20 335d 292e 6469 6666 6572 656e   2, 3]).differen
-000387d0: 6365 2829 0a20 2020 2020 2020 2020 2020  ce().           
-000387e0: 204f 7264 6572 6564 5365 7428 5b31 2c20   OrderedSet([1, 
-000387f0: 322c 2033 5d29 0a20 2020 2020 2020 2022  2, 3]).        "
-00038800: 2222 0a20 2020 2020 2020 2063 6c73 203d  "".        cls =
-00038810: 2073 656c 662e 5f5f 636c 6173 735f 5f0a   self.__class__.
-00038820: 2020 2020 2020 2020 6966 2073 6574 733a          if sets:
-00038830: 0a20 2020 2020 2020 2020 2020 206f 7468  .            oth
-00038840: 6572 203d 2073 6574 2e75 6e69 6f6e 282a  er = set.union(*
-00038850: 6d61 7028 7365 742c 2073 6574 7329 290a  map(set, sets)).
-00038860: 2020 2020 2020 2020 2020 2020 6974 656d              item
-00038870: 7320 3d20 2869 7465 6d20 666f 7220 6974  s = (item for it
-00038880: 656d 2069 6e20 7365 6c66 2069 6620 6974  em in self if it
-00038890: 656d 206e 6f74 2069 6e20 6f74 6865 7229  em not in other)
-000388a0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-000388b0: 2020 2020 2020 2020 2020 2069 7465 6d73             items
-000388c0: 203d 2073 656c 660a 2020 2020 2020 2020   = self.        
-000388d0: 7265 7475 726e 2063 6c73 2869 7465 6d73  return cls(items
-000388e0: 290a 0a20 2020 2064 6566 2069 7373 7562  )..    def issub
-000388f0: 7365 7428 7365 6c66 2c20 6f74 6865 7229  set(self, other)
-00038900: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-00038910: 2020 2020 2020 5265 706f 7274 2077 6865        Report whe
-00038920: 7468 6572 2061 6e6f 7468 6572 2073 6574  ther another set
-00038930: 2063 6f6e 7461 696e 7320 7468 6973 2073   contains this s
-00038940: 6574 2e0a 0a20 2020 2020 2020 2045 7861  et...        Exa
-00038950: 6d70 6c65 3a0a 2020 2020 2020 2020 2020  mple:.          
-00038960: 2020 3e3e 3e20 4f72 6465 7265 6453 6574    >>> OrderedSet
-00038970: 285b 312c 2032 2c20 335d 292e 6973 7375  ([1, 2, 3]).issu
-00038980: 6273 6574 287b 312c 2032 7d29 0a20 2020  bset({1, 2}).   
-00038990: 2020 2020 2020 2020 2046 616c 7365 0a20           False. 
-000389a0: 2020 2020 2020 2020 2020 203e 3e3e 204f             >>> O
-000389b0: 7264 6572 6564 5365 7428 5b31 2c20 322c  rderedSet([1, 2,
-000389c0: 2033 5d29 2e69 7373 7562 7365 7428 7b31   3]).issubset({1
-000389d0: 2c20 322c 2033 2c20 347d 290a 2020 2020  , 2, 3, 4}).    
-000389e0: 2020 2020 2020 2020 5472 7565 0a20 2020          True.   
-000389f0: 2020 2020 2020 2020 203e 3e3e 204f 7264           >>> Ord
-00038a00: 6572 6564 5365 7428 5b31 2c20 322c 2033  eredSet([1, 2, 3
-00038a10: 5d29 2e69 7373 7562 7365 7428 7b31 2c20  ]).issubset({1, 
-00038a20: 342c 2033 2c20 357d 290a 2020 2020 2020  4, 3, 5}).      
-00038a30: 2020 2020 2020 4661 6c73 650a 2020 2020        False.    
-00038a40: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00038a50: 6966 206c 656e 2873 656c 6629 203e 206c  if len(self) > l
-00038a60: 656e 286f 7468 6572 293a 2020 2320 4661  en(other):  # Fa
-00038a70: 7374 2063 6865 636b 2066 6f72 206f 6276  st check for obv
-00038a80: 696f 7573 2063 6173 6573 0a20 2020 2020  ious cases.     
-00038a90: 2020 2020 2020 2072 6574 7572 6e20 4661         return Fa
-00038aa0: 6c73 650a 2020 2020 2020 2020 7265 7475  lse.        retu
-00038ab0: 726e 2061 6c6c 2869 7465 6d20 696e 206f  rn all(item in o
-00038ac0: 7468 6572 2066 6f72 2069 7465 6d20 696e  ther for item in
-00038ad0: 2073 656c 6629 0a0a 2020 2020 6465 6620   self)..    def 
-00038ae0: 6973 7375 7065 7273 6574 2873 656c 662c  issuperset(self,
-00038af0: 206f 7468 6572 293a 0a20 2020 2020 2020   other):.       
-00038b00: 2022 2222 0a20 2020 2020 2020 2052 6570   """.        Rep
-00038b10: 6f72 7420 7768 6574 6865 7220 7468 6973  ort whether this
-00038b20: 2073 6574 2063 6f6e 7461 696e 7320 616e   set contains an
-00038b30: 6f74 6865 7220 7365 742e 0a0a 2020 2020  other set...    
-00038b40: 2020 2020 4578 616d 706c 653a 0a20 2020      Example:.   
-00038b50: 2020 2020 2020 2020 203e 3e3e 204f 7264           >>> Ord
-00038b60: 6572 6564 5365 7428 5b31 2c20 325d 292e  eredSet([1, 2]).
-00038b70: 6973 7375 7065 7273 6574 285b 312c 2032  issuperset([1, 2
-00038b80: 2c20 335d 290a 2020 2020 2020 2020 2020  , 3]).          
-00038b90: 2020 4661 6c73 650a 2020 2020 2020 2020    False.        
-00038ba0: 2020 2020 3e3e 3e20 4f72 6465 7265 6453      >>> OrderedS
-00038bb0: 6574 285b 312c 2032 2c20 332c 2034 5d29  et([1, 2, 3, 4])
-00038bc0: 2e69 7373 7570 6572 7365 7428 7b31 2c20  .issuperset({1, 
-00038bd0: 322c 2033 7d29 0a20 2020 2020 2020 2020  2, 3}).         
-00038be0: 2020 2054 7275 650a 2020 2020 2020 2020     True.        
-00038bf0: 2020 2020 3e3e 3e20 4f72 6465 7265 6453      >>> OrderedS
-00038c00: 6574 285b 312c 2034 2c20 332c 2035 5d29  et([1, 4, 3, 5])
-00038c10: 2e69 7373 7570 6572 7365 7428 7b31 2c20  .issuperset({1, 
-00038c20: 322c 2033 7d29 0a20 2020 2020 2020 2020  2, 3}).         
-00038c30: 2020 2046 616c 7365 0a20 2020 2020 2020     False.       
-00038c40: 2022 2222 0a20 2020 2020 2020 2069 6620   """.        if 
-00038c50: 6c65 6e28 7365 6c66 2920 3c20 6c65 6e28  len(self) < len(
-00038c60: 6f74 6865 7229 3a20 2023 2046 6173 7420  other):  # Fast 
-00038c70: 6368 6563 6b20 666f 7220 6f62 7669 6f75  check for obviou
-00038c80: 7320 6361 7365 730a 2020 2020 2020 2020  s cases.        
-00038c90: 2020 2020 7265 7475 726e 2046 616c 7365      return False
-00038ca0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00038cb0: 616c 6c28 6974 656d 2069 6e20 7365 6c66  all(item in self
-00038cc0: 2066 6f72 2069 7465 6d20 696e 206f 7468   for item in oth
-00038cd0: 6572 290a 0a20 2020 2064 6566 2073 796d  er)..    def sym
-00038ce0: 6d65 7472 6963 5f64 6966 6665 7265 6e63  metric_differenc
-00038cf0: 6528 7365 6c66 2c20 6f74 6865 7229 3a0a  e(self, other):.
-00038d00: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00038d10: 2020 2020 5265 7475 726e 2074 6865 2073      Return the s
-00038d20: 796d 6d65 7472 6963 2064 6966 6665 7265  ymmetric differe
-00038d30: 6e63 6520 6f66 2074 776f 204f 7264 6572  nce of two Order
-00038d40: 6564 5365 7473 2061 7320 6120 6e65 7720  edSets as a new 
-00038d50: 7365 742e 0a20 2020 2020 2020 2054 6861  set..        Tha
-00038d60: 7420 6973 2c20 7468 6520 6e65 7720 7365  t is, the new se
-00038d70: 7420 7769 6c6c 2063 6f6e 7461 696e 2061  t will contain a
-00038d80: 6c6c 2065 6c65 6d65 6e74 7320 7468 6174  ll elements that
-00038d90: 2061 7265 2069 6e20 6578 6163 746c 790a   are in exactly.
-00038da0: 2020 2020 2020 2020 6f6e 6520 6f66 2074          one of t
-00038db0: 6865 2073 6574 732e 0a0a 2020 2020 2020  he sets...      
-00038dc0: 2020 5468 6569 7220 6f72 6465 7220 7769    Their order wi
-00038dd0: 6c6c 2062 6520 7072 6573 6572 7665 642c  ll be preserved,
-00038de0: 2077 6974 6820 656c 656d 656e 7473 2066   with elements f
-00038df0: 726f 6d20 6073 656c 6660 2070 7265 6365  rom `self` prece
-00038e00: 6469 6e67 0a20 2020 2020 2020 2065 6c65  ding.        ele
-00038e10: 6d65 6e74 7320 6672 6f6d 2060 6f74 6865  ments from `othe
-00038e20: 7260 2e0a 0a20 2020 2020 2020 2045 7861  r`...        Exa
-00038e30: 6d70 6c65 3a0a 2020 2020 2020 2020 2020  mple:.          
-00038e40: 2020 3e3e 3e20 7468 6973 203d 204f 7264    >>> this = Ord
-00038e50: 6572 6564 5365 7428 5b31 2c20 342c 2033  eredSet([1, 4, 3
-00038e60: 2c20 352c 2037 5d29 0a20 2020 2020 2020  , 5, 7]).       
-00038e70: 2020 2020 203e 3e3e 206f 7468 6572 203d       >>> other =
-00038e80: 204f 7264 6572 6564 5365 7428 5b39 2c20   OrderedSet([9, 
-00038e90: 372c 2031 2c20 332c 2032 5d29 0a20 2020  7, 1, 3, 2]).   
-00038ea0: 2020 2020 2020 2020 203e 3e3e 2074 6869           >>> thi
-00038eb0: 732e 7379 6d6d 6574 7269 635f 6469 6666  s.symmetric_diff
-00038ec0: 6572 656e 6365 286f 7468 6572 290a 2020  erence(other).  
-00038ed0: 2020 2020 2020 2020 2020 4f72 6465 7265            Ordere
-00038ee0: 6453 6574 285b 342c 2035 2c20 392c 2032  dSet([4, 5, 9, 2
-00038ef0: 5d29 0a20 2020 2020 2020 2022 2222 0a20  ]).        """. 
-00038f00: 2020 2020 2020 2063 6c73 203d 2073 656c         cls = sel
-00038f10: 662e 5f5f 636c 6173 735f 5f20 6966 2069  f.__class__ if i
-00038f20: 7369 6e73 7461 6e63 6528 7365 6c66 2c20  sinstance(self, 
-00038f30: 4f72 6465 7265 6453 6574 2920 656c 7365  OrderedSet) else
-00038f40: 204f 7264 6572 6564 5365 740a 2020 2020   OrderedSet.    
-00038f50: 2020 2020 6469 6666 3120 3d20 636c 7328      diff1 = cls(
-00038f60: 7365 6c66 292e 6469 6666 6572 656e 6365  self).difference
-00038f70: 286f 7468 6572 290a 2020 2020 2020 2020  (other).        
-00038f80: 6469 6666 3220 3d20 636c 7328 6f74 6865  diff2 = cls(othe
-00038f90: 7229 2e64 6966 6665 7265 6e63 6528 7365  r).difference(se
-00038fa0: 6c66 290a 2020 2020 2020 2020 7265 7475  lf).        retu
-00038fb0: 726e 2064 6966 6631 2e75 6e69 6f6e 2864  rn diff1.union(d
-00038fc0: 6966 6632 290a 0a20 2020 2064 6566 205f  iff2)..    def _
-00038fd0: 7570 6461 7465 5f69 7465 6d73 2873 656c  update_items(sel
-00038fe0: 662c 2069 7465 6d73 293a 0a20 2020 2020  f, items):.     
-00038ff0: 2020 2022 2222 0a20 2020 2020 2020 2052     """.        R
-00039000: 6570 6c61 6365 2074 6865 2027 6974 656d  eplace the 'item
-00039010: 7327 206c 6973 7420 6f66 2074 6869 7320  s' list of this 
-00039020: 4f72 6465 7265 6453 6574 2077 6974 6820  OrderedSet with 
-00039030: 6120 6e65 7720 6f6e 652c 2075 7064 6174  a new one, updat
-00039040: 696e 670a 2020 2020 2020 2020 7365 6c66  ing.        self
-00039050: 2e6d 6170 2061 6363 6f72 6469 6e67 6c79  .map accordingly
-00039060: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00039070: 2020 2020 2020 7365 6c66 2e69 7465 6d73        self.items
-00039080: 203d 2069 7465 6d73 0a20 2020 2020 2020   = items.       
-00039090: 2073 656c 662e 6d61 7020 3d20 7b69 7465   self.map = {ite
-000390a0: 6d3a 2069 6478 2066 6f72 2028 6964 782c  m: idx for (idx,
-000390b0: 2069 7465 6d29 2069 6e20 656e 756d 6572   item) in enumer
-000390c0: 6174 6528 6974 656d 7329 7d0a 0a20 2020  ate(items)}..   
-000390d0: 2064 6566 2064 6966 6665 7265 6e63 655f   def difference_
-000390e0: 7570 6461 7465 2873 656c 662c 202a 7365  update(self, *se
-000390f0: 7473 293a 0a20 2020 2020 2020 2022 2222  ts):.        """
-00039100: 0a20 2020 2020 2020 2055 7064 6174 6520  .        Update 
-00039110: 7468 6973 204f 7264 6572 6564 5365 7420  this OrderedSet 
-00039120: 746f 2072 656d 6f76 6520 6974 656d 7320  to remove items 
-00039130: 6672 6f6d 206f 6e65 206f 7220 6d6f 7265  from one or more
-00039140: 206f 7468 6572 2073 6574 732e 0a0a 2020   other sets...  
-00039150: 2020 2020 2020 4578 616d 706c 653a 0a20        Example:. 
-00039160: 2020 2020 2020 2020 2020 203e 3e3e 2074             >>> t
-00039170: 6869 7320 3d20 4f72 6465 7265 6453 6574  his = OrderedSet
-00039180: 285b 312c 2032 2c20 335d 290a 2020 2020  ([1, 2, 3]).    
-00039190: 2020 2020 2020 2020 3e3e 3e20 7468 6973          >>> this
-000391a0: 2e64 6966 6665 7265 6e63 655f 7570 6461  .difference_upda
-000391b0: 7465 284f 7264 6572 6564 5365 7428 5b32  te(OrderedSet([2
-000391c0: 2c20 345d 2929 0a20 2020 2020 2020 2020  , 4])).         
-000391d0: 2020 203e 3e3e 2070 7269 6e74 2874 6869     >>> print(thi
-000391e0: 7329 0a20 2020 2020 2020 2020 2020 204f  s).            O
-000391f0: 7264 6572 6564 5365 7428 5b31 2c20 335d  rderedSet([1, 3]
-00039200: 290a 0a20 2020 2020 2020 2020 2020 203e  )..            >
-00039210: 3e3e 2074 6869 7320 3d20 4f72 6465 7265  >> this = Ordere
-00039220: 6453 6574 285b 312c 2032 2c20 332c 2034  dSet([1, 2, 3, 4
-00039230: 2c20 355d 290a 2020 2020 2020 2020 2020  , 5]).          
-00039240: 2020 3e3e 3e20 7468 6973 2e64 6966 6665    >>> this.diffe
-00039250: 7265 6e63 655f 7570 6461 7465 284f 7264  rence_update(Ord
-00039260: 6572 6564 5365 7428 5b32 2c20 345d 292c  eredSet([2, 4]),
-00039270: 204f 7264 6572 6564 5365 7428 5b31 2c20   OrderedSet([1, 
-00039280: 342c 2036 5d29 290a 2020 2020 2020 2020  4, 6])).        
-00039290: 2020 2020 3e3e 3e20 7072 696e 7428 7468      >>> print(th
-000392a0: 6973 290a 2020 2020 2020 2020 2020 2020  is).            
-000392b0: 4f72 6465 7265 6453 6574 285b 332c 2035  OrderedSet([3, 5
-000392c0: 5d29 0a20 2020 2020 2020 2022 2222 0a20  ]).        """. 
-000392d0: 2020 2020 2020 2069 7465 6d73 5f74 6f5f         items_to_
-000392e0: 7265 6d6f 7665 203d 2073 6574 2829 0a20  remove = set(). 
-000392f0: 2020 2020 2020 2066 6f72 206f 7468 6572         for other
-00039300: 2069 6e20 7365 7473 3a0a 2020 2020 2020   in sets:.      
-00039310: 2020 2020 2020 6974 656d 735f 746f 5f72        items_to_r
-00039320: 656d 6f76 6520 7c3d 2073 6574 286f 7468  emove |= set(oth
-00039330: 6572 290a 2020 2020 2020 2020 7365 6c66  er).        self
-00039340: 2e5f 7570 6461 7465 5f69 7465 6d73 285b  ._update_items([
-00039350: 6974 656d 2066 6f72 2069 7465 6d20 696e  item for item in
-00039360: 2073 656c 662e 6974 656d 7320 6966 2069   self.items if i
-00039370: 7465 6d20 6e6f 7420 696e 2069 7465 6d73  tem not in items
-00039380: 5f74 6f5f 7265 6d6f 7665 5d29 0a0a 2020  _to_remove])..  
-00039390: 2020 6465 6620 696e 7465 7273 6563 7469    def intersecti
-000393a0: 6f6e 5f75 7064 6174 6528 7365 6c66 2c20  on_update(self, 
-000393b0: 6f74 6865 7229 3a0a 2020 2020 2020 2020  other):.        
-000393c0: 2222 220a 2020 2020 2020 2020 5570 6461  """.        Upda
-000393d0: 7465 2074 6869 7320 4f72 6465 7265 6453  te this OrderedS
-000393e0: 6574 2074 6f20 6b65 6570 206f 6e6c 7920  et to keep only 
-000393f0: 6974 656d 7320 696e 2061 6e6f 7468 6572  items in another
-00039400: 2073 6574 2c20 7072 6573 6572 7669 6e67   set, preserving
-00039410: 0a20 2020 2020 2020 2074 6865 6972 206f  .        their o
-00039420: 7264 6572 2069 6e20 7468 6973 2073 6574  rder in this set
-00039430: 2e0a 0a20 2020 2020 2020 2045 7861 6d70  ...        Examp
-00039440: 6c65 3a0a 2020 2020 2020 2020 2020 2020  le:.            
-00039450: 3e3e 3e20 7468 6973 203d 204f 7264 6572  >>> this = Order
-00039460: 6564 5365 7428 5b31 2c20 342c 2033 2c20  edSet([1, 4, 3, 
-00039470: 352c 2037 5d29 0a20 2020 2020 2020 2020  5, 7]).         
-00039480: 2020 203e 3e3e 206f 7468 6572 203d 204f     >>> other = O
-00039490: 7264 6572 6564 5365 7428 5b39 2c20 372c  rderedSet([9, 7,
-000394a0: 2031 2c20 332c 2032 5d29 0a20 2020 2020   1, 3, 2]).     
-000394b0: 2020 2020 2020 203e 3e3e 2074 6869 732e         >>> this.
-000394c0: 696e 7465 7273 6563 7469 6f6e 5f75 7064  intersection_upd
-000394d0: 6174 6528 6f74 6865 7229 0a20 2020 2020  ate(other).     
-000394e0: 2020 2020 2020 203e 3e3e 2070 7269 6e74         >>> print
-000394f0: 2874 6869 7329 0a20 2020 2020 2020 2020  (this).         
-00039500: 2020 204f 7264 6572 6564 5365 7428 5b31     OrderedSet([1
-00039510: 2c20 332c 2037 5d29 0a20 2020 2020 2020  , 3, 7]).       
-00039520: 2022 2222 0a20 2020 2020 2020 206f 7468   """.        oth
-00039530: 6572 203d 2073 6574 286f 7468 6572 290a  er = set(other).
-00039540: 2020 2020 2020 2020 7365 6c66 2e5f 7570          self._up
-00039550: 6461 7465 5f69 7465 6d73 285b 6974 656d  date_items([item
-00039560: 2066 6f72 2069 7465 6d20 696e 2073 656c   for item in sel
-00039570: 662e 6974 656d 7320 6966 2069 7465 6d20  f.items if item 
-00039580: 696e 206f 7468 6572 5d29 0a0a 2020 2020  in other])..    
-00039590: 6465 6620 7379 6d6d 6574 7269 635f 6469  def symmetric_di
-000395a0: 6666 6572 656e 6365 5f75 7064 6174 6528  fference_update(
-000395b0: 7365 6c66 2c20 6f74 6865 7229 3a0a 2020  self, other):.  
-000395c0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000395d0: 2020 5570 6461 7465 2074 6869 7320 4f72    Update this Or
-000395e0: 6465 7265 6453 6574 2074 6f20 7265 6d6f  deredSet to remo
-000395f0: 7665 2069 7465 6d73 2066 726f 6d20 616e  ve items from an
-00039600: 6f74 6865 7220 7365 742c 2074 6865 6e0a  other set, then.
-00039610: 2020 2020 2020 2020 6164 6420 6974 656d          add item
-00039620: 7320 6672 6f6d 2074 6865 206f 7468 6572  s from the other
-00039630: 2073 6574 2074 6861 7420 7765 7265 206e   set that were n
-00039640: 6f74 2070 7265 7365 6e74 2069 6e20 7468  ot present in th
-00039650: 6973 2073 6574 2e0a 0a20 2020 2020 2020  is set...       
-00039660: 2045 7861 6d70 6c65 3a0a 2020 2020 2020   Example:.      
-00039670: 2020 2020 2020 3e3e 3e20 7468 6973 203d        >>> this =
-00039680: 204f 7264 6572 6564 5365 7428 5b31 2c20   OrderedSet([1, 
-00039690: 342c 2033 2c20 352c 2037 5d29 0a20 2020  4, 3, 5, 7]).   
-000396a0: 2020 2020 2020 2020 203e 3e3e 206f 7468           >>> oth
-000396b0: 6572 203d 204f 7264 6572 6564 5365 7428  er = OrderedSet(
-000396c0: 5b39 2c20 372c 2031 2c20 332c 2032 5d29  [9, 7, 1, 3, 2])
-000396d0: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-000396e0: 2074 6869 732e 7379 6d6d 6574 7269 635f   this.symmetric_
-000396f0: 6469 6666 6572 656e 6365 5f75 7064 6174  difference_updat
-00039700: 6528 6f74 6865 7229 0a20 2020 2020 2020  e(other).       
-00039710: 2020 2020 203e 3e3e 2070 7269 6e74 2874       >>> print(t
-00039720: 6869 7329 0a20 2020 2020 2020 2020 2020  his).           
-00039730: 204f 7264 6572 6564 5365 7428 5b34 2c20   OrderedSet([4, 
-00039740: 352c 2039 2c20 325d 290a 2020 2020 2020  5, 9, 2]).      
-00039750: 2020 2222 220a 2020 2020 2020 2020 6974    """.        it
-00039760: 656d 735f 746f 5f61 6464 203d 205b 6974  ems_to_add = [it
-00039770: 656d 2066 6f72 2069 7465 6d20 696e 206f  em for item in o
-00039780: 7468 6572 2069 6620 6974 656d 206e 6f74  ther if item not
-00039790: 2069 6e20 7365 6c66 5d0a 2020 2020 2020   in self].      
-000397a0: 2020 6974 656d 735f 746f 5f72 656d 6f76    items_to_remov
-000397b0: 6520 3d20 7365 7428 6f74 6865 7229 0a20  e = set(other). 
-000397c0: 2020 2020 2020 2073 656c 662e 5f75 7064         self._upd
-000397d0: 6174 655f 6974 656d 7328 0a20 2020 2020  ate_items(.     
-000397e0: 2020 2020 2020 205b 6974 656d 2066 6f72         [item for
-000397f0: 2069 7465 6d20 696e 2073 656c 662e 6974   item in self.it
-00039800: 656d 7320 6966 2069 7465 6d20 6e6f 7420  ems if item not 
-00039810: 696e 2069 7465 6d73 5f74 6f5f 7265 6d6f  in items_to_remo
-00039820: 7665 5d20 2b20 6974 656d 735f 746f 5f61  ve] + items_to_a
-00039830: 6464 0a20 2020 2020 2020 2029 0a0a 6465  dd.        )..de
-00039840: 6620 6f63 7228 696d 673d 4e6f 6e65 2c6c  f ocr(img=None,l
-00039850: 616e 673d 5b27 656e 275d 2c67 7075 3d46  ang=['en'],gpu=F
-00039860: 616c 7365 2c2a 6172 6773 2c2a 2a6b 7761  alse,*args,**kwa
-00039870: 7267 7329 3a0a 2020 2020 2222 220a 2020  rgs):.    """.  
-00039880: 2020 696d 673a 2066 696c 6570 6174 682c    img: filepath,
-00039890: 204f 7065 6e43 5620 696d 6167 6520 6f62   OpenCV image ob
-000398a0: 6a65 6374 2028 6e75 6d70 7920 6172 7261  ject (numpy arra
-000398b0: 7929 2c20 696d 6167 6520 6669 6c65 2061  y), image file a
-000398c0: 7320 6279 7465 732c 2055 524c 2074 6f20  s bytes, URL to 
-000398d0: 7261 7720 696d 6167 6520 2864 6566 6175  raw image (defau
-000398e0: 6c74 204e 6f6e 653d 636c 6970 626f 6172  lt None=clipboar
-000398f0: 6420 696d 6729 0a20 2020 206c 616e 673a  d img).    lang:
-00039900: 205b 2765 6e27 2c27 6368 5f73 696d 272c   ['en','ch_sim',
-00039910: 2763 685f 7472 6127 5d0a 2020 2020 6874  'ch_tra'].    ht
-00039920: 7470 733a 2f2f 7777 772e 6a61 6964 6564  tps://www.jaided
-00039930: 2e61 692f 6561 7379 6f63 722f 646f 6375  .ai/easyocr/docu
-00039940: 6d65 6e74 6174 696f 6e2f 0a20 2020 2022  mentation/.    "
-00039950: 2222 0a20 2020 2066 726f 6d20 5049 4c20  "".    from PIL 
-00039960: 696d 706f 7274 2049 6d61 6765 4772 6162  import ImageGrab
-00039970: 0a20 2020 2069 6d70 6f72 7420 6561 7379  .    import easy
-00039980: 6f63 720a 2020 2020 6966 2069 6d67 2069  ocr.    if img i
-00039990: 7320 4e6f 6e65 3a20 696d 6720 3d20 496d  s None: img = Im
-000399a0: 6167 6547 7261 622e 6772 6162 636c 6970  ageGrab.grabclip
-000399b0: 626f 6172 6428 290a 2020 2020 7265 6164  board().    read
-000399c0: 6572 203d 2065 6173 796f 6372 2e52 6561  er = easyocr.Rea
-000399d0: 6465 7228 6c61 6e67 2c67 7075 3d67 7075  der(lang,gpu=gpu
-000399e0: 290a 2020 2020 7265 7375 6c74 203d 2072  ).    result = r
-000399f0: 6561 6465 722e 7265 6164 7465 7874 2869  eader.readtext(i
-00039a00: 6d67 2c64 6574 6169 6c3d 5472 7565 2c70  mg,detail=True,p
-00039a10: 6172 6167 7261 7068 3d46 616c 7365 2c2a  aragraph=False,*
-00039a20: 6172 6773 2c2a 2a6b 7761 7267 7329 0a20  args,**kwargs). 
-00039a30: 2020 2023 2072 6573 756c 743d 5b28 5b5b     # result=[([[
-00039a40: 3138 392c 2037 355d 2c20 5b34 3639 2c20  189, 75], [469, 
-00039a50: 3735 5d2c 205b 3436 392c 2031 3635 5d2c  75], [469, 165],
-00039a60: 205b 3138 392c 2031 3635 5d5d 2c20 27e6   [189, 165]], '.
-00039a70: 849a e59b ade8 b7af 272c 2030 2e33 3735  ........', 0.375
-00039a80: 3439 3839 3530 3438 3134 3134 3829 2c0a  4989504814148),.
-00039a90: 2020 2020 2320 2028 5b5b 3836 2c20 3830      #  ([[86, 80
-00039aa0: 5d2c 205b 3133 342c 2038 305d 2c20 5b31  ], [134, 80], [1
-00039ab0: 3334 2c20 3132 385d 2c20 5b38 362c 2031  34, 128], [86, 1
-00039ac0: 3238 5d5d 2c20 27e8 a5bf 272c 2030 2e34  28]], '...', 0.4
-00039ad0: 3034 3532 3635 3931 3330 3039 3634 3336  0452659130096436
-00039ae0: 292c 0a20 2020 2023 2020 285b 5b35 3137  ),.    #  ([[517
-00039af0: 2c20 3831 5d2c 205b 3536 352c 2038 315d  , 81], [565, 81]
-00039b00: 2c20 5b35 3635 2c20 3132 335d 2c20 5b35  , [565, 123], [5
-00039b10: 3137 2c20 3132 335d 5d2c 2027 e4b8 9c27  17, 123]], '...'
-00039b20: 2c20 302e 3939 3839 3539 3839 3839 3438  , 0.998959898948
-00039b30: 3636 3934 292c 0a20 2020 2023 2020 285b  6694),.    #  ([
-00039b40: 5b37 382c 2031 3236 5d2c 205b 3133 362c  [78, 126], [136,
-00039b50: 2031 3236 5d2c 205b 3133 362c 2031 3536   126], [136, 156
-00039b60: 5d2c 205b 3738 2c20 3135 365d 5d2c 2027  ], [78, 156]], '
-00039b70: 3331 3527 2c20 302e 3831 3235 3838 3933  315', 0.81258893
-00039b80: 3031 3330 3030 3439 292c 0a20 2020 2023  01300049),.    #
-00039b90: 2020 285b 5b35 3134 2c20 3132 365d 2c20    ([[514, 126], 
-00039ba0: 5b35 3734 2c20 3132 365d 2c20 5b35 3734  [574, 126], [574
-00039bb0: 2c20 3135 365d 2c20 5b35 3134 2c20 3135  , 156], [514, 15
-00039bc0: 365d 5d2c 2027 3330 3927 2c20 302e 3439  6]], '309', 0.49
-00039bd0: 3731 3537 3732 3237 3131 3536 3331 292c  71577227115631),
-00039be0: 0a20 2020 2023 2020 285b 5b32 3236 2c20  .    #  ([[226, 
-00039bf0: 3137 305d 2c20 5b34 3134 2c20 3137 305d  170], [414, 170]
-00039c00: 2c20 5b34 3134 2c20 3232 305d 2c20 5b32  , [414, 220], [2
-00039c10: 3236 2c20 3232 305d 5d2c 2027 5975 7975  26, 220]], 'Yuyu
-00039c20: 616e 2052 642e 272c 2030 2e38 3236 3139  an Rd.', 0.82619
-00039c30: 3032 3333 3233 3035 3930 3829 2c0a 2020  02332305908),.  
-00039c40: 2020 2320 2028 5b5b 3739 2c20 3137 335d    #  ([[79, 173]
-00039c50: 2c20 5b31 3235 2c20 3137 335d 2c20 5b31  , [125, 173], [1
-00039c60: 3235 2c20 3231 335d 2c20 5b37 392c 2032  25, 213], [79, 2
-00039c70: 3133 5d5d 2c20 2757 272c 2030 2e39 3834  13]], 'W', 0.984
-00039c80: 3831 3131 3237 3138 3538 3231 3529 2c0a  8111271858215),.
-00039c90: 2020 2020 2320 2028 5b5b 3532 392c 2031      #  ([[529, 1
-00039ca0: 3733 5d2c 205b 3536 392c 2031 3733 5d2c  73], [569, 173],
-00039cb0: 205b 3536 392c 2032 3133 5d2c 205b 3532   [569, 213], [52
-00039cc0: 392c 2032 3133 5d5d 2c20 2745 272c 2030  9, 213]], 'E', 0
-00039cd0: 2e38 3430 3535 3933 3633 3336 3531 3733  .840559363365173
-00039ce0: 3329 5d0a 2020 2020 746f 703d 5b5d 3b20  3)].    top=[]; 
-00039cf0: 6c65 6674 3d5b 5d3b 206f 7574 3d7b 7d0a  left=[]; out={}.
-00039d00: 2020 2020 666f 7220 7220 696e 2072 6573      for r in res
-00039d10: 756c 743a 0a20 2020 2020 2020 2074 6f70  ult:.        top
-00039d20: 3d72 5b30 5d5b 305d 5b31 5d3b 206c 6566  =r[0][0][1]; lef
-00039d30: 743d 725b 305d 5b30 5d5b 305d 3b20 7465  t=r[0][0][0]; te
-00039d40: 7874 3d72 5b31 5d0a 2020 2020 2020 2020  xt=r[1].        
-00039d50: 6966 2074 6f70 206e 6f74 2069 6e20 6f75  if top not in ou
-00039d60: 742e 6b65 7973 2829 3a0a 2020 2020 2020  t.keys():.      
-00039d70: 2020 2020 2020 2320 2f31 3020 746f 2073        # /10 to s
-00039d80: 6361 6c65 0a20 2020 2020 2020 2020 2020  cale.           
-00039d90: 206f 7574 5b74 6f70 5d3d 2720 272a 696e   out[top]=' '*in
-00039da0: 7428 6c65 6674 2f31 3029 2b74 6578 740a  t(left/10)+text.
-00039db0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00039dc0: 2020 2020 2020 2020 2020 7465 7874 5f6f            text_o
-00039dd0: 6c64 203d 206f 7574 5b74 6f70 5d2e 6c73  ld = out[top].ls
-00039de0: 7472 6970 2829 0a20 2020 2020 2020 2020  trip().         
-00039df0: 2020 2074 6578 745f 6e65 7720 3d20 7465     text_new = te
-00039e00: 7874 0a20 2020 2020 2020 2020 2020 206c  xt.            l
-00039e10: 6566 745f 6f6c 6420 3d20 6c65 6e28 6f75  eft_old = len(ou
-00039e20: 745b 746f 705d 2920 2d20 6c65 6e28 6f75  t[top]) - len(ou
-00039e30: 745b 746f 705d 2e6c 7374 7269 7028 2929  t[top].lstrip())
-00039e40: 0a20 2020 2020 2020 2020 2020 206c 6566  .            lef
-00039e50: 745f 6e65 7720 3d20 696e 7428 6c65 6674  t_new = int(left
-00039e60: 2f31 3029 0a20 2020 2020 2020 2020 2020  /10).           
-00039e70: 2069 6620 6c65 6674 5f6e 6577 203e 206c   if left_new > l
-00039e80: 6566 745f 6f6c 643a 0a20 2020 2020 2020  eft_old:.       
-00039e90: 2020 2020 2020 2020 2070 6172 7431 203d           part1 =
-00039ea0: 2027 2027 2a69 6e74 286c 6566 745f 6f6c   ' '*int(left_ol
-00039eb0: 642f 3130 292b 7465 7874 5f6f 6c64 3b20  d/10)+text_old; 
-00039ec0: 7061 7274 3220 3d20 2720 272a 696e 7428  part2 = ' '*int(
-00039ed0: 6c65 6674 5f6e 6577 202d 206c 656e 2870  left_new - len(p
-00039ee0: 6172 7431 2929 2b74 6578 745f 6e65 770a  art1))+text_new.
-00039ef0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00039f00: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00039f10: 2020 2320 756e 6c69 6b65 2074 6f20 7472    # unlike to tr
-00039f20: 6967 6765 722c 2073 696e 6365 2072 6573  igger, since res
-00039f30: 756c 7420 6f72 6465 7265 6420 6279 2074  ult ordered by t
-00039f40: 6f70 2061 6c72 6561 6479 0a20 2020 2020  op already.     
-00039f50: 2020 2020 2020 2020 2020 2070 6172 7431             part1
-00039f60: 203d 2027 2027 2a69 6e74 286c 6566 745f   = ' '*int(left_
-00039f70: 6e65 772f 3130 292b 7465 7874 5f6e 6577  new/10)+text_new
-00039f80: 3b20 7061 7274 3220 3d20 2720 272a 696e  ; part2 = ' '*in
-00039f90: 7428 6c65 6674 5f6f 6c64 202d 206c 656e  t(left_old - len
-00039fa0: 2870 6172 7431 2929 2b74 6578 745f 6f6c  (part1))+text_ol
-00039fb0: 640a 2020 2020 2020 2020 2020 2020 6f75  d.            ou
-00039fc0: 745b 746f 705d 203d 2070 6172 7431 2b70  t[top] = part1+p
-00039fd0: 6172 7432 0a20 2020 2072 6573 756c 743d  art2.    result=
-00039fe0: 5b74 6578 7420 666f 7220 2874 6f70 2c20  [text for (top, 
-00039ff0: 7465 7874 2920 696e 2073 6f72 7465 6428  text) in sorted(
-0003a000: 6f75 742e 6974 656d 7328 2929 5d0a 2020  out.items())].  
-0003a010: 2020 7265 7475 726e 2072 6573 756c 740a    return result.
-0003a020: 2020 2020 2320 666f 7220 7220 696e 2072      # for r in r
-0003a030: 6573 756c 743a 0a20 2020 2023 2020 2020  esult:.    #    
-0003a040: 2070 7269 6e74 2872 290a 0a64 6566 2067   print(r)..def g
-0003a050: 6966 2869 6d67 732c 6f75 743d 2761 6e69  if(imgs,out='ani
-0003a060: 6d61 7469 6f6e 2e67 6966 272c 6372 6f70  mation.gif',crop
-0003a070: 3d4e 6f6e 652c 6475 7261 7469 6f6e 3d33  =None,duration=3
-0003a080: 3030 2c6c 6f6f 703d 3029 3a0a 2020 2020  00,loop=0):.    
-0003a090: 2222 220a 2020 2020 696d 6773 3a20 6120  """.    imgs: a 
-0003a0a0: 6c69 7374 206f 6620 696d 6167 6520 7061  list of image pa
-0003a0b0: 7468 0a20 2020 206f 7574 3a20 7061 7468  th.    out: path
-0003a0c0: 206f 6620 6769 6620 746f 2073 6176 650a   of gif to save.
-0003a0d0: 2020 2020 6372 6f70 3a20 5b6c 6566 742c      crop: [left,
-0003a0e0: 2075 702c 2072 6967 6874 2c20 626f 7474   up, right, bott
-0003a0f0: 6f6d 5d20 6f66 2074 6865 2069 6d61 6765  om] of the image
-0003a100: 2074 6f20 6372 6f70 0a20 2020 2064 7572   to crop.    dur
-0003a110: 6174 696f 6e3a 2061 2073 696e 676c 6520  ation: a single 
-0003a120: 7661 6c75 6520 6f72 2061 206c 6973 7420  value or a list 
-0003a130: 6f66 2076 616c 7565 7320 666f 7220 6561  of values for ea
-0003a140: 6368 2066 7261 6d65 2028 696e 206d 7329  ch frame (in ms)
-0003a150: 0a20 2020 206c 6f6f 703a 203e 3d30 2c20  .    loop: >=0, 
-0003a160: 3020 666f 7265 7665 720a 2020 2020 2222  0 forever.    ""
-0003a170: 220a 2020 2020 6672 6f6d 2050 494c 2069  ".    from PIL i
-0003a180: 6d70 6f72 7420 496d 6167 650a 2020 2020  mport Image.    
-0003a190: 2320 4372 6561 7465 2074 6865 2066 7261  # Create the fra
-0003a1a0: 6d65 730a 2020 2020 6672 616d 6573 203d  mes.    frames =
-0003a1b0: 205b 5d0a 2020 2020 666f 7220 6920 696e   [].    for i in
-0003a1c0: 2069 6d67 733a 0a20 2020 2020 2020 2069   imgs:.        i
-0003a1d0: 6d20 3d20 496d 6167 652e 6f70 656e 2869  m = Image.open(i
-0003a1e0: 290a 2020 2020 2020 2020 7072 696e 7428  ).        print(
-0003a1f0: 6622 496e 7075 7420 696d 6167 6520 7b69  f"Input image {i
-0003a200: 7d3a 2077 207b 696d 2e73 697a 655b 305d  }: w {im.size[0]
-0003a210: 7d20 7820 6820 7b69 6d2e 7369 7a65 5b31  } x h {im.size[1
-0003a220: 5d7d 2229 0a20 2020 2020 2020 2069 6620  ]}").        if 
-0003a230: 6372 6f70 2069 7320 6e6f 7420 4e6f 6e65  crop is not None
-0003a240: 3a20 696d 203d 2069 6d2e 6372 6f70 2863  : im = im.crop(c
-0003a250: 726f 7029 0a20 2020 2020 2020 2066 7261  rop).        fra
-0003a260: 6d65 732e 6170 7065 6e64 2869 6d29 0a0a  mes.append(im)..
-0003a270: 2020 2020 2320 5361 7665 2069 6e74 6f20      # Save into 
-0003a280: 6120 4749 4620 6669 6c65 0a20 2020 2066  a GIF file.    f
-0003a290: 7261 6d65 735b 305d 2e73 6176 6528 6f75  rames[0].save(ou
-0003a2a0: 742c 2066 6f72 6d61 743d 2747 4946 272c  t, format='GIF',
-0003a2b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003a2c0: 2020 2020 6170 7065 6e64 5f69 6d61 6765      append_image
-0003a2d0: 733d 6672 616d 6573 5b31 3a5d 2c0a 2020  s=frames[1:],.  
-0003a2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a2f0: 2073 6176 655f 616c 6c3d 5472 7565 2c0a   save_all=True,.
-0003a300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a310: 2020 2064 7572 6174 696f 6e3d 6475 7261     duration=dura
-0003a320: 7469 6f6e 2c20 6c6f 6f70 3d6c 6f6f 7029  tion, loop=loop)
-0003a330: 0a20 2020 2070 7269 6e74 2866 224f 7574  .    print(f"Out
-0003a340: 7075 7420 6769 663a 207b 6f75 747d 2229  put gif: {out}")
-0003a350: 0a0a 2320 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ..# ++++++++++++
+00035cf0: 2a2a 2a2a 2a2a 2a0a 2222 220a 6874 7470  *******.""".http
+00035d00: 733a 2f2f 7079 7069 2e6f 7267 2f70 726f  s://pypi.org/pro
+00035d10: 6a65 6374 2f6f 7264 6572 6564 2d73 6574  ject/ordered-set
+00035d20: 2f0a 416e 204f 7264 6572 6564 5365 7420  /.An OrderedSet 
+00035d30: 6973 2061 2063 7573 746f 6d20 4d75 7461  is a custom Muta
+00035d40: 626c 6553 6574 2074 6861 7420 7265 6d65  bleSet that reme
+00035d50: 6d62 6572 7320 6974 7320 6f72 6465 722c  mbers its order,
+00035d60: 2073 6f20 7468 6174 2065 7665 7279 0a65   so that every.e
+00035d70: 6e74 7279 2068 6173 2061 6e20 696e 6465  ntry has an inde
+00035d80: 7820 7468 6174 2063 616e 2062 6520 6c6f  x that can be lo
+00035d90: 6f6b 6564 2075 702e 0a0a 4261 7365 6420  oked up...Based 
+00035da0: 6f6e 2061 2072 6563 6970 6520 6f72 6967  on a recipe orig
+00035db0: 696e 616c 6c79 2070 6f73 7465 6420 746f  inally posted to
+00035dc0: 2041 6374 6976 6553 7461 7465 2052 6563   ActiveState Rec
+00035dd0: 6970 6573 2062 7920 5261 796d 6f6e 6420  ipes by Raymond 
+00035de0: 4865 7474 6967 6572 2c0a 616e 6420 7265  Hettiger,.and re
+00035df0: 6c65 6173 6564 2075 6e64 6572 2074 6865  leased under the
+00035e00: 204d 4954 206c 6963 656e 7365 2e0a 2222   MIT license..""
+00035e10: 220a 696d 706f 7274 2069 7465 7274 6f6f  ".import itertoo
+00035e20: 6c73 2061 7320 6974 0a66 726f 6d20 636f  ls as it.from co
+00035e30: 6c6c 6563 7469 6f6e 7320 696d 706f 7274  llections import
+00035e40: 2064 6571 7565 0a0a 7472 793a 0a20 2020   deque..try:.   
+00035e50: 2023 2050 7974 686f 6e20 330a 2020 2020   # Python 3.    
+00035e60: 6672 6f6d 2063 6f6c 6c65 6374 696f 6e73  from collections
+00035e70: 2e61 6263 2069 6d70 6f72 7420 4d75 7461  .abc import Muta
+00035e80: 626c 6553 6574 2c20 5365 7175 656e 6365  bleSet, Sequence
+00035e90: 0a65 7863 6570 7420 496d 706f 7274 4572  .except ImportEr
+00035ea0: 726f 723a 0a20 2020 2023 2050 7974 686f  ror:.    # Pytho
+00035eb0: 6e20 322e 370a 2020 2020 6672 6f6d 2063  n 2.7.    from c
+00035ec0: 6f6c 6c65 6374 696f 6e73 2069 6d70 6f72  ollections impor
+00035ed0: 7420 4d75 7461 626c 6553 6574 2c20 5365  t MutableSet, Se
+00035ee0: 7175 656e 6365 0a0a 534c 4943 455f 414c  quence..SLICE_AL
+00035ef0: 4c20 3d20 736c 6963 6528 4e6f 6e65 290a  L = slice(None).
+00035f00: 5f5f 7665 7273 696f 6e5f 5f20 3d20 2233  __version__ = "3
+00035f10: 2e31 220a 0a0a 6465 6620 6973 5f69 7465  .1"...def is_ite
+00035f20: 7261 626c 6528 6f62 6a29 3a0a 2020 2020  rable(obj):.    
+00035f30: 2222 220a 2020 2020 4172 6520 7765 2062  """.    Are we b
+00035f40: 6569 6e67 2061 736b 6564 2074 6f20 6c6f  eing asked to lo
+00035f50: 6f6b 2075 7020 6120 6c69 7374 206f 6620  ok up a list of 
+00035f60: 7468 696e 6773 2c20 696e 7374 6561 6420  things, instead 
+00035f70: 6f66 2061 2073 696e 676c 6520 7468 696e  of a single thin
+00035f80: 673f 0a20 2020 2057 6520 6368 6563 6b20  g?.    We check 
+00035f90: 666f 7220 7468 6520 605f 5f69 7465 725f  for the `__iter_
+00035fa0: 5f60 2061 7474 7269 6275 7465 2073 6f20  _` attribute so 
+00035fb0: 7468 6174 2074 6869 7320 6361 6e20 636f  that this can co
+00035fc0: 7665 7220 7479 7065 7320 7468 6174 0a20  ver types that. 
+00035fd0: 2020 2064 6f6e 2774 2068 6176 6520 746f     don't have to
+00035fe0: 2062 6520 6b6e 6f77 6e20 6279 2074 6869   be known by thi
+00035ff0: 7320 6d6f 6475 6c65 2c20 7375 6368 2061  s module, such a
+00036000: 7320 4e75 6d50 7920 6172 7261 7973 2e0a  s NumPy arrays..
+00036010: 0a20 2020 2053 7472 696e 6773 2c20 686f  .    Strings, ho
+00036020: 7765 7665 722c 2073 686f 756c 6420 6265  wever, should be
+00036030: 2063 6f6e 7369 6465 7265 6420 6173 2061   considered as a
+00036040: 746f 6d69 6320 7661 6c75 6573 2074 6f20  tomic values to 
+00036050: 6c6f 6f6b 2075 702c 206e 6f74 0a20 2020  look up, not.   
+00036060: 2069 7465 7261 626c 6573 2e20 5468 6520   iterables. The 
+00036070: 7361 6d65 2067 6f65 7320 666f 7220 7475  same goes for tu
+00036080: 706c 6573 2c20 7369 6e63 6520 7468 6579  ples, since they
+00036090: 2061 7265 2069 6d6d 7574 6162 6c65 2061   are immutable a
+000360a0: 6e64 2074 6865 7265 666f 7265 0a20 2020  nd therefore.   
+000360b0: 2076 616c 6964 2065 6e74 7269 6573 2e0a   valid entries..
+000360c0: 0a20 2020 2057 6520 646f 6e27 7420 6e65  .    We don't ne
+000360d0: 6564 2074 6f20 6368 6563 6b20 666f 7220  ed to check for 
+000360e0: 7468 6520 5079 7468 6f6e 2032 2060 756e  the Python 2 `un
+000360f0: 6963 6f64 6560 2074 7970 652c 2062 6563  icode` type, bec
+00036100: 6175 7365 2069 7420 646f 6573 6e27 740a  ause it doesn't.
+00036110: 2020 2020 6861 7665 2061 6e20 605f 5f69      have an `__i
+00036120: 7465 725f 5f60 2061 7474 7269 6275 7465  ter__` attribute
+00036130: 2061 6e79 7761 792e 0a20 2020 2022 2222   anyway..    """
+00036140: 0a20 2020 2072 6574 7572 6e20 280a 2020  .    return (.  
+00036150: 2020 2020 2020 6861 7361 7474 7228 6f62        hasattr(ob
+00036160: 6a2c 2022 5f5f 6974 6572 5f5f 2229 0a20  j, "__iter__"). 
+00036170: 2020 2020 2020 2061 6e64 206e 6f74 2069         and not i
+00036180: 7369 6e73 7461 6e63 6528 6f62 6a2c 2073  sinstance(obj, s
+00036190: 7472 290a 2020 2020 2020 2020 616e 6420  tr).        and 
+000361a0: 6e6f 7420 6973 696e 7374 616e 6365 286f  not isinstance(o
+000361b0: 626a 2c20 7475 706c 6529 0a20 2020 2029  bj, tuple).    )
+000361c0: 0a0a 0a63 6c61 7373 204f 7264 6572 6564  ...class Ordered
+000361d0: 5365 7428 4d75 7461 626c 6553 6574 2c20  Set(MutableSet, 
+000361e0: 5365 7175 656e 6365 293a 0a20 2020 2022  Sequence):.    "
+000361f0: 2222 0a20 2020 2041 6e20 4f72 6465 7265  "".    An Ordere
+00036200: 6453 6574 2069 7320 6120 6375 7374 6f6d  dSet is a custom
+00036210: 204d 7574 6162 6c65 5365 7420 7468 6174   MutableSet that
+00036220: 2072 656d 656d 6265 7273 2069 7473 206f   remembers its o
+00036230: 7264 6572 2c20 736f 2074 6861 740a 2020  rder, so that.  
+00036240: 2020 6576 6572 7920 656e 7472 7920 6861    every entry ha
+00036250: 7320 616e 2069 6e64 6578 2074 6861 7420  s an index that 
+00036260: 6361 6e20 6265 206c 6f6f 6b65 6420 7570  can be looked up
+00036270: 2e0a 0a20 2020 2045 7861 6d70 6c65 3a0a  ...    Example:.
+00036280: 2020 2020 2020 2020 3e3e 3e20 4f72 6465          >>> Orde
+00036290: 7265 6453 6574 285b 312c 2031 2c20 322c  redSet([1, 1, 2,
+000362a0: 2033 2c20 325d 290a 2020 2020 2020 2020   3, 2]).        
+000362b0: 4f72 6465 7265 6453 6574 285b 312c 2032  OrderedSet([1, 2
+000362c0: 2c20 335d 290a 2020 2020 2222 220a 0a20  , 3]).    """.. 
+000362d0: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
+000362e0: 7365 6c66 2c20 6974 6572 6162 6c65 3d4e  self, iterable=N
+000362f0: 6f6e 6529 3a0a 2020 2020 2020 2020 7365  one):.        se
+00036300: 6c66 2e69 7465 6d73 203d 205b 5d0a 2020  lf.items = [].  
+00036310: 2020 2020 2020 7365 6c66 2e6d 6170 203d        self.map =
+00036320: 207b 7d0a 2020 2020 2020 2020 6966 2069   {}.        if i
+00036330: 7465 7261 626c 6520 6973 206e 6f74 204e  terable is not N
+00036340: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00036350: 2073 656c 6620 7c3d 2069 7465 7261 626c   self |= iterabl
+00036360: 650a 0a20 2020 2064 6566 205f 5f6c 656e  e..    def __len
+00036370: 5f5f 2873 656c 6629 3a0a 2020 2020 2020  __(self):.      
+00036380: 2020 2222 220a 2020 2020 2020 2020 5265    """.        Re
+00036390: 7475 726e 7320 7468 6520 6e75 6d62 6572  turns the number
+000363a0: 206f 6620 756e 6971 7565 2065 6c65 6d65   of unique eleme
+000363b0: 6e74 7320 696e 2074 6865 206f 7264 6572  nts in the order
+000363c0: 6564 2073 6574 0a0a 2020 2020 2020 2020  ed set..        
+000363d0: 4578 616d 706c 653a 0a20 2020 2020 2020  Example:.       
+000363e0: 2020 2020 203e 3e3e 206c 656e 284f 7264       >>> len(Ord
+000363f0: 6572 6564 5365 7428 5b5d 2929 0a20 2020  eredSet([])).   
+00036400: 2020 2020 2020 2020 2030 0a20 2020 2020           0.     
+00036410: 2020 2020 2020 203e 3e3e 206c 656e 284f         >>> len(O
+00036420: 7264 6572 6564 5365 7428 5b31 2c20 325d  rderedSet([1, 2]
+00036430: 2929 0a20 2020 2020 2020 2020 2020 2032  )).            2
+00036440: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00036450: 2020 2020 2072 6574 7572 6e20 6c65 6e28       return len(
+00036460: 7365 6c66 2e69 7465 6d73 290a 0a20 2020  self.items)..   
+00036470: 2064 6566 205f 5f67 6574 6974 656d 5f5f   def __getitem__
+00036480: 2873 656c 662c 2069 6e64 6578 293a 0a20  (self, index):. 
+00036490: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+000364a0: 2020 2047 6574 2074 6865 2069 7465 6d20     Get the item 
+000364b0: 6174 2061 2067 6976 656e 2069 6e64 6578  at a given index
+000364c0: 2e0a 0a20 2020 2020 2020 2049 6620 6069  ...        If `i
+000364d0: 6e64 6578 6020 6973 2061 2073 6c69 6365  ndex` is a slice
+000364e0: 2c20 796f 7520 7769 6c6c 2067 6574 2062  , you will get b
+000364f0: 6163 6b20 7468 6174 2073 6c69 6365 206f  ack that slice o
+00036500: 6620 6974 656d 732c 2061 7320 610a 2020  f items, as a.  
+00036510: 2020 2020 2020 6e65 7720 4f72 6465 7265        new Ordere
+00036520: 6453 6574 2e0a 0a20 2020 2020 2020 2049  dSet...        I
+00036530: 6620 6069 6e64 6578 6020 6973 2061 206c  f `index` is a l
+00036540: 6973 7420 6f72 2061 2073 696d 696c 6172  ist or a similar
+00036550: 2069 7465 7261 626c 652c 2079 6f75 276c   iterable, you'l
+00036560: 6c20 6765 7420 6120 6c69 7374 206f 660a  l get a list of.
+00036570: 2020 2020 2020 2020 6974 656d 7320 636f          items co
+00036580: 7272 6573 706f 6e64 696e 6720 746f 2074  rresponding to t
+00036590: 686f 7365 2069 6e64 6963 6573 2e20 5468  hose indices. Th
+000365a0: 6973 2069 7320 7369 6d69 6c61 7220 746f  is is similar to
+000365b0: 204e 756d 5079 2773 0a20 2020 2020 2020   NumPy's.       
+000365c0: 2022 6661 6e63 7920 696e 6465 7869 6e67   "fancy indexing
+000365d0: 222e 2054 6865 2072 6573 756c 7420 6973  ". The result is
+000365e0: 206e 6f74 2061 6e20 4f72 6465 7265 6453   not an OrderedS
+000365f0: 6574 2062 6563 6175 7365 2079 6f75 206d  et because you m
+00036600: 6179 2061 736b 0a20 2020 2020 2020 2066  ay ask.        f
+00036610: 6f72 2064 7570 6c69 6361 7465 2069 6e64  or duplicate ind
+00036620: 6963 6573 2c20 616e 6420 7468 6520 6e75  ices, and the nu
+00036630: 6d62 6572 206f 6620 656c 656d 656e 7473  mber of elements
+00036640: 2072 6574 7572 6e65 6420 7368 6f75 6c64   returned should
+00036650: 2062 650a 2020 2020 2020 2020 7468 6520   be.        the 
+00036660: 6e75 6d62 6572 206f 6620 656c 656d 656e  number of elemen
+00036670: 7473 2061 736b 6564 2066 6f72 2e0a 0a20  ts asked for... 
+00036680: 2020 2020 2020 2045 7861 6d70 6c65 3a0a         Example:.
+00036690: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+000366a0: 6f73 6574 203d 204f 7264 6572 6564 5365  oset = OrderedSe
+000366b0: 7428 5b31 2c20 322c 2033 5d29 0a20 2020  t([1, 2, 3]).   
+000366c0: 2020 2020 2020 2020 203e 3e3e 206f 7365           >>> ose
+000366d0: 745b 315d 0a20 2020 2020 2020 2020 2020  t[1].           
+000366e0: 2032 0a20 2020 2020 2020 2022 2222 0a20   2.        """. 
+000366f0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+00036700: 616e 6365 2869 6e64 6578 2c20 736c 6963  ance(index, slic
+00036710: 6529 2061 6e64 2069 6e64 6578 203d 3d20  e) and index == 
+00036720: 534c 4943 455f 414c 4c3a 0a20 2020 2020  SLICE_ALL:.     
+00036730: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00036740: 6c66 2e63 6f70 7928 290a 2020 2020 2020  lf.copy().      
+00036750: 2020 656c 6966 2069 735f 6974 6572 6162    elif is_iterab
+00036760: 6c65 2869 6e64 6578 293a 0a20 2020 2020  le(index):.     
+00036770: 2020 2020 2020 2072 6574 7572 6e20 5b73         return [s
+00036780: 656c 662e 6974 656d 735b 695d 2066 6f72  elf.items[i] for
+00036790: 2069 2069 6e20 696e 6465 785d 0a20 2020   i in index].   
+000367a0: 2020 2020 2065 6c69 6620 6861 7361 7474       elif hasatt
+000367b0: 7228 696e 6465 782c 2022 5f5f 696e 6465  r(index, "__inde
+000367c0: 785f 5f22 2920 6f72 2069 7369 6e73 7461  x__") or isinsta
+000367d0: 6e63 6528 696e 6465 782c 2073 6c69 6365  nce(index, slice
+000367e0: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+000367f0: 6573 756c 7420 3d20 7365 6c66 2e69 7465  esult = self.ite
+00036800: 6d73 5b69 6e64 6578 5d0a 2020 2020 2020  ms[index].      
+00036810: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+00036820: 6e63 6528 7265 7375 6c74 2c20 6c69 7374  nce(result, list
+00036830: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00036840: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+00036850: 5f63 6c61 7373 5f5f 2872 6573 756c 7429  _class__(result)
+00036860: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+00036870: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00036880: 2020 2072 6574 7572 6e20 7265 7375 6c74     return result
+00036890: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+000368a0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+000368b0: 2054 7970 6545 7272 6f72 2822 446f 6e27   TypeError("Don'
+000368c0: 7420 6b6e 6f77 2068 6f77 2074 6f20 696e  t know how to in
+000368d0: 6465 7820 616e 204f 7264 6572 6564 5365  dex an OrderedSe
+000368e0: 7420 6279 2025 7222 2025 2069 6e64 6578  t by %r" % index
+000368f0: 290a 0a20 2020 2064 6566 2063 6f70 7928  )..    def copy(
+00036900: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+00036910: 2222 0a20 2020 2020 2020 2052 6574 7572  "".        Retur
+00036920: 6e20 6120 7368 616c 6c6f 7720 636f 7079  n a shallow copy
+00036930: 206f 6620 7468 6973 206f 626a 6563 742e   of this object.
+00036940: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
+00036950: 653a 0a20 2020 2020 2020 2020 2020 203e  e:.            >
+00036960: 3e3e 2074 6869 7320 3d20 4f72 6465 7265  >> this = Ordere
+00036970: 6453 6574 285b 312c 2032 2c20 335d 290a  dSet([1, 2, 3]).
+00036980: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+00036990: 6f74 6865 7220 3d20 7468 6973 2e63 6f70  other = this.cop
+000369a0: 7928 290a 2020 2020 2020 2020 2020 2020  y().            
+000369b0: 3e3e 3e20 7468 6973 203d 3d20 6f74 6865  >>> this == othe
+000369c0: 720a 2020 2020 2020 2020 2020 2020 5472  r.            Tr
+000369d0: 7565 0a20 2020 2020 2020 2020 2020 203e  ue.            >
+000369e0: 3e3e 2074 6869 7320 6973 206f 7468 6572  >> this is other
+000369f0: 0a20 2020 2020 2020 2020 2020 2046 616c  .            Fal
+00036a00: 7365 0a20 2020 2020 2020 2022 2222 0a20  se.        """. 
+00036a10: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00036a20: 6c66 2e5f 5f63 6c61 7373 5f5f 2873 656c  lf.__class__(sel
+00036a30: 6629 0a0a 2020 2020 6465 6620 5f5f 6765  f)..    def __ge
+00036a40: 7473 7461 7465 5f5f 2873 656c 6629 3a0a  tstate__(self):.
+00036a50: 2020 2020 2020 2020 6966 206c 656e 2873          if len(s
+00036a60: 656c 6629 203d 3d20 303a 0a20 2020 2020  elf) == 0:.     
+00036a70: 2020 2020 2020 2023 2054 6865 2073 7461         # The sta
+00036a80: 7465 2063 616e 2774 2062 6520 616e 2065  te can't be an e
+00036a90: 6d70 7479 206c 6973 742e 0a20 2020 2020  mpty list..     
+00036aa0: 2020 2020 2020 2023 2057 6520 6e65 6564         # We need
+00036ab0: 2074 6f20 7265 7475 726e 2061 2074 7275   to return a tru
+00036ac0: 7468 7920 7661 6c75 652c 206f 7220 656c  thy value, or el
+00036ad0: 7365 205f 5f73 6574 7374 6174 655f 5f20  se __setstate__ 
+00036ae0: 776f 6e27 7420 6265 2072 756e 2e0a 2020  won't be run..  
+00036af0: 2020 2020 2020 2020 2020 230a 2020 2020            #.    
+00036b00: 2020 2020 2020 2020 2320 5468 6973 2063          # This c
+00036b10: 6f75 6c64 2068 6176 6520 6265 656e 2064  ould have been d
+00036b20: 6f6e 6520 6d6f 7265 2067 7261 6365 6675  one more gracefu
+00036b30: 6c6c 7920 6279 2061 6c77 6179 7320 7075  lly by always pu
+00036b40: 7474 696e 6720 7468 6520 7374 6174 650a  tting the state.
+00036b50: 2020 2020 2020 2020 2020 2020 2320 696e              # in
+00036b60: 2061 2074 7570 6c65 2c20 6275 7420 7468   a tuple, but th
+00036b70: 6973 2077 6179 2069 7320 6261 636b 7761  is way is backwa
+00036b80: 7264 732d 2061 6e64 2066 6f72 7761 7264  rds- and forward
+00036b90: 732d 2063 6f6d 7061 7469 626c 6520 7769  s- compatible wi
+00036ba0: 7468 0a20 2020 2020 2020 2020 2020 2023  th.            #
+00036bb0: 2070 7265 7669 6f75 7320 7665 7273 696f   previous versio
+00036bc0: 6e73 206f 6620 4f72 6465 7265 6453 6574  ns of OrderedSet
+00036bd0: 2e0a 2020 2020 2020 2020 2020 2020 7265  ..            re
+00036be0: 7475 726e 2028 4e6f 6e65 2c29 0a20 2020  turn (None,).   
+00036bf0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00036c00: 2020 2020 2020 2072 6574 7572 6e20 6c69         return li
+00036c10: 7374 2873 656c 6629 0a0a 2020 2020 6465  st(self)..    de
+00036c20: 6620 5f5f 7365 7473 7461 7465 5f5f 2873  f __setstate__(s
+00036c30: 656c 662c 2073 7461 7465 293a 0a20 2020  elf, state):.   
+00036c40: 2020 2020 2069 6620 7374 6174 6520 3d3d       if state ==
+00036c50: 2028 4e6f 6e65 2c29 3a0a 2020 2020 2020   (None,):.      
+00036c60: 2020 2020 2020 7365 6c66 2e5f 5f69 6e69        self.__ini
+00036c70: 745f 5f28 5b5d 290a 2020 2020 2020 2020  t__([]).        
+00036c80: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00036c90: 2020 7365 6c66 2e5f 5f69 6e69 745f 5f28    self.__init__(
+00036ca0: 7374 6174 6529 0a0a 2020 2020 6465 6620  state)..    def 
+00036cb0: 5f5f 636f 6e74 6169 6e73 5f5f 2873 656c  __contains__(sel
+00036cc0: 662c 206b 6579 293a 0a20 2020 2020 2020  f, key):.       
+00036cd0: 2022 2222 0a20 2020 2020 2020 2054 6573   """.        Tes
+00036ce0: 7420 6966 2074 6865 2069 7465 6d20 6973  t if the item is
+00036cf0: 2069 6e20 7468 6973 206f 7264 6572 6564   in this ordered
+00036d00: 2073 6574 0a0a 2020 2020 2020 2020 4578   set..        Ex
+00036d10: 616d 706c 653a 0a20 2020 2020 2020 2020  ample:.         
+00036d20: 2020 203e 3e3e 2031 2069 6e20 4f72 6465     >>> 1 in Orde
+00036d30: 7265 6453 6574 285b 312c 2033 2c20 325d  redSet([1, 3, 2]
+00036d40: 290a 2020 2020 2020 2020 2020 2020 5472  ).            Tr
+00036d50: 7565 0a20 2020 2020 2020 2020 2020 203e  ue.            >
+00036d60: 3e3e 2035 2069 6e20 4f72 6465 7265 6453  >> 5 in OrderedS
+00036d70: 6574 285b 312c 2033 2c20 325d 290a 2020  et([1, 3, 2]).  
+00036d80: 2020 2020 2020 2020 2020 4661 6c73 650a            False.
+00036d90: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00036da0: 2020 2020 7265 7475 726e 206b 6579 2069      return key i
+00036db0: 6e20 7365 6c66 2e6d 6170 0a0a 2020 2020  n self.map..    
+00036dc0: 6465 6620 6164 6428 7365 6c66 2c20 6b65  def add(self, ke
+00036dd0: 7929 3a0a 2020 2020 2020 2020 2222 220a  y):.        """.
+00036de0: 2020 2020 2020 2020 4164 6420 606b 6579          Add `key
+00036df0: 6020 6173 2061 6e20 6974 656d 2074 6f20  ` as an item to 
+00036e00: 7468 6973 204f 7264 6572 6564 5365 742c  this OrderedSet,
+00036e10: 2074 6865 6e20 7265 7475 726e 2069 7473   then return its
+00036e20: 2069 6e64 6578 2e0a 0a20 2020 2020 2020   index...       
+00036e30: 2049 6620 606b 6579 6020 6973 2061 6c72   If `key` is alr
+00036e40: 6561 6479 2069 6e20 7468 6520 4f72 6465  eady in the Orde
+00036e50: 7265 6453 6574 2c20 7265 7475 726e 2074  redSet, return t
+00036e60: 6865 2069 6e64 6578 2069 7420 616c 7265  he index it alre
+00036e70: 6164 790a 2020 2020 2020 2020 6861 642e  ady.        had.
+00036e80: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
+00036e90: 653a 0a20 2020 2020 2020 2020 2020 203e  e:.            >
+00036ea0: 3e3e 206f 7365 7420 3d20 4f72 6465 7265  >> oset = Ordere
+00036eb0: 6453 6574 2829 0a20 2020 2020 2020 2020  dSet().         
+00036ec0: 2020 203e 3e3e 206f 7365 742e 6170 7065     >>> oset.appe
+00036ed0: 6e64 2833 290a 2020 2020 2020 2020 2020  nd(3).          
+00036ee0: 2020 300a 2020 2020 2020 2020 2020 2020    0.            
+00036ef0: 3e3e 3e20 7072 696e 7428 6f73 6574 290a  >>> print(oset).
+00036f00: 2020 2020 2020 2020 2020 2020 4f72 6465              Orde
+00036f10: 7265 6453 6574 285b 335d 290a 2020 2020  redSet([3]).    
+00036f20: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00036f30: 6966 206b 6579 206e 6f74 2069 6e20 7365  if key not in se
+00036f40: 6c66 2e6d 6170 3a0a 2020 2020 2020 2020  lf.map:.        
+00036f50: 2020 2020 7365 6c66 2e6d 6170 5b6b 6579      self.map[key
+00036f60: 5d20 3d20 6c65 6e28 7365 6c66 2e69 7465  ] = len(self.ite
+00036f70: 6d73 290a 2020 2020 2020 2020 2020 2020  ms).            
+00036f80: 7365 6c66 2e69 7465 6d73 2e61 7070 656e  self.items.appen
+00036f90: 6428 6b65 7929 0a20 2020 2020 2020 2072  d(key).        r
+00036fa0: 6574 7572 6e20 7365 6c66 2e6d 6170 5b6b  eturn self.map[k
+00036fb0: 6579 5d0a 0a20 2020 2061 7070 656e 6420  ey]..    append 
+00036fc0: 3d20 6164 640a 0a20 2020 2064 6566 2075  = add..    def u
+00036fd0: 7064 6174 6528 7365 6c66 2c20 7365 7175  pdate(self, sequ
+00036fe0: 656e 6365 293a 0a20 2020 2020 2020 2022  ence):.        "
+00036ff0: 2222 0a20 2020 2020 2020 2055 7064 6174  "".        Updat
+00037000: 6520 7468 6520 7365 7420 7769 7468 2074  e the set with t
+00037010: 6865 2067 6976 656e 2069 7465 7261 626c  he given iterabl
+00037020: 6520 7365 7175 656e 6365 2c20 7468 656e  e sequence, then
+00037030: 2072 6574 7572 6e20 7468 6520 696e 6465   return the inde
+00037040: 780a 2020 2020 2020 2020 6f66 2074 6865  x.        of the
+00037050: 206c 6173 7420 656c 656d 656e 7420 696e   last element in
+00037060: 7365 7274 6564 2e0a 0a20 2020 2020 2020  serted...       
+00037070: 2045 7861 6d70 6c65 3a0a 2020 2020 2020   Example:.      
+00037080: 2020 2020 2020 3e3e 3e20 6f73 6574 203d        >>> oset =
+00037090: 204f 7264 6572 6564 5365 7428 5b31 2c20   OrderedSet([1, 
+000370a0: 322c 2033 5d29 0a20 2020 2020 2020 2020  2, 3]).         
+000370b0: 2020 203e 3e3e 206f 7365 742e 7570 6461     >>> oset.upda
+000370c0: 7465 285b 332c 2031 2c20 352c 2031 2c20  te([3, 1, 5, 1, 
+000370d0: 345d 290a 2020 2020 2020 2020 2020 2020  4]).            
+000370e0: 340a 2020 2020 2020 2020 2020 2020 3e3e  4.            >>
+000370f0: 3e20 7072 696e 7428 6f73 6574 290a 2020  > print(oset).  
+00037100: 2020 2020 2020 2020 2020 4f72 6465 7265            Ordere
+00037110: 6453 6574 285b 312c 2032 2c20 332c 2035  dSet([1, 2, 3, 5
+00037120: 2c20 345d 290a 2020 2020 2020 2020 2222  , 4]).        ""
+00037130: 220a 2020 2020 2020 2020 6974 656d 5f69  ".        item_i
+00037140: 6e64 6578 203d 204e 6f6e 650a 2020 2020  ndex = None.    
+00037150: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+00037160: 2020 2020 2066 6f72 2069 7465 6d20 696e       for item in
+00037170: 2073 6571 7565 6e63 653a 0a20 2020 2020   sequence:.     
+00037180: 2020 2020 2020 2020 2020 2069 7465 6d5f             item_
+00037190: 696e 6465 7820 3d20 7365 6c66 2e61 6464  index = self.add
+000371a0: 2869 7465 6d29 0a20 2020 2020 2020 2065  (item).        e
+000371b0: 7863 6570 7420 5479 7065 4572 726f 723a  xcept TypeError:
+000371c0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+000371d0: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
+000371e0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000371f0: 4172 6775 6d65 6e74 206e 6565 6473 2074  Argument needs t
+00037200: 6f20 6265 2061 6e20 6974 6572 6162 6c65  o be an iterable
+00037210: 2c20 676f 7420 2573 2220 2520 7479 7065  , got %s" % type
+00037220: 2873 6571 7565 6e63 6529 0a20 2020 2020  (sequence).     
+00037230: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00037240: 2072 6574 7572 6e20 6974 656d 5f69 6e64   return item_ind
+00037250: 6578 0a0a 2020 2020 6465 6620 696e 6465  ex..    def inde
+00037260: 7828 7365 6c66 2c20 6b65 7929 3a0a 2020  x(self, key):.  
+00037270: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00037280: 2020 4765 7420 7468 6520 696e 6465 7820    Get the index 
+00037290: 6f66 2061 2067 6976 656e 2065 6e74 7279  of a given entry
+000372a0: 2c20 7261 6973 696e 6720 616e 2049 6e64  , raising an Ind
+000372b0: 6578 4572 726f 7220 6966 2069 7427 7320  exError if it's 
+000372c0: 6e6f 740a 2020 2020 2020 2020 7072 6573  not.        pres
+000372d0: 656e 742e 0a0a 2020 2020 2020 2020 606b  ent...        `k
+000372e0: 6579 6020 6361 6e20 6265 2061 6e20 6974  ey` can be an it
+000372f0: 6572 6162 6c65 206f 6620 656e 7472 6965  erable of entrie
+00037300: 7320 7468 6174 2069 7320 6e6f 7420 6120  s that is not a 
+00037310: 7374 7269 6e67 2c20 696e 2077 6869 6368  string, in which
+00037320: 2063 6173 650a 2020 2020 2020 2020 7468   case.        th
+00037330: 6973 2072 6574 7572 6e73 2061 206c 6973  is returns a lis
+00037340: 7420 6f66 2069 6e64 6963 6573 2e0a 0a20  t of indices... 
+00037350: 2020 2020 2020 2045 7861 6d70 6c65 3a0a         Example:.
+00037360: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
+00037370: 6f73 6574 203d 204f 7264 6572 6564 5365  oset = OrderedSe
+00037380: 7428 5b31 2c20 322c 2033 5d29 0a20 2020  t([1, 2, 3]).   
+00037390: 2020 2020 2020 2020 203e 3e3e 206f 7365           >>> ose
+000373a0: 742e 696e 6465 7828 3229 0a20 2020 2020  t.index(2).     
+000373b0: 2020 2020 2020 2031 0a20 2020 2020 2020         1.       
+000373c0: 2022 2222 0a20 2020 2020 2020 2069 6620   """.        if 
+000373d0: 6973 5f69 7465 7261 626c 6528 6b65 7929  is_iterable(key)
+000373e0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+000373f0: 7475 726e 205b 7365 6c66 2e69 6e64 6578  turn [self.index
+00037400: 2873 7562 6b65 7929 2066 6f72 2073 7562  (subkey) for sub
+00037410: 6b65 7920 696e 206b 6579 5d0a 2020 2020  key in key].    
+00037420: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00037430: 6d61 705b 6b65 795d 0a0a 2020 2020 2320  map[key]..    # 
+00037440: 5072 6f76 6964 6520 736f 6d65 2063 6f6d  Provide some com
+00037450: 7061 7469 6269 6c69 7479 2077 6974 6820  patibility with 
+00037460: 7064 2e49 6e64 6578 0a20 2020 2067 6574  pd.Index.    get
+00037470: 5f6c 6f63 203d 2069 6e64 6578 0a20 2020  _loc = index.   
+00037480: 2067 6574 5f69 6e64 6578 6572 203d 2069   get_indexer = i
+00037490: 6e64 6578 0a0a 2020 2020 6465 6620 706f  ndex..    def po
+000374a0: 7028 7365 6c66 293a 0a20 2020 2020 2020  p(self):.       
+000374b0: 2022 2222 0a20 2020 2020 2020 2052 656d   """.        Rem
+000374c0: 6f76 6520 616e 6420 7265 7475 726e 2074  ove and return t
+000374d0: 6865 206c 6173 7420 656c 656d 656e 7420  he last element 
+000374e0: 6672 6f6d 2074 6865 2073 6574 2e0a 0a20  from the set... 
+000374f0: 2020 2020 2020 2052 6169 7365 7320 4b65         Raises Ke
+00037500: 7945 7272 6f72 2069 6620 7468 6520 7365  yError if the se
+00037510: 7420 6973 2065 6d70 7479 2e0a 0a20 2020  t is empty...   
+00037520: 2020 2020 2045 7861 6d70 6c65 3a0a 2020       Example:.  
+00037530: 2020 2020 2020 2020 2020 3e3e 3e20 6f73            >>> os
+00037540: 6574 203d 204f 7264 6572 6564 5365 7428  et = OrderedSet(
+00037550: 5b31 2c20 322c 2033 5d29 0a20 2020 2020  [1, 2, 3]).     
+00037560: 2020 2020 2020 203e 3e3e 206f 7365 742e         >>> oset.
+00037570: 706f 7028 290a 2020 2020 2020 2020 2020  pop().          
+00037580: 2020 330a 2020 2020 2020 2020 2222 220a    3.        """.
+00037590: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
+000375a0: 656c 662e 6974 656d 733a 0a20 2020 2020  elf.items:.     
+000375b0: 2020 2020 2020 2072 6169 7365 204b 6579         raise Key
+000375c0: 4572 726f 7228 2253 6574 2069 7320 656d  Error("Set is em
+000375d0: 7074 7922 290a 0a20 2020 2020 2020 2065  pty")..        e
+000375e0: 6c65 6d20 3d20 7365 6c66 2e69 7465 6d73  lem = self.items
+000375f0: 5b2d 315d 0a20 2020 2020 2020 2064 656c  [-1].        del
+00037600: 2073 656c 662e 6974 656d 735b 2d31 5d0a   self.items[-1].
+00037610: 2020 2020 2020 2020 6465 6c20 7365 6c66          del self
+00037620: 2e6d 6170 5b65 6c65 6d5d 0a20 2020 2020  .map[elem].     
+00037630: 2020 2072 6574 7572 6e20 656c 656d 0a0a     return elem..
+00037640: 2020 2020 6465 6620 6469 7363 6172 6428      def discard(
+00037650: 7365 6c66 2c20 6b65 7929 3a0a 2020 2020  self, key):.    
+00037660: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00037670: 5265 6d6f 7665 2061 6e20 656c 656d 656e  Remove an elemen
+00037680: 742e 2020 446f 206e 6f74 2072 6169 7365  t.  Do not raise
+00037690: 2061 6e20 6578 6365 7074 696f 6e20 6966   an exception if
+000376a0: 2061 6273 656e 742e 0a0a 2020 2020 2020   absent...      
+000376b0: 2020 5468 6520 4d75 7461 626c 6553 6574    The MutableSet
+000376c0: 206d 6978 696e 2075 7365 7320 7468 6973   mixin uses this
+000376d0: 2074 6f20 696d 706c 656d 656e 7420 7468   to implement th
+000376e0: 6520 2e72 656d 6f76 6528 2920 6d65 7468  e .remove() meth
+000376f0: 6f64 2c20 7768 6963 680a 2020 2020 2020  od, which.      
+00037700: 2020 2a64 6f65 732a 2072 6169 7365 2061    *does* raise a
+00037710: 6e20 6572 726f 7220 7768 656e 2061 736b  n error when ask
+00037720: 6564 2074 6f20 7265 6d6f 7665 2061 206e  ed to remove a n
+00037730: 6f6e 2d65 7869 7374 656e 7420 6974 656d  on-existent item
+00037740: 2e0a 0a20 2020 2020 2020 2045 7861 6d70  ...        Examp
+00037750: 6c65 3a0a 2020 2020 2020 2020 2020 2020  le:.            
+00037760: 3e3e 3e20 6f73 6574 203d 204f 7264 6572  >>> oset = Order
+00037770: 6564 5365 7428 5b31 2c20 322c 2033 5d29  edSet([1, 2, 3])
+00037780: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
+00037790: 206f 7365 742e 6469 7363 6172 6428 3229   oset.discard(2)
+000377a0: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
+000377b0: 2070 7269 6e74 286f 7365 7429 0a20 2020   print(oset).   
+000377c0: 2020 2020 2020 2020 204f 7264 6572 6564           Ordered
+000377d0: 5365 7428 5b31 2c20 335d 290a 2020 2020  Set([1, 3]).    
+000377e0: 2020 2020 2020 2020 3e3e 3e20 6f73 6574          >>> oset
+000377f0: 2e64 6973 6361 7264 2832 290a 2020 2020  .discard(2).    
+00037800: 2020 2020 2020 2020 3e3e 3e20 7072 696e          >>> prin
+00037810: 7428 6f73 6574 290a 2020 2020 2020 2020  t(oset).        
+00037820: 2020 2020 4f72 6465 7265 6453 6574 285b      OrderedSet([
+00037830: 312c 2033 5d29 0a20 2020 2020 2020 2022  1, 3]).        "
+00037840: 2222 0a20 2020 2020 2020 2069 6620 6b65  "".        if ke
+00037850: 7920 696e 2073 656c 663a 0a20 2020 2020  y in self:.     
+00037860: 2020 2020 2020 2069 203d 2073 656c 662e         i = self.
+00037870: 6d61 705b 6b65 795d 0a20 2020 2020 2020  map[key].       
+00037880: 2020 2020 2064 656c 2073 656c 662e 6974       del self.it
+00037890: 656d 735b 695d 0a20 2020 2020 2020 2020  ems[i].         
+000378a0: 2020 2064 656c 2073 656c 662e 6d61 705b     del self.map[
+000378b0: 6b65 795d 0a20 2020 2020 2020 2020 2020  key].           
+000378c0: 2066 6f72 206b 2c20 7620 696e 2073 656c   for k, v in sel
+000378d0: 662e 6d61 702e 6974 656d 7328 293a 0a20  f.map.items():. 
+000378e0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000378f0: 6620 7620 3e3d 2069 3a0a 2020 2020 2020  f v >= i:.      
+00037900: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00037910: 6c66 2e6d 6170 5b6b 5d20 3d20 7620 2d20  lf.map[k] = v - 
+00037920: 310a 0a20 2020 2064 6566 2063 6c65 6172  1..    def clear
+00037930: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00037940: 2222 220a 2020 2020 2020 2020 5265 6d6f  """.        Remo
+00037950: 7665 2061 6c6c 2069 7465 6d73 2066 726f  ve all items fro
+00037960: 6d20 7468 6973 204f 7264 6572 6564 5365  m this OrderedSe
+00037970: 742e 0a20 2020 2020 2020 2022 2222 0a20  t..        """. 
+00037980: 2020 2020 2020 2064 656c 2073 656c 662e         del self.
+00037990: 6974 656d 735b 3a5d 0a20 2020 2020 2020  items[:].       
+000379a0: 2073 656c 662e 6d61 702e 636c 6561 7228   self.map.clear(
+000379b0: 290a 0a20 2020 2064 6566 205f 5f69 7465  )..    def __ite
+000379c0: 725f 5f28 7365 6c66 293a 0a20 2020 2020  r__(self):.     
+000379d0: 2020 2022 2222 0a20 2020 2020 2020 2045     """.        E
+000379e0: 7861 6d70 6c65 3a0a 2020 2020 2020 2020  xample:.        
+000379f0: 2020 2020 3e3e 3e20 6c69 7374 2869 7465      >>> list(ite
+00037a00: 7228 4f72 6465 7265 6453 6574 285b 312c  r(OrderedSet([1,
+00037a10: 2032 2c20 335d 2929 290a 2020 2020 2020   2, 3]))).      
+00037a20: 2020 2020 2020 5b31 2c20 322c 2033 5d0a        [1, 2, 3].
+00037a30: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00037a40: 2020 2020 7265 7475 726e 2069 7465 7228      return iter(
+00037a50: 7365 6c66 2e69 7465 6d73 290a 0a20 2020  self.items)..   
+00037a60: 2064 6566 205f 5f72 6576 6572 7365 645f   def __reversed_
+00037a70: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
+00037a80: 2022 2222 0a20 2020 2020 2020 2045 7861   """.        Exa
+00037a90: 6d70 6c65 3a0a 2020 2020 2020 2020 2020  mple:.          
+00037aa0: 2020 3e3e 3e20 6c69 7374 2872 6576 6572    >>> list(rever
+00037ab0: 7365 6428 4f72 6465 7265 6453 6574 285b  sed(OrderedSet([
+00037ac0: 312c 2032 2c20 335d 2929 290a 2020 2020  1, 2, 3]))).    
+00037ad0: 2020 2020 2020 2020 5b33 2c20 322c 2031          [3, 2, 1
+00037ae0: 5d0a 2020 2020 2020 2020 2222 220a 2020  ].        """.  
+00037af0: 2020 2020 2020 7265 7475 726e 2072 6576        return rev
+00037b00: 6572 7365 6428 7365 6c66 2e69 7465 6d73  ersed(self.items
+00037b10: 290a 0a20 2020 2064 6566 205f 5f72 6570  )..    def __rep
+00037b20: 725f 5f28 7365 6c66 293a 0a20 2020 2020  r__(self):.     
+00037b30: 2020 2069 6620 6e6f 7420 7365 6c66 3a0a     if not self:.
+00037b40: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00037b50: 726e 2022 2573 2829 2220 2520 2873 656c  rn "%s()" % (sel
+00037b60: 662e 5f5f 636c 6173 735f 5f2e 5f5f 6e61  f.__class__.__na
+00037b70: 6d65 5f5f 2c29 0a20 2020 2020 2020 2072  me__,).        r
+00037b80: 6574 7572 6e20 2225 7328 2572 2922 2025  eturn "%s(%r)" %
+00037b90: 2028 7365 6c66 2e5f 5f63 6c61 7373 5f5f   (self.__class__
+00037ba0: 2e5f 5f6e 616d 655f 5f2c 206c 6973 7428  .__name__, list(
+00037bb0: 7365 6c66 2929 0a0a 2020 2020 6465 6620  self))..    def 
+00037bc0: 5f5f 6571 5f5f 2873 656c 662c 206f 7468  __eq__(self, oth
+00037bd0: 6572 293a 0a20 2020 2020 2020 2022 2222  er):.        """
+00037be0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+00037bf0: 2074 7275 6520 6966 2074 6865 2063 6f6e   true if the con
+00037c00: 7461 696e 6572 7320 6861 7665 2074 6865  tainers have the
+00037c10: 2073 616d 6520 6974 656d 732e 2049 6620   same items. If 
+00037c20: 606f 7468 6572 6020 6973 2061 0a20 2020  `other` is a.   
+00037c30: 2020 2020 2053 6571 7565 6e63 652c 2074       Sequence, t
+00037c40: 6865 6e20 6f72 6465 7220 6973 2063 6865  hen order is che
+00037c50: 636b 6564 2c20 6f74 6865 7277 6973 6520  cked, otherwise 
+00037c60: 6974 2069 7320 6967 6e6f 7265 642e 0a0a  it is ignored...
+00037c70: 2020 2020 2020 2020 4578 616d 706c 653a          Example:
+00037c80: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
+00037c90: 206f 7365 7420 3d20 4f72 6465 7265 6453   oset = OrderedS
+00037ca0: 6574 285b 312c 2033 2c20 325d 290a 2020  et([1, 3, 2]).  
+00037cb0: 2020 2020 2020 2020 2020 3e3e 3e20 6f73            >>> os
+00037cc0: 6574 203d 3d20 5b31 2c20 332c 2032 5d0a  et == [1, 3, 2].
+00037cd0: 2020 2020 2020 2020 2020 2020 5472 7565              True
+00037ce0: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
+00037cf0: 206f 7365 7420 3d3d 205b 312c 2032 2c20   oset == [1, 2, 
+00037d00: 335d 0a20 2020 2020 2020 2020 2020 2046  3].            F
+00037d10: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
+00037d20: 203e 3e3e 206f 7365 7420 3d3d 205b 322c   >>> oset == [2,
+00037d30: 2033 5d0a 2020 2020 2020 2020 2020 2020   3].            
+00037d40: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
+00037d50: 2020 3e3e 3e20 6f73 6574 203d 3d20 4f72    >>> oset == Or
+00037d60: 6465 7265 6453 6574 285b 332c 2032 2c20  deredSet([3, 2, 
+00037d70: 315d 290a 2020 2020 2020 2020 2020 2020  1]).            
+00037d80: 4661 6c73 650a 2020 2020 2020 2020 2222  False.        ""
+00037d90: 220a 2020 2020 2020 2020 2320 496e 2050  ".        # In P
+00037da0: 7974 686f 6e20 3220 6465 7175 6520 6973  ython 2 deque is
+00037db0: 206e 6f74 2061 2053 6571 7565 6e63 652c   not a Sequence,
+00037dc0: 2073 6f20 7472 6561 7420 6974 2061 7320   so treat it as 
+00037dd0: 6f6e 6520 666f 720a 2020 2020 2020 2020  one for.        
+00037de0: 2320 636f 6e73 6973 7465 6e74 2062 6568  # consistent beh
+00037df0: 6176 696f 7220 7769 7468 2050 7974 686f  avior with Pytho
+00037e00: 6e20 332e 0a20 2020 2020 2020 2069 6620  n 3..        if 
+00037e10: 6973 696e 7374 616e 6365 286f 7468 6572  isinstance(other
+00037e20: 2c20 2853 6571 7565 6e63 652c 2064 6571  , (Sequence, deq
+00037e30: 7565 2929 3a0a 2020 2020 2020 2020 2020  ue)):.          
+00037e40: 2020 2320 4368 6563 6b20 7468 6174 2074    # Check that t
+00037e50: 6869 7320 4f72 6465 7265 6453 6574 2063  his OrderedSet c
+00037e60: 6f6e 7461 696e 7320 7468 6520 7361 6d65  ontains the same
+00037e70: 2065 6c65 6d65 6e74 732c 2069 6e20 7468   elements, in th
+00037e80: 650a 2020 2020 2020 2020 2020 2020 2320  e.            # 
+00037e90: 7361 6d65 206f 7264 6572 2c20 6173 2074  same order, as t
+00037ea0: 6865 206f 7468 6572 206f 626a 6563 742e  he other object.
+00037eb0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00037ec0: 7572 6e20 6c69 7374 2873 656c 6629 203d  urn list(self) =
+00037ed0: 3d20 6c69 7374 286f 7468 6572 290a 2020  = list(other).  
+00037ee0: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
+00037ef0: 2020 2020 2020 206f 7468 6572 5f61 735f         other_as_
+00037f00: 7365 7420 3d20 7365 7428 6f74 6865 7229  set = set(other)
+00037f10: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
+00037f20: 5479 7065 4572 726f 723a 0a20 2020 2020  TypeError:.     
+00037f30: 2020 2020 2020 2023 2049 6620 606f 7468         # If `oth
+00037f40: 6572 6020 6361 6e27 7420 6265 2063 6f6e  er` can't be con
+00037f50: 7665 7274 6564 2069 6e74 6f20 6120 7365  verted into a se
+00037f60: 742c 2069 7427 7320 6e6f 7420 6571 7561  t, it's not equa
+00037f70: 6c2e 0a20 2020 2020 2020 2020 2020 2072  l..            r
+00037f80: 6574 7572 6e20 4661 6c73 650a 2020 2020  eturn False.    
+00037f90: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00037fa0: 2020 2020 2020 7265 7475 726e 2073 6574        return set
+00037fb0: 2873 656c 6629 203d 3d20 6f74 6865 725f  (self) == other_
+00037fc0: 6173 5f73 6574 0a0a 2020 2020 6465 6620  as_set..    def 
+00037fd0: 756e 696f 6e28 7365 6c66 2c20 2a73 6574  union(self, *set
+00037fe0: 7329 3a0a 2020 2020 2020 2020 2222 220a  s):.        """.
+00037ff0: 2020 2020 2020 2020 436f 6d62 696e 6573          Combines
+00038000: 2061 6c6c 2075 6e69 7175 6520 6974 656d   all unique item
+00038010: 732e 0a20 2020 2020 2020 2045 6163 6820  s..        Each 
+00038020: 6974 656d 7320 6f72 6465 7220 6973 2064  items order is d
+00038030: 6566 696e 6564 2062 7920 6974 7320 6669  efined by its fi
+00038040: 7273 7420 6170 7065 6172 616e 6365 2e0a  rst appearance..
+00038050: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
+00038060: 3a0a 2020 2020 2020 2020 2020 2020 3e3e  :.            >>
+00038070: 3e20 6f73 6574 203d 204f 7264 6572 6564  > oset = Ordered
+00038080: 5365 742e 756e 696f 6e28 4f72 6465 7265  Set.union(Ordere
+00038090: 6453 6574 285b 332c 2031 2c20 342c 2031  dSet([3, 1, 4, 1
+000380a0: 2c20 355d 292c 205b 312c 2033 5d2c 205b  , 5]), [1, 3], [
+000380b0: 322c 2030 5d29 0a20 2020 2020 2020 2020  2, 0]).         
+000380c0: 2020 203e 3e3e 2070 7269 6e74 286f 7365     >>> print(ose
+000380d0: 7429 0a20 2020 2020 2020 2020 2020 204f  t).            O
+000380e0: 7264 6572 6564 5365 7428 5b33 2c20 312c  rderedSet([3, 1,
+000380f0: 2034 2c20 352c 2032 2c20 305d 290a 2020   4, 5, 2, 0]).  
+00038100: 2020 2020 2020 2020 2020 3e3e 3e20 6f73            >>> os
+00038110: 6574 2e75 6e69 6f6e 285b 382c 2039 5d29  et.union([8, 9])
+00038120: 0a20 2020 2020 2020 2020 2020 204f 7264  .            Ord
+00038130: 6572 6564 5365 7428 5b33 2c20 312c 2034  eredSet([3, 1, 4
+00038140: 2c20 352c 2032 2c20 302c 2038 2c20 395d  , 5, 2, 0, 8, 9]
+00038150: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
+00038160: 3e20 6f73 6574 207c 207b 3130 7d0a 2020  > oset | {10}.  
+00038170: 2020 2020 2020 2020 2020 4f72 6465 7265            Ordere
+00038180: 6453 6574 285b 332c 2031 2c20 342c 2035  dSet([3, 1, 4, 5
+00038190: 2c20 322c 2030 2c20 3130 5d29 0a20 2020  , 2, 0, 10]).   
+000381a0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+000381b0: 2063 6c73 203d 2073 656c 662e 5f5f 636c   cls = self.__cl
+000381c0: 6173 735f 5f20 6966 2069 7369 6e73 7461  ass__ if isinsta
+000381d0: 6e63 6528 7365 6c66 2c20 4f72 6465 7265  nce(self, Ordere
+000381e0: 6453 6574 2920 656c 7365 204f 7264 6572  dSet) else Order
+000381f0: 6564 5365 740a 2020 2020 2020 2020 636f  edSet.        co
+00038200: 6e74 6169 6e65 7273 203d 206d 6170 286c  ntainers = map(l
+00038210: 6973 742c 2069 742e 6368 6169 6e28 5b73  ist, it.chain([s
+00038220: 656c 665d 2c20 7365 7473 2929 0a20 2020  elf], sets)).   
+00038230: 2020 2020 2069 7465 6d73 203d 2069 742e       items = it.
+00038240: 6368 6169 6e2e 6672 6f6d 5f69 7465 7261  chain.from_itera
+00038250: 626c 6528 636f 6e74 6169 6e65 7273 290a  ble(containers).
+00038260: 2020 2020 2020 2020 7265 7475 726e 2063          return c
+00038270: 6c73 2869 7465 6d73 290a 0a20 2020 2064  ls(items)..    d
+00038280: 6566 205f 5f61 6e64 5f5f 2873 656c 662c  ef __and__(self,
+00038290: 206f 7468 6572 293a 0a20 2020 2020 2020   other):.       
+000382a0: 2023 2074 6865 2070 6172 656e 7420 696d   # the parent im
+000382b0: 706c 656d 656e 7461 7469 6f6e 206f 6620  plementation of 
+000382c0: 7468 6973 2069 7320 6261 636b 7761 7264  this is backward
+000382d0: 730a 2020 2020 2020 2020 7265 7475 726e  s.        return
+000382e0: 2073 656c 662e 696e 7465 7273 6563 7469   self.intersecti
+000382f0: 6f6e 286f 7468 6572 290a 0a20 2020 2064  on(other)..    d
+00038300: 6566 2069 6e74 6572 7365 6374 696f 6e28  ef intersection(
+00038310: 7365 6c66 2c20 2a73 6574 7329 3a0a 2020  self, *sets):.  
+00038320: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00038330: 2020 5265 7475 726e 7320 656c 656d 656e    Returns elemen
+00038340: 7473 2069 6e20 636f 6d6d 6f6e 2062 6574  ts in common bet
+00038350: 7765 656e 2061 6c6c 2073 6574 732e 204f  ween all sets. O
+00038360: 7264 6572 2069 7320 6465 6669 6e65 6420  rder is defined 
+00038370: 6f6e 6c79 0a20 2020 2020 2020 2062 7920  only.        by 
+00038380: 7468 6520 6669 7273 7420 7365 742e 0a0a  the first set...
+00038390: 2020 2020 2020 2020 4578 616d 706c 653a          Example:
+000383a0: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
+000383b0: 206f 7365 7420 3d20 4f72 6465 7265 6453   oset = OrderedS
+000383c0: 6574 2e69 6e74 6572 7365 6374 696f 6e28  et.intersection(
+000383d0: 4f72 6465 7265 6453 6574 285b 302c 2031  OrderedSet([0, 1
+000383e0: 2c20 322c 2033 5d29 2c20 5b31 2c20 322c  , 2, 3]), [1, 2,
+000383f0: 2033 5d29 0a20 2020 2020 2020 2020 2020   3]).           
+00038400: 203e 3e3e 2070 7269 6e74 286f 7365 7429   >>> print(oset)
+00038410: 0a20 2020 2020 2020 2020 2020 204f 7264  .            Ord
+00038420: 6572 6564 5365 7428 5b31 2c20 322c 2033  eredSet([1, 2, 3
+00038430: 5d29 0a20 2020 2020 2020 2020 2020 203e  ]).            >
+00038440: 3e3e 206f 7365 742e 696e 7465 7273 6563  >> oset.intersec
+00038450: 7469 6f6e 285b 322c 2034 2c20 355d 2c20  tion([2, 4, 5], 
+00038460: 5b31 2c20 322c 2033 2c20 345d 290a 2020  [1, 2, 3, 4]).  
+00038470: 2020 2020 2020 2020 2020 4f72 6465 7265            Ordere
+00038480: 6453 6574 285b 325d 290a 2020 2020 2020  dSet([2]).      
+00038490: 2020 2020 2020 3e3e 3e20 6f73 6574 2e69        >>> oset.i
+000384a0: 6e74 6572 7365 6374 696f 6e28 290a 2020  ntersection().  
+000384b0: 2020 2020 2020 2020 2020 4f72 6465 7265            Ordere
+000384c0: 6453 6574 285b 312c 2032 2c20 335d 290a  dSet([1, 2, 3]).
+000384d0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+000384e0: 2020 2020 636c 7320 3d20 7365 6c66 2e5f      cls = self._
+000384f0: 5f63 6c61 7373 5f5f 2069 6620 6973 696e  _class__ if isin
+00038500: 7374 616e 6365 2873 656c 662c 204f 7264  stance(self, Ord
+00038510: 6572 6564 5365 7429 2065 6c73 6520 4f72  eredSet) else Or
+00038520: 6465 7265 6453 6574 0a20 2020 2020 2020  deredSet.       
+00038530: 2069 6620 7365 7473 3a0a 2020 2020 2020   if sets:.      
+00038540: 2020 2020 2020 636f 6d6d 6f6e 203d 2073        common = s
+00038550: 6574 2e69 6e74 6572 7365 6374 696f 6e28  et.intersection(
+00038560: 2a6d 6170 2873 6574 2c20 7365 7473 2929  *map(set, sets))
+00038570: 0a20 2020 2020 2020 2020 2020 2069 7465  .            ite
+00038580: 6d73 203d 2028 6974 656d 2066 6f72 2069  ms = (item for i
+00038590: 7465 6d20 696e 2073 656c 6620 6966 2069  tem in self if i
+000385a0: 7465 6d20 696e 2063 6f6d 6d6f 6e29 0a20  tem in common). 
+000385b0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+000385c0: 2020 2020 2020 2020 2069 7465 6d73 203d           items =
+000385d0: 2073 656c 660a 2020 2020 2020 2020 7265   self.        re
+000385e0: 7475 726e 2063 6c73 2869 7465 6d73 290a  turn cls(items).
+000385f0: 0a20 2020 2064 6566 2064 6966 6665 7265  .    def differe
+00038600: 6e63 6528 7365 6c66 2c20 2a73 6574 7329  nce(self, *sets)
+00038610: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+00038620: 2020 2020 2020 5265 7475 726e 7320 616c        Returns al
+00038630: 6c20 656c 656d 656e 7473 2074 6861 7420  l elements that 
+00038640: 6172 6520 696e 2074 6869 7320 7365 7420  are in this set 
+00038650: 6275 7420 6e6f 7420 7468 6520 6f74 6865  but not the othe
+00038660: 7273 2e0a 0a20 2020 2020 2020 2045 7861  rs...        Exa
+00038670: 6d70 6c65 3a0a 2020 2020 2020 2020 2020  mple:.          
+00038680: 2020 3e3e 3e20 4f72 6465 7265 6453 6574    >>> OrderedSet
+00038690: 285b 312c 2032 2c20 335d 292e 6469 6666  ([1, 2, 3]).diff
+000386a0: 6572 656e 6365 284f 7264 6572 6564 5365  erence(OrderedSe
+000386b0: 7428 5b32 5d29 290a 2020 2020 2020 2020  t([2])).        
+000386c0: 2020 2020 4f72 6465 7265 6453 6574 285b      OrderedSet([
+000386d0: 312c 2033 5d29 0a20 2020 2020 2020 2020  1, 3]).         
+000386e0: 2020 203e 3e3e 204f 7264 6572 6564 5365     >>> OrderedSe
+000386f0: 7428 5b31 2c20 322c 2033 5d29 2e64 6966  t([1, 2, 3]).dif
+00038700: 6665 7265 6e63 6528 4f72 6465 7265 6453  ference(OrderedS
+00038710: 6574 285b 325d 292c 204f 7264 6572 6564  et([2]), Ordered
+00038720: 5365 7428 5b33 5d29 290a 2020 2020 2020  Set([3])).      
+00038730: 2020 2020 2020 4f72 6465 7265 6453 6574        OrderedSet
+00038740: 285b 315d 290a 2020 2020 2020 2020 2020  ([1]).          
+00038750: 2020 3e3e 3e20 4f72 6465 7265 6453 6574    >>> OrderedSet
+00038760: 285b 312c 2032 2c20 335d 2920 2d20 4f72  ([1, 2, 3]) - Or
+00038770: 6465 7265 6453 6574 285b 325d 290a 2020  deredSet([2]).  
+00038780: 2020 2020 2020 2020 2020 4f72 6465 7265            Ordere
+00038790: 6453 6574 285b 312c 2033 5d29 0a20 2020  dSet([1, 3]).   
+000387a0: 2020 2020 2020 2020 203e 3e3e 204f 7264           >>> Ord
+000387b0: 6572 6564 5365 7428 5b31 2c20 322c 2033  eredSet([1, 2, 3
+000387c0: 5d29 2e64 6966 6665 7265 6e63 6528 290a  ]).difference().
+000387d0: 2020 2020 2020 2020 2020 2020 4f72 6465              Orde
+000387e0: 7265 6453 6574 285b 312c 2032 2c20 335d  redSet([1, 2, 3]
+000387f0: 290a 2020 2020 2020 2020 2222 220a 2020  ).        """.  
+00038800: 2020 2020 2020 636c 7320 3d20 7365 6c66        cls = self
+00038810: 2e5f 5f63 6c61 7373 5f5f 0a20 2020 2020  .__class__.     
+00038820: 2020 2069 6620 7365 7473 3a0a 2020 2020     if sets:.    
+00038830: 2020 2020 2020 2020 6f74 6865 7220 3d20          other = 
+00038840: 7365 742e 756e 696f 6e28 2a6d 6170 2873  set.union(*map(s
+00038850: 6574 2c20 7365 7473 2929 0a20 2020 2020  et, sets)).     
+00038860: 2020 2020 2020 2069 7465 6d73 203d 2028         items = (
+00038870: 6974 656d 2066 6f72 2069 7465 6d20 696e  item for item in
+00038880: 2073 656c 6620 6966 2069 7465 6d20 6e6f   self if item no
+00038890: 7420 696e 206f 7468 6572 290a 2020 2020  t in other).    
+000388a0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+000388b0: 2020 2020 2020 6974 656d 7320 3d20 7365        items = se
+000388c0: 6c66 0a20 2020 2020 2020 2072 6574 7572  lf.        retur
+000388d0: 6e20 636c 7328 6974 656d 7329 0a0a 2020  n cls(items)..  
+000388e0: 2020 6465 6620 6973 7375 6273 6574 2873    def issubset(s
+000388f0: 656c 662c 206f 7468 6572 293a 0a20 2020  elf, other):.   
+00038900: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00038910: 2052 6570 6f72 7420 7768 6574 6865 7220   Report whether 
+00038920: 616e 6f74 6865 7220 7365 7420 636f 6e74  another set cont
+00038930: 6169 6e73 2074 6869 7320 7365 742e 0a0a  ains this set...
+00038940: 2020 2020 2020 2020 4578 616d 706c 653a          Example:
+00038950: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
+00038960: 204f 7264 6572 6564 5365 7428 5b31 2c20   OrderedSet([1, 
+00038970: 322c 2033 5d29 2e69 7373 7562 7365 7428  2, 3]).issubset(
+00038980: 7b31 2c20 327d 290a 2020 2020 2020 2020  {1, 2}).        
+00038990: 2020 2020 4661 6c73 650a 2020 2020 2020      False.      
+000389a0: 2020 2020 2020 3e3e 3e20 4f72 6465 7265        >>> Ordere
+000389b0: 6453 6574 285b 312c 2032 2c20 335d 292e  dSet([1, 2, 3]).
+000389c0: 6973 7375 6273 6574 287b 312c 2032 2c20  issubset({1, 2, 
+000389d0: 332c 2034 7d29 0a20 2020 2020 2020 2020  3, 4}).         
+000389e0: 2020 2054 7275 650a 2020 2020 2020 2020     True.        
+000389f0: 2020 2020 3e3e 3e20 4f72 6465 7265 6453      >>> OrderedS
+00038a00: 6574 285b 312c 2032 2c20 335d 292e 6973  et([1, 2, 3]).is
+00038a10: 7375 6273 6574 287b 312c 2034 2c20 332c  subset({1, 4, 3,
+00038a20: 2035 7d29 0a20 2020 2020 2020 2020 2020   5}).           
+00038a30: 2046 616c 7365 0a20 2020 2020 2020 2022   False.        "
+00038a40: 2222 0a20 2020 2020 2020 2069 6620 6c65  "".        if le
+00038a50: 6e28 7365 6c66 2920 3e20 6c65 6e28 6f74  n(self) > len(ot
+00038a60: 6865 7229 3a20 2023 2046 6173 7420 6368  her):  # Fast ch
+00038a70: 6563 6b20 666f 7220 6f62 7669 6f75 7320  eck for obvious 
+00038a80: 6361 7365 730a 2020 2020 2020 2020 2020  cases.          
+00038a90: 2020 7265 7475 726e 2046 616c 7365 0a20    return False. 
+00038aa0: 2020 2020 2020 2072 6574 7572 6e20 616c         return al
+00038ab0: 6c28 6974 656d 2069 6e20 6f74 6865 7220  l(item in other 
+00038ac0: 666f 7220 6974 656d 2069 6e20 7365 6c66  for item in self
+00038ad0: 290a 0a20 2020 2064 6566 2069 7373 7570  )..    def issup
+00038ae0: 6572 7365 7428 7365 6c66 2c20 6f74 6865  erset(self, othe
+00038af0: 7229 3a0a 2020 2020 2020 2020 2222 220a  r):.        """.
+00038b00: 2020 2020 2020 2020 5265 706f 7274 2077          Report w
+00038b10: 6865 7468 6572 2074 6869 7320 7365 7420  hether this set 
+00038b20: 636f 6e74 6169 6e73 2061 6e6f 7468 6572  contains another
+00038b30: 2073 6574 2e0a 0a20 2020 2020 2020 2045   set...        E
+00038b40: 7861 6d70 6c65 3a0a 2020 2020 2020 2020  xample:.        
+00038b50: 2020 2020 3e3e 3e20 4f72 6465 7265 6453      >>> OrderedS
+00038b60: 6574 285b 312c 2032 5d29 2e69 7373 7570  et([1, 2]).issup
+00038b70: 6572 7365 7428 5b31 2c20 322c 2033 5d29  erset([1, 2, 3])
+00038b80: 0a20 2020 2020 2020 2020 2020 2046 616c  .            Fal
+00038b90: 7365 0a20 2020 2020 2020 2020 2020 203e  se.            >
+00038ba0: 3e3e 204f 7264 6572 6564 5365 7428 5b31  >> OrderedSet([1
+00038bb0: 2c20 322c 2033 2c20 345d 292e 6973 7375  , 2, 3, 4]).issu
+00038bc0: 7065 7273 6574 287b 312c 2032 2c20 337d  perset({1, 2, 3}
+00038bd0: 290a 2020 2020 2020 2020 2020 2020 5472  ).            Tr
+00038be0: 7565 0a20 2020 2020 2020 2020 2020 203e  ue.            >
+00038bf0: 3e3e 204f 7264 6572 6564 5365 7428 5b31  >> OrderedSet([1
+00038c00: 2c20 342c 2033 2c20 355d 292e 6973 7375  , 4, 3, 5]).issu
+00038c10: 7065 7273 6574 287b 312c 2032 2c20 337d  perset({1, 2, 3}
+00038c20: 290a 2020 2020 2020 2020 2020 2020 4661  ).            Fa
+00038c30: 6c73 650a 2020 2020 2020 2020 2222 220a  lse.        """.
+00038c40: 2020 2020 2020 2020 6966 206c 656e 2873          if len(s
+00038c50: 656c 6629 203c 206c 656e 286f 7468 6572  elf) < len(other
+00038c60: 293a 2020 2320 4661 7374 2063 6865 636b  ):  # Fast check
+00038c70: 2066 6f72 206f 6276 696f 7573 2063 6173   for obvious cas
+00038c80: 6573 0a20 2020 2020 2020 2020 2020 2072  es.            r
+00038c90: 6574 7572 6e20 4661 6c73 650a 2020 2020  eturn False.    
+00038ca0: 2020 2020 7265 7475 726e 2061 6c6c 2869      return all(i
+00038cb0: 7465 6d20 696e 2073 656c 6620 666f 7220  tem in self for 
+00038cc0: 6974 656d 2069 6e20 6f74 6865 7229 0a0a  item in other)..
+00038cd0: 2020 2020 6465 6620 7379 6d6d 6574 7269      def symmetri
+00038ce0: 635f 6469 6666 6572 656e 6365 2873 656c  c_difference(sel
+00038cf0: 662c 206f 7468 6572 293a 0a20 2020 2020  f, other):.     
+00038d00: 2020 2022 2222 0a20 2020 2020 2020 2052     """.        R
+00038d10: 6574 7572 6e20 7468 6520 7379 6d6d 6574  eturn the symmet
+00038d20: 7269 6320 6469 6666 6572 656e 6365 206f  ric difference o
+00038d30: 6620 7477 6f20 4f72 6465 7265 6453 6574  f two OrderedSet
+00038d40: 7320 6173 2061 206e 6577 2073 6574 2e0a  s as a new set..
+00038d50: 2020 2020 2020 2020 5468 6174 2069 732c          That is,
+00038d60: 2074 6865 206e 6577 2073 6574 2077 696c   the new set wil
+00038d70: 6c20 636f 6e74 6169 6e20 616c 6c20 656c  l contain all el
+00038d80: 656d 656e 7473 2074 6861 7420 6172 6520  ements that are 
+00038d90: 696e 2065 7861 6374 6c79 0a20 2020 2020  in exactly.     
+00038da0: 2020 206f 6e65 206f 6620 7468 6520 7365     one of the se
+00038db0: 7473 2e0a 0a20 2020 2020 2020 2054 6865  ts...        The
+00038dc0: 6972 206f 7264 6572 2077 696c 6c20 6265  ir order will be
+00038dd0: 2070 7265 7365 7276 6564 2c20 7769 7468   preserved, with
+00038de0: 2065 6c65 6d65 6e74 7320 6672 6f6d 2060   elements from `
+00038df0: 7365 6c66 6020 7072 6563 6564 696e 670a  self` preceding.
+00038e00: 2020 2020 2020 2020 656c 656d 656e 7473          elements
+00038e10: 2066 726f 6d20 606f 7468 6572 602e 0a0a   from `other`...
+00038e20: 2020 2020 2020 2020 4578 616d 706c 653a          Example:
+00038e30: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
+00038e40: 2074 6869 7320 3d20 4f72 6465 7265 6453   this = OrderedS
+00038e50: 6574 285b 312c 2034 2c20 332c 2035 2c20  et([1, 4, 3, 5, 
+00038e60: 375d 290a 2020 2020 2020 2020 2020 2020  7]).            
+00038e70: 3e3e 3e20 6f74 6865 7220 3d20 4f72 6465  >>> other = Orde
+00038e80: 7265 6453 6574 285b 392c 2037 2c20 312c  redSet([9, 7, 1,
+00038e90: 2033 2c20 325d 290a 2020 2020 2020 2020   3, 2]).        
+00038ea0: 2020 2020 3e3e 3e20 7468 6973 2e73 796d      >>> this.sym
+00038eb0: 6d65 7472 6963 5f64 6966 6665 7265 6e63  metric_differenc
+00038ec0: 6528 6f74 6865 7229 0a20 2020 2020 2020  e(other).       
+00038ed0: 2020 2020 204f 7264 6572 6564 5365 7428       OrderedSet(
+00038ee0: 5b34 2c20 352c 2039 2c20 325d 290a 2020  [4, 5, 9, 2]).  
+00038ef0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00038f00: 2020 636c 7320 3d20 7365 6c66 2e5f 5f63    cls = self.__c
+00038f10: 6c61 7373 5f5f 2069 6620 6973 696e 7374  lass__ if isinst
+00038f20: 616e 6365 2873 656c 662c 204f 7264 6572  ance(self, Order
+00038f30: 6564 5365 7429 2065 6c73 6520 4f72 6465  edSet) else Orde
+00038f40: 7265 6453 6574 0a20 2020 2020 2020 2064  redSet.        d
+00038f50: 6966 6631 203d 2063 6c73 2873 656c 6629  iff1 = cls(self)
+00038f60: 2e64 6966 6665 7265 6e63 6528 6f74 6865  .difference(othe
+00038f70: 7229 0a20 2020 2020 2020 2064 6966 6632  r).        diff2
+00038f80: 203d 2063 6c73 286f 7468 6572 292e 6469   = cls(other).di
+00038f90: 6666 6572 656e 6365 2873 656c 6629 0a20  fference(self). 
+00038fa0: 2020 2020 2020 2072 6574 7572 6e20 6469         return di
+00038fb0: 6666 312e 756e 696f 6e28 6469 6666 3229  ff1.union(diff2)
+00038fc0: 0a0a 2020 2020 6465 6620 5f75 7064 6174  ..    def _updat
+00038fd0: 655f 6974 656d 7328 7365 6c66 2c20 6974  e_items(self, it
+00038fe0: 656d 7329 3a0a 2020 2020 2020 2020 2222  ems):.        ""
+00038ff0: 220a 2020 2020 2020 2020 5265 706c 6163  ".        Replac
+00039000: 6520 7468 6520 2769 7465 6d73 2720 6c69  e the 'items' li
+00039010: 7374 206f 6620 7468 6973 204f 7264 6572  st of this Order
+00039020: 6564 5365 7420 7769 7468 2061 206e 6577  edSet with a new
+00039030: 206f 6e65 2c20 7570 6461 7469 6e67 0a20   one, updating. 
+00039040: 2020 2020 2020 2073 656c 662e 6d61 7020         self.map 
+00039050: 6163 636f 7264 696e 676c 792e 0a20 2020  accordingly..   
+00039060: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00039070: 2073 656c 662e 6974 656d 7320 3d20 6974   self.items = it
+00039080: 656d 730a 2020 2020 2020 2020 7365 6c66  ems.        self
+00039090: 2e6d 6170 203d 207b 6974 656d 3a20 6964  .map = {item: id
+000390a0: 7820 666f 7220 2869 6478 2c20 6974 656d  x for (idx, item
+000390b0: 2920 696e 2065 6e75 6d65 7261 7465 2869  ) in enumerate(i
+000390c0: 7465 6d73 297d 0a0a 2020 2020 6465 6620  tems)}..    def 
+000390d0: 6469 6666 6572 656e 6365 5f75 7064 6174  difference_updat
+000390e0: 6528 7365 6c66 2c20 2a73 6574 7329 3a0a  e(self, *sets):.
+000390f0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00039100: 2020 2020 5570 6461 7465 2074 6869 7320      Update this 
+00039110: 4f72 6465 7265 6453 6574 2074 6f20 7265  OrderedSet to re
+00039120: 6d6f 7665 2069 7465 6d73 2066 726f 6d20  move items from 
+00039130: 6f6e 6520 6f72 206d 6f72 6520 6f74 6865  one or more othe
+00039140: 7220 7365 7473 2e0a 0a20 2020 2020 2020  r sets...       
+00039150: 2045 7861 6d70 6c65 3a0a 2020 2020 2020   Example:.      
+00039160: 2020 2020 2020 3e3e 3e20 7468 6973 203d        >>> this =
+00039170: 204f 7264 6572 6564 5365 7428 5b31 2c20   OrderedSet([1, 
+00039180: 322c 2033 5d29 0a20 2020 2020 2020 2020  2, 3]).         
+00039190: 2020 203e 3e3e 2074 6869 732e 6469 6666     >>> this.diff
+000391a0: 6572 656e 6365 5f75 7064 6174 6528 4f72  erence_update(Or
+000391b0: 6465 7265 6453 6574 285b 322c 2034 5d29  deredSet([2, 4])
+000391c0: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
+000391d0: 3e20 7072 696e 7428 7468 6973 290a 2020  > print(this).  
+000391e0: 2020 2020 2020 2020 2020 4f72 6465 7265            Ordere
+000391f0: 6453 6574 285b 312c 2033 5d29 0a0a 2020  dSet([1, 3])..  
+00039200: 2020 2020 2020 2020 2020 3e3e 3e20 7468            >>> th
+00039210: 6973 203d 204f 7264 6572 6564 5365 7428  is = OrderedSet(
+00039220: 5b31 2c20 322c 2033 2c20 342c 2035 5d29  [1, 2, 3, 4, 5])
+00039230: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
+00039240: 2074 6869 732e 6469 6666 6572 656e 6365   this.difference
+00039250: 5f75 7064 6174 6528 4f72 6465 7265 6453  _update(OrderedS
+00039260: 6574 285b 322c 2034 5d29 2c20 4f72 6465  et([2, 4]), Orde
+00039270: 7265 6453 6574 285b 312c 2034 2c20 365d  redSet([1, 4, 6]
+00039280: 2929 0a20 2020 2020 2020 2020 2020 203e  )).            >
+00039290: 3e3e 2070 7269 6e74 2874 6869 7329 0a20  >> print(this). 
+000392a0: 2020 2020 2020 2020 2020 204f 7264 6572             Order
+000392b0: 6564 5365 7428 5b33 2c20 355d 290a 2020  edSet([3, 5]).  
+000392c0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+000392d0: 2020 6974 656d 735f 746f 5f72 656d 6f76    items_to_remov
+000392e0: 6520 3d20 7365 7428 290a 2020 2020 2020  e = set().      
+000392f0: 2020 666f 7220 6f74 6865 7220 696e 2073    for other in s
+00039300: 6574 733a 0a20 2020 2020 2020 2020 2020  ets:.           
+00039310: 2069 7465 6d73 5f74 6f5f 7265 6d6f 7665   items_to_remove
+00039320: 207c 3d20 7365 7428 6f74 6865 7229 0a20   |= set(other). 
+00039330: 2020 2020 2020 2073 656c 662e 5f75 7064         self._upd
+00039340: 6174 655f 6974 656d 7328 5b69 7465 6d20  ate_items([item 
+00039350: 666f 7220 6974 656d 2069 6e20 7365 6c66  for item in self
+00039360: 2e69 7465 6d73 2069 6620 6974 656d 206e  .items if item n
+00039370: 6f74 2069 6e20 6974 656d 735f 746f 5f72  ot in items_to_r
+00039380: 656d 6f76 655d 290a 0a20 2020 2064 6566  emove])..    def
+00039390: 2069 6e74 6572 7365 6374 696f 6e5f 7570   intersection_up
+000393a0: 6461 7465 2873 656c 662c 206f 7468 6572  date(self, other
+000393b0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+000393c0: 2020 2020 2020 2055 7064 6174 6520 7468         Update th
+000393d0: 6973 204f 7264 6572 6564 5365 7420 746f  is OrderedSet to
+000393e0: 206b 6565 7020 6f6e 6c79 2069 7465 6d73   keep only items
+000393f0: 2069 6e20 616e 6f74 6865 7220 7365 742c   in another set,
+00039400: 2070 7265 7365 7276 696e 670a 2020 2020   preserving.    
+00039410: 2020 2020 7468 6569 7220 6f72 6465 7220      their order 
+00039420: 696e 2074 6869 7320 7365 742e 0a0a 2020  in this set...  
+00039430: 2020 2020 2020 4578 616d 706c 653a 0a20        Example:. 
+00039440: 2020 2020 2020 2020 2020 203e 3e3e 2074             >>> t
+00039450: 6869 7320 3d20 4f72 6465 7265 6453 6574  his = OrderedSet
+00039460: 285b 312c 2034 2c20 332c 2035 2c20 375d  ([1, 4, 3, 5, 7]
+00039470: 290a 2020 2020 2020 2020 2020 2020 3e3e  ).            >>
+00039480: 3e20 6f74 6865 7220 3d20 4f72 6465 7265  > other = Ordere
+00039490: 6453 6574 285b 392c 2037 2c20 312c 2033  dSet([9, 7, 1, 3
+000394a0: 2c20 325d 290a 2020 2020 2020 2020 2020  , 2]).          
+000394b0: 2020 3e3e 3e20 7468 6973 2e69 6e74 6572    >>> this.inter
+000394c0: 7365 6374 696f 6e5f 7570 6461 7465 286f  section_update(o
+000394d0: 7468 6572 290a 2020 2020 2020 2020 2020  ther).          
+000394e0: 2020 3e3e 3e20 7072 696e 7428 7468 6973    >>> print(this
+000394f0: 290a 2020 2020 2020 2020 2020 2020 4f72  ).            Or
+00039500: 6465 7265 6453 6574 285b 312c 2033 2c20  deredSet([1, 3, 
+00039510: 375d 290a 2020 2020 2020 2020 2222 220a  7]).        """.
+00039520: 2020 2020 2020 2020 6f74 6865 7220 3d20          other = 
+00039530: 7365 7428 6f74 6865 7229 0a20 2020 2020  set(other).     
+00039540: 2020 2073 656c 662e 5f75 7064 6174 655f     self._update_
+00039550: 6974 656d 7328 5b69 7465 6d20 666f 7220  items([item for 
+00039560: 6974 656d 2069 6e20 7365 6c66 2e69 7465  item in self.ite
+00039570: 6d73 2069 6620 6974 656d 2069 6e20 6f74  ms if item in ot
+00039580: 6865 725d 290a 0a20 2020 2064 6566 2073  her])..    def s
+00039590: 796d 6d65 7472 6963 5f64 6966 6665 7265  ymmetric_differe
+000395a0: 6e63 655f 7570 6461 7465 2873 656c 662c  nce_update(self,
+000395b0: 206f 7468 6572 293a 0a20 2020 2020 2020   other):.       
+000395c0: 2022 2222 0a20 2020 2020 2020 2055 7064   """.        Upd
+000395d0: 6174 6520 7468 6973 204f 7264 6572 6564  ate this Ordered
+000395e0: 5365 7420 746f 2072 656d 6f76 6520 6974  Set to remove it
+000395f0: 656d 7320 6672 6f6d 2061 6e6f 7468 6572  ems from another
+00039600: 2073 6574 2c20 7468 656e 0a20 2020 2020   set, then.     
+00039610: 2020 2061 6464 2069 7465 6d73 2066 726f     add items fro
+00039620: 6d20 7468 6520 6f74 6865 7220 7365 7420  m the other set 
+00039630: 7468 6174 2077 6572 6520 6e6f 7420 7072  that were not pr
+00039640: 6573 656e 7420 696e 2074 6869 7320 7365  esent in this se
+00039650: 742e 0a0a 2020 2020 2020 2020 4578 616d  t...        Exam
+00039660: 706c 653a 0a20 2020 2020 2020 2020 2020  ple:.           
+00039670: 203e 3e3e 2074 6869 7320 3d20 4f72 6465   >>> this = Orde
+00039680: 7265 6453 6574 285b 312c 2034 2c20 332c  redSet([1, 4, 3,
+00039690: 2035 2c20 375d 290a 2020 2020 2020 2020   5, 7]).        
+000396a0: 2020 2020 3e3e 3e20 6f74 6865 7220 3d20      >>> other = 
+000396b0: 4f72 6465 7265 6453 6574 285b 392c 2037  OrderedSet([9, 7
+000396c0: 2c20 312c 2033 2c20 325d 290a 2020 2020  , 1, 3, 2]).    
+000396d0: 2020 2020 2020 2020 3e3e 3e20 7468 6973          >>> this
+000396e0: 2e73 796d 6d65 7472 6963 5f64 6966 6665  .symmetric_diffe
+000396f0: 7265 6e63 655f 7570 6461 7465 286f 7468  rence_update(oth
+00039700: 6572 290a 2020 2020 2020 2020 2020 2020  er).            
+00039710: 3e3e 3e20 7072 696e 7428 7468 6973 290a  >>> print(this).
+00039720: 2020 2020 2020 2020 2020 2020 4f72 6465              Orde
+00039730: 7265 6453 6574 285b 342c 2035 2c20 392c  redSet([4, 5, 9,
+00039740: 2032 5d29 0a20 2020 2020 2020 2022 2222   2]).        """
+00039750: 0a20 2020 2020 2020 2069 7465 6d73 5f74  .        items_t
+00039760: 6f5f 6164 6420 3d20 5b69 7465 6d20 666f  o_add = [item fo
+00039770: 7220 6974 656d 2069 6e20 6f74 6865 7220  r item in other 
+00039780: 6966 2069 7465 6d20 6e6f 7420 696e 2073  if item not in s
+00039790: 656c 665d 0a20 2020 2020 2020 2069 7465  elf].        ite
+000397a0: 6d73 5f74 6f5f 7265 6d6f 7665 203d 2073  ms_to_remove = s
+000397b0: 6574 286f 7468 6572 290a 2020 2020 2020  et(other).      
+000397c0: 2020 7365 6c66 2e5f 7570 6461 7465 5f69    self._update_i
+000397d0: 7465 6d73 280a 2020 2020 2020 2020 2020  tems(.          
+000397e0: 2020 5b69 7465 6d20 666f 7220 6974 656d    [item for item
+000397f0: 2069 6e20 7365 6c66 2e69 7465 6d73 2069   in self.items i
+00039800: 6620 6974 656d 206e 6f74 2069 6e20 6974  f item not in it
+00039810: 656d 735f 746f 5f72 656d 6f76 655d 202b  ems_to_remove] +
+00039820: 2069 7465 6d73 5f74 6f5f 6164 640a 2020   items_to_add.  
+00039830: 2020 2020 2020 290a 0a64 6566 206f 6372        )..def ocr
+00039840: 2869 6d67 3d4e 6f6e 652c 6c61 6e67 3d5b  (img=None,lang=[
+00039850: 2765 6e27 5d2c 6770 753d 4661 6c73 652c  'en'],gpu=False,
+00039860: 2a61 7267 732c 2a2a 6b77 6172 6773 293a  *args,**kwargs):
+00039870: 0a20 2020 2022 2222 0a20 2020 2069 6d67  .    """.    img
+00039880: 3a20 6669 6c65 7061 7468 2c20 4f70 656e  : filepath, Open
+00039890: 4356 2069 6d61 6765 206f 626a 6563 7420  CV image object 
+000398a0: 286e 756d 7079 2061 7272 6179 292c 2069  (numpy array), i
+000398b0: 6d61 6765 2066 696c 6520 6173 2062 7974  mage file as byt
+000398c0: 6573 2c20 5552 4c20 746f 2072 6177 2069  es, URL to raw i
+000398d0: 6d61 6765 2028 6465 6661 756c 7420 4e6f  mage (default No
+000398e0: 6e65 3d63 6c69 7062 6f61 7264 2069 6d67  ne=clipboard img
+000398f0: 290a 2020 2020 6c61 6e67 3a20 5b27 656e  ).    lang: ['en
+00039900: 272c 2763 685f 7369 6d27 2c27 6368 5f74  ','ch_sim','ch_t
+00039910: 7261 275d 0a20 2020 2068 7474 7073 3a2f  ra'].    https:/
+00039920: 2f77 7777 2e6a 6169 6465 642e 6169 2f65  /www.jaided.ai/e
+00039930: 6173 796f 6372 2f64 6f63 756d 656e 7461  asyocr/documenta
+00039940: 7469 6f6e 2f0a 2020 2020 2222 220a 2020  tion/.    """.  
+00039950: 2020 6672 6f6d 2050 494c 2069 6d70 6f72    from PIL impor
+00039960: 7420 496d 6167 6547 7261 620a 2020 2020  t ImageGrab.    
+00039970: 696d 706f 7274 2065 6173 796f 6372 0a20  import easyocr. 
+00039980: 2020 2069 6620 696d 6720 6973 204e 6f6e     if img is Non
+00039990: 653a 2069 6d67 203d 2049 6d61 6765 4772  e: img = ImageGr
+000399a0: 6162 2e67 7261 6263 6c69 7062 6f61 7264  ab.grabclipboard
+000399b0: 2829 0a20 2020 2072 6561 6465 7220 3d20  ().    reader = 
+000399c0: 6561 7379 6f63 722e 5265 6164 6572 286c  easyocr.Reader(l
+000399d0: 616e 672c 6770 753d 6770 7529 0a20 2020  ang,gpu=gpu).   
+000399e0: 2072 6573 756c 7420 3d20 7265 6164 6572   result = reader
+000399f0: 2e72 6561 6474 6578 7428 696d 672c 6465  .readtext(img,de
+00039a00: 7461 696c 3d54 7275 652c 7061 7261 6772  tail=True,paragr
+00039a10: 6170 683d 4661 6c73 652c 2a61 7267 732c  aph=False,*args,
+00039a20: 2a2a 6b77 6172 6773 290a 2020 2020 2320  **kwargs).    # 
+00039a30: 7265 7375 6c74 3d5b 285b 5b31 3839 2c20  result=[([[189, 
+00039a40: 3735 5d2c 205b 3436 392c 2037 355d 2c20  75], [469, 75], 
+00039a50: 5b34 3639 2c20 3136 355d 2c20 5b31 3839  [469, 165], [189
+00039a60: 2c20 3136 355d 5d2c 2027 e684 9ae5 9bad  , 165]], '......
+00039a70: e8b7 af27 2c20 302e 3337 3534 3938 3935  ...', 0.37549895
+00039a80: 3034 3831 3431 3438 292c 0a20 2020 2023  04814148),.    #
+00039a90: 2020 285b 5b38 362c 2038 305d 2c20 5b31    ([[86, 80], [1
+00039aa0: 3334 2c20 3830 5d2c 205b 3133 342c 2031  34, 80], [134, 1
+00039ab0: 3238 5d2c 205b 3836 2c20 3132 385d 5d2c  28], [86, 128]],
+00039ac0: 2027 e8a5 bf27 2c20 302e 3430 3435 3236   '...', 0.404526
+00039ad0: 3539 3133 3030 3936 3433 3629 2c0a 2020  59130096436),.  
+00039ae0: 2020 2320 2028 5b5b 3531 372c 2038 315d    #  ([[517, 81]
+00039af0: 2c20 5b35 3635 2c20 3831 5d2c 205b 3536  , [565, 81], [56
+00039b00: 352c 2031 3233 5d2c 205b 3531 372c 2031  5, 123], [517, 1
+00039b10: 3233 5d5d 2c20 27e4 b89c 272c 2030 2e39  23]], '...', 0.9
+00039b20: 3938 3935 3938 3938 3934 3836 3639 3429  989598989486694)
+00039b30: 2c0a 2020 2020 2320 2028 5b5b 3738 2c20  ,.    #  ([[78, 
+00039b40: 3132 365d 2c20 5b31 3336 2c20 3132 365d  126], [136, 126]
+00039b50: 2c20 5b31 3336 2c20 3135 365d 2c20 5b37  , [136, 156], [7
+00039b60: 382c 2031 3536 5d5d 2c20 2733 3135 272c  8, 156]], '315',
+00039b70: 2030 2e38 3132 3538 3839 3330 3133 3030   0.8125889301300
+00039b80: 3034 3929 2c0a 2020 2020 2320 2028 5b5b  049),.    #  ([[
+00039b90: 3531 342c 2031 3236 5d2c 205b 3537 342c  514, 126], [574,
+00039ba0: 2031 3236 5d2c 205b 3537 342c 2031 3536   126], [574, 156
+00039bb0: 5d2c 205b 3531 342c 2031 3536 5d5d 2c20  ], [514, 156]], 
+00039bc0: 2733 3039 272c 2030 2e34 3937 3135 3737  '309', 0.4971577
+00039bd0: 3232 3731 3135 3633 3129 2c0a 2020 2020  227115631),.    
+00039be0: 2320 2028 5b5b 3232 362c 2031 3730 5d2c  #  ([[226, 170],
+00039bf0: 205b 3431 342c 2031 3730 5d2c 205b 3431   [414, 170], [41
+00039c00: 342c 2032 3230 5d2c 205b 3232 362c 2032  4, 220], [226, 2
+00039c10: 3230 5d5d 2c20 2759 7579 7561 6e20 5264  20]], 'Yuyuan Rd
+00039c20: 2e27 2c20 302e 3832 3631 3930 3233 3332  .', 0.8261902332
+00039c30: 3330 3539 3038 292c 0a20 2020 2023 2020  305908),.    #  
+00039c40: 285b 5b37 392c 2031 3733 5d2c 205b 3132  ([[79, 173], [12
+00039c50: 352c 2031 3733 5d2c 205b 3132 352c 2032  5, 173], [125, 2
+00039c60: 3133 5d2c 205b 3739 2c20 3231 335d 5d2c  13], [79, 213]],
+00039c70: 2027 5727 2c20 302e 3938 3438 3131 3132   'W', 0.98481112
+00039c80: 3731 3835 3832 3135 292c 0a20 2020 2023  71858215),.    #
+00039c90: 2020 285b 5b35 3239 2c20 3137 335d 2c20    ([[529, 173], 
+00039ca0: 5b35 3639 2c20 3137 335d 2c20 5b35 3639  [569, 173], [569
+00039cb0: 2c20 3231 335d 2c20 5b35 3239 2c20 3231  , 213], [529, 21
+00039cc0: 335d 5d2c 2027 4527 2c20 302e 3834 3035  3]], 'E', 0.8405
+00039cd0: 3539 3336 3333 3635 3137 3333 295d 0a20  593633651733)]. 
+00039ce0: 2020 2074 6f70 3d5b 5d3b 206c 6566 743d     top=[]; left=
+00039cf0: 5b5d 3b20 6f75 743d 7b7d 0a20 2020 2066  []; out={}.    f
+00039d00: 6f72 2072 2069 6e20 7265 7375 6c74 3a0a  or r in result:.
+00039d10: 2020 2020 2020 2020 746f 703d 725b 305d          top=r[0]
+00039d20: 5b30 5d5b 315d 3b20 6c65 6674 3d72 5b30  [0][1]; left=r[0
+00039d30: 5d5b 305d 5b30 5d3b 2074 6578 743d 725b  ][0][0]; text=r[
+00039d40: 315d 0a20 2020 2020 2020 2069 6620 746f  1].        if to
+00039d50: 7020 6e6f 7420 696e 206f 7574 2e6b 6579  p not in out.key
+00039d60: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
+00039d70: 2023 202f 3130 2074 6f20 7363 616c 650a   # /10 to scale.
+00039d80: 2020 2020 2020 2020 2020 2020 6f75 745b              out[
+00039d90: 746f 705d 3d27 2027 2a69 6e74 286c 6566  top]=' '*int(lef
+00039da0: 742f 3130 292b 7465 7874 0a20 2020 2020  t/10)+text.     
+00039db0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00039dc0: 2020 2020 2074 6578 745f 6f6c 6420 3d20       text_old = 
+00039dd0: 6f75 745b 746f 705d 2e6c 7374 7269 7028  out[top].lstrip(
+00039de0: 290a 2020 2020 2020 2020 2020 2020 7465  ).            te
+00039df0: 7874 5f6e 6577 203d 2074 6578 740a 2020  xt_new = text.  
+00039e00: 2020 2020 2020 2020 2020 6c65 6674 5f6f            left_o
+00039e10: 6c64 203d 206c 656e 286f 7574 5b74 6f70  ld = len(out[top
+00039e20: 5d29 202d 206c 656e 286f 7574 5b74 6f70  ]) - len(out[top
+00039e30: 5d2e 6c73 7472 6970 2829 290a 2020 2020  ].lstrip()).    
+00039e40: 2020 2020 2020 2020 6c65 6674 5f6e 6577          left_new
+00039e50: 203d 2069 6e74 286c 6566 742f 3130 290a   = int(left/10).
+00039e60: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+00039e70: 6566 745f 6e65 7720 3e20 6c65 6674 5f6f  eft_new > left_o
+00039e80: 6c64 3a0a 2020 2020 2020 2020 2020 2020  ld:.            
+00039e90: 2020 2020 7061 7274 3120 3d20 2720 272a      part1 = ' '*
+00039ea0: 696e 7428 6c65 6674 5f6f 6c64 2f31 3029  int(left_old/10)
+00039eb0: 2b74 6578 745f 6f6c 643b 2070 6172 7432  +text_old; part2
+00039ec0: 203d 2027 2027 2a69 6e74 286c 6566 745f   = ' '*int(left_
+00039ed0: 6e65 7720 2d20 6c65 6e28 7061 7274 3129  new - len(part1)
+00039ee0: 292b 7465 7874 5f6e 6577 0a20 2020 2020  )+text_new.     
+00039ef0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00039f00: 2020 2020 2020 2020 2020 2020 2023 2075               # u
+00039f10: 6e6c 696b 6520 746f 2074 7269 6767 6572  nlike to trigger
+00039f20: 2c20 7369 6e63 6520 7265 7375 6c74 206f  , since result o
+00039f30: 7264 6572 6564 2062 7920 746f 7020 616c  rdered by top al
+00039f40: 7265 6164 790a 2020 2020 2020 2020 2020  ready.          
+00039f50: 2020 2020 2020 7061 7274 3120 3d20 2720        part1 = ' 
+00039f60: 272a 696e 7428 6c65 6674 5f6e 6577 2f31  '*int(left_new/1
+00039f70: 3029 2b74 6578 745f 6e65 773b 2070 6172  0)+text_new; par
+00039f80: 7432 203d 2027 2027 2a69 6e74 286c 6566  t2 = ' '*int(lef
+00039f90: 745f 6f6c 6420 2d20 6c65 6e28 7061 7274  t_old - len(part
+00039fa0: 3129 292b 7465 7874 5f6f 6c64 0a20 2020  1))+text_old.   
+00039fb0: 2020 2020 2020 2020 206f 7574 5b74 6f70           out[top
+00039fc0: 5d20 3d20 7061 7274 312b 7061 7274 320a  ] = part1+part2.
+00039fd0: 2020 2020 7265 7375 6c74 3d5b 7465 7874      result=[text
+00039fe0: 2066 6f72 2028 746f 702c 2074 6578 7429   for (top, text)
+00039ff0: 2069 6e20 736f 7274 6564 286f 7574 2e69   in sorted(out.i
+0003a000: 7465 6d73 2829 295d 0a20 2020 2072 6574  tems())].    ret
+0003a010: 7572 6e20 7265 7375 6c74 0a20 2020 2023  urn result.    #
+0003a020: 2066 6f72 2072 2069 6e20 7265 7375 6c74   for r in result
+0003a030: 3a0a 2020 2020 2320 2020 2020 7072 696e  :.    #     prin
+0003a040: 7428 7229 0a0a 6465 6620 6769 6628 696d  t(r)..def gif(im
+0003a050: 6773 2c6f 7574 3d27 616e 696d 6174 696f  gs,out='animatio
+0003a060: 6e2e 6769 6627 2c63 726f 703d 4e6f 6e65  n.gif',crop=None
+0003a070: 2c64 7572 6174 696f 6e3d 3330 302c 6c6f  ,duration=300,lo
+0003a080: 6f70 3d30 293a 0a20 2020 2022 2222 0a20  op=0):.    """. 
+0003a090: 2020 2069 6d67 733a 2061 206c 6973 7420     imgs: a list 
+0003a0a0: 6f66 2069 6d61 6765 2070 6174 680a 2020  of image path.  
+0003a0b0: 2020 6f75 743a 2070 6174 6820 6f66 2067    out: path of g
+0003a0c0: 6966 2074 6f20 7361 7665 0a20 2020 2063  if to save.    c
+0003a0d0: 726f 703a 205b 6c65 6674 2c20 7570 2c20  rop: [left, up, 
+0003a0e0: 7269 6768 742c 2062 6f74 746f 6d5d 206f  right, bottom] o
+0003a0f0: 6620 7468 6520 696d 6167 6520 746f 2063  f the image to c
+0003a100: 726f 700a 2020 2020 6475 7261 7469 6f6e  rop.    duration
+0003a110: 3a20 6120 7369 6e67 6c65 2076 616c 7565  : a single value
+0003a120: 206f 7220 6120 6c69 7374 206f 6620 7661   or a list of va
+0003a130: 6c75 6573 2066 6f72 2065 6163 6820 6672  lues for each fr
+0003a140: 616d 6520 2869 6e20 6d73 290a 2020 2020  ame (in ms).    
+0003a150: 6c6f 6f70 3a20 3e3d 302c 2030 2066 6f72  loop: >=0, 0 for
+0003a160: 6576 6572 0a20 2020 2022 2222 0a20 2020  ever.    """.   
+0003a170: 2066 726f 6d20 5049 4c20 696d 706f 7274   from PIL import
+0003a180: 2049 6d61 6765 0a20 2020 2023 2043 7265   Image.    # Cre
+0003a190: 6174 6520 7468 6520 6672 616d 6573 0a20  ate the frames. 
+0003a1a0: 2020 2066 7261 6d65 7320 3d20 5b5d 0a20     frames = []. 
+0003a1b0: 2020 2066 6f72 2069 2069 6e20 696d 6773     for i in imgs
+0003a1c0: 3a0a 2020 2020 2020 2020 696d 203d 2049  :.        im = I
+0003a1d0: 6d61 6765 2e6f 7065 6e28 6929 0a20 2020  mage.open(i).   
+0003a1e0: 2020 2020 2070 7269 6e74 2866 2249 6e70       print(f"Inp
+0003a1f0: 7574 2069 6d61 6765 207b 697d 3a20 7720  ut image {i}: w 
+0003a200: 7b69 6d2e 7369 7a65 5b30 5d7d 2078 2068  {im.size[0]} x h
+0003a210: 207b 696d 2e73 697a 655b 315d 7d22 290a   {im.size[1]}").
+0003a220: 2020 2020 2020 2020 6966 2063 726f 7020          if crop 
+0003a230: 6973 206e 6f74 204e 6f6e 653a 2069 6d20  is not None: im 
+0003a240: 3d20 696d 2e63 726f 7028 6372 6f70 290a  = im.crop(crop).
+0003a250: 2020 2020 2020 2020 6672 616d 6573 2e61          frames.a
+0003a260: 7070 656e 6428 696d 290a 0a20 2020 2023  ppend(im)..    #
+0003a270: 2053 6176 6520 696e 746f 2061 2047 4946   Save into a GIF
+0003a280: 2066 696c 650a 2020 2020 6672 616d 6573   file.    frames
+0003a290: 5b30 5d2e 7361 7665 286f 7574 2c20 666f  [0].save(out, fo
+0003a2a0: 726d 6174 3d27 4749 4627 2c0a 2020 2020  rmat='GIF',.    
+0003a2b0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+0003a2c0: 7070 656e 645f 696d 6167 6573 3d66 7261  ppend_images=fra
+0003a2d0: 6d65 735b 313a 5d2c 0a20 2020 2020 2020  mes[1:],.       
+0003a2e0: 2020 2020 2020 2020 2020 2020 7361 7665              save
+0003a2f0: 5f61 6c6c 3d54 7275 652c 0a20 2020 2020  _all=True,.     
+0003a300: 2020 2020 2020 2020 2020 2020 2020 6475                du
+0003a310: 7261 7469 6f6e 3d64 7572 6174 696f 6e2c  ration=duration,
+0003a320: 206c 6f6f 703d 6c6f 6f70 290a 2020 2020   loop=loop).    
+0003a330: 7072 696e 7428 6622 4f75 7470 7574 2067  print(f"Output g
+0003a340: 6966 3a20 7b6f 7574 7d22 290a 0a23 202b  if: {out}")..# +
+0003a350: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
 0003a360: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
 0003a370: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
 0003a380: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
 0003a390: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0003a3a0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0003a3b0: 2b0a 2320 6465 6275 6767 696e 670a 2320  +.# debugging.# 
+0003a3a0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0a23 2064  ++++++++++++.# d
+0003a3b0: 6562 7567 6769 6e67 0a23 202b 2b2b 2b2b  ebugging.# +++++
 0003a3c0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
 0003a3d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
 0003a3e0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
 0003a3f0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
 0003a400: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0003a410: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0a 6966  +++++++++++++.if
-0003a420: 205f 5f6e 616d 655f 5f20 3d3d 2022 5f5f   __name__ == "__
-0003a430: 6d61 696e 5f5f 223a 0a20 2020 2070 6173  main__":.    pas
-0003a440: 73                                       s
+0003a410: 2b2b 2b2b 2b2b 2b2b 0a69 6620 5f5f 6e61  ++++++++.if __na
+0003a420: 6d65 5f5f 203d 3d20 225f 5f6d 6169 6e5f  me__ == "__main_
+0003a430: 5f22 3a0a 2020 2020 7061 7373            _":.    pass
```

### Comparing `ez-9.9.8/ez/firefox.py` & `ez-9.9.9/ez/firefox.py`

 * *Files identical despite different names*

### Comparing `ez-9.9.8/ez/firefox.xpi` & `ez-9.9.9/ez/firefox.xpi`

 * *Files identical despite different names*

### Comparing `ez-9.9.8/ez.egg-info/PKG-INFO` & `ez-9.9.9/ez.egg-info/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: ez
-Version: 9.9.8
+Version: 9.9.9
 Summary: easy stuff
 Home-page: https://pypi.python.org/pypi/ez
 Author: Jerry Zhu
 Author-email: jerryzhujian9@gmail.com
 License: GPLv3+
 Keywords: shell,cross-platform,easy,wrapper
 Platform: UNKNOWN
```

### Comparing `ez-9.9.8/setup.py` & `ez-9.9.9/setup.py`

 * *Files 2% similar despite different names*

```diff
@@ -13,17 +13,18 @@
 # packages.append('ez.timezone.pytz')
 # install_requires = ['django-pipeline==1.1.22', 'south>=0.7']
 # install_requires=['peppercorn']
 # install_requires=['']
 # 'noraise' (seems not actually used, might be useful for myself), 'fake_useragent', 'tldextract' --> firefox
 # 'cachelib': for flask
 # 'opencv-python' for find on screen, 'easyocr' for ocr
+# 'html': html.escape for gmail text
 # pynput instead of pyautogui <- problematic dependencies on MacOS
 # setup.py upload depreciated -> twine
-install_requires=['twine','pytz', 'tzlocal', 'Send2Trash', 'keyring', 'pyperclip', 'yagmail', 'O365', 'chardet', 'psutil',
+install_requires=['twine','pytz', 'tzlocal', 'Send2Trash', 'keyring', 'pyperclip', 'html', 'yagmail', 'O365', 'chardet', 'psutil',
                  'openpyxl', 'xlsxwriter', 'xlwt', 'xlrd', 'PyMuPDF', 'pdfCropMargins', 'python-docx', 'python-pptx',
                  'requests>=2.26.0', 'selenium-requests>=1.4.1', 'selenium-wire', 'selenium>4', 'noraise', 'fake_useragent', 'tldextract',
                  'pynput', 'gspread>=3.7.0', 'tenacity', 'fire', 'parse',
                  'pandas', 'numpy', 'beautifulsoup4', 'lxml',
                  'pyarrow', 'cachelib', 'Pillow', 'mss', 'SpeechRecognition',
                  'dropbox','pydrive2']
 # 'imessage_reader' not available on heroku/linux when installing ez
```

